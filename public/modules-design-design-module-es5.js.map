{"version":3,"sources":["webpack:///node_modules/jsplumb/dist/js/jsplumb.js","webpack:///node_modules/ngx-monaco-editor/__ivy_ngcc__/fesm2015/ngx-monaco-editor.js","webpack:///src/app/modules/design/design-block-types/design-block-types.component.ts","webpack:///src/app/modules/design/design-block-types/design-block-types.component.html","webpack:///src/app/modules/design/design-blocks/design-blocks.component.ts","webpack:///src/app/modules/design/design-blocks/design-blocks.component.html","webpack:///src/app/modules/design/design-custom-icons/design-custom-icons.component.ts","webpack:///src/app/modules/design/design-custom-icons/design-custom-icons.component.html","webpack:///src/app/modules/design/design-home/design-home.component.ts","webpack:///src/app/modules/design/design-home/design-home.component.html","webpack:///src/app/modules/design/design-providers/design-providers.component.ts","webpack:///src/app/modules/design/design-providers/design-providers.component.html","webpack:///src/app/modules/design/design-routing.module.ts","webpack:///src/app/modules/design/design-workflow-editor/design-workflow-editor.component.ts","webpack:///src/app/modules/design/design-workflow-editor/design-workflow-editor.component.html","webpack:///src/app/modules/design/design-workflow-node/design-workflow-node.component.ts","webpack:///src/app/modules/design/design-workflow-node/design-workflow-node.component.html","webpack:///src/app/modules/design/design-workflow-palette/design-workflow-palette.component.ts","webpack:///src/app/modules/design/design-workflow-palette/design-workflow-palette.component.html","webpack:///src/app/modules/design/design-workflow-tree/design-workflow-tree.component.ts","webpack:///src/app/modules/design/design-workflow-tree/design-workflow-tree.component.html","webpack:///src/app/modules/design/design-workflows/design-workflows.component.ts","webpack:///src/app/modules/design/design-workflows/design-workflows.component.html","webpack:///src/app/modules/design/design.component.ts","webpack:///src/app/modules/design/design.component.html","webpack:///src/app/modules/design/design.module.ts","webpack:///src/app/modules/design/node.component.ts","webpack:///src/app/modules/design/node.component.html","webpack:///src/app/modules/design/node.service.ts","webpack:///src/app/modules/design/nodes-container/nodes-container.component.ts","webpack:///src/app/modules/design/nodes-container/nodes-container.component.html","webpack:///src/app/modules/design/treelist.service.ts","webpack:///src/app/modules/design/workflow-node-details/workflow-node-details.component.ts","webpack:///src/app/modules/design/workflow-node-details/workflow-node-details.component.html","webpack:///src/app/modules/design/workflow-studio-root/workflow-studio-root.component.ts","webpack:///src/app/modules/design/workflow-studio-root/workflow-studio-root.component.html"],"names":["root","Math","sgn","x","Vectors","subtract","v1","v2","y","dotProduct","square","v","sqrt","scale","s","maxRecursion","flatnessTolerance","pow","_distanceFromCurve","point","curve","candidates","w","_convertToBezier","degree","length","higherDegree","numSolutions","_findRoots","dist","t","i","_bezier","newDist","location","distance","_nearestPointOnCurve","td","c","d","cdTable","z","row","column","parseFloat","n","m","k","lb","max","ub","min","j","depth","left","right","left_count","right_count","left_t","right_t","_getCrossingCount","_isFlatEnough","_computeXIntercept","n_crossings","sign","old_sign","error","intercept_1","intercept_2","left_intercept","right_intercept","a","b","det","dInv","a1","b1","c1","a2","b2","c2","max_distance_above","max_distance_below","value","XLK","YLK","XNM","YNM","XMK","YMK","detInv","S","temp","_curveFunctionCache","_getCurveFunctions","order","fns","f_term","l_term","c_term","t_term","one_minus_t_term","_termFunc","terms","p","push","_pointOnPath","cc","_x","_y","_dist","p1","p2","_isPoint","_pointAlongPath","prev","tally","curLoc","direction","cur","abs","_length","Date","getTime","console","log","_pointAlongPathFrom","_locationAlongPathFrom","_gradientAtPoint","slice","dy","dx","Infinity","atan","_gradientAtPointAlongPathFrom","_perpendicularToPathAt","_theta2","sin","cos","_lineIntersection","x1","y1","x2","y2","coeffs","_computeCoefficients","r","_cubicRoots","apply","intersections","t2","t3","_boxIntersection","h","_boundingBoxIntersection","boundingBox","_computeCoefficientsForAxis","axis","A","B","C","Q","R","D","T","th","acos","PI","jsBezier","distanceFromCurve","gradientAtPoint","gradientAtPointAlongCurveFrom","nearestPointOnCurve","pointOnCurve","pointAlongCurveFrom","perpendicularToCurveAt","locationAlongCurveFrom","getLength","lineIntersection","boxIntersection","boundingBoxIntersection","version","exports","call","window","Biltong","_isa","Object","prototype","toString","_pointHelper","fn","_gradient","gradient","_p1","_p2","_normal","normal","_lineLength","lineLength","_quadrant","quadrant","_theta","theta","_intersects","intersects","r1","r2","_encloses","encloses","allowSharedEdges","v3","v4","_segmentMultipliers","_inverseSegmentMultipliers","_pointOnLine","pointOnLine","fromPoint","toPoint","segmentMultiplier","_perpendicularLineTo","perpendicularLineTo","theta2","_touch","view","target","pageX","pageY","screenX","screenY","clientX","clientY","Touch","identifier","_uuid","_touchList","list","Array","arguments","item","index","_touchAndList","matchesSelector","el","selector","ctx","parentNode","possibles","querySelectorAll","_gel","constructor","String","document","getElementById","_t","e","srcElement","_pi","obj","doCompute","path","end","indexOf","out","_one","_d","l","splice","guid","_store","event","g","__ta","__tauid","_unstore","__taExtra","_unbind","__taUnstore","_curryChildFilter","children","evt","split","_fn","pathInfo","registerExtraFunction","newFn","DefaultHandler","isTouchDevice","touchMap","tfn","_bind","getAttribute","setAttribute","SmartClickHandler","__taSmartClicks","down","__tad","_pageLocation","up","__tau","click","_tapProfiles","touches","taps","TapHandler","clickThreshold","dblClickThreshold","isMouseDevice","__taTapHandler","tt","tap","dbltap","contextmenu","downSelectors","finished","setTimeout","clearSingle","clearDouble","currentTarget","tc","_touchCount","eventId","hasOwnProperty","pLoop","meeHelper","type","__tamee","MouseEnterExitHandler","activeElements","over","mouseenter","mouseexit","relatedTarget","toElement","documentElement","navigator","maxTouchPoints","touchstart","touchend","touchmove","iev","rv","appName","ua","userAgent","re","RegExp","exec","$1","isIELT9","_genLoc","prefix","ts","_touches","_getTouch","scrollLeft","scrollTop","_screenLocation","_clientLocation","idx","changedTouches","targetTouches","originalFn","addEventListener","attachEvent","key","_each","_el","removeEventListener","detachEvent","__taTouchProxy","Window","top","tagName","replace","random","Mottle","params","mouseEnterExitHandler","tapHandler","_smartClicks","smartClicks","_doBind","remove","removeChild","on","_c","_e","_f","off","trigger","originalEvent","payload","originalIsMouse","MouseEvent","eventToBind","bindingAMouseEvent","pl","sl","cl","_decorate","_evt","eventGenerators","touchList","init","initTouchEvent","initEvent","initMouseEvent","createEvent","ite","evtName","dispatchEvent","createEventObject","eventType","eventName","fireEvent","consume","doNotPreventDefault","stopPropagation","returnValue","preventDefault","pageLocation","setForceTouchEvents","setForceMouseEvents","_suggest","head","unshift","_vanquish","_difference","l1","l2","_isString","f","getOffsetRect","elem","box","getBoundingClientRect","body","docElem","pageYOffset","pageXOffset","clientTop","clientLeft","round","findDelegateElement","parentElement","childElement","currentParent","findMatchingSelector","availableSelectors","draggableId","filter","matches","exclude","filterExclude","DEFAULT_GRID_X","DEFAULT_GRID_Y","isIE9","_pl","_classes","delegatedDraggable","draggable","droppable","drag","selected","active","hover","noSelect","ghostProxy","clonedDrag","_defaultScope","_events","_devNull","_true","_foreach","from","_setDroppablesActive","dd","val","andHover","setActive","updatePosition","setHover","_consume","_defaultInputFilterSelector","_inputFilter","_katavorio","getInputFilterSelector","Super","css","scope","addClass","_class","uuid","enabled","setEnabled","isEnabled","toggleEnabled","setScope","scopes","addScope","removeScope","toggleScope","katavorio","TRUE","FALSE","Drag","rightButtonCanDrag","downAt","posAtDown","pagePosAtDown","pageDelta","moving","initialScroll","consumeStartEvent","dragEl","clone","scroll","_multipleDrop","multipleDrop","isConstrained","useGhostProxy","cloneNode","elementToDrag","activeSelectorParams","ghostProxyParent","currentParentPosition","ghostParentPosition","ghostDx","ghostDy","snapThreshold","_snap","pos","gridX","gridY","thresholdX","thresholdY","_dx","floor","_dxl","_dxt","_dy","_dyl","_dyt","posses","posseRoles","toGrid","grid","tx","ty","snap","getPosition","snapped","setPosition","setUseGhostProxy","constrain","negativeFilter","allowNegative","_setConstrain","_constrainRect","_size","bind","containment","setConstrain","revertFunction","setRevert","revert","_assignId","_katavorioId","_filters","_testFilter","_setFilter","setFilter","_exclude","_addFilter","addFilter","_removeFilter","removeFilter","clearAllFilters","canDrag","constrainRect","matchingDroppables","intersectingDroppables","addSelector","downListener","defaultPrevented","isNotRightClick","which","button","match","style","position","parent","appendChild","moveListener","upListener","markSelection","markPosses","_dispatch","consumeFilteredEvents","_continue","mark","abort","ignoreZoom","getZoom","moveBy","updateSelection","updatePosses","unbind","removeClass","unmark","unmarkSelection","unmarkPosses","stop","notifyPosseDragStop","getFilters","getDragElement","retrieveOriginalElement","listeners","events","start","beforeStart","result","notifyStart","force","positions","sel","getSelection","dPos","ghostProxyOffsets","finalPos","selection","andNotify","size","getSize","getMatchingDroppables","dragClass","cs","getConstrainingRectangle","notifySelectionDragStart","doNotCheckDroppables","offsetLeft","offsetTop","sort","_rankSort","retVal","drop","desiredLoc","cPos","gp","rect","pageRect","focusDropElement","pagePosition","canDrop","isHover","destroy","handle","Drop","rank","_activeClass","activeClass","_hoverClass","hoverClass","allowLoopback","_katavorioDragHover","Katavorio","katavorioParams","_selection","_selectionMap","_dragsByScope","_dropsByScope","_zoom","_reg","map","_obj","_unreg","_getMatchingDroppables","_m","_dd","_prepareParams","_p","_mistletoe","existingDrag","_css","overrideCss","_scope","inputFilterSelector","setInputFilterSelector","o","_katavorioDrag","_katavorioDrop","select","deselect","_s","deselectAll","_posses","members","_posseAction","notifySelectionDragStop","setZoom","_scopeManip","kObj","_kObj","snapToGrid","getDragsForScope","getDropsForScope","_destroy","selIdx","_removeListener","elementRemoved","destroyDraggable","destroyDroppable","reset","_processOneSpec","_spec","dontAddExisting","posseId","id","posse","name","addToPosse","spec","setPosse","diff","removeFromPosse","TypeError","removeFromAllPosses","setPosseState","state","jsPlumbUtil","isArray","isNumber","isString","isBoolean","isNull","isObject","isDate","isFunction","isNamedFunction","isEmpty","merge","collations","overwrites","cMap","ar","oMap","inObj","q","term","lc","str","array","last","_getArray","a_1","functionChain","successValue","failValue","populate","model","values","functionPrefix","doNotExpandFunctions","getValue","fromString","substring","findWithFunction","removeWithFunction","addWithFunction","hashFunction","addToList","insertAtStart","suggest","insertAtHead","extend","child","_protoFn","_copyProtoChain","focus","proto","__proto__","_makeFn","protoFn","_oneSet","lut","d0","d1","d2","d3","fastTrim","ws","test","charAt","each","mergeWithParents","parentAttribute","_def","_parent","def","overrides","mergeStrategy","d_1","_getDef","done","logEnabled","args","_i","msg","wrap","wrappedFunction","newFunction","returnOnThisValue","EventGenerator","_this","_listeners","eventsSuspended","tick","eventsToDieOn","queue","listener","__jsPlumb","fire","_gone","ret","shouldFireEvent","_drain","pop","eventOrListener","getListener","forEvent","setSuspendEvents","isSuspendEvents","silently","cleanupListeners","sizeElement","height","width","DEFAULT_OPTIONS","deriveAnchor","edge","ep","conn","bottom","ListManager","jsPlumbInstance","count","instance","lists","options","addList","listManager","removeList","scrollableLists","getSelector","_maybeUpdateParentList","source","jsPlumbListManager","dp","getInstanceIndex","join","List","_jsPlumbList","container","getContainer","_jsPlumbScrollHandler","anchor","deriveEndpoint","endpoint","_maybeUpdateDraggable","hasClass","recalculateOffsets","scrollHandler","elId","getId","_jsPlumbProxies","proxyConnection","endpoints","offsetHeight","unproxyConnection","revalidate","_ju","_timestamp","_updateHoverStyle","component","_jsPlumb","paintStyle","hoverPaintStyle","mergedHoverStyle","jsPlumb","fill","eventFilters","_updateAttachedElements","timestamp","sourceElement","affectedElements","getAttachedElements","_splitType","_mapType","typeId","_applyTypes","doNotRepaint","getDefaultType","getTypeDescriptor","defType","types","tid","getType","applyType","repaint","jsPlumbUIComponent","self","idPrefix","parameters","paintStyleInUse","beforeDetach","beforeDrop","overlayPlacements","Defaults","HoverClass","typeCache","cacheTypeItem","getCachedTypeItem","overlays","oo","defaultOverlayKeys","fo","convertToFullOverlaySpec","_defaultType","getDefaultScope","appendToDefaultType","create","isDetachAllowed","connection","isDropAllowed","sourceId","targetId","dropEndpoint","checkCondition","domListeners","setListenerComponent","_removeTypeCssHelper","typeIndex","cssClass","canvas","getParameter","setParameter","getParameters","setParameters","getClass","clazz","updateClasses","classesToAdd","classesToRemove","setType","clearTypes","reapplyTypes","hasType","addType","_cont","removeType","toggleType","setPaintStyle","setHoverPaintStyle","getPaintStyle","getHoverPaintStyle","ignoreAttachedElements","currentlyDragging","isHoverSuspended","method","isSuspendDrawing","recalc","_jsPlumbInstanceIndex","_defaults","Anchor","Anchors","ConnectionsDetachable","ConnectionOverlays","Connector","Container","DoNotThrowErrors","DragOptions","DropOptions","Endpoint","EndpointOverlays","Endpoints","EndpointStyle","EndpointStyles","EndpointHoverStyle","EndpointHoverStyles","HoverPaintStyle","LabelStyle","color","ListStyle","LogEnabled","Overlays","MaxConnections","PaintStyle","stroke","ReattachConnections","RenderMode","Scope","_connectionTypes","_endpointTypes","_currentInstance","_instanceIndex","_bb","_initialDefaults","_info","nodeType","text","getElement","_getId","repaintEverything","_container","_containerDelegations","unbindContainer","setContainer","moveParent","selectEndpoints","previousContainer","eventAliases","_oneDelegateHandler","componentType","jp","alias","_addOneDelegate","_oneDelegate","managedElements","initialized","importDefaults","restoreDefaults","connections","endpointsByElement","endpointsByUUID","offsets","offsetTimestamps","draggableStates","connectionBeingDragged","sizes","_suspendDrawing","_suspendedAt","DEFAULT_SCOPE","_curIdStamp","_idstamp","_appendElement","appendToRoot","_draw","element","ui","clearEdits","repaintEls","_updateOffset","offset","anchorManager","redraw","_getEndpoint","_scopeMatch","e1","e2","s1","s2","_mergeOverrides","_prepareConnectionParams","referenceParams","sourceEndpoint","targetEndpoint","uuids","isFull","connectionType","connectorOverlays","connectorPointerEvents","_addEndpoint","anchors","endpointStyles","endpointStyle","endpointHoverStyles","endpointHoverStyle","addEndpoint","_oneElementDef","defs","matchType","newConnection","tep","epDef","label","newEndpoint","uniqueEndpoint","setDeleteOnEmpty","finalEndpoint","sourceEndpointDefinitions","targetEndpointDefinitions","_newConnection","connectionFunc","ConnectionType","getDefaultConnectionType","_newEndpoint","finaliseConnection","_finaliseConnection","con","isDetachable","initDraggable","jpc","doInformAnchorManager","suspendedEndpoint","pending","isTemporarySource","router","doNotFireConnectionEvent","eventArgs","endpointFunc","EndpointType","fireDetachEvent","elementId","_manage","headless","getDragManager","endpointAdded","_operation","func","ii","jj","_setDraggable","isDragSupported","setElementDraggable","_setVisible","alsoChangeEndpoints","setVisible","info","oidx","isVisible","_toggleVisible","changeEndpoints","_getCachedData","doNotCreateIfNotFound","undefined","setConnectionBeingDragged","isConnectionBeingDragged","getManagedElements","connectorClass","connectorOutlineClass","connectedClass","endpointClass","endpointConnectedClass","endpointFullClass","endpointDropAllowedClass","endpointDropForbiddenClass","overlayClass","draggingClass","elementDraggingClass","sourceElementDraggingClass","targetElementDraggingClass","endpointAnchorClassPrefix","hoverSourceClass","hoverTargetClass","dragSelectClass","Connectors","ConnectorRenderers","SVG","results","inputs","_ensureContainer","myOffset","paint","anchorLoc","compute","xy","wh","addEndpoints","animate","properties","animationSupported","del","stepFunction","animEvents","step","completeFunction","complete","doAnimate","conditionName","connect","stTypes","epDefs","_set","_st","cId","cEl","sid","sep","oldEndpoint","evtParams","originalSourceId","newSourceId","originalTargetId","newTargetId","addConnection","makeEndpoint","detachFromConnection","fireMoveEvent","setSource","sourceOrTargetChanged","setTarget","deleteEndpoint","object","dontUpdateHover","deleteAttachedObjects","deleteObject","deleteEveryEndpoint","_is","setSuspendDrawing","dm","doFireEvent","connType","argIsConnection","connectionDetached","unregisterEndpoint","newEndpoints","IS_DETACH_ALLOWED","BEFORE_DETACH","CHECK_CONDITION","deleteConnection","cleanup","deleteEveryConnection","deletedCount","batch","deleteConnectionsForElement","endpointCount","connectionCount","unravelConnection","unravelEndpoint","doNotCleanup","_setOperation","_getOperation","setter","getter","prepareList","input","doNotGetIds","filterList","missingIsFalse","getConnections","flat","sources","targets","_addOne","ss","proxies","originalEp","_curryEach","executor","_curryGet","_makeCommonSelectHandler","get","setters","getters","_makeConnectionSelectHandler","common","setDetachable","setReattach","setConnector","isReattach","_makeEndpointSelectHandler","setAnchor","noElementFilters","elements","either","sourceMatchExact","targetMatchExact","inner","_ep","noMatchSource","isSource","noMatchTarget","isTarget","getAllConnections","getEndpoint","getEndpoints","getDefaultEndpointType","Connection","draw","appendElement","_hoverSuspended","setHoverSuspended","hide","idstamp","candidate","can","offsetParent","_getContainerFromDefaults","manage","_transient","_recalc","_unmanage","unmanage","getOffset","centerx","centery","updateOffset","DefaultRouter","makeAnchor","pp","_a","specimen","newAnchor","getOrientation","DynamicAnchor","anchorParams","orientation","makeAnchors","makeDynamicAnchor","anchorSelector","selectorFilter","_instance","negate","ok","_makeElementDropHandler","elInfo","dropOptions","proxyComponent","_drop","EndpointDropHandler","targetCount","maxConnections","onDrop","unlock","isRedrop","suspendedElement","eps","deriveEndpointAndAnchorSpec","_mtNew","positionFinder","dropPosition","getUIPosition","elPosition","elSize","ap","constructorParams","maybeCleanup","dropEvent","dragEvents","_drag","de","_jsPlumbRelatedElement","initDroppable","makeTarget","_doOne","elid","_isJsPlumbGroup","createEndpoint","targetDef","unmakeTarget","doNotClearArrays","makeSource","aae","onMaxConnections","_del","stopEvent","dragEvent","dragOptions","existingStop","endpointAddedButNoDragYet","anchorDef","oldAnchor","oldConnection","mouseDownListener","sourceCount","elxy","getPositionOnElement","tempEndpointParams","_delTempEndpoint","extract","att","setDragFilter","unmakeSource","eldefs","unmakeEverySource","_getScope","_setScope","getScope","getSourceScope","getTargetScope","setSourceScope","setTargetScope","setDragScope","setDropScope","unmakeEveryTarget","_setEnabled","toggle","originalState","newState","_first","toggleSourceEnabled","isSourceEnabled","setSourceEnabled","toggleTargetEnabled","isTargetEnabled","setTargetEnabled","ready","_elEach","isIdAlready","updateOffsets","removeAllEndpoints","recurse","ebe","childNodes","_doRemove","floatingConnections","removeElement","ae","empty","dontRemoveFocus","doNotUnbindInstanceEventListeners","removeAllGroups","removeGroupManager","doReset","_clearObject","clear","setDefaultScope","dontPrependDefault","bits","as","setId","newId","doNotSetAttribute","sConns","tConns","setElementId","setReferenceElement","changeId","_conns","epIdx","setDebugLog","debugLog","repaintAfterwards","curVal","getSuspendedAt","doNotRepaintAfterwards","_wasSuspended","doWhileSuspended","getCachedData","show","toggleVisible","addListener","registerFloatingConnection","getFloatingConnectionFor","registerConnectionType","to","registerConnectionTypes","registerEndpointType","registerEndpointTypes","typeDescriptor","setIdChanged","oldId","setParent","newParent","_dom","_id","_pdom","_pid","o1","o2","names","getFloatingAnchorIndex","isFloating","proxyEl","proxyElId","endpointGenerator","anchorGenerator","proxyEp","originalElementId","originalEndpoint","isProxyEndpoint","originalElement","getInstance","overrideFns","ovf","_jp","_internalLabelOverlayId","_makeLabelOverlay","_params","labelStyle","mergedParams","getRenderMode","Label","_processOverlay","_newOverlay","OverlayCapableJsPlumbUIComponent","overlayPositions","labelLocation","defaultLabelLocation","keep","existing","updateFrom","reattach","addOverlay","removeOverlay","overlay","getData","locationAttribute","labelLocationAttribute","loc","getOverlay","getOverlays","hideOverlay","hideOverlays","showOverlay","showOverlays","removeAllOverlays","overlayId","dontCleanup","removeOverlays","bgCanvas","isAppendedAtTopLevel","getLabel","lo","getLabelOverlay","setLabel","Function","setLocation","setAbsoluteOverlayPosition","getAbsoluteOverlayPosition","_clazzManip","action","dontUpdateOverlays","_makeConnectionDragHandler","placeholder","stopped","_ui","anchorPoint","getCurrentLocation","stopDrag","_makeDraggablePlaceholder","ipco","ips","createElement","_makeFloatingEndpoint","referenceAnchor","referenceCanvas","floatingAnchor","FloatingAnchor","reference","typeParameters","findConnectionToUseForDynamicAnchor","elementWithPrecedence","connectorStyle","connectorHoverStyle","connectorHoverClass","connector","connectorTooltip","visible","floatingEndpoint","inPlaceCopy","dragProxy","connectionCost","connectionsDirected","currentAnchorClass","deleteOnEmpty","_updateAnchorClass","oldAnchorClass","getCssClass","anchorClass","prepareAnchor","currentAnchor","setPreparedAnchor","continuousAnchorFactory","internalHover","add","prepareEndpoint","rm","endpointArgs","tooltip","setEndpoint","setPreparedEndpoint","reattachConnections","connectionsDetachable","detachable","dragAllowedWhenFull","detachFrom","setElement","parentId","curId","rehomeEndpoint","dragManager","makeInPlaceCopy","acc","inPlaceAnchor","hideOnDrag","connectorSelector","setStyle","connectorPaintStyle","dimensions","isDynamic","oIdx","oId","oInfo","oOffset","oWH","txy","twh","tElement","draggingInitialised","placeholderInfo","existingJpc","existingJpcParams","_dragHandler","defaultOpts","startEvent","beforeStartEvent","beforeStartParams","startParams","beforeDrag","canvasElement","setAttributes","endpointToFloat","centerAnchor","_savedAnchor","data","anchorIdx","dragScope","getDragScope","suspendedElementId","suspendedElementType","referenceEndpoint","getDropEvent","deleteConnectionNow","floatingElement","floatingId","floatingIndex","fe","_forceReattach","_forceDetach","deleteAfterDragStop","visibility","anchorParamsToUse","_initDropTarget","isTransient","isDropSupported","overEvent","outEvent","dhParams","getDragObject","_jpc","bb","doNotChangeConnections","doNotNotifyOtherEndpoint","display","isConnectedTo","found","getConnectionCost","setConnectionCost","areConnectionsDirected","setConnectionsDirected","_elId","setDragAllowedWhenFull","allowed","equals","getUuid","computeAnchor","existingConnection","_doContinue","continueFunction","optionalData","aParam","originalSourceEndpoint","newSourceEndpoint","originalTargetEndpoint","newTargetEndpoint","_toDelete","mergeData","dontContinueFunction","makeConnector","renderMode","connectorName","connectorArgs","forComponent","_makeAnchor","_updateConnectedClass","_jsPlumbConnections","previousConnection","editorParams","lastPaintedAt","definition","eS","eT","deleteEndpointsOnEmpty","_detachable","_reattach","myInfo","myWH","otherInfo","otherOffset","otherWH","initialTimestamp","cost","directed","setData","_types","updateConnectedClass","typeMap","_connector","prepareConnector","setPreparedConnector","_anchors","informEndpoints","getUuids","getCost","setCost","isDirected","getConnector","connectorSpec","doNotChangeListenerComponent","previous","previousClasses","transfer","swap","tId","sId","tIdx","sIdx","sourceInfo","targetInfo","sE","tE","sAnchorP","tAnchorP","resetBounds","sourcePos","targetPos","sourceOrientation","targetOrientation","strokeWidth","extents","xmin","bounds","minX","ymin","minY","xmax","maxX","ymax","maxY","paintExtents","es","outlineStroke","outlineWidth","ehs","u","drawEndpoints","replaceEndpoint","endpointDef","current","_idx","_new","AnchorManager","_amEndpoints","continuousAnchorLocations","continuousAnchorOrientations","connectionsByElementId","anchorLists","placeAnchorsOnLine","desc","elementDimensions","elementPosition","horizontal","otherMultiplier","reverse","other","xp","yp","rightAndBottomSort","leftAndTopSort","edgeSortFunctions","_sortHelper","_array","placeAnchors","_anchorLists","cd","sS","sO","placeSomeAnchors","unsortedConnections","isHorizontal","sc","_setAnchorLocation","anchorPos","weAreSource","weAreTarget","addFloatingConnection","doRegisterTarget","registerConnection","otherIndex","otherEndpoint","otherAnchor","isContinuous","removeEndpointFromAnchorLists","eId","connInfo","doNotRedraw","removeConnection","getConnectionsFor","getEndpointsFor","_updateAnchorList","aBoolean","otherElId","edgeId","connsToPaint","endpointsToPaint","exactIdx","firstMatchingElIdx","endpointId","listToAddTo","listToRemoveFrom","_continuousAnchorEdge","rIdx","insertIdx","originalId","newElement","anchorIndex","sourceElId","sIndex","tIndex","currentId","offsetToUI","doNotRecalcEndpoint","endpointConnections","connectionsToPaint","anchorsToUpdate","orientationCache","sourceContinuous","targetContinuous","oKey","sd","calculateOrientation","getDefaultFace","fc","ContinuousAnchor","faces","clockwise","availableFaces","opposites","clockwiseOptions","antiClockwiseOptions","secondBest","lastChoice","_currentFace","_lockedFace","X_AXIS_FACES","Y_AXIS_FACES","_lockedAxis","isRelocatable","isSnapOnRelocate","verifyEdge","isEdgeSupported","setCurrentFace","face","overrideLock","getCurrentFace","getSupportedFaces","af","lock","isLocked","lockCurrentAxis","unlockCurrentAxis","sourceAnchor","targetAnchor","Orientation","HORIZONTAL","VERTICAL","DIAGONAL","IDENTITY","axes","atan2","midpoints","dim","sf","tf","sourceEdge","targetEdge","userDefinedLocation","lastReturnValue","relocatable","setRelocatable","_relocatable","snapOnRelocate","locked","clearUserDefinedLocation","ox","oy","ao","getUserDefinedLocation","setUserDefinedLocation","ref","refCanvas","xDir","yDir","_lastResult","_endpoint","_convertAnchor","getAnchors","_curAnchor","_lastAnchor","_distance","cx","cy","ax","ay","acx","acy","_anchorSelector","minIdx","minDist","udl","setAnchorCoordinates","coords","_curryAnchor","fnInit","DynamicAnchors","AutoDefault","_curryContinuousAnchor","Continuous","pf","AnchorPositionFinders","gx","gy","mx","my","Perimeter","anchorCount","shape","Error","_circle","_path","segments","anchorsPerFace","_computeFace","fractionalLength","_shape","_rectangle","_shapes","points","tl","_rotate","amountInDegrees","da","rotation","_jg","Segments","AbstractSegment","findClosestPointOnPath","getBounds","Straight","_super","m2","getGradient","getCoordinates","setCoordinates","pointOnPath","absolute","_","pointAlongPathFrom","farAwayPoint","within","closest","_x1","_y1","fractionInSegment","_pointLiesBetween","_plb","_x2","_y2","m1","X","Y","Arc","_calcAngle","_calcAngleForLocation","segment","anticlockwise","sa","startAngle","endAngle","TWO_PI","ea","radius","ac","sweep","circumference","frac","VERY_SMALL_VALUE","gentleRound","ceil","angle","arcSpan","dir","startX","startY","Bezier","cp1x","cp1y","cp2x","cp2y","_compute","EMPTY_POINT","_getLUT","steps","_computeLength","_translateLocation","_curve","SegmentRenderer","getPath","isFirstSegment","laf","AbstractComponent","AbstractConnector","totalLength","segmentProportions","segmentProportionalLengths","stub","sourceStub","targetStub","gap","sourceGap","targetGap","userProvidedSegments","paintInfo","getPathData","findSegmentForPoint","connectorLocation","_updateSegmentProportions","_findSegmentForLocation","inSegmentProportion","proportion","_addSegment","updateBounds","_clearSegments","setSegments","_segs","_prepareCompute","swapX","swapY","lw","so","oIndex","sx","sy","oProduct","xSpan","ySpan","startStubX","startStubY","endStubX","endStubY","isXGreaterThanStubTimes2","isYGreaterThanStubTimes2","opposite","perpendicular","orthogonal","sourceAxis","stubs","anchorOrientation","getSegments","segBounds","dumpSegmentsToConsole","seg","addSegment","prepareCompute","maxStub","maxGap","AbstractEndpoint","Dot","defaultOffset","defaultInnerRadius","Rectangle","DOMElementEndpoint","displayElements","getDisplayElements","appendDisplayElement","Image","_onload","onload","src","url","img","deleted","widthToUse","heightToUse","setImage","_img","margin","padding","outline","actuallyPaint","Blank","background","Triangle","AbstractOverlay","endpointLoc","endpointLocation","incrementLocation","amount","getLocation","Arrow","foldback","computeMaxSize","elementCreated","currentConnectionPaintStyle","hxy","mid","tail","cxy","parseInt","fromLoc","__","lineWidth","PlainArrow","Diamond","_getDimensions","forceRefresh","cachedDimensions","getDimensions","AbstractDOMOverlay","detached","div","initialised","initiallyInvisible","webkitTransform","mozTransform","msTransform","oTransform","transform","absolutePosition","locToUse","minx","miny","clearCachedDimensions","containerExtents","Custom","GuideLines","tailLine","headLine","labelWidth","labelHeight","labelText","labelPadding","font","borderWidth","dStyle","borderStyle","border","update","lt","innerHTML","_jpi","GROUP_COLLAPSED_CLASS","GROUP_EXPANDED_CLASS","GROUP_CONTAINER_SELECTOR","ELEMENT_DRAGGABLE_EVENT","STOP","REVERT","GROUP_MANAGER","GROUP","GROUP_DRAG_SCOPE","EVT_CHILD_ADDED","EVT_CHILD_REMOVED","EVT_GROUP_ADDED","EVT_GROUP_REMOVED","EVT_EXPAND","EVT_COLLAPSE","EVT_GROUP_DRAG_STOP","EVT_CONNECTION_MOVED","EVT_INTERNAL_CONNECTION_DETACHED","CMD_REMOVE_ALL","CMD_ORPHAN_ALL","CMD_SHOW","CMD_HIDE","GroupManager","_managedGroups","_connectionSourceMap","_connectionTargetMap","isDescendant","parentEl","sourceGroup","getGroupFor","targetGroup","_cleanupDetachedConnection","group","connMap","addGroup","getEl","manager","_updateConnectionsForGroup","addToGroup","doNotFireEvent","getGroup","groupEl","currentGroup","_jsPlumbGroup","removeFromDragSelection","elpos","cpos","collapsed","getDragArea","updateConnectionsForGroup","handleDroppedConnections","_expandConnection","_collapseConnection","newPosition","revalidateParent","removeFromGroup","_expandSet","conns","proxiedElement","groupId","getGroups","removeGroup","deleteMembers","manipulateDOM","expandGroup","newPositions","_groups","otherEl","shouldProxy","groupElId","getAnchor","collapseGroup","_collapseSet","repaintGroup","getMembers","childMembers","processed","oneSet","gs","gt","refreshAllGroups","Group","ghost","orphan","prune","dropOverride","proxied","internal","endpointIndex","opts","overrideDrop","getGroupManager","els","dragArea","__el","isAlreadyDraggable","_bindDragHandlers","doNotUpdateConnections","_unbindDragHandlers","removeAll","orphanAll","orphanedPositions","_orphan","dragParams","_findParent","_isInsideParent","leftEdge","rightEdge","topEdge","bottomEdge","clearParent","_pruneOrOrphan","orphanedPosition","_revalidate","toggleGroup","mgr","STRAIGHT","ARC","Flowchart","midpoint","alwaysRespectStubs","lastx","lasty","lastOrientation","cornerRadius","loopbackRadius","isLoopbackCurrently","segmentDirections","lx","ly","segLength","_cloneArray","writeSegments","next","currentDirection","nextDirection","minSegLength","radiusToUse","sgny","sgnx","sgnEqual","commonStubCalculator","stubCalculators","pi","areInProximity","oss","oes","midx","midy","orientations","lineCalculators","sis","midLines","linesToEnd","startToEnd","startToMidToEnd","otherStubs","soIdx","toIdx","_so","_to","otherFlipped","stub1","stub2","segmentIndexes","startStub","otherStartStub","endStub","otherEndStub","extent","otherAxis","comparator","toUpperCase","_val","AbstractBezierConnector","showLoopback","curviness","proximityLimit","sp","tp","_w","_h","_computeBezier","loopback","majorAnchor","minorAnchor","getCurviness","_findControlPoint","sourceAnchorPosition","targetAnchorPosition","soo","too","_CP","_CP2","_sx","_sy","_tx","_ty","_segment","StateMachine","_controlPoint","_midx","_midy","svgAttributeMap","STROKE_DASHARRAY","DASHSTYLE","LINEAR_GRADIENT","RADIAL_GRADIENT","DEFS","FILL","STROKE","STROKE_WIDTH","STYLE","NONE","JSPLUMB_GRADIENT","LINE_WIDTH","ns","svg","_attr","node","attributes","_node","xmlns","createElementNS","_pos","_clearGradient","_updateGradient","uiComponent","gradientUnits","stops","styleToUse","stopColor","applyGradientTo","_applyStyles","parts","forEach","_appendAtIndex","insertBefore","attr","SvgComponent","pointerEventsSpec","renderer","originalArgs","svgParams","useDivWrapper","className","outlineStyle","outlineStrokeWidth","bgPath","SvgEndpoint","makeNode","updateNode","AbstractSvgArrowOverlay","superclass","makePath","isNaN","svgProtoFunctions","p1_1","p1_2","attachListeners","_jk","_getEventManager","_mottle","_getDragManager","category","getEventManager","scrollWidth","scrollHeight","relativeToRoot","_dragStart","_jsPlumbDragOptions","cont","_dragMove","_dragging","_dragStop","uip","dragEnded","_animProps","pName","DragManager","_draggables","_dlist","_delements","_elementsWithEndpoints","_draggablesForElements","register","parentOffset","_oneLevel","cid","cOff","childOffsetOverrides","domEl","cel","pid","pLoc","cLoc","endpointDeleted","getElementsForDraggable","ancestor","pId","currentChildLocation","childOffset","co","getDragAncestor","aid","_setClassName","cn","classList","baseVal","_getClassName","_classManip","curClasses","classes","screenLocation","clientLocation","tag","atts","attName","getRenderModes","contains","toggleClass","toAdd","toRemove","setClass","prop","getStyle","getComputedStyle","getPropertyValue","currentStyle","op","_maybeAdjustScroll","zoom","pst","psl","offsetWidth","getAbsolutePosition","setAbsolutePosition","animateFrom","animateOptions","getWidth","getHeight","_initDraggableIfNecessary","_oneEl","_me","mel","unbindDraggable","setDraggable","_draggableStates","toggleDraggable","isDraggable","_draggable","disabled","enctype","ldist","tdist","duration","linc","tinc","_int","setInterval","clearInterval","unbindDroppable","isElementDraggable","oc","specs","addToDragSelection","getDragSelection","clearDragSelection","callback","_do","readyState","_c0","loadedMonaco","loadPromise","BaseEditor","config","onInit","then","initMonaco","_options","Promise","resolve","baseUrl","monaco","onGotAmdLoader","require","paths","onMonacoLoad","loaderScript","_windowResizeSubscription","unsubscribe","_editor","dispose","ɵfac","BaseEditor_Factory","ɵdir","viewQuery","BaseEditor_Query","rf","_editorContainer","first","outputs","NGX_MONACO_EDITOR_CONFIG","EditorComponent_1","EditorComponent","zone","editorConfig","_value","propagateChange","onTouched","setValue","hasModel","editor","getModel","uri","createModel","language","nativeElement","onDidChangeModelContent","run","onDidBlurEditorWidget","subscribe","layout","emit","assign","defaultOptions","EditorComponent_Factory","ɵcmp","selectors","features","provide","useExisting","multi","decls","vars","consts","template","EditorComponent_Template","styles","ctorParameters","decorators","DiffEditorComponent","_originalModel","_modifiedModel","originalModel","code","modifiedModel","theme","createDiffEditor","setModel","original","modified","DiffEditorComponent_Factory","DiffEditorComponent_Template","MonacoEditorModule_1","MonacoEditorModule","ngModule","providers","useValue","ɵmod","ɵinj","factory","MonacoEditorModule_Factory","imports","ngJitMode","declarations","DesignBlockTypesComponent","templateUrl","styleUrls","DesignBlocksComponent","DesignCustomIconsComponent","DesignHomeComponent","DesignProvidersComponent","routes","pathMatch","redirectTo","DesignRoutingModule","forChild","DesignWorkflowEditorComponent","dataService","nodeService","activatedRoute","authService","treelistsvc","editorOptions","treeLists","nodes","loading","showNodeConfig","currentNode","showNodeDetails","currentNodeDetails","blocks$","records$","pipe","workflow","findRecords","parent_workflow","res","nodeCount","treeToggler$","status","currentlySelectedTree","currentlySelectedTreeId","clearHiddenChildren","setCurrentlySelectedTree","getRecord","wf","node_connections","saveWorkflow","read","DesignWorkflowNodeComponent","ticks","hideChilrenToggler$","hideChildrenList","hideChildrenOfIds","hoverNodeToggler$","currentlyHoveringId","showDetails","hideNodeChilren","nodeID","selectedNode","mouseDownX","mouseDownY","setCurrentlyHoveringId","includes","createRecord","parent_activity","addChild","blockData","dragDataTransfer","_type","parent_block","icon","DesignWorkflowPaletteComponent","DesignWorkflowTreeComponent","sanitizer","DesignWorkflowsComponent","DesignComponent","files","activeDemoVariant","droppedFiles","directoryName","fileName","indexInFiles","newNode","node_type","description","dropPointPosition","addDynamicNode","updateRecord","DesignModule","forRoot","entryComponents","NodeComponent","joinstyle","sourceAnchors","metaKey","alert","_addEndpoints","toId","targetAnchors","sourceUUID","targetUUID","handleClick","loadNodeDetails","encapsulation","None","NodeService","factoryResolver","showNodeDetails$","asObservable","currentNodeDetails$","cursor","zIndex","viewContainerRef","rootViewContainer","resolveComponentFactory","parentInjector","insert","hostView","NodesContainerComponent","setRootViewContainerRef","nodesAdded","json","JSON","stringify","saveNodeJson","TreelistService","treeToggler","hideChilrenToggler","hoverNodeToggler","treelist","childArray","getChildrenOfID","tree","stack","providedIn","WorkflowNodeDetailsComponent","node_vars","parentVariables$","parent$","record$","deleteRecord","err","WorkflowStudioRootComponent"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiEA,KAAC,YAAW;AAER,UAAIA,IAAI,GAAG,IAAX;;AAEA,UAAG,OAAOC,IAAI,CAACC,GAAZ,IAAmB,WAAtB,EAAmC;AAC/BD,YAAI,CAACC,GAAL,GAAW,UAASC,CAAT,EAAY;AAAE,iBAAOA,CAAC,IAAI,CAAL,GAAS,CAAT,GAAaA,CAAC,GAAG,CAAJ,GAAQ,CAAR,GAAW,CAAC,CAAhC;AAAoC,SAA7D;AACH;;AAED,UAAIC,OAAO,GAAG;AACNC,gBAAQ,EAAK,kBAASC,EAAT,EAAaC,EAAb,EAAiB;AAAE,iBAAO;AAACJ,aAAC,EAACG,EAAE,CAACH,CAAH,GAAOI,EAAE,CAACJ,CAAb;AAAgBK,aAAC,EAACF,EAAE,CAACE,CAAH,GAAOD,EAAE,CAACC;AAA5B,WAAP;AAAyC,SADnE;AAENC,kBAAU,EAAI,oBAASH,EAAT,EAAaC,EAAb,EAAiB;AAAE,iBAAQD,EAAE,CAACH,CAAH,GAAOI,EAAE,CAACJ,CAAX,GAAkBG,EAAE,CAACE,CAAH,GAAOD,EAAE,CAACC,CAAnC;AAAwC,SAFnE;AAGNE,cAAM,EAAI,gBAASC,CAAT,EAAY;AAAE,iBAAOV,IAAI,CAACW,IAAL,CAAWD,CAAC,CAACR,CAAF,GAAMQ,CAAC,CAACR,CAAT,GAAeQ,CAAC,CAACH,CAAF,GAAMG,CAAC,CAACH,CAAjC,CAAP;AAA8C,SAHhE;AAINK,aAAK,EAAI,eAASF,CAAT,EAAYG,CAAZ,EAAe;AAAE,iBAAO;AAACX,aAAC,EAACQ,CAAC,CAACR,CAAF,GAAMW,CAAT;AAAYN,aAAC,EAACG,CAAC,CAACH,CAAF,GAAMM;AAApB,WAAP;AAAiC;AAJrD,OAAd;AAAA,UAOIC,YAAY,GAAG,EAPnB;AAAA,UAQIC,iBAAiB,GAAGf,IAAI,CAACgB,GAAL,CAAS,GAAT,EAAa,CAACF,YAAD,GAAc,CAA3B,CARxB;AAUA;;;;;;;;;;;AAUA,UAAIG,kBAAkB,GAAG,SAArBA,kBAAqB,CAASC,KAAT,EAAgBC,KAAhB,EAAuB;AAC5C,YAAIC,UAAU,GAAG,EAAjB;AAAA,YACIC,CAAC,GAAGC,gBAAgB,CAACJ,KAAD,EAAQC,KAAR,CADxB;AAAA,YAEII,MAAM,GAAGJ,KAAK,CAACK,MAAN,GAAe,CAF5B;AAAA,YAE+BC,YAAY,GAAI,IAAIF,MAAL,GAAe,CAF7D;AAAA,YAGIG,YAAY,GAAGC,UAAU,CAACN,CAAD,EAAII,YAAJ,EAAkBL,UAAlB,EAA8B,CAA9B,CAH7B;AAAA,YAIIV,CAAC,GAAGP,OAAO,CAACC,QAAR,CAAiBc,KAAjB,EAAwBC,KAAK,CAAC,CAAD,CAA7B,CAJR;AAAA,YAI2CS,IAAI,GAAGzB,OAAO,CAACM,MAAR,CAAeC,CAAf,CAJlD;AAAA,YAIqEmB,CAAC,GAAG,GAJzE;;AAMA,aAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGJ,YAApB,EAAkCI,CAAC,EAAnC,EAAuC;AACnCpB,WAAC,GAAGP,OAAO,CAACC,QAAR,CAAiBc,KAAjB,EAAwBa,OAAO,CAACZ,KAAD,EAAQI,MAAR,EAAgBH,UAAU,CAACU,CAAD,CAA1B,EAA+B,IAA/B,EAAqC,IAArC,CAA/B,CAAJ;AACA,cAAIE,OAAO,GAAG7B,OAAO,CAACM,MAAR,CAAeC,CAAf,CAAd;;AACA,cAAIsB,OAAO,GAAGJ,IAAd,EAAoB;AAChBA,gBAAI,GAAGI,OAAP;AACAH,aAAC,GAAGT,UAAU,CAACU,CAAD,CAAd;AACH;AACJ;;AACDpB,SAAC,GAAGP,OAAO,CAACC,QAAR,CAAiBc,KAAjB,EAAwBC,KAAK,CAACI,MAAD,CAA7B,CAAJ;AACAS,eAAO,GAAG7B,OAAO,CAACM,MAAR,CAAeC,CAAf,CAAV;;AACA,YAAIsB,OAAO,GAAGJ,IAAd,EAAoB;AAChBA,cAAI,GAAGI,OAAP;AACAH,WAAC,GAAG,GAAJ;AACH;;AACD,eAAO;AAACI,kBAAQ,EAACJ,CAAV;AAAaK,kBAAQ,EAACN;AAAtB,SAAP;AACH,OAtBD;AAuBA;;;;;AAGA,UAAIO,oBAAoB,GAAG,SAAvBA,oBAAuB,CAASjB,KAAT,EAAgBC,KAAhB,EAAuB;AAC9C,YAAIiB,EAAE,GAAGnB,kBAAkB,CAACC,KAAD,EAAQC,KAAR,CAA3B;;AACA,eAAO;AAACD,eAAK,EAACa,OAAO,CAACZ,KAAD,EAAQA,KAAK,CAACK,MAAN,GAAe,CAAvB,EAA0BY,EAAE,CAACH,QAA7B,EAAuC,IAAvC,EAA6C,IAA7C,CAAd;AAAkEA,kBAAQ,EAACG,EAAE,CAACH;AAA9E,SAAP;AACH,OAHD;;AAIA,UAAIX,gBAAgB,GAAG,SAAnBA,gBAAmB,CAASJ,KAAT,EAAgBC,KAAhB,EAAuB;AAC1C,YAAII,MAAM,GAAGJ,KAAK,CAACK,MAAN,GAAe,CAA5B;AAAA,YAA+BC,YAAY,GAAI,IAAIF,MAAL,GAAe,CAA7D;AAAA,YACIc,CAAC,GAAG,EADR;AAAA,YACYC,CAAC,GAAG,EADhB;AAAA,YACoBC,OAAO,GAAG,EAD9B;AAAA,YACkClB,CAAC,GAAG,EADtC;AAAA,YAEImB,CAAC,GAAG,CAAE,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,GAAhB,CAAF,EAAwB,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,GAAhB,CAAxB,EAA8C,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,GAAhB,CAA9C,CAFR;;AAIA,aAAK,IAAIV,CAAC,GAAG,CAAb,EAAgBA,CAAC,IAAIP,MAArB,EAA6BO,CAAC,EAA9B;AAAkCO,WAAC,CAACP,CAAD,CAAD,GAAO3B,OAAO,CAACC,QAAR,CAAiBe,KAAK,CAACW,CAAD,CAAtB,EAA2BZ,KAA3B,CAAP;AAAlC;;AACA,aAAK,IAAIY,CAAC,GAAG,CAAb,EAAgBA,CAAC,IAAIP,MAAM,GAAG,CAA9B,EAAiCO,CAAC,EAAlC,EAAsC;AAClCQ,WAAC,CAACR,CAAD,CAAD,GAAO3B,OAAO,CAACC,QAAR,CAAiBe,KAAK,CAACW,CAAC,GAAC,CAAH,CAAtB,EAA6BX,KAAK,CAACW,CAAD,CAAlC,CAAP;AACAQ,WAAC,CAACR,CAAD,CAAD,GAAO3B,OAAO,CAACS,KAAR,CAAc0B,CAAC,CAACR,CAAD,CAAf,EAAoB,GAApB,CAAP;AACH;;AACD,aAAK,IAAIW,GAAG,GAAG,CAAf,EAAkBA,GAAG,IAAIlB,MAAM,GAAG,CAAlC,EAAqCkB,GAAG,EAAxC,EAA4C;AACxC,eAAK,IAAIC,MAAM,GAAG,CAAlB,EAAqBA,MAAM,IAAInB,MAA/B,EAAuCmB,MAAM,EAA7C,EAAiD;AAC7C,gBAAI,CAACH,OAAO,CAACE,GAAD,CAAZ,EAAmBF,OAAO,CAACE,GAAD,CAAP,GAAe,EAAf;AACnBF,mBAAO,CAACE,GAAD,CAAP,CAAaC,MAAb,IAAuBvC,OAAO,CAACK,UAAR,CAAmB8B,CAAC,CAACG,GAAD,CAApB,EAA2BJ,CAAC,CAACK,MAAD,CAA5B,CAAvB;AACH;AACJ;;AACD,aAAKZ,CAAC,GAAG,CAAT,EAAYA,CAAC,IAAIL,YAAjB,EAA+BK,CAAC,EAAhC,EAAoC;AAChC,cAAI,CAACT,CAAC,CAACS,CAAD,CAAN,EAAWT,CAAC,CAACS,CAAD,CAAD,GAAO,EAAP;AACXT,WAAC,CAACS,CAAD,CAAD,CAAKvB,CAAL,GAAS,GAAT;AACAc,WAAC,CAACS,CAAD,CAAD,CAAK5B,CAAL,GAASyC,UAAU,CAACb,CAAD,CAAV,GAAgBL,YAAzB;AACH;;AACD,YAAImB,CAAC,GAAGrB,MAAR;AAAA,YAAgBsB,CAAC,GAAGtB,MAAM,GAAC,CAA3B;;AACA,aAAK,IAAIuB,CAAC,GAAG,CAAb,EAAgBA,CAAC,IAAIF,CAAC,GAAGC,CAAzB,EAA4BC,CAAC,EAA7B,EAAiC;AAC7B,cAAIC,EAAE,GAAG/C,IAAI,CAACgD,GAAL,CAAS,CAAT,EAAYF,CAAC,GAAGD,CAAhB,CAAT;AAAA,cACII,EAAE,GAAGjD,IAAI,CAACkD,GAAL,CAASJ,CAAT,EAAYF,CAAZ,CADT;;AAEA,eAAKd,CAAC,GAAGiB,EAAT,EAAajB,CAAC,IAAImB,EAAlB,EAAsBnB,CAAC,EAAvB,EAA2B;AACvB,gBAAIqB,CAAC,GAAGL,CAAC,GAAGhB,CAAZ;AACAT,aAAC,CAACS,CAAC,GAACqB,CAAH,CAAD,CAAO5C,CAAP,IAAYgC,OAAO,CAACY,CAAD,CAAP,CAAWrB,CAAX,IAAgBU,CAAC,CAACW,CAAD,CAAD,CAAKrB,CAAL,CAA5B;AACH;AACJ;;AACD,eAAOT,CAAP;AACH,OA/BD;AAgCA;;;;;AAGA,UAAIM,UAAU,GAAG,SAAbA,UAAa,CAASN,CAAT,EAAYE,MAAZ,EAAoBM,CAApB,EAAuBuB,KAAvB,EAA8B;AAC3C,YAAIC,IAAI,GAAG,EAAX;AAAA,YAAeC,KAAK,GAAG,EAAvB;AAAA,YACIC,UADJ;AAAA,YACgBC,WADhB;AAAA,YAEIC,MAAM,GAAG,EAFb;AAAA,YAEiBC,OAAO,GAAG,EAF3B;;AAIA,gBAAQC,iBAAiB,CAACtC,CAAD,EAAIE,MAAJ,CAAzB;AACI,eAAK,CAAL;AAAS;AACL,qBAAO,CAAP;AACH;;AACD,eAAK,CAAL;AAAS;AACL,kBAAI6B,KAAK,IAAItC,YAAb,EAA2B;AACvBe,iBAAC,CAAC,CAAD,CAAD,GAAO,CAACR,CAAC,CAAC,CAAD,CAAD,CAAKnB,CAAL,GAASmB,CAAC,CAACE,MAAD,CAAD,CAAUrB,CAApB,IAAyB,GAAhC;AACA,uBAAO,CAAP;AACH;;AACD,kBAAI0D,aAAa,CAACvC,CAAD,EAAIE,MAAJ,CAAjB,EAA8B;AAC1BM,iBAAC,CAAC,CAAD,CAAD,GAAOgC,kBAAkB,CAACxC,CAAD,EAAIE,MAAJ,CAAzB;AACA,uBAAO,CAAP;AACH;;AACD;AACH;AAdL;;AAgBAQ,eAAO,CAACV,CAAD,EAAIE,MAAJ,EAAY,GAAZ,EAAiB8B,IAAjB,EAAuBC,KAAvB,CAAP;;AACAC,kBAAU,GAAI5B,UAAU,CAAC0B,IAAD,EAAQ9B,MAAR,EAAgBkC,MAAhB,EAAwBL,KAAK,GAAC,CAA9B,CAAxB;AACAI,mBAAW,GAAG7B,UAAU,CAAC2B,KAAD,EAAQ/B,MAAR,EAAgBmC,OAAhB,EAAyBN,KAAK,GAAC,CAA/B,CAAxB;;AACA,aAAK,IAAItB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGyB,UAApB,EAAgCzB,CAAC,EAAjC;AAAqCD,WAAC,CAACC,CAAD,CAAD,GAAO2B,MAAM,CAAC3B,CAAD,CAAb;AAArC;;AACA,aAAK,IAAIA,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG0B,WAApB,EAAiC1B,CAAC,EAAlC;AAAsCD,WAAC,CAACC,CAAC,GAACyB,UAAH,CAAD,GAAkBG,OAAO,CAAC5B,CAAD,CAAzB;AAAtC;;AACA,eAAQyB,UAAU,GAACC,WAAnB;AACH,OA3BD;;AA4BA,UAAIG,iBAAiB,GAAG,SAApBA,iBAAoB,CAASxC,KAAT,EAAgBI,MAAhB,EAAwB;AAC5C,YAAIuC,WAAW,GAAG,CAAlB;AAAA,YAAqBC,IAArB;AAAA,YAA2BC,QAA3B;AACAD,YAAI,GAAGC,QAAQ,GAAGhE,IAAI,CAACC,GAAL,CAASkB,KAAK,CAAC,CAAD,CAAL,CAASZ,CAAlB,CAAlB;;AACA,aAAK,IAAIuB,CAAC,GAAG,CAAb,EAAgBA,CAAC,IAAIP,MAArB,EAA6BO,CAAC,EAA9B,EAAkC;AAC9BiC,cAAI,GAAG/D,IAAI,CAACC,GAAL,CAASkB,KAAK,CAACW,CAAD,CAAL,CAASvB,CAAlB,CAAP;AACA,cAAIwD,IAAI,IAAIC,QAAZ,EAAsBF,WAAW;AACjCE,kBAAQ,GAAGD,IAAX;AACH;;AACD,eAAOD,WAAP;AACH,OATD;;AAUA,UAAIF,aAAa,GAAG,SAAhBA,aAAgB,CAASzC,KAAT,EAAgBI,MAAhB,EAAwB;AACxC,YAAK0C,KAAL,EACIC,WADJ,EACiBC,WADjB,EAC8BC,cAD9B,EAC8CC,eAD9C,EAEIC,CAFJ,EAEOC,CAFP,EAEUlC,CAFV,EAEamC,GAFb,EAEkBC,IAFlB,EAEwBC,EAFxB,EAE4BC,EAF5B,EAEgCC,EAFhC,EAEoCC,EAFpC,EAEwCC,EAFxC,EAE4CC,EAF5C;AAGAT,SAAC,GAAGnD,KAAK,CAAC,CAAD,CAAL,CAASZ,CAAT,GAAaY,KAAK,CAACI,MAAD,CAAL,CAAchB,CAA/B;AACAgE,SAAC,GAAGpD,KAAK,CAACI,MAAD,CAAL,CAAcrB,CAAd,GAAkBiB,KAAK,CAAC,CAAD,CAAL,CAASjB,CAA/B;AACAmC,SAAC,GAAGlB,KAAK,CAAC,CAAD,CAAL,CAASjB,CAAT,GAAaiB,KAAK,CAACI,MAAD,CAAL,CAAchB,CAA3B,GAA+BY,KAAK,CAACI,MAAD,CAAL,CAAcrB,CAAd,GAAkBiB,KAAK,CAAC,CAAD,CAAL,CAASZ,CAA9D;AAEA,YAAIyE,kBAAJ,EAAwBC,kBAAxB;AACAD,0BAAkB,GAAGC,kBAAkB,GAAG,GAA1C;;AAEA,aAAK,IAAInD,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGP,MAApB,EAA4BO,CAAC,EAA7B,EAAiC;AAC7B,cAAIoD,KAAK,GAAGZ,CAAC,GAAGnD,KAAK,CAACW,CAAD,CAAL,CAAS5B,CAAb,GAAiBqE,CAAC,GAAGpD,KAAK,CAACW,CAAD,CAAL,CAASvB,CAA9B,GAAkC8B,CAA9C;AACA,cAAI6C,KAAK,GAAGF,kBAAZ,EACIA,kBAAkB,GAAGE,KAArB,CADJ,KAEK,IAAIA,KAAK,GAAGD,kBAAZ,EACDA,kBAAkB,GAAGC,KAArB;AACP;;AAEDR,UAAE,GAAG,GAAL;AAAUC,UAAE,GAAG,GAAL;AAAUC,UAAE,GAAG,GAAL;AAAUC,UAAE,GAAGP,CAAL;AAAQQ,UAAE,GAAGP,CAAL;AACtCQ,UAAE,GAAG1C,CAAC,GAAG2C,kBAAT;AACAR,WAAG,GAAGE,EAAE,GAAGI,EAAL,GAAUD,EAAE,GAAGF,EAArB;AACAF,YAAI,GAAG,MAAID,GAAX;AACAN,mBAAW,GAAG,CAACS,EAAE,GAAGI,EAAL,GAAUD,EAAE,GAAGF,EAAhB,IAAsBH,IAApC;AACAI,UAAE,GAAGP,CAAL;AAAQQ,UAAE,GAAGP,CAAL;AAAQQ,UAAE,GAAG1C,CAAC,GAAG4C,kBAAT;AAChBT,WAAG,GAAGE,EAAE,GAAGI,EAAL,GAAUD,EAAE,GAAGF,EAArB;AACAF,YAAI,GAAG,MAAID,GAAX;AACAL,mBAAW,GAAG,CAACQ,EAAE,GAAGI,EAAL,GAAUD,EAAE,GAAGF,EAAhB,IAAsBH,IAApC;AACAL,sBAAc,GAAGpE,IAAI,CAACkD,GAAL,CAASgB,WAAT,EAAsBC,WAAtB,CAAjB;AACAE,uBAAe,GAAGrE,IAAI,CAACgD,GAAL,CAASkB,WAAT,EAAsBC,WAAtB,CAAlB;AACAF,aAAK,GAAGI,eAAe,GAAGD,cAA1B;AACA,eAAQH,KAAK,GAAGlD,iBAAT,GAA6B,CAA7B,GAAiC,CAAxC;AACH,OAhCD;;AAiCA,UAAI8C,kBAAkB,GAAG,SAArBA,kBAAqB,CAAS1C,KAAT,EAAgBI,MAAhB,EAAwB;AAC7C,YAAI4D,GAAG,GAAG,GAAV;AAAA,YAAeC,GAAG,GAAG,GAArB;AAAA,YACIC,GAAG,GAAGlE,KAAK,CAACI,MAAD,CAAL,CAAcrB,CAAd,GAAkBiB,KAAK,CAAC,CAAD,CAAL,CAASjB,CADrC;AAAA,YACwCoF,GAAG,GAAGnE,KAAK,CAACI,MAAD,CAAL,CAAchB,CAAd,GAAkBY,KAAK,CAAC,CAAD,CAAL,CAASZ,CADzE;AAAA,YAEIgF,GAAG,GAAGpE,KAAK,CAAC,CAAD,CAAL,CAASjB,CAAT,GAAa,GAFvB;AAAA,YAE4BsF,GAAG,GAAGrE,KAAK,CAAC,CAAD,CAAL,CAASZ,CAAT,GAAa,GAF/C;AAAA,YAGIiE,GAAG,GAAGa,GAAG,GAACD,GAAJ,GAAUE,GAAG,GAACH,GAHxB;AAAA,YAG6BM,MAAM,GAAG,MAAIjB,GAH1C;AAAA,YAIIkB,CAAC,GAAG,CAACL,GAAG,GAACG,GAAJ,GAAUF,GAAG,GAACC,GAAf,IAAsBE,MAJ9B;AAKA,eAAO,MAAMN,GAAG,GAAGO,CAAnB;AACH,OAPD;;AAQA,UAAI3D,OAAO,GAAG,SAAVA,OAAU,CAASZ,KAAT,EAAgBI,MAAhB,EAAwBM,CAAxB,EAA2BwB,IAA3B,EAAiCC,KAAjC,EAAwC;AAClD,YAAIqC,IAAI,GAAG,CAAC,EAAD,CAAX;;AACA,aAAK,IAAIxC,CAAC,GAAE,CAAZ,EAAeA,CAAC,IAAI5B,MAApB,EAA4B4B,CAAC,EAA7B;AAAiCwC,cAAI,CAAC,CAAD,CAAJ,CAAQxC,CAAR,IAAahC,KAAK,CAACgC,CAAD,CAAlB;AAAjC;;AACA,aAAK,IAAIrB,CAAC,GAAG,CAAb,EAAgBA,CAAC,IAAIP,MAArB,EAA6BO,CAAC,EAA9B,EAAkC;AAC9B,eAAK,IAAIqB,CAAC,GAAE,CAAZ,EAAgBA,CAAC,IAAI5B,MAAM,GAAGO,CAA9B,EAAiCqB,CAAC,EAAlC,EAAsC;AAClC,gBAAI,CAACwC,IAAI,CAAC7D,CAAD,CAAT,EAAc6D,IAAI,CAAC7D,CAAD,CAAJ,GAAU,EAAV;AACd,gBAAI,CAAC6D,IAAI,CAAC7D,CAAD,CAAJ,CAAQqB,CAAR,CAAL,EAAiBwC,IAAI,CAAC7D,CAAD,CAAJ,CAAQqB,CAAR,IAAa,EAAb;AACjBwC,gBAAI,CAAC7D,CAAD,CAAJ,CAAQqB,CAAR,EAAWjD,CAAX,GAAe,CAAC,MAAM2B,CAAP,IAAY8D,IAAI,CAAC7D,CAAC,GAAC,CAAH,CAAJ,CAAUqB,CAAV,EAAajD,CAAzB,GAA6B2B,CAAC,GAAG8D,IAAI,CAAC7D,CAAC,GAAC,CAAH,CAAJ,CAAUqB,CAAC,GAAC,CAAZ,EAAejD,CAA/D;AACAyF,gBAAI,CAAC7D,CAAD,CAAJ,CAAQqB,CAAR,EAAW5C,CAAX,GAAe,CAAC,MAAMsB,CAAP,IAAY8D,IAAI,CAAC7D,CAAC,GAAC,CAAH,CAAJ,CAAUqB,CAAV,EAAa5C,CAAzB,GAA6BsB,CAAC,GAAG8D,IAAI,CAAC7D,CAAC,GAAC,CAAH,CAAJ,CAAUqB,CAAC,GAAC,CAAZ,EAAe5C,CAA/D;AACH;AACJ;;AACD,YAAI8C,IAAI,IAAI,IAAZ,EACI,KAAKF,CAAC,GAAG,CAAT,EAAYA,CAAC,IAAI5B,MAAjB,EAAyB4B,CAAC,EAA1B;AAA8BE,cAAI,CAACF,CAAD,CAAJ,GAAWwC,IAAI,CAACxC,CAAD,CAAJ,CAAQ,CAAR,CAAX;AAA9B;AACJ,YAAIG,KAAK,IAAI,IAAb,EACI,KAAKH,CAAC,GAAG,CAAT,EAAYA,CAAC,IAAI5B,MAAjB,EAAyB4B,CAAC,EAA1B;AAA8BG,eAAK,CAACH,CAAD,CAAL,GAAWwC,IAAI,CAACpE,MAAM,GAAC4B,CAAR,CAAJ,CAAeA,CAAf,CAAX;AAA9B;AAEJ,eAAQwC,IAAI,CAACpE,MAAD,CAAJ,CAAa,CAAb,CAAR;AACH,OAjBD;;AAmBA,UAAIqE,mBAAmB,GAAG,EAA1B;;AACA,UAAIC,kBAAkB,GAAG,SAArBA,kBAAqB,CAASC,KAAT,EAAgB;AACrC,YAAIC,GAAG,GAAGH,mBAAmB,CAACE,KAAD,CAA7B;;AACA,YAAI,CAACC,GAAL,EAAU;AACNA,aAAG,GAAG,EAAN;;AACA,cAAIC,MAAM,GAAG,SAATA,MAAS,GAAW;AAAE,mBAAO,UAASnE,CAAT,EAAY;AAAE,qBAAO7B,IAAI,CAACgB,GAAL,CAASa,CAAT,EAAYiE,KAAZ,CAAP;AAA4B,aAAjD;AAAoD,WAA9E;AAAA,cACIG,MAAM,GAAG,SAATA,MAAS,GAAW;AAAE,mBAAO,UAASpE,CAAT,EAAY;AAAE,qBAAO7B,IAAI,CAACgB,GAAL,CAAU,IAAEa,CAAZ,EAAgBiE,KAAhB,CAAP;AAAgC,aAArD;AAAwD,WADlF;AAAA,cAEII,MAAM,GAAG,SAATA,MAAS,CAAS7D,CAAT,EAAY;AAAE,mBAAO,UAASR,CAAT,EAAY;AAAE,qBAAOQ,CAAP;AAAW,aAAhC;AAAmC,WAF9D;AAAA,cAGI8D,MAAM,GAAG,SAATA,MAAS,GAAW;AAAE,mBAAO,UAAStE,CAAT,EAAY;AAAE,qBAAOA,CAAP;AAAW,aAAhC;AAAmC,WAH7D;AAAA,cAIIuE,gBAAgB,GAAG,SAAnBA,gBAAmB,GAAW;AAAE,mBAAO,UAASvE,CAAT,EAAY;AAAE,qBAAO,IAAEA,CAAT;AAAa,aAAlC;AAAqC,WAJzE;AAAA,cAKIwE,SAAS,GAAG,SAAZA,SAAY,CAASC,KAAT,EAAgB;AACxB,mBAAO,UAASzE,CAAT,EAAY;AACf,kBAAI0E,CAAC,GAAG,CAAR;;AACA,mBAAK,IAAIzE,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGwE,KAAK,CAAC9E,MAA1B,EAAkCM,CAAC,EAAnC;AAAuCyE,iBAAC,GAAGA,CAAC,GAAGD,KAAK,CAACxE,CAAD,CAAL,CAASD,CAAT,CAAR;AAAvC;;AACA,qBAAO0E,CAAP;AACH,aAJD;AAKH,WAXL;;AAaAR,aAAG,CAACS,IAAJ,CAAS,IAAIR,MAAJ,EAAT,EAfM,CAemB;;AACzB,eAAK,IAAIlE,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGgE,KAApB,EAA2BhE,CAAC,EAA5B,EAAgC;AAC5B,gBAAIwE,KAAK,GAAG,CAAC,IAAIJ,MAAJ,CAAWJ,KAAX,CAAD,CAAZ;;AACA,iBAAK,IAAI3C,CAAC,GAAG,CAAb,EAAiBA,CAAC,GAAI2C,KAAK,GAAGhE,CAA9B,EAAkCqB,CAAC,EAAnC;AAAuCmD,mBAAK,CAACE,IAAN,CAAW,IAAIL,MAAJ,EAAX;AAAvC;;AACA,iBAAK,IAAIhD,CAAC,GAAG,CAAb,EAAiBA,CAAC,GAAGrB,CAArB,EAAwBqB,CAAC,EAAzB;AAA6BmD,mBAAK,CAACE,IAAN,CAAW,IAAIJ,gBAAJ,EAAX;AAA7B;;AACAL,eAAG,CAACS,IAAJ,CAAS,IAAIH,SAAJ,CAAcC,KAAd,CAAT;AACH;;AACDP,aAAG,CAACS,IAAJ,CAAS,IAAIP,MAAJ,EAAT,EAtBM,CAsBmB;;AAEzBL,6BAAmB,CAACE,KAAD,CAAnB,GAA6BC,GAA7B;AACH;;AAED,eAAOA,GAAP;AACH,OA9BD;AAiCA;;;;;;;AAKA,UAAIU,YAAY,GAAG,SAAfA,YAAe,CAAStF,KAAT,EAAgBc,QAAhB,EAA0B;AACzC,YAAIyE,EAAE,GAAGb,kBAAkB,CAAC1E,KAAK,CAACK,MAAN,GAAe,CAAhB,CAA3B;AAAA,YACImF,EAAE,GAAG,CADT;AAAA,YACYC,EAAE,GAAG,CADjB;;AAEA,aAAK,IAAI9E,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGX,KAAK,CAACK,MAA1B,EAAmCM,CAAC,EAApC,EAAwC;AACpC6E,YAAE,GAAGA,EAAE,GAAIxF,KAAK,CAACW,CAAD,CAAL,CAAS5B,CAAT,GAAawG,EAAE,CAAC5E,CAAD,CAAF,CAAMG,QAAN,CAAxB;AACA2E,YAAE,GAAGA,EAAE,GAAIzF,KAAK,CAACW,CAAD,CAAL,CAASvB,CAAT,GAAamG,EAAE,CAAC5E,CAAD,CAAF,CAAMG,QAAN,CAAxB;AACH;;AAED,eAAO;AAAC/B,WAAC,EAACyG,EAAH;AAAOpG,WAAC,EAACqG;AAAT,SAAP;AACH,OATD;;AAWA,UAAIC,KAAK,GAAG,SAARA,KAAQ,CAASC,EAAT,EAAYC,EAAZ,EAAgB;AACxB,eAAO/G,IAAI,CAACW,IAAL,CAAUX,IAAI,CAACgB,GAAL,CAAS8F,EAAE,CAAC5G,CAAH,GAAO6G,EAAE,CAAC7G,CAAnB,EAAsB,CAAtB,IAA2BF,IAAI,CAACgB,GAAL,CAAS8F,EAAE,CAACvG,CAAH,GAAOwG,EAAE,CAACxG,CAAnB,EAAsB,CAAtB,CAArC,CAAP;AACH,OAFD;;AAIA,UAAIyG,QAAQ,GAAG,SAAXA,QAAW,CAAS7F,KAAT,EAAgB;AAC3B,eAAOA,KAAK,CAAC,CAAD,CAAL,CAASjB,CAAT,KAAeiB,KAAK,CAAC,CAAD,CAAL,CAASjB,CAAxB,IAA6BiB,KAAK,CAAC,CAAD,CAAL,CAASZ,CAAT,KAAeY,KAAK,CAAC,CAAD,CAAL,CAASZ,CAA5D;AACH,OAFD;AAIA;;;;;;;AAKA,UAAI0G,eAAe,GAAG,SAAlBA,eAAkB,CAAS9F,KAAT,EAAgBc,QAAhB,EAA0BC,QAA1B,EAAoC;AAEtD,YAAI8E,QAAQ,CAAC7F,KAAD,CAAZ,EAAqB;AACjB,iBAAO;AACHD,iBAAK,EAACC,KAAK,CAAC,CAAD,CADR;AAEHc,oBAAQ,EAACA;AAFN,WAAP;AAIH;;AAED,YAAIiF,IAAI,GAAGT,YAAY,CAACtF,KAAD,EAAQc,QAAR,CAAvB;AAAA,YACIkF,KAAK,GAAG,CADZ;AAAA,YAEIC,MAAM,GAAGnF,QAFb;AAAA,YAGIoF,SAAS,GAAGnF,QAAQ,GAAG,CAAX,GAAe,CAAf,GAAmB,CAAC,CAHpC;AAAA,YAIIoF,GAAG,GAAG,IAJV;;AAMA,eAAOH,KAAK,GAAGnH,IAAI,CAACuH,GAAL,CAASrF,QAAT,CAAf,EAAmC;AAC/BkF,gBAAM,IAAK,QAAQC,SAAnB;AACAC,aAAG,GAAGb,YAAY,CAACtF,KAAD,EAAQiG,MAAR,CAAlB;AACAD,eAAK,IAAIN,KAAK,CAACS,GAAD,EAAMJ,IAAN,CAAd;AACAA,cAAI,GAAGI,GAAP;AACH;;AAED,eAAO;AAACpG,eAAK,EAACoG,GAAP;AAAYrF,kBAAQ,EAACmF;AAArB,SAAP;AACH,OAvBD;;AAyBA,UAAII,OAAO,GAAG,SAAVA,OAAU,CAASrG,KAAT,EAAgB;AAE1B,YAAImB,CAAC,GAAG,IAAImF,IAAJ,GAAWC,OAAX,EAAR;AAEA,YAAIV,QAAQ,CAAC7F,KAAD,CAAZ,EAAqB,OAAO,CAAP;;AAErB,YAAI+F,IAAI,GAAGT,YAAY,CAACtF,KAAD,EAAQ,CAAR,CAAvB;AAAA,YACIgG,KAAK,GAAG,CADZ;AAAA,YAEIC,MAAM,GAAG,CAFb;AAAA,YAGIC,SAAS,GAAG,CAHhB;AAAA,YAIIC,GAAG,GAAG,IAJV;;AAMA,eAAOF,MAAM,GAAG,CAAhB,EAAmB;AACfA,gBAAM,IAAK,QAAQC,SAAnB;AACAC,aAAG,GAAGb,YAAY,CAACtF,KAAD,EAAQiG,MAAR,CAAlB;AACAD,eAAK,IAAIN,KAAK,CAACS,GAAD,EAAMJ,IAAN,CAAd;AACAA,cAAI,GAAGI,GAAP;AACH;;AACDK,eAAO,CAACC,GAAR,CAAY,QAAZ,EAAsB,IAAIH,IAAJ,GAAWC,OAAX,KAAuBpF,CAA7C;AAEA,eAAO6E,KAAP;AACH,OArBD;AAuBA;;;;;AAGA,UAAIU,mBAAmB,GAAG,SAAtBA,mBAAsB,CAAS1G,KAAT,EAAgBc,QAAhB,EAA0BC,QAA1B,EAAoC;AAC1D,eAAO+E,eAAe,CAAC9F,KAAD,EAAQc,QAAR,EAAkBC,QAAlB,CAAf,CAA2ChB,KAAlD;AACH,OAFD;AAIA;;;;;AAGA,UAAI4G,sBAAsB,GAAG,SAAzBA,sBAAyB,CAAS3G,KAAT,EAAgBc,QAAhB,EAA0BC,QAA1B,EAAoC;AAC7D,eAAO+E,eAAe,CAAC9F,KAAD,EAAQc,QAAR,EAAkBC,QAAlB,CAAf,CAA2CD,QAAlD;AACH,OAFD;AAIA;;;;;;;AAKA,UAAI8F,gBAAgB,GAAG,SAAnBA,gBAAmB,CAAS5G,KAAT,EAAgBc,QAAhB,EAA0B;AAE7C,YAAI6E,EAAE,GAAGL,YAAY,CAACtF,KAAD,EAAQc,QAAR,CAArB;AAAA,YACI8E,EAAE,GAAGN,YAAY,CAACtF,KAAK,CAAC6G,KAAN,CAAY,CAAZ,EAAe7G,KAAK,CAACK,MAAN,GAAe,CAA9B,CAAD,EAAmCS,QAAnC,CADrB;AAAA,YAEIgG,EAAE,GAAGlB,EAAE,CAACxG,CAAH,GAAOuG,EAAE,CAACvG,CAFnB;AAAA,YAEsB2H,EAAE,GAAGnB,EAAE,CAAC7G,CAAH,GAAO4G,EAAE,CAAC5G,CAFrC;;AAIA,eAAO+H,EAAE,KAAK,CAAP,GAAWE,QAAX,GAAsBnI,IAAI,CAACoI,IAAL,CAAUH,EAAE,GAAGC,EAAf,CAA7B;AACH,OAPD;AASA;;;;;;;AAKA,UAAIG,6BAA6B,GAAG,SAAhCA,6BAAgC,CAASlH,KAAT,EAAgBc,QAAhB,EAA0BC,QAA1B,EAAoC;AACpE,YAAIqE,CAAC,GAAGU,eAAe,CAAC9F,KAAD,EAAQc,QAAR,EAAkBC,QAAlB,CAAvB;;AACA,YAAIqE,CAAC,CAACtE,QAAF,GAAa,CAAjB,EAAoBsE,CAAC,CAACtE,QAAF,GAAa,CAAb;AACpB,YAAIsE,CAAC,CAACtE,QAAF,GAAa,CAAjB,EAAoBsE,CAAC,CAACtE,QAAF,GAAa,CAAb;AACpB,eAAO8F,gBAAgB,CAAC5G,KAAD,EAAQoF,CAAC,CAACtE,QAAV,CAAvB;AACH,OALD;AAOA;;;;;;AAIA,UAAIqG,sBAAsB,GAAG,SAAzBA,sBAAyB,CAASnH,KAAT,EAAgBc,QAAhB,EAA0BT,MAA1B,EAAkCU,QAAlC,EAA4C;AACrEA,gBAAQ,GAAGA,QAAQ,IAAI,IAAZ,GAAmB,CAAnB,GAAuBA,QAAlC;;AACA,YAAIqE,CAAC,GAAGU,eAAe,CAAC9F,KAAD,EAAQc,QAAR,EAAkBC,QAAlB,CAAvB;AAAA,YACIW,CAAC,GAAGkF,gBAAgB,CAAC5G,KAAD,EAAQoF,CAAC,CAACtE,QAAV,CADxB;AAAA,YAEIsG,OAAO,GAAGvI,IAAI,CAACoI,IAAL,CAAU,CAAC,CAAD,GAAKvF,CAAf,CAFd;AAAA,YAGItC,CAAC,GAAIiB,MAAM,GAAG,CAAT,GAAaxB,IAAI,CAACwI,GAAL,CAASD,OAAT,CAHtB;AAAA,YAIIrI,CAAC,GAAIsB,MAAM,GAAG,CAAT,GAAaxB,IAAI,CAACyI,GAAL,CAASF,OAAT,CAJtB;;AAKA,eAAO,CAAC;AAACrI,WAAC,EAACqG,CAAC,CAACrF,KAAF,CAAQhB,CAAR,GAAYA,CAAf;AAAkBK,WAAC,EAACgG,CAAC,CAACrF,KAAF,CAAQX,CAAR,GAAYA;AAAhC,SAAD,EAAqC;AAACL,WAAC,EAACqG,CAAC,CAACrF,KAAF,CAAQhB,CAAR,GAAYA,CAAf;AAAkBK,WAAC,EAACgG,CAAC,CAACrF,KAAF,CAAQX,CAAR,GAAYA;AAAhC,SAArC,CAAP;AACH,OARD;AAUA;;;;;;;;;;;AASA,UAAImI,iBAAiB,GAAG,SAApBA,iBAAoB,CAASC,EAAT,EAAaC,EAAb,EAAiBC,EAAjB,EAAqBC,EAArB,EAAyB3H,KAAzB,EAAgC;AACpD,YAAImD,CAAC,GAAGwE,EAAE,GAAGF,EAAb;AAAA,YACIrE,CAAC,GAAGoE,EAAE,GAAGE,EADb;AAAA,YAEIxG,CAAC,GAAIsG,EAAE,IAAIC,EAAE,GAAGE,EAAT,CAAH,GAAoBF,EAAE,IAAIC,EAAE,GAACF,EAAP,CAF9B;AAAA,YAGII,MAAM,GAAGC,oBAAoB,CAAC7H,KAAD,CAHjC;AAAA,YAIIoF,CAAC,GAAG,CACCjC,CAAC,GAACyE,MAAM,CAAC,CAAD,CAAN,CAAU,CAAV,CAAH,GAAoBxE,CAAC,GAAGwE,MAAM,CAAC,CAAD,CAAN,CAAU,CAAV,CADxB,EAECzE,CAAC,GAACyE,MAAM,CAAC,CAAD,CAAN,CAAU,CAAV,CAAH,GAAkBxE,CAAC,GAACwE,MAAM,CAAC,CAAD,CAAN,CAAU,CAAV,CAFpB,EAGCzE,CAAC,GAACyE,MAAM,CAAC,CAAD,CAAN,CAAU,CAAV,CAAH,GAAkBxE,CAAC,GAACwE,MAAM,CAAC,CAAD,CAAN,CAAU,CAAV,CAHpB,EAICzE,CAAC,GAACyE,MAAM,CAAC,CAAD,CAAN,CAAU,CAAV,CAAH,GAAkBxE,CAAC,GAACwE,MAAM,CAAC,CAAD,CAAN,CAAU,CAAV,CAApB,GAAoC1G,CAJpC,CAJR;AAAA,YAUI4G,CAAC,GAAGC,WAAW,CAACC,KAAZ,CAAkB,IAAlB,EAAwB5C,CAAxB,CAVR;AAAA,YAWI6C,aAAa,GAAG,EAXpB;;AAaA,YAAIH,CAAC,IAAI,IAAT,EAAe;AAEX,eAAK,IAAInH,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,CAApB,EAAuBA,CAAC,EAAxB,EAA4B;AACxB,gBAAID,CAAC,GAAGoH,CAAC,CAACnH,CAAD,CAAT;AAAA,gBACIuH,EAAE,GAAGrJ,IAAI,CAACgB,GAAL,CAASa,CAAT,EAAY,CAAZ,CADT;AAAA,gBAEIyH,EAAE,GAAGtJ,IAAI,CAACgB,GAAL,CAASa,CAAT,EAAY,CAAZ,CAFT;AAAA,gBAGI3B,CAAC,GAAG,CACC6I,MAAM,CAAC,CAAD,CAAN,CAAU,CAAV,IAAeO,EAAhB,GAAuBP,MAAM,CAAC,CAAD,CAAN,CAAU,CAAV,IAAeM,EAAtC,GAA6CN,MAAM,CAAC,CAAD,CAAN,CAAU,CAAV,IAAelH,CAA5D,GAAiEkH,MAAM,CAAC,CAAD,CAAN,CAAU,CAAV,CADjE,EAECA,MAAM,CAAC,CAAD,CAAN,CAAU,CAAV,IAAeO,EAAhB,GAAuBP,MAAM,CAAC,CAAD,CAAN,CAAU,CAAV,IAAeM,EAAtC,GAA6CN,MAAM,CAAC,CAAD,CAAN,CAAU,CAAV,IAAelH,CAA5D,GAAiEkH,MAAM,CAAC,CAAD,CAAN,CAAU,CAAV,CAFjE,CAHR,CADwB,CASxB;;AACA,gBAAIlI,CAAJ;;AACA,gBAAKgI,EAAE,GAAGF,EAAN,KAAc,CAAlB,EAAqB;AACjB9H,eAAC,GAAG,CAACX,CAAC,CAAC,CAAD,CAAD,GAAOyI,EAAR,KAAeE,EAAE,GAAGF,EAApB,CAAJ;AACH,aAFD,MAGK;AACD9H,eAAC,GAAG,CAACX,CAAC,CAAC,CAAD,CAAD,GAAO0I,EAAR,KAAeE,EAAE,GAAGF,EAApB,CAAJ;AACH;;AAED,gBAAI/G,CAAC,IAAI,CAAL,IAAUA,CAAC,IAAI,GAAf,IAAsBhB,CAAC,IAAI,CAA3B,IAAgCA,CAAC,IAAI,GAAzC,EAA8C;AAC1CuI,2BAAa,CAAC5C,IAAd,CAAmBtG,CAAnB;AACH;AACJ;AACJ;;AAED,eAAOkJ,aAAP;AACH,OAzCD;AA2CA;;;;;;;;;;;AASA,UAAIG,gBAAgB,GAAG,SAAnBA,gBAAmB,CAASrJ,CAAT,EAAYK,CAAZ,EAAec,CAAf,EAAkBmI,CAAlB,EAAqBrI,KAArB,EAA4B;AAC/C,YAAIW,CAAC,GAAG,EAAR;AACAA,SAAC,CAAC0E,IAAF,CAAO2C,KAAP,CAAarH,CAAb,EAAgB4G,iBAAiB,CAACxI,CAAD,EAAIK,CAAJ,EAAOL,CAAC,GAAGmB,CAAX,EAAcd,CAAd,EAAiBY,KAAjB,CAAjC;AACAW,SAAC,CAAC0E,IAAF,CAAO2C,KAAP,CAAarH,CAAb,EAAgB4G,iBAAiB,CAACxI,CAAC,GAAGmB,CAAL,EAAQd,CAAR,EAAWL,CAAC,GAAGmB,CAAf,EAAkBd,CAAC,GAAGiJ,CAAtB,EAAyBrI,KAAzB,CAAjC;AACAW,SAAC,CAAC0E,IAAF,CAAO2C,KAAP,CAAarH,CAAb,EAAgB4G,iBAAiB,CAACxI,CAAC,GAAGmB,CAAL,EAAQd,CAAC,GAAGiJ,CAAZ,EAAetJ,CAAf,EAAkBK,CAAC,GAAGiJ,CAAtB,EAAyBrI,KAAzB,CAAjC;AACAW,SAAC,CAAC0E,IAAF,CAAO2C,KAAP,CAAarH,CAAb,EAAgB4G,iBAAiB,CAACxI,CAAD,EAAIK,CAAC,GAAGiJ,CAAR,EAAWtJ,CAAX,EAAcK,CAAd,EAAiBY,KAAjB,CAAjC;AACA,eAAOW,CAAP;AACH,OAPD;AASA;;;;;;;;AAMA,UAAI2H,wBAAwB,GAAG,SAA3BA,wBAA2B,CAASC,WAAT,EAAsBvI,KAAtB,EAA6B;AACxD,YAAIW,CAAC,GAAG,EAAR;AACAA,SAAC,CAAC0E,IAAF,CAAO2C,KAAP,CAAarH,CAAb,EAAgB4G,iBAAiB,CAACgB,WAAW,CAACxJ,CAAb,EAAgBwJ,WAAW,CAACnJ,CAA5B,EAA+BmJ,WAAW,CAACxJ,CAAZ,GAAgBwJ,WAAW,CAACrI,CAA3D,EAA8DqI,WAAW,CAACnJ,CAA1E,EAA6EY,KAA7E,CAAjC;AACAW,SAAC,CAAC0E,IAAF,CAAO2C,KAAP,CAAarH,CAAb,EAAgB4G,iBAAiB,CAACgB,WAAW,CAACxJ,CAAZ,GAAgBwJ,WAAW,CAACrI,CAA7B,EAAgCqI,WAAW,CAACnJ,CAA5C,EAA+CmJ,WAAW,CAACxJ,CAAZ,GAAgBwJ,WAAW,CAACrI,CAA3E,EAA8EqI,WAAW,CAACnJ,CAAZ,GAAgBmJ,WAAW,CAACF,CAA1G,EAA6GrI,KAA7G,CAAjC;AACAW,SAAC,CAAC0E,IAAF,CAAO2C,KAAP,CAAarH,CAAb,EAAgB4G,iBAAiB,CAACgB,WAAW,CAACxJ,CAAZ,GAAgBwJ,WAAW,CAACrI,CAA7B,EAAgCqI,WAAW,CAACnJ,CAAZ,GAAgBmJ,WAAW,CAACF,CAA5D,EAA+DE,WAAW,CAACxJ,CAA3E,EAA8EwJ,WAAW,CAACnJ,CAAZ,GAAgBmJ,WAAW,CAACF,CAA1G,EAA6GrI,KAA7G,CAAjC;AACAW,SAAC,CAAC0E,IAAF,CAAO2C,KAAP,CAAarH,CAAb,EAAgB4G,iBAAiB,CAACgB,WAAW,CAACxJ,CAAb,EAAgBwJ,WAAW,CAACnJ,CAAZ,GAAgBmJ,WAAW,CAACF,CAA5C,EAA+CE,WAAW,CAACxJ,CAA3D,EAA8DwJ,WAAW,CAACnJ,CAA1E,EAA6EY,KAA7E,CAAjC;AACA,eAAOW,CAAP;AACH,OAPD;;AAUA,eAAS6H,2BAAT,CAAqCxI,KAArC,EAA4CyI,IAA5C,EAAkD;AAC9C,eAAO,CACH,CAAEzI,KAAK,CAAC,CAAD,CAAL,CAASyI,IAAT,CAAF,GAAqB,IAAEzI,KAAK,CAAC,CAAD,CAAL,CAASyI,IAAT,CAAvB,GAA0C,CAAC,CAAD,GAAKzI,KAAK,CAAC,CAAD,CAAL,CAASyI,IAAT,CAA/C,GAAiEzI,KAAK,CAAC,CAAD,CAAL,CAASyI,IAAT,CAD9D,EAEF,IAAGzI,KAAK,CAAC,CAAD,CAAL,CAASyI,IAAT,CAAJ,GAAwB,IAAGzI,KAAK,CAAC,CAAD,CAAL,CAASyI,IAAT,CAA3B,GAA+C,IAAGzI,KAAK,CAAC,CAAD,CAAL,CAASyI,IAAT,CAF/C,EAGH,CAAC,CAAD,GAAGzI,KAAK,CAAC,CAAD,CAAL,CAASyI,IAAT,CAAH,GAAoB,IAAEzI,KAAK,CAAC,CAAD,CAAL,CAASyI,IAAT,CAHnB,EAIHzI,KAAK,CAAC,CAAD,CAAL,CAASyI,IAAT,CAJG,CAAP;AAMH;;AAED,eAASZ,oBAAT,CAA8B7H,KAA9B,EACA;AACI,eAAO,CACHwI,2BAA2B,CAACxI,KAAD,EAAQ,GAAR,CADxB,EAEHwI,2BAA2B,CAACxI,KAAD,EAAQ,GAAR,CAFxB,CAAP;AAIH;;AAED,eAASlB,GAAT,CAAaC,CAAb,EAAgB;AACZ,eAAOA,CAAC,GAAG,CAAJ,GAAQ,CAAC,CAAT,GAAaA,CAAC,GAAG,CAAJ,GAAQ,CAAR,GAAY,CAAhC;AACH;;AAED,eAASgJ,WAAT,CAAqB5E,CAArB,EAAwBC,CAAxB,EAA2BlC,CAA3B,EAA8BC,CAA9B,EAAiC;AAC7B,YAAIuH,CAAC,GAAGtF,CAAC,GAAGD,CAAZ;AAAA,YACIwF,CAAC,GAAGzH,CAAC,GAAGiC,CADZ;AAAA,YAEIyF,CAAC,GAAGzH,CAAC,GAAGgC,CAFZ;AAAA,YAGI0F,CAAC,GAAG,CAAC,IAAEF,CAAF,GAAM9J,IAAI,CAACgB,GAAL,CAAS6I,CAAT,EAAY,CAAZ,CAAP,IAAuB,CAH/B;AAAA,YAIII,CAAC,GAAG,CAAC,IAAEJ,CAAF,GAAIC,CAAJ,GAAQ,KAAGC,CAAX,GAAe,IAAE/J,IAAI,CAACgB,GAAL,CAAS6I,CAAT,EAAY,CAAZ,CAAlB,IAAkC,EAJ1C;AAAA,YAKIK,CAAC,GAAGlK,IAAI,CAACgB,GAAL,CAASgJ,CAAT,EAAY,CAAZ,IAAiBhK,IAAI,CAACgB,GAAL,CAASiJ,CAAT,EAAY,CAAZ,CALzB;AAAA,YAMIvE,CANJ;AAAA,YAOIyE,CAPJ;AAAA,YAQItI,CAAC,GAAG,EARR;;AAUA,YAAIqI,CAAC,IAAI,CAAT,EAA4C;AAC5C;AACIxE,aAAC,GAAGzF,GAAG,CAACgK,CAAC,GAAGjK,IAAI,CAACW,IAAL,CAAUuJ,CAAV,CAAL,CAAH,GAAsBlK,IAAI,CAACgB,GAAL,CAAShB,IAAI,CAACuH,GAAL,CAAS0C,CAAC,GAAGjK,IAAI,CAACW,IAAL,CAAUuJ,CAAV,CAAb,CAAT,EAAqC,IAAE,CAAvC,CAA1B;AACAC,aAAC,GAAGlK,GAAG,CAACgK,CAAC,GAAGjK,IAAI,CAACW,IAAL,CAAUuJ,CAAV,CAAL,CAAH,GAAsBlK,IAAI,CAACgB,GAAL,CAAShB,IAAI,CAACuH,GAAL,CAAS0C,CAAC,GAAGjK,IAAI,CAACW,IAAL,CAAUuJ,CAAV,CAAb,CAAT,EAAqC,IAAE,CAAvC,CAA1B;AAEArI,aAAC,CAAC,CAAD,CAAD,GAAO,CAACgI,CAAD,GAAG,CAAH,IAAQnE,CAAC,GAAGyE,CAAZ,CAAP;AACAtI,aAAC,CAAC,CAAD,CAAD,GAAO,CAACgI,CAAD,GAAG,CAAH,GAAO,CAACnE,CAAC,GAAGyE,CAAL,IAAQ,CAAtB;AACAtI,aAAC,CAAC,CAAD,CAAD,GAAO,CAACgI,CAAD,GAAG,CAAH,GAAO,CAACnE,CAAC,GAAGyE,CAAL,IAAQ,CAAtB;AAEA;;AACA,gBAAInK,IAAI,CAACuH,GAAL,CAASvH,IAAI,CAACW,IAAL,CAAU,CAAV,KAAc+E,CAAC,GAAGyE,CAAlB,IAAqB,CAA9B,MAAqC,CAAzC,EAA4C;AACxCtI,eAAC,CAAC,CAAD,CAAD,GAAO,CAAC,CAAR;AACAA,eAAC,CAAC,CAAD,CAAD,GAAO,CAAC,CAAR;AACH;AACJ,WAdD,MAe8C;AAC9C;AACI,gBAAIuI,EAAE,GAAGpK,IAAI,CAACqK,IAAL,CAAUJ,CAAC,GAACjK,IAAI,CAACW,IAAL,CAAU,CAACX,IAAI,CAACgB,GAAL,CAASgJ,CAAT,EAAY,CAAZ,CAAX,CAAZ,CAAT;AACAnI,aAAC,CAAC,CAAD,CAAD,GAAO,IAAE7B,IAAI,CAACW,IAAL,CAAU,CAACqJ,CAAX,CAAF,GAAgBhK,IAAI,CAACyI,GAAL,CAAS2B,EAAE,GAAC,CAAZ,CAAhB,GAAiCP,CAAC,GAAC,CAA1C;AACAhI,aAAC,CAAC,CAAD,CAAD,GAAO,IAAE7B,IAAI,CAACW,IAAL,CAAU,CAACqJ,CAAX,CAAF,GAAgBhK,IAAI,CAACyI,GAAL,CAAS,CAAC2B,EAAE,GAAG,IAAEpK,IAAI,CAACsK,EAAb,IAAiB,CAA1B,CAAhB,GAA+CT,CAAC,GAAC,CAAxD;AACAhI,aAAC,CAAC,CAAD,CAAD,GAAO,IAAE7B,IAAI,CAACW,IAAL,CAAU,CAACqJ,CAAX,CAAF,GAAgBhK,IAAI,CAACyI,GAAL,CAAS,CAAC2B,EAAE,GAAG,IAAEpK,IAAI,CAACsK,EAAb,IAAiB,CAA1B,CAAhB,GAA+CT,CAAC,GAAC,CAAxD;AACH,WAhC4B,CAkC7B;;;AACA,aAAK,IAAI/H,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,CAApB,EAAuBA,CAAC,EAAxB,EAA4B;AACxB,cAAID,CAAC,CAACC,CAAD,CAAD,GAAO,CAAP,IAAYD,CAAC,CAACC,CAAD,CAAD,GAAO,GAAvB,EAA4B;AACxBD,aAAC,CAACC,CAAD,CAAD,GAAO,CAAC,CAAR;AACH;AACJ;;AAED,eAAOD,CAAP;AACH;;AAED,UAAI0I,QAAQ,GAAG,KAAKA,QAAL,GAAgB;AAC3BC,yBAAiB,EAAGvJ,kBADO;AAE3BwJ,uBAAe,EAAG1C,gBAFS;AAG3B2C,qCAA6B,EAAGrC,6BAHL;AAI3BsC,2BAAmB,EAAGxI,oBAJK;AAK3ByI,oBAAY,EAAGnE,YALY;AAM3BoE,2BAAmB,EAAGhD,mBANK;AAO3BiD,8BAAsB,EAAGxC,sBAPE;AAQ3ByC,8BAAsB,EAACjD,sBARI;AAS3BkD,iBAAS,EAACxD,OATiB;AAU3ByD,wBAAgB,EAACvC,iBAVU;AAW3BwC,uBAAe,EAAC3B,gBAXW;AAY3B4B,+BAAuB,EAAC1B,wBAZG;AAa3B2B,eAAO,EAAC;AAbmB,OAA/B;;AAgBA,UAAI,IAAJ,EAAoC;AAChCC,eAAO,CAACd,QAAR,GAAmBA,QAAnB;AACH;AAEJ,KA/gBD,EA+gBGe,IA/gBH,CA+gBQ,OAAOC,MAAP,KAAkB,WAAlB,GAAgCA,MAAhC,GAAyC,IA/gBjD;AAihBA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6BA;AAAC,KAAC,YAAW;AAET;;AACA,UAAIxL,IAAI,GAAG,IAAX;AAEA,UAAIyL,OAAO,GAAGzL,IAAI,CAACyL,OAAL,GAAe;AACzBJ,eAAO,EAAC;AADiB,OAA7B;;AAIA,UAAI,IAAJ,EAAoC;AAChCC,eAAO,CAACG,OAAR,GAAkBA,OAAlB;AACH;;AAED,UAAIC,IAAI,GAAG,SAAPA,IAAO,CAASnH,CAAT,EAAY;AAAE,eAAOoH,MAAM,CAACC,SAAP,CAAiBC,QAAjB,CAA0BN,IAA1B,CAA+BhH,CAA/B,MAAsC,gBAA7C;AAAgE,OAAzF;AAAA,UACIuH,YAAY,GAAG,SAAfA,YAAe,CAAS/E,EAAT,EAAaC,EAAb,EAAiB+E,EAAjB,EAAqB;AAChChF,UAAE,GAAG2E,IAAI,CAAC3E,EAAD,CAAJ,GAAWA,EAAX,GAAgB,CAACA,EAAE,CAAC5G,CAAJ,EAAO4G,EAAE,CAACvG,CAAV,CAArB;AACAwG,UAAE,GAAG0E,IAAI,CAAC1E,EAAD,CAAJ,GAAWA,EAAX,GAAgB,CAACA,EAAE,CAAC7G,CAAJ,EAAO6G,EAAE,CAACxG,CAAV,CAArB;AACA,eAAOuL,EAAE,CAAChF,EAAD,EAAKC,EAAL,CAAT;AACH,OALL;;AAMI;;;;;;;;AAQAgF,eAAS,GAAGP,OAAO,CAACQ,QAAR,GAAmB,UAASlF,EAAT,EAAaC,EAAb,EAAiB;AAC5C,eAAO8E,YAAY,CAAC/E,EAAD,EAAKC,EAAL,EAAS,UAASkF,GAAT,EAAcC,GAAd,EAAmB;AAC3C,cAAIA,GAAG,CAAC,CAAD,CAAH,IAAUD,GAAG,CAAC,CAAD,CAAjB,EACI,OAAOC,GAAG,CAAC,CAAD,CAAH,GAASD,GAAG,CAAC,CAAD,CAAZ,GAAkB9D,QAAlB,GAA6B,CAACA,QAArC,CADJ,KAEK,IAAI+D,GAAG,CAAC,CAAD,CAAH,IAAUD,GAAG,CAAC,CAAD,CAAjB,EACD,OAAOC,GAAG,CAAC,CAAD,CAAH,GAASD,GAAG,CAAC,CAAD,CAAZ,GAAkB,CAAlB,GAAsB,CAAC,CAA9B,CADC,KAGD,OAAO,CAACC,GAAG,CAAC,CAAD,CAAH,GAASD,GAAG,CAAC,CAAD,CAAb,KAAqBC,GAAG,CAAC,CAAD,CAAH,GAASD,GAAG,CAAC,CAAD,CAAjC,CAAP;AACP,SAPkB,CAAnB;AAQH,OAvBL;;AAwBI;;;;;;;;AAQAE,aAAO,GAAGX,OAAO,CAACY,MAAR,GAAiB,UAAStF,EAAT,EAAaC,EAAb,EAAiB;AACxC,eAAO,CAAC,CAAD,GAAKgF,SAAS,CAACjF,EAAD,EAAKC,EAAL,CAArB;AACH,OAlCL;;AAmCI;;;;;;;;AAQAsF,iBAAW,GAAGb,OAAO,CAACc,UAAR,GAAqB,UAASxF,EAAT,EAAaC,EAAb,EAAiB;AAChD,eAAO8E,YAAY,CAAC/E,EAAD,EAAKC,EAAL,EAAS,UAASkF,GAAT,EAAcC,GAAd,EAAmB;AAC3C,iBAAOlM,IAAI,CAACW,IAAL,CAAUX,IAAI,CAACgB,GAAL,CAASkL,GAAG,CAAC,CAAD,CAAH,GAASD,GAAG,CAAC,CAAD,CAArB,EAA0B,CAA1B,IAA+BjM,IAAI,CAACgB,GAAL,CAASkL,GAAG,CAAC,CAAD,CAAH,GAASD,GAAG,CAAC,CAAD,CAArB,EAA0B,CAA1B,CAAzC,CAAP;AACH,SAFkB,CAAnB;AAGH,OA/CL;;AAgDI;;;;;;;;AAQAM,eAAS,GAAGf,OAAO,CAACgB,QAAR,GAAmB,UAAS1F,EAAT,EAAaC,EAAb,EAAiB;AAC5C,eAAO8E,YAAY,CAAC/E,EAAD,EAAKC,EAAL,EAAS,UAASkF,GAAT,EAAcC,GAAd,EAAmB;AAC3C,cAAIA,GAAG,CAAC,CAAD,CAAH,GAASD,GAAG,CAAC,CAAD,CAAhB,EAAqB;AACjB,mBAAQC,GAAG,CAAC,CAAD,CAAH,GAASD,GAAG,CAAC,CAAD,CAAb,GAAoB,CAApB,GAAwB,CAA/B;AACH,WAFD,MAGK,IAAIC,GAAG,CAAC,CAAD,CAAH,IAAUD,GAAG,CAAC,CAAD,CAAjB,EAAsB;AACvB,mBAAOC,GAAG,CAAC,CAAD,CAAH,GAASD,GAAG,CAAC,CAAD,CAAZ,GAAkB,CAAlB,GAAsB,CAA7B;AACH,WAFI,MAGA;AACD,mBAAQC,GAAG,CAAC,CAAD,CAAH,GAASD,GAAG,CAAC,CAAD,CAAb,GAAoB,CAApB,GAAwB,CAA/B;AACH;AACJ,SAVkB,CAAnB;AAWH,OApEL;;AAqEI;;;;;;;;AAQAQ,YAAM,GAAGjB,OAAO,CAACkB,KAAR,GAAgB,UAAS5F,EAAT,EAAaC,EAAb,EAAiB;AACtC,eAAO8E,YAAY,CAAC/E,EAAD,EAAKC,EAAL,EAAS,UAASkF,GAAT,EAAcC,GAAd,EAAmB;AAC3C,cAAIrJ,CAAC,GAAGkJ,SAAS,CAACE,GAAD,EAAMC,GAAN,CAAjB;AAAA,cACIrK,CAAC,GAAG7B,IAAI,CAACoI,IAAL,CAAUvF,CAAV,CADR;AAAA,cAEIhC,CAAC,GAAG0L,SAAS,CAACN,GAAD,EAAMC,GAAN,CAFjB;;AAGA,cAAKrL,CAAC,IAAI,CAAL,IAAUA,CAAC,IAAG,CAAnB,EAAuBgB,CAAC,IAAI7B,IAAI,CAACsK,EAAV;AACvB,cAAIzI,CAAC,GAAG,CAAR,EAAWA,CAAC,IAAK,IAAI7B,IAAI,CAACsK,EAAf;AAEX,iBAAOzI,CAAP;AACH,SARkB,CAAnB;AASH,OAvFL;;AAwFI;;;;;;;;AAQA8K,iBAAW,GAAGnB,OAAO,CAACoB,UAAR,GAAqB,UAASC,EAAT,EAAaC,EAAb,EAAiB;AAChD,YAAInE,EAAE,GAAGkE,EAAE,CAAC3M,CAAZ;AAAA,YAAe2I,EAAE,GAAGgE,EAAE,CAAC3M,CAAH,GAAO2M,EAAE,CAACxL,CAA9B;AAAA,YAAiCuH,EAAE,GAAGiE,EAAE,CAACtM,CAAzC;AAAA,YAA4CuI,EAAE,GAAG+D,EAAE,CAACtM,CAAH,GAAOsM,EAAE,CAACrD,CAA3D;AAAA,YACI9E,EAAE,GAAGoI,EAAE,CAAC5M,CADZ;AAAA,YACe2E,EAAE,GAAGiI,EAAE,CAAC5M,CAAH,GAAO4M,EAAE,CAACzL,CAD9B;AAAA,YACiCsD,EAAE,GAAGmI,EAAE,CAACvM,CADzC;AAAA,YAC4CuE,EAAE,GAAGgI,EAAE,CAACvM,CAAH,GAAOuM,EAAE,CAACtD,CAD3D;AAGA,eAAWb,EAAE,IAAIjE,EAAN,IAAYA,EAAE,IAAImE,EAAnB,IAA2BD,EAAE,IAAIjE,EAAN,IAAYA,EAAE,IAAImE,EAA/C,IACDH,EAAE,IAAI9D,EAAN,IAAYA,EAAE,IAAIgE,EAAnB,IAA2BD,EAAE,IAAIjE,EAAN,IAAYA,EAAE,IAAImE,EAD3C,IAEDH,EAAE,IAAIjE,EAAN,IAAYA,EAAE,IAAImE,EAAnB,IAA2BD,EAAE,IAAI9D,EAAN,IAAYA,EAAE,IAAIgE,EAF3C,IAGDH,EAAE,IAAI9D,EAAN,IAAYH,EAAE,IAAImE,EAAnB,IAA2BD,EAAE,IAAI9D,EAAN,IAAYA,EAAE,IAAIgE,EAH3C,IAIDpE,EAAE,IAAIiE,EAAN,IAAYA,EAAE,IAAI9D,EAAnB,IAA2BF,EAAE,IAAIiE,EAAN,IAAYA,EAAE,IAAI9D,EAJ3C,IAKDJ,EAAE,IAAImE,EAAN,IAAYA,EAAE,IAAIhE,EAAnB,IAA2BF,EAAE,IAAIiE,EAAN,IAAYA,EAAE,IAAI9D,EAL3C,IAMDJ,EAAE,IAAIiE,EAAN,IAAYA,EAAE,IAAI9D,EAAnB,IAA2BF,EAAE,IAAImE,EAAN,IAAYA,EAAE,IAAIhE,EAN3C,IAODJ,EAAE,IAAImE,EAAN,IAAYF,EAAE,IAAI9D,EAAnB,IAA2BF,EAAE,IAAImE,EAAN,IAAYA,EAAE,IAAIhE,EAPnD;AAQH,OA5GL;;AA6GI;;;;;;;;;AASAiI,eAAS,GAAGvB,OAAO,CAACwB,QAAR,GAAmB,UAASH,EAAT,EAAaC,EAAb,EAAiBG,gBAAjB,EAAmC;AAC9D,YAAItE,EAAE,GAAGkE,EAAE,CAAC3M,CAAZ;AAAA,YAAe2I,EAAE,GAAGgE,EAAE,CAAC3M,CAAH,GAAO2M,EAAE,CAACxL,CAA9B;AAAA,YAAiCuH,EAAE,GAAGiE,EAAE,CAACtM,CAAzC;AAAA,YAA4CuI,EAAE,GAAG+D,EAAE,CAACtM,CAAH,GAAOsM,EAAE,CAACrD,CAA3D;AAAA,YACI9E,EAAE,GAAGoI,EAAE,CAAC5M,CADZ;AAAA,YACe2E,EAAE,GAAGiI,EAAE,CAAC5M,CAAH,GAAO4M,EAAE,CAACzL,CAD9B;AAAA,YACiCsD,EAAE,GAAGmI,EAAE,CAACvM,CADzC;AAAA,YAC4CuE,EAAE,GAAGgI,EAAE,CAACvM,CAAH,GAAOuM,EAAE,CAACtD,CAD3D;AAAA,YAEInH,CAAC,GAAG,SAAJA,CAAI,CAAShC,EAAT,EAAaC,EAAb,EAAiB4M,EAAjB,EAAqBC,EAArB,EAAyB;AAAE,iBAAOF,gBAAgB,GAAG5M,EAAE,IAAIC,EAAN,IAAY4M,EAAE,IAAGC,EAApB,GAAyB9M,EAAE,GAAGC,EAAL,IAAW4M,EAAE,GAAGC,EAAhE;AAAqE,SAFxG;;AAIA,eAAO9K,CAAC,CAACsG,EAAD,EAAIjE,EAAJ,EAAOmE,EAAP,EAAUhE,EAAV,CAAD,IAAkBxC,CAAC,CAACuG,EAAD,EAAIjE,EAAJ,EAAOmE,EAAP,EAAUhE,EAAV,CAA1B;AACH,OA5HL;AAAA,UA6HIsI,mBAAmB,GAAG,CAAC,IAAD,EAAO,CAAC,CAAD,EAAI,CAAC,CAAL,CAAP,EAAgB,CAAC,CAAD,EAAI,CAAJ,CAAhB,EAAwB,CAAC,CAAC,CAAF,EAAK,CAAL,CAAxB,EAAiC,CAAC,CAAC,CAAF,EAAK,CAAC,CAAN,CAAjC,CA7H1B;AAAA,UA8HIC,0BAA0B,GAAG,CAAC,IAAD,EAAO,CAAC,CAAC,CAAF,EAAK,CAAC,CAAN,CAAP,EAAiB,CAAC,CAAC,CAAF,EAAK,CAAL,CAAjB,EAA0B,CAAC,CAAD,EAAI,CAAJ,CAA1B,EAAkC,CAAC,CAAD,EAAI,CAAC,CAAL,CAAlC,CA9HjC;;AA+HI;;;;;;;;AAQAC,kBAAY,GAAG9B,OAAO,CAAC+B,WAAR,GAAsB,UAASC,SAAT,EAAoBC,OAApB,EAA6BvL,QAA7B,EAAuC;AACxE,YAAIW,CAAC,GAAGkJ,SAAS,CAACyB,SAAD,EAAYC,OAAZ,CAAjB;AAAA,YACI5M,CAAC,GAAG0L,SAAS,CAACiB,SAAD,EAAYC,OAAZ,CADjB;AAAA,YAEIC,iBAAiB,GAAGxL,QAAQ,GAAG,CAAX,GAAekL,mBAAmB,CAACvM,CAAD,CAAlC,GAAwCwM,0BAA0B,CAACxM,CAAD,CAF1F;AAAA,YAGI6L,KAAK,GAAG1M,IAAI,CAACoI,IAAL,CAAUvF,CAAV,CAHZ;AAAA,YAIItC,CAAC,GAAGP,IAAI,CAACuH,GAAL,CAASrF,QAAQ,GAAGlC,IAAI,CAACwI,GAAL,CAASkE,KAAT,CAApB,IAAuCgB,iBAAiB,CAAC,CAAD,CAJhE;AAAA,YAKIxN,CAAC,GAAIF,IAAI,CAACuH,GAAL,CAASrF,QAAQ,GAAGlC,IAAI,CAACyI,GAAL,CAASiE,KAAT,CAApB,IAAuCgB,iBAAiB,CAAC,CAAD,CALjE;;AAMA,eAAO;AAAExN,WAAC,EAACsN,SAAS,CAACtN,CAAV,GAAcA,CAAlB;AAAqBK,WAAC,EAACiN,SAAS,CAACjN,CAAV,GAAcA;AAArC,SAAP;AACH,OA/IL;;AAgJI;;;;;;;;AAQAoN,0BAAoB,GAAGnC,OAAO,CAACoC,mBAAR,GAA8B,UAASJ,SAAT,EAAoBC,OAApB,EAA6BjM,MAA7B,EAAqC;AACtF,YAAIqB,CAAC,GAAGkJ,SAAS,CAACyB,SAAD,EAAYC,OAAZ,CAAjB;AAAA,YACII,MAAM,GAAG7N,IAAI,CAACoI,IAAL,CAAU,CAAC,CAAD,GAAKvF,CAAf,CADb;AAAA,YAEItC,CAAC,GAAIiB,MAAM,GAAG,CAAT,GAAaxB,IAAI,CAACwI,GAAL,CAASqF,MAAT,CAFtB;AAAA,YAGI3N,CAAC,GAAIsB,MAAM,GAAG,CAAT,GAAaxB,IAAI,CAACyI,GAAL,CAASoF,MAAT,CAHtB;;AAIA,eAAO,CAAC;AAAC3N,WAAC,EAACuN,OAAO,CAACvN,CAAR,GAAYA,CAAf;AAAkBK,WAAC,EAACkN,OAAO,CAAClN,CAAR,GAAYA;AAAhC,SAAD,EAAqC;AAACL,WAAC,EAACuN,OAAO,CAACvN,CAAR,GAAYA,CAAf;AAAkBK,WAAC,EAACkN,OAAO,CAAClN,CAAR,GAAYA;AAAhC,SAArC,CAAP;AACH,OA9JL;AA+JH,KA5KA,EA4KE+K,IA5KF,CA4KO,OAAOC,MAAP,KAAkB,WAAlB,GAAgCA,MAAhC,GAAyC,IA5KhD;AA6KD;AACA,KAAC,YAAY;AAET;AAEA;;;;;;;;;;;;;;AAaA,eAASuC,MAAT,CAAgBC,IAAhB,EAAsBC,MAAtB,EAA8BC,KAA9B,EAAqCC,KAArC,EAA4CC,OAA5C,EAAqDC,OAArD,EAA8DC,OAA9D,EAAuEC,OAAvE,EAAgF;AAExE,eAAO,IAAIC,KAAJ,CAAU;AACbP,gBAAM,EAACA,MADM;AAEbQ,oBAAU,EAACC,KAAK,EAFH;AAGbR,eAAK,EAAEA,KAHM;AAIbC,eAAK,EAAEA,KAJM;AAKbC,iBAAO,EAAEA,OALI;AAMbC,iBAAO,EAAEA,OANI;AAObC,iBAAO,EAAEA,OAAO,IAAIF,OAPP;AAQbG,iBAAO,EAAEA,OAAO,IAAIF;AARP,SAAV,CAAP;AAUP;AAED;;;;;;;AAKA,eAASM,UAAT,GAAsB;AAClB,YAAIC,IAAI,GAAG,EAAX;AACAC,aAAK,CAACjD,SAAN,CAAgBnF,IAAhB,CAAqB2C,KAArB,CAA2BwF,IAA3B,EAAiCE,SAAjC;;AACAF,YAAI,CAACG,IAAL,GAAa,UAASC,KAAT,EAAgB;AAAE,iBAAO,KAAKA,KAAL,CAAP;AAAqB,SAApD;;AACA,eAAOJ,IAAP;AACH;AAED;;;;;;;;;;;;;;;AAaA,eAASK,aAAT,CAAuBjB,IAAvB,EAA6BC,MAA7B,EAAqCC,KAArC,EAA4CC,KAA5C,EAAmDC,OAAnD,EAA4DC,OAA5D,EAAqEC,OAArE,EAA8EC,OAA9E,EAAuF;AACnF,eAAOI,UAAU,CAACZ,MAAM,CAAC3E,KAAP,CAAa,IAAb,EAAmB0F,SAAnB,CAAD,CAAjB;AACH;;AAED,UAAI9O,IAAI,GAAG,IAAX;AAAA,UACIkP,eAAe,GAAG,SAAlBA,eAAkB,CAAUC,EAAV,EAAcC,QAAd,EAAwBC,GAAxB,EAA6B;AAC3CA,WAAG,GAAGA,GAAG,IAAIF,EAAE,CAACG,UAAhB;AACA,YAAIC,SAAS,GAAGF,GAAG,CAACG,gBAAJ,CAAqBJ,QAArB,CAAhB;;AACA,aAAK,IAAIrN,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGwN,SAAS,CAAC9N,MAA9B,EAAsCM,CAAC,EAAvC,EAA2C;AACvC,cAAIwN,SAAS,CAACxN,CAAD,CAAT,KAAiBoN,EAArB,EAAyB;AACrB,mBAAO,IAAP;AACH;AACJ;;AACD,eAAO,KAAP;AACH,OAVL;AAAA,UAWIM,IAAI,GAAG,SAAPA,IAAO,CAAUN,EAAV,EAAc;AACjB,eAAQ,OAAOA,EAAP,IAAa,QAAb,IAAyBA,EAAE,CAACO,WAAH,KAAmBC,MAA7C,GAAuDC,QAAQ,CAACC,cAAT,CAAwBV,EAAxB,CAAvD,GAAqFA,EAA5F;AACH,OAbL;AAAA,UAcIW,EAAE,GAAG,SAALA,EAAK,CAAUC,CAAV,EAAa;AACd,eAAOA,CAAC,CAACC,UAAF,IAAgBD,CAAC,CAAC9B,MAAzB;AACH,OAhBL;AAAA,UAiBA;AACA;AACA;AACA;AACIgC,SAAG,GAAG,SAANA,GAAM,CAASF,CAAT,EAAY9B,MAAZ,EAAoBiC,GAApB,EAAyBC,SAAzB,EAAoC;AACtC,YAAI,CAACA,SAAL,EAAgB,OAAO;AAAEC,cAAI,EAAC,CAACnC,MAAD,CAAP;AAAiBoC,aAAG,EAAC;AAArB,SAAP,CAAhB,KACK,IAAI,OAAON,CAAC,CAACK,IAAT,KAAkB,WAAlB,IAAiCL,CAAC,CAACK,IAAF,CAAOE,OAA5C,EAAqD;AACtD,iBAAO;AAAEF,gBAAI,EAAEL,CAAC,CAACK,IAAV;AAAgBC,eAAG,EAAEN,CAAC,CAACK,IAAF,CAAOE,OAAP,CAAeJ,GAAf;AAArB,WAAP;AACH,SAFI,MAEE;AACH,cAAIK,GAAG,GAAG;AAAEH,gBAAI,EAAC,EAAP;AAAWC,eAAG,EAAC,CAAC;AAAhB,WAAV;AAAA,cAA+BG,IAAI,GAAG,SAAPA,IAAO,CAASrB,EAAT,EAAa;AAC/CoB,eAAG,CAACH,IAAJ,CAAS3J,IAAT,CAAc0I,EAAd;;AACA,gBAAIA,EAAE,KAAKe,GAAX,EAAgB;AACZK,iBAAG,CAACF,GAAJ,GAAUE,GAAG,CAACH,IAAJ,CAAS3O,MAAT,GAAkB,CAA5B;AACH,aAFD,MAGK,IAAI0N,EAAE,CAACG,UAAH,IAAiB,IAArB,EAA2B;AAC5BkB,kBAAI,CAACrB,EAAE,CAACG,UAAJ,CAAJ;AACH;AACJ,WARD;;AASAkB,cAAI,CAACvC,MAAD,CAAJ;;AACA,iBAAOsC,GAAP;AACH;AACJ,OAtCL;AAAA,UAuCIE,EAAE,GAAG,SAALA,EAAK,CAAUC,CAAV,EAAa3E,EAAb,EAAiB;AAClB,aAAK,IAAIhK,CAAC,GAAG,CAAR,EAAWqB,CAAC,GAAGsN,CAAC,CAACjP,MAAtB,EAA8BM,CAAC,GAAGqB,CAAlC,EAAqCrB,CAAC,EAAtC,EAA0C;AACtC,cAAI2O,CAAC,CAAC3O,CAAD,CAAD,IAAQgK,EAAZ,EAAgB;AACnB;;AACD,YAAIhK,CAAC,GAAG2O,CAAC,CAACjP,MAAV,EAAkBiP,CAAC,CAACC,MAAF,CAAS5O,CAAT,EAAY,CAAZ;AACrB,OA5CL;AAAA,UA6CI6O,IAAI,GAAG,CA7CX;AAAA,UA8CA;AACA;AACA;AACA;AACA;AACIC,YAAM,GAAG,SAATA,MAAS,CAAUX,GAAV,EAAeY,KAAf,EAAsB/E,EAAtB,EAA0B;AAC/B,YAAIgF,CAAC,GAAGH,IAAI,EAAZ;AACAV,WAAG,CAACc,IAAJ,GAAWd,GAAG,CAACc,IAAJ,IAAY,EAAvB;AACAd,WAAG,CAACc,IAAJ,CAASF,KAAT,IAAkBZ,GAAG,CAACc,IAAJ,CAASF,KAAT,KAAmB,EAArC,CAH+B,CAI/B;;AACAZ,WAAG,CAACc,IAAJ,CAASF,KAAT,EAAgBC,CAAhB,IAAqBhF,EAArB,CAL+B,CAM/B;;AACAA,UAAE,CAACkF,OAAH,GAAaF,CAAb;AACA,eAAOA,CAAP;AACH,OA5DL;AAAA,UA6DIG,QAAQ,GAAG,SAAXA,QAAW,CAAUhB,GAAV,EAAeY,KAAf,EAAsB/E,EAAtB,EAA0B;AACjCmE,WAAG,CAACc,IAAJ,IAAYd,GAAG,CAACc,IAAJ,CAASF,KAAT,CAAZ,IAA+B,OAAOZ,GAAG,CAACc,IAAJ,CAASF,KAAT,EAAgB/E,EAAE,CAACkF,OAAnB,CAAtC,CADiC,CAEjC;;AACA,YAAIlF,EAAE,CAACoF,SAAP,EAAkB;AACd,eAAK,IAAIpP,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGgK,EAAE,CAACoF,SAAH,CAAa1P,MAAjC,EAAyCM,CAAC,EAA1C,EAA8C;AAC1CqP,mBAAO,CAAClB,GAAD,EAAMnE,EAAE,CAACoF,SAAH,CAAapP,CAAb,EAAgB,CAAhB,CAAN,EAA0BgK,EAAE,CAACoF,SAAH,CAAapP,CAAb,EAAgB,CAAhB,CAA1B,CAAP;AACH;;AACDgK,YAAE,CAACoF,SAAH,CAAa1P,MAAb,GAAsB,CAAtB;AACH,SARgC,CASjC;;;AACAsK,UAAE,CAACsF,WAAH,IAAkBtF,EAAE,CAACsF,WAAH,EAAlB;AACH,OAxEL;AAAA,UAyEIC,iBAAiB,GAAG,SAApBA,iBAAoB,CAAUC,QAAV,EAAoBrB,GAApB,EAAyBnE,EAAzB,EAA6ByF,GAA7B,EAAkC;AAClD,YAAID,QAAQ,IAAI,IAAhB,EAAsB,OAAOxF,EAAP,CAAtB,KACK;AACD,cAAIzJ,CAAC,GAAGiP,QAAQ,CAACE,KAAT,CAAe,GAAf,CAAR;AAAA,cACIC,GAAG,GAAG,SAANA,GAAM,CAAU3B,CAAV,EAAa;AACf2B,eAAG,CAACT,OAAJ,GAAclF,EAAE,CAACkF,OAAjB;;AACA,gBAAInP,CAAC,GAAGgO,EAAE,CAACC,CAAD,CAAV;AAAA,gBAAe9B,MAAM,GAAGnM,CAAxB,CAFe,CAEa;AAC5B;;;AACA,gBAAI6P,QAAQ,GAAG1B,GAAG,CAACF,CAAD,EAAIjO,CAAJ,EAAOoO,GAAP,EAAYqB,QAAQ,IAAI,IAAxB,CAAlB;;AACA,gBAAII,QAAQ,CAACtB,GAAT,IAAgB,CAAC,CAArB,EAAwB;AACpB,mBAAK,IAAI7J,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGmL,QAAQ,CAACtB,GAA7B,EAAkC7J,CAAC,EAAnC,EAAuC;AACnCyH,sBAAM,GAAG0D,QAAQ,CAACvB,IAAT,CAAc5J,CAAd,CAAT;;AACA,qBAAK,IAAIzE,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGO,CAAC,CAACb,MAAtB,EAA8BM,CAAC,EAA/B,EAAmC;AAC/B,sBAAImN,eAAe,CAACjB,MAAD,EAAS3L,CAAC,CAACP,CAAD,CAAV,EAAemO,GAAf,CAAnB,EAAwC;AACpCnE,sBAAE,CAAC3C,KAAH,CAAS6E,MAAT,EAAiBa,SAAjB;AACH;AACJ;AACJ;AACJ;AACJ,WAhBL;;AAiBA8C,+BAAqB,CAAC7F,EAAD,EAAKyF,GAAL,EAAUE,GAAV,CAArB;AACA,iBAAOA,GAAP;AACH;AACJ,OAhGL;AAAA,UAiGA;AACA;AACA;AACA;AACIE,2BAAqB,GAAG,SAAxBA,qBAAwB,CAAU7F,EAAV,EAAcyF,GAAd,EAAmBK,KAAnB,EAA0B;AAC9C9F,UAAE,CAACoF,SAAH,GAAepF,EAAE,CAACoF,SAAH,IAAgB,EAA/B;;AACApF,UAAE,CAACoF,SAAH,CAAa1K,IAAb,CAAkB,CAAC+K,GAAD,EAAMK,KAAN,CAAlB;AACH,OAxGL;AAAA,UAyGIC,cAAc,GAAG,SAAjBA,cAAiB,CAAU5B,GAAV,EAAesB,GAAf,EAAoBzF,EAApB,EAAwBwF,QAAxB,EAAkC;AAC/C,YAAIQ,aAAa,IAAIC,QAAQ,CAACR,GAAD,CAA7B,EAAoC;AAChC,cAAIS,GAAG,GAAGX,iBAAiB,CAACC,QAAD,EAAWrB,GAAX,EAAgBnE,EAAhB,EAAoBiG,QAAQ,CAACR,GAAD,CAA5B,CAA3B;;AACAU,eAAK,CAAChC,GAAD,EAAM8B,QAAQ,CAACR,GAAD,CAAd,EAAqBS,GAArB,EAA2BlG,EAA3B,CAAL;AACH;;AACD,YAAIyF,GAAG,KAAK,OAAR,IAAmBtB,GAAG,CAACiC,YAAJ,CAAiB,UAAjB,KAAgC,IAAvD,EAA6D;AACzDjC,aAAG,CAACkC,YAAJ,CAAiB,UAAjB,EAA6B,GAA7B;AACH;;AACDF,aAAK,CAAChC,GAAD,EAAMsB,GAAN,EAAWF,iBAAiB,CAACC,QAAD,EAAWrB,GAAX,EAAgBnE,EAAhB,EAAoByF,GAApB,CAA5B,EAAsDzF,EAAtD,CAAL;AACH,OAlHL;AAAA,UAmHIsG,iBAAiB,GAAG,SAApBA,iBAAoB,CAAUnC,GAAV,EAAesB,GAAf,EAAoBzF,EAApB,EAAwBwF,QAAxB,EAAkC;AAClD,YAAIrB,GAAG,CAACoC,eAAJ,IAAuB,IAA3B,EAAiC;AAC7B,cAAIC,IAAI,GAAG,SAAPA,IAAO,CAAUxC,CAAV,EAAa;AAChBG,eAAG,CAACsC,KAAJ,GAAYC,aAAa,CAAC1C,CAAD,CAAzB;AACH,WAFL;AAAA,cAGI2C,EAAE,GAAG,SAALA,EAAK,CAAU3C,CAAV,EAAa;AACdG,eAAG,CAACyC,KAAJ,GAAYF,aAAa,CAAC1C,CAAD,CAAzB;AACH,WALL;AAAA,cAMI6C,KAAK,GAAG,SAARA,KAAQ,CAAU7C,CAAV,EAAa;AACjB,gBAAIG,GAAG,CAACsC,KAAJ,IAAatC,GAAG,CAACyC,KAAjB,IAA0BzC,GAAG,CAACsC,KAAJ,CAAU,CAAV,MAAiBtC,GAAG,CAACyC,KAAJ,CAAU,CAAV,CAA3C,IAA2DzC,GAAG,CAACsC,KAAJ,CAAU,CAAV,MAAiBtC,GAAG,CAACyC,KAAJ,CAAU,CAAV,CAAhF,EAA8F;AAC1F,mBAAK,IAAI5Q,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGmO,GAAG,CAACoC,eAAJ,CAAoB7Q,MAAxC,EAAgDM,CAAC,EAAjD;AACImO,mBAAG,CAACoC,eAAJ,CAAoBvQ,CAApB,EAAuBqH,KAAvB,CAA6B0G,EAAE,CAACC,CAAD,CAA/B,EAAoC,CAAEA,CAAF,CAApC;AADJ;AAEH;AACJ,WAXL;;AAYA+B,wBAAc,CAAC5B,GAAD,EAAM,WAAN,EAAmBqC,IAAnB,EAAyBhB,QAAzB,CAAd;AACAO,wBAAc,CAAC5B,GAAD,EAAM,SAAN,EAAiBwC,EAAjB,EAAqBnB,QAArB,CAAd;AACAO,wBAAc,CAAC5B,GAAD,EAAM,OAAN,EAAe0C,KAAf,EAAsBrB,QAAtB,CAAd;AACArB,aAAG,CAACoC,eAAJ,GAAsB,EAAtB;AACH,SAlBiD,CAoBlD;;;AACApC,WAAG,CAACoC,eAAJ,CAAoB7L,IAApB,CAAyBsF,EAAzB,EArBkD,CAsBlD;;;AACAA,UAAE,CAACsF,WAAH,GAAiB,YAAY;AACzBZ,YAAE,CAACP,GAAG,CAACoC,eAAL,EAAsBvG,EAAtB,CAAF;AACH,SAFD;AAGH,OA7IL;AAAA,UA8II8G,YAAY,GAAG;AACX,eAAO;AAACC,iBAAO,EAAE,CAAV;AAAaC,cAAI,EAAE;AAAnB,SADI;AAEX,kBAAU;AAACD,iBAAO,EAAE,CAAV;AAAaC,cAAI,EAAE;AAAnB,SAFC;AAGX,uBAAe;AAACD,iBAAO,EAAE,CAAV;AAAaC,cAAI,EAAE;AAAnB;AAHJ,OA9InB;AAAA,UAmJIC,UAAU,GAAG,SAAbA,UAAa,CAAUC,cAAV,EAA0BC,iBAA1B,EAA6C;AACtD,eAAO,UAAUhD,GAAV,EAAesB,GAAf,EAAoBzF,EAApB,EAAwBwF,QAAxB,EAAkC;AACrC;AACA;AACA,cAAIC,GAAG,IAAI,aAAP,IAAwB2B,aAA5B,EACIrB,cAAc,CAAC5B,GAAD,EAAMsB,GAAN,EAAWzF,EAAX,EAAewF,QAAf,CAAd,CADJ,KAEK;AACD;AACA;AACA;AACA;AACA;AACA,gBAAIrB,GAAG,CAACkD,cAAJ,IAAsB,IAA1B,EAAgC;AAC5B,kBAAIC,EAAE,GAAGnD,GAAG,CAACkD,cAAJ,GAAqB;AAC1BE,mBAAG,EAAE,EADqB;AAE1BC,sBAAM,EAAE,EAFkB;AAG1BC,2BAAW,EAAE,EAHa;AAI1BjB,oBAAI,EAAE,KAJoB;AAK1BQ,oBAAI,EAAE,CALoB;AAM1BU,6BAAa,EAAE;AANW,eAA9B;;AAQA,kBAAIlB,IAAI,GAAG,SAAPA,IAAO,CAAUxC,CAAV,EAAa;AAChB,oBAAI9B,MAAM,GAAG6B,EAAE,CAACC,CAAD,CAAf;AAAA,oBAAoB4B,QAAQ,GAAG1B,GAAG,CAACF,CAAD,EAAI9B,MAAJ,EAAYiC,GAAZ,EAAiBqB,QAAQ,IAAI,IAA7B,CAAlC;AAAA,oBAAsEmC,QAAQ,GAAG,KAAjF;;AACA,qBAAK,IAAIlN,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGmL,QAAQ,CAACtB,GAA7B,EAAkC7J,CAAC,EAAnC,EAAuC;AACnC,sBAAIkN,QAAJ,EAAc;AACdzF,wBAAM,GAAG0D,QAAQ,CAACvB,IAAT,CAAc5J,CAAd,CAAT;;AACA,uBAAK,IAAIzE,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGsR,EAAE,CAACI,aAAH,CAAiBhS,MAArC,EAA6CM,CAAC,EAA9C,EAAkD;AAC9C,wBAAIsR,EAAE,CAACI,aAAH,CAAiB1R,CAAjB,KAAuB,IAAvB,IAA+BmN,eAAe,CAACjB,MAAD,EAASoF,EAAE,CAACI,aAAH,CAAiB1R,CAAjB,CAAT,EAA8BmO,GAA9B,CAAlD,EAAsF;AAClFmD,wBAAE,CAACd,IAAH,GAAU,IAAV;AACAoB,gCAAU,CAACC,WAAD,EAAcX,cAAd,CAAV;AACAU,gCAAU,CAACE,WAAD,EAAcX,iBAAd,CAAV;AACAQ,8BAAQ,GAAG,IAAX;AACA,4BALkF,CAK3E;AACV;AACJ;AACJ;AACJ,eAfL;AAAA,kBAgBIhB,EAAE,GAAG,SAALA,EAAK,CAAU3C,CAAV,EAAa;AACd,oBAAIsD,EAAE,CAACd,IAAP,EAAa;AACT,sBAAItE,MAAM,GAAG6B,EAAE,CAACC,CAAD,CAAf;AAAA,sBAAoB+D,aAApB;AAAA,sBAAmCnC,QAAnC;;AACA0B,oBAAE,CAACN,IAAH;;AACA,sBAAIgB,EAAE,GAAGC,WAAW,CAACjE,CAAD,CAApB;;AACA,uBAAK,IAAIkE,OAAT,IAAoBpB,YAApB,EAAkC;AAC9B,wBAAIA,YAAY,CAACqB,cAAb,CAA4BD,OAA5B,CAAJ,EAA0C;AACtC,0BAAIzN,CAAC,GAAGqM,YAAY,CAACoB,OAAD,CAApB;;AACA,0BAAIzN,CAAC,CAACsM,OAAF,KAAciB,EAAd,KAAqBvN,CAAC,CAACuM,IAAF,KAAW,CAAX,IAAgBvM,CAAC,CAACuM,IAAF,KAAWM,EAAE,CAACN,IAAnD,CAAJ,EAA8D;AAC1D,6BAAK,IAAIhR,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGsR,EAAE,CAACY,OAAD,CAAF,CAAYxS,MAAhC,EAAwCM,CAAC,EAAzC,EAA6C;AACzC4P,kCAAQ,GAAG1B,GAAG,CAACF,CAAD,EAAI9B,MAAJ,EAAYiC,GAAZ,EAAiBmD,EAAE,CAACY,OAAD,CAAF,CAAYlS,CAAZ,EAAe,CAAf,KAAqB,IAAtC,CAAd;;AACA,+BAAK,IAAIoS,KAAK,GAAG,CAAjB,EAAoBA,KAAK,GAAGxC,QAAQ,CAACtB,GAArC,EAA0C8D,KAAK,EAA/C,EAAmD;AAC/CL,yCAAa,GAAGnC,QAAQ,CAACvB,IAAT,CAAc+D,KAAd,CAAhB,CAD+C,CAE/C;;AACA,gCAAId,EAAE,CAACY,OAAD,CAAF,CAAYlS,CAAZ,EAAe,CAAf,KAAqB,IAArB,IAA6BmN,eAAe,CAAC4E,aAAD,EAAgBT,EAAE,CAACY,OAAD,CAAF,CAAYlS,CAAZ,EAAe,CAAf,CAAhB,EAAmCmO,GAAnC,CAAhD,EAAyF;AACrFmD,gCAAE,CAACY,OAAD,CAAF,CAAYlS,CAAZ,EAAe,CAAf,EAAkBqH,KAAlB,CAAwB0K,aAAxB,EAAuC,CAAE/D,CAAF,CAAvC;AACA;AACH;AACJ;AACJ;AACJ;AACJ;AACJ;AACJ;AACJ,eAxCL;AAAA,kBAyCI6D,WAAW,GAAG,SAAdA,WAAc,GAAY;AACtBP,kBAAE,CAACd,IAAH,GAAU,KAAV;AACH,eA3CL;AAAA,kBA4CIsB,WAAW,GAAG,SAAdA,WAAc,GAAY;AACtBR,kBAAE,CAACN,IAAH,GAAU,CAAV;AACH,eA9CL;;AAgDAjB,4BAAc,CAAC5B,GAAD,EAAM,WAAN,EAAmBqC,IAAnB,CAAd;AACAT,4BAAc,CAAC5B,GAAD,EAAM,SAAN,EAAiBwC,EAAjB,CAAd;AACH,aAjEA,CAkED;;;AACAxC,eAAG,CAACkD,cAAJ,CAAmBK,aAAnB,CAAiChN,IAAjC,CAAsC8K,QAAtC;;AAEArB,eAAG,CAACkD,cAAJ,CAAmB5B,GAAnB,EAAwB/K,IAAxB,CAA6B,CAACsF,EAAD,EAAKwF,QAAL,CAA7B,EArEC,CAsED;;;AACAxF,cAAE,CAACsF,WAAH,GAAiB,YAAY;AACzBZ,gBAAE,CAACP,GAAG,CAACkD,cAAJ,CAAmB5B,GAAnB,CAAD,EAA0BzF,EAA1B,CAAF;AACH,aAFD;AAGH;AACJ,SAhFD;AAiFH,OArOL;AAAA,UAsOIqI,SAAS,GAAG,SAAZA,SAAY,CAAUC,IAAV,EAAgB7C,GAAhB,EAAqBtB,GAArB,EAA0BjC,MAA1B,EAAkC;AAC1C,aAAK,IAAIlM,CAAT,IAAcmO,GAAG,CAACoE,OAAJ,CAAYD,IAAZ,CAAd,EAAiC;AAC7B,cAAInE,GAAG,CAACoE,OAAJ,CAAYD,IAAZ,EAAkBH,cAAlB,CAAiCnS,CAAjC,CAAJ,EAAyC;AACrCmO,eAAG,CAACoE,OAAJ,CAAYD,IAAZ,EAAkBtS,CAAlB,EAAqBqH,KAArB,CAA2B6E,MAA3B,EAAmC,CAAEuD,GAAF,CAAnC;AACH;AACJ;AACJ,OA5OL;AAAA,UA6OI+C,qBAAqB,GAAG,SAAxBA,qBAAwB,GAAY;AAChC,YAAIC,cAAc,GAAG,EAArB;AACA,eAAO,UAAUtE,GAAV,EAAesB,GAAf,EAAoBzF,EAApB,EAAwBwF,QAAxB,EAAkC;AACrC,cAAI,CAACrB,GAAG,CAACoE,OAAT,EAAkB;AACd;AACA;AACApE,eAAG,CAACoE,OAAJ,GAAc;AAAEG,kBAAI,EAAE,KAAR;AAAeC,wBAAU,EAAE,EAA3B;AAA+BC,uBAAS,EAAE;AAA1C,aAAd,CAHc,CAId;;AACA,gBAAIF,IAAI,GAAG,SAAPA,IAAO,CAAU1E,CAAV,EAAa;AAChB,kBAAIjO,CAAC,GAAGgO,EAAE,CAACC,CAAD,CAAV;;AACA,kBAAKwB,QAAQ,IAAI,IAAZ,IAAqBzP,CAAC,IAAIoO,GAAL,IAAY,CAACA,GAAG,CAACoE,OAAJ,CAAYG,IAA/C,IAA0DvF,eAAe,CAACpN,CAAD,EAAIyP,QAAJ,EAAcrB,GAAd,CAAf,KAAsCpO,CAAC,CAACwS,OAAF,IAAa,IAAb,IAAqB,CAACxS,CAAC,CAACwS,OAAF,CAAUG,IAAtE,CAA9D,EAA4I;AACxIL,yBAAS,CAAC,YAAD,EAAerE,CAAf,EAAkBG,GAAlB,EAAuBpO,CAAvB,CAAT;AACAA,iBAAC,CAACwS,OAAF,GAAYxS,CAAC,CAACwS,OAAF,IAAa,EAAzB;AACAxS,iBAAC,CAACwS,OAAF,CAAUG,IAAV,GAAiB,IAAjB;AACAD,8BAAc,CAAC/N,IAAf,CAAoB3E,CAApB;AACH;AACJ,aARL;AAAA,gBASIyO,GAAG,GAAG,SAANA,GAAM,CAAUR,CAAV,EAAa;AACf,kBAAIjO,CAAC,GAAGgO,EAAE,CAACC,CAAD,CAAV,CADe,CAEf;AACA;;;AACA,mBAAK,IAAIhO,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGyS,cAAc,CAAC/S,MAAnC,EAA2CM,CAAC,EAA5C,EAAgD;AAC5C,oBAAID,CAAC,IAAI0S,cAAc,CAACzS,CAAD,CAAnB,IAA0B,CAACmN,eAAe,CAAEa,CAAC,CAAC6E,aAAF,IAAmB7E,CAAC,CAAC8E,SAAvB,EAAmC,GAAnC,EAAwC/S,CAAxC,CAA9C,EAA0F;AACtFA,mBAAC,CAACwS,OAAF,CAAUG,IAAV,GAAiB,KAAjB;AACAD,gCAAc,CAAC7D,MAAf,CAAsB5O,CAAtB,EAAyB,CAAzB;AACAqS,2BAAS,CAAC,WAAD,EAAcrE,CAAd,EAAiBG,GAAjB,EAAsBpO,CAAtB,CAAT;AACH;AACJ;AACJ,aApBL;;AAsBAoQ,iBAAK,CAAChC,GAAD,EAAM,WAAN,EAAmBoB,iBAAiB,CAACC,QAAD,EAAWrB,GAAX,EAAgBuE,IAAhB,EAAsB,WAAtB,CAApC,EAAwEA,IAAxE,CAAL;;AACAvC,iBAAK,CAAChC,GAAD,EAAM,UAAN,EAAkBoB,iBAAiB,CAACC,QAAD,EAAWrB,GAAX,EAAgBK,GAAhB,EAAqB,UAArB,CAAnC,EAAqEA,GAArE,CAAL;AACH;;AAEDxE,YAAE,CAACsF,WAAH,GAAiB,YAAY;AACzB,mBAAOnB,GAAG,CAACoE,OAAJ,CAAY9C,GAAZ,EAAiBzF,EAAE,CAACkF,OAApB,CAAP;AACH,WAFD;;AAIAJ,gBAAM,CAACX,GAAD,EAAMsB,GAAN,EAAWzF,EAAX,CAAN;;AACAmE,aAAG,CAACoE,OAAJ,CAAY9C,GAAZ,EAAiBzF,EAAE,CAACkF,OAApB,IAA+BlF,EAA/B;AACH,SAtCD;AAuCH,OAtRL;AAAA,UAuRIgG,aAAa,GAAG,kBAAkBnC,QAAQ,CAACkF,eAA3B,IAA8CC,SAAS,CAACC,cAvR5E;AAAA,UAwRI7B,aAAa,IAAG,iBAAiBvD,QAAQ,CAACkF,eAA7B,CAxRjB;AAAA,UAyRI9C,QAAQ,GAAG;AAAE,qBAAa,YAAf;AAA6B,mBAAW,UAAxC;AAAoD,qBAAa;AAAjE,OAzRf;AAAA,UA0RIiD,UAAU,GAAG,YA1RjB;AAAA,UA0R+BC,QAAQ,GAAG,UA1R1C;AAAA,UA0RsDC,SAAS,GAAG,WA1RlE;AAAA,UA2RIC,GAAG,GAAI,YAAY;AACf,YAAIC,EAAE,GAAG,CAAC,CAAV;;AACA,YAAIN,SAAS,CAACO,OAAV,IAAqB,6BAAzB,EAAwD;AACpD,cAAIC,EAAE,GAAGR,SAAS,CAACS,SAAnB;AAAA,cACIC,EAAE,GAAG,IAAIC,MAAJ,CAAW,6BAAX,CADT;AAEA,cAAID,EAAE,CAACE,IAAH,CAAQJ,EAAR,KAAe,IAAnB,EACIF,EAAE,GAAGzS,UAAU,CAAC8S,MAAM,CAACE,EAAR,CAAf;AACP;;AACD,eAAOP,EAAP;AACH,OATK,EA3RV;AAAA,UAqSIQ,OAAO,GAAGT,GAAG,GAAG,CAAC,CAAP,IAAYA,GAAG,GAAG,CArShC;AAAA,UAsSIU,OAAO,GAAG,SAAVA,OAAU,CAAU/F,CAAV,EAAagG,MAAb,EAAqB;AAC3B,YAAIhG,CAAC,IAAI,IAAT,EAAe,OAAO,CAAE,CAAF,EAAK,CAAL,CAAP;;AACf,YAAIiG,EAAE,GAAGC,QAAQ,CAAClG,CAAD,CAAjB;AAAA,YAAsBjO,CAAC,GAAGoU,SAAS,CAACF,EAAD,EAAK,CAAL,CAAnC;;AACA,eAAO,CAAClU,CAAC,CAACiU,MAAM,GAAG,GAAV,CAAF,EAAkBjU,CAAC,CAACiU,MAAM,GAAG,GAAV,CAAnB,CAAP;AACH,OA1SL;AAAA,UA2SItD,aAAa,GAAG,SAAhBA,aAAgB,CAAU1C,CAAV,EAAa;AACzB,YAAIA,CAAC,IAAI,IAAT,EAAe,OAAO,CAAE,CAAF,EAAK,CAAL,CAAP;;AACf,YAAI8F,OAAJ,EAAa;AACT,iBAAO,CAAE9F,CAAC,CAACzB,OAAF,GAAYsB,QAAQ,CAACkF,eAAT,CAAyBqB,UAAvC,EAAmDpG,CAAC,CAACxB,OAAF,GAAYqB,QAAQ,CAACkF,eAAT,CAAyBsB,SAAxF,CAAP;AACH,SAFD,MAGK;AACD,iBAAON,OAAO,CAAC/F,CAAD,EAAI,MAAJ,CAAd;AACH;AACJ,OAnTL;AAAA,UAoTIsG,eAAe,GAAG,SAAlBA,eAAkB,CAAUtG,CAAV,EAAa;AAC3B,eAAO+F,OAAO,CAAC/F,CAAD,EAAI,QAAJ,CAAd;AACH,OAtTL;AAAA,UAuTIuG,eAAe,GAAG,SAAlBA,eAAkB,CAAUvG,CAAV,EAAa;AAC3B,eAAO+F,OAAO,CAAC/F,CAAD,EAAI,QAAJ,CAAd;AACH,OAzTL;AAAA,UA0TImG,SAAS,GAAG,SAAZA,SAAY,CAAUpD,OAAV,EAAmByD,GAAnB,EAAwB;AAChC,eAAOzD,OAAO,CAAC/D,IAAR,GAAe+D,OAAO,CAAC/D,IAAR,CAAawH,GAAb,CAAf,GAAmCzD,OAAO,CAACyD,GAAD,CAAjD;AACH,OA5TL;AAAA,UA6TIN,QAAQ,GAAG,SAAXA,QAAW,CAAUlG,CAAV,EAAa;AACpB,eAAOA,CAAC,CAAC+C,OAAF,IAAa/C,CAAC,CAAC+C,OAAF,CAAUrR,MAAV,GAAmB,CAAhC,GAAoCsO,CAAC,CAAC+C,OAAtC,GACC/C,CAAC,CAACyG,cAAF,IAAoBzG,CAAC,CAACyG,cAAF,CAAiB/U,MAAjB,GAA0B,CAA9C,GAAkDsO,CAAC,CAACyG,cAApD,GACAzG,CAAC,CAAC0G,aAAF,IAAmB1G,CAAC,CAAC0G,aAAF,CAAgBhV,MAAhB,GAAyB,CAA5C,GAAgDsO,CAAC,CAAC0G,aAAlD,GACJ,CAAE1G,CAAF,CAHJ;AAIH,OAlUL;AAAA,UAmUIiE,WAAW,GAAG,SAAdA,WAAc,CAAUjE,CAAV,EAAa;AACvB,eAAOkG,QAAQ,CAAClG,CAAD,CAAR,CAAYtO,MAAnB;AACH,OArUL;AAAA,UAsUA;AACIyQ,WAAK,GAAG,SAARA,KAAQ,CAAUhC,GAAV,EAAemE,IAAf,EAAqBtI,EAArB,EAAyB2K,UAAzB,EAAqC;AACzC7F,cAAM,CAACX,GAAD,EAAMmE,IAAN,EAAYtI,EAAZ,CAAN;;AACA2K,kBAAU,CAACzF,OAAX,GAAqBlF,EAAE,CAACkF,OAAxB;AACA,YAAIf,GAAG,CAACyG,gBAAR,EACIzG,GAAG,CAACyG,gBAAJ,CAAqBtC,IAArB,EAA2BtI,EAA3B,EAA+B,KAA/B,EADJ,KAEK,IAAImE,GAAG,CAAC0G,WAAR,EAAqB;AACtB,cAAIC,GAAG,GAAGxC,IAAI,GAAGtI,EAAE,CAACkF,OAApB;AACAf,aAAG,CAAC,MAAM2G,GAAP,CAAH,GAAiB9K,EAAjB,CAFsB,CAGtB;;AACAmE,aAAG,CAAC2G,GAAD,CAAH,GAAW,YAAY;AACnB3G,eAAG,CAAC,MAAM2G,GAAP,CAAH,IAAkB3G,GAAG,CAAC,MAAM2G,GAAP,CAAH,CAAerL,MAAM,CAACsF,KAAtB,CAAlB;AACH,WAFD;;AAGAZ,aAAG,CAAC0G,WAAJ,CAAgB,OAAOvC,IAAvB,EAA6BnE,GAAG,CAAC2G,GAAD,CAAhC;AACH;AACJ,OArVL;AAAA,UAsVIzF,OAAO,GAAG,SAAVA,OAAU,CAAUlB,GAAV,EAAemE,IAAf,EAAqBtI,EAArB,EAAyB;AAC/B,YAAIA,EAAE,IAAI,IAAV,EAAgB;;AAChB+K,aAAK,CAAC5G,GAAD,EAAM,YAAY;AACnB,cAAI6G,GAAG,GAAGtH,IAAI,CAAC,IAAD,CAAd;;AACAyB,kBAAQ,CAAC6F,GAAD,EAAM1C,IAAN,EAAYtI,EAAZ,CAAR,CAFmB,CAGnB;;;AACA,cAAIA,EAAE,CAACkF,OAAH,IAAc,IAAlB,EAAwB;AACpB,gBAAI8F,GAAG,CAACC,mBAAR,EAA6B;AACzBD,iBAAG,CAACC,mBAAJ,CAAwB3C,IAAxB,EAA8BtI,EAA9B,EAAkC,KAAlC;;AACA,kBAAIgG,aAAa,IAAIC,QAAQ,CAACqC,IAAD,CAA7B,EAAqC0C,GAAG,CAACC,mBAAJ,CAAwBhF,QAAQ,CAACqC,IAAD,CAAhC,EAAwCtI,EAAxC,EAA4C,KAA5C;AACxC,aAHD,MAIK,IAAI,KAAKkL,WAAT,EAAsB;AACvB,kBAAIJ,GAAG,GAAGxC,IAAI,GAAGtI,EAAE,CAACkF,OAApB;AACA8F,iBAAG,CAACF,GAAD,CAAH,IAAYE,GAAG,CAACE,WAAJ,CAAgB,OAAO5C,IAAvB,EAA6B0C,GAAG,CAACF,GAAD,CAAhC,CAAZ;AACAE,iBAAG,CAACF,GAAD,CAAH,GAAW,IAAX;AACAE,iBAAG,CAAC,MAAMF,GAAP,CAAH,GAAiB,IAAjB;AACH;AACJ,WAfkB,CAiBnB;;;AACA,cAAI9K,EAAE,CAACmL,cAAP,EAAuB;AACnB9F,mBAAO,CAAClB,GAAD,EAAMnE,EAAE,CAACmL,cAAH,CAAkB,CAAlB,CAAN,EAA4BnL,EAAE,CAACmL,cAAH,CAAkB,CAAlB,CAA5B,CAAP;AACH;AACJ,SArBI,CAAL;AAsBH,OA9WL;AAAA,UA+WIJ,KAAK,GAAG,SAARA,KAAQ,CAAU5G,GAAV,EAAenE,EAAf,EAAmB;AACvB,YAAImE,GAAG,IAAI,IAAX,EAAiB,OADM,CAEvB;AACA;AACA;AACA;;AACAA,WAAG,GAAI,OAAOiH,MAAP,KAAkB,WAAlB,IAAkC,OAAOjH,GAAG,CAACkH,GAAX,KAAmB,SAAnB,IAAgClH,GAAG,IAAIA,GAAG,CAACkH,GAA9E,GAAsF,CAAElH,GAAF,CAAtF,GACG,OAAOA,GAAP,KAAe,QAAhB,IAA8BA,GAAG,CAACmH,OAAJ,IAAe,IAAf,IAAuBnH,GAAG,CAACzO,MAAJ,IAAc,IAAnE,GAA2EyO,GAA3E,GACA,OAAOA,GAAP,KAAe,QAAf,GAA0BN,QAAQ,CAACJ,gBAAT,CAA0BU,GAA1B,CAA1B,GACF,CAAEA,GAAF,CAHN;;AAKA,aAAK,IAAInO,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGmO,GAAG,CAACzO,MAAxB,EAAgCM,CAAC,EAAjC;AACIgK,YAAE,CAAC3C,KAAH,CAAS8G,GAAG,CAACnO,CAAD,CAAZ;AADJ;AAEH,OA5XL;AAAA,UA6XI2M,KAAK,GAAG,SAARA,KAAQ,GAAY;AAChB,eAAQ,uCAAuC4I,OAAvC,CAA+C,OAA/C,EAAwD,UAAUhV,CAAV,EAAa;AACzE,cAAI4G,CAAC,GAAGjJ,IAAI,CAACsX,MAAL,KAAgB,EAAhB,GAAqB,CAA7B;AAAA,cAAgC5W,CAAC,GAAG2B,CAAC,IAAI,GAAL,GAAW4G,CAAX,GAAgBA,CAAC,GAAG,GAAJ,GAAU,GAA9D;AACA,iBAAOvI,CAAC,CAACkL,QAAF,CAAW,EAAX,CAAP;AACH,SAHO,CAAR;AAIH,OAlYL;AAoYA;;;;;;;;;;;;;;;AAaA7L,UAAI,CAACwX,MAAL,GAAc,UAAUC,MAAV,EAAkB;AAC5BA,cAAM,GAAGA,MAAM,IAAI,EAAnB;;AACA,YAAIxE,cAAc,GAAGwE,MAAM,CAACxE,cAAP,IAAyB,GAA9C;AAAA,YACIC,iBAAiB,GAAGuE,MAAM,CAACvE,iBAAP,IAA4B,GADpD;AAAA,YAEIwE,qBAAqB,GAAG,IAAInD,qBAAJ,EAF5B;AAAA,YAGIoD,UAAU,GAAG,IAAI3E,UAAJ,CAAeC,cAAf,EAA+BC,iBAA/B,CAHjB;AAAA,YAII0E,YAAY,GAAGH,MAAM,CAACI,WAJ1B;AAAA,YAKIC,OAAO,GAAG,SAAVA,OAAU,CAAU5H,GAAV,EAAesB,GAAf,EAAoBzF,EAApB,EAAwBwF,QAAxB,EAAkC;AACxC,cAAIxF,EAAE,IAAI,IAAV,EAAgB;;AAChB+K,eAAK,CAAC5G,GAAD,EAAM,YAAY;AACnB,gBAAI6G,GAAG,GAAGtH,IAAI,CAAC,IAAD,CAAd;;AACA,gBAAImI,YAAY,IAAIpG,GAAG,KAAK,OAA5B,EACIa,iBAAiB,CAAC0E,GAAD,EAAMvF,GAAN,EAAWzF,EAAX,EAAewF,QAAf,CAAjB,CADJ,KAEK,IAAIC,GAAG,KAAK,KAAR,IAAiBA,GAAG,KAAK,QAAzB,IAAqCA,GAAG,KAAK,aAAjD,EAAgE;AACjEmG,wBAAU,CAACZ,GAAD,EAAMvF,GAAN,EAAWzF,EAAX,EAAewF,QAAf,CAAV;AACH,aAFI,MAGA,IAAIC,GAAG,KAAK,YAAR,IAAwBA,GAAG,IAAI,WAAnC,EACDkG,qBAAqB,CAACX,GAAD,EAAMvF,GAAN,EAAWzF,EAAX,EAAewF,QAAf,CAArB,CADC,KAGDO,cAAc,CAACiF,GAAD,EAAMvF,GAAN,EAAWzF,EAAX,EAAewF,QAAf,CAAd;AACP,WAXI,CAAL;AAYH,SAnBL;AAqBA;;;;;;;;;AAOA,aAAKwG,MAAL,GAAc,UAAU5I,EAAV,EAAc;AACxB2H,eAAK,CAAC3H,EAAD,EAAK,YAAY;AAClB,gBAAI4H,GAAG,GAAGtH,IAAI,CAAC,IAAD,CAAd;;AACA,gBAAIsH,GAAG,CAAC/F,IAAR,EAAc;AACV,mBAAK,IAAIQ,GAAT,IAAgBuF,GAAG,CAAC/F,IAApB,EAA0B;AACtB,oBAAI+F,GAAG,CAAC/F,IAAJ,CAASkD,cAAT,CAAwB1C,GAAxB,CAAJ,EAAkC;AAC9B,uBAAK,IAAI/H,CAAT,IAAcsN,GAAG,CAAC/F,IAAJ,CAASQ,GAAT,CAAd,EAA6B;AACzB,wBAAIuF,GAAG,CAAC/F,IAAJ,CAASQ,GAAT,EAAc0C,cAAd,CAA6BzK,CAA7B,CAAJ,EACI2H,OAAO,CAAC2F,GAAD,EAAMvF,GAAN,EAAWuF,GAAG,CAAC/F,IAAJ,CAASQ,GAAT,EAAc/H,CAAd,CAAX,CAAP;AACP;AACJ;AACJ;AACJ;;AACDsN,eAAG,CAACzH,UAAJ,IAAkByH,GAAG,CAACzH,UAAJ,CAAe0I,WAAf,CAA2BjB,GAA3B,CAAlB;AACH,WAbI,CAAL;;AAcA,iBAAO,IAAP;AACH,SAhBD;AAkBA;;;;;;;;;;;;;AAWA,aAAKkB,EAAL,GAAU,UAAU9I,EAAV,EAAc2B,KAAd,EAAqBS,QAArB,EAA+BxF,EAA/B,EAAmC;AACzC,cAAIgL,GAAG,GAAGjI,SAAS,CAAC,CAAD,CAAnB;AAAA,cACIoJ,EAAE,GAAGpJ,SAAS,CAACrN,MAAV,IAAoB,CAApB,GAAwBqN,SAAS,CAAC,CAAD,CAAjC,GAAuC,IADhD;AAAA,cAEIqJ,EAAE,GAAGrJ,SAAS,CAAC,CAAD,CAFlB;AAAA,cAGIsJ,EAAE,GAAGtJ,SAAS,CAACA,SAAS,CAACrN,MAAV,GAAmB,CAApB,CAHlB;;AAKAqW,iBAAO,CAACf,GAAD,EAAMoB,EAAN,EAAUC,EAAV,EAAcF,EAAd,CAAP;;AACA,iBAAO,IAAP;AACH,SARD;AAUA;;;;;;;;;;;;AAUA,aAAKG,GAAL,GAAW,UAAUlJ,EAAV,EAAc2B,KAAd,EAAqB/E,EAArB,EAAyB;AAChCqF,iBAAO,CAACjC,EAAD,EAAK2B,KAAL,EAAY/E,EAAZ,CAAP;;AACA,iBAAO,IAAP;AACH,SAHD;AAKA;;;;;;;;;;;;AAUA,aAAKuM,OAAL,GAAe,UAAUnJ,EAAV,EAAc2B,KAAd,EAAqByH,aAArB,EAAoCC,OAApC,EAA6C;AACxD;AACA,cAAIC,eAAe,GAAGtF,aAAa,KAAK,OAAOuF,UAAP,KAAsB,WAAtB,IAAqCH,aAAa,IAAI,IAAtD,IAA8DA,aAAa,CAAC7I,WAAd,KAA8BgJ,UAAjG,CAAnC;AAEA,cAAIC,WAAW,GAAI5G,aAAa,IAAI,CAACoB,aAAlB,IAAmCnB,QAAQ,CAAClB,KAAD,CAA5C,GAAuDkB,QAAQ,CAAClB,KAAD,CAA/D,GAAyEA,KAA3F;AAAA,cACI8H,kBAAkB,GAAG,EAAE7G,aAAa,IAAI,CAACoB,aAAlB,IAAmCnB,QAAQ,CAAClB,KAAD,CAA7C,CADzB;;AAGA,cAAI+H,EAAE,GAAGpG,aAAa,CAAC8F,aAAD,CAAtB;AAAA,cAAuCO,EAAE,GAAGzC,eAAe,CAACkC,aAAD,CAA3D;AAAA,cAA4EQ,EAAE,GAAGzC,eAAe,CAACiC,aAAD,CAAhG;;AACAzB,eAAK,CAAC3H,EAAD,EAAK,YAAY;AAClB,gBAAI4H,GAAG,GAAGtH,IAAI,CAAC,IAAD,CAAd;AAAA,gBAAsB+B,GAAtB;;AACA+G,yBAAa,GAAGA,aAAa,IAAI;AAC7BnK,qBAAO,EAAE0K,EAAE,CAAC,CAAD,CADkB;AAE7BzK,qBAAO,EAAEyK,EAAE,CAAC,CAAD,CAFkB;AAG7BxK,qBAAO,EAAEyK,EAAE,CAAC,CAAD,CAHkB;AAI7BxK,qBAAO,EAAEwK,EAAE,CAAC,CAAD;AAJkB,aAAjC;;AAOA,gBAAIC,SAAS,GAAG,SAAZA,SAAY,CAAUC,IAAV,EAAgB;AAC5B,kBAAIT,OAAJ,EAAaS,IAAI,CAACT,OAAL,GAAeA,OAAf;AAChB,aAFD;;AAIA,gBAAIU,eAAe,GAAG;AAClB,4BAAc,oBAAU1H,GAAV,EAAe;AAEzB,oBAAI2H,SAAS,GAAGlK,aAAa,CAACzD,MAAD,EAASuL,GAAT,EAAc,CAAd,EAAiB8B,EAAE,CAAC,CAAD,CAAnB,EAAwBA,EAAE,CAAC,CAAD,CAA1B,EAA+BC,EAAE,CAAC,CAAD,CAAjC,EAAsCA,EAAE,CAAC,CAAD,CAAxC,EAA6CC,EAAE,CAAC,CAAD,CAA/C,EAAoDA,EAAE,CAAC,CAAD,CAAtD,CAA7B;AAAA,oBACIK,IAAI,GAAG5H,GAAG,CAAC6H,cAAJ,IAAsB7H,GAAG,CAAC8H,SADrC;;AAGAF,oBAAI,CAACT,WAAD,EAAc,IAAd,EAAoB,IAApB,EAA0BnN,MAA1B,EAAkC,IAAlC,EAAwCsN,EAAE,CAAC,CAAD,CAA1C,EAA+CA,EAAE,CAAC,CAAD,CAAjD,EACAC,EAAE,CAAC,CAAD,CADF,EACOA,EAAE,CAAC,CAAD,CADT,EACc,KADd,EACqB,KADrB,EAC4B,KAD5B,EACmC,KADnC,EAEAI,SAFA,EAEWA,SAFX,EAEsBA,SAFtB,EAEiC,CAFjC,EAEoC,CAFpC,CAAJ;AAGH,eATiB;AAUlB,6BAAe,qBAAU3H,GAAV,EAAe;AAC1BA,mBAAG,CAAC+H,cAAJ,CAAmBZ,WAAnB,EAAgC,IAAhC,EAAsC,IAAtC,EAA4CnN,MAA5C,EAAoD,CAApD,EACIsN,EAAE,CAAC,CAAD,CADN,EACWA,EAAE,CAAC,CAAD,CADb,EAEIC,EAAE,CAAC,CAAD,CAFN,EAEWA,EAAE,CAAC,CAAD,CAFb,EAGI,KAHJ,EAGW,KAHX,EAGkB,KAHlB,EAGyB,KAHzB,EAGgC,CAHhC,EAGmChC,GAHnC;AAIH;AAfiB,aAAtB;;AAkBA,gBAAInH,QAAQ,CAAC4J,WAAb,EAA0B;AAEtB,kBAAIC,GAAG,GAAG,CAACb,kBAAD,IAAuB,CAACH,eAAxB,IAA4C1G,aAAa,IAAIC,QAAQ,CAAClB,KAAD,CAA/E;AAAA,kBACI4I,OAAO,GAAGD,GAAG,GAAG,YAAH,GAAkB,aADnC;AAGAjI,iBAAG,GAAG5B,QAAQ,CAAC4J,WAAT,CAAqBE,OAArB,CAAN;AACAR,6BAAe,CAACQ,OAAD,CAAf,CAAyBlI,GAAzB;;AACAwH,uBAAS,CAACxH,GAAD,CAAT;;AACAuF,iBAAG,CAAC4C,aAAJ,CAAkBnI,GAAlB;AACH,aATD,MAUK,IAAI5B,QAAQ,CAACgK,iBAAb,EAAgC;AACjCpI,iBAAG,GAAG5B,QAAQ,CAACgK,iBAAT,EAAN;AACApI,iBAAG,CAACqI,SAAJ,GAAgBrI,GAAG,CAACsI,SAAJ,GAAgBnB,WAAhC;AACAnH,iBAAG,CAACpD,OAAJ,GAAc0K,EAAE,CAAC,CAAD,CAAhB;AACAtH,iBAAG,CAACnD,OAAJ,GAAcyK,EAAE,CAAC,CAAD,CAAhB;AACAtH,iBAAG,CAAClD,OAAJ,GAAcyK,EAAE,CAAC,CAAD,CAAhB;AACAvH,iBAAG,CAACjD,OAAJ,GAAcwK,EAAE,CAAC,CAAD,CAAhB;;AACAC,uBAAS,CAACxH,GAAD,CAAT;;AACAuF,iBAAG,CAACgD,SAAJ,CAAc,OAAOpB,WAArB,EAAkCnH,GAAlC;AACH;AACJ,WAnDI,CAAL;;AAoDA,iBAAO,IAAP;AACH,SA7DD;AA8DH,OA5JD;AA8JA;;;;;;;;;AAOAxR,UAAI,CAACwX,MAAL,CAAYwC,OAAZ,GAAsB,UAAUjK,CAAV,EAAakK,mBAAb,EAAkC;AACpD,YAAIlK,CAAC,CAACmK,eAAN,EACInK,CAAC,CAACmK,eAAF,GADJ,KAGInK,CAAC,CAACoK,WAAF,GAAgB,KAAhB;AAEJ,YAAI,CAACF,mBAAD,IAAwBlK,CAAC,CAACqK,cAA9B,EACIrK,CAAC,CAACqK,cAAF;AACP,OARD;AAUA;;;;;;;;AAMApa,UAAI,CAACwX,MAAL,CAAY6C,YAAZ,GAA2B5H,aAA3B;AAEA;;;;;;;AAMAzS,UAAI,CAACwX,MAAL,CAAY8C,mBAAZ,GAAkC,UAAUnV,KAAV,EAAiB;AAC/C4M,qBAAa,GAAG5M,KAAhB;AACH,OAFD;AAIA;;;;;;;;AAMAnF,UAAI,CAACwX,MAAL,CAAY+C,mBAAZ,GAAkC,UAAUpV,KAAV,EAAiB;AAC/CgO,qBAAa,GAAGhO,KAAhB;AACH,OAFD;;AAIAnF,UAAI,CAACwX,MAAL,CAAYnM,OAAZ,GAAsB,OAAtB;;AAEA,UAAI,IAAJ,EAAoC;AAChCC,eAAO,CAACkM,MAAR,GAAiBxX,IAAI,CAACwX,MAAtB;AACH;AAEJ,KA9pBD,EA8pBGjM,IA9pBH,CA8pBQ,OAAOC,MAAP,KAAkB,WAAlB,GAAgC,IAAhC,GAAuCA,MA9pB/C;AAgqBA;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4BA;AAAC,KAAC,YAAW;AAET;;AACA,UAAIxL,IAAI,GAAG,IAAX;;AAEA,UAAIwa,QAAQ,GAAG,SAAXA,QAAW,CAAS5L,IAAT,EAAeG,IAAf,EAAqB0L,IAArB,EAA2B;AACtC,YAAI7L,IAAI,CAAC0B,OAAL,CAAavB,IAAb,MAAuB,CAAC,CAA5B,EAA+B;AAC3B0L,cAAI,GAAG7L,IAAI,CAAC8L,OAAL,CAAa3L,IAAb,CAAH,GAAwBH,IAAI,CAACnI,IAAL,CAAUsI,IAAV,CAA5B;AACA,iBAAO,IAAP;AACH;;AACD,eAAO,KAAP;AACH,OAND;;AAQA,UAAI4L,SAAS,GAAG,SAAZA,SAAY,CAAS/L,IAAT,EAAeG,IAAf,EAAqB;AACjC,YAAIwH,GAAG,GAAG3H,IAAI,CAAC0B,OAAL,CAAavB,IAAb,CAAV;AACA,YAAIwH,GAAG,KAAK,CAAC,CAAb,EAAgB3H,IAAI,CAAC+B,MAAL,CAAY4F,GAAZ,EAAiB,CAAjB;AACnB,OAHD;;AAKA,UAAIqE,WAAW,GAAG,SAAdA,WAAc,CAASC,EAAT,EAAaC,EAAb,EAAiB;AAC/B,YAAIvY,CAAC,GAAG,EAAR;;AACA,aAAK,IAAIR,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG8Y,EAAE,CAACpZ,MAAvB,EAA+BM,CAAC,EAAhC,EAAoC;AAChC,cAAI+Y,EAAE,CAACxK,OAAH,CAAWuK,EAAE,CAAC9Y,CAAD,CAAb,MAAsB,CAAC,CAA3B,EACIQ,CAAC,CAACkE,IAAF,CAAOoU,EAAE,CAAC9Y,CAAD,CAAT;AACP;;AACD,eAAOQ,CAAP;AACH,OAPD;;AASA,UAAIwY,SAAS,GAAG,SAAZA,SAAY,CAASC,CAAT,EAAY;AACxB,eAAOA,CAAC,IAAI,IAAL,GAAY,KAAZ,GAAqB,OAAOA,CAAP,KAAa,QAAb,IAAyBA,CAAC,CAACtL,WAAF,KAAkBC,MAAvE;AACH,OAFD;;AAIA,UAAIsL,aAAa,GAAG,SAAhBA,aAAgB,CAAUC,IAAV,EAAgB;AAChC;AACA,YAAIC,GAAG,GAAGD,IAAI,CAACE,qBAAL,EAAV;AAAA,YACIC,IAAI,GAAGzL,QAAQ,CAACyL,IADpB;AAAA,YAEIC,OAAO,GAAG1L,QAAQ,CAACkF,eAFvB;AAAA,YAGA;AACIsB,iBAAS,GAAG5K,MAAM,CAAC+P,WAAP,IAAsBD,OAAO,CAAClF,SAA9B,IAA2CiF,IAAI,CAACjF,SAJhE;AAAA,YAKID,UAAU,GAAG3K,MAAM,CAACgQ,WAAP,IAAsBF,OAAO,CAACnF,UAA9B,IAA4CkF,IAAI,CAAClF,UALlE;AAAA,YAMA;AACIsF,iBAAS,GAAGH,OAAO,CAACG,SAAR,IAAqBJ,IAAI,CAACI,SAA1B,IAAuC,CAPvD;AAAA,YAQIC,UAAU,GAAGJ,OAAO,CAACI,UAAR,IAAsBL,IAAI,CAACK,UAA3B,IAAyC,CAR1D;AAAA,YASA;AACItE,WAAG,GAAI+D,GAAG,CAAC/D,GAAJ,GAAWhB,SAAX,GAAuBqF,SAVlC;AAAA,YAWInY,IAAI,GAAG6X,GAAG,CAAC7X,IAAJ,GAAW6S,UAAX,GAAwBuF,UAXnC;AAaA,eAAO;AAAEtE,aAAG,EAAEnX,IAAI,CAAC0b,KAAL,CAAWvE,GAAX,CAAP;AAAwB9T,cAAI,EAAErD,IAAI,CAAC0b,KAAL,CAAWrY,IAAX;AAA9B,SAAP;AACH,OAhBD;;AAkBA,UAAI4L,eAAe,GAAG,SAAlBA,eAAkB,CAASC,EAAT,EAAaC,QAAb,EAAuBC,GAAvB,EAA4B;AAC9CA,WAAG,GAAGA,GAAG,IAAIF,EAAE,CAACG,UAAhB;AACA,YAAIC,SAAS,GAAGF,GAAG,CAACG,gBAAJ,CAAqBJ,QAArB,CAAhB;;AACA,aAAK,IAAIrN,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGwN,SAAS,CAAC9N,MAA9B,EAAsCM,CAAC,EAAvC,EAA2C;AACvC,cAAIwN,SAAS,CAACxN,CAAD,CAAT,KAAiBoN,EAArB,EACI,OAAO,IAAP;AACP;;AACD,eAAO,KAAP;AACH,OARD;;AAUA,UAAIyM,mBAAmB,GAAG,SAAtBA,mBAAsB,CAASC,aAAT,EAAwBC,YAAxB,EAAsC1M,QAAtC,EAAgD;AACtE,YAAIF,eAAe,CAAC4M,YAAD,EAAe1M,QAAf,EAAyByM,aAAzB,CAAnB,EAA4D;AACxD,iBAAOC,YAAP;AACH,SAFD,MAEO;AACH,cAAIC,aAAa,GAAGD,YAAY,CAACxM,UAAjC;;AACA,iBAAOyM,aAAa,IAAI,IAAjB,IAAyBA,aAAa,KAAKF,aAAlD,EAAiE;AAC7D,gBAAI3M,eAAe,CAAC6M,aAAD,EAAgB3M,QAAhB,EAA0ByM,aAA1B,CAAnB,EAA6D;AACzD,qBAAOE,aAAP;AACH,aAFD,MAEO;AACHA,2BAAa,GAAGA,aAAa,CAACzM,UAA9B;AACH;AACJ;AACJ;AACJ,OAbD;AAeA;;;;;;;;;;;;;;;AAaA,UAAI0M,oBAAoB,GAAG,SAAvBA,oBAAuB,CAASC,kBAAT,EAA6BJ,aAA7B,EAA4CC,YAA5C,EAA0D;AACjF,YAAI3M,EAAE,GAAG,IAAT;AACA,YAAI+M,WAAW,GAAGL,aAAa,CAAC1J,YAAd,CAA2B,qBAA3B,CAAlB;AAAA,YACI4D,MAAM,GAAGmG,WAAW,IAAI,IAAf,GAAsB,2BAA2BA,WAA3B,GAAyC,KAA/D,GAAuE,EADpF;;AAGA,aAAK,IAAIna,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGka,kBAAkB,CAACxa,MAAvC,EAA+CM,CAAC,EAAhD,EAAoD;AAChDoN,YAAE,GAAGyM,mBAAmB,CAACC,aAAD,EAAgBC,YAAhB,EAA8B/F,MAAM,GAAGkG,kBAAkB,CAACla,CAAD,CAAlB,CAAsBqN,QAA7D,CAAxB;;AACA,cAAID,EAAE,IAAI,IAAV,EAAgB;AACZ,gBAAI8M,kBAAkB,CAACla,CAAD,CAAlB,CAAsBoa,MAA1B,EAAkC;AAC9B,kBAAIC,OAAO,GAAGlN,eAAe,CAAC4M,YAAD,EAAeG,kBAAkB,CAACla,CAAD,CAAlB,CAAsBoa,MAArC,EAA6ChN,EAA7C,CAA7B;AAAA,kBACIkN,OAAO,GAAGJ,kBAAkB,CAACla,CAAD,CAAlB,CAAsBua,aAAtB,KAAwC,IADtD;;AAGA,kBAAMD,OAAO,IAAI,CAACD,OAAb,IAAyBA,OAA9B,EAAuC;AACnC,uBAAO,IAAP;AACH;AAEJ;;AACD,mBAAO,CAAEH,kBAAkB,CAACla,CAAD,CAApB,EAAyBoN,EAAzB,CAAP;AACH;AACJ;;AACD,eAAO,IAAP;AACH,OArBD;;AAuBA,UAAIiG,GAAG,GAAI,YAAW;AACd,YAAIC,EAAE,GAAG,CAAC,CAAV;;AACA,YAAIN,SAAS,CAACO,OAAV,KAAsB,6BAA1B,EAAyD;AACrD,cAAIC,EAAE,GAAGR,SAAS,CAACS,SAAnB;AAAA,cACIC,EAAE,GAAG,IAAIC,MAAJ,CAAW,6BAAX,CADT;AAEA,cAAID,EAAE,CAACE,IAAH,CAAQJ,EAAR,KAAe,IAAnB,EACIF,EAAE,GAAGzS,UAAU,CAAC8S,MAAM,CAACE,EAAR,CAAf;AACP;;AACD,eAAOP,EAAP;AACH,OATK,EAAV;AAAA,UAUIkH,cAAc,GAAG,EAVrB;AAAA,UAWIC,cAAc,GAAG,EAXrB;AAAA,UAYI3G,OAAO,GAAGT,GAAG,GAAG,CAAC,CAAP,IAAYA,GAAG,GAAG,CAZhC;AAAA,UAaIqH,KAAK,GAAGrH,GAAG,KAAK,CAbpB;AAAA,UAcIsH,GAAG,GAAG,SAANA,GAAM,CAAS3M,CAAT,EAAY;AACd,YAAI8F,OAAJ,EAAa;AACT,iBAAO,CAAE9F,CAAC,CAACzB,OAAF,GAAYsB,QAAQ,CAACkF,eAAT,CAAyBqB,UAAvC,EAAmDpG,CAAC,CAACxB,OAAF,GAAYqB,QAAQ,CAACkF,eAAT,CAAyBsB,SAAxF,CAAP;AACH,SAFD,MAGK;AACD,cAAIJ,EAAE,GAAGC,QAAQ,CAAClG,CAAD,CAAjB;AAAA,cAAsBjO,CAAC,GAAGoU,SAAS,CAACF,EAAD,EAAK,CAAL,CAAnC,CADC,CAED;AACA;;;AACA,iBAAOyG,KAAK,GAAG,CAAC3a,CAAC,CAACoM,KAAF,IAAWpM,CAAC,CAACwM,OAAd,EAAuBxM,CAAC,CAACqM,KAAF,IAAWrM,CAAC,CAACyM,OAApC,CAAH,GAAkD,CAACzM,CAAC,CAACoM,KAAH,EAAUpM,CAAC,CAACqM,KAAZ,CAA9D;AACH;AACJ,OAxBL;AAAA,UAyBI+H,SAAS,GAAG,SAAZA,SAAY,CAASpD,OAAT,EAAkByD,GAAlB,EAAuB;AAAE,eAAOzD,OAAO,CAAC/D,IAAR,GAAe+D,OAAO,CAAC/D,IAAR,CAAawH,GAAb,CAAf,GAAmCzD,OAAO,CAACyD,GAAD,CAAjD;AAAyD,OAzBlG;AAAA,UA0BIN,QAAQ,GAAG,SAAXA,QAAW,CAASlG,CAAT,EAAY;AACnB,eAAOA,CAAC,CAAC+C,OAAF,IAAa/C,CAAC,CAAC+C,OAAF,CAAUrR,MAAV,GAAmB,CAAhC,GAAoCsO,CAAC,CAAC+C,OAAtC,GACC/C,CAAC,CAACyG,cAAF,IAAoBzG,CAAC,CAACyG,cAAF,CAAiB/U,MAAjB,GAA0B,CAA9C,GAAkDsO,CAAC,CAACyG,cAApD,GACAzG,CAAC,CAAC0G,aAAF,IAAmB1G,CAAC,CAAC0G,aAAF,CAAgBhV,MAAhB,GAAyB,CAA5C,GAAgDsO,CAAC,CAAC0G,aAAlD,GACJ,CAAE1G,CAAF,CAHJ;AAIH,OA/BL;AAAA,UAgCI4M,QAAQ,GAAG;AACPC,0BAAkB,EAAC,+BADZ;AAC8C;AACrDC,iBAAS,EAAC,qBAFH;AAE6B;AACpCC,iBAAS,EAAC,qBAHH;AAG6B;AACpCC,YAAI,EAAG,gBAJA;AAI6B;AACpCC,gBAAQ,EAAC,yBALF;AAK6B;AACpCC,cAAM,EAAG,uBANF;AAM6B;AACpCC,aAAK,EAAG,sBAPD;AAO6B;AACpCC,gBAAQ,EAAG,0BARJ;AAQgC;AACvCC,kBAAU,EAAC,uBATJ;AAS8B;AACrCC,kBAAU,EAAC,sBAVJ,CAU+B;;AAV/B,OAhCf;AAAA,UA4CIC,aAAa,GAAG,sBA5CpB;AAAA,UA6CIC,OAAO,GAAG,CAAE,MAAF,EAAU,OAAV,EAAmB,MAAnB,EAA2B,MAA3B,EAAmC,MAAnC,EAA2C,KAA3C,EAAkD,aAAlD,CA7Cd;AAAA,UA8CIC,QAAQ,GAAG,SAAXA,QAAW,GAAW,CAAE,CA9C5B;AAAA,UA+CIC,KAAK,GAAG,SAARA,KAAQ,GAAW;AAAE,eAAO,IAAP;AAAc,OA/CvC;AAAA,UAgDIC,QAAQ,GAAG,SAAXA,QAAW,CAAShN,CAAT,EAAY3E,EAAZ,EAAgB4R,IAAhB,EAAsB;AAC7B,aAAK,IAAI5b,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG2O,CAAC,CAACjP,MAAtB,EAA8BM,CAAC,EAA/B,EAAmC;AAC/B,cAAI2O,CAAC,CAAC3O,CAAD,CAAD,IAAQ4b,IAAZ,EACI5R,EAAE,CAAC2E,CAAC,CAAC3O,CAAD,CAAF,CAAF;AACP;AACJ,OArDL;AAAA,UAsDI6b,oBAAoB,GAAG,SAAvBA,oBAAuB,CAASC,EAAT,EAAaC,GAAb,EAAkBC,QAAlB,EAA4BhB,IAA5B,EAAkC;AACrDW,gBAAQ,CAACG,EAAD,EAAK,UAAS9N,CAAT,EAAY;AACrBA,WAAC,CAACiO,SAAF,CAAYF,GAAZ;AACA,cAAIA,GAAJ,EAAS/N,CAAC,CAACkO,cAAF;AACT,cAAIF,QAAJ,EAAchO,CAAC,CAACmO,QAAF,CAAWnB,IAAX,EAAiBe,GAAjB;AACjB,SAJO,CAAR;AAKH,OA5DL;AAAA,UA6DIhH,KAAK,GAAG,SAARA,KAAQ,CAAS5G,GAAT,EAAcnE,EAAd,EAAkB;AACtB,YAAImE,GAAG,IAAI,IAAX,EAAiB;AACjBA,WAAG,GAAG,CAAC6K,SAAS,CAAC7K,GAAD,CAAV,IAAoBA,GAAG,CAACmH,OAAJ,IAAe,IAAf,IAAuBnH,GAAG,CAACzO,MAAJ,IAAc,IAAzD,GAAiEyO,GAAjE,GAAuE,CAAEA,GAAF,CAA7E;;AACA,aAAK,IAAInO,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGmO,GAAG,CAACzO,MAAxB,EAAgCM,CAAC,EAAjC;AACIgK,YAAE,CAAC3C,KAAH,CAAS8G,GAAG,CAACnO,CAAD,CAAZ,EAAiB,CAAEmO,GAAG,CAACnO,CAAD,CAAL,CAAjB;AADJ;AAEH,OAlEL;AAAA,UAmEIoc,QAAQ,GAAG,SAAXA,QAAW,CAASpO,CAAT,EAAY;AACnB,YAAIA,CAAC,CAACmK,eAAN,EAAuB;AACnBnK,WAAC,CAACmK,eAAF;AACAnK,WAAC,CAACqK,cAAF;AACH,SAHD,MAIK;AACDrK,WAAC,CAACoK,WAAF,GAAgB,KAAhB;AACH;AACJ,OA3EL;AAAA,UA4EIiE,2BAA2B,GAAG,qCA5ElC;AAAA,UA6EA;AACA;AACIC,kBAAY,GAAG,SAAfA,YAAe,CAAStO,CAAT,EAAYZ,EAAZ,EAAgBmP,UAAhB,EAA4B;AACvC,YAAIxc,CAAC,GAAGiO,CAAC,CAACC,UAAF,IAAgBD,CAAC,CAAC9B,MAA1B;AACA,eAAO,CAACiB,eAAe,CAACpN,CAAD,EAAIwc,UAAU,CAACC,sBAAX,EAAJ,EAAyCpP,EAAzC,CAAvB;AACH,OAlFL;;AAoFA,UAAIqP,KAAK,GAAG,SAARA,KAAQ,CAASrP,EAAT,EAAasI,MAAb,EAAqBgH,GAArB,EAA0BC,KAA1B,EAAiC;AACzC,aAAKjH,MAAL,GAAcA,MAAM,IAAI,EAAxB;AACA,aAAKtI,EAAL,GAAUA,EAAV;AACA,aAAKsI,MAAL,CAAYkH,QAAZ,CAAqB,KAAKxP,EAA1B,EAA8B,KAAKyP,MAAnC;AACA,aAAKC,IAAL,GAAYnQ,KAAK,EAAjB;AACA,YAAIoQ,OAAO,GAAG,IAAd;;AACA,aAAKC,UAAL,GAAkB,UAAShP,CAAT,EAAY;AAAE+O,iBAAO,GAAG/O,CAAV;AAAc,SAA9C;;AACA,aAAKiP,SAAL,GAAiB,YAAW;AAAE,iBAAOF,OAAP;AAAiB,SAA/C;;AACA,aAAKG,aAAL,GAAqB,YAAW;AAAEH,iBAAO,GAAG,CAACA,OAAX;AAAqB,SAAvD;;AACA,aAAKI,QAAL,GAAgB,UAASC,MAAT,EAAiB;AAC7B,eAAKA,MAAL,GAAcA,MAAM,GAAGA,MAAM,CAAC1N,KAAP,CAAa,KAAb,CAAH,GAAyB,CAAEiN,KAAF,CAA7C;AACH,SAFD;;AAGA,aAAKU,QAAL,GAAgB,UAASD,MAAT,EAAiB;AAC7B,cAAIrc,CAAC,GAAG,EAAR;;AACAgU,eAAK,CAAC,KAAKqI,MAAN,EAAc,UAASre,CAAT,EAAY;AAAEgC,aAAC,CAAChC,CAAD,CAAD,GAAO,IAAP;AAAa,WAAzC,CAAL;;AACAgW,eAAK,CAACqI,MAAM,GAAGA,MAAM,CAAC1N,KAAP,CAAa,KAAb,CAAH,GAAyB,EAAhC,EAAoC,UAAS3Q,CAAT,EAAY;AAAEgC,aAAC,CAAChC,CAAD,CAAD,GAAO,IAAP;AAAa,WAA/D,CAAL;;AACA,eAAKqe,MAAL,GAAc,EAAd;;AACA,eAAK,IAAIpd,CAAT,IAAce,CAAd;AAAiB,iBAAKqc,MAAL,CAAY1Y,IAAZ,CAAiB1E,CAAjB;AAAjB;AACH,SAND;;AAOA,aAAKsd,WAAL,GAAmB,UAASF,MAAT,EAAiB;AAChC,cAAIrc,CAAC,GAAG,EAAR;;AACAgU,eAAK,CAAC,KAAKqI,MAAN,EAAc,UAASre,CAAT,EAAY;AAAEgC,aAAC,CAAChC,CAAD,CAAD,GAAO,IAAP;AAAa,WAAzC,CAAL;;AACAgW,eAAK,CAACqI,MAAM,GAAGA,MAAM,CAAC1N,KAAP,CAAa,KAAb,CAAH,GAAyB,EAAhC,EAAoC,UAAS3Q,CAAT,EAAY;AAAE,mBAAOgC,CAAC,CAAChC,CAAD,CAAR;AAAa,WAA/D,CAAL;;AACA,eAAKqe,MAAL,GAAc,EAAd;;AACA,eAAK,IAAIpd,CAAT,IAAce,CAAd;AAAiB,iBAAKqc,MAAL,CAAY1Y,IAAZ,CAAiB1E,CAAjB;AAAjB;AACH,SAND;;AAOA,aAAKud,WAAL,GAAmB,UAASH,MAAT,EAAiB;AAChC,cAAIrc,CAAC,GAAG,EAAR;;AACAgU,eAAK,CAAC,KAAKqI,MAAN,EAAc,UAASre,CAAT,EAAY;AAAEgC,aAAC,CAAChC,CAAD,CAAD,GAAO,IAAP;AAAa,WAAzC,CAAL;;AACAgW,eAAK,CAACqI,MAAM,GAAGA,MAAM,CAAC1N,KAAP,CAAa,KAAb,CAAH,GAAyB,EAAhC,EAAoC,UAAS3Q,CAAT,EAAY;AACjD,gBAAIgC,CAAC,CAAChC,CAAD,CAAL,EAAU,OAAOgC,CAAC,CAAChC,CAAD,CAAR,CAAV,KACKgC,CAAC,CAAChC,CAAD,CAAD,GAAO,IAAP;AACR,WAHI,CAAL;;AAIA,eAAKqe,MAAL,GAAc,EAAd;;AACA,eAAK,IAAIpd,CAAT,IAAce,CAAd;AAAiB,iBAAKqc,MAAL,CAAY1Y,IAAZ,CAAiB1E,CAAjB;AAAjB;AACH,SATD;;AAUA,aAAKmd,QAAL,CAAczH,MAAM,CAACiH,KAArB;AACA,aAAK3b,CAAL,GAAS0U,MAAM,CAAC8H,SAAhB;AACA,eAAO9H,MAAM,CAAC8H,SAAd;AACH,OAvCD;;AAyCA,UAAIC,IAAI,GAAG,SAAPA,IAAO,GAAW;AAAE,eAAO,IAAP;AAAc,OAAtC;;AACA,UAAIC,KAAK,GAAG,SAARA,KAAQ,GAAW;AAAE,eAAO,KAAP;AAAe,OAAxC;;AAEA,UAAIC,IAAI,GAAG,SAAPA,IAAO,CAASvQ,EAAT,EAAasI,MAAb,EAAqBgH,GAArB,EAA0BC,KAA1B,EAAiC;AACxC,aAAKE,MAAL,GAAcH,GAAG,CAAC5B,SAAlB;AACA,YAAI9Z,CAAC,GAAGyb,KAAK,CAACpV,KAAN,CAAY,IAAZ,EAAkB0F,SAAlB,CAAR;AACA,aAAK6Q,kBAAL,GAA0B,KAAKlI,MAAL,CAAYkI,kBAAtC;;AACA,YAAIC,MAAM,GAAG,CAAC,CAAD,EAAG,CAAH,CAAb;AAAA,YAAoBC,SAAS,GAAG,IAAhC;AAAA,YAAsCC,aAAa,GAAG,IAAtD;AAAA,YAA4DC,SAAS,GAAG,CAAC,CAAD,EAAG,CAAH,CAAxE;AAAA,YAA+EC,MAAM,GAAG,KAAxF;AAAA,YAA+FC,aAAa,GAAG,CAAC,CAAD,EAAG,CAAH,CAA/G;AAAA,YACIC,iBAAiB,GAAG,KAAKzI,MAAL,CAAYyI,iBAAZ,KAAkC,KAD1D;AAAA,YAEIC,MAAM,GAAG,KAAKhR,EAFlB;AAAA,YAGIiR,KAAK,GAAG,KAAK3I,MAAL,CAAY2I,KAHxB;AAAA,YAIIC,MAAM,GAAG,KAAK5I,MAAL,CAAY4I,MAJzB;AAAA,YAKIC,aAAa,GAAG7I,MAAM,CAAC8I,YAAP,KAAwB,KAL5C;AAAA,YAMIC,aAAa,GAAG,KANpB;AAAA,YAOIC,aAAa,GAAGhJ,MAAM,CAAC2F,UAAP,KAAsB,IAAtB,GAA6BoC,IAA7B,GAAoC/H,MAAM,CAAC2F,UAAP,IAAqB,OAAO3F,MAAM,CAAC2F,UAAd,KAA6B,UAAlD,GAA+D3F,MAAM,CAAC2F,UAAtE,GAAmFqC,KAP3I;AAAA,YAQIrC,UAAU,GAAG,SAAbA,UAAa,CAASjO,EAAT,EAAa;AAAE,iBAAOA,EAAE,CAACuR,SAAH,CAAa,IAAb,CAAP;AAA4B,SAR5D;AAAA,YASIC,aAAa,GAAG,IATpB;AAAA,YAUI1E,kBAAkB,GAAG,EAVzB;AAAA,YAWI2E,oBAAoB,GAAG,IAX3B;AAAA,YAWiC;AAC7BC,wBAAgB,GAAGpJ,MAAM,CAACoJ,gBAZ9B;AAAA,YAaIC,qBAbJ;AAAA,YAcIC,mBAdJ;AAAA,YAeIC,OAfJ;AAAA,YAgBIC,OAhBJ,CAJwC,CAsBxC;;;AACA,YAAIxJ,MAAM,CAACrI,QAAX,EAAqB;AACjB,cAAI8M,WAAW,GAAG/M,EAAE,CAACgD,YAAH,CAAgB,qBAAhB,CAAlB;;AACA,cAAI+J,WAAW,IAAI,IAAnB,EAAyB;AACrBA,uBAAW,GAAG,KAAK,IAAIxU,IAAJ,GAAWC,OAAX,EAAnB;AACAwH,cAAE,CAACiD,YAAH,CAAgB,qBAAhB,EAAuC8J,WAAvC;AACH;;AAEDD,4BAAkB,CAACxV,IAAnB,CAAwBgR,MAAxB;AACH;;AAED,YAAIyJ,aAAa,GAAGzJ,MAAM,CAACyJ,aAA3B;AAAA,YACIC,KAAK,GAAG,SAARA,KAAQ,CAASC,GAAT,EAAcC,KAAd,EAAqBC,KAArB,EAA4BC,UAA5B,EAAwCC,UAAxC,EAAoD;AACxD,cAAIC,GAAG,GAAGxhB,IAAI,CAACyhB,KAAL,CAAWN,GAAG,CAAC,CAAD,CAAH,GAASC,KAApB,CAAV;AAAA,cACIM,IAAI,GAAGN,KAAK,GAAGI,GADnB;AAAA,cAEIG,IAAI,GAAGD,IAAI,GAAGN,KAFlB;AAAA,cAGIza,EAAE,GAAG3G,IAAI,CAACuH,GAAL,CAAS4Z,GAAG,CAAC,CAAD,CAAH,GAASO,IAAlB,KAA2BJ,UAA3B,GAAwCI,IAAxC,GAA+C1hB,IAAI,CAACuH,GAAL,CAASoa,IAAI,GAAGR,GAAG,CAAC,CAAD,CAAnB,KAA2BG,UAA3B,GAAwCK,IAAxC,GAA+CR,GAAG,CAAC,CAAD,CAH1G;;AAKA,cAAIS,GAAG,GAAG5hB,IAAI,CAACyhB,KAAL,CAAWN,GAAG,CAAC,CAAD,CAAH,GAASE,KAApB,CAAV;AAAA,cACIQ,IAAI,GAAGR,KAAK,GAAGO,GADnB;AAAA,cAEIE,IAAI,GAAGD,IAAI,GAAGR,KAFlB;AAAA,cAGIza,EAAE,GAAG5G,IAAI,CAACuH,GAAL,CAAS4Z,GAAG,CAAC,CAAD,CAAH,GAASU,IAAlB,KAA2BN,UAA3B,GAAwCM,IAAxC,GAA+C7hB,IAAI,CAACuH,GAAL,CAASua,IAAI,GAAGX,GAAG,CAAC,CAAD,CAAnB,KAA2BI,UAA3B,GAAwCO,IAAxC,GAA+CX,GAAG,CAAC,CAAD,CAH1G;;AAKA,iBAAO,CAAExa,EAAF,EAAMC,EAAN,CAAP;AACH,SAbL;;AAeA,aAAKmb,MAAL,GAAc,EAAd;AACA,aAAKC,UAAL,GAAkB,EAAlB;;AAEA,aAAKC,MAAL,GAAc,UAASd,GAAT,EAAc;AACxB,cAAI,KAAK3J,MAAL,CAAY0K,IAAZ,IAAoB,IAAxB,EAA8B;AAC1B,mBAAOf,GAAP;AACH,WAFD,MAGK;AACD,gBAAIgB,EAAE,GAAG,KAAK3K,MAAL,CAAY0K,IAAZ,GAAmB,KAAK1K,MAAL,CAAY0K,IAAZ,CAAiB,CAAjB,IAAsB,CAAzC,GAA6CjB,aAAa,GAAGA,aAAH,GAAmB3E,cAAc,GAAG,CAAvG;AAAA,gBACI8F,EAAE,GAAG,KAAK5K,MAAL,CAAY0K,IAAZ,GAAmB,KAAK1K,MAAL,CAAY0K,IAAZ,CAAiB,CAAjB,IAAsB,CAAzC,GAA6CjB,aAAa,GAAGA,aAAH,GAAmB1E,cAAc,GAAG,CADvG;AAGA,mBAAO2E,KAAK,CAACC,GAAD,EAAM,KAAK3J,MAAL,CAAY0K,IAAZ,CAAiB,CAAjB,CAAN,EAA2B,KAAK1K,MAAL,CAAY0K,IAAZ,CAAiB,CAAjB,CAA3B,EAAgDC,EAAhD,EAAoDC,EAApD,CAAZ;AACH;AACJ,SAVD;;AAYA,aAAKC,IAAL,GAAY,UAASniB,CAAT,EAAYK,CAAZ,EAAe;AACvB,cAAI2f,MAAM,IAAI,IAAd,EAAoB;AACpBhgB,WAAC,GAAGA,CAAC,KAAK,KAAKsX,MAAL,CAAY0K,IAAZ,GAAmB,KAAK1K,MAAL,CAAY0K,IAAZ,CAAiB,CAAjB,CAAnB,GAAyC5F,cAA9C,CAAL;AACA/b,WAAC,GAAGA,CAAC,KAAK,KAAKiX,MAAL,CAAY0K,IAAZ,GAAmB,KAAK1K,MAAL,CAAY0K,IAAZ,CAAiB,CAAjB,CAAnB,GAAyC3F,cAA9C,CAAL;;AACA,cAAIhW,CAAC,GAAG,KAAKiR,MAAL,CAAY8K,WAAZ,CAAwBpC,MAAxB,CAAR;AAAA,cACIiC,EAAE,GAAG,KAAK3K,MAAL,CAAY0K,IAAZ,GAAmB,KAAK1K,MAAL,CAAY0K,IAAZ,CAAiB,CAAjB,IAAsB,CAAzC,GAA6CjB,aADtD;AAAA,cAEImB,EAAE,GAAG,KAAK5K,MAAL,CAAY0K,IAAZ,GAAmB,KAAK1K,MAAL,CAAY0K,IAAZ,CAAiB,CAAjB,IAAsB,CAAzC,GAA6CjB,aAFtD;AAAA,cAGIsB,OAAO,GAAGrB,KAAK,CAAC3a,CAAD,EAAIrG,CAAJ,EAAOK,CAAP,EAAU4hB,EAAV,EAAcC,EAAd,CAHnB;;AAKA,eAAK5K,MAAL,CAAYgL,WAAZ,CAAwBtC,MAAxB,EAAgCqC,OAAhC;AACA,iBAAOA,OAAP;AACH,SAXD;;AAaA,aAAKE,gBAAL,GAAwB,UAAS5E,GAAT,EAAc;AAClC2C,uBAAa,GAAG3C,GAAG,GAAG0B,IAAH,GAAUC,KAA7B;AACH,SAFD;;AAIA,YAAIkD,SAAJ;;AACA,YAAIC,cAAc,GAAG,SAAjBA,cAAiB,CAASxB,GAAT,EAAc;AAC/B,iBAAQ3J,MAAM,CAACoL,aAAP,KAAyB,KAA1B,GAAmC,CAAE5iB,IAAI,CAACgD,GAAL,CAAU,CAAV,EAAame,GAAG,CAAC,CAAD,CAAhB,CAAF,EAAwBnhB,IAAI,CAACgD,GAAL,CAAS,CAAT,EAAYme,GAAG,CAAC,CAAD,CAAf,CAAxB,CAAnC,GAAmFA,GAA1F;AACH,SAFD;;AAIA,YAAI0B,aAAa,GAAG,UAAS3d,KAAT,EAAgB;AAChCwd,mBAAS,GAAG,OAAOxd,KAAP,KAAiB,UAAjB,GAA8BA,KAA9B,GAAsCA,KAAK,GAAG,UAASic,GAAT,EAAcjB,MAAd,EAAsB4C,cAAtB,EAAsCC,KAAtC,EAA6C;AACnG,mBAAOJ,cAAc,CAAC,CAClB3iB,IAAI,CAACgD,GAAL,CAAS,CAAT,EAAYhD,IAAI,CAACkD,GAAL,CAAS4f,cAAc,CAACzhB,CAAf,GAAmB0hB,KAAK,CAAC,CAAD,CAAjC,EAAsC5B,GAAG,CAAC,CAAD,CAAzC,CAAZ,CADkB,EAElBnhB,IAAI,CAACgD,GAAL,CAAS,CAAT,EAAYhD,IAAI,CAACkD,GAAL,CAAS4f,cAAc,CAACtZ,CAAf,GAAmBuZ,KAAK,CAAC,CAAD,CAAjC,EAAsC5B,GAAG,CAAC,CAAD,CAAzC,CAAZ,CAFkB,CAAD,CAArB;AAIH,WALyD,CAKxD6B,IALwD,CAKnD,IALmD,CAAH,GAKxC,UAAS7B,GAAT,EAAc;AAAE,mBAAOwB,cAAc,CAACxB,GAAD,CAArB;AAA6B,WAL5D;AAMH,SAPmB,CAOlB6B,IAPkB,CAOb,IAPa,CAApB;;AASAH,qBAAa,CAAC,OAAO,KAAKrL,MAAL,CAAYkL,SAAnB,KAAiC,UAAjC,GAA8C,KAAKlL,MAAL,CAAYkL,SAA1D,GAAwE,KAAKlL,MAAL,CAAYkL,SAAZ,IAAyB,KAAKlL,MAAL,CAAYyL,WAA9G,CAAb;AAGA;;;;;;;AAKA,aAAKC,YAAL,GAAoB,UAAShe,KAAT,EAAgB;AAChC2d,uBAAa,CAAC3d,KAAD,CAAb;AACH,SAFD;;AAIA,YAAIie,cAAJ;AACA;;;;;;AAKA,aAAKC,SAAL,GAAiB,UAAStX,EAAT,EAAa;AAC1BqX,wBAAc,GAAGrX,EAAjB;AACH,SAFD;;AAIA,YAAI,KAAK0L,MAAL,CAAY6L,MAAhB,EAAwB;AACpBF,wBAAc,GAAG,KAAK3L,MAAL,CAAY6L,MAA7B;AACH;;AAED,YAAIC,SAAS,GAAG,SAAZA,SAAY,CAASrT,GAAT,EAAc;AACtB,cAAI,OAAOA,GAAP,KAAe,UAAnB,EAA+B;AAC3BA,eAAG,CAACsT,YAAJ,GAAmB9U,KAAK,EAAxB;AACA,mBAAOwB,GAAG,CAACsT,YAAX;AACH,WAHD,MAGO;AACH,mBAAOtT,GAAP;AACH;AACJ,SAPL;AAAA,YAQA;AACIuT,gBAAQ,GAAG,EATf;AAAA,YAUIC,WAAW,GAAG,SAAdA,WAAc,CAAS3T,CAAT,EAAY;AACtB,eAAK,IAAI8G,GAAT,IAAgB4M,QAAhB,EAA0B;AACtB,gBAAIzI,CAAC,GAAGyI,QAAQ,CAAC5M,GAAD,CAAhB;AACA,gBAAIxB,EAAE,GAAG2F,CAAC,CAAC,CAAD,CAAD,CAAKjL,CAAL,CAAT;AACA,gBAAIiL,CAAC,CAAC,CAAD,CAAL,EAAU3F,EAAE,GAAG,CAACA,EAAN;AACV,gBAAI,CAACA,EAAL,EAAS,OAAO,KAAP;AACZ;;AACD,iBAAO,IAAP;AACH,SAlBL;AAAA,YAmBIsO,UAAU,GAAG,KAAKC,SAAL,GAAiB,UAAS5I,CAAT,EAAY6I,QAAZ,EAAsB;AAChD,cAAI7I,CAAJ,EAAO;AACH,gBAAInE,GAAG,GAAG0M,SAAS,CAACvI,CAAD,CAAnB;;AACAyI,oBAAQ,CAAC5M,GAAD,CAAR,GAAgB,CACZ,UAAS9G,CAAT,EAAY;AACR,kBAAIjO,CAAC,GAAGiO,CAAC,CAACC,UAAF,IAAgBD,CAAC,CAAC9B,MAA1B;AAAA,kBAAkCnL,CAAlC;;AACA,kBAAIiY,SAAS,CAACC,CAAD,CAAb,EAAkB;AACdlY,iBAAC,GAAGoM,eAAe,CAACpN,CAAD,EAAIkZ,CAAJ,EAAO7L,EAAP,CAAnB;AACH,eAFD,MAGK,IAAI,OAAO6L,CAAP,KAAa,UAAjB,EAA6B;AAC9BlY,iBAAC,GAAGkY,CAAC,CAACjL,CAAD,EAAIZ,EAAJ,CAAL;AACH;;AACD,qBAAOrM,CAAP;AACH,aAVW,EAWR+gB,QAAQ,KAAK,KAXL,CAAhB;AAcH;AACJ,SArCL;AAAA,YAsCIC,UAAU,GAAG,KAAKC,SAAL,GAAiBJ,UAtClC;AAAA,YAuCIK,aAAa,GAAG,KAAKC,YAAL,GAAoB,UAASjJ,CAAT,EAAY;AAC5C,cAAInE,GAAG,GAAG,OAAOmE,CAAP,KAAa,UAAb,GAA0BA,CAAC,CAACwI,YAA5B,GAA2CxI,CAArD;AACA,iBAAOyI,QAAQ,CAAC5M,GAAD,CAAf;AACH,SA1CL;;AA4CA,aAAKqN,eAAL,GAAuB,YAAW;AAC9BT,kBAAQ,GAAG,EAAX;AACH,SAFD;;AAIA,aAAKU,OAAL,GAAe,KAAK1M,MAAL,CAAY0M,OAAZ,IAAuB1G,KAAtC;AAEA,YAAI2G,aAAJ;AAAA,YACIC,kBAAkB,GAAG,EADzB;AAAA,YAEIC,sBAAsB,GAAG,EAF7B;;AAIA,aAAKC,WAAL,GAAmB,UAAS9M,MAAT,EAAiB;AAChC,cAAIA,MAAM,CAACrI,QAAX,EAAqB;AACjB6M,8BAAkB,CAACxV,IAAnB,CAAwBgR,MAAxB;AACH;AACJ,SAJD;;AAMA,aAAK+M,YAAL,GAAoB,UAASzU,CAAT,EAAY;AAC5B,cAAIA,CAAC,CAAC0U,gBAAN,EAAwB;AAAE;AAAS;;AACnC,cAAIC,eAAe,GAAG,KAAK/E,kBAAL,IAA4B5P,CAAC,CAAC4U,KAAF,KAAY,CAAZ,IAAiB5U,CAAC,CAAC6U,MAAF,KAAa,CAAhF;;AACA,cAAIF,eAAe,IAAI,KAAK1F,SAAL,EAAnB,IAAuC,KAAKmF,OAAL,EAA3C,EAA2D;AAEvD,gBAAI/L,EAAE,GAAIsL,WAAW,CAAC3T,CAAD,CAAX,IAAkBsO,YAAY,CAACtO,CAAD,EAAI,KAAKZ,EAAT,EAAa,KAAKpM,CAAlB,CAAxC;;AACA,gBAAIqV,EAAJ,EAAQ;AAEJwI,kCAAoB,GAAG,IAAvB;AACAD,2BAAa,GAAG,IAAhB,CAHI,CAKJ;AACA;AACA;AACA;AACA;AACA;;AACA,kBAAI1E,kBAAkB,CAACxa,MAAnB,GAA4B,CAAhC,EAAmC;AAC/B,oBAAIojB,KAAK,GAAG7I,oBAAoB,CAACC,kBAAD,EAAqB,KAAK9M,EAA1B,EAA8BY,CAAC,CAAC9B,MAAF,IAAY8B,CAAC,CAACC,UAA5C,CAAhC;;AACA,oBAAI6U,KAAK,IAAI,IAAb,EAAmB;AACfjE,sCAAoB,GAAGiE,KAAK,CAAC,CAAD,CAA5B;AACAlE,+BAAa,GAAGkE,KAAK,CAAC,CAAD,CAArB;AACH,iBAL8B,CAM/B;;;AACA,oBAAGlE,aAAa,IAAI,IAApB,EAA0B;AACtB;AACH;AACJ,eAVD,MAWK;AACDA,6BAAa,GAAG,KAAKxR,EAArB;AACH;;AAED,kBAAIiR,KAAJ,EAAW;AACPD,sBAAM,GAAGQ,aAAa,CAACD,SAAd,CAAwB,IAAxB,CAAT;AACA,qBAAKjJ,MAAL,CAAYkH,QAAZ,CAAqBwB,MAArB,EAA6BxD,QAAQ,CAACU,UAAtC;AAEA8C,sBAAM,CAAC/N,YAAP,CAAoB,IAApB,EAA0B,IAA1B;AACA+N,sBAAM,CAAC2E,KAAP,CAAaC,QAAb,GAAwB,UAAxB;;AAEA,oBAAI,KAAKtN,MAAL,CAAYuN,MAAZ,IAAsB,IAA1B,EAAgC;AAC5B,sBAAIxe,CAAC,GAAG,KAAKiR,MAAL,CAAY8K,WAAZ,CAAwB,KAAKpT,EAA7B,CAAR;AACAgR,wBAAM,CAAC2E,KAAP,CAAaxhB,IAAb,GAAoBkD,CAAC,CAAC,CAAD,CAAD,GAAO,IAA3B;AACA2Z,wBAAM,CAAC2E,KAAP,CAAa1N,GAAb,GAAmB5Q,CAAC,CAAC,CAAD,CAAD,GAAO,IAA1B;AACA,uBAAKiR,MAAL,CAAYuN,MAAZ,CAAmBC,WAAnB,CAA+B9E,MAA/B;AACH,iBALD,MAKO;AACH;AACA;AACA,sBAAI3b,CAAC,GAAGyW,aAAa,CAAC0F,aAAD,CAArB;AACAR,wBAAM,CAAC2E,KAAP,CAAaxhB,IAAb,GAAoBkB,CAAC,CAAClB,IAAF,GAAS,IAA7B;AACA6c,wBAAM,CAAC2E,KAAP,CAAa1N,GAAb,GAAmB5S,CAAC,CAAC4S,GAAF,GAAQ,IAA3B;AAEAxH,0BAAQ,CAACyL,IAAT,CAAc4J,WAAd,CAA0B9E,MAA1B;AACH;AAEJ,eAtBD,MAsBO;AACHA,sBAAM,GAAGQ,aAAT;AACH;;AAEDT,+BAAiB,IAAI/B,QAAQ,CAACpO,CAAD,CAA7B;AACA6P,oBAAM,GAAGlD,GAAG,CAAC3M,CAAD,CAAZ;;AACA,kBAAIoQ,MAAM,IAAIA,MAAM,CAAC7Q,UAArB,EACA;AACI2Q,6BAAa,GAAG,CAACE,MAAM,CAAC7Q,UAAP,CAAkB6G,UAAnB,EAA+BgK,MAAM,CAAC7Q,UAAP,CAAkB8G,SAAjD,CAAhB;AACH,eAzDG,CA0DJ;;;AACA,mBAAKqB,MAAL,CAAYwL,IAAZ,CAAiBrT,QAAjB,EAA2B,WAA3B,EAAwC,KAAKsV,YAA7C;AACA,mBAAKzN,MAAL,CAAYwL,IAAZ,CAAiBrT,QAAjB,EAA2B,SAA3B,EAAsC,KAAKuV,UAA3C;AACApiB,eAAC,CAACqiB,aAAF,CAAgB,IAAhB;AACAriB,eAAC,CAACsiB,UAAF,CAAa,IAAb;AACA,mBAAK5N,MAAL,CAAYkH,QAAZ,CAAqB/O,QAAQ,CAACyL,IAA9B,EAAoCoD,GAAG,CAACtB,QAAxC;;AACAmI,uBAAS,CAAC,aAAD,EAAgB;AAACnW,kBAAE,EAAC,KAAKA,EAAT;AAAaiS,mBAAG,EAACvB,SAAjB;AAA4B9P,iBAAC,EAACA,CAA9B;AAAiCgN,oBAAI,EAAC;AAAtC,eAAhB,CAAT;AACH,aAjED,MAkEK,IAAI,KAAKtF,MAAL,CAAY8N,qBAAhB,EAAuC;AACxCpH,sBAAQ,CAACpO,CAAD,CAAR;AACH;AACJ;AACJ,SA5EmB,CA4ElBkT,IA5EkB,CA4Eb,IA5Ea,CAApB;;AA8EA,aAAKiC,YAAL,GAAoB,UAASnV,CAAT,EAAY;AAC5B,cAAI6P,MAAJ,EAAY;AACR,gBAAI,CAACI,MAAL,EAAa;AACT,kBAAIwF,SAAS,GAAGF,SAAS,CAAC,OAAD,EAAU;AAACnW,kBAAE,EAAC,KAAKA,EAAT;AAAaiS,mBAAG,EAACvB,SAAjB;AAA4B9P,iBAAC,EAACA,CAA9B;AAAiCgN,oBAAI,EAAC;AAAtC,eAAV,CAAzB;;AACA,kBAAIyI,SAAS,KAAK,KAAlB,EAAyB;AACrB,oBAAI,CAAC5F,MAAL,EAAa;AACT;AACH;;AACD,qBAAK6F,IAAL,CAAU,IAAV;AACAzF,sBAAM,GAAG,IAAT;AACH,eAND,MAMO;AACH,qBAAK0F,KAAL;AACH;AACJ,aAZO,CAcR;AACA;;;AACA,gBAAI9F,MAAJ,EAAY;AACR0E,oCAAsB,CAAC7iB,MAAvB,GAAgC,CAAhC;;AACA,kBAAI2f,GAAG,GAAG1E,GAAG,CAAC3M,CAAD,CAAb;AAAA,kBAAkB5H,EAAE,GAAGiZ,GAAG,CAAC,CAAD,CAAH,GAASxB,MAAM,CAAC,CAAD,CAAtC;AAAA,kBAA2C1X,EAAE,GAAGkZ,GAAG,CAAC,CAAD,CAAH,GAASxB,MAAM,CAAC,CAAD,CAA/D;AAAA,kBACInd,CAAC,GAAG,KAAKgV,MAAL,CAAYkO,UAAZ,GAAyB,CAAzB,GAA6B5iB,CAAC,CAAC6iB,OAAF,EADrC;;AAEA,kBAAIzF,MAAM,IAAIA,MAAM,CAAC7Q,UAArB,EACA;AACInH,kBAAE,IAAIgY,MAAM,CAAC7Q,UAAP,CAAkB6G,UAAlB,GAA+B8J,aAAa,CAAC,CAAD,CAAlD;AACA/X,kBAAE,IAAIiY,MAAM,CAAC7Q,UAAP,CAAkB8G,SAAlB,GAA8B6J,aAAa,CAAC,CAAD,CAAjD;AACH;;AACD9X,gBAAE,IAAI1F,CAAN;AACAyF,gBAAE,IAAIzF,CAAN;AACA,mBAAKojB,MAAL,CAAY1d,EAAZ,EAAgBD,EAAhB,EAAoB6H,CAApB;AACAhN,eAAC,CAAC+iB,eAAF,CAAkB3d,EAAlB,EAAsBD,EAAtB,EAA0B,IAA1B;AACAnF,eAAC,CAACgjB,YAAF,CAAe5d,EAAf,EAAmBD,EAAnB,EAAuB,IAAvB;AACH;AACJ;AACJ,SAjCmB,CAiClB+a,IAjCkB,CAiCb,IAjCa,CAApB;;AAmCA,aAAKkC,UAAL,GAAkB,UAASpV,CAAT,EAAY;AAC1B,cAAI6P,MAAJ,EAAY;AACRA,kBAAM,GAAG,IAAT;AACA,iBAAKnI,MAAL,CAAYuO,MAAZ,CAAmBpW,QAAnB,EAA6B,WAA7B,EAA0C,KAAKsV,YAA/C;AACA,iBAAKzN,MAAL,CAAYuO,MAAZ,CAAmBpW,QAAnB,EAA6B,SAA7B,EAAwC,KAAKuV,UAA7C;AACA,iBAAK1N,MAAL,CAAYwO,WAAZ,CAAwBrW,QAAQ,CAACyL,IAAjC,EAAuCoD,GAAG,CAACtB,QAA3C;AACA,iBAAK+I,MAAL,CAAYnW,CAAZ;AACAhN,aAAC,CAACojB,eAAF,CAAkB,IAAlB,EAAwBpW,CAAxB;AACAhN,aAAC,CAACqjB,YAAF,CAAe,IAAf,EAAqBrW,CAArB;AACA,iBAAKsW,IAAL,CAAUtW,CAAV;AAEAhN,aAAC,CAACujB,mBAAF,CAAsB,IAAtB,EAA4BvW,CAA5B;AACAiQ,kBAAM,GAAG,KAAT;AACAsE,kCAAsB,CAAC7iB,MAAvB,GAAgC,CAAhC;;AAEA,gBAAI2e,KAAJ,EAAW;AACPD,oBAAM,IAAIA,MAAM,CAAC7Q,UAAjB,IAA+B6Q,MAAM,CAAC7Q,UAAP,CAAkB0I,WAAlB,CAA8BmI,MAA9B,CAA/B;AACAA,oBAAM,GAAG,IAAT;AACH,aAHD,MAGO;AACH,kBAAIiD,cAAc,IAAIA,cAAc,CAACjD,MAAD,EAAS,KAAK1I,MAAL,CAAY8K,WAAZ,CAAwBpC,MAAxB,CAAT,CAAd,KAA4D,IAAlF,EAAwF;AACpF,qBAAK1I,MAAL,CAAYgL,WAAZ,CAAwBtC,MAAxB,EAAgCN,SAAhC;;AACAyF,yBAAS,CAAC,QAAD,EAAWnF,MAAX,CAAT;AACH;AACJ;AAEJ;AACJ,SA1BiB,CA0BhB8C,IA1BgB,CA0BX,IA1BW,CAAlB;;AA4BA,aAAKsD,UAAL,GAAkB,YAAW;AAAE,iBAAO9C,QAAP;AAAkB,SAAjD;;AAEA,aAAKiC,KAAL,GAAa,YAAW;AACpB,cAAI9F,MAAM,IAAI,IAAd,EAAoB;AAChB,iBAAKuF,UAAL;AACH;AACJ,SAJD;AAMA;;;;;;;;;;AAQA,aAAKqB,cAAL,GAAsB,UAASC,uBAAT,EAAkC;AACpD,iBAAOA,uBAAuB,GAAG9F,aAAa,IAAI,KAAKxR,EAAzB,GAA8BgR,MAAM,IAAI,KAAKhR,EAA3E;AACH,SAFD;;AAIA,YAAIuX,SAAS,GAAG;AAAC,mBAAQ,EAAT;AAAa,kBAAO,EAApB;AAAwB,kBAAO,EAA/B;AAAmC,kBAAO,EAA1C;AAA8C,iBAAM,EAApD;AAAwD,yBAAc,EAAtE;AAA0E,oBAAS;AAAnF,SAAhB;AACA,YAAIjP,MAAM,CAACkP,MAAP,CAAcC,KAAlB,EAAyBF,SAAS,CAACE,KAAV,CAAgBngB,IAAhB,CAAqBgR,MAAM,CAACkP,MAAP,CAAcC,KAAnC;AACzB,YAAInP,MAAM,CAACkP,MAAP,CAAcE,WAAlB,EAA+BH,SAAS,CAACG,WAAV,CAAsBpgB,IAAtB,CAA2BgR,MAAM,CAACkP,MAAP,CAAcE,WAAzC;AAC/B,YAAIpP,MAAM,CAACkP,MAAP,CAAcN,IAAlB,EAAwBK,SAAS,CAACL,IAAV,CAAe5f,IAAf,CAAoBgR,MAAM,CAACkP,MAAP,CAAcN,IAAlC;AACxB,YAAI5O,MAAM,CAACkP,MAAP,CAAc5J,IAAlB,EAAwB2J,SAAS,CAAC3J,IAAV,CAAetW,IAAf,CAAoBgR,MAAM,CAACkP,MAAP,CAAc5J,IAAlC;AACxB,YAAItF,MAAM,CAACkP,MAAP,CAAcrD,MAAlB,EAA0BoD,SAAS,CAACpD,MAAV,CAAiB7c,IAAjB,CAAsBgR,MAAM,CAACkP,MAAP,CAAcrD,MAApC;;AAE1B,aAAKrL,EAAL,GAAU,UAASzG,GAAT,EAAczF,EAAd,EAAkB;AACxB,cAAI2a,SAAS,CAAClV,GAAD,CAAb,EAAoBkV,SAAS,CAAClV,GAAD,CAAT,CAAe/K,IAAf,CAAoBsF,EAApB;AACvB,SAFD;;AAIA,aAAKsM,GAAL,GAAW,UAAS7G,GAAT,EAAczF,EAAd,EAAkB;AACzB,cAAI2a,SAAS,CAAClV,GAAD,CAAb,EAAoB;AAChB,gBAAId,CAAC,GAAG,EAAR;;AACA,iBAAK,IAAI3O,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG2kB,SAAS,CAAClV,GAAD,CAAT,CAAe/P,MAAnC,EAA2CM,CAAC,EAA5C,EAAgD;AAC5C,kBAAI2kB,SAAS,CAAClV,GAAD,CAAT,CAAezP,CAAf,MAAsBgK,EAA1B,EAA8B2E,CAAC,CAACjK,IAAF,CAAOigB,SAAS,CAAClV,GAAD,CAAT,CAAezP,CAAf,CAAP;AACjC;;AACD2kB,qBAAS,CAAClV,GAAD,CAAT,GAAiBd,CAAjB;AACH;AACJ,SARD;;AAUA,YAAI4U,SAAS,GAAG,SAAZA,SAAY,CAAS9T,GAAT,EAAcrM,KAAd,EAAqB;AACjC,cAAI2hB,MAAM,GAAG,IAAb;;AACA,cAAIlG,oBAAoB,IAAIA,oBAAoB,CAACpP,GAAD,CAAhD,EAAuD;AACnDsV,kBAAM,GAAGlG,oBAAoB,CAACpP,GAAD,CAApB,CAA0BrM,KAA1B,CAAT;AACH,WAFD,MAEO,IAAIuhB,SAAS,CAAClV,GAAD,CAAb,EAAoB;AACvB,iBAAK,IAAIzP,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG2kB,SAAS,CAAClV,GAAD,CAAT,CAAe/P,MAAnC,EAA2CM,CAAC,EAA5C,EAAgD;AAC5C,kBAAI;AACA,oBAAIpB,CAAC,GAAG+lB,SAAS,CAAClV,GAAD,CAAT,CAAezP,CAAf,EAAkBoD,KAAlB,CAAR;;AACA,oBAAIxE,CAAC,IAAI,IAAT,EAAe;AACXmmB,wBAAM,GAAGnmB,CAAT;AACH;AACJ,eALD,CAMA,OAAOoP,CAAP,EAAU,CAAG;AAChB;AACJ;;AACD,iBAAO+W,MAAP;AACH,SAhBD;;AAkBA,aAAKC,WAAL,GAAmB,UAAShX,CAAT,EAAY;AAC3BuV,mBAAS,CAAC,OAAD,EAAU;AAACnW,cAAE,EAAC,KAAKA,EAAT;AAAaiS,eAAG,EAAC,KAAK3J,MAAL,CAAY8K,WAAZ,CAAwBpC,MAAxB,CAAjB;AAAkDpQ,aAAC,EAACA,CAApD;AAAuDgN,gBAAI,EAAC;AAA5D,WAAV,CAAT;AACH,SAFD;;AAIA,aAAKsJ,IAAL,GAAY,UAAStW,CAAT,EAAYiX,KAAZ,EAAmB;AAC3B,cAAIA,KAAK,IAAIhH,MAAb,EAAqB;AACjB,gBAAIiH,SAAS,GAAG,EAAhB;AAAA,gBACIC,GAAG,GAAGnkB,CAAC,CAACokB,YAAF,EADV;AAAA,gBAEIC,IAAI,GAAG,KAAK3P,MAAL,CAAY8K,WAAZ,CAAwBpC,MAAxB,CAFX;;AAIA,gBAAI+G,GAAG,CAACzlB,MAAJ,GAAa,CAAjB,EAAoB;AAChB,mBAAK,IAAIM,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGmlB,GAAG,CAACzlB,MAAxB,EAAgCM,CAAC,EAAjC,EAAqC;AACjC,oBAAIyE,CAAC,GAAG,KAAKiR,MAAL,CAAY8K,WAAZ,CAAwB2E,GAAG,CAACnlB,CAAD,CAAH,CAAOoN,EAA/B,CAAR;AACA8X,yBAAS,CAACxgB,IAAV,CAAe,CAAEygB,GAAG,CAACnlB,CAAD,CAAH,CAAOoN,EAAT,EAAa;AAAE7L,sBAAI,EAAEkD,CAAC,CAAC,CAAD,CAAT;AAAc4Q,qBAAG,EAAE5Q,CAAC,CAAC,CAAD;AAApB,iBAAb,EAAwC0gB,GAAG,CAACnlB,CAAD,CAA3C,CAAf;AACH;AACJ,aALD,MAMK;AACDklB,uBAAS,CAACxgB,IAAV,CAAe,CAAE0Z,MAAF,EAAU;AAAC7c,oBAAI,EAAC8jB,IAAI,CAAC,CAAD,CAAV;AAAehQ,mBAAG,EAACgQ,IAAI,CAAC,CAAD;AAAvB,eAAV,EAAuC,IAAvC,CAAf;AACH;;AAED9B,qBAAS,CAAC,MAAD,EAAS;AACdnW,gBAAE,EAAEgR,MADU;AAEdiB,iBAAG,EAAEiG,iBAAiB,IAAID,IAFZ;AAGdE,sBAAQ,EAACF,IAHK;AAIdrX,eAAC,EAAEA,CAJW;AAKdgN,kBAAI,EAAE,IALQ;AAMdwK,uBAAS,EAACN;AANI,aAAT,CAAT;AAQH;AACJ,SAzBD;;AA2BA,aAAKxB,IAAL,GAAY,UAAS+B,SAAT,EAAoB;AAC5B3H,mBAAS,GAAG,KAAKpI,MAAL,CAAY8K,WAAZ,CAAwBpC,MAAxB,CAAZ;AACAL,uBAAa,GAAG,KAAKrI,MAAL,CAAY8K,WAAZ,CAAwBpC,MAAxB,EAAgC,IAAhC,CAAhB;AACAJ,mBAAS,GAAG,CAACD,aAAa,CAAC,CAAD,CAAb,GAAmBD,SAAS,CAAC,CAAD,CAA7B,EAAkCC,aAAa,CAAC,CAAD,CAAb,GAAmBD,SAAS,CAAC,CAAD,CAA9D,CAAZ;AACA,eAAK4H,IAAL,GAAY,KAAKhQ,MAAL,CAAYiQ,OAAZ,CAAoBvH,MAApB,CAAZ;AACAkE,4BAAkB,GAAGthB,CAAC,CAAC4kB,qBAAF,CAAwB,IAAxB,CAArB;;AACA/J,8BAAoB,CAACyG,kBAAD,EAAqB,IAArB,EAA2B,KAA3B,EAAkC,IAAlC,CAApB;;AACA,eAAK5M,MAAL,CAAYkH,QAAZ,CAAqBwB,MAArB,EAA6B,KAAK1I,MAAL,CAAYmQ,SAAZ,IAAyBnJ,GAAG,CAAC1B,IAA1D;AAEA,cAAI8K,EAAJ;;AACA,cAAI,KAAKpQ,MAAL,CAAYqQ,wBAAhB,EAA0C;AACtCD,cAAE,GAAG,KAAKpQ,MAAL,CAAYqQ,wBAAZ,CAAqC3H,MAArC,CAAL;AACH,WAFD,MAEO;AACH0H,cAAE,GAAG,KAAKpQ,MAAL,CAAYiQ,OAAZ,CAAoBvH,MAAM,CAAC7Q,UAA3B,CAAL;AACH;;AACD8U,uBAAa,GAAG;AAAC9iB,aAAC,EAAEumB,EAAE,CAAC,CAAD,CAAN;AAAWpe,aAAC,EAAEoe,EAAE,CAAC,CAAD;AAAhB,WAAhB;AAEA7G,iBAAO,GAAG,CAAV;AACAC,iBAAO,GAAG,CAAV;;AAEA,cAAIuG,SAAJ,EAAe;AACXzkB,aAAC,CAACglB,wBAAF,CAA2B,IAA3B;AACH;AACJ,SAvBD;;AAwBA,YAAIV,iBAAJ;;AACA,aAAKnB,MAAL,GAAc,UAASnW,CAAT,EAAYiY,oBAAZ,EAAkC;AAC5CpK,8BAAoB,CAACyG,kBAAD,EAAqB,KAArB,EAA4B,IAA5B,EAAkC,IAAlC,CAApB;;AAEA,cAAI7D,aAAa,IAAIC,aAAa,CAACE,aAAD,EAAgBR,MAAhB,CAAlC,EAA2D;AACvDkH,6BAAiB,GAAG,CAAClH,MAAM,CAAC8H,UAAP,GAAoBjH,OAArB,EAA8Bb,MAAM,CAAC+H,SAAP,GAAmBjH,OAAjD,CAApB;AACAd,kBAAM,CAAC7Q,UAAP,CAAkB0I,WAAlB,CAA8BmI,MAA9B;AACAA,kBAAM,GAAGQ,aAAT;AACH,WAJD,MAKK;AACD0G,6BAAiB,GAAG,IAApB;AACH;;AAED,eAAK5P,MAAL,CAAYwO,WAAZ,CAAwB9F,MAAxB,EAAgC,KAAK1I,MAAL,CAAYmQ,SAAZ,IAAyBnJ,GAAG,CAAC1B,IAA7D;AACAsH,4BAAkB,CAAC5iB,MAAnB,GAA4B,CAA5B;AACA+e,uBAAa,GAAG,KAAhB;;AACA,cAAI,CAACwH,oBAAL,EAA2B;AACvB,gBAAI1D,sBAAsB,CAAC7iB,MAAvB,GAAgC,CAAhC,IAAqC4lB,iBAAzC,EAA4D;AACxD5P,oBAAM,CAACgL,WAAP,CAAmB9B,aAAnB,EAAkC0G,iBAAlC;AACH;;AACD/C,kCAAsB,CAAC6D,IAAvB,CAA4BC,SAA5B;;AACA,iBAAK,IAAIrmB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGuiB,sBAAsB,CAAC7iB,MAA3C,EAAmDM,CAAC,EAApD,EAAwD;AACpD,kBAAIsmB,MAAM,GAAG/D,sBAAsB,CAACviB,CAAD,CAAtB,CAA0BumB,IAA1B,CAA+B,IAA/B,EAAqCvY,CAArC,CAAb;AACA,kBAAIsY,MAAM,KAAK,IAAf,EAAqB;AACxB;AACJ;AACJ,SAzBD;;AA0BA,aAAKxC,MAAL,GAAc,UAAS1d,EAAT,EAAaD,EAAb,EAAiB6H,CAAjB,EAAoB;AAC9BuU,gCAAsB,CAAC7iB,MAAvB,GAAgC,CAAhC;AAEA,cAAI8mB,UAAU,GAAG,KAAKrG,MAAL,CAAY,CAACrC,SAAS,CAAC,CAAD,CAAT,GAAe1X,EAAhB,EAAoB0X,SAAS,CAAC,CAAD,CAAT,GAAe3X,EAAnC,CAAZ,CAAjB;AAAA,cACIsgB,IAAI,GAAG7F,SAAS,CAAC4F,UAAD,EAAapI,MAAb,EAAqBiE,aAArB,EAAoC,KAAKqD,IAAzC,CADpB,CAH8B,CAM9B;;AACA,cAAIhH,aAAa,CAAC,KAAKtR,EAAN,EAAUgR,MAAV,CAAjB,EAAoC;AAChC;AACA,gBAAIoI,UAAU,CAAC,CAAD,CAAV,KAAkBC,IAAI,CAAC,CAAD,CAAtB,IAA6BD,UAAU,CAAC,CAAD,CAAV,KAAkBC,IAAI,CAAC,CAAD,CAAvD,EAA4D;AAExD;AACA,kBAAI,CAAChI,aAAL,EAAoB;AAChB;AACA,oBAAIiI,EAAE,GAAGrL,UAAU,CAACuD,aAAD,CAAnB;AACAlJ,sBAAM,CAACkH,QAAP,CAAgB8J,EAAhB,EAAoB9L,QAAQ,CAACS,UAA7B;;AAEA,oBAAIyD,gBAAJ,EAAsB;AAClBA,kCAAgB,CAACoE,WAAjB,CAA6BwD,EAA7B,EADkB,CAElB;;AACD3H,uCAAqB,GAAGrJ,MAAM,CAAC8K,WAAP,CAAmB5B,aAAa,CAACrR,UAAjC,EAA6C,IAA7C,CAAxB;AACAyR,qCAAmB,GAAGtJ,MAAM,CAAC8K,WAAP,CAAmB9K,MAAM,CAACoJ,gBAA1B,EAA4C,IAA5C,CAAtB;AACAG,yBAAO,GAAGF,qBAAqB,CAAC,CAAD,CAArB,GAA2BC,mBAAmB,CAAC,CAAD,CAAxD;AACAE,yBAAO,GAAGH,qBAAqB,CAAC,CAAD,CAArB,GAA2BC,mBAAmB,CAAC,CAAD,CAAxD;AAEF,iBARD,MAQO;AACHJ,+BAAa,CAACrR,UAAd,CAAyB2V,WAAzB,CAAqCwD,EAArC;AACH,iBAfe,CAiBhB;;;AACAtI,sBAAM,GAAGsI,EAAT,CAlBgB,CAmBhB;;AACAjI,6BAAa,GAAG,IAAhB;AACH,eAxBuD,CAyBxD;;;AACAgI,kBAAI,GAAGD,UAAP;AACH,aA3BD,MA4BK;AACD;AACA,kBAAI/H,aAAJ,EAAmB;AACf;AACAL,sBAAM,CAAC7Q,UAAP,CAAkB0I,WAAlB,CAA8BmI,MAA9B,EAFe,CAGf;;AACAA,sBAAM,GAAGQ,aAAT,CAJe,CAKf;;AACAH,6BAAa,GAAG,KAAhB;AACAM,qCAAqB,GAAG,IAAxB;AACAC,mCAAmB,GAAG,IAAtB;AACAC,uBAAO,GAAG,CAAV;AACAC,uBAAO,GAAG,CAAV;AACH;AACJ;AACJ;;AAED,cAAIyH,IAAI,GAAG;AAAEvoB,aAAC,EAACqoB,IAAI,CAAC,CAAD,CAAR;AAAahoB,aAAC,EAACgoB,IAAI,CAAC,CAAD,CAAnB;AAAwBlnB,aAAC,EAAC,KAAKmmB,IAAL,CAAU,CAAV,CAA1B;AAAwChe,aAAC,EAAC,KAAKge,IAAL,CAAU,CAAV;AAA1C,WAAX;AAAA,cACIkB,QAAQ,GAAG;AAAExoB,aAAC,EAACuoB,IAAI,CAACvoB,CAAL,GAAS4f,SAAS,CAAC,CAAD,CAAtB;AAA2Bvf,aAAC,EAACkoB,IAAI,CAACloB,CAAL,GAASuf,SAAS,CAAC,CAAD,CAA/C;AAAoDze,aAAC,EAAConB,IAAI,CAACpnB,CAA3D;AAA8DmI,aAAC,EAACif,IAAI,CAACjf;AAArE,WADf;AAAA,cAEImf,gBAAgB,GAAG,IAFvB;AAIA,eAAKnR,MAAL,CAAYgL,WAAZ,CAAwBtC,MAAxB,EAAgC,CAACqI,IAAI,CAAC,CAAD,CAAJ,GAAUxH,OAAX,EAAoBwH,IAAI,CAAC,CAAD,CAAJ,GAAUvH,OAA9B,CAAhC;;AAEA,eAAK,IAAIlf,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGsiB,kBAAkB,CAAC5iB,MAAvC,EAA+CM,CAAC,EAAhD,EAAoD;AAChD,gBAAIgL,EAAE,GAAG;AAAE5M,eAAC,EAACkkB,kBAAkB,CAACtiB,CAAD,CAAlB,CAAsB8mB,YAAtB,CAAmC,CAAnC,CAAJ;AAA2CroB,eAAC,EAAC6jB,kBAAkB,CAACtiB,CAAD,CAAlB,CAAsB8mB,YAAtB,CAAmC,CAAnC,CAA7C;AAAoFvnB,eAAC,EAAC+iB,kBAAkB,CAACtiB,CAAD,CAAlB,CAAsB0lB,IAAtB,CAA2B,CAA3B,CAAtF;AAAqHhe,eAAC,EAAC4a,kBAAkB,CAACtiB,CAAD,CAAlB,CAAsB0lB,IAAtB,CAA2B,CAA3B;AAAvH,aAAT;;AACA,gBAAI,KAAKhQ,MAAL,CAAY5K,UAAZ,CAAuB8b,QAAvB,EAAiC5b,EAAjC,MAAyCuT,aAAa,IAAIsI,gBAAgB,IAAI,IAArC,IAA6CA,gBAAgB,KAAKvE,kBAAkB,CAACtiB,CAAD,CAAlB,CAAsBoN,EAAjI,KAAwIkV,kBAAkB,CAACtiB,CAAD,CAAlB,CAAsB+mB,OAAtB,CAA8B,IAA9B,CAA5I,EAAiL;AAC7K,kBAAI,CAACF,gBAAL,EAAuBA,gBAAgB,GAAGvE,kBAAkB,CAACtiB,CAAD,CAAlB,CAAsBoN,EAAzC;AACvBmV,oCAAsB,CAAC7d,IAAvB,CAA4B4d,kBAAkB,CAACtiB,CAAD,CAA9C;AACAsiB,gCAAkB,CAACtiB,CAAD,CAAlB,CAAsBmc,QAAtB,CAA+B,IAA/B,EAAqC,IAArC,EAA2CnO,CAA3C;AACH,aAJD,MAKK,IAAIsU,kBAAkB,CAACtiB,CAAD,CAAlB,CAAsBgnB,OAAtB,EAAJ,EAAqC;AACtC1E,gCAAkB,CAACtiB,CAAD,CAAlB,CAAsBmc,QAAtB,CAA+B,IAA/B,EAAqC,KAArC,EAA4CnO,CAA5C;AACH;AACJ;;AAEDuV,mBAAS,CAAC,MAAD,EAAS;AAACnW,cAAE,EAAC,KAAKA,EAAT;AAAaiS,eAAG,EAACoH,IAAjB;AAAuBzY,aAAC,EAACA,CAAzB;AAA4BgN,gBAAI,EAAC;AAAjC,WAAT,CAAT;AAEA;;;;;;AAKH,SA/ED;;AAgFA,aAAKiM,OAAL,GAAe,YAAW;AACtB,eAAKvR,MAAL,CAAYuO,MAAZ,CAAmB,KAAK7W,EAAxB,EAA4B,WAA5B,EAAyC,KAAKqV,YAA9C;AACA,eAAK/M,MAAL,CAAYuO,MAAZ,CAAmBpW,QAAnB,EAA6B,WAA7B,EAA0C,KAAKsV,YAA/C;AACA,eAAKzN,MAAL,CAAYuO,MAAZ,CAAmBpW,QAAnB,EAA6B,SAA7B,EAAwC,KAAKuV,UAA7C;AACA,eAAKX,YAAL,GAAoB,IAApB;AACA,eAAKW,UAAL,GAAkB,IAAlB;AACA,eAAKD,YAAL,GAAoB,IAApB;AACH,SAPD,CA9hBwC,CAuiBxC;;;AACA,aAAKzN,MAAL,CAAYwL,IAAZ,CAAiB,KAAK9T,EAAtB,EAA0B,WAA1B,EAAuC,KAAKqV,YAA5C,EAxiBwC,CA0iBxC;AACA;AACA;;AACA,YAAI,KAAK/M,MAAL,CAAYwR,MAAhB,EACItF,UAAU,CAAC,KAAKlM,MAAL,CAAYwR,MAAb,EAAqB,KAArB,CAAV,CADJ,KAGItF,UAAU,CAAC,KAAKlM,MAAL,CAAY0E,MAAb,EAAqB,KAAK1E,MAAL,CAAY6E,aAAjC,CAAV;AACP,OAjjBD;;AAmjBA,UAAI4M,IAAI,GAAG,SAAPA,IAAO,CAAS/Z,EAAT,EAAasI,MAAb,EAAqBgH,GAArB,EAA0BC,KAA1B,EAAiC;AACxC,aAAKE,MAAL,GAAcH,GAAG,CAAC3B,SAAlB;AACA,aAAKrF,MAAL,GAAcA,MAAM,IAAI,EAAxB;AACA,aAAK0R,IAAL,GAAY1R,MAAM,CAAC0R,IAAP,IAAe,CAA3B;AACA,aAAKC,YAAL,GAAoB,KAAK3R,MAAL,CAAY4R,WAAZ,IAA2B5K,GAAG,CAACxB,MAAnD;AACA,aAAKqM,WAAL,GAAmB,KAAK7R,MAAL,CAAY8R,UAAZ,IAA0B9K,GAAG,CAACvB,KAAjD;AACAsB,aAAK,CAACpV,KAAN,CAAY,IAAZ,EAAkB0F,SAAlB;AACA,YAAIoO,KAAK,GAAG,KAAZ;AACA,aAAKsM,aAAL,GAAqB,KAAK/R,MAAL,CAAY+R,aAAZ,KAA8B,KAAnD;;AAEA,aAAKxL,SAAL,GAAiB,UAASF,GAAT,EAAc;AAC3B,eAAKrG,MAAL,CAAYqG,GAAG,GAAG,UAAH,GAAgB,aAA/B,EAA8C,KAAK3O,EAAnD,EAAuD,KAAKia,YAA5D;AACH,SAFD;;AAIA,aAAKnL,cAAL,GAAsB,YAAW;AAC7B,eAAK8G,QAAL,GAAgB,KAAKtN,MAAL,CAAY8K,WAAZ,CAAwB,KAAKpT,EAA7B,CAAhB;AACA,eAAK0Z,YAAL,GAAoB,KAAKpR,MAAL,CAAY8K,WAAZ,CAAwB,KAAKpT,EAA7B,EAAiC,IAAjC,CAApB;AACA,eAAKsY,IAAL,GAAY,KAAKhQ,MAAL,CAAYiQ,OAAZ,CAAoB,KAAKvY,EAAzB,CAAZ;AACH,SAJD;;AAMA,aAAK2Z,OAAL,GAAe,KAAKrR,MAAL,CAAYqR,OAAZ,IAAuB,UAAS/L,IAAT,EAAe;AACjD,iBAAO,IAAP;AACH,SAFD;;AAIA,aAAKgM,OAAL,GAAe,YAAW;AAAE,iBAAO7L,KAAP;AAAe,SAA3C;;AAEA,aAAKgB,QAAL,GAAgB,UAASnB,IAAT,EAAee,GAAf,EAAoB/N,CAApB,EAAuB;AACnC;AACA,cAAI+N,GAAG,IAAI,KAAK3O,EAAL,CAAQsa,mBAAR,IAA+B,IAAtC,IAA8C,KAAKta,EAAL,CAAQsa,mBAAR,KAAgC1M,IAAI,CAAC5N,EAAL,CAAQmP,UAA1F,EAAsG;AAClG,iBAAK7G,MAAL,CAAYqG,GAAG,GAAG,UAAH,GAAgB,aAA/B,EAA8C,KAAK3O,EAAnD,EAAuD,KAAKma,WAA5D;AACA,iBAAKna,EAAL,CAAQsa,mBAAR,GAA8B3L,GAAG,GAAGf,IAAI,CAAC5N,EAAL,CAAQmP,UAAX,GAAwB,IAAzD;;AACA,gBAAIpB,KAAK,KAAKY,GAAd,EAAmB;AACf,mBAAKrG,MAAL,CAAYkP,MAAZ,CAAmB7I,GAAG,GAAG,MAAH,GAAY,KAAlC,EAAyC;AAAC3O,kBAAE,EAAE,KAAKA,EAAV;AAAcY,iBAAC,EAAEA,CAAjB;AAAoBgN,oBAAI,EAAEA,IAA1B;AAAgCuL,oBAAI,EAAE;AAAtC,eAAzC;AACH;;AACDpL,iBAAK,GAAGY,GAAR;AACH;AACJ,SAVD;AAYA;;;;;;;;;AAOA,aAAKwK,IAAL,GAAY,UAASvL,IAAT,EAAejM,KAAf,EAAsB;AAC9B,iBAAO,KAAK2G,MAAL,CAAYkP,MAAZ,CAAmB,MAAnB,EAA2B;AAAE5J,gBAAI,EAACA,IAAP;AAAahN,aAAC,EAACe,KAAf;AAAsBwX,gBAAI,EAAC;AAA3B,WAA3B,CAAP;AACH,SAFD;;AAIA,aAAKU,OAAL,GAAe,YAAW;AACtB,eAAKpK,MAAL,GAAc,IAAd;AACA,eAAKwK,YAAL,GAAoB,IAApB;AACA,eAAKE,WAAL,GAAmB,IAAnB;AACApM,eAAK,GAAG,IAAR;AACH,SALD;AAMH,OAvDD;;AAyDA,UAAIxO,KAAK,GAAG,SAARA,KAAQ,GAAW;AACnB,eAAQ,uCAAuC4I,OAAvC,CAA+C,OAA/C,EAAwD,UAAShV,CAAT,EAAY;AACxE,cAAI4G,CAAC,GAAGjJ,IAAI,CAACsX,MAAL,KAAc,EAAd,GAAiB,CAAzB;AAAA,cAA4B5W,CAAC,GAAG2B,CAAC,KAAK,GAAN,GAAY4G,CAAZ,GAAiBA,CAAC,GAAC,GAAF,GAAM,GAAvD;AACA,iBAAOvI,CAAC,CAACkL,QAAF,CAAW,EAAX,CAAP;AACH,SAHO,CAAR;AAIH,OALD;;AAOA,UAAIuc,SAAS,GAAG,SAAZA,SAAY,CAAS7jB,CAAT,EAAWC,CAAX,EAAc;AAC1B,eAAOD,CAAC,CAAC4kB,IAAF,GAAS3kB,CAAC,CAAC2kB,IAAX,GAAkB,CAAlB,GAAsB5kB,CAAC,CAAC4kB,IAAF,GAAS3kB,CAAC,CAAC2kB,IAAX,GAAkB,CAAC,CAAnB,GAAuB,CAApD;AACH,OAFD;;AAIA,UAAI1Z,IAAI,GAAG,SAAPA,IAAO,CAASN,EAAT,EAAa;AACpB,YAAIA,EAAE,IAAI,IAAV,EAAgB,OAAO,IAAP;AAChBA,UAAE,GAAI,OAAOA,EAAP,KAAc,QAAd,IAA0BA,EAAE,CAACO,WAAH,KAAmBC,MAA9C,GAAyDC,QAAQ,CAACC,cAAT,CAAwBV,EAAxB,CAAzD,GAAuFA,EAA5F;AACA,YAAIA,EAAE,IAAI,IAAV,EAAgB,OAAO,IAAP;AAChBA,UAAE,CAACmP,UAAH,GAAgBnP,EAAE,CAACmP,UAAH,IAAiB5P,KAAK,EAAtC;AACA,eAAOS,EAAP;AACH,OAND;;AAQAnP,UAAI,CAAC0pB,SAAL,GAAiB,UAASC,eAAT,EAA0B;AAEvC,YAAIC,UAAU,GAAG,EAAjB;AAAA,YACIC,aAAa,GAAG,EADpB;AAGA,aAAKC,aAAL,GAAqB,EAArB;AACA,aAAKC,aAAL,GAAqB,EAArB;;AACA,YAAIC,KAAK,GAAG,CAAZ;AAAA,YACIC,IAAI,GAAG,SAAPA,IAAO,CAAS/Z,GAAT,EAAcga,GAAd,EAAmB;AACtBpT,eAAK,CAAC5G,GAAD,EAAM,UAASia,IAAT,EAAe;AACtB,iBAAI,IAAIpoB,CAAC,GAAG,CAAZ,EAAeA,CAAC,GAAGooB,IAAI,CAAChL,MAAL,CAAY1d,MAA/B,EAAuCM,CAAC,EAAxC,EAA4C;AACxCmoB,iBAAG,CAACC,IAAI,CAAChL,MAAL,CAAYpd,CAAZ,CAAD,CAAH,GAAsBmoB,GAAG,CAACC,IAAI,CAAChL,MAAL,CAAYpd,CAAZ,CAAD,CAAH,IAAuB,EAA7C;;AACAmoB,iBAAG,CAACC,IAAI,CAAChL,MAAL,CAAYpd,CAAZ,CAAD,CAAH,CAAoB0E,IAApB,CAAyB0jB,IAAzB;AACH;AACJ,WALI,CAAL;AAMH,SARL;AAAA,YASIC,MAAM,GAAG,SAATA,MAAS,CAASla,GAAT,EAAcga,GAAd,EAAmB;AACxB,cAAI5nB,CAAC,GAAG,CAAR;;AACAwU,eAAK,CAAC5G,GAAD,EAAM,UAASia,IAAT,EAAe;AACtB,iBAAI,IAAIpoB,CAAC,GAAG,CAAZ,EAAeA,CAAC,GAAGooB,IAAI,CAAChL,MAAL,CAAY1d,MAA/B,EAAuCM,CAAC,EAAxC,EAA4C;AACxC,kBAAImoB,GAAG,CAACC,IAAI,CAAChL,MAAL,CAAYpd,CAAZ,CAAD,CAAP,EAAyB;AACrB,oBAAIwU,GAAG,GAAGoT,eAAe,CAACrZ,OAAhB,CAAwB4Z,GAAG,CAACC,IAAI,CAAChL,MAAL,CAAYpd,CAAZ,CAAD,CAA3B,EAA6CooB,IAA7C,CAAV;;AACA,oBAAI5T,GAAG,KAAK,CAAC,CAAb,EAAgB;AACZ2T,qBAAG,CAACC,IAAI,CAAChL,MAAL,CAAYpd,CAAZ,CAAD,CAAH,CAAoB4O,MAApB,CAA2B4F,GAA3B,EAAgC,CAAhC;;AACAjU,mBAAC;AACJ;AACJ;AACJ;AACJ,WAVI,CAAL;;AAYA,iBAAOA,CAAC,GAAG,CAAX;AACH,SAxBL;AAAA,YAyBI+nB,sBAAsB,GAAG,KAAK1C,qBAAL,GAA6B,UAAS5K,IAAT,EAAe;AACjE,cAAIc,EAAE,GAAG,EAAT;AAAA,cAAayM,EAAE,GAAG,EAAlB;;AACA,eAAK,IAAIvoB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGgb,IAAI,CAACoC,MAAL,CAAY1d,MAAhC,EAAwCM,CAAC,EAAzC,EAA6C;AACzC,gBAAIwoB,GAAG,GAAG,KAAKR,aAAL,CAAmBhN,IAAI,CAACoC,MAAL,CAAYpd,CAAZ,CAAnB,CAAV;;AACA,gBAAIwoB,GAAJ,EAAS;AACL,mBAAK,IAAInnB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGmnB,GAAG,CAAC9oB,MAAxB,EAAgC2B,CAAC,EAAjC,EAAqC;AACjC,oBAAImnB,GAAG,CAACnnB,CAAD,CAAH,CAAO0lB,OAAP,CAAe/L,IAAf,KAAyB,CAACuN,EAAE,CAACC,GAAG,CAACnnB,CAAD,CAAH,CAAOyb,IAAR,CAA5B,KAA8C0L,GAAG,CAACnnB,CAAD,CAAH,CAAOomB,aAAP,IAAwBe,GAAG,CAACnnB,CAAD,CAAH,CAAO+L,EAAP,KAAc4N,IAAI,CAAC5N,EAAzF,CAAJ,EAAkG;AAC9Fmb,oBAAE,CAACC,GAAG,CAACnnB,CAAD,CAAH,CAAOyb,IAAR,CAAF,GAAkB,IAAlB;AACAhB,oBAAE,CAACpX,IAAH,CAAQ8jB,GAAG,CAACnnB,CAAD,CAAX;AACH;AACJ;AACJ;AACJ;;AACDya,YAAE,CAACsK,IAAH,CAAQC,SAAR;AACA,iBAAOvK,EAAP;AACH,SAxCL;AAAA,YAyCI2M,cAAc,GAAG,UAAShkB,CAAT,EAAY;AACzBA,WAAC,GAAGA,CAAC,IAAI,EAAT;AACA,cAAIikB,EAAE,GAAG;AACL9D,kBAAM,EAAC;AADF,WAAT;AAAA,cAEG5kB,CAFH;;AAGA,eAAKA,CAAL,IAAU4nB,eAAV;AAA2Bc,cAAE,CAAC1oB,CAAD,CAAF,GAAQ4nB,eAAe,CAAC5nB,CAAD,CAAvB;AAA3B;;AACA,eAAKA,CAAL,IAAUyE,CAAV;AAAaikB,cAAE,CAAC1oB,CAAD,CAAF,GAAQyE,CAAC,CAACzE,CAAD,CAAT;AAAb,WANyB,CAOzB;;;AAEA,eAAKA,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGwb,OAAO,CAAC9b,MAAxB,EAAgCM,CAAC,EAAjC,EAAqC;AACjC0oB,cAAE,CAAC9D,MAAH,CAAUpJ,OAAO,CAACxb,CAAD,CAAjB,IAAwByE,CAAC,CAAC+W,OAAO,CAACxb,CAAD,CAAR,CAAD,IAAiByb,QAAzC;AACH;;AACDiN,YAAE,CAAClL,SAAH,GAAe,IAAf;AACA,iBAAOkL,EAAP;AACH,SAdgB,CAcfxH,IAde,CAcV,IAdU,CAzCrB;AAAA,YAwDIyH,UAAU,GAAG,UAASC,YAAT,EAAuBlT,MAAvB,EAA+B;AACxC,eAAK,IAAI1V,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGwb,OAAO,CAAC9b,MAA5B,EAAoCM,CAAC,EAArC,EAAyC;AACrC,gBAAI0V,MAAM,CAAC8F,OAAO,CAACxb,CAAD,CAAR,CAAV,EAAwB;AACpB4oB,0BAAY,CAAC1S,EAAb,CAAgBsF,OAAO,CAACxb,CAAD,CAAvB,EAA4B0V,MAAM,CAAC8F,OAAO,CAACxb,CAAD,CAAR,CAAlC;AACH;AACJ;AACJ,SANY,CAMXkhB,IANW,CAMN,IANM,CAxDjB;AAAA,YA+DI2H,IAAI,GAAG,EA/DX;AAAA,YAgEIC,WAAW,GAAGlB,eAAe,CAAClL,GAAhB,IAAuB,EAhEzC;AAAA,YAiEIqM,MAAM,GAAGnB,eAAe,CAACjL,KAAhB,IAAyBpB,aAjEtC,CAPuC,CA0EvC;;;AACA,aAAK,IAAIvb,CAAT,IAAc4a,QAAd;AAAwBiO,cAAI,CAAC7oB,CAAD,CAAJ,GAAU4a,QAAQ,CAAC5a,CAAD,CAAlB;AAAxB;;AACA,aAAK,IAAIA,CAAT,IAAc8oB,WAAd;AAA2BD,cAAI,CAAC7oB,CAAD,CAAJ,GAAU8oB,WAAW,CAAC9oB,CAAD,CAArB;AAA3B;;AAEA,YAAIgpB,mBAAmB,GAAGpB,eAAe,CAACoB,mBAAhB,IAAuC3M,2BAAjE;AACA;;;;;;AAKA,aAAKG,sBAAL,GAA8B,YAAW;AAAE,iBAAOwM,mBAAP;AAA6B,SAAxE;AAEA;;;;;;;;AAMA,aAAKC,sBAAL,GAA8B,UAAS5b,QAAT,EAAmB;AAC7C2b,6BAAmB,GAAG3b,QAAtB;AACA,iBAAO,IAAP;AACH,SAHD;AAKA;;;;;;;;;AAOA,aAAKyN,SAAL,GAAiB,UAAS1N,EAAT,EAAasI,MAAb,EAAqB;AAClC,cAAIwT,CAAC,GAAG,EAAR;;AACAnU,eAAK,CAAC3H,EAAD,EAAK,UAAU4H,GAAV,EAAe;AACrBA,eAAG,GAAGtH,IAAI,CAACsH,GAAD,CAAV;;AACA,gBAAIA,GAAG,IAAI,IAAX,EAAiB;AACb,kBAAIA,GAAG,CAACmU,cAAJ,IAAsB,IAA1B,EAAgC;AAC5B,oBAAI1kB,CAAC,GAAGgkB,cAAc,CAAC/S,MAAD,CAAtB;;AACAV,mBAAG,CAACmU,cAAJ,GAAqB,IAAIxL,IAAJ,CAAS3I,GAAT,EAAcvQ,CAAd,EAAiBokB,IAAjB,EAAuBE,MAAvB,CAArB;;AACAb,oBAAI,CAAClT,GAAG,CAACmU,cAAL,EAAqB,KAAKpB,aAA1B,CAAJ;;AACAmB,iBAAC,CAACxkB,IAAF,CAAOsQ,GAAG,CAACmU,cAAX;AACAvB,+BAAe,CAAChL,QAAhB,CAAyB5H,GAAzB,EAA8BvQ,CAAC,CAAC4I,QAAF,GAAawb,IAAI,CAAChO,kBAAlB,GAAuCgO,IAAI,CAAC/N,SAA1E;AACH,eAND,MAOK;AACD6N,0BAAU,CAAC3T,GAAG,CAACmU,cAAL,EAAqBzT,MAArB,CAAV;AACH;AACJ;AACJ,WAdS,CAcRwL,IAdQ,CAcH,IAdG,CAAL,CAAL;;AAeA,iBAAOgI,CAAP;AACH,SAlBD;;AAoBA,aAAKnO,SAAL,GAAiB,UAAS3N,EAAT,EAAasI,MAAb,EAAqB;AAClC,cAAIwT,CAAC,GAAG,EAAR;;AACAnU,eAAK,CAAC3H,EAAD,EAAK,UAAS4H,GAAT,EAAc;AACpBA,eAAG,GAAGtH,IAAI,CAACsH,GAAD,CAAV;;AACA,gBAAIA,GAAG,IAAI,IAAX,EAAiB;AACb,kBAAIuR,IAAI,GAAG,IAAIY,IAAJ,CAASnS,GAAT,EAAcyT,cAAc,CAAC/S,MAAD,CAA5B,EAAsCmT,IAAtC,EAA4CE,MAA5C,CAAX;AACA/T,iBAAG,CAACoU,cAAJ,GAAqBpU,GAAG,CAACoU,cAAJ,IAAsB,EAA3C;;AACApU,iBAAG,CAACoU,cAAJ,CAAmB1kB,IAAnB,CAAwB6hB,IAAxB;;AACA2B,kBAAI,CAAC3B,IAAD,EAAO,KAAKyB,aAAZ,CAAJ;;AACAkB,eAAC,CAACxkB,IAAF,CAAO6hB,IAAP;AACAqB,6BAAe,CAAChL,QAAhB,CAAyB5H,GAAzB,EAA8B6T,IAAI,CAAC9N,SAAnC;AACH;AACJ,WAVS,CAURmG,IAVQ,CAUH,IAVG,CAAL,CAAL;;AAWA,iBAAOgI,CAAP;AACH,SAdD;AAgBA;;;;;;;;AAMA,aAAKG,MAAL,GAAc,UAASjc,EAAT,EAAa;AACvB2H,eAAK,CAAC3H,EAAD,EAAK,YAAW;AACjB,gBAAI4H,GAAG,GAAGtH,IAAI,CAAC,IAAD,CAAd;;AACA,gBAAIsH,GAAG,IAAIA,GAAG,CAACmU,cAAf,EAA+B;AAC3B,kBAAI,CAACrB,aAAa,CAAC9S,GAAG,CAACuH,UAAL,CAAlB,EAAoC;AAChCsL,0BAAU,CAACnjB,IAAX,CAAgBsQ,GAAG,CAACmU,cAApB;;AACArB,6BAAa,CAAC9S,GAAG,CAACuH,UAAL,CAAb,GAAgC,CAAEvH,GAAF,EAAO6S,UAAU,CAACnoB,MAAX,GAAoB,CAA3B,CAAhC;AACAkoB,+BAAe,CAAChL,QAAhB,CAAyB5H,GAAzB,EAA8B6T,IAAI,CAAC5N,QAAnC;AACH;AACJ;AACJ,WATI,CAAL;;AAUA,iBAAO,IAAP;AACH,SAZD;AAcA;;;;;;;;AAMA,aAAKqO,QAAL,GAAgB,UAASlc,EAAT,EAAa;AACzB2H,eAAK,CAAC3H,EAAD,EAAK,YAAW;AACjB,gBAAI4H,GAAG,GAAGtH,IAAI,CAAC,IAAD,CAAd;;AACA,gBAAIsH,GAAG,IAAIA,GAAG,CAACuH,UAAf,EAA2B;AACvB,kBAAIvO,CAAC,GAAG8Z,aAAa,CAAC9S,GAAG,CAACuH,UAAL,CAArB;;AACA,kBAAIvO,CAAJ,EAAO;AACH,oBAAIub,EAAE,GAAG,EAAT;;AACA,qBAAK,IAAIvpB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG6nB,UAAU,CAACnoB,MAA/B,EAAuCM,CAAC,EAAxC;AACI,sBAAI6nB,UAAU,CAAC7nB,CAAD,CAAV,CAAcoN,EAAd,KAAqB4H,GAAzB,EAA8BuU,EAAE,CAAC7kB,IAAH,CAAQmjB,UAAU,CAAC7nB,CAAD,CAAlB;AADlC;;AAEA6nB,0BAAU,GAAG0B,EAAb;AACA,uBAAOzB,aAAa,CAAC9S,GAAG,CAACuH,UAAL,CAApB;AACAqL,+BAAe,CAAC1D,WAAhB,CAA4BlP,GAA5B,EAAiC6T,IAAI,CAAC5N,QAAtC;AACH;AACJ;AACJ,WAbI,CAAL;;AAcA,iBAAO,IAAP;AACH,SAhBD;;AAkBA,aAAKuO,WAAL,GAAmB,YAAW;AAC1B,eAAK,IAAIxpB,CAAT,IAAc8nB,aAAd,EAA6B;AACzB,gBAAItnB,CAAC,GAAGsnB,aAAa,CAAC9nB,CAAD,CAArB;AACA4nB,2BAAe,CAAC1D,WAAhB,CAA4B1jB,CAAC,CAAC,CAAD,CAA7B,EAAkCqoB,IAAI,CAAC5N,QAAvC;AACH;;AAED4M,oBAAU,CAACnoB,MAAX,GAAoB,CAApB;AACAooB,uBAAa,GAAG,EAAhB;AACH,SARD;;AAUA,aAAKzE,aAAL,GAAqB,UAASrI,IAAT,EAAe;AAChCW,kBAAQ,CAACkM,UAAD,EAAa,UAAS7Z,CAAT,EAAY;AAAEA,aAAC,CAAC0V,IAAF;AAAW,WAAtC,EAAwC1I,IAAxC,CAAR;AACH,SAFD;;AAIA,aAAKsI,UAAL,GAAkB,UAAStI,IAAT,EAAe;AAC7B,cAAIA,IAAI,CAACiF,MAAT,EAAiB;AACblL,iBAAK,CAACiG,IAAI,CAACiF,MAAN,EAAc,UAASxb,CAAT,EAAY;AAC3B,kBAAIuW,IAAI,CAACkF,UAAL,CAAgBzb,CAAhB,KAAsBglB,OAAO,CAAChlB,CAAD,CAAjC,EAAsC;AAClCkX,wBAAQ,CAAC8N,OAAO,CAAChlB,CAAD,CAAP,CAAWilB,OAAZ,EAAqB,UAAUlpB,CAAV,EAAa;AACtCA,mBAAC,CAACkjB,IAAF;AACH,iBAFO,EAEL1I,IAFK,CAAR;AAGH;AACJ,aANI,CAAL;AAOH;AACJ,SAVD;;AAYA,aAAKoJ,eAAL,GAAuB,UAASpJ,IAAT,EAAejM,KAAf,EAAsB;AACzC4M,kBAAQ,CAACkM,UAAD,EAAa,UAAS7Z,CAAT,EAAY;AAAEA,aAAC,CAACmW,MAAF,CAASpV,KAAT;AAAkB,WAA7C,EAA+CiM,IAA/C,CAAR;AACH,SAFD;;AAIA,aAAKqJ,YAAL,GAAoB,UAASrJ,IAAT,EAAejM,KAAf,EAAsB;AACtC,cAAIiM,IAAI,CAACiF,MAAT,EAAiB;AACblL,iBAAK,CAACiG,IAAI,CAACiF,MAAN,EAAc,UAASxb,CAAT,EAAY;AAC3B,kBAAIuW,IAAI,CAACkF,UAAL,CAAgBzb,CAAhB,KAAsBglB,OAAO,CAAChlB,CAAD,CAAjC,EAAsC;AAClCkX,wBAAQ,CAAC8N,OAAO,CAAChlB,CAAD,CAAP,CAAWilB,OAAZ,EAAqB,UAAUlpB,CAAV,EAAa;AACtCA,mBAAC,CAAC2jB,MAAF,CAASpV,KAAT,EAAgB,IAAhB;AACH,iBAFO,EAELiM,IAFK,CAAR;AAGH;AACJ,aANI,CAAL;AAOH;AACJ,SAVD;;AAYA,aAAKoK,YAAL,GAAoB,YAAW;AAAE,iBAAOyC,UAAU,CAAC3hB,KAAX,CAAiB,CAAjB,CAAP;AAA6B,SAA9D;;AAEA,aAAK6d,eAAL,GAAuB,UAAS3d,EAAT,EAAaD,EAAb,EAAiB6U,IAAjB,EAAuB;AAC1CW,kBAAQ,CAACkM,UAAD,EAAa,UAAS7Z,CAAT,EAAY;AAAEA,aAAC,CAAC8V,MAAF,CAAS1d,EAAT,EAAaD,EAAb;AAAmB,WAA9C,EAAgD6U,IAAhD,CAAR;AACH,SAFD;;AAIA,YAAI2O,YAAY,GAAG,SAAfA,YAAe,CAAS3f,EAAT,EAAagR,IAAb,EAAmB;AAClC,cAAIA,IAAI,CAACiF,MAAT,EAAiB;AACblL,iBAAK,CAACiG,IAAI,CAACiF,MAAN,EAAc,UAASxb,CAAT,EAAY;AAC3B,kBAAIuW,IAAI,CAACkF,UAAL,CAAgBzb,CAAhB,KAAsBglB,OAAO,CAAChlB,CAAD,CAAjC,EAAsC;AAClCkX,wBAAQ,CAAC8N,OAAO,CAAChlB,CAAD,CAAP,CAAWilB,OAAZ,EAAqB,UAAU1b,CAAV,EAAa;AACtChE,oBAAE,CAACgE,CAAD,CAAF;AACH,iBAFO,EAELgN,IAFK,CAAR;AAGH;AACJ,aANI,CAAL;AAOH;AACJ,SAVD;;AAYA,aAAKgJ,YAAL,GAAoB,UAAS5d,EAAT,EAAaD,EAAb,EAAiB6U,IAAjB,EAAuB;AACvC2O,sBAAY,CAAC,UAAS3b,CAAT,EAAY;AAAEA,aAAC,CAAC8V,MAAF,CAAS1d,EAAT,EAAaD,EAAb;AAAmB,WAAlC,EAAoC6U,IAApC,CAAZ;AACH,SAFD;;AAIA,aAAKuJ,mBAAL,GAA2B,UAASvJ,IAAT,EAAevL,GAAf,EAAoB;AAC3Cka,sBAAY,CAAC,UAAS3b,CAAT,EAAY;AAAEA,aAAC,CAACsW,IAAF,CAAO7U,GAAP,EAAY,IAAZ;AAAoB,WAAnC,EAAqCuL,IAArC,CAAZ;AACH,SAFD;;AAIA,aAAK4O,uBAAL,GAA+B,UAAS5O,IAAT,EAAevL,GAAf,EAAoB;AAC/CkM,kBAAQ,CAACkM,UAAD,EAAa,UAAS7Z,CAAT,EAAY;AAAEA,aAAC,CAACsW,IAAF,CAAO7U,GAAP,EAAY,IAAZ;AAAoB,WAA/C,EAAiDuL,IAAjD,CAAR;AACH,SAFD;;AAIA,aAAKgL,wBAAL,GAAgC,UAAShL,IAAT,EAAevL,GAAf,EAAoB;AAChDkM,kBAAQ,CAACkM,UAAD,EAAa,UAAS7Z,CAAT,EAAY;AAAEA,aAAC,CAACgX,WAAF,CAAcvV,GAAd;AAAoB,WAA/C,EAAiDuL,IAAjD,CAAR;AACH,SAFD;;AAIA,aAAK6O,OAAL,GAAe,UAASnpB,CAAT,EAAY;AAAEunB,eAAK,GAAGvnB,CAAR;AAAY,SAAzC;;AACA,aAAKmjB,OAAL,GAAe,YAAW;AAAE,iBAAOoE,KAAP;AAAe,SAA3C,CArQuC,CAuQvC;;;AACA,YAAI6B,WAAW,GAAG,SAAdA,WAAc,CAASC,IAAT,EAAe3M,MAAf,EAAuB+K,GAAvB,EAA4Bne,EAA5B,EAAgC;AAC9C+K,eAAK,CAACgV,IAAD,EAAO,UAASC,KAAT,EAAgB;AACxB3B,kBAAM,CAAC2B,KAAD,EAAQ7B,GAAR,CAAN,CADwB,CACH;;;AACrB6B,iBAAK,CAAChgB,EAAD,CAAL,CAAUoT,MAAV,EAFwB,CAEL;;;AACnB8K,gBAAI,CAAC8B,KAAD,EAAQ7B,GAAR,CAAJ,CAHwB,CAGN;;AACrB,WAJI,CAAL;AAKH,SAND;;AAQApT,aAAK,CAAC,CAAE,KAAF,EAAS,KAAT,EAAgB,QAAhB,EAA0B,QAA1B,CAAD,EAAsC,UAASnW,CAAT,EAAY;AACnD,eAAKA,CAAC,GAAG,OAAT,IAAoB,UAASwO,EAAT,EAAagQ,MAAb,EAAqB;AACrC0M,uBAAW,CAAC1c,EAAE,CAAC+b,cAAJ,EAAoB/L,MAApB,EAA4B,KAAK2K,aAAjC,EAAgDnpB,CAAC,GAAG,OAApD,CAAX;;AACAkrB,uBAAW,CAAC1c,EAAE,CAACgc,cAAJ,EAAoBhM,MAApB,EAA4B,KAAK4K,aAAjC,EAAgDppB,CAAC,GAAG,OAApD,CAAX;AACH,WAHmB,CAGlBsiB,IAHkB,CAGb,IAHa,CAApB;;AAIA,eAAKtiB,CAAC,GAAG,WAAT,IAAwB,UAASwO,EAAT,EAAagQ,MAAb,EAAqB;AACzC0M,uBAAW,CAAC1c,EAAE,CAACO,WAAH,KAAmBgQ,IAAnB,GAA0BvQ,EAA1B,GAA+BA,EAAE,CAAC+b,cAAnC,EAAmD/L,MAAnD,EAA2D,KAAK2K,aAAhE,EAA+EnpB,CAAC,GAAG,OAAnF,CAAX;AACH,WAFuB,CAEtBsiB,IAFsB,CAEjB,IAFiB,CAAxB;;AAGA,eAAKtiB,CAAC,GAAG,WAAT,IAAwB,UAASwO,EAAT,EAAagQ,MAAb,EAAqB;AACzC0M,uBAAW,CAAC1c,EAAE,CAACO,WAAH,KAAmBwZ,IAAnB,GAA0B/Z,EAA1B,GAA+BA,EAAE,CAACgc,cAAnC,EAAmDhM,MAAnD,EAA2D,KAAK4K,aAAhE,EAA+EppB,CAAC,GAAG,OAAnF,CAAX;AACH,WAFuB,CAEtBsiB,IAFsB,CAEjB,IAFiB,CAAxB;AAGH,SAX0C,CAWzCA,IAXyC,CAWpC,IAXoC,CAAtC,CAAL;;AAaA,aAAK+I,UAAL,GAAkB,UAAS7rB,CAAT,EAAYK,CAAZ,EAAe;AAC7B,eAAK,IAAIM,CAAT,IAAc,KAAKgpB,aAAnB,EAAkC;AAC9BpM,oBAAQ,CAAC,KAAKoM,aAAL,CAAmBhpB,CAAnB,CAAD,EAAwB,UAASyB,CAAT,EAAY;AAAEA,eAAC,CAAC+f,IAAF,CAAOniB,CAAP,EAAUK,CAAV;AAAe,aAArD,CAAR;AACH;AACJ,SAJD;;AAMA,aAAKyrB,gBAAL,GAAwB,UAASnrB,CAAT,EAAY;AAAE,iBAAO,KAAKgpB,aAAL,CAAmBhpB,CAAnB,CAAP;AAA+B,SAArE;;AACA,aAAKorB,gBAAL,GAAwB,UAASprB,CAAT,EAAY;AAAE,iBAAO,KAAKipB,aAAL,CAAmBjpB,CAAnB,CAAP;AAA+B,SAArE;;AAEA,YAAIqrB,QAAQ,GAAG,SAAXA,QAAW,CAAShd,EAAT,EAAakF,IAAb,EAAmB6V,GAAnB,EAAwB;AACnC/a,YAAE,GAAGM,IAAI,CAACN,EAAD,CAAT;;AACA,cAAIA,EAAE,CAACkF,IAAD,CAAN,EAAc;AAEV;AACA,gBAAI+X,MAAM,GAAGxC,UAAU,CAACtZ,OAAX,CAAmBnB,EAAE,CAACkF,IAAD,CAArB,CAAb;;AACA,gBAAI+X,MAAM,IAAI,CAAd,EAAiB;AACbxC,wBAAU,CAACjZ,MAAX,CAAkByb,MAAlB,EAA0B,CAA1B;AACH;;AAED,gBAAIhC,MAAM,CAACjb,EAAE,CAACkF,IAAD,CAAH,EAAW6V,GAAX,CAAV,EAA2B;AACvBpT,mBAAK,CAAC3H,EAAE,CAACkF,IAAD,CAAH,EAAW,UAASyX,IAAT,EAAe;AAAEA,oBAAI,CAAC9C,OAAL;AAAgB,eAA5C,CAAL;AACH;;AAED,mBAAO7Z,EAAE,CAACkF,IAAD,CAAT;AACH;AACJ,SAhBD;;AAkBA,YAAIgY,eAAe,GAAG,SAAlBA,eAAkB,CAASld,EAAT,EAAakF,IAAb,EAAmB7C,GAAnB,EAAwBzF,EAAxB,EAA4B;AAC9CoD,YAAE,GAAGM,IAAI,CAACN,EAAD,CAAT;;AACA,cAAIA,EAAE,CAACkF,IAAD,CAAN,EAAc;AACVlF,cAAE,CAACkF,IAAD,CAAF,CAASgE,GAAT,CAAa7G,GAAb,EAAkBzF,EAAlB;AACH;AACJ,SALD;;AAOA,aAAKugB,cAAL,GAAsB,UAASnd,EAAT,EAAa;AAC/B,eAAKod,gBAAL,CAAsBpd,EAAtB;AACA,eAAKqd,gBAAL,CAAsBrd,EAAtB;AACH,SAHD;AAKA;;;;;;;;;;AAQA,aAAKod,gBAAL,GAAwB,UAASpd,EAAT,EAAaqC,GAAb,EAAkBzF,EAAlB,EAAsB;AAC1C,cAAI+C,SAAS,CAACrN,MAAV,KAAqB,CAAzB,EAA4B;AACxB0qB,oBAAQ,CAAChd,EAAD,EAAK,gBAAL,EAAuB,KAAK2a,aAA5B,CAAR;AACH,WAFD,MAEO;AACHuC,2BAAe,CAACld,EAAD,EAAK,gBAAL,EAAuBqC,GAAvB,EAA4BzF,EAA5B,CAAf;AACH;AACJ,SAND;AAQA;;;;;;;;;;AAQA,aAAKygB,gBAAL,GAAwB,UAASrd,EAAT,EAAaqC,GAAb,EAAkBzF,EAAlB,EAAsB;AAC1C,cAAI+C,SAAS,CAACrN,MAAV,KAAqB,CAAzB,EAA4B;AACxB0qB,oBAAQ,CAAChd,EAAD,EAAK,gBAAL,EAAuB,KAAK4a,aAA5B,CAAR;AACH,WAFD,MAEO;AACHsC,2BAAe,CAACld,EAAD,EAAK,gBAAL,EAAuBqC,GAAvB,EAA4BzF,EAA5B,CAAf;AACH;AACJ,SAND;;AAQA,aAAK0gB,KAAL,GAAa,YAAW;AACpB,eAAK3C,aAAL,GAAqB,EAArB;AACA,eAAKC,aAAL,GAAqB,EAArB;AACAH,oBAAU,GAAG,EAAb;AACAC,uBAAa,GAAG,EAAhB;AACA2B,iBAAO,GAAG,EAAV;AACH,SAND,CApWuC,CA4WvC;;;AACA,YAAIA,OAAO,GAAG,EAAd;;AAEA,YAAIkB,eAAe,GAAG,SAAlBA,eAAkB,CAASvd,EAAT,EAAawd,KAAb,EAAoBC,eAApB,EAAqC;AACvD,cAAIC,OAAO,GAAG9R,SAAS,CAAC4R,KAAD,CAAT,GAAmBA,KAAnB,GAA2BA,KAAK,CAACG,EAA/C;AACA,cAAI7P,MAAM,GAAGlC,SAAS,CAAC4R,KAAD,CAAT,GAAmB,IAAnB,GAA0BA,KAAK,CAAC1P,MAAN,KAAiB,KAAxD;;AACA,cAAI8P,KAAK,GAAGvB,OAAO,CAACqB,OAAD,CAAP,IAAqB,YAAW;AACxC,gBAAI9b,CAAC,GAAG;AAACic,kBAAI,EAACH,OAAN;AAAepB,qBAAO,EAAC;AAAvB,aAAR;AACAD,mBAAO,CAACqB,OAAD,CAAP,GAAmB9b,CAAnB;AACA,mBAAOA,CAAP;AACH,WAJ+B,EAAhC;;AAKA+F,eAAK,CAAC3H,EAAD,EAAK,UAAS4H,GAAT,EAAc;AACpB,gBAAIA,GAAG,CAACmU,cAAR,EAAwB;AAEpB,kBAAI0B,eAAe,IAAI7V,GAAG,CAACmU,cAAJ,CAAmBjJ,UAAnB,CAA8B8K,KAAK,CAACC,IAApC,KAA6C,IAApE,EAA0E;;AAE1ExS,sBAAQ,CAACuS,KAAK,CAACtB,OAAP,EAAgB1U,GAAG,CAACmU,cAApB,CAAR;;AACA1Q,sBAAQ,CAACzD,GAAG,CAACmU,cAAJ,CAAmBlJ,MAApB,EAA4B+K,KAAK,CAACC,IAAlC,CAAR;;AACAjW,iBAAG,CAACmU,cAAJ,CAAmBjJ,UAAnB,CAA8B8K,KAAK,CAACC,IAApC,IAA4C/P,MAA5C;AACH;AACJ,WATI,CAAL;;AAUA,iBAAO8P,KAAP;AACH,SAnBD;AAqBA;;;;;;;;;;;;AAUA,aAAKE,UAAL,GAAkB,UAAS9d,EAAT,EAAa+d,IAAb,EAAmB;AAEjC,cAAIlL,MAAM,GAAG,EAAb;;AAEA,eAAK,IAAIjgB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG+M,SAAS,CAACrN,MAA9B,EAAsCM,CAAC,EAAvC,EAA2C;AACvCigB,kBAAM,CAACvb,IAAP,CAAYimB,eAAe,CAACvd,EAAD,EAAKL,SAAS,CAAC/M,CAAD,CAAd,CAA3B;AACH;;AAED,iBAAOigB,MAAM,CAACvgB,MAAP,KAAkB,CAAlB,GAAsBugB,MAAM,CAAC,CAAD,CAA5B,GAAkCA,MAAzC;AACH,SATD;AAWA;;;;;;;;;;;;;;AAYA,aAAKmL,QAAL,GAAgB,UAAShe,EAAT,EAAa+d,IAAb,EAAmB;AAE/B,cAAIlL,MAAM,GAAG,EAAb;;AAEA,eAAK,IAAIjgB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG+M,SAAS,CAACrN,MAA9B,EAAsCM,CAAC,EAAvC,EAA2C;AACvCigB,kBAAM,CAACvb,IAAP,CAAYimB,eAAe,CAACvd,EAAD,EAAKL,SAAS,CAAC/M,CAAD,CAAd,EAAmB,IAAnB,CAAf,CAAwCirB,IAApD;AACH;;AAEDlW,eAAK,CAAC3H,EAAD,EAAK,UAAS4H,GAAT,EAAc;AACpB,gBAAIA,GAAG,CAACmU,cAAR,EAAwB;AACpB,kBAAIkC,IAAI,GAAGxS,WAAW,CAAC7D,GAAG,CAACmU,cAAJ,CAAmBlJ,MAApB,EAA4BA,MAA5B,CAAtB;;AACA,kBAAIxb,CAAC,GAAG,EAAR;AACAqI,mBAAK,CAACjD,SAAN,CAAgBnF,IAAhB,CAAqB2C,KAArB,CAA2B5C,CAA3B,EAA8BuQ,GAAG,CAACmU,cAAJ,CAAmBlJ,MAAjD;;AACA,mBAAK,IAAIjgB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGqrB,IAAI,CAAC3rB,MAAzB,EAAiCM,CAAC,EAAlC,EAAsC;AAClC,qBAAKsrB,eAAL,CAAqBtW,GAArB,EAA0BqW,IAAI,CAACrrB,CAAD,CAA9B;AACH;AACJ;AACJ,WATS,CASRkhB,IATQ,CASH,IATG,CAAL,CAAL;;AAWA,iBAAOjB,MAAM,CAACvgB,MAAP,KAAkB,CAAlB,GAAsBugB,MAAM,CAAC,CAAD,CAA5B,GAAkCA,MAAzC;AACH,SApBD;AAsBA;;;;;;;;AAMA,aAAKqL,eAAL,GAAuB,UAASle,EAAT,EAAa0d,OAAb,EAAsB;AACzC,cAAI/d,SAAS,CAACrN,MAAV,GAAmB,CAAvB,EAA0B,MAAM,IAAI6rB,SAAJ,CAAc,2CAAd,CAAN;;AAC1B,eAAI,IAAIvrB,CAAC,GAAG,CAAZ,EAAeA,CAAC,GAAG+M,SAAS,CAACrN,MAA7B,EAAqCM,CAAC,EAAtC,EAA0C;AACtC8qB,mBAAO,GAAG/d,SAAS,CAAC/M,CAAD,CAAnB;;AACA+U,iBAAK,CAAC3H,EAAD,EAAK,UAAU4H,GAAV,EAAe;AACrB,kBAAIA,GAAG,CAACmU,cAAJ,IAAsBnU,GAAG,CAACmU,cAAJ,CAAmBlJ,MAA7C,EAAqD;AACjD,oBAAIzf,CAAC,GAAGwU,GAAG,CAACmU,cAAZ;;AACApU,qBAAK,CAAC+V,OAAD,EAAU,UAAUrmB,CAAV,EAAa;AACxBmU,2BAAS,CAAC6Q,OAAO,CAAChlB,CAAD,CAAP,CAAWilB,OAAZ,EAAqBlpB,CAArB,CAAT;;AACAoY,2BAAS,CAACpY,CAAC,CAACyf,MAAH,EAAWxb,CAAX,CAAT;;AACA,yBAAOjE,CAAC,CAAC0f,UAAF,CAAazb,CAAb,CAAP;AACH,iBAJI,CAAL;AAKH;AACJ,aATI,CAAL;AAUH;AACJ,SAfD;AAiBA;;;;;;;AAKA,aAAK+mB,mBAAL,GAA2B,UAASpe,EAAT,EAAa;AACpC2H,eAAK,CAAC3H,EAAD,EAAK,UAAS4H,GAAT,EAAc;AACpB,gBAAIA,GAAG,CAACmU,cAAJ,IAAsBnU,GAAG,CAACmU,cAAJ,CAAmBlJ,MAA7C,EAAqD;AACjD,kBAAIzf,CAAC,GAAGwU,GAAG,CAACmU,cAAZ;;AACApU,mBAAK,CAACvU,CAAC,CAACyf,MAAH,EAAW,UAASxb,CAAT,EAAY;AACxBmU,yBAAS,CAAC6Q,OAAO,CAAChlB,CAAD,CAAP,CAAWilB,OAAZ,EAAqBlpB,CAArB,CAAT;AACH,eAFI,CAAL;;AAGAA,eAAC,CAACyf,MAAF,CAASvgB,MAAT,GAAkB,CAAlB;AACAc,eAAC,CAAC0f,UAAF,GAAe,EAAf;AACH;AACJ,WATI,CAAL;AAUH,SAXD;AAaA;;;;;;;;AAMA,aAAKuL,aAAL,GAAqB,UAASre,EAAT,EAAa0d,OAAb,EAAsBY,KAAtB,EAA6B;AAC9C,cAAIV,KAAK,GAAGvB,OAAO,CAACqB,OAAD,CAAnB;;AACA,cAAIE,KAAJ,EAAW;AACPjW,iBAAK,CAAC3H,EAAD,EAAK,UAAS4H,GAAT,EAAc;AACpB,kBAAIA,GAAG,CAACmU,cAAJ,IAAsBnU,GAAG,CAACmU,cAAJ,CAAmBlJ,MAA7C,EAAqD;AACjDjL,mBAAG,CAACmU,cAAJ,CAAmBjJ,UAAnB,CAA8B8K,KAAK,CAACC,IAApC,IAA4CS,KAA5C;AACH;AACJ,aAJI,CAAL;AAKH;AACJ,SATD;AAWH,OArfD;;AAufAztB,UAAI,CAAC0pB,SAAL,CAAere,OAAf,GAAyB,OAAzB;;AAEA,UAAI,IAAJ,EAAoC;AAChCC,eAAO,CAACoe,SAAR,GAAoB1pB,IAAI,CAAC0pB,SAAzB;AACH;AAEJ,KA12CA,EA02CEne,IA12CF,CA02CO,OAAOC,MAAP,KAAkB,WAAlB,GAAgCA,MAAhC,GAAyC,IA12ChD;AA42CD;;;;;;;;;;;AAUA,KAAC,YAAW;AAER,UAAIxL,IAAI,GAAG,IAAX;AACAA,UAAI,CAAC0tB,WAAL,GAAmB1tB,IAAI,CAAC0tB,WAAL,IAAoB,EAAvC;AACA,UAAIA,WAAW,GAAG1tB,IAAI,CAAC0tB,WAAvB;;AAEA,UAAI,IAAJ,EAAmC;AAAEpiB,eAAO,CAACoiB,WAAR,GAAsBA,WAAtB;AAAmC;AAGxE;;;;;;AAIA,eAASC,OAAT,CAAiBppB,CAAjB,EAAoB;AAChB,eAAOoH,MAAM,CAACC,SAAP,CAAiBC,QAAjB,CAA0BN,IAA1B,CAA+BhH,CAA/B,MAAsC,gBAA7C;AACH;;AACDmpB,iBAAW,CAACC,OAAZ,GAAsBA,OAAtB;AACA;;;;;AAIA,eAASC,QAAT,CAAkB/qB,CAAlB,EAAqB;AACjB,eAAO8I,MAAM,CAACC,SAAP,CAAiBC,QAAjB,CAA0BN,IAA1B,CAA+B1I,CAA/B,MAAsC,iBAA7C;AACH;;AACD6qB,iBAAW,CAACE,QAAZ,GAAuBA,QAAvB;;AACA,eAASC,QAAT,CAAkB/sB,CAAlB,EAAqB;AACjB,eAAO,OAAOA,CAAP,KAAa,QAApB;AACH;;AACD4sB,iBAAW,CAACG,QAAZ,GAAuBA,QAAvB;;AACA,eAASC,SAAT,CAAmBhtB,CAAnB,EAAsB;AAClB,eAAO,OAAOA,CAAP,KAAa,SAApB;AACH;;AACD4sB,iBAAW,CAACI,SAAZ,GAAwBA,SAAxB;;AACA,eAASC,MAAT,CAAgBjtB,CAAhB,EAAmB;AACf,eAAOA,CAAC,IAAI,IAAZ;AACH;;AACD4sB,iBAAW,CAACK,MAAZ,GAAqBA,MAArB;;AACA,eAASC,QAAT,CAAkB/C,CAAlB,EAAqB;AACjB,eAAOA,CAAC,IAAI,IAAL,GAAY,KAAZ,GAAoBtf,MAAM,CAACC,SAAP,CAAiBC,QAAjB,CAA0BN,IAA1B,CAA+B0f,CAA/B,MAAsC,iBAAjE;AACH;;AACDyC,iBAAW,CAACM,QAAZ,GAAuBA,QAAvB;;AACA,eAASC,MAAT,CAAgBhD,CAAhB,EAAmB;AACf,eAAOtf,MAAM,CAACC,SAAP,CAAiBC,QAAjB,CAA0BN,IAA1B,CAA+B0f,CAA/B,MAAsC,eAA7C;AACH;;AACDyC,iBAAW,CAACO,MAAZ,GAAqBA,MAArB;;AACA,eAASC,UAAT,CAAoBjD,CAApB,EAAuB;AACnB,eAAOtf,MAAM,CAACC,SAAP,CAAiBC,QAAjB,CAA0BN,IAA1B,CAA+B0f,CAA/B,MAAsC,mBAA7C;AACH;;AACDyC,iBAAW,CAACQ,UAAZ,GAAyBA,UAAzB;;AACA,eAASC,eAAT,CAAyBlD,CAAzB,EAA4B;AACxB,eAAOiD,UAAU,CAACjD,CAAD,CAAV,IAAiBA,CAAC,CAAC+B,IAAF,IAAU,IAA3B,IAAmC/B,CAAC,CAAC+B,IAAF,CAAOvrB,MAAP,GAAgB,CAA1D;AACH;;AACDisB,iBAAW,CAACS,eAAZ,GAA8BA,eAA9B;;AACA,eAASC,OAAT,CAAiBnD,CAAjB,EAAoB;AAChB,aAAK,IAAIlpB,CAAT,IAAckpB,CAAd,EAAiB;AACb,cAAIA,CAAC,CAAC/W,cAAF,CAAiBnS,CAAjB,CAAJ,EAAyB;AACrB,mBAAO,KAAP;AACH;AACJ;;AACD,eAAO,IAAP;AACH;;AACD2rB,iBAAW,CAACU,OAAZ,GAAsBA,OAAtB;;AACA,eAAShO,KAAT,CAAe7b,CAAf,EAAkB;AACd,YAAIspB,QAAQ,CAACtpB,CAAD,CAAZ,EAAiB;AACb,iBAAO,KAAKA,CAAZ;AACH,SAFD,MAGK,IAAIupB,SAAS,CAACvpB,CAAD,CAAb,EAAkB;AACnB,iBAAO,CAAC,CAACA,CAAT;AACH,SAFI,MAGA,IAAI0pB,MAAM,CAAC1pB,CAAD,CAAV,EAAe;AAChB,iBAAO,IAAImD,IAAJ,CAASnD,CAAC,CAACoD,OAAF,EAAT,CAAP;AACH,SAFI,MAGA,IAAIumB,UAAU,CAAC3pB,CAAD,CAAd,EAAmB;AACpB,iBAAOA,CAAP;AACH,SAFI,MAGA,IAAIopB,OAAO,CAACppB,CAAD,CAAX,EAAgB;AACjB,cAAIC,CAAC,GAAG,EAAR;;AACA,eAAK,IAAIzC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGwC,CAAC,CAAC9C,MAAtB,EAA8BM,CAAC,EAA/B,EAAmC;AAC/ByC,aAAC,CAACiC,IAAF,CAAO2Z,KAAK,CAAC7b,CAAC,CAACxC,CAAD,CAAF,CAAZ;AACH;;AACD,iBAAOyC,CAAP;AACH,SANI,MAOA,IAAIwpB,QAAQ,CAACzpB,CAAD,CAAZ,EAAiB;AAClB,cAAIjC,CAAC,GAAG,EAAR;;AACA,eAAK,IAAIc,CAAT,IAAcmB,CAAd,EAAiB;AACbjC,aAAC,CAACc,CAAD,CAAD,GAAOgd,KAAK,CAAC7b,CAAC,CAACnB,CAAD,CAAF,CAAZ;AACH;;AACD,iBAAOd,CAAP;AACH,SANI,MAOA;AACD,iBAAOiC,CAAP;AACH;AACJ;;AACDmpB,iBAAW,CAACtN,KAAZ,GAAoBA,KAApB;;AACA,eAASiO,KAAT,CAAe9pB,CAAf,EAAkBC,CAAlB,EAAqB8pB,UAArB,EAAiCC,UAAjC,EAA6C;AACzC;AACA,YAAIC,IAAI,GAAG,EAAX;AAAA,YAAeC,EAAf;AAAA,YAAmB1sB,CAAnB;AAAA,YAAsB2sB,IAAI,GAAG,EAA7B;AACAJ,kBAAU,GAAGA,UAAU,IAAI,EAA3B;AACAC,kBAAU,GAAGA,UAAU,IAAI,EAA3B;;AACA,aAAKxsB,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGusB,UAAU,CAAC7sB,MAA3B,EAAmCM,CAAC,EAApC,EAAwC;AACpCysB,cAAI,CAACF,UAAU,CAACvsB,CAAD,CAAX,CAAJ,GAAsB,IAAtB;AACH;;AACD,aAAKA,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGwsB,UAAU,CAAC9sB,MAA3B,EAAmCM,CAAC,EAApC,EAAwC;AACpC2sB,cAAI,CAACH,UAAU,CAACxsB,CAAD,CAAX,CAAJ,GAAsB,IAAtB;AACH;;AACD,YAAIO,CAAC,GAAG8d,KAAK,CAAC7b,CAAD,CAAb;;AACA,aAAKxC,CAAL,IAAUyC,CAAV,EAAa;AACT,cAAIlC,CAAC,CAACP,CAAD,CAAD,IAAQ,IAAR,IAAgB2sB,IAAI,CAAC3sB,CAAD,CAAxB,EAA6B;AACzBO,aAAC,CAACP,CAAD,CAAD,GAAOyC,CAAC,CAACzC,CAAD,CAAR;AACH,WAFD,MAGK,IAAI8rB,QAAQ,CAACrpB,CAAC,CAACzC,CAAD,CAAF,CAAR,IAAkB+rB,SAAS,CAACtpB,CAAC,CAACzC,CAAD,CAAF,CAA/B,EAAuC;AACxC,gBAAI,CAACysB,IAAI,CAACzsB,CAAD,CAAT,EAAc;AACVO,eAAC,CAACP,CAAD,CAAD,GAAOyC,CAAC,CAACzC,CAAD,CAAR,CADU,CACG;AAChB,aAFD,MAGK;AACD0sB,gBAAE,GAAG,EAAL,CADC,CAED;;AACAA,gBAAE,CAAChoB,IAAH,CAAQ2C,KAAR,CAAcqlB,EAAd,EAAkBd,OAAO,CAACrrB,CAAC,CAACP,CAAD,CAAF,CAAP,GAAgBO,CAAC,CAACP,CAAD,CAAjB,GAAuB,CAACO,CAAC,CAACP,CAAD,CAAF,CAAzC;AACA0sB,gBAAE,CAAChoB,IAAH,CAAQ2C,KAAR,CAAcqlB,EAAd,EAAkBX,SAAS,CAACtpB,CAAC,CAACzC,CAAD,CAAF,CAAT,GAAkByC,CAAC,CAACzC,CAAD,CAAnB,GAAyB,CAACyC,CAAC,CAACzC,CAAD,CAAF,CAA3C;AACAO,eAAC,CAACP,CAAD,CAAD,GAAO0sB,EAAP;AACH;AACJ,WAXI,MAYA;AACD,gBAAId,OAAO,CAACnpB,CAAC,CAACzC,CAAD,CAAF,CAAX,EAAmB;AACf0sB,gBAAE,GAAG,EAAL,CADe,CAEf;;AACA,kBAAId,OAAO,CAACrrB,CAAC,CAACP,CAAD,CAAF,CAAX,EAAmB;AACf0sB,kBAAE,CAAChoB,IAAH,CAAQ2C,KAAR,CAAcqlB,EAAd,EAAkBnsB,CAAC,CAACP,CAAD,CAAnB;AACH;;AACD0sB,gBAAE,CAAChoB,IAAH,CAAQ2C,KAAR,CAAcqlB,EAAd,EAAkBjqB,CAAC,CAACzC,CAAD,CAAnB;AACAO,eAAC,CAACP,CAAD,CAAD,GAAO0sB,EAAP;AACH,aARD,MASK,IAAIT,QAAQ,CAACxpB,CAAC,CAACzC,CAAD,CAAF,CAAZ,EAAoB;AACrB;AACA,kBAAI,CAACisB,QAAQ,CAAC1rB,CAAC,CAACP,CAAD,CAAF,CAAb,EAAqB;AACjBO,iBAAC,CAACP,CAAD,CAAD,GAAO,EAAP;AACH;;AACD,mBAAK,IAAIqB,CAAT,IAAcoB,CAAC,CAACzC,CAAD,CAAf,EAAoB;AAChBO,iBAAC,CAACP,CAAD,CAAD,CAAKqB,CAAL,IAAUoB,CAAC,CAACzC,CAAD,CAAD,CAAKqB,CAAL,CAAV;AACH;AACJ;AACJ;AACJ;;AACD,eAAOd,CAAP;AACH;;AACDorB,iBAAW,CAACW,KAAZ,GAAoBA,KAApB;;AACA,eAAS/W,OAAT,CAAiBqX,KAAjB,EAAwBve,IAAxB,EAA8BjL,KAA9B,EAAqC;AACjC,YAAIwpB,KAAK,IAAI,IAAb,EAAmB;AACf;AACH;;AACD,YAAIC,CAAC,GAAGD,KAAR;AAAA,YAAe7sB,CAAC,GAAG8sB,CAAnB;AACAxe,YAAI,CAACkH,OAAL,CAAa,WAAb,EAA0B,UAAUuX,IAAV,EAAgBC,EAAhB,EAAoB1N,GAApB,EAAyB2N,GAAzB,EAA8B;AACpD,cAAIC,KAAK,GAAGH,IAAI,CAAChK,KAAL,CAAW,4BAAX,CAAZ;AAAA,cAAsDoK,IAAI,GAAG7N,GAAG,GAAGyN,IAAI,CAACptB,MAAX,IAAqBstB,GAAG,CAACttB,MAAtF;AAAA,cAA8FytB,SAAS,GAAG,SAAZA,SAAY,GAAY;AAClH,mBAAOptB,CAAC,CAACktB,KAAK,CAAC,CAAD,CAAN,CAAD,IAAgB,YAAY;AAC/BltB,eAAC,CAACktB,KAAK,CAAC,CAAD,CAAN,CAAD,GAAc,EAAd;AACA,qBAAOltB,CAAC,CAACktB,KAAK,CAAC,CAAD,CAAN,CAAR;AACH,aAHqB,EAAtB;AAIH,WALD;;AAMA,cAAIC,IAAJ,EAAU;AACN;AACA,gBAAID,KAAJ,EAAW;AACPE,uBAAS,GAAGF,KAAK,CAAC,CAAD,CAAR,CAAT,GAAwB7pB,KAAxB;AACH,aAFD,MAGK;AACDrD,eAAC,CAAC+sB,IAAD,CAAD,GAAU1pB,KAAV;AACH;AACJ,WARD,MASK;AACD;AACA,gBAAI6pB,KAAJ,EAAW;AACP,kBAAIG,GAAG,GAAGD,SAAS,EAAnB;;AACAptB,eAAC,GAAGqtB,GAAG,CAACH,KAAK,CAAC,CAAD,CAAN,CAAH,IAAkB,YAAY;AAC9BG,mBAAG,CAACH,KAAK,CAAC,CAAD,CAAN,CAAH,GAAgB,EAAhB;AACA,uBAAOG,GAAG,CAACH,KAAK,CAAC,CAAD,CAAN,CAAV;AACH,eAHoB,EAArB;AAIH,aAND,MAOK;AACDltB,eAAC,GAAGA,CAAC,CAAC+sB,IAAD,CAAD,IAAY,YAAY;AACxB/sB,iBAAC,CAAC+sB,IAAD,CAAD,GAAU,EAAV;AACA,uBAAO/sB,CAAC,CAAC+sB,IAAD,CAAR;AACH,eAHc,EAAf;AAIH;AACJ;;AACD,iBAAO,EAAP;AACH,SAjCD;AAkCA,eAAOF,KAAP;AACH;;AACDjB,iBAAW,CAACpW,OAAZ,GAAsBA,OAAtB,CA3LQ,CA4LR;AACA;AACA;AACA;;AACA,eAAS8X,aAAT,CAAuBC,YAAvB,EAAqCC,SAArC,EAAgDtpB,GAAhD,EAAqD;AACjD,aAAK,IAAIjE,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGiE,GAAG,CAACvE,MAAxB,EAAgCM,CAAC,EAAjC,EAAqC;AACjC,cAAIkpB,CAAC,GAAGjlB,GAAG,CAACjE,CAAD,CAAH,CAAO,CAAP,EAAUiE,GAAG,CAACjE,CAAD,CAAH,CAAO,CAAP,CAAV,EAAqBqH,KAArB,CAA2BpD,GAAG,CAACjE,CAAD,CAAH,CAAO,CAAP,CAA3B,EAAsCiE,GAAG,CAACjE,CAAD,CAAH,CAAO,CAAP,CAAtC,CAAR;;AACA,cAAIkpB,CAAC,KAAKqE,SAAV,EAAqB;AACjB,mBAAOrE,CAAP;AACH;AACJ;;AACD,eAAOoE,YAAP;AACH;;AACD3B,iBAAW,CAAC0B,aAAZ,GAA4BA,aAA5B;AACA;;;;;;;;;;;;;;AAaA,eAASG,QAAT,CAAkBC,KAAlB,EAAyBC,MAAzB,EAAiCC,cAAjC,EAAiDC,oBAAjD,EAAuE;AACnE;AACA,YAAIC,QAAQ,GAAG,SAAXA,QAAW,CAAUC,UAAV,EAAsB;AACjC,cAAIzT,OAAO,GAAGyT,UAAU,CAAChL,KAAX,CAAiB,YAAjB,CAAd;;AACA,cAAIzI,OAAO,IAAI,IAAf,EAAqB;AACjB,iBAAK,IAAIra,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGqa,OAAO,CAAC3a,MAA5B,EAAoCM,CAAC,EAArC,EAAyC;AACrC,kBAAI+b,GAAG,GAAG2R,MAAM,CAACrT,OAAO,CAACra,CAAD,CAAP,CAAW+tB,SAAX,CAAqB,CAArB,EAAwB1T,OAAO,CAACra,CAAD,CAAP,CAAWN,MAAX,GAAoB,CAA5C,CAAD,CAAN,IAA0D,EAApE;;AACA,kBAAIqc,GAAG,IAAI,IAAX,EAAiB;AACb+R,0BAAU,GAAGA,UAAU,CAACvY,OAAX,CAAmB8E,OAAO,CAACra,CAAD,CAA1B,EAA+B+b,GAA/B,CAAb;AACH;AACJ;AACJ;;AACD,iBAAO+R,UAAP;AACH,SAXD,CAFmE,CAcnE;;;AACA,YAAIrf,IAAI,GAAG,SAAPA,IAAO,CAAUjO,CAAV,EAAa;AACpB,cAAIA,CAAC,IAAI,IAAT,EAAe;AACX,gBAAIsrB,QAAQ,CAACtrB,CAAD,CAAZ,EAAiB;AACb,qBAAOqtB,QAAQ,CAACrtB,CAAD,CAAf;AACH,aAFD,MAGK,IAAI2rB,UAAU,CAAC3rB,CAAD,CAAV,IAAiB,CAACotB,oBAAlB,KAA2CD,cAAc,IAAI,IAAlB,IAA0B,CAACntB,CAAC,CAACyqB,IAAF,IAAU,EAAX,EAAe1c,OAAf,CAAuBof,cAAvB,MAA2C,CAAhH,CAAJ,EAAwH;AACzH,qBAAOntB,CAAC,CAACktB,MAAD,CAAR;AACH,aAFI,MAGA,IAAI9B,OAAO,CAACprB,CAAD,CAAX,EAAgB;AACjB,kBAAI2G,CAAC,GAAG,EAAR;;AACA,mBAAK,IAAInH,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGQ,CAAC,CAACd,MAAtB,EAA8BM,CAAC,EAA/B,EAAmC;AAC/BmH,iBAAC,CAACzC,IAAF,CAAO+J,IAAI,CAACjO,CAAC,CAACR,CAAD,CAAF,CAAX;AACH;;AACD,qBAAOmH,CAAP;AACH,aANI,MAOA,IAAI8kB,QAAQ,CAACzrB,CAAD,CAAZ,EAAiB;AAClB,kBAAIzB,CAAC,GAAG,EAAR;;AACA,mBAAK,IAAIsC,CAAT,IAAcb,CAAd,EAAiB;AACbzB,iBAAC,CAACsC,CAAD,CAAD,GAAOoN,IAAI,CAACjO,CAAC,CAACa,CAAD,CAAF,CAAX;AACH;;AACD,qBAAOtC,CAAP;AACH,aANI,MAOA;AACD,qBAAOyB,CAAP;AACH;AACJ;AACJ,SA1BD;;AA2BA,eAAOiO,IAAI,CAACgf,KAAD,CAAX;AACH;;AACD9B,iBAAW,CAAC6B,QAAZ,GAAuBA,QAAvB;AACA;;;;;;;AAMA,eAASQ,gBAAT,CAA0BxrB,CAA1B,EAA6ByW,CAA7B,EAAgC;AAC5B,YAAIzW,CAAJ,EAAO;AACH,eAAK,IAAIxC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGwC,CAAC,CAAC9C,MAAtB,EAA8BM,CAAC,EAA/B,EAAmC;AAC/B,gBAAIiZ,CAAC,CAACzW,CAAC,CAACxC,CAAD,CAAF,CAAL,EAAa;AACT,qBAAOA,CAAP;AACH;AACJ;AACJ;;AACD,eAAO,CAAC,CAAR;AACH;;AACD2rB,iBAAW,CAACqC,gBAAZ,GAA+BA,gBAA/B;AACA;;;;;;;;AAOA,eAASC,kBAAT,CAA4BzrB,CAA5B,EAA+ByW,CAA/B,EAAkC;AAC9B,YAAIzE,GAAG,GAAGwZ,gBAAgB,CAACxrB,CAAD,EAAIyW,CAAJ,CAA1B;;AACA,YAAIzE,GAAG,GAAG,CAAC,CAAX,EAAc;AACVhS,WAAC,CAACoM,MAAF,CAAS4F,GAAT,EAAc,CAAd;AACH;;AACD,eAAOA,GAAG,KAAK,CAAC,CAAhB;AACH;;AACDmX,iBAAW,CAACsC,kBAAZ,GAAiCA,kBAAjC;AACA;;;;;;;;AAOA,eAASjY,MAAT,CAAgBrH,CAAhB,EAAmB/P,CAAnB,EAAsB;AAClB,YAAI4V,GAAG,GAAG7F,CAAC,CAACJ,OAAF,CAAU3P,CAAV,CAAV;;AACA,YAAI4V,GAAG,GAAG,CAAC,CAAX,EAAc;AACV7F,WAAC,CAACC,MAAF,CAAS4F,GAAT,EAAc,CAAd;AACH;;AACD,eAAOA,GAAG,KAAK,CAAC,CAAhB;AACH;;AACDmX,iBAAW,CAAC3V,MAAZ,GAAqBA,MAArB;AACA;;;;;;;AAMA,eAASkY,eAAT,CAAyBrhB,IAAzB,EAA+BG,IAA/B,EAAqCmhB,YAArC,EAAmD;AAC/C,YAAIH,gBAAgB,CAACnhB,IAAD,EAAOshB,YAAP,CAAhB,KAAyC,CAAC,CAA9C,EAAiD;AAC7CthB,cAAI,CAACnI,IAAL,CAAUsI,IAAV;AACH;AACJ;;AACD2e,iBAAW,CAACuC,eAAZ,GAA8BA,eAA9B;AACA;;;;;;;;AAOA,eAASE,SAAT,CAAmBjG,GAAnB,EAAwBrT,GAAxB,EAA6B1R,KAA7B,EAAoCirB,aAApC,EAAmD;AAC/C,YAAI1f,CAAC,GAAGwZ,GAAG,CAACrT,GAAD,CAAX;;AACA,YAAInG,CAAC,IAAI,IAAT,EAAe;AACXA,WAAC,GAAG,EAAJ;AACAwZ,aAAG,CAACrT,GAAD,CAAH,GAAWnG,CAAX;AACH;;AACDA,SAAC,CAAC0f,aAAa,GAAG,SAAH,GAAe,MAA7B,CAAD,CAAsCjrB,KAAtC;AACA,eAAOuL,CAAP;AACH;;AACDgd,iBAAW,CAACyC,SAAZ,GAAwBA,SAAxB;AACA;;;;;;;;AAOA,eAASE,OAAT,CAAiBzhB,IAAjB,EAAuBG,IAAvB,EAA6BuhB,YAA7B,EAA2C;AACvC,YAAI1hB,IAAI,CAAC0B,OAAL,CAAavB,IAAb,MAAuB,CAAC,CAA5B,EAA+B;AAC3B,cAAIuhB,YAAJ,EAAkB;AACd1hB,gBAAI,CAAC8L,OAAL,CAAa3L,IAAb;AACH,WAFD,MAGK;AACDH,gBAAI,CAACnI,IAAL,CAAUsI,IAAV;AACH;;AACD,iBAAO,IAAP;AACH;;AACD,eAAO,KAAP;AACH;;AACD2e,iBAAW,CAAC2C,OAAZ,GAAsBA,OAAtB;AACA;;;;;;;AAMA,eAASE,MAAT,CAAgBC,KAAhB,EAAuBxL,MAAvB,EAA+ByL,QAA/B,EAAyC;AACrC,YAAI1uB,CAAJ;AACAijB,cAAM,GAAG2I,OAAO,CAAC3I,MAAD,CAAP,GAAkBA,MAAlB,GAA2B,CAACA,MAAD,CAApC;;AACA,YAAI0L,eAAe,GAAG,SAAlBA,eAAkB,CAAUC,KAAV,EAAiB;AACnC,cAAIC,KAAK,GAAGD,KAAK,CAACE,SAAlB;;AACA,iBAAOD,KAAK,IAAI,IAAhB,EAAsB;AAClB,gBAAIA,KAAK,CAAChlB,SAAN,IAAmB,IAAvB,EAA6B;AACzB,mBAAK,IAAIxI,CAAT,IAAcwtB,KAAK,CAAChlB,SAApB,EAA+B;AAC3B,oBAAIglB,KAAK,CAAChlB,SAAN,CAAgBsI,cAAhB,CAA+B9Q,CAA/B,KAAqC,CAACotB,KAAK,CAAC5kB,SAAN,CAAgBsI,cAAhB,CAA+B9Q,CAA/B,CAA1C,EAA6E;AACzEotB,uBAAK,CAAC5kB,SAAN,CAAgBxI,CAAhB,IAAqBwtB,KAAK,CAAChlB,SAAN,CAAgBxI,CAAhB,CAArB;AACH;AACJ;;AACDwtB,mBAAK,GAAGA,KAAK,CAAChlB,SAAN,CAAgBilB,SAAxB;AACH,aAPD,MAQK;AACDD,mBAAK,GAAG,IAAR;AACH;AACJ;AACJ,SAfD;;AAgBA,aAAK7uB,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGijB,MAAM,CAACvjB,MAAvB,EAA+BM,CAAC,EAAhC,EAAoC;AAChC,eAAK,IAAIqB,CAAT,IAAc4hB,MAAM,CAACjjB,CAAD,CAAN,CAAU6J,SAAxB,EAAmC;AAC/B,gBAAIoZ,MAAM,CAACjjB,CAAD,CAAN,CAAU6J,SAAV,CAAoBsI,cAApB,CAAmC9Q,CAAnC,KAAyC,CAACotB,KAAK,CAAC5kB,SAAN,CAAgBsI,cAAhB,CAA+B9Q,CAA/B,CAA9C,EAAiF;AAC7EotB,mBAAK,CAAC5kB,SAAN,CAAgBxI,CAAhB,IAAqB4hB,MAAM,CAACjjB,CAAD,CAAN,CAAU6J,SAAV,CAAoBxI,CAApB,CAArB;AACH;AACJ;;AACDstB,yBAAe,CAAC1L,MAAM,CAACjjB,CAAD,CAAP,CAAf;AACH;;AACD,YAAI+uB,OAAO,GAAG,SAAVA,OAAU,CAAU9D,IAAV,EAAgB+D,OAAhB,EAAyB;AACnC,iBAAO,YAAY;AACf,iBAAKhvB,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGijB,MAAM,CAACvjB,MAAvB,EAA+BM,CAAC,EAAhC,EAAoC;AAChC,kBAAIijB,MAAM,CAACjjB,CAAD,CAAN,CAAU6J,SAAV,CAAoBohB,IAApB,CAAJ,EAA+B;AAC3BhI,sBAAM,CAACjjB,CAAD,CAAN,CAAU6J,SAAV,CAAoBohB,IAApB,EAA0B5jB,KAA1B,CAAgC,IAAhC,EAAsC0F,SAAtC;AACH;AACJ;;AACD,mBAAOiiB,OAAO,CAAC3nB,KAAR,CAAc,IAAd,EAAoB0F,SAApB,CAAP;AACH,WAPD;AAQH,SATD;;AAUA,YAAIkiB,OAAO,GAAG,SAAVA,OAAU,CAAUhrB,GAAV,EAAe;AACzB,eAAK,IAAIjD,CAAT,IAAciD,GAAd,EAAmB;AACfwqB,iBAAK,CAAC5kB,SAAN,CAAgB7I,CAAhB,IAAqB+tB,OAAO,CAAC/tB,CAAD,EAAIiD,GAAG,CAACjD,CAAD,CAAP,CAA5B;AACH;AACJ,SAJD;;AAKA,YAAI+L,SAAS,CAACrN,MAAV,GAAmB,CAAvB,EAA0B;AACtB,eAAKM,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAG+M,SAAS,CAACrN,MAA1B,EAAkCM,CAAC,EAAnC,EAAuC;AACnCivB,mBAAO,CAACliB,SAAS,CAAC/M,CAAD,CAAV,CAAP;AACH;AACJ;;AACD,eAAOyuB,KAAP;AACH;;AACD9C,iBAAW,CAAC6C,MAAZ,GAAqBA,MAArB;AACA;;;AAGI;AACA;AACA;AACA;AACA;AACA;;AACJ,UAAIU,GAAG,GAAG,EAAV;;AACA,WAAK,IAAIlvB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,GAApB,EAAyBA,CAAC,EAA1B,EAA8B;AAC1BkvB,WAAG,CAAClvB,CAAD,CAAH,GAAS,CAACA,CAAC,GAAG,EAAJ,GAAS,GAAT,GAAe,EAAhB,IAAuBA,CAAD,CAAI8J,QAAJ,CAAa,EAAb,CAA/B;AACH;;AACD,eAASgT,IAAT,GAAgB;AACZ,YAAIqS,EAAE,GAAGjxB,IAAI,CAACsX,MAAL,KAAgB,UAAhB,GAA6B,CAAtC;AACA,YAAI4Z,EAAE,GAAGlxB,IAAI,CAACsX,MAAL,KAAgB,UAAhB,GAA6B,CAAtC;AACA,YAAI6Z,EAAE,GAAGnxB,IAAI,CAACsX,MAAL,KAAgB,UAAhB,GAA6B,CAAtC;AACA,YAAI8Z,EAAE,GAAGpxB,IAAI,CAACsX,MAAL,KAAgB,UAAhB,GAA6B,CAAtC;AACA,eAAO0Z,GAAG,CAACC,EAAE,GAAG,IAAN,CAAH,GAAiBD,GAAG,CAACC,EAAE,IAAI,CAAN,GAAU,IAAX,CAApB,GAAuCD,GAAG,CAACC,EAAE,IAAI,EAAN,GAAW,IAAZ,CAA1C,GAA8DD,GAAG,CAACC,EAAE,IAAI,EAAN,GAAW,IAAZ,CAAjE,GAAqF,GAArF,GACHD,GAAG,CAACE,EAAE,GAAG,IAAN,CADA,GACcF,GAAG,CAACE,EAAE,IAAI,CAAN,GAAU,IAAX,CADjB,GACoC,GADpC,GAC0CF,GAAG,CAACE,EAAE,IAAI,EAAN,GAAW,IAAX,GAAkB,IAAnB,CAD7C,GACwEF,GAAG,CAACE,EAAE,IAAI,EAAN,GAAW,IAAZ,CAD3E,GAC+F,GAD/F,GAEHF,GAAG,CAACG,EAAE,GAAG,IAAL,GAAY,IAAb,CAFA,GAEqBH,GAAG,CAACG,EAAE,IAAI,CAAN,GAAU,IAAX,CAFxB,GAE2C,GAF3C,GAEiDH,GAAG,CAACG,EAAE,IAAI,EAAN,GAAW,IAAZ,CAFpD,GAEwEH,GAAG,CAACG,EAAE,IAAI,EAAN,GAAW,IAAZ,CAF3E,GAGHH,GAAG,CAACI,EAAE,GAAG,IAAN,CAHA,GAGcJ,GAAG,CAACI,EAAE,IAAI,CAAN,GAAU,IAAX,CAHjB,GAGoCJ,GAAG,CAACI,EAAE,IAAI,EAAN,GAAW,IAAZ,CAHvC,GAG2DJ,GAAG,CAACI,EAAE,IAAI,EAAN,GAAW,IAAZ,CAHrE;AAIH;;AACD3D,iBAAW,CAAC7O,IAAZ,GAAmBA,IAAnB;AACA;;;;;;AAKA,eAASyS,QAAT,CAAkBxwB,CAAlB,EAAqB;AACjB,YAAIA,CAAC,IAAI,IAAT,EAAe;AACX,iBAAO,IAAP;AACH;;AACD,YAAIiuB,GAAG,GAAGjuB,CAAC,CAACwW,OAAF,CAAU,QAAV,EAAoB,EAApB,CAAV;AAAA,YAAmCia,EAAE,GAAG,IAAxC;AAAA,YAA8CxvB,CAAC,GAAGgtB,GAAG,CAACttB,MAAtD;;AACA,eAAO8vB,EAAE,CAACC,IAAH,CAAQzC,GAAG,CAAC0C,MAAJ,CAAW,EAAE1vB,CAAb,CAAR,CAAP,EAAiC,CAChC;;AACD,eAAOgtB,GAAG,CAAC9mB,KAAJ,CAAU,CAAV,EAAalG,CAAC,GAAG,CAAjB,CAAP;AACH;;AACD2rB,iBAAW,CAAC4D,QAAZ,GAAuBA,QAAvB;;AACA,eAASI,IAAT,CAAcxhB,GAAd,EAAmBnE,EAAnB,EAAuB;AACnBmE,WAAG,GAAGA,GAAG,CAACzO,MAAJ,IAAc,IAAd,IAAsB,OAAOyO,GAAP,KAAe,QAArC,GAAgD,CAACA,GAAD,CAAhD,GAAwDA,GAA9D;;AACA,aAAK,IAAInO,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGmO,GAAG,CAACzO,MAAxB,EAAgCM,CAAC,EAAjC,EAAqC;AACjCgK,YAAE,CAACmE,GAAG,CAACnO,CAAD,CAAJ,CAAF;AACH;AACJ;;AACD2rB,iBAAW,CAACgE,IAAZ,GAAmBA,IAAnB;;AACA,eAASxH,GAAT,CAAaha,GAAb,EAAkBnE,EAAlB,EAAsB;AAClB,YAAIkf,CAAC,GAAG,EAAR;;AACA,aAAK,IAAIlpB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGmO,GAAG,CAACzO,MAAxB,EAAgCM,CAAC,EAAjC,EAAqC;AACjCkpB,WAAC,CAACxkB,IAAF,CAAOsF,EAAE,CAACmE,GAAG,CAACnO,CAAD,CAAJ,CAAT;AACH;;AACD,eAAOkpB,CAAP;AACH;;AACDyC,iBAAW,CAACxD,GAAZ,GAAkBA,GAAlB;;AACA,eAASyH,gBAAT,CAA0Btd,IAA1B,EAAgC6V,GAAhC,EAAqC0H,eAArC,EAAsD;AAClDA,uBAAe,GAAGA,eAAe,IAAI,QAArC;;AACA,YAAIC,IAAI,GAAG,SAAPA,IAAO,CAAU/E,EAAV,EAAc;AACrB,iBAAOA,EAAE,GAAG5C,GAAG,CAAC4C,EAAD,CAAN,GAAa,IAAtB;AACH,SAFD;;AAGA,YAAIgF,OAAO,GAAG,SAAVA,OAAU,CAAUC,GAAV,EAAe;AACzB,iBAAOA,GAAG,GAAGF,IAAI,CAACE,GAAG,CAACH,eAAD,CAAJ,CAAP,GAAgC,IAA1C;AACH,SAFD;;AAGA,YAAIphB,IAAI,GAAG,SAAPA,IAAO,CAAUwU,MAAV,EAAkB+M,GAAlB,EAAuB;AAC9B,cAAI/M,MAAM,IAAI,IAAd,EAAoB;AAChB,mBAAO+M,GAAP;AACH,WAFD,MAGK;AACD,gBAAIC,SAAS,GAAG,CAAC,QAAD,EAAW,SAAX,EAAsB,UAAtB,EAAkC,WAAlC,EAA+C,YAA/C,EAA6D,iBAA7D,EAAgF,UAAhF,EAA4F,WAA5F,CAAhB;;AACA,gBAAID,GAAG,CAACE,aAAJ,KAAsB,UAA1B,EAAsC;AAClCpjB,mBAAK,CAACjD,SAAN,CAAgBnF,IAAhB,CAAqB2C,KAArB,CAA2B4oB,SAA3B,EAAsC,CAAC,QAAD,EAAW,UAAX,CAAtC;AACH;;AACD,gBAAIE,GAAG,GAAG7D,KAAK,CAACrJ,MAAD,EAAS+M,GAAT,EAAc,EAAd,EAAkBC,SAAlB,CAAf;AACA,mBAAOxhB,IAAI,CAACshB,OAAO,CAAC9M,MAAD,CAAR,EAAkBkN,GAAlB,CAAX;AACH;AACJ,SAZD;;AAaA,YAAIC,OAAO,GAAG,SAAVA,OAAU,CAAUrwB,CAAV,EAAa;AACvB,cAAIA,CAAC,IAAI,IAAT,EAAe;AACX,mBAAO,EAAP;AACH;;AACD,cAAI,OAAOA,CAAP,KAAa,QAAjB,EAA2B;AACvB,mBAAO+vB,IAAI,CAAC/vB,CAAD,CAAX;AACH,WAFD,MAGK,IAAIA,CAAC,CAACL,MAAN,EAAc;AACf,gBAAI2wB,IAAI,GAAG,KAAX;AAAA,gBAAkBrwB,CAAC,GAAG,CAAtB;AAAA,gBAAyBwoB,GAAG,GAAG,KAAK,CAApC;;AACA,mBAAO,CAAC6H,IAAD,IAASrwB,CAAC,GAAGD,CAAC,CAACL,MAAtB,EAA8B;AAC1B8oB,iBAAG,GAAG4H,OAAO,CAACrwB,CAAC,CAACC,CAAD,CAAF,CAAb;;AACA,kBAAIwoB,GAAJ,EAAS;AACL6H,oBAAI,GAAG,IAAP;AACH,eAFD,MAGK;AACDrwB,iBAAC;AACJ;AACJ;;AACD,mBAAOwoB,GAAP;AACH;AACJ,SApBD;;AAqBA,YAAIhoB,CAAC,GAAG4vB,OAAO,CAAC9d,IAAD,CAAf;;AACA,YAAI9R,CAAJ,EAAO;AACH,iBAAOiO,IAAI,CAACshB,OAAO,CAACvvB,CAAD,CAAR,EAAaA,CAAb,CAAX;AACH,SAFD,MAGK;AACD,iBAAO,EAAP;AACH;AACJ;;AACDmrB,iBAAW,CAACiE,gBAAZ,GAA+BA,gBAA/B;AACAjE,iBAAW,CAAC2E,UAAZ,GAAyB,IAAzB;;AACA,eAASxqB,GAAT,GAAe;AACX,YAAIyqB,IAAI,GAAG,EAAX;;AACA,aAAK,IAAIC,EAAE,GAAG,CAAd,EAAiBA,EAAE,GAAGzjB,SAAS,CAACrN,MAAhC,EAAwC8wB,EAAE,EAA1C,EAA8C;AAC1CD,cAAI,CAACC,EAAD,CAAJ,GAAWzjB,SAAS,CAACyjB,EAAD,CAApB;AACH;;AACD,YAAI7E,WAAW,CAAC2E,UAAZ,IAA0B,OAAOzqB,OAAP,KAAmB,WAAjD,EAA8D;AAC1D,cAAI;AACA,gBAAI4qB,GAAG,GAAG1jB,SAAS,CAACA,SAAS,CAACrN,MAAV,GAAmB,CAApB,CAAnB;AACAmG,mBAAO,CAACC,GAAR,CAAY2qB,GAAZ;AACH,WAHD,CAIA,OAAOziB,CAAP,EAAU,CACT;AACJ;AACJ;;AACD2d,iBAAW,CAAC7lB,GAAZ,GAAkBA,GAAlB;AACA;;;;;;;;;;;;;;AAaA,eAAS4qB,IAAT,CAAcC,eAAd,EAA+BC,WAA/B,EAA4CC,iBAA5C,EAA+D;AAC3D,eAAO,YAAY;AACf,cAAI1pB,CAAC,GAAG,IAAR;;AACA,cAAI;AACA,gBAAIypB,WAAW,IAAI,IAAnB,EAAyB;AACrBzpB,eAAC,GAAGypB,WAAW,CAACvpB,KAAZ,CAAkB,IAAlB,EAAwB0F,SAAxB,CAAJ;AACH;AACJ,WAJD,CAKA,OAAOiB,CAAP,EAAU;AACNlI,eAAG,CAAC,+BAA+BkI,CAAhC,CAAH;AACH;;AACD,cAAK2iB,eAAe,IAAI,IAApB,KAA8BE,iBAAiB,IAAI,IAArB,IAA8B1pB,CAAC,KAAK0pB,iBAAlE,CAAJ,EAA2F;AACvF,gBAAI;AACA1pB,eAAC,GAAGwpB,eAAe,CAACtpB,KAAhB,CAAsB,IAAtB,EAA4B0F,SAA5B,CAAJ;AACH,aAFD,CAGA,OAAOiB,CAAP,EAAU;AACNlI,iBAAG,CAAC,+BAA+BkI,CAAhC,CAAH;AACH;AACJ;;AACD,iBAAO7G,CAAP;AACH,SAnBD;AAoBH;;AACDwkB,iBAAW,CAAC+E,IAAZ,GAAmBA,IAAnB;;AACA,UAAII,cAAc;AAAG;AAAe,kBAAY;AAC5C,iBAASA,cAAT,GAA0B;AACtB,cAAIC,KAAK,GAAG,IAAZ;;AACA,eAAKC,UAAL,GAAkB,EAAlB;AACA,eAAKC,eAAL,GAAuB,KAAvB;AACA,eAAKC,IAAL,GAAY,KAAZ,CAJsB,CAKtB;;AACA,eAAKC,aAAL,GAAqB;AAAE,qBAAS;AAAX,WAArB;AACA,eAAKC,KAAL,GAAa,EAAb;;AACA,eAAKlQ,IAAL,GAAY,UAAUnS,KAAV,EAAiBsiB,QAAjB,EAA2BhD,aAA3B,EAA0C;AAClD,gBAAI5f,IAAI,GAAG,SAAPA,IAAO,CAAUgB,GAAV,EAAe;AACtB2e,uBAAS,CAAC2C,KAAK,CAACC,UAAP,EAAmBvhB,GAAnB,EAAwB4hB,QAAxB,EAAkChD,aAAlC,CAAT;AACAgD,sBAAQ,CAACC,SAAT,GAAqBD,QAAQ,CAACC,SAAT,IAAsB,EAA3C;AACAD,sBAAQ,CAACC,SAAT,CAAmBxU,IAAI,EAAvB,IAA6BrN,GAA7B;AACH,aAJD;;AAKA,gBAAI,OAAOV,KAAP,KAAiB,QAArB,EAA+B;AAC3BN,kBAAI,CAACM,KAAD,CAAJ;AACH,aAFD,MAGK,IAAIA,KAAK,CAACrP,MAAN,IAAgB,IAApB,EAA0B;AAC3B,mBAAK,IAAIM,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG+O,KAAK,CAACrP,MAA1B,EAAkCM,CAAC,EAAnC,EAAuC;AACnCyO,oBAAI,CAACM,KAAK,CAAC/O,CAAD,CAAN,CAAJ;AACH;AACJ;;AACD,mBAAO+wB,KAAP;AACH,WAfD;;AAgBA,eAAKQ,IAAL,GAAY,UAAUxiB,KAAV,EAAiB3L,KAAjB,EAAwBoT,aAAxB,EAAuC;AAC/C,gBAAI,CAAC,KAAK0a,IAAV,EAAgB;AACZ,mBAAKA,IAAL,GAAY,IAAZ;;AACA,kBAAI,CAAC,KAAKD,eAAN,IAAyB,KAAKD,UAAL,CAAgBjiB,KAAhB,CAA7B,EAAqD;AACjD,oBAAIJ,CAAC,GAAG,KAAKqiB,UAAL,CAAgBjiB,KAAhB,EAAuBrP,MAA/B;AAAA,oBAAuCM,CAAC,GAAG,CAA3C;AAAA,oBAA8CwxB,KAAK,GAAG,KAAtD;AAAA,oBAA6DC,GAAG,GAAG,IAAnE;;AACA,oBAAI,CAAC,KAAKC,eAAN,IAAyB,KAAKA,eAAL,CAAqB3iB,KAArB,EAA4B3L,KAA5B,EAAmCoT,aAAnC,CAA7B,EAAgF;AAC5E,yBAAO,CAACgb,KAAD,IAAUxxB,CAAC,GAAG2O,CAAd,IAAmB8iB,GAAG,KAAK,KAAlC,EAAyC;AACrC;AACA;AACA,wBAAI,KAAKN,aAAL,CAAmBpiB,KAAnB,CAAJ,EAA+B;AAC3B,2BAAKiiB,UAAL,CAAgBjiB,KAAhB,EAAuB/O,CAAvB,EAA0BqH,KAA1B,CAAgC,IAAhC,EAAsC,CAACjE,KAAD,EAAQoT,aAAR,CAAtC;AACH,qBAFD,MAGK;AACD,0BAAI;AACAib,2BAAG,GAAG,KAAKT,UAAL,CAAgBjiB,KAAhB,EAAuB/O,CAAvB,EAA0BqH,KAA1B,CAAgC,IAAhC,EAAsC,CAACjE,KAAD,EAAQoT,aAAR,CAAtC,CAAN;AACH,uBAFD,CAGA,OAAOxI,CAAP,EAAU;AACNlI,2BAAG,CAAC,oCAAoCiJ,KAApC,GAA4C,KAA5C,GAAoDf,CAArD,CAAH;AACH;AACJ;;AACDhO,qBAAC;;AACD,wBAAI,KAAKgxB,UAAL,IAAmB,IAAnB,IAA2B,KAAKA,UAAL,CAAgBjiB,KAAhB,KAA0B,IAAzD,EAA+D;AAC3DyiB,2BAAK,GAAG,IAAR;AACH;AACJ;AACJ;AACJ;;AACD,mBAAKN,IAAL,GAAY,KAAZ;;AACA,mBAAKS,MAAL;AACH,aA5BD,MA6BK;AACD,mBAAKP,KAAL,CAAWzY,OAAX,CAAmB5L,SAAnB;AACH;;AACD,mBAAO,IAAP;AACH,WAlCD;;AAmCA,eAAK4kB,MAAL,GAAc,YAAY;AACtB,gBAAI7wB,CAAC,GAAGiwB,KAAK,CAACK,KAAN,CAAYQ,GAAZ,EAAR;;AACA,gBAAI9wB,CAAJ,EAAO;AACHiwB,mBAAK,CAACQ,IAAN,CAAWlqB,KAAX,CAAiB0pB,KAAjB,EAAwBjwB,CAAxB;AACH;AACJ,WALD;;AAMA,eAAKmjB,MAAL,GAAc,UAAU4N,eAAV,EAA2BR,QAA3B,EAAqC;AAC/C,gBAAItkB,SAAS,CAACrN,MAAV,KAAqB,CAAzB,EAA4B;AACxB,mBAAKsxB,UAAL,GAAkB,EAAlB;AACH,aAFD,MAGK,IAAIjkB,SAAS,CAACrN,MAAV,KAAqB,CAAzB,EAA4B;AAC7B,kBAAI,OAAOmyB,eAAP,KAA2B,QAA/B,EAAyC;AACrC,uBAAO,KAAKb,UAAL,CAAgBa,eAAhB,CAAP;AACH,eAFD,MAGK,IAAIA,eAAe,CAACP,SAApB,EAA+B;AAChC,oBAAI7hB,GAAG,GAAG,KAAK,CAAf;;AACA,qBAAK,IAAIzP,CAAT,IAAc6xB,eAAe,CAACP,SAA9B,EAAyC;AACrC7hB,qBAAG,GAAGoiB,eAAe,CAACP,SAAhB,CAA0BtxB,CAA1B,CAAN;AACAgW,wBAAM,CAAC,KAAKgb,UAAL,CAAgBvhB,GAAhB,KAAwB,EAAzB,EAA6BoiB,eAA7B,CAAN;AACH;AACJ;AACJ,aAXI,MAYA,IAAI9kB,SAAS,CAACrN,MAAV,KAAqB,CAAzB,EAA4B;AAC7BsW,oBAAM,CAAC,KAAKgb,UAAL,CAAgBa,eAAhB,KAAoC,EAArC,EAAyCR,QAAzC,CAAN;AACH;;AACD,mBAAO,IAAP;AACH,WApBD;;AAqBA,eAAKS,WAAL,GAAmB,UAAUC,QAAV,EAAoB;AACnC,mBAAOhB,KAAK,CAACC,UAAN,CAAiBe,QAAjB,CAAP;AACH,WAFD;;AAGA,eAAKC,gBAAL,GAAwB,UAAUjW,GAAV,EAAe;AACnCgV,iBAAK,CAACE,eAAN,GAAwBlV,GAAxB;AACH,WAFD;;AAGA,eAAKkW,eAAL,GAAuB,YAAY;AAC/B,mBAAOlB,KAAK,CAACE,eAAb;AACH,WAFD;;AAGA,eAAKiB,QAAL,GAAgB,UAAUloB,EAAV,EAAc;AAC1B+mB,iBAAK,CAACiB,gBAAN,CAAuB,IAAvB;;AACA,gBAAI;AACAhoB,gBAAE;AACL,aAFD,CAGA,OAAOgE,CAAP,EAAU;AACNlI,iBAAG,CAAC,oCAAoCkI,CAArC,CAAH;AACH;;AACD+iB,iBAAK,CAACiB,gBAAN,CAAuB,KAAvB;AACH,WATD;;AAUA,eAAKG,gBAAL,GAAwB,YAAY;AAChC,iBAAK,IAAInyB,CAAT,IAAc+wB,KAAK,CAACC,UAApB,EAAgC;AAC5BD,mBAAK,CAACC,UAAN,CAAiBhxB,CAAjB,IAAsB,IAAtB;AACH;AACJ,WAJD;AAKH;;AACD,eAAO8wB,cAAP;AACH,OAjHmC,EAApC;;AAkHAnF,iBAAW,CAACmF,cAAZ,GAA6BA,cAA7B;AAEH,KA7qBD,EA6qBGtnB,IA7qBH,CA6qBQ,OAAOC,MAAP,KAAkB,WAAlB,GAAgCA,MAAhC,GAAyC,IA7qBjD;AA+qBA;;;;;;;;;;;AAUC;AAAC,KAAC,YAAW;AAEZ;;AAEC,UAAIxL,IAAI,GAAG,IAAX;;AAECA,UAAI,CAAC0tB,WAAL,CAAiBxe,eAAjB,GAAmC,UAASC,EAAT,EAAaC,QAAb,EAAuBC,GAAvB,EAA4B;AAC5DA,WAAG,GAAGA,GAAG,IAAIF,EAAE,CAACG,UAAhB;AACA,YAAIC,SAAS,GAAGF,GAAG,CAACG,gBAAJ,CAAqBJ,QAArB,CAAhB;;AACA,aAAK,IAAIrN,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGwN,SAAS,CAAC9N,MAA9B,EAAsCM,CAAC,EAAvC,EAA2C;AACvC,cAAIwN,SAAS,CAACxN,CAAD,CAAT,KAAiBoN,EAArB,EAAyB;AACrB,mBAAO,IAAP;AACH;AACJ;;AACD,eAAO,KAAP;AACH,OATA;;AAWAnP,UAAI,CAAC0tB,WAAL,CAAiB1T,OAAjB,GAA2B,UAASjK,CAAT,EAAYkK,mBAAZ,EAAiC;AACzD,YAAIlK,CAAC,CAACmK,eAAN,EAAuB;AACnBnK,WAAC,CAACmK,eAAF;AACH,SAFD,MAGK;AACDnK,WAAC,CAACoK,WAAF,GAAgB,KAAhB;AACH;;AAED,YAAI,CAACF,mBAAD,IAAwBlK,CAAC,CAACqK,cAA9B,EAA6C;AACzCrK,WAAC,CAACqK,cAAF;AACH;AACJ,OAXA;AAaD;;;;;;;;;;;;;;AAYCpa,UAAI,CAAC0tB,WAAL,CAAiByG,WAAjB,GAA+B,UAAShlB,EAAT,EAAahP,CAAb,EAAgBK,CAAhB,EAAmBc,CAAnB,EAAsBmI,CAAtB,EAAyB;AACrD,YAAI0F,EAAJ,EAAQ;AACJA,YAAE,CAAC2V,KAAH,CAASsP,MAAT,GAAkB3qB,CAAC,GAAG,IAAtB;AACA0F,YAAE,CAACilB,MAAH,GAAY3qB,CAAZ;AACA0F,YAAE,CAAC2V,KAAH,CAASuP,KAAT,GAAiB/yB,CAAC,GAAG,IAArB;AACA6N,YAAE,CAACklB,KAAH,GAAW/yB,CAAX;AACA6N,YAAE,CAAC2V,KAAH,CAASxhB,IAAT,GAAgBnD,CAAC,GAAG,IAApB;AACAgP,YAAE,CAAC2V,KAAH,CAAS1N,GAAT,GAAe5W,CAAC,GAAG,IAAnB;AACH;AACJ,OATA;AAWF,KArDA,EAqDE+K,IArDF,CAqDO,OAAOC,MAAP,KAAkB,WAAlB,GAAgCA,MAAhC,GAAyC,IArDhD;AAuDF;;;;;;;;;;;AAUA;AAAC,KAAC,YAAW;AAET,UAAI8oB,eAAe,GAAG;AAClBC,oBAAY,EAAC,sBAASC,IAAT,EAAexlB,KAAf,EAAsBylB,EAAtB,EAA0BC,IAA1B,EAAgC;AACzC,iBAAO;AACHtd,eAAG,EAAC,CAAC,UAAD,EAAa,SAAb,CADD;AAEHud,kBAAM,EAAC,CAAC,aAAD,EAAgB,YAAhB;AAFJ,YAGLH,IAHK,EAGCxlB,KAHD,CAAP;AAIH;AANiB,OAAtB;AASA,UAAIhP,IAAI,GAAG,IAAX;;AAEA,UAAI40B,WAAW,GAAG,SAAdA,WAAc,CAASC,eAAT,EAA0Bpd,MAA1B,EAAkC;AAEhD,aAAKqd,KAAL,GAAa,CAAb;AACA,aAAKC,QAAL,GAAgBF,eAAhB;AACA,aAAKG,KAAL,GAAa,EAAb;AACA,aAAKC,OAAL,GAAexd,MAAM,IAAI,EAAzB;;AAEA,aAAKsd,QAAL,CAAcG,OAAd,GAAwB,UAAS/lB,EAAT,EAAa8lB,OAAb,EAAsB;AAC1C,iBAAO,KAAKE,WAAL,CAAiBD,OAAjB,CAAyB/lB,EAAzB,EAA6B8lB,OAA7B,CAAP;AACH,SAFD;;AAIA,aAAKF,QAAL,CAAcK,UAAd,GAA2B,UAASjmB,EAAT,EAAa;AACpC,eAAKgmB,WAAL,CAAiBC,UAAjB,CAA4BjmB,EAA5B;AACH,SAFD;;AAIA,aAAK4lB,QAAL,CAAc9R,IAAd,CAAmB,eAAnB,EAAoC,UAASzc,CAAT,EAAY;AAE5C;AACA,cAAI6uB,eAAe,GAAG,KAAKN,QAAL,CAAcO,WAAd,CAA0B9uB,CAAC,CAAC2I,EAA5B,EAAgC,uBAAhC,CAAtB;;AACA,eAAK,IAAIpN,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGszB,eAAe,CAAC5zB,MAApC,EAA4CM,CAAC,EAA7C,EAAiD;AAC7C,iBAAKmzB,OAAL,CAAaG,eAAe,CAACtzB,CAAD,CAA5B;AACH;AAEJ,SARmC,CAQlCkhB,IARkC,CAQ7B,IAR6B,CAApC;AAUA,aAAK8R,QAAL,CAAc9R,IAAd,CAAmB,iBAAnB,EAAsC,UAASzc,CAAT,EAAY;AAC9C,eAAK4uB,UAAL,CAAgB5uB,CAAC,CAAC2I,EAAlB;AACH,SAFD;AAKA,aAAK4lB,QAAL,CAAc9R,IAAd,CAAmB,YAAnB,EAAiC,UAAS3gB,CAAT,EAAYkP,GAAZ,EAAiB;AAC9C,cAAIA,GAAG,IAAI,IAAX,EAAiB;AACb;AACA;AACA,iBAAK+jB,sBAAL,CAA4BjzB,CAAC,CAACkzB,MAA9B;;AACA,iBAAKD,sBAAL,CAA4BjzB,CAAC,CAAC2L,MAA9B;AACH;AACJ,SAPgC,CAO/BgV,IAP+B,CAO1B,IAP0B,CAAjC;AAQH,OAtCD;;AAwCAjjB,UAAI,CAACy1B,kBAAL,GAA0Bb,WAA1B;AAEAA,iBAAW,CAAChpB,SAAZ,GAAwB;AAEpBspB,eAAO,EAAG,iBAAS/lB,EAAT,EAAa8lB,OAAb,EAAsB;AAC5B,cAAIS,EAAE,GAAG,KAAKX,QAAL,CAAcxE,MAAd,CAAqB,EAArB,EAAyB+D,eAAzB,CAAT;AACA,eAAKS,QAAL,CAAcxE,MAAd,CAAqBmF,EAArB,EAAyB,KAAKT,OAA9B;AACAA,iBAAO,GAAG,KAAKF,QAAL,CAAcxE,MAAd,CAAqBmF,EAArB,EAA0BT,OAAO,IAAI,EAArC,CAAV;AACA,cAAInI,EAAE,GAAG,CAAC,KAAKiI,QAAL,CAAcY,gBAAd,EAAD,EAAmC,KAAKb,KAAL,EAAnC,EAAiDc,IAAjD,CAAsD,GAAtD,CAAT;AACA,eAAKZ,KAAL,CAAWlI,EAAX,IAAiB,IAAI+I,IAAJ,CAAS,KAAKd,QAAd,EAAwB5lB,EAAxB,EAA4B8lB,OAA5B,EAAqCnI,EAArC,CAAjB;AACH,SARmB;AAUpBsI,kBAAU,EAAC,oBAASjmB,EAAT,EAAa;AACpB,cAAIP,IAAI,GAAG,KAAKomB,KAAL,CAAW7lB,EAAE,CAAC2mB,YAAd,CAAX;;AACA,cAAIlnB,IAAJ,EAAU;AACNA,gBAAI,CAACoa,OAAL;AACA,mBAAO,KAAKgM,KAAL,CAAW7lB,EAAE,CAAC2mB,YAAd,CAAP;AACH;AACJ,SAhBmB;AAkBpBP,8BAAsB,EAAC,gCAAUpmB,EAAV,EAAc;AACjC,cAAI6V,MAAM,GAAG7V,EAAE,CAACG,UAAhB;AAAA,cAA4BymB,SAAS,GAAG,KAAKhB,QAAL,CAAciB,YAAd,EAAxC;;AACA,iBAAMhR,MAAM,IAAI,IAAV,IAAkBA,MAAM,KAAK+Q,SAAnC,EAA8C;AAC1C,gBAAI/Q,MAAM,CAAC8Q,YAAP,IAAuB,IAAvB,IAA+B,KAAKd,KAAL,CAAWhQ,MAAM,CAAC8Q,YAAlB,KAAmC,IAAtE,EAA4E;AACxE9Q,oBAAM,CAACiR,qBAAP;;AACA;AACH;;AACDjR,kBAAM,GAAGA,MAAM,CAAC1V,UAAhB;AACH;AACJ;AA3BmB,OAAxB;;AAgCA,UAAIumB,IAAI,GAAG,SAAPA,IAAO,CAASd,QAAT,EAAmB5lB,EAAnB,EAAuB8lB,OAAvB,EAAgCnI,EAAhC,EAAoC;AAE3C3d,UAAE,CAAC,cAAD,CAAF,GAAqB2d,EAArB,CAF2C,CAI3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,iBAASyH,YAAT,CAAsBC,IAAtB,EAA4BxlB,KAA5B,EAAmCylB,EAAnC,EAAuCC,IAAvC,EAA6C;AACzC,iBAAOO,OAAO,CAACiB,MAAR,GAAiBjB,OAAO,CAACiB,MAAzB,GAAkCjB,OAAO,CAACV,YAAR,CAAqBC,IAArB,EAA2BxlB,KAA3B,EAAkCylB,EAAlC,EAAsCC,IAAtC,CAAzC;AACH,SAhB0C,CAkB3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA,iBAASyB,cAAT,CAAwB3B,IAAxB,EAA8BxlB,KAA9B,EAAqCylB,EAArC,EAAyCC,IAAzC,EAA+C;AAC3C,iBAAOO,OAAO,CAACkB,cAAR,GAAyBlB,OAAO,CAACkB,cAAR,CAAuB3B,IAAvB,EAA6BxlB,KAA7B,EAAoCylB,EAApC,EAAwCC,IAAxC,CAAzB,GAAyEO,OAAO,CAACmB,QAAR,GAAmBnB,OAAO,CAACmB,QAA3B,GAAsC3B,EAAE,CAACpgB,IAAzH;AACH,SA7B0C,CA+B3C;AACA;AACA;AACA;;;AACA,iBAASgiB,qBAAT,CAA+BlnB,EAA/B,EAAmC;AAC/B,cAAI6V,MAAM,GAAG7V,EAAE,CAACG,UAAhB;AAAA,cAA4BymB,SAAS,GAAGhB,QAAQ,CAACiB,YAAT,EAAxC;;AACA,iBAAMhR,MAAM,IAAI,IAAV,IAAkBA,MAAM,KAAK+Q,SAAnC,EAA8C;AAC1C,gBAAIhB,QAAQ,CAACuB,QAAT,CAAkBtR,MAAlB,EAA0B,aAA1B,CAAJ,EAA8C;AAC1C+P,sBAAQ,CAACwB,kBAAT,CAA4BvR,MAA5B;AACA;AACH;;AACDA,kBAAM,GAAGA,MAAM,CAAC1V,UAAhB;AACH;AACJ;;AAED,YAAIknB,aAAa,GAAG,SAAhBA,aAAgB,CAASzmB,CAAT,EAAY;AAE5B,cAAIwB,QAAQ,GAAGwjB,QAAQ,CAACO,WAAT,CAAqBnmB,EAArB,EAAyB,cAAzB,CAAf;AACA,cAAIsnB,IAAI,GAAG1B,QAAQ,CAAC2B,KAAT,CAAevnB,EAAf,CAAX;;AAEA,eAAK,IAAIpN,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGwP,QAAQ,CAAC9P,MAA7B,EAAqCM,CAAC,EAAtC,EAA0C;AAEtC,gBAAIwP,QAAQ,CAACxP,CAAD,CAAR,CAAYmmB,SAAZ,GAAwB/Y,EAAE,CAACiH,SAA/B,EAA0C;AACtC,kBAAI,CAAC7E,QAAQ,CAACxP,CAAD,CAAR,CAAY40B,eAAjB,EAAkC;AAC9BplB,wBAAQ,CAACxP,CAAD,CAAR,CAAY40B,eAAZ,GAA8BplB,QAAQ,CAACxP,CAAD,CAAR,CAAY40B,eAAZ,IAA+B,EAA7D;AACA5B,wBAAQ,CAAC3J,MAAT,CAAgB;AAACoK,wBAAM,EAAEjkB,QAAQ,CAACxP,CAAD;AAAjB,iBAAhB,EAAuC2vB,IAAvC,CAA4C,UAAUpvB,CAAV,EAAa;AAGrDyyB,0BAAQ,CAAC6B,eAAT,CAAyBt0B,CAAzB,EAA4B,CAA5B,EAA+B6M,EAA/B,EAAmCsnB,IAAnC,EAAyC,YAAY;AACjD,2BAAON,cAAc,CAAC,KAAD,EAAQ,CAAR,EAAW7zB,CAAC,CAACu0B,SAAF,CAAY,CAAZ,CAAX,EAA2Bv0B,CAA3B,CAArB;AACH,mBAFD,EAEG,YAAY;AACX,2BAAOiyB,YAAY,CAAC,KAAD,EAAQ,CAAR,EAAWjyB,CAAC,CAACu0B,SAAF,CAAY,CAAZ,CAAX,EAA2Bv0B,CAA3B,CAAnB;AACH,mBAJD;;AAKAiP,0BAAQ,CAACxP,CAAD,CAAR,CAAY40B,eAAZ,CAA4BlwB,IAA5B,CAAiC,CAACnE,CAAD,EAAI,CAAJ,CAAjC;AACH,iBATD;AAWAyyB,wBAAQ,CAAC3J,MAAT,CAAgB;AAACnd,wBAAM,EAAEsD,QAAQ,CAACxP,CAAD;AAAjB,iBAAhB,EAAuC2vB,IAAvC,CAA4C,UAAUpvB,CAAV,EAAa;AACrDyyB,0BAAQ,CAAC6B,eAAT,CAAyBt0B,CAAzB,EAA4B,CAA5B,EAA+B6M,EAA/B,EAAmCsnB,IAAnC,EAAyC,YAAY;AACjD,2BAAON,cAAc,CAAC,KAAD,EAAQ,CAAR,EAAW7zB,CAAC,CAACu0B,SAAF,CAAY,CAAZ,CAAX,EAA2Bv0B,CAA3B,CAArB;AACH,mBAFD,EAEG,YAAY;AACX,2BAAOiyB,YAAY,CAAC,KAAD,EAAQ,CAAR,EAAWjyB,CAAC,CAACu0B,SAAF,CAAY,CAAZ,CAAX,EAA2Bv0B,CAA3B,CAAnB;AACH,mBAJD;;AAKAiP,0BAAQ,CAACxP,CAAD,CAAR,CAAY40B,eAAZ,CAA4BlwB,IAA5B,CAAiC,CAACnE,CAAD,EAAI,CAAJ,CAAjC;AACH,iBAPD;AAQH;AACJ,aAvBD,CAwBA;AAxBA,iBAyBK,IAAIiP,QAAQ,CAACxP,CAAD,CAAR,CAAYmmB,SAAZ,GAAwB3W,QAAQ,CAACxP,CAAD,CAAR,CAAY+0B,YAApC,GAAmD3nB,EAAE,CAACiH,SAAH,GAAejH,EAAE,CAAC2nB,YAAzE,EAAuF;AACxF,oBAAI,CAACvlB,QAAQ,CAACxP,CAAD,CAAR,CAAY40B,eAAjB,EAAkC;AAC9BplB,0BAAQ,CAACxP,CAAD,CAAR,CAAY40B,eAAZ,GAA8BplB,QAAQ,CAACxP,CAAD,CAAR,CAAY40B,eAAZ,IAA+B,EAA7D;AAEA5B,0BAAQ,CAAC3J,MAAT,CAAgB;AAACoK,0BAAM,EAAEjkB,QAAQ,CAACxP,CAAD;AAAjB,mBAAhB,EAAuC2vB,IAAvC,CAA4C,UAAUpvB,CAAV,EAAa;AACrDyyB,4BAAQ,CAAC6B,eAAT,CAAyBt0B,CAAzB,EAA4B,CAA5B,EAA+B6M,EAA/B,EAAmCsnB,IAAnC,EAAyC,YAAY;AACjD,6BAAON,cAAc,CAAC,QAAD,EAAW,CAAX,EAAc7zB,CAAC,CAACu0B,SAAF,CAAY,CAAZ,CAAd,EAA8Bv0B,CAA9B,CAArB;AACH,qBAFD,EAEG,YAAY;AACX,6BAAOiyB,YAAY,CAAC,QAAD,EAAW,CAAX,EAAcjyB,CAAC,CAACu0B,SAAF,CAAY,CAAZ,CAAd,EAA8Bv0B,CAA9B,CAAnB;AACH,qBAJD;;AAKAiP,4BAAQ,CAACxP,CAAD,CAAR,CAAY40B,eAAZ,CAA4BlwB,IAA5B,CAAiC,CAACnE,CAAD,EAAI,CAAJ,CAAjC;AACH,mBAPD;AASAyyB,0BAAQ,CAAC3J,MAAT,CAAgB;AAACnd,0BAAM,EAAEsD,QAAQ,CAACxP,CAAD;AAAjB,mBAAhB,EAAuC2vB,IAAvC,CAA4C,UAAUpvB,CAAV,EAAa;AACrDyyB,4BAAQ,CAAC6B,eAAT,CAAyBt0B,CAAzB,EAA4B,CAA5B,EAA+B6M,EAA/B,EAAmCsnB,IAAnC,EAAyC,YAAY;AACjD,6BAAON,cAAc,CAAC,QAAD,EAAW,CAAX,EAAc7zB,CAAC,CAACu0B,SAAF,CAAY,CAAZ,CAAd,EAA8Bv0B,CAA9B,CAArB;AACH,qBAFD,EAEG,YAAY;AACX,6BAAOiyB,YAAY,CAAC,QAAD,EAAW,CAAX,EAAcjyB,CAAC,CAACu0B,SAAF,CAAY,CAAZ,CAAd,EAA8Bv0B,CAA9B,CAAnB;AACH,qBAJD;;AAKAiP,4BAAQ,CAACxP,CAAD,CAAR,CAAY40B,eAAZ,CAA4BlwB,IAA5B,CAAiC,CAACnE,CAAD,EAAI,CAAJ,CAAjC;AACH,mBAPD;AAQH;AACJ,eAtBI,MAsBE,IAAIiP,QAAQ,CAACxP,CAAD,CAAR,CAAY40B,eAAhB,EAAiC;AACpC,qBAAK,IAAIvzB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGmO,QAAQ,CAACxP,CAAD,CAAR,CAAY40B,eAAZ,CAA4Bl1B,MAAhD,EAAwD2B,CAAC,EAAzD,EAA6D;AACzD2xB,0BAAQ,CAACgC,iBAAT,CAA2BxlB,QAAQ,CAACxP,CAAD,CAAR,CAAY40B,eAAZ,CAA4BvzB,CAA5B,EAA+B,CAA/B,CAA3B,EAA8DmO,QAAQ,CAACxP,CAAD,CAAR,CAAY40B,eAAZ,CAA4BvzB,CAA5B,EAA+B,CAA/B,CAA9D,EAAiGqzB,IAAjG;AACH;;AAED,uBAAOllB,QAAQ,CAACxP,CAAD,CAAR,CAAY40B,eAAnB;AACH;;AAED5B,oBAAQ,CAACiC,UAAT,CAAoBzlB,QAAQ,CAACxP,CAAD,CAA5B;AACH;;AAEDs0B,+BAAqB,CAAClnB,EAAD,CAArB;AACH,SAlED;;AAoEA4lB,gBAAQ,CAAC3iB,YAAT,CAAsBjD,EAAtB,EAA0B,qBAA1B,EAAiD,MAAjD;AACAA,UAAE,CAAC8mB,qBAAH,GAA2BO,aAA3B;AACAzB,gBAAQ,CAAC9c,EAAT,CAAY9I,EAAZ,EAAgB,QAAhB,EAA0BqnB,aAA1B;AACAA,qBAAa,GArH8B,CAqH1B;;AAEjB,aAAKxN,OAAL,GAAe,YAAW;AACtB+L,kBAAQ,CAAC1c,GAAT,CAAalJ,EAAb,EAAiB,QAAjB,EAA2BqnB,aAA3B;AACA,iBAAOrnB,EAAE,CAAC8mB,qBAAV;AAEA,cAAI1kB,QAAQ,GAAGwjB,QAAQ,CAACO,WAAT,CAAqBnmB,EAArB,EAAyB,cAAzB,CAAf;AACA,cAAIsnB,IAAI,GAAG1B,QAAQ,CAAC2B,KAAT,CAAevnB,EAAf,CAAX;;AAEA,eAAK,IAAIpN,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGwP,QAAQ,CAAC9P,MAA7B,EAAqCM,CAAC,EAAtC,EAA0C;AACtC,gBAAIwP,QAAQ,CAACxP,CAAD,CAAR,CAAY40B,eAAhB,EAAiC;AAC7B,mBAAK,IAAIvzB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGmO,QAAQ,CAACxP,CAAD,CAAR,CAAY40B,eAAZ,CAA4Bl1B,MAAhD,EAAwD2B,CAAC,EAAzD,EAA6D;AACzD2xB,wBAAQ,CAACgC,iBAAT,CAA2BxlB,QAAQ,CAACxP,CAAD,CAAR,CAAY40B,eAAZ,CAA4BvzB,CAA5B,EAA+B,CAA/B,CAA3B,EAA8DmO,QAAQ,CAACxP,CAAD,CAAR,CAAY40B,eAAZ,CAA4BvzB,CAA5B,EAA+B,CAA/B,CAA9D,EAAiGqzB,IAAjG;AACH;;AAED,qBAAOllB,QAAQ,CAACxP,CAAD,CAAR,CAAY40B,eAAnB;AACH;AACJ;AACJ,SAhBD;AAiBH,OAxID;AA2IH,KAlOA,EAkOEprB,IAlOF,CAkOO,OAAOC,MAAP,KAAkB,WAAlB,GAAgCA,MAAhC,GAAyC,IAlOhD;AAoOD;;;;;;;;;;;AAUA;AAAC,KAAC,YAAY;AAEV;;AAEA,UAAIxL,IAAI,GAAG,IAAX;;AAEA,UAAIi3B,GAAG,GAAGj3B,IAAI,CAAC0tB,WAAf;;AAEI;;;AAGAwJ,gBAAU,GAAG,SAAbA,UAAa,GAAY;AACrB,eAAO,KAAM,IAAIxvB,IAAJ,EAAD,CAAaC,OAAb,EAAZ;AACH,OAPL;AAAA,UASI;AACA;AACA;AACAwvB,uBAAiB,GAAG,SAApBA,iBAAoB,CAAUC,SAAV,EAAqB;AACrC,YAAIA,SAAS,CAACC,QAAV,CAAmBC,UAAnB,IAAiCF,SAAS,CAACC,QAAV,CAAmBE,eAAxD,EAAyE;AACrE,cAAIC,gBAAgB,GAAG,EAAvB;AACAC,iBAAO,CAAClH,MAAR,CAAeiH,gBAAf,EAAiCJ,SAAS,CAACC,QAAV,CAAmBC,UAApD;AACAG,iBAAO,CAAClH,MAAR,CAAeiH,gBAAf,EAAiCJ,SAAS,CAACC,QAAV,CAAmBE,eAApD;AACA,iBAAOH,SAAS,CAACC,QAAV,CAAmBE,eAA1B,CAJqE,CAKrE;;AACA,cAAIC,gBAAgB,CAACvrB,QAAjB,IAA6BmrB,SAAS,CAACC,QAAV,CAAmBC,UAAnB,CAA8BI,IAA/D,EAAqE;AACjE,mBAAOF,gBAAgB,CAACvrB,QAAxB;AACH;;AACDmrB,mBAAS,CAACC,QAAV,CAAmBE,eAAnB,GAAqCC,gBAArC;AACH;AACJ,OAxBL;AAAA,UAyBI7Q,MAAM,GAAG,CAAC,KAAD,EAAQ,QAAR,EAAkB,OAAlB,EAA2B,UAA3B,EAAuC,WAAvC,EAAoD,UAApD,EAAgE,WAAhE,EAA6E,WAA7E,EAA0F,SAA1F,EAAqG,aAArG,CAzBb;AAAA,UA0BIgR,YAAY,GAAG;AAAE,oBAAY,YAAd;AAA4B,qBAAa;AAAzC,OA1BnB;AAAA,UA2BIC,uBAAuB,GAAG,SAA1BA,uBAA0B,CAAUR,SAAV,EAAqB3J,KAArB,EAA4BoK,SAA5B,EAAuCC,aAAvC,EAAsD;AAC5E,YAAIC,gBAAgB,GAAGX,SAAS,CAACY,mBAAV,EAAvB;;AACA,YAAID,gBAAJ,EAAsB;AAClB,eAAK,IAAIh2B,CAAC,GAAG,CAAR,EAAWqB,CAAC,GAAG20B,gBAAgB,CAACt2B,MAArC,EAA6CM,CAAC,GAAGqB,CAAjD,EAAoDrB,CAAC,EAArD,EAAyD;AACrD,gBAAI,CAAC+1B,aAAD,IAAkBA,aAAa,KAAKC,gBAAgB,CAACh2B,CAAD,CAAxD,EAA6D;AACzDg2B,8BAAgB,CAACh2B,CAAD,CAAhB,CAAoBmc,QAApB,CAA6BuP,KAA7B,EAAoC,IAApC,EAA0CoK,SAA1C,EADyD,CACD;AAC3D;AACJ;AACJ;AACJ,OApCL;AAAA,UAqCII,UAAU,GAAG,SAAbA,UAAa,CAAUn2B,CAAV,EAAa;AACtB,eAAOA,CAAC,IAAI,IAAL,GAAY,IAAZ,GAAmBA,CAAC,CAAC2P,KAAF,CAAQ,GAAR,CAA1B;AACH,OAvCL;AAAA,UAwCIymB,QAAQ,GAAG,SAAXA,QAAW,CAAShO,GAAT,EAAcha,GAAd,EAAmBioB,MAAnB,EAA2B;AAClC,aAAK,IAAIp2B,CAAT,IAAcmO,GAAd,EAAmB;AACfga,aAAG,CAACnoB,CAAD,CAAH,GAASo2B,MAAT;AACH;AACJ,OA5CL;AAAA,UA6CIrhB,KAAK,GAAG,SAARA,KAAQ,CAAS/K,EAAT,EAAamE,GAAb,EAAkB;AACtBA,WAAG,GAAG+mB,GAAG,CAACtJ,OAAJ,CAAYzd,GAAZ,KAAqBA,GAAG,CAACzO,MAAJ,IAAc,IAAd,IAAsB,CAACw1B,GAAG,CAACpJ,QAAJ,CAAa3d,GAAb,CAA5C,GAAiEA,GAAjE,GAAuE,CAAEA,GAAF,CAA7E;;AACA,aAAK,IAAInO,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGmO,GAAG,CAACzO,MAAxB,EAAgCM,CAAC,EAAjC,EAAqC;AACjC,cAAI;AACAgK,cAAE,CAAC3C,KAAH,CAAS8G,GAAG,CAACnO,CAAD,CAAZ,EAAiB,CAAEmO,GAAG,CAACnO,CAAD,CAAL,CAAjB;AACH,WAFD,CAGA,OAAOgO,CAAP,EAAU;AACNknB,eAAG,CAACpvB,GAAJ,CAAQ,8BAA8BkI,CAAtC;AACH;AACJ;AACJ,OAvDL;AAAA,UAwDIqoB,WAAW,GAAG,SAAdA,WAAc,CAAUhB,SAAV,EAAqB3f,MAArB,EAA6B4gB,YAA7B,EAA2C;AACrD,YAAIjB,SAAS,CAACkB,cAAd,EAA8B;AAC1B,cAAIj2B,EAAE,GAAG+0B,SAAS,CAACmB,iBAAV,EAAT;AAAA,cAAwCrO,GAAG,GAAG,EAA9C;AACA,cAAIsO,OAAO,GAAGpB,SAAS,CAACkB,cAAV,EAAd;;AACA,cAAIrN,CAAC,GAAGgM,GAAG,CAAC5I,KAAJ,CAAU,EAAV,EAAcmK,OAAd,CAAR;;AACAN,kBAAQ,CAAChO,GAAD,EAAMsO,OAAN,EAAe,WAAf,CAAR;;AACA,eAAK,IAAIz2B,CAAC,GAAG,CAAR,EAAWqB,CAAC,GAAGg0B,SAAS,CAACC,QAAV,CAAmBoB,KAAnB,CAAyBh3B,MAA7C,EAAqDM,CAAC,GAAGqB,CAAzD,EAA4DrB,CAAC,EAA7D,EAAiE;AAC7D,gBAAI22B,GAAG,GAAGtB,SAAS,CAACC,QAAV,CAAmBoB,KAAnB,CAAyB12B,CAAzB,CAAV;;AACA,gBAAI22B,GAAG,KAAK,WAAZ,EAAyB;AACrB,kBAAI5oB,EAAE,GAAGsnB,SAAS,CAACC,QAAV,CAAmBtC,QAAnB,CAA4B4D,OAA5B,CAAoCD,GAApC,EAAyCr2B,EAAzC,CAAT;;AACA,kBAAIyN,EAAE,IAAI,IAAV,EAAgB;AAEZ,oBAAIkiB,SAAS,GAAG,CAAC,QAAD,EAAW,SAAX,EAAsB,WAAtB,EAAmC,YAAnC,EAAiD,iBAAjD,EAAoE,UAApE,EAAgF,WAAhF,EAA6F,mBAA7F,EAAkH,gBAAlH,EAAoI,qBAApI,EAA2J,eAA3J,EAA4K,oBAA5K,CAAhB;AACA,oBAAI1D,UAAU,GAAG,EAAjB;;AAEA,oBAAIxe,EAAE,CAACmiB,aAAH,KAAqB,UAAzB,EAAqC;AACjCpjB,uBAAK,CAACjD,SAAN,CAAgBnF,IAAhB,CAAqB2C,KAArB,CAA2B4oB,SAA3B,EAAsC,CAAC,QAAD,EAAW,UAAX,EAAuB,UAAvB,CAAtC;AACH,iBAFD,MAEO;AACH1D,4BAAU,CAAC7nB,IAAX,CAAgB,UAAhB;AACH;;AAEDwkB,iBAAC,GAAGgM,GAAG,CAAC5I,KAAJ,CAAUpD,CAAV,EAAanb,EAAb,EAAiBwe,UAAjB,EAA6B0D,SAA7B,CAAJ;;AACAkG,wBAAQ,CAAChO,GAAD,EAAMpa,EAAN,EAAU4oB,GAAV,CAAR;AACH;AACJ;AACJ;;AAED,cAAIjhB,MAAJ,EAAY;AACRwT,aAAC,GAAGgM,GAAG,CAAC1H,QAAJ,CAAatE,CAAb,EAAgBxT,MAAhB,EAAwB,GAAxB,CAAJ;AACH;;AAED2f,mBAAS,CAACwB,SAAV,CAAoB3N,CAApB,EAAuBoN,YAAvB,EAAqCnO,GAArC;;AACA,cAAI,CAACmO,YAAL,EAAmB;AACfjB,qBAAS,CAACyB,OAAV;AACH;AACJ;AACJ,OA5FL;AAAA,UA8FJ;AAEQC,wBAAkB,GAAG94B,IAAI,CAAC84B,kBAAL,GAA0B,UAAUrhB,MAAV,EAAkB;AAE7Dwf,WAAG,CAACpE,cAAJ,CAAmBzpB,KAAnB,CAAyB,IAAzB,EAA+B0F,SAA/B;;AAEA,YAAIiqB,IAAI,GAAG,IAAX;AAAA,YACIx0B,CAAC,GAAGuK,SADR;AAAA,YAEIkqB,QAAQ,GAAGD,IAAI,CAACC,QAFpB;AAAA,YAGIlM,EAAE,GAAGkM,QAAQ,GAAI,IAAItxB,IAAJ,EAAD,CAAaC,OAAb,EAHpB;AAKA,aAAK0vB,QAAL,GAAgB;AACZtC,kBAAQ,EAAEtd,MAAM,CAAC4f,QADL;AAEZ4B,oBAAU,EAAExhB,MAAM,CAACwhB,UAAP,IAAqB,EAFrB;AAGZ3B,oBAAU,EAAE,IAHA;AAIZC,yBAAe,EAAE,IAJL;AAKZ2B,yBAAe,EAAE,IALL;AAMZhc,eAAK,EAAE,KANK;AAOZic,sBAAY,EAAE1hB,MAAM,CAAC0hB,YAPT;AAQZC,oBAAU,EAAE3hB,MAAM,CAAC2hB,UARP;AASZC,2BAAiB,EAAE,EATP;AAUZ9P,oBAAU,EAAE9R,MAAM,CAAC8R,UAAP,IAAqB9R,MAAM,CAAC4f,QAAP,CAAgBiC,QAAhB,CAAyBC,UAV9C;AAWZd,eAAK,EAAE,EAXK;AAYZe,mBAAS,EAAC;AAZE,SAAhB;;AAeA,aAAKC,aAAL,GAAqB,UAAS5iB,GAAT,EAAc9H,IAAd,EAAoBopB,MAApB,EAA4B;AAC7C,eAAKd,QAAL,CAAcmC,SAAd,CAAwBrB,MAAxB,IAAkC,KAAKd,QAAL,CAAcmC,SAAd,CAAwBrB,MAAxB,KAAmC,EAArE;AACA,eAAKd,QAAL,CAAcmC,SAAd,CAAwBrB,MAAxB,EAAgCthB,GAAhC,IAAuC9H,IAAvC;AACH,SAHD;;AAIA,aAAK2qB,iBAAL,GAAyB,UAAS7iB,GAAT,EAAcshB,MAAd,EAAsB;AAC3C,iBAAO,KAAKd,QAAL,CAAcmC,SAAd,CAAwBrB,MAAxB,IAAkC,KAAKd,QAAL,CAAcmC,SAAd,CAAwBrB,MAAxB,EAAgCthB,GAAhC,CAAlC,GAAyE,IAAhF;AACH,SAFD;;AAIA,aAAK6f,KAAL,GAAa,YAAY;AACrB,iBAAO5J,EAAP;AACH,SAFD,CAhC6D,CAoCzE;;;AAGY,YAAI7B,CAAC,GAAGxT,MAAM,CAACkiB,QAAP,IAAmB,EAA3B;AAAA,YAA+BC,EAAE,GAAG,EAApC;;AACA,YAAI,KAAKC,kBAAT,EAA6B;AACzB,eAAK,IAAI93B,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAK83B,kBAAL,CAAwBp4B,MAA5C,EAAoDM,CAAC,EAArD,EAAyD;AACrD8M,iBAAK,CAACjD,SAAN,CAAgBnF,IAAhB,CAAqB2C,KAArB,CAA2B6hB,CAA3B,EAA8B,KAAKoM,QAAL,CAActC,QAAd,CAAuBuE,QAAvB,CAAgC,KAAKO,kBAAL,CAAwB93B,CAAxB,CAAhC,KAA+D,EAA7F;AACH;;AAED,eAAKA,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGkpB,CAAC,CAACxpB,MAAlB,EAA0BM,CAAC,EAA3B,EAA+B;AAC3B;AACA;AACA,gBAAI+3B,EAAE,GAAGrC,OAAO,CAACsC,wBAAR,CAAiC9O,CAAC,CAAClpB,CAAD,CAAlC,CAAT;AACA63B,cAAE,CAACE,EAAE,CAAC,CAAD,CAAF,CAAMhN,EAAP,CAAF,GAAegN,EAAf;AACH;AACJ;;AAED,YAAIE,YAAY,GAAG;AACfL,kBAAQ,EAACC,EADM;AAEfX,oBAAU,EAAExhB,MAAM,CAACwhB,UAAP,IAAqB,EAFlB;AAGfva,eAAK,EAAEjH,MAAM,CAACiH,KAAP,IAAgB,KAAK2Y,QAAL,CAActC,QAAd,CAAuBkF,eAAvB;AAHR,SAAnB;;AAKA,aAAK3B,cAAL,GAAsB,YAAW;AAC7B,iBAAO0B,YAAP;AACH,SAFD;;AAGA,aAAKE,mBAAL,GAA2B,UAAShqB,GAAT,EAAc;AACrC,eAAK,IAAInO,CAAT,IAAcmO,GAAd,EAAmB;AACf8pB,wBAAY,CAACj4B,CAAD,CAAZ,GAAkBmO,GAAG,CAACnO,CAAD,CAArB;AACH;AACJ,SAJD,CA7D6D,CAmEzE;AAEY;;;AAEA,YAAI0V,MAAM,CAACkP,MAAX,EAAmB;AACf,eAAK,IAAIjN,OAAT,IAAoBjC,MAAM,CAACkP,MAA3B,EAAmC;AAC/BoS,gBAAI,CAAC9V,IAAL,CAAUvJ,OAAV,EAAmBjC,MAAM,CAACkP,MAAP,CAAcjN,OAAd,CAAnB;AACH;AACJ,SA3E4D,CA6E7D;AACA;AACA;AACA;AACA;AACA;;;AACA,aAAK0G,KAAL,GAAa,YAAY;AACrB,cAAI6K,CAAC,GAAGtf,MAAM,CAACwuB,MAAP,CAAc,KAAKzqB,WAAL,CAAiB9D,SAA/B,CAAR;AACA,eAAK8D,WAAL,CAAiBtG,KAAjB,CAAuB6hB,CAAvB,EAA0B1mB,CAA1B;AACA,iBAAO0mB,CAAP;AACH,SAJY,CAIXhI,IAJW,CAIN,IAJM,CAAb,CAnF6D,CAyF7D;AACA;;;AACA,aAAKmX,eAAL,GAAuB,UAAUC,UAAV,EAAsB;AACzC,cAAInxB,CAAC,GAAG,IAAR;;AACA,cAAI,KAAKmuB,QAAL,CAAc8B,YAAlB,EAAgC;AAC5B,gBAAI;AACAjwB,eAAC,GAAG,KAAKmuB,QAAL,CAAc8B,YAAd,CAA2BkB,UAA3B,CAAJ;AACH,aAFD,CAGA,OAAOtqB,CAAP,EAAU;AACNknB,iBAAG,CAACpvB,GAAJ,CAAQ,uCAAR,EAAiDkI,CAAjD;AACH;AACJ;;AACD,iBAAO7G,CAAP;AACH,SAXD,CA3F6D,CAwG7D;AACA;;;AACA,aAAKoxB,aAAL,GAAqB,UAAUC,QAAV,EAAoBC,QAApB,EAA8B9b,KAA9B,EAAqC2b,UAArC,EAAiDI,YAAjD,EAA+DjF,MAA/D,EAAuEvnB,MAAvE,EAA+E;AAChG,cAAI/E,CAAC,GAAG,KAAKmuB,QAAL,CAActC,QAAd,CAAuB2F,cAAvB,CAAsC,YAAtC,EAAoD;AACxDH,oBAAQ,EAAEA,QAD8C;AAExDC,oBAAQ,EAAEA,QAF8C;AAGxD9b,iBAAK,EAAEA,KAHiD;AAIxD2b,sBAAU,EAAEA,UAJ4C;AAKxDI,wBAAY,EAAEA,YAL0C;AAMxDjF,kBAAM,EAAEA,MANgD;AAMxCvnB,kBAAM,EAAEA;AANgC,WAApD,CAAR;;AAQA,cAAI,KAAKopB,QAAL,CAAc+B,UAAlB,EAA8B;AAC1B,gBAAI;AACAlwB,eAAC,GAAG,KAAKmuB,QAAL,CAAc+B,UAAd,CAAyB;AACzBmB,wBAAQ,EAAEA,QADe;AAEzBC,wBAAQ,EAAEA,QAFe;AAGzB9b,qBAAK,EAAEA,KAHkB;AAIzB2b,0BAAU,EAAEA,UAJa;AAKzBI,4BAAY,EAAEA,YALW;AAMzBjF,sBAAM,EAAEA,MANiB;AAMTvnB,sBAAM,EAAEA;AANC,eAAzB,CAAJ;AAQH,aATD,CAUA,OAAO8B,CAAP,EAAU;AACNknB,iBAAG,CAACpvB,GAAJ,CAAQ,qCAAR,EAA+CkI,CAA/C;AACH;AACJ;;AACD,iBAAO7G,CAAP;AACH,SAzBD;;AA2BA,YAAIyxB,YAAY,GAAG,EAAnB,CArI6D,CAuI7D;AACA;AACA;;AACA,aAAKC,oBAAL,GAA4B,UAAUt4B,CAAV,EAAa;AACrC,eAAK,IAAIP,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG44B,YAAY,CAACl5B,MAAjC,EAAyCM,CAAC,EAA1C,EAA8C;AAC1C44B,wBAAY,CAAC54B,CAAD,CAAZ,CAAgB,CAAhB,IAAqBO,CAArB;AACH;AACJ,SAJD;AAOH,OAjPL;;AAmPA,UAAIu4B,oBAAoB,GAAG,SAAvBA,oBAAuB,CAAUzD,SAAV,EAAqB0D,SAArB,EAAgC;AACvD,YAAI3C,MAAM,GAAGf,SAAS,CAACC,QAAV,CAAmBoB,KAAnB,CAAyBqC,SAAzB,CAAb;AAAA,YACIzmB,IAAI,GAAG+iB,SAAS,CAACC,QAAV,CAAmBtC,QAAnB,CAA4B4D,OAA5B,CAAoCR,MAApC,EAA4Cf,SAAS,CAACmB,iBAAV,EAA5C,CADX;;AAGA,YAAIlkB,IAAI,IAAI,IAAR,IAAgBA,IAAI,CAAC0mB,QAArB,IAAiC3D,SAAS,CAAC4D,MAA/C,EAAuD;AACnD5D,mBAAS,CAACC,QAAV,CAAmBtC,QAAnB,CAA4B9O,WAA5B,CAAwCmR,SAAS,CAAC4D,MAAlD,EAA0D3mB,IAAI,CAAC0mB,QAA/D;AACH;AACJ,OAPD;;AASA9D,SAAG,CAAC1G,MAAJ,CAAWvwB,IAAI,CAAC84B,kBAAhB,EAAoC7B,GAAG,CAACpE,cAAxC,EAAwD;AAEpDoI,oBAAY,EAAE,sBAAUjO,IAAV,EAAgB;AAC1B,iBAAO,KAAKqK,QAAL,CAAc4B,UAAd,CAAyBjM,IAAzB,CAAP;AACH,SAJmD;AAMpDkO,oBAAY,EAAE,sBAAUlO,IAAV,EAAgB7nB,KAAhB,EAAuB;AACjC,eAAKkyB,QAAL,CAAc4B,UAAd,CAAyBjM,IAAzB,IAAiC7nB,KAAjC;AACH,SARmD;AAUpDg2B,qBAAa,EAAE,yBAAY;AACvB,iBAAO,KAAK9D,QAAL,CAAc4B,UAArB;AACH,SAZmD;AAcpDmC,qBAAa,EAAE,uBAAU50B,CAAV,EAAa;AACxB,eAAK6wB,QAAL,CAAc4B,UAAd,GAA2BzyB,CAA3B;AACH,SAhBmD;AAkBpD60B,gBAAQ,EAAC,oBAAW;AAChB,iBAAO5D,OAAO,CAAC4D,QAAR,CAAiB,KAAKL,MAAtB,CAAP;AACH,SApBmD;AAsBpD1E,gBAAQ,EAAC,kBAASgF,KAAT,EAAgB;AACrB,iBAAO7D,OAAO,CAACnB,QAAR,CAAiB,KAAK0E,MAAtB,EAA8BM,KAA9B,CAAP;AACH,SAxBmD;AA0BpD3c,gBAAQ,EAAE,kBAAU2c,KAAV,EAAiB;AACvB7D,iBAAO,CAAC9Y,QAAR,CAAiB,KAAKqc,MAAtB,EAA8BM,KAA9B;AACH,SA5BmD;AA8BpDrV,mBAAW,EAAE,qBAAUqV,KAAV,EAAiB;AAC1B7D,iBAAO,CAACxR,WAAR,CAAoB,KAAK+U,MAAzB,EAAiCM,KAAjC;AACH,SAhCmD;AAkCpDC,qBAAa,EAAE,uBAAUC,YAAV,EAAwBC,eAAxB,EAAyC;AACpDhE,iBAAO,CAAC8D,aAAR,CAAsB,KAAKP,MAA3B,EAAmCQ,YAAnC,EAAiDC,eAAjD;AACH,SApCmD;AAsCpDC,eAAO,EAAE,iBAAUvD,MAAV,EAAkB1gB,MAAlB,EAA0B4gB,YAA1B,EAAwC;AAC7C,eAAKsD,UAAL;AACA,eAAKtE,QAAL,CAAcoB,KAAd,GAAsBR,UAAU,CAACE,MAAD,CAAV,IAAsB,EAA5C;;AACAC,qBAAW,CAAC,IAAD,EAAO3gB,MAAP,EAAe4gB,YAAf,CAAX;AACH,SA1CmD;AA4CpDM,eAAO,EAAE,mBAAY;AACjB,iBAAO,KAAKtB,QAAL,CAAcoB,KAArB;AACH,SA9CmD;AAgDpDmD,oBAAY,EAAE,sBAAUnkB,MAAV,EAAkB4gB,YAAlB,EAAgC;AAC1CD,qBAAW,CAAC,IAAD,EAAO3gB,MAAP,EAAe4gB,YAAf,CAAX;AACH,SAlDmD;AAoDpDwD,eAAO,EAAE,iBAAU1D,MAAV,EAAkB;AACvB,iBAAO,KAAKd,QAAL,CAAcoB,KAAd,CAAoBnoB,OAApB,CAA4B6nB,MAA5B,MAAwC,CAAC,CAAhD;AACH,SAtDmD;AAwDpD2D,eAAO,EAAE,iBAAU3D,MAAV,EAAkB1gB,MAAlB,EAA0B4gB,YAA1B,EAAwC;AAC7C,cAAIv2B,CAAC,GAAGm2B,UAAU,CAACE,MAAD,CAAlB;AAAA,cAA4B4D,KAAK,GAAG,KAApC;;AACA,cAAIj6B,CAAC,IAAI,IAAT,EAAe;AACX,iBAAK,IAAIC,CAAC,GAAG,CAAR,EAAWqB,CAAC,GAAGtB,CAAC,CAACL,MAAtB,EAA8BM,CAAC,GAAGqB,CAAlC,EAAqCrB,CAAC,EAAtC,EAA0C;AACtC,kBAAI,CAAC,KAAK85B,OAAL,CAAa/5B,CAAC,CAACC,CAAD,CAAd,CAAL,EAAyB;AACrB,qBAAKs1B,QAAL,CAAcoB,KAAd,CAAoBhyB,IAApB,CAAyB3E,CAAC,CAACC,CAAD,CAA1B;;AACAg6B,qBAAK,GAAG,IAAR;AACH;AACJ;;AACD,gBAAIA,KAAJ,EAAW;AACP3D,yBAAW,CAAC,IAAD,EAAO3gB,MAAP,EAAe4gB,YAAf,CAAX;AACH;AACJ;AACJ,SArEmD;AAuEpD2D,kBAAU,EAAE,oBAAU7D,MAAV,EAAkB1gB,MAAlB,EAA0B4gB,YAA1B,EAAwC;AAChD,cAAIv2B,CAAC,GAAGm2B,UAAU,CAACE,MAAD,CAAlB;AAAA,cAA4B4D,KAAK,GAAG,KAApC;AAAA,cAA2CvrB,IAAI,GAAG,UAAU6C,EAAV,EAAc;AAC5D,gBAAIkD,GAAG,GAAG,KAAK8gB,QAAL,CAAcoB,KAAd,CAAoBnoB,OAApB,CAA4B+C,EAA5B,CAAV;;AACA,gBAAIkD,GAAG,KAAK,CAAC,CAAb,EAAgB;AACZ;AACAskB,kCAAoB,CAAC,IAAD,EAAOtkB,GAAP,CAApB;;AACA,mBAAK8gB,QAAL,CAAcoB,KAAd,CAAoB9nB,MAApB,CAA2B4F,GAA3B,EAAgC,CAAhC;;AACA,qBAAO,IAAP;AACH;;AACD,mBAAO,KAAP;AACH,WATiD,CAShD0M,IATgD,CAS3C,IAT2C,CAAlD;;AAWA,cAAInhB,CAAC,IAAI,IAAT,EAAe;AACX,iBAAK,IAAIC,CAAC,GAAG,CAAR,EAAWqB,CAAC,GAAGtB,CAAC,CAACL,MAAtB,EAA8BM,CAAC,GAAGqB,CAAlC,EAAqCrB,CAAC,EAAtC,EAA0C;AACtCg6B,mBAAK,GAAGvrB,IAAI,CAAC1O,CAAC,CAACC,CAAD,CAAF,CAAJ,IAAcg6B,KAAtB;AACH;;AACD,gBAAIA,KAAJ,EAAW;AACP3D,yBAAW,CAAC,IAAD,EAAO3gB,MAAP,EAAe4gB,YAAf,CAAX;AACH;AACJ;AACJ,SA3FmD;AA4FpDsD,kBAAU,EAAE,oBAAUlkB,MAAV,EAAkB4gB,YAAlB,EAAgC;AACxC,cAAIt2B,CAAC,GAAG,KAAKs1B,QAAL,CAAcoB,KAAd,CAAoBh3B,MAA5B;;AACA,eAAK,IAAI2B,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGrB,CAApB,EAAuBqB,CAAC,EAAxB,EAA4B;AACxBy3B,gCAAoB,CAAC,IAAD,EAAO,CAAP,CAApB;;AACA,iBAAKxD,QAAL,CAAcoB,KAAd,CAAoB9nB,MAApB,CAA2B,CAA3B,EAA8B,CAA9B;AACH;;AACDynB,qBAAW,CAAC,IAAD,EAAO3gB,MAAP,EAAe4gB,YAAf,CAAX;AACH,SAnGmD;AAqGpD4D,kBAAU,EAAE,oBAAU9D,MAAV,EAAkB1gB,MAAlB,EAA0B4gB,YAA1B,EAAwC;AAChD,cAAIv2B,CAAC,GAAGm2B,UAAU,CAACE,MAAD,CAAlB;;AACA,cAAIr2B,CAAC,IAAI,IAAT,EAAe;AACX,iBAAK,IAAIC,CAAC,GAAG,CAAR,EAAWqB,CAAC,GAAGtB,CAAC,CAACL,MAAtB,EAA8BM,CAAC,GAAGqB,CAAlC,EAAqCrB,CAAC,EAAtC,EAA0C;AACtC,kBAAIwU,GAAG,GAAG,KAAK8gB,QAAL,CAAcoB,KAAd,CAAoBnoB,OAApB,CAA4BxO,CAAC,CAACC,CAAD,CAA7B,CAAV;;AACA,kBAAIwU,GAAG,KAAK,CAAC,CAAb,EAAgB;AACZskB,oCAAoB,CAAC,IAAD,EAAOtkB,GAAP,CAApB;;AACA,qBAAK8gB,QAAL,CAAcoB,KAAd,CAAoB9nB,MAApB,CAA2B4F,GAA3B,EAAgC,CAAhC;AACH,eAHD,MAIK;AACD,qBAAK8gB,QAAL,CAAcoB,KAAd,CAAoBhyB,IAApB,CAAyB3E,CAAC,CAACC,CAAD,CAA1B;AACH;AACJ;;AAEDq2B,uBAAW,CAAC,IAAD,EAAO3gB,MAAP,EAAe4gB,YAAf,CAAX;AACH;AACJ,SArHmD;AAsHpDO,iBAAS,EAAE,mBAAU92B,CAAV,EAAau2B,YAAb,EAA2B;AAClC,eAAK6D,aAAL,CAAmBp6B,CAAC,CAACw1B,UAArB,EAAiCe,YAAjC;AACA,eAAK8D,kBAAL,CAAwBr6B,CAAC,CAACy1B,eAA1B,EAA2Cc,YAA3C;;AACA,cAAIv2B,CAAC,CAACm3B,UAAN,EAAkB;AACd,iBAAK,IAAIl3B,CAAT,IAAcD,CAAC,CAACm3B,UAAhB,EAA4B;AACxB,mBAAKiC,YAAL,CAAkBn5B,CAAlB,EAAqBD,CAAC,CAACm3B,UAAF,CAAal3B,CAAb,CAArB;AACH;AACJ;;AACD,eAAKs1B,QAAL,CAAc6B,eAAd,GAAgC,KAAKkD,aAAL,EAAhC;AACH,SA/HmD;AAgIpDF,qBAAa,EAAE,uBAAUpX,KAAV,EAAiBuT,YAAjB,EAA+B;AAC1C;AACA;AACA,eAAKhB,QAAL,CAAcC,UAAd,GAA2BxS,KAA3B;AACA,eAAKuS,QAAL,CAAc6B,eAAd,GAAgC,KAAK7B,QAAL,CAAcC,UAA9C;;AACAH,2BAAiB,CAAC,IAAD,CAAjB;;AACA,cAAI,CAACkB,YAAL,EAAmB;AACf,iBAAKQ,OAAL;AACH;AACJ,SAzImD;AA0IpDuD,qBAAa,EAAE,yBAAY;AACvB,iBAAO,KAAK/E,QAAL,CAAcC,UAArB;AACH,SA5ImD;AA6IpD6E,0BAAkB,EAAE,4BAAUrX,KAAV,EAAiBuT,YAAjB,EAA+B;AAC/C;AACA;AACA,eAAKhB,QAAL,CAAcE,eAAd,GAAgCzS,KAAhC;;AACAqS,2BAAiB,CAAC,IAAD,CAAjB;;AACA,cAAI,CAACkB,YAAL,EAAmB;AACf,iBAAKQ,OAAL;AACH;AACJ,SArJmD;AAsJpDwD,0BAAkB,EAAE,8BAAY;AAC5B,iBAAO,KAAKhF,QAAL,CAAcE,eAArB;AACH,SAxJmD;AAyJpDvO,eAAO,EAAE,iBAAUhC,KAAV,EAAiB;AACtB,cAAIA,KAAK,IAAI,KAAKmR,MAAL,IAAe,IAA5B,EAAkC;AAC9B,iBAAKjE,gBAAL,GAD8B,CACL;;AACzB,iBAAK9T,KAAL,GAAa,IAAb;AACA,iBAAKiX,QAAL,GAAgB,IAAhB;AACH;AACJ,SA/JmD;AAiKpDtO,eAAO,EAAE,mBAAY;AACjB,iBAAO,KAAKsO,QAAL,CAAcna,KAArB;AACH,SAnKmD;AAqKpDgB,gBAAQ,EAAE,kBAAUhB,KAAV,EAAiBof,sBAAjB,EAAyCzE,SAAzC,EAAoD;AAC1D;AACA;AACA,cAAI,KAAKR,QAAL,IAAiB,CAAC,KAAKA,QAAL,CAActC,QAAd,CAAuBwH,iBAAzC,IAA8D,CAAC,KAAKlF,QAAL,CAActC,QAAd,CAAuByH,gBAAvB,EAAnE,EAA8G;AAE1G,iBAAKnF,QAAL,CAAcna,KAAd,GAAsBA,KAAtB;AACA,gBAAIuf,MAAM,GAAGvf,KAAK,GAAG,UAAH,GAAgB,aAAlC;;AAEA,gBAAI,KAAK8d,MAAL,IAAe,IAAnB,EAAyB;AACrB,kBAAI,KAAK3D,QAAL,CAActC,QAAd,CAAuBxL,UAAvB,IAAqC,IAAzC,EAA+C;AAC3C,qBAAK8N,QAAL,CAActC,QAAd,CAAuB0H,MAAvB,EAA+B,KAAKzB,MAApC,EAA4C,KAAK3D,QAAL,CAActC,QAAd,CAAuBxL,UAAnE;AACH;;AACD,kBAAI,KAAK8N,QAAL,CAAc9N,UAAd,IAA4B,IAAhC,EAAsC;AAClC,qBAAK8N,QAAL,CAActC,QAAd,CAAuB0H,MAAvB,EAA+B,KAAKzB,MAApC,EAA4C,KAAK3D,QAAL,CAAc9N,UAA1D;AACH;AACJ;;AACD,gBAAI,KAAK8N,QAAL,CAAcE,eAAd,IAAiC,IAArC,EAA2C;AACvC,mBAAKF,QAAL,CAAc6B,eAAd,GAAgChc,KAAK,GAAG,KAAKma,QAAL,CAAcE,eAAjB,GAAmC,KAAKF,QAAL,CAAcC,UAAtF;;AACA,kBAAI,CAAC,KAAKD,QAAL,CAActC,QAAd,CAAuB2H,gBAAvB,EAAL,EAAgD;AAC5C7E,yBAAS,GAAGA,SAAS,IAAIX,UAAU,EAAnC;AACA,qBAAK2B,OAAL,CAAa;AAAChB,2BAAS,EAAEA,SAAZ;AAAuB8E,wBAAM,EAAE;AAA/B,iBAAb;AACH;AACJ,aAnByG,CAoB1G;AACA;;;AACA,gBAAI,KAAK3E,mBAAL,IAA4B,CAACsE,sBAAjC,EAAyD;AACrD1E,qCAAuB,CAAC,IAAD,EAAO1a,KAAP,EAAcga,UAAU,EAAxB,EAA4B,IAA5B,CAAvB;AACH;AACJ;AACJ;AAlMmD,OAAxD,EAlQU,CAucd;;;AAEI,UAAI0F,qBAAqB,GAAG,CAA5B;AAAA,UACIjH,gBAAgB,GAAG,SAAnBA,gBAAmB,GAAY;AAC3B,YAAI5zB,CAAC,GAAG66B,qBAAqB,GAAG,CAAhC;AACAA,6BAAqB;AACrB,eAAO76B,CAAP;AACH,OALL;;AAOA,UAAI8yB,eAAe,GAAG70B,IAAI,CAAC60B,eAAL,GAAuB,UAAUgI,SAAV,EAAqB;AAE9D,aAAKxxB,OAAL,GAAe,QAAf;AAEA,aAAKiuB,QAAL,GAAgB;AACZwD,gBAAM,EAAE,QADI;AAEZC,iBAAO,EAAE,CAAE,IAAF,EAAQ,IAAR,CAFG;AAGZC,+BAAqB,EAAE,IAHX;AAIZC,4BAAkB,EAAE,EAJR;AAKZC,mBAAS,EAAE,QALC;AAMZC,mBAAS,EAAE,IANC;AAOZC,0BAAgB,EAAE,KAPN;AAQZC,qBAAW,EAAE,EARD;AASZC,qBAAW,EAAE,EATD;AAUZC,kBAAQ,EAAE,KAVE;AAWZC,0BAAgB,EAAE,EAXN;AAYZC,mBAAS,EAAE,CAAE,IAAF,EAAQ,IAAR,CAZC;AAaZC,uBAAa,EAAE;AAAEhG,gBAAI,EAAE;AAAR,WAbH;AAcZiG,wBAAc,EAAE,CAAE,IAAF,EAAQ,IAAR,CAdJ;AAeZC,4BAAkB,EAAE,IAfR;AAgBZC,6BAAmB,EAAE,CAAE,IAAF,EAAQ,IAAR,CAhBT;AAiBZC,yBAAe,EAAE,IAjBL;AAkBZC,oBAAU,EAAE;AAAEC,iBAAK,EAAE;AAAT,WAlBA;AAmBZC,mBAAS,EAAE,EAnBC;AAoBZC,oBAAU,EAAE,KApBA;AAqBZC,kBAAQ,EAAE,EArBE;AAsBZC,wBAAc,EAAE,CAtBJ;AAuBZC,oBAAU,EAAE;AAAE,4BAAgB,CAAlB;AAAqBC,kBAAM,EAAE;AAA7B,WAvBA;AAwBZC,6BAAmB,EAAE,KAxBT;AAyBZC,oBAAU,EAAE,KAzBA;AA0BZC,eAAK,EAAE;AA1BK,SAAhB;;AA6BA,YAAI5B,SAAJ,EAAe;AACXpF,iBAAO,CAAClH,MAAR,CAAe,KAAK+I,QAApB,EAA8BuD,SAA9B;AACH;;AAED,aAAKxK,UAAL,GAAkB,KAAKiH,QAAL,CAAc4E,UAAhC;AACA,aAAKQ,gBAAL,GAAwB,EAAxB;AACA,aAAKC,cAAL,GAAsB,EAAtB;;AAEA1H,WAAG,CAACpE,cAAJ,CAAmBzpB,KAAnB,CAAyB,IAAzB;;AAEA,YAAIw1B,gBAAgB,GAAG,IAAvB;AAAA,YACIC,cAAc,GAAGlJ,gBAAgB,EADrC;AAAA,YAEImJ,GAAG,GAAGF,gBAAgB,CAAC3b,IAF3B;AAAA,YAGI8b,gBAAgB,GAAG,EAHvB;AAAA,YAII/U,KAAK,GAAG,CAJZ;AAAA,YAKIgV,KAAK,GAAG,SAARA,KAAQ,CAAU7vB,EAAV,EAAc;AAClB,cAAIA,EAAE,IAAI,IAAV,EAAgB;AACZ,mBAAO,IAAP;AACH,WAFD,MAGK,IAAIA,EAAE,CAAC8vB,QAAH,KAAgB,CAAhB,IAAqB9vB,EAAE,CAAC8vB,QAAH,KAAgB,CAAzC,EAA4C;AAC7C,mBAAO;AAAE9vB,gBAAE,EAACA,EAAL;AAAS+vB,kBAAI,EAAC;AAAd,aAAP;AACH,WAFI,MAGA;AACD,gBAAInoB,GAAG,GAAG6nB,gBAAgB,CAACO,UAAjB,CAA4BhwB,EAA5B,CAAV;;AACA,mBAAO;AAAEA,gBAAE,EAAE4H,GAAN;AAAW+V,gBAAE,EAAGmK,GAAG,CAACpJ,QAAJ,CAAa1e,EAAb,KAAoB4H,GAAG,IAAI,IAA5B,GAAoC5H,EAApC,GAAyCiwB,MAAM,CAACroB,GAAD;AAA9D,aAAP;AACH;AACJ,SAhBL;;AAkBA,aAAK4e,gBAAL,GAAwB,YAAY;AAChC,iBAAOkJ,cAAP;AACH,SAFD,CA7D8D,CAiE9D;;;AACA,aAAKjT,OAAL,GAAe,UAAUnpB,CAAV,EAAa48B,iBAAb,EAAgC;AAC3CrV,eAAK,GAAGvnB,CAAR;;AACAm8B,0BAAgB,CAACtL,IAAjB,CAAsB,MAAtB,EAA8BtJ,KAA9B;;AACA,cAAIqV,iBAAJ,EAAuB;AACnBT,4BAAgB,CAACS,iBAAjB;AACH;;AACD,iBAAO,IAAP;AACH,SAPD,CAlE8D,CA0E9D;;;AACA,aAAKzZ,OAAL,GAAe,YAAY;AACvB,iBAAOoE,KAAP;AACH,SAFD;;AAIA,aAAK,IAAIjoB,CAAT,IAAc,KAAKu3B,QAAnB,EAA6B;AACzByF,0BAAgB,CAACh9B,CAAD,CAAhB,GAAsB,KAAKu3B,QAAL,CAAcv3B,CAAd,CAAtB;AACH;;AAED,YAAIu9B,UAAJ;AAAA,YAAgBC,qBAAqB,GAAG,EAAxC;;AACA,aAAKC,eAAL,GAAuB,YAAW;AAC9B,cAAIF,UAAU,IAAI,IAAd,IAAsBC,qBAAqB,CAAC99B,MAAtB,GAA+B,CAAzD,EAA4D;AACxD,iBAAK,IAAIM,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGw9B,qBAAqB,CAAC99B,MAA1C,EAAkDM,CAAC,EAAnD,EAAuD;AACnD68B,8BAAgB,CAACvmB,GAAjB,CAAqBinB,UAArB,EAAiCC,qBAAqB,CAACx9B,CAAD,CAArB,CAAyB,CAAzB,CAAjC,EAA8Dw9B,qBAAqB,CAACx9B,CAAD,CAArB,CAAyB,CAAzB,CAA9D;AACH;AACJ;AACJ,SAND;;AAOA,aAAK09B,YAAL,GAAoB,UAAUn9B,CAAV,EAAa;AAE7B,eAAKk9B,eAAL,GAF6B,CAI7B;;AACAl9B,WAAC,GAAG,KAAK68B,UAAL,CAAgB78B,CAAhB,CAAJ,CAL6B,CAM7B;;AACA,eAAK8oB,MAAL,GAAcsG,IAAd,CAAmB,UAAUgD,IAAV,EAAgB;AAC/BA,gBAAI,CAACgL,UAAL,CAAgBp9B,CAAhB;AACH,WAFD;AAGA,eAAKq9B,eAAL,GAAuBjO,IAAvB,CAA4B,UAAU+C,EAAV,EAAc;AACtCA,cAAE,CAACiL,UAAH,CAAcp9B,CAAd;AACH,WAFD,EAV6B,CAc7B;;AACA,cAAIs9B,iBAAiB,GAAGN,UAAxB;AACAA,oBAAU,GAAGh9B,CAAb;AACAi9B,+BAAqB,CAAC99B,MAAtB,GAA+B,CAA/B;AACA,cAAIo+B,YAAY,GAAG;AACf,6BAAgB,eADD;AAEf,gCAAmB;AAFJ,WAAnB;;AAKA,cAAIC,mBAAmB,GAAG,SAAtBA,mBAAsB,CAAUhT,EAAV,EAAc/c,CAAd,EAAiBgwB,aAAjB,EAAgC;AACtD,gBAAIj+B,CAAC,GAAGiO,CAAC,CAACC,UAAF,IAAgBD,CAAC,CAAC9B,MAA1B;AAAA,gBACI+xB,EAAE,GAAG,CAACl+B,CAAC,IAAIA,CAAC,CAACwN,UAAP,GAAoBxN,CAAC,CAACwN,UAAF,CAAa+nB,QAAjC,GAA4C,IAA7C,MAAuDv1B,CAAC,GAAGA,CAAC,CAACu1B,QAAL,GAAgB,IAAxE,MAAkFv1B,CAAC,IAAIA,CAAC,CAACwN,UAAP,IAAqBxN,CAAC,CAACwN,UAAF,CAAaA,UAAlC,GAA+CxN,CAAC,CAACwN,UAAF,CAAaA,UAAb,CAAwB+nB,QAAvE,GAAkF,IAApK,CADT;;AAEA,gBAAI2I,EAAJ,EAAQ;AACJA,gBAAE,CAAC1M,IAAH,CAAQxG,EAAR,EAAYkT,EAAZ,EAAgBjwB,CAAhB;AACA,kBAAIkwB,KAAK,GAAGF,aAAa,GAAGF,YAAY,CAACE,aAAa,GAAGjT,EAAjB,CAAZ,IAAoCA,EAAvC,GAA4CA,EAArE,CAFI,CAGJ;;AACA8R,8BAAgB,CAACtL,IAAjB,CAAsB2M,KAAtB,EAA6BD,EAAE,CAAC5I,SAAH,IAAgB4I,EAA7C,EAAiDjwB,CAAjD;AACH;AACJ,WATD;;AAWA,cAAImwB,eAAe,GAAG,SAAlBA,eAAkB,CAASjsB,OAAT,EAAkB7E,QAAlB,EAA4BrD,EAA5B,EAAgC;AAClDwzB,iCAAqB,CAAC94B,IAAtB,CAA2B,CAACwN,OAAD,EAAUlI,EAAV,CAA3B;;AACA6yB,4BAAgB,CAAC3mB,EAAjB,CAAoBqnB,UAApB,EAAgCrrB,OAAhC,EAAyC7E,QAAzC,EAAmDrD,EAAnD;AACH,WAHD,CAlC6B,CAuC7B;AACA;AACA;AACA;;;AACA,cAAIo0B,YAAY,GAAG,SAAfA,YAAe,CAAUrT,EAAV,EAAc;AAC7B;AACAoT,2BAAe,CAACpT,EAAD,EAAK,gBAAL,EAAuB,UAAU/c,CAAV,EAAa;AAC/C+vB,iCAAmB,CAAChT,EAAD,EAAK/c,CAAL,CAAnB;AACH,aAFc,CAAf,CAF6B,CAK7B;;;AACAmwB,2BAAe,CAACpT,EAAD,EAAK,eAAL,EAAsB,UAAU/c,CAAV,EAAa;AAC9C+vB,iCAAmB,CAAChT,EAAD,EAAK/c,CAAL,EAAQ,UAAR,CAAnB;AACH,aAFc,CAAf,CAN6B,CAS7B;;;AACAmwB,2BAAe,CAACpT,EAAD,EAAK,cAAL,EAAqB,UAAU/c,CAAV,EAAa;AAC7C+vB,iCAAmB,CAAChT,EAAD,EAAK/c,CAAL,CAAnB;AACH,aAFc,CAAf;AAGH,WAbD;;AAeA,eAAK,IAAIhO,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG4kB,MAAM,CAACllB,MAA3B,EAAmCM,CAAC,EAApC,EAAwC;AACpCo+B,wBAAY,CAACxZ,MAAM,CAAC5kB,CAAD,CAAP,CAAZ;AACH,WA5D4B,CA8D7B;;;AACA,eAAK,IAAI00B,IAAT,IAAiB2J,eAAjB,EAAkC;AAC9B,gBAAIjxB,EAAE,GAAGixB,eAAe,CAAC3J,IAAD,CAAf,CAAsBtnB,EAA/B;;AACA,gBAAIA,EAAE,CAACG,UAAH,KAAkBswB,iBAAtB,EAAyC;AACrCA,+BAAiB,CAAC5nB,WAAlB,CAA8B7I,EAA9B;;AACAmwB,wBAAU,CAACra,WAAX,CAAuB9V,EAAvB;AACH;AACJ;AAEJ,SAvED;;AAwEA,aAAK6mB,YAAL,GAAoB,YAAY;AAC5B,iBAAOsJ,UAAP;AACH,SAFD;;AAIA,aAAKrc,IAAL,GAAY,UAAUnS,KAAV,EAAiB/E,EAAjB,EAAqB;AAC7B,cAAI,YAAY+E,KAAZ,IAAqBuvB,WAAzB,EAAsC;AAClCt0B,cAAE;AACL,WAFD,MAGK;AACD+yB,eAAG,CAAC11B,KAAJ,CAAUw1B,gBAAV,EAA4B,CAAC9tB,KAAD,EAAQ/E,EAAR,CAA5B;AACH;AACJ,SAPD;;AASA6yB,wBAAgB,CAAC0B,cAAjB,GAAkC,UAAU/9B,CAAV,EAAa;AAC3C,eAAK,IAAIR,CAAT,IAAcQ,CAAd,EAAiB;AACbq8B,4BAAgB,CAACtF,QAAjB,CAA0Bv3B,CAA1B,IAA+BQ,CAAC,CAACR,CAAD,CAAhC;AACH;;AACD,cAAIQ,CAAC,CAAC46B,SAAN,EAAiB;AACbyB,4BAAgB,CAACa,YAAjB,CAA8Bl9B,CAAC,CAAC46B,SAAhC;AACH;;AAED,iBAAOyB,gBAAP;AACH,SATD;;AAWAA,wBAAgB,CAAC2B,eAAjB,GAAmC,YAAY;AAC3C3B,0BAAgB,CAACtF,QAAjB,GAA4B7B,OAAO,CAAClH,MAAR,CAAe,EAAf,EAAmBwO,gBAAnB,CAA5B;AACA,iBAAOH,gBAAP;AACH,SAHD;;AAKA,YAAI/2B,GAAG,GAAG,IAAV;AAAA,YACIw4B,WAAW,GAAG,KADlB;AAAA,YAEI;AACAG,mBAAW,GAAG,EAHlB;AAAA,YAII;AACA;AACA;AACAC,0BAAkB,GAAG,EAPzB;AAAA,YAQIC,eAAe,GAAG,EARtB;AAAA,YASIN,eAAe,GAAG,EATtB;AAAA,YAUIO,OAAO,GAAG,EAVd;AAAA,YAWIC,gBAAgB,GAAG,EAXvB;AAAA,YAYIC,eAAe,GAAG,EAZtB;AAAA,YAaIC,sBAAsB,GAAG,KAb7B;AAAA,YAcIC,KAAK,GAAG,EAdZ;AAAA,YAeIC,eAAe,GAAG,KAftB;AAAA,YAgBIC,YAAY,GAAG,IAhBnB;AAAA,YAiBIC,aAAa,GAAG,KAAK5H,QAAL,CAAcmF,KAjBlC;AAAA,YAkBI0C,WAAW,GAAG,CAlBlB;AAAA,YAmBIC,QAAQ,GAAG,SAAXA,QAAW,GAAY;AACnB,iBAAO,KAAKD,WAAW,EAAvB;AACH,SArBL;AAAA,YAuBI;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAE,sBAAc,GAAG,UAAUlyB,EAAV,EAAc6V,MAAd,EAAsB;AACnC,cAAIsa,UAAJ,EAAgB;AACZA,sBAAU,CAACra,WAAX,CAAuB9V,EAAvB;AACH,WAFD,MAGK,IAAI,CAAC6V,MAAL,EAAa;AACd,iBAAKsc,YAAL,CAAkBnyB,EAAlB;AACH,WAFI,MAGA;AACD,iBAAKgwB,UAAL,CAAgBna,MAAhB,EAAwBC,WAAxB,CAAoC9V,EAApC;AACH;AACJ,SAVgB,CAUf8T,IAVe,CAUV,IAVU,CA/BrB;AAAA,YA2CI;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAse,aAAK,GAAG,SAARA,KAAQ,CAAUC,OAAV,EAAmBC,EAAnB,EAAuB5J,SAAvB,EAAkC6J,UAAlC,EAA8C;AAElD,cAAI,CAACV,eAAL,EAAsB;AAElBQ,mBAAO,GAAG5C,gBAAgB,CAACO,UAAjB,CAA4BqC,OAA5B,CAAV;;AAEA,gBAAIA,OAAO,IAAI,IAAf,EAAqB;AAEjB,kBAAI1U,EAAE,GAAGsS,MAAM,CAACoC,OAAD,CAAf;AAAA,kBACIG,UAAU,GAAGH,OAAO,CAAChyB,gBAAR,CAAyB,cAAzB,CADjB;;AAGA,kBAAIqoB,SAAS,IAAI,IAAjB,EAAuB;AACnBA,yBAAS,GAAGX,UAAU,EAAtB;AACH,eAPgB,CASjB;;;AACA,kBAAIjM,CAAC,GAAG2W,aAAa,CAAC;AAACnL,oBAAI,EAAE3J,EAAP;AAAW+U,sBAAM,EAAEJ,EAAnB;AAAuB9E,sBAAM,EAAE,KAA/B;AAAsC9E,yBAAS,EAAEA;AAAjD,eAAD,CAArB;;AAEA,mBAAK,IAAI91B,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG4/B,UAAU,CAAClgC,MAA/B,EAAuCM,CAAC,EAAxC,EAA4C;AACxC6/B,6BAAa,CAAC;AACVnL,sBAAI,EAAEkL,UAAU,CAAC5/B,CAAD,CAAV,CAAcoQ,YAAd,CAA2B,IAA3B,CADI;AAEV;AACA;AACA;AACA;AACAwqB,wBAAM,EAAE,IANE;AAOV9E,2BAAS,EAAEA;AAPD,iBAAD,CAAb;AASH;;AAED+G,8BAAgB,CAACkD,aAAjB,CAA+BC,MAA/B,CAAsCjV,EAAtC,EAA0C2U,EAA1C,EAA8C5J,SAA9C,EAAyD,IAAzD,EAA+D6J,UAA/D;;AAEA,kBAAIC,UAAJ,EAAgB;AACZ,qBAAK,IAAIv+B,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGu+B,UAAU,CAAClgC,MAA/B,EAAuC2B,CAAC,EAAxC,EAA4C;AACxCw7B,kCAAgB,CAACkD,aAAjB,CAA+BC,MAA/B,CAAsCJ,UAAU,CAACv+B,CAAD,CAAV,CAAc+O,YAAd,CAA2B,IAA3B,CAAtC,EAAwE,IAAxE,EAA8E0lB,SAA9E,EAAyF,IAAzF,EAA+F6J,UAA/F,EAA2G,IAA3G;AACH;AACJ;AACJ;AACJ;AACJ,SA3FL;AAAA,YA6FI;AACA;AACA;AACAM,oBAAY,GAAG,SAAfA,YAAe,CAAUnjB,IAAV,EAAgB;AAC3B,iBAAO6hB,eAAe,CAAC7hB,IAAD,CAAtB;AACH,SAlGL;;AAoGI;;;;;AAOAojB,mBAAW,GAAG,SAAdA,WAAc,CAAUC,EAAV,EAAcC,EAAd,EAAkB;AAC5B,cAAIC,EAAE,GAAGF,EAAE,CAACxjB,KAAH,CAASjN,KAAT,CAAe,IAAf,CAAT;AAAA,cAA+B4wB,EAAE,GAAGF,EAAE,CAACzjB,KAAH,CAASjN,KAAT,CAAe,IAAf,CAApC;;AACA,eAAK,IAAI1P,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGqgC,EAAE,CAAC3gC,MAAvB,EAA+BM,CAAC,EAAhC,EAAoC;AAChC,iBAAK,IAAIqB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGi/B,EAAE,CAAC5gC,MAAvB,EAA+B2B,CAAC,EAAhC,EAAoC;AAChC,kBAAIi/B,EAAE,CAACj/B,CAAD,CAAF,KAAUg/B,EAAE,CAACrgC,CAAD,CAAhB,EAAqB;AACjB,uBAAO,IAAP;AACH;AACJ;AACJ;;AAED,iBAAO,KAAP;AACH,SAtHL;AAAA,YAwHIugC,eAAe,GAAG,SAAlBA,eAAkB,CAAUvQ,GAAV,EAAetC,MAAf,EAAuB;AACrC,cAAI3sB,CAAC,GAAG20B,OAAO,CAAClH,MAAR,CAAe,EAAf,EAAmBwB,GAAnB,CAAR;;AACA,eAAK,IAAIhwB,CAAT,IAAc0tB,MAAd,EAAsB;AAClB,gBAAIA,MAAM,CAAC1tB,CAAD,CAAV,EAAe;AACXe,eAAC,CAACf,CAAD,CAAD,GAAO0tB,MAAM,CAAC1tB,CAAD,CAAb;AACH;AACJ;;AACD,iBAAOe,CAAP;AACH,SAhIL;;AAkII;;;AAGAy/B,gCAAwB,GAAG,UAAU9qB,MAAV,EAAkB+qB,eAAlB,EAAmC;AAC1D,cAAI/X,EAAE,GAAGgN,OAAO,CAAClH,MAAR,CAAe,EAAf,EAAoB9Y,MAApB,CAAT;;AACA,cAAI+qB,eAAJ,EAAqB;AACjB/K,mBAAO,CAAClH,MAAR,CAAe9F,EAAf,EAAmB+X,eAAnB;AACH,WAJyD,CAM1D;;;AACA,cAAI/X,EAAE,CAAC+K,MAAP,EAAe;AACX,gBAAI/K,EAAE,CAAC+K,MAAH,CAAUY,QAAd,EAAwB;AACpB3L,gBAAE,CAACgY,cAAH,GAAoBhY,EAAE,CAAC+K,MAAvB;AACH,aAFD,MAGK;AACD/K,gBAAE,CAAC+K,MAAH,GAAYoJ,gBAAgB,CAACO,UAAjB,CAA4B1U,EAAE,CAAC+K,MAA/B,CAAZ;AACH;AACJ;;AACD,cAAI/K,EAAE,CAACxc,MAAP,EAAe;AACX,gBAAIwc,EAAE,CAACxc,MAAH,CAAUmoB,QAAd,EAAwB;AACpB3L,gBAAE,CAACiY,cAAH,GAAoBjY,EAAE,CAACxc,MAAvB;AACH,aAFD,MAGK;AACDwc,gBAAE,CAACxc,MAAH,GAAY2wB,gBAAgB,CAACO,UAAjB,CAA4B1U,EAAE,CAACxc,MAA/B,CAAZ;AACH;AACJ,WAtByD,CAwB1D;;;AACA,cAAIwJ,MAAM,CAACkrB,KAAX,EAAkB;AACdlY,cAAE,CAACgY,cAAH,GAAoBT,YAAY,CAACvqB,MAAM,CAACkrB,KAAP,CAAa,CAAb,CAAD,CAAhC;AACAlY,cAAE,CAACiY,cAAH,GAAoBV,YAAY,CAACvqB,MAAM,CAACkrB,KAAP,CAAa,CAAb,CAAD,CAAhC;AACH,WA5ByD,CA8B1D;AACA;;;AACA,cAAIlY,EAAE,CAACgY,cAAH,IAAqBhY,EAAE,CAACgY,cAAH,CAAkBG,MAAlB,EAAzB,EAAqD;AACjD3L,eAAG,CAACpvB,GAAJ,CAAQ+2B,gBAAR,EAA0B,mDAA1B;;AACA;AACH,WAnCyD,CAqC1D;;;AACA,cAAInU,EAAE,CAACiY,cAAH,IAAqBjY,EAAE,CAACiY,cAAH,CAAkBE,MAAlB,EAAzB,EAAqD;AACjD3L,eAAG,CAACpvB,GAAJ,CAAQ+2B,gBAAR,EAA0B,mDAA1B;;AACA;AACH,WAzCyD,CA2C1D;;;AACA,cAAI,CAACnU,EAAE,CAACpW,IAAJ,IAAYoW,EAAE,CAACgY,cAAnB,EAAmC;AAC/BhY,cAAE,CAACpW,IAAH,GAAUoW,EAAE,CAACgY,cAAH,CAAkBI,cAA5B;AACH,WA9CyD,CAgD1D;AACA;;;AACA,cAAIpY,EAAE,CAACgY,cAAH,IAAqBhY,EAAE,CAACgY,cAAH,CAAkBK,iBAA3C,EAA8D;AAC1DrY,cAAE,CAACkP,QAAH,GAAclP,EAAE,CAACkP,QAAH,IAAe,EAA7B;;AACA,iBAAK,IAAI53B,CAAC,GAAG,CAAR,EAAWqB,CAAC,GAAGqnB,EAAE,CAACgY,cAAH,CAAkBK,iBAAlB,CAAoCrhC,MAAxD,EAAgEM,CAAC,GAAGqB,CAApE,EAAuErB,CAAC,EAAxE,EAA4E;AACxE0oB,gBAAE,CAACkP,QAAH,CAAYlzB,IAAZ,CAAiBgkB,EAAE,CAACgY,cAAH,CAAkBK,iBAAlB,CAAoC/gC,CAApC,CAAjB;AACH;AACJ,WAvDyD,CAyD1D;;;AACA,cAAI0oB,EAAE,CAACgY,cAAH,IAAqBhY,EAAE,CAACgY,cAAH,CAAkB/jB,KAA3C,EAAkD;AAC9C+L,cAAE,CAAC/L,KAAH,GAAW+L,EAAE,CAACgY,cAAH,CAAkB/jB,KAA7B;AACH,WA5DyD,CA8D1D;;;AACA,cAAI,CAAC+L,EAAE,CAAC,gBAAD,CAAH,IAAyBA,EAAE,CAACgY,cAA5B,IAA8ChY,EAAE,CAACgY,cAAH,CAAkBM,sBAApE,EAA4F;AACxFtY,cAAE,CAAC,gBAAD,CAAF,GAAuBA,EAAE,CAACgY,cAAH,CAAkBM,sBAAzC;AACH;;AAGD,cAAIC,YAAY,GAAG,SAAfA,YAAe,CAAU7zB,EAAV,EAAc4iB,GAAd,EAAmBxb,GAAnB,EAAwB;AACvC,gBAAIkB,MAAM,GAAG6qB,eAAe,CAACvQ,GAAD,EAAM;AAC9BmE,oBAAM,EAAEzL,EAAE,CAACwY,OAAH,GAAaxY,EAAE,CAACwY,OAAH,CAAW1sB,GAAX,CAAb,GAA+BkU,EAAE,CAACyL,MADZ;AAE9BE,sBAAQ,EAAE3L,EAAE,CAACoM,SAAH,GAAepM,EAAE,CAACoM,SAAH,CAAatgB,GAAb,CAAf,GAAmCkU,EAAE,CAAC2L,QAFlB;AAG9BkB,wBAAU,EAAE7M,EAAE,CAACyY,cAAH,GAAoBzY,EAAE,CAACyY,cAAH,CAAkB3sB,GAAlB,CAApB,GAA6CkU,EAAE,CAAC0Y,aAH9B;AAI9B5L,6BAAe,EAAE9M,EAAE,CAAC2Y,mBAAH,GAAyB3Y,EAAE,CAAC2Y,mBAAH,CAAuB7sB,GAAvB,CAAzB,GAAuDkU,EAAE,CAAC4Y;AAJ7C,aAAN,CAA5B;;AAMA,mBAAOzE,gBAAgB,CAAC0E,WAAjB,CAA6Bn0B,EAA7B,EAAiCsI,MAAjC,CAAP;AACH,WARD,CApE0D,CA8E1D;;;AAEA,cAAI8rB,cAAc,GAAG,SAAjBA,cAAiB,CAAUlvB,IAAV,EAAgBkC,GAAhB,EAAqBitB,IAArB,EAA2BC,SAA3B,EAAsC;AACvD,gBAAIhZ,EAAE,CAACpW,IAAD,CAAF,IAAY,CAACoW,EAAE,CAACpW,IAAD,CAAF,CAAS+hB,QAAtB,IAAkC,CAAC3L,EAAE,CAACpW,IAAI,GAAG,UAAR,CAArC,IAA4D,CAACoW,EAAE,CAACiZ,aAApE,EAAmF;AAC/E,kBAAIhL,GAAG,GAAG0G,MAAM,CAAC3U,EAAE,CAACpW,IAAD,CAAH,CAAhB;AAAA,kBAA4BsvB,GAAG,GAAGH,IAAI,CAAC9K,GAAD,CAAtC;;AAEAiL,iBAAG,GAAGA,GAAG,GAAGA,GAAG,CAACF,SAAD,CAAN,GAAoB,IAA7B;;AAEA,kBAAIE,GAAJ,EAAS;AACL;AACA,oBAAI,CAACA,GAAG,CAAC7kB,OAAT,EAAkB;AACd,yBAAO,KAAP;AACH;;AAED,oBAAI8kB,KAAK,GAAGnM,OAAO,CAAClH,MAAR,CAAe,EAAf,EAAmBoT,GAAG,CAAC5R,GAAvB,CAAZ;AACA,uBAAO6R,KAAK,CAACC,KAAb;AAEA,oBAAIC,WAAW,GAAGH,GAAG,CAACvN,QAAJ,IAAgB,IAAhB,IAAwBuN,GAAG,CAACvN,QAAJ,CAAaiB,QAArC,GAAgDsM,GAAG,CAACvN,QAApD,GAA+D4M,YAAY,CAACvY,EAAE,CAACpW,IAAD,CAAH,EAAWuvB,KAAX,EAAkBrtB,GAAlB,CAA7F;;AACA,oBAAIutB,WAAW,CAAClB,MAAZ,EAAJ,EAA0B;AACtB,yBAAO,KAAP;AACH;;AACDnY,kBAAE,CAACpW,IAAI,GAAG,UAAR,CAAF,GAAwByvB,WAAxB;;AACA,oBAAI,CAACrZ,EAAE,CAAC/L,KAAJ,IAAaklB,KAAK,CAACllB,KAAvB,EAA8B;AAC1B+L,oBAAE,CAAC/L,KAAH,GAAWklB,KAAK,CAACllB,KAAjB;AACH,iBAhBI,CAgBH;;;AACF,oBAAIilB,GAAG,CAACI,cAAR,EAAwB;AACpB,sBAAI,CAACJ,GAAG,CAACvN,QAAT,EAAmB;AACfuN,uBAAG,CAACvN,QAAJ,GAAe0N,WAAf;AACAA,+BAAW,CAACE,gBAAZ,CAA6B,KAA7B;AACH,mBAHD,MAIK;AACDF,+BAAW,CAACG,aAAZ,GAA4BN,GAAG,CAACvN,QAAhC;AACH;AACJ,iBARD,MAQO;AACH0N,6BAAW,CAACE,gBAAZ,CAA6B,IAA7B;AACH,iBA3BI,CA6BL;AACA;AACA;;;AACA,oBAAIztB,GAAG,KAAK,CAAR,IAAaotB,GAAG,CAAC5R,GAAJ,CAAQ+Q,iBAAzB,EAA4C;AACxCrY,oBAAE,CAACkP,QAAH,GAAclP,EAAE,CAACkP,QAAH,IAAe,EAA7B;AACA9qB,uBAAK,CAACjD,SAAN,CAAgBnF,IAAhB,CAAqB2C,KAArB,CAA2BqhB,EAAE,CAACkP,QAA9B,EAAwCgK,GAAG,CAAC5R,GAAJ,CAAQ+Q,iBAAhD;AACH;AACJ;AACJ;AACJ,WA5CD;;AA8CA,cAAIS,cAAc,CAAC,QAAD,EAAW,CAAX,EAAc,KAAKW,yBAAnB,EAA8CzZ,EAAE,CAACpW,IAAH,IAAW,SAAzD,CAAd,KAAsF,KAA1F,EAAiG;AAC7F;AACH;;AACD,cAAIkvB,cAAc,CAAC,QAAD,EAAW,CAAX,EAAc,KAAKY,yBAAnB,EAA8C1Z,EAAE,CAACpW,IAAH,IAAW,SAAzD,CAAd,KAAsF,KAA1F,EAAiG;AAC7F;AACH,WAnIyD,CAqI1D;;;AACA,cAAIoW,EAAE,CAACgY,cAAH,IAAqBhY,EAAE,CAACiY,cAA5B,EAA4C;AACxC,gBAAI,CAACT,WAAW,CAACxX,EAAE,CAACgY,cAAJ,EAAoBhY,EAAE,CAACiY,cAAvB,CAAhB,EAAwD;AACpDjY,gBAAE,GAAG,IAAL;AACH;AACJ;;AAED,iBAAOA,EAAP;AACH,SA7I0B,CA6IzBxH,IA7IyB,CA6IpB2b,gBA7IoB,CArI/B;AAAA,YAoRIwF,cAAc,GAAG,SAAjBA,cAAiB,CAAU3sB,MAAV,EAAkB;AAC/B,cAAI4sB,cAAc,GAAGzF,gBAAgB,CAACtF,QAAjB,CAA0BgL,cAA1B,IAA4C1F,gBAAgB,CAAC2F,wBAAjB,EAAjE;;AAEA9sB,gBAAM,CAAC4f,QAAP,GAAkBuH,gBAAlB;AACAnnB,gBAAM,CAACisB,aAAP,GAAuBU,cAAvB;AACA3sB,gBAAM,CAACqsB,WAAP,GAAqBU,YAArB;AACA/sB,gBAAM,CAACipB,eAAP,GAAyBA,eAAzB;AACAjpB,gBAAM,CAACgpB,kBAAP,GAA4BA,kBAA5B;AACAhpB,gBAAM,CAACgtB,kBAAP,GAA4BC,mBAA5B;AACAjtB,gBAAM,CAACqV,EAAP,GAAY,SAASsU,QAAQ,EAA7B;AACA,cAAIuD,GAAG,GAAG,IAAIN,cAAJ,CAAmB5sB,MAAnB,CAAV,CAV+B,CAY/B;AACA;;AACA,cAAIktB,GAAG,CAACC,YAAJ,EAAJ,EAAwB;AACpBD,eAAG,CAAC9N,SAAJ,CAAc,CAAd,EAAiBgO,aAAjB,CAA+B,gBAA/B;AACAF,eAAG,CAAC9N,SAAJ,CAAc,CAAd,EAAiBgO,aAAjB,CAA+B,gBAA/B;AACH;;AAED,iBAAOF,GAAP;AACH,SAxSL;AAAA,YA0SI;AACA;AACA;AACAD,2BAAmB,GAAG9F,gBAAgB,CAAC6F,kBAAjB,GAAsC,UAAUK,GAAV,EAAertB,MAAf,EAAuBc,aAAvB,EAAsCwsB,qBAAtC,EAA6D;AACrHttB,gBAAM,GAAGA,MAAM,IAAI,EAAnB,CADqH,CAErH;;AACA,cAAI,CAACqtB,GAAG,CAACE,iBAAT,EAA4B;AACxBxE,uBAAW,CAAC/5B,IAAZ,CAAiBq+B,GAAjB;AACH;;AAEDA,aAAG,CAACG,OAAJ,GAAc,IAAd,CAPqH,CASrH;;AACAH,aAAG,CAACjO,SAAJ,CAAc,CAAd,EAAiBqO,iBAAjB,GAAqC,KAArC,CAVqH,CAYrH;AACA;AACA;AACA;;AACA,cAAIH,qBAAqB,KAAK,KAA9B,EAAqC;AACjCnG,4BAAgB,CAACuG,MAAjB,CAAwBzB,aAAxB,CAAsCoB,GAAtC;AACH,WAlBoH,CAoBrH;;;AACAvD,eAAK,CAACuD,GAAG,CAACtP,MAAL,CAAL,CArBqH,CAuBrH;;;AACA,cAAI,CAAC/d,MAAM,CAAC2tB,wBAAR,IAAoC3tB,MAAM,CAACsC,SAAP,KAAqB,KAA7D,EAAoE;AAEhE,gBAAIsrB,SAAS,GAAG;AACZhL,wBAAU,EAAEyK,GADA;AAEZtP,oBAAM,EAAEsP,GAAG,CAACtP,MAFA;AAEQvnB,oBAAM,EAAE62B,GAAG,CAAC72B,MAFpB;AAGZssB,sBAAQ,EAAEuK,GAAG,CAACvK,QAHF;AAGYC,sBAAQ,EAAEsK,GAAG,CAACtK,QAH1B;AAIZiI,4BAAc,EAAEqC,GAAG,CAACjO,SAAJ,CAAc,CAAd,CAJJ;AAIsB6L,4BAAc,EAAEoC,GAAG,CAACjO,SAAJ,CAAc,CAAd;AAJtC,aAAhB;;AAOA+H,4BAAgB,CAACtL,IAAjB,CAAsB,YAAtB,EAAoC+R,SAApC,EAA+C9sB,aAA/C;AACH;AACJ,SAhVL;;AAkVI;;;;AAIAisB,oBAAY,GAAG,SAAfA,YAAe,CAAU/sB,MAAV,EAAkBqV,EAAlB,EAAsB;AACjC,cAAIwY,YAAY,GAAG1G,gBAAgB,CAACtF,QAAjB,CAA0BiM,YAA1B,IAA0C9N,OAAO,CAAC8F,QAArE;;AACA,cAAI9S,EAAE,GAAGgN,OAAO,CAAClH,MAAR,CAAe,EAAf,EAAmB9Y,MAAnB,CAAT,CAFiC,CAGjC;;;AACAgT,YAAE,CAAC4M,QAAH,GAAcuH,gBAAd;AACAnU,YAAE,CAACiZ,aAAH,GAAmBU,cAAnB;AACA3Z,YAAE,CAACqZ,WAAH,GAAiBU,YAAjB;AACA/Z,YAAE,CAACiW,eAAH,GAAqBA,eAArB;AACAjW,YAAE,CAACgW,kBAAH,GAAwBA,kBAAxB;AACAhW,YAAE,CAAC+a,eAAH,GAAqBA,eAArB;AACA/a,YAAE,CAACgb,SAAH,GAAe3Y,EAAE,IAAIsS,MAAM,CAAC3U,EAAE,CAAC+K,MAAJ,CAA3B;AACA,cAAIf,EAAE,GAAG,IAAI6Q,YAAJ,CAAiB7a,EAAjB,CAAT;AACAgK,YAAE,CAAC3H,EAAH,GAAQ,QAAQsU,QAAQ,EAAxB;;AACAsE,iBAAO,CAACjb,EAAE,CAACgb,SAAJ,EAAehb,EAAE,CAAC+K,MAAlB,CAAP;;AAEA,cAAI,CAACiC,OAAO,CAACkO,QAAb,EAAuB;AACnB/G,4BAAgB,CAACgH,cAAjB,GAAkCC,aAAlC,CAAgDpb,EAAE,CAAC+K,MAAnD,EAA2D1I,EAA3D;AACH;;AAED,iBAAO2H,EAAP;AACH,SA1WL;;AA4WI;;;;;;;AAOAqR,kBAAU,GAAG,SAAbA,UAAa,CAAUrP,IAAV,EAAgBsP,IAAhB,EAAsBT,YAAtB,EAAoC;AAC7C,cAAIzO,SAAS,GAAG4J,kBAAkB,CAAChK,IAAD,CAAlC;;AACA,cAAII,SAAS,IAAIA,SAAS,CAACp1B,MAA3B,EAAmC;AAC/B,iBAAK,IAAIM,CAAC,GAAG,CAAR,EAAWikC,EAAE,GAAGnP,SAAS,CAACp1B,MAA/B,EAAuCM,CAAC,GAAGikC,EAA3C,EAA+CjkC,CAAC,EAAhD,EAAoD;AAChD,mBAAK,IAAIqB,CAAC,GAAG,CAAR,EAAW6iC,EAAE,GAAGpP,SAAS,CAAC90B,CAAD,CAAT,CAAay+B,WAAb,CAAyB/+B,MAA9C,EAAsD2B,CAAC,GAAG6iC,EAA1D,EAA8D7iC,CAAC,EAA/D,EAAmE;AAC/D,oBAAIilB,MAAM,GAAG0d,IAAI,CAAClP,SAAS,CAAC90B,CAAD,CAAT,CAAay+B,WAAb,CAAyBp9B,CAAzB,CAAD,CAAjB,CAD+D,CAE/D;AACA;;AACA,oBAAIilB,MAAJ,EAAY;AACR;AACH;AACJ;;AACD,kBAAIid,YAAJ,EAAkB;AACdA,4BAAY,CAACzO,SAAS,CAAC90B,CAAD,CAAV,CAAZ;AACH;AACJ;AACJ;AACJ,SApYL;AAAA,YAsYImkC,aAAa,GAAG,SAAhBA,aAAgB,CAAU1E,OAAV,EAAmB3kB,SAAnB,EAA8B;AAC1C,iBAAO4a,OAAO,CAAC/F,IAAR,CAAa8P,OAAb,EAAsB,UAAUryB,EAAV,EAAc;AACvC,gBAAIyvB,gBAAgB,CAACuH,eAAjB,CAAiCh3B,EAAjC,CAAJ,EAA0C;AACtC0xB,6BAAe,CAACjC,gBAAgB,CAACzsB,YAAjB,CAA8BhD,EAA9B,EAAkC,IAAlC,CAAD,CAAf,GAA2D0N,SAA3D;;AACA+hB,8BAAgB,CAACwH,mBAAjB,CAAqCj3B,EAArC,EAAyC0N,SAAzC;AACH;AACJ,WALM,CAAP;AAMH,SA7YL;;AA8YI;;;;;;;;;;AAUAwpB,mBAAW,GAAG,SAAdA,WAAc,CAAUl3B,EAAV,EAAcse,KAAd,EAAqB6Y,mBAArB,EAA0C;AACpD7Y,eAAK,GAAGA,KAAK,KAAK,OAAlB;AACA,cAAI6X,YAAY,GAAG,IAAnB;;AACA,cAAIgB,mBAAJ,EAAyB;AACrBhB,wBAAY,GAAG,sBAAU7Q,EAAV,EAAc;AACzBA,gBAAE,CAAC8R,UAAH,CAAc9Y,KAAd,EAAqB,IAArB,EAA2B,IAA3B;AACH,aAFD;AAGH;;AACD,cAAI+Y,IAAI,GAAGxH,KAAK,CAAC7vB,EAAD,CAAhB;;AACA22B,oBAAU,CAACU,IAAI,CAAC1Z,EAAN,EAAU,UAAUgY,GAAV,EAAe;AAC/B,gBAAIrX,KAAK,IAAI6Y,mBAAb,EAAkC;AAC9B;AACA;AACA,kBAAIG,IAAI,GAAG3B,GAAG,CAACvK,QAAJ,KAAiBiM,IAAI,CAAC1Z,EAAtB,GAA2B,CAA3B,GAA+B,CAA1C;;AACA,kBAAIgY,GAAG,CAACjO,SAAJ,CAAc4P,IAAd,EAAoBC,SAApB,EAAJ,EAAqC;AACjC5B,mBAAG,CAACyB,UAAJ,CAAe,IAAf;AACH;AACJ,aAPD,MAQK;AAAE;AACHzB,iBAAG,CAACyB,UAAJ,CAAe9Y,KAAf;AACH;AACJ,WAZS,EAYP6X,YAZO,CAAV;AAaH,SA9aL;;AA+aI;;;AAGAqB,sBAAc,GAAG,SAAjBA,cAAiB,CAAUlQ,IAAV,EAAgBmQ,eAAhB,EAAiC;AAC9C,cAAItB,YAAY,GAAG,IAAnB;;AACA,cAAIsB,eAAJ,EAAqB;AACjBtB,wBAAY,GAAG,sBAAU7Q,EAAV,EAAc;AACzB,kBAAIhH,KAAK,GAAGgH,EAAE,CAACiS,SAAH,EAAZ;AACAjS,gBAAE,CAAC8R,UAAH,CAAc,CAAC9Y,KAAf;AACH,aAHD;AAIH;;AACDqY,oBAAU,CAACrP,IAAD,EAAO,UAAUqO,GAAV,EAAe;AAC5B,gBAAIrX,KAAK,GAAGqX,GAAG,CAAC4B,SAAJ,EAAZ;AACA5B,eAAG,CAACyB,UAAJ,CAAe,CAAC9Y,KAAhB;AACH,WAHS,EAGP6X,YAHO,CAAV;AAIH,SA9bL;AAAA,YAgcI;AACAuB,sBAAc,GAAG,SAAjBA,cAAiB,CAAUpQ,IAAV,EAAgB;AAC7B,cAAIxL,CAAC,GAAG0V,OAAO,CAAClK,IAAD,CAAf;;AACA,cAAI,CAACxL,CAAL,EAAQ;AACJ,mBAAO2W,aAAa,CAAC;AAACnL,kBAAI,EAAEA;AAAP,aAAD,CAApB;AACH,WAFD,MAGK;AACD,mBAAO;AAACxL,eAAC,EAAEA,CAAJ;AAAOnqB,eAAC,EAAEigC,KAAK,CAACtK,IAAD;AAAf,aAAP;AACH;AACJ,SAzcL;;AA2cI;;;;;;;;;;AAUA2I,cAAM,GAAG,SAATA,MAAS,CAAUoC,OAAV,EAAmB3iB,IAAnB,EAAyBioB,qBAAzB,EAAgD;AACrD,cAAI7P,GAAG,CAACpJ,QAAJ,CAAa2T,OAAb,CAAJ,EAA2B;AACvB,mBAAOA,OAAP;AACH;;AACD,cAAIA,OAAO,IAAI,IAAf,EAAqB;AACjB,mBAAO,IAAP;AACH;;AACD,cAAI1U,EAAE,GAAG8R,gBAAgB,CAACzsB,YAAjB,CAA8BqvB,OAA9B,EAAuC,IAAvC,CAAT;;AACA,cAAI,CAAC1U,EAAD,IAAOA,EAAE,KAAK,WAAlB,EAA+B;AAC3B;AACA,gBAAIhe,SAAS,CAACrN,MAAV,KAAqB,CAArB,IAA0BqN,SAAS,CAAC,CAAD,CAAT,KAAiBi4B,SAA/C,EAA0D;AACtDja,gBAAE,GAAGjO,IAAL;AACH,aAFD,MAGK,IAAI/P,SAAS,CAACrN,MAAV,KAAqB,CAArB,IAA2BqN,SAAS,CAACrN,MAAV,KAAqB,CAArB,IAA0B,CAACqN,SAAS,CAAC,CAAD,CAAnE,EAAyE;AAC1Ege,gBAAE,GAAG,aAAa+R,cAAb,GAA8B,GAA9B,GAAoCuC,QAAQ,EAAjD;AACH;;AAED,gBAAI,CAAC0F,qBAAL,EAA4B;AACxBlI,8BAAgB,CAACxsB,YAAjB,CAA8BovB,OAA9B,EAAuC,IAAvC,EAA6C1U,EAA7C;AACH;AACJ;;AACD,iBAAOA,EAAP;AACH,SA3eL;;AA6eA,aAAKka,yBAAL,GAAiC,UAAUrmC,CAAV,EAAa;AAC1CmgC,gCAAsB,GAAGngC,CAAzB;AACH,SAFD;;AAGA,aAAKsmC,wBAAL,GAAgC,YAAY;AACxC,iBAAOnG,sBAAP;AACH,SAFD;AAIA;;;;;;AAIA,aAAKoG,kBAAL,GAA0B,YAAW;AACjC,iBAAO9G,eAAP;AACH,SAFD;;AAIA,aAAK+G,cAAL,GAAsB,eAAtB;AACA,aAAKC,qBAAL,GAA6B,uBAA7B;AACA,aAAKC,cAAL,GAAsB,eAAtB;AACA,aAAK9d,UAAL,GAAkB,WAAlB;AACA,aAAK+d,aAAL,GAAqB,cAArB;AACA,aAAKC,sBAAL,GAA8B,wBAA9B;AACA,aAAKC,iBAAL,GAAyB,mBAAzB;AACA,aAAKC,wBAAL,GAAgC,2BAAhC;AACA,aAAKC,0BAAL,GAAkC,6BAAlC;AACA,aAAKC,YAAL,GAAoB,aAApB;AACA,aAAKC,aAAL,GAAqB,cAArB,CAtsB8D,CAssB1B;;AACpC,aAAKC,oBAAL,GAA4B,sBAA5B,CAvsB8D,CAusBX;;AACnD,aAAKC,0BAAL,GAAkC,6BAAlC,CAxsB8D,CAwsBG;;AACjE,aAAKC,0BAAL,GAAkC,6BAAlC,CAzsB8D,CAysBE;;AAChE,aAAKC,yBAAL,GAAiC,qBAAjC;AACA,aAAKC,gBAAL,GAAwB,kBAAxB;AACA,aAAKC,gBAAL,GAAwB,kBAAxB;AACA,aAAKC,eAAL,GAAuB,iBAAvB;AAEA,aAAKpL,OAAL,GAAe,EAAf;AACA,aAAKqL,UAAL,GAAkB;AAAG,iBAAO;AAAV,SAAlB;AACA,aAAK3K,SAAL,GAAiB;AAAE,iBAAO;AAAT,SAAjB;AACA,aAAKU,QAAL,GAAgB;AAAE,iBAAO;AAAT,SAAhB;AACA,aAAKkK,kBAAL,GAA0B,EAA1B;AACA,aAAKC,GAAL,GAAW,KAAX,CAptB8D,CAstBtE;;AAGQ,aAAKhF,WAAL,GAAmB,UAAUn0B,EAAV,EAAcsI,MAAd,EAAsB+qB,eAAtB,EAAuC;AACtDA,yBAAe,GAAGA,eAAe,IAAI,EAArC;AACA,cAAIh8B,CAAC,GAAGixB,OAAO,CAAClH,MAAR,CAAe,EAAf,EAAmBiS,eAAnB,CAAR;AACA/K,iBAAO,CAAClH,MAAR,CAAe/pB,CAAf,EAAkBiR,MAAlB;AACAjR,WAAC,CAAC4vB,QAAF,GAAa5vB,CAAC,CAAC4vB,QAAF,IAAcwI,gBAAgB,CAACtF,QAAjB,CAA0BiE,QAArD;AACA/2B,WAAC,CAAC8wB,UAAF,GAAe9wB,CAAC,CAAC8wB,UAAF,IAAgBsH,gBAAgB,CAACtF,QAAjB,CAA0BoE,aAAzD;AAEA,cAAI6K,OAAO,GAAG,EAAd;AAAA,cACIC,MAAM,GAAIvR,GAAG,CAACtJ,OAAJ,CAAYxe,EAAZ,KAAoBA,EAAE,CAAC1N,MAAH,IAAa,IAAb,IAAqB,CAACw1B,GAAG,CAACpJ,QAAJ,CAAa1e,EAAb,CAA3C,GAAgEA,EAAhE,GAAqE,CAAEA,EAAF,CADlF;;AAGA,eAAK,IAAIpN,CAAC,GAAG,CAAR,EAAWqB,CAAC,GAAGolC,MAAM,CAAC/mC,MAA3B,EAAmCM,CAAC,GAAGqB,CAAvC,EAA0CrB,CAAC,EAA3C,EAA+C;AAC3CyE,aAAC,CAACgvB,MAAF,GAAWoJ,gBAAgB,CAACO,UAAjB,CAA4BqJ,MAAM,CAACzmC,CAAD,CAAlC,CAAX;;AACA0mC,4BAAgB,CAACjiC,CAAC,CAACgvB,MAAH,CAAhB;;AAEA,gBAAI1I,EAAE,GAAGsS,MAAM,CAAC54B,CAAC,CAACgvB,MAAH,CAAf;AAAA,gBAA2BzlB,CAAC,GAAGy0B,YAAY,CAACh+B,CAAD,EAAIsmB,EAAJ,CAA3C,CAJ2C,CAM3C;;;AACA,gBAAI4b,QAAQ,GAAGhD,OAAO,CAAC5Y,EAAD,EAAKtmB,CAAC,CAACgvB,MAAP,EAAe,IAAf,EAAqB,CAACwL,eAAtB,CAAP,CAA8CwF,IAA9C,CAAmDvb,CAAlE;;AACAgM,eAAG,CAAC9G,SAAJ,CAAcsQ,kBAAd,EAAkC3T,EAAlC,EAAsC/c,CAAtC;;AAEA,gBAAI,CAACixB,eAAL,EAAsB;AAClBjxB,eAAC,CAAC44B,KAAF,CAAQ;AACJC,yBAAS,EAAE74B,CAAC,CAACmmB,MAAF,CAAS2S,OAAT,CAAiB;AAAEC,oBAAE,EAAE,CAAEJ,QAAQ,CAACplC,IAAX,EAAiBolC,QAAQ,CAACtxB,GAA1B,CAAN;AAAuC2xB,oBAAE,EAAEhI,KAAK,CAACjU,EAAD,CAAhD;AAAsD0U,yBAAO,EAAEzxB,CAA/D;AAAkE8nB,2BAAS,EAAEoJ;AAA7E,iBAAjB,CADP;AAEJpJ,yBAAS,EAAEoJ;AAFP,eAAR;AAIH;;AAEDsH,mBAAO,CAAC9hC,IAAR,CAAasJ,CAAb;AACH;;AAED,iBAAOw4B,OAAO,CAAC9mC,MAAR,KAAmB,CAAnB,GAAuB8mC,OAAO,CAAC,CAAD,CAA9B,GAAoCA,OAA3C;AACH,SA/BD;;AAiCA,aAAKS,YAAL,GAAoB,UAAU75B,EAAV,EAAc0nB,SAAd,EAAyB2L,eAAzB,EAA0C;AAC1D,cAAI+F,OAAO,GAAG,EAAd;;AACA,eAAK,IAAIxmC,CAAC,GAAG,CAAR,EAAWqB,CAAC,GAAGyzB,SAAS,CAACp1B,MAA9B,EAAsCM,CAAC,GAAGqB,CAA1C,EAA6CrB,CAAC,EAA9C,EAAkD;AAC9C,gBAAIgO,CAAC,GAAG6uB,gBAAgB,CAAC0E,WAAjB,CAA6Bn0B,EAA7B,EAAiC0nB,SAAS,CAAC90B,CAAD,CAA1C,EAA+CygC,eAA/C,CAAR;;AACA,gBAAIvL,GAAG,CAACtJ,OAAJ,CAAY5d,CAAZ,CAAJ,EAAoB;AAChBlB,mBAAK,CAACjD,SAAN,CAAgBnF,IAAhB,CAAqB2C,KAArB,CAA2Bm/B,OAA3B,EAAoCx4B,CAApC;AACH,aAFD,MAGK;AACDw4B,qBAAO,CAAC9hC,IAAR,CAAasJ,CAAb;AACH;AACJ;;AACD,iBAAOw4B,OAAP;AACH,SAZD;;AAcA,aAAKU,OAAL,GAAe,UAAU95B,EAAV,EAAc+5B,UAAd,EAA0BjU,OAA1B,EAAmC;AAC9C,cAAI,CAAC,KAAKkU,kBAAV,EAA8B;AAC1B,mBAAO,KAAP;AACH;;AAEDlU,iBAAO,GAAGA,OAAO,IAAI,EAArB;;AACA,cAAImU,GAAG,GAAGxK,gBAAgB,CAACO,UAAjB,CAA4BhwB,EAA5B,CAAV;AAAA,cACI2d,EAAE,GAAGsS,MAAM,CAACgK,GAAD,CADf;AAAA,cAEIC,YAAY,GAAG5R,OAAO,CAAC6R,UAAR,CAAmBC,IAFtC;AAAA,cAGIC,gBAAgB,GAAG/R,OAAO,CAAC6R,UAAR,CAAmBG,QAH1C;;AAKAxU,iBAAO,CAACoU,YAAD,CAAP,GAAwBpS,GAAG,CAACxE,IAAJ,CAASwC,OAAO,CAACoU,YAAD,CAAhB,EAAgC,YAAY;AAChEzK,4BAAgB,CAAC5H,UAAjB,CAA4BlK,EAA5B;AACH,WAFuB,CAAxB,CAX8C,CAe9C;;AACAmI,iBAAO,CAACuU,gBAAD,CAAP,GAA4BvS,GAAG,CAACxE,IAAJ,CAASwC,OAAO,CAACuU,gBAAD,CAAhB,EAAoC,YAAY;AACxE5K,4BAAgB,CAAC5H,UAAjB,CAA4BlK,EAA5B;AACH,WAF2B,CAA5B;;AAIA8R,0BAAgB,CAAC8K,SAAjB,CAA2BN,GAA3B,EAAgCF,UAAhC,EAA4CjU,OAA5C;AACH,SArBD;AAuBA;;;;;;;;;AAOA,aAAKyF,cAAL,GAAsB,UAAUiP,aAAV,EAAyBrX,IAAzB,EAA+B;AACjD,cAAI5hB,CAAC,GAAGkuB,gBAAgB,CAAC/K,WAAjB,CAA6B8V,aAA7B,CAAR;AAAA,cACIzgC,CAAC,GAAG,IADR;;AAGA,cAAIwH,CAAC,IAAIA,CAAC,CAACjP,MAAF,GAAW,CAApB,EAAuB;AACnB,gBAAIguB,MAAM,GAAG5gB,KAAK,CAACjD,SAAN,CAAgB3D,KAAhB,CAAsBsD,IAAtB,CAA2BuD,SAA3B,EAAsC,CAAtC,CAAb;;AACA,gBAAI;AACA,mBAAK,IAAI/M,CAAC,GAAG,CAAR,EAAWqB,CAAC,GAAGsN,CAAC,CAACjP,MAAtB,EAA8BM,CAAC,GAAGqB,CAAlC,EAAqCrB,CAAC,EAAtC,EAA0C;AACtCmH,iBAAC,GAAGA,CAAC,IAAIwH,CAAC,CAAC3O,CAAD,CAAD,CAAKqH,KAAL,CAAWsH,CAAC,CAAC3O,CAAD,CAAZ,EAAiB0tB,MAAjB,CAAT;AACH;AACJ,aAJD,CAKA,OAAO1f,CAAP,EAAU;AACNknB,iBAAG,CAACpvB,GAAJ,CAAQ+2B,gBAAR,EAA0B,6BAA6B+K,aAA7B,GAA6C,GAA7C,GAAmD55B,CAA7E;AACH;AACJ;;AACD,iBAAO7G,CAAP;AACH,SAhBD;;AAkBA,aAAK0gC,OAAL,GAAe,UAAUnyB,MAAV,EAAkB+qB,eAAlB,EAAmC;AAC9C;AACA,cAAI/X,EAAE,GAAG8X,wBAAwB,CAAC9qB,MAAD,EAAS+qB,eAAT,CAAjC;AAAA,cAA4DsC,GAA5D,CAF8C,CAG9C;AACA;AACA;;;AACA,cAAIra,EAAJ,EAAQ;AACJ,gBAAIA,EAAE,CAAC+K,MAAH,IAAa,IAAb,IAAqB/K,EAAE,CAACgY,cAAH,IAAqB,IAA9C,EAAoD;AAChDxL,iBAAG,CAACpvB,GAAJ,CAAQ,qDAAR;;AACA;AACH;;AACD,gBAAI4iB,EAAE,CAACxc,MAAH,IAAa,IAAb,IAAqBwc,EAAE,CAACiY,cAAH,IAAqB,IAA9C,EAAoD;AAChDzL,iBAAG,CAACpvB,GAAJ,CAAQ,qDAAR;;AACA;AACH;;AACD4gC,4BAAgB,CAAChe,EAAE,CAAC+K,MAAJ,CAAhB,CATI,CAUJ;;;AACAsP,eAAG,GAAGV,cAAc,CAAC3Z,EAAD,CAApB,CAXI,CAYJ;;AACAia,+BAAmB,CAACI,GAAD,EAAMra,EAAN,CAAnB;AACH;;AACD,iBAAOqa,GAAP;AACH,SAtBD;;AAwBA,YAAI+E,OAAO,GAAG,CACV;AAAE16B,YAAE,EAAE,QAAN;AAAgBsnB,cAAI,EAAE,UAAtB;AAAkCqT,gBAAM,EAAE;AAA1C,SADU,EAEV;AAAE36B,YAAE,EAAE,QAAN;AAAgBsnB,cAAI,EAAE,UAAtB;AAAkCqT,gBAAM,EAAE;AAA1C,SAFU,CAAd;;AAKA,YAAIC,IAAI,GAAG,UAAUznC,CAAV,EAAa6M,EAAb,EAAiBoH,GAAjB,EAAsB8hB,YAAtB,EAAoC;AAC3C,cAAI5D,EAAJ;AAAA,cAAQuV,GAAG,GAAGH,OAAO,CAACtzB,GAAD,CAArB;AAAA,cAA4B0zB,GAAG,GAAG3nC,CAAC,CAAC0nC,GAAG,CAACvT,IAAL,CAAnC;AAAA,cAA+CyT,GAAG,GAAG5nC,CAAC,CAAC0nC,GAAG,CAAC76B,EAAL,CAAtD;AAAA,cAAgEg7B,GAAhE;AAAA,cAAqEC,GAArE;AAAA,cACIC,WAAW,GAAG/nC,CAAC,CAACu0B,SAAF,CAAYtgB,GAAZ,CADlB;AAGA,cAAI+zB,SAAS,GAAG;AACZt7B,iBAAK,EAAEuH,GADK;AAEZg0B,4BAAgB,EAAEh0B,GAAG,KAAK,CAAR,GAAY0zB,GAAZ,GAAkB3nC,CAAC,CAACi4B,QAF1B;AAGZiQ,uBAAW,EAAEloC,CAAC,CAACi4B,QAHH;AAIZkQ,4BAAgB,EAAEl0B,GAAG,KAAK,CAAR,GAAY0zB,GAAZ,GAAkB3nC,CAAC,CAACk4B,QAJ1B;AAKZkQ,uBAAW,EAAEpoC,CAAC,CAACk4B,QALH;AAMZH,sBAAU,EAAE/3B;AANA,WAAhB;;AASA,cAAI6M,EAAE,CAACO,WAAH,KAAmB+nB,OAAO,CAAC8F,QAA/B,EAAyC;AACrC9I,cAAE,GAAGtlB,EAAL;AACAslB,cAAE,CAACkW,aAAH,CAAiBroC,CAAjB;AACA6M,cAAE,GAAGslB,EAAE,CAAC+M,OAAR;AACH,WAJD,MAKK;AACD2I,eAAG,GAAG/K,MAAM,CAACjwB,EAAD,CAAZ;AACAi7B,eAAG,GAAG,KAAKJ,GAAG,CAACF,MAAT,EAAiBK,GAAjB,CAAN;;AAEA,gBAAIA,GAAG,KAAK7nC,CAAC,CAAC0nC,GAAG,CAACvT,IAAL,CAAb,EAAyB;AACrBhC,gBAAE,GAAG,IAAL,CADqB,CACV;AACd,aAFD,MAGK,IAAI2V,GAAJ,EAAS;AACV,mBAAK,IAAItoC,CAAT,IAAcsoC,GAAd,EAAmB;AACf,oBAAI,CAACA,GAAG,CAACtoC,CAAD,CAAH,CAAOgd,OAAZ,EAAqB;AACjB;AACH;;AACD2V,kBAAE,GAAG2V,GAAG,CAACtoC,CAAD,CAAH,CAAOs0B,QAAP,IAAmB,IAAnB,IAA2BgU,GAAG,CAACtoC,CAAD,CAAH,CAAOs0B,QAAP,CAAgBiB,QAA3C,GAAsD+S,GAAG,CAACtoC,CAAD,CAAH,CAAOs0B,QAA7D,GAAwE,KAAKkN,WAAL,CAAiBn0B,EAAjB,EAAqBi7B,GAAG,CAACtoC,CAAD,CAAH,CAAOiwB,GAA5B,CAA7E;;AACA,oBAAIqY,GAAG,CAACtoC,CAAD,CAAH,CAAOiiC,cAAX,EAA2B;AACvBqG,qBAAG,CAACtoC,CAAD,CAAH,CAAOs0B,QAAP,GAAkB3B,EAAlB;AACH;;AACDA,kBAAE,CAACkW,aAAH,CAAiBroC,CAAjB;AACH;AACJ,aAXI,MAYA;AACDmyB,gBAAE,GAAGnyB,CAAC,CAACsoC,YAAF,CAAer0B,GAAG,KAAK,CAAvB,EAA0BpH,EAA1B,EAA8Bg7B,GAA9B,CAAL;AACH;AACJ;;AAED,cAAI1V,EAAE,IAAI,IAAV,EAAgB;AACZ4V,uBAAW,CAACQ,oBAAZ,CAAiCvoC,CAAjC;AACAA,aAAC,CAACu0B,SAAF,CAAYtgB,GAAZ,IAAmBke,EAAnB;AACAnyB,aAAC,CAAC0nC,GAAG,CAAC76B,EAAL,CAAD,GAAYslB,EAAE,CAAC+M,OAAf;AACAl/B,aAAC,CAAC0nC,GAAG,CAACvT,IAAL,CAAD,GAAchC,EAAE,CAACgR,SAAjB;AACA6E,qBAAS,CAAC/zB,GAAG,KAAK,CAAR,GAAY,aAAZ,GAA4B,aAA7B,CAAT,GAAuDke,EAAE,CAACgR,SAA1D;AAEAqF,yBAAa,CAACR,SAAD,CAAb;;AAEA,gBAAI,CAACjS,YAAL,EAAmB;AACf/1B,eAAC,CAACu2B,OAAF;AACH;AACJ;;AAEDyR,mBAAS,CAAC9I,OAAV,GAAoBryB,EAApB;AACA,iBAAOm7B,SAAP;AAEH,SA3DU,CA2DTrnB,IA3DS,CA2DJ,IA3DI,CAAX;;AA6DA,aAAK8nB,SAAL,GAAiB,UAAU1Q,UAAV,EAAsBlrB,EAAtB,EAA0BkpB,YAA1B,EAAwC;AACrD,cAAI7xB,CAAC,GAAGujC,IAAI,CAAC1P,UAAD,EAAalrB,EAAb,EAAiB,CAAjB,EAAoBkpB,YAApB,CAAZ;;AACA,eAAK8M,MAAL,CAAY6F,qBAAZ,CAAkCxkC,CAAC,CAAC+jC,gBAApC,EAAsD/jC,CAAC,CAACgkC,WAAxD,EAAqEnQ,UAArE,EAAiF7zB,CAAC,CAAC2I,EAAnF,EAAuF,CAAvF;AACH,SAHD;;AAIA,aAAK87B,SAAL,GAAiB,UAAU5Q,UAAV,EAAsBlrB,EAAtB,EAA0BkpB,YAA1B,EAAwC;AACrD,cAAI7xB,CAAC,GAAGujC,IAAI,CAAC1P,UAAD,EAAalrB,EAAb,EAAiB,CAAjB,EAAoBkpB,YAApB,CAAZ;;AACA,eAAK8M,MAAL,CAAY6F,qBAAZ,CAAkCxkC,CAAC,CAACikC,gBAApC,EAAsDjkC,CAAC,CAACkkC,WAAxD,EAAqErQ,UAArE,EAAiF7zB,CAAC,CAAC2I,EAAnF,EAAuF,CAAvF;AACH,SAHD;;AAKA,aAAK+7B,cAAL,GAAsB,UAAUC,MAAV,EAAkBC,eAAlB,EAAmCC,qBAAnC,EAA0D;AAC5E,cAAIjV,QAAQ,GAAI,OAAO+U,MAAP,KAAkB,QAAnB,GAA+BzK,eAAe,CAACyK,MAAD,CAA9C,GAAyDA,MAAxE;;AACA,cAAI/U,QAAJ,EAAc;AACVwI,4BAAgB,CAAC0M,YAAjB,CAA8B;AAAElV,sBAAQ,EAAEA,QAAZ;AAAsBgV,6BAAe,EAAEA,eAAvC;AAAwDC,mCAAqB,EAACA;AAA9E,aAA9B;AACH;;AACD,iBAAOzM,gBAAP;AACH,SAND;;AAQA,aAAK2M,mBAAL,GAA2B,YAAY;AACnC,cAAIC,GAAG,GAAG5M,gBAAgB,CAAC6M,iBAAjB,CAAmC,IAAnC,CAAV;;AACA,eAAK,IAAI3e,EAAT,IAAe2T,kBAAf,EAAmC;AAC/B,gBAAI5J,SAAS,GAAG4J,kBAAkB,CAAC3T,EAAD,CAAlC;;AACA,gBAAI+J,SAAS,IAAIA,SAAS,CAACp1B,MAA3B,EAAmC;AAC/B,mBAAK,IAAIM,CAAC,GAAG,CAAR,EAAWqB,CAAC,GAAGyzB,SAAS,CAACp1B,MAA9B,EAAsCM,CAAC,GAAGqB,CAA1C,EAA6CrB,CAAC,EAA9C,EAAkD;AAC9C68B,gCAAgB,CAACsM,cAAjB,CAAgCrU,SAAS,CAAC90B,CAAD,CAAzC,EAA8C,IAA9C;AACH;AACJ;AACJ;;AACD0+B,4BAAkB,GAAG,EAArB;AACAL,yBAAe,GAAG,EAAlB;AACAM,yBAAe,GAAG,EAAlB;AACAC,iBAAO,GAAG,EAAV;AACAC,0BAAgB,GAAG,EAAnB;;AACAhC,0BAAgB,CAACuG,MAAjB,CAAwB1Y,KAAxB;;AACA,cAAIif,EAAE,GAAG9M,gBAAgB,CAACgH,cAAjB,EAAT;;AACA,cAAI8F,EAAJ,EAAQ;AACJA,cAAE,CAACjf,KAAH;AACH;;AACD,cAAI,CAAC+e,GAAL,EAAU;AACN5M,4BAAgB,CAAC6M,iBAAjB,CAAmC,KAAnC;AACH;;AACD,iBAAO7M,gBAAP;AACH,SAxBD;;AA0BA,YAAI4G,eAAe,GAAG,SAAlBA,eAAkB,CAAUV,GAAV,EAAe6G,WAAf,EAA4BpzB,aAA5B,EAA2C;AAC7D;AACA,cAAIqzB,QAAQ,GAAGhN,gBAAgB,CAACtF,QAAjB,CAA0BgL,cAA1B,IAA4C1F,gBAAgB,CAAC2F,wBAAjB,EAA3D;AAAA,cACIsH,eAAe,GAAG/G,GAAG,CAACp1B,WAAJ,KAAoBk8B,QAD1C;AAAA,cAEIn0B,MAAM,GAAGo0B,eAAe,GAAG;AACvBxR,sBAAU,EAAEyK,GADW;AAEvBtP,kBAAM,EAAEsP,GAAG,CAACtP,MAFW;AAEHvnB,kBAAM,EAAE62B,GAAG,CAAC72B,MAFT;AAGvBssB,oBAAQ,EAAEuK,GAAG,CAACvK,QAHS;AAGCC,oBAAQ,EAAEsK,GAAG,CAACtK,QAHf;AAIvBiI,0BAAc,EAAEqC,GAAG,CAACjO,SAAJ,CAAc,CAAd,CAJO;AAIW6L,0BAAc,EAAEoC,GAAG,CAACjO,SAAJ,CAAc,CAAd;AAJ3B,WAAH,GAKpBiO,GAPR;;AASA,cAAI6G,WAAJ,EAAiB;AACb/M,4BAAgB,CAACtL,IAAjB,CAAsB,oBAAtB,EAA4C7b,MAA5C,EAAoDc,aAApD;AACH,WAb4D,CAe7D;;;AACAqmB,0BAAgB,CAACtL,IAAjB,CAAsB,6BAAtB,EAAqD7b,MAArD,EAA6Dc,aAA7D;;AAEAqmB,0BAAgB,CAACuG,MAAjB,CAAwB2G,kBAAxB,CAA2Cr0B,MAA3C;AACH,SAnBD;;AAqBA,YAAIqzB,aAAa,GAAGlM,gBAAgB,CAACkM,aAAjB,GAAiC,UAAUrzB,MAAV,EAAkBjG,GAAlB,EAAuB;AACxEotB,0BAAgB,CAACtL,IAAjB,CAAsB,iBAAtB,EAAyC7b,MAAzC,EAAiDjG,GAAjD;AACH,SAFD;;AAIA,aAAKu6B,kBAAL,GAA0B,UAAU3V,QAAV,EAAoB;AAC1C,cAAIA,QAAQ,CAACiB,QAAT,CAAkBxY,IAAtB,EAA4B;AACxB6hB,2BAAe,CAACtK,QAAQ,CAACiB,QAAT,CAAkBxY,IAAnB,CAAf,GAA0C,IAA1C;AACH;;AACD+f,0BAAgB,CAACkD,aAAjB,CAA+BoJ,cAA/B,CAA8C9U,QAA9C,EAJ0C,CAK1C;;;AACA,eAAK,IAAIrmB,CAAT,IAAc0wB,kBAAd,EAAkC;AAC9B,gBAAI5J,SAAS,GAAG4J,kBAAkB,CAAC1wB,CAAD,CAAlC;;AACA,gBAAI8mB,SAAJ,EAAe;AACX,kBAAImV,YAAY,GAAG,EAAnB;;AACA,mBAAK,IAAIjqC,CAAC,GAAG,CAAR,EAAWqB,CAAC,GAAGyzB,SAAS,CAACp1B,MAA9B,EAAsCM,CAAC,GAAGqB,CAA1C,EAA6CrB,CAAC,EAA9C,EAAkD;AAC9C,oBAAI80B,SAAS,CAAC90B,CAAD,CAAT,KAAiBq0B,QAArB,EAA+B;AAC3B4V,8BAAY,CAACvlC,IAAb,CAAkBowB,SAAS,CAAC90B,CAAD,CAA3B;AACH;AACJ;;AAED0+B,gCAAkB,CAAC1wB,CAAD,CAAlB,GAAwBi8B,YAAxB;AACH;;AACD,gBAAIvL,kBAAkB,CAAC1wB,CAAD,CAAlB,CAAsBtO,MAAtB,GAA+B,CAAnC,EAAsC;AAClC,qBAAOg/B,kBAAkB,CAAC1wB,CAAD,CAAzB;AACH;AACJ;AACJ,SAtBD;;AAwBA,YAAIk8B,iBAAiB,GAAG,iBAAxB;AACA,YAAIC,aAAa,GAAG,cAApB;AACA,YAAIC,eAAe,GAAG,gBAAtB;AAEA;;;;;;;;;;AASA,aAAKC,gBAAL,GAAwB,UAAS/R,UAAT,EAAqB5iB,MAArB,EAA6B;AAEjD,cAAI4iB,UAAU,IAAI,IAAlB,EAAwB;AACpB5iB,kBAAM,GAAGA,MAAM,IAAI,EAAnB;;AAEA,gBAAIA,MAAM,CAACuP,KAAP,IAAgBiQ,GAAG,CAAC7H,aAAJ,CAAkB,IAAlB,EAAwB,KAAxB,EAA+B,CAC3C,CAAEiL,UAAU,CAACxD,SAAX,CAAqB,CAArB,CAAF,EAA2BoV,iBAA3B,EAA8C,CAAE5R,UAAF,CAA9C,CAD2C,EAE3C,CAAEA,UAAU,CAACxD,SAAX,CAAqB,CAArB,CAAF,EAA2BoV,iBAA3B,EAA8C,CAAE5R,UAAF,CAA9C,CAF2C,EAG3C,CAAEA,UAAF,EAAc4R,iBAAd,EAAiC,CAAE5R,UAAF,CAAjC,CAH2C,EAI3C,CAAEuE,gBAAF,EAAoBuN,eAApB,EAAqC,CAAED,aAAF,EAAiB7R,UAAjB,CAArC,CAJ2C,CAA/B,CAApB,EAKQ;AAEJA,wBAAU,CAACnc,QAAX,CAAoB,KAApB;AACAsnB,6BAAe,CAACnL,UAAD,EAAa,CAACA,UAAU,CAAC4K,OAAZ,IAAuBxtB,MAAM,CAACsC,SAAP,KAAqB,KAAzD,EAAgEtC,MAAM,CAACc,aAAvE,CAAf;AAEA8hB,wBAAU,CAACxD,SAAX,CAAqB,CAArB,EAAwBgU,oBAAxB,CAA6CxQ,UAA7C;AACAA,wBAAU,CAACxD,SAAX,CAAqB,CAArB,EAAwBgU,oBAAxB,CAA6CxQ,UAA7C;;AACApD,iBAAG,CAACjH,kBAAJ,CAAuBwQ,WAAvB,EAAoC,UAAUtoB,EAAV,EAAc;AAC9C,uBAAOmiB,UAAU,CAACvN,EAAX,KAAkB5U,EAAE,CAAC4U,EAA5B;AACH,eAFD;;AAIAuN,wBAAU,CAACgS,OAAX;AACAhS,wBAAU,CAACrR,OAAX;AACA,qBAAO,IAAP;AACH;AACJ;;AACD,iBAAO,KAAP;AACH,SA3BD;AA6BA;;;;;;;;;;AAQA,aAAKsjB,qBAAL,GAA6B,UAAU70B,MAAV,EAAkB;AAC3CA,gBAAM,GAAGA,MAAM,IAAI,EAAnB;AACA,cAAIqd,KAAK,GAAG0L,WAAW,CAAC/+B,MAAxB;AAAA,cAAgC8qC,YAAY,GAAG,CAA/C;;AACA3N,0BAAgB,CAAC4N,KAAjB,CAAuB,YAAY;AAC/B,iBAAK,IAAIzqC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG+yB,KAApB,EAA2B/yB,CAAC,EAA5B,EAAgC;AAC5BwqC,0BAAY,IAAI3N,gBAAgB,CAACwN,gBAAjB,CAAkC5L,WAAW,CAAC,CAAD,CAA7C,EAAkD/oB,MAAlD,IAA4D,CAA5D,GAAgE,CAAhF;AACH;AACJ,WAJD;;AAKA,iBAAO80B,YAAP;AACH,SATD;AAWA;;;;;;;;;;;AASA,aAAKE,2BAAL,GAAmC,UAAUt9B,EAAV,EAAcsI,MAAd,EAAsB;AACrDA,gBAAM,GAAGA,MAAM,IAAI,EAAnB;AACAtI,YAAE,GAAGyvB,gBAAgB,CAACO,UAAjB,CAA4BhwB,EAA5B,CAAL;;AACA,cAAI2d,EAAE,GAAGsS,MAAM,CAACjwB,EAAD,CAAf;AAAA,cAAqB0nB,SAAS,GAAG4J,kBAAkB,CAAC3T,EAAD,CAAnD;;AACA,cAAI+J,SAAS,IAAIA,SAAS,CAACp1B,MAA3B,EAAmC;AAC/B,iBAAK,IAAIM,CAAC,GAAG,CAAR,EAAWqB,CAAC,GAAGyzB,SAAS,CAACp1B,MAA9B,EAAsCM,CAAC,GAAGqB,CAA1C,EAA6CrB,CAAC,EAA9C,EAAkD;AAC9C80B,uBAAS,CAAC90B,CAAD,CAAT,CAAauqC,qBAAb,CAAmC70B,MAAnC;AACH;AACJ;;AACD,iBAAOmnB,gBAAP;AACH,SAVD,CApjC8D,CAgkC9D;;;AACA,aAAK0M,YAAL,GAAoB,UAAU7zB,MAAV,EAAkB;AAClC,cAAIqP,MAAM,GAAG;AACL+P,qBAAS,EAAE,EADN;AAEL2J,uBAAW,EAAE,EAFR;AAGLkM,yBAAa,EAAE,CAHV;AAILC,2BAAe,EAAE;AAJZ,WAAb;AAAA,cAMItB,qBAAqB,GAAG5zB,MAAM,CAAC4zB,qBAAP,KAAiC,KAN7D;;AAQA,cAAIuB,iBAAiB,GAAG,SAApBA,iBAAoB,CAAUvS,UAAV,EAAsB;AAC1C,gBAAIA,UAAU,IAAI,IAAd,IAAsBvT,MAAM,CAAC0Z,WAAP,CAAmBnG,UAAU,CAACvN,EAA9B,KAAqC,IAA/D,EAAqE;AACjE,kBAAI,CAACrV,MAAM,CAAC2zB,eAAR,IAA2B/Q,UAAU,CAAChD,QAAX,IAAuB,IAAtD,EAA4D;AACxDgD,0BAAU,CAACnc,QAAX,CAAoB,KAApB;AACH;;AACD4I,oBAAM,CAAC0Z,WAAP,CAAmBnG,UAAU,CAACvN,EAA9B,IAAoCuN,UAApC;AACAvT,oBAAM,CAAC6lB,eAAP;AACH;AACJ,WARD;;AASA,cAAIE,eAAe,GAAG,SAAlBA,eAAkB,CAAUzW,QAAV,EAAoB;AACtC,gBAAIA,QAAQ,IAAI,IAAZ,IAAoBtP,MAAM,CAAC+P,SAAP,CAAiBT,QAAQ,CAACtJ,EAA1B,KAAiC,IAAzD,EAA+D;AAC3D,kBAAI,CAACrV,MAAM,CAAC2zB,eAAR,IAA2BhV,QAAQ,CAACiB,QAAT,IAAqB,IAApD,EAA0D;AACtDjB,wBAAQ,CAAClY,QAAT,CAAkB,KAAlB;AACH;;AACD4I,oBAAM,CAAC+P,SAAP,CAAiBT,QAAQ,CAACtJ,EAA1B,IAAgCsJ,QAAhC;AACAtP,oBAAM,CAAC4lB,aAAP;;AAEA,kBAAIrB,qBAAJ,EAA2B;AACvB,qBAAK,IAAItpC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGq0B,QAAQ,CAACoK,WAAT,CAAqB/+B,MAAzC,EAAiDM,CAAC,EAAlD,EAAsD;AAClD,sBAAIO,CAAC,GAAG8zB,QAAQ,CAACoK,WAAT,CAAqBz+B,CAArB,CAAR;AACA6qC,mCAAiB,CAACtqC,CAAD,CAAjB;AACH;AACJ;AACJ;AACJ,WAfD;;AAiBA,cAAImV,MAAM,CAAC4iB,UAAX,EAAuB;AACnBuS,6BAAiB,CAACn1B,MAAM,CAAC4iB,UAAR,CAAjB;AACH,WAFD,MAGK;AACDwS,2BAAe,CAACp1B,MAAM,CAAC2e,QAAR,CAAf;AACH,WAxCiC,CA0ClC;;;AACA,eAAK,IAAIr0B,CAAT,IAAc+kB,MAAM,CAAC0Z,WAArB,EAAkC;AAC9B,gBAAIl+B,CAAC,GAAGwkB,MAAM,CAAC0Z,WAAP,CAAmBz+B,CAAnB,CAAR;;AACA,gBAAIO,CAAC,CAAC+0B,QAAN,EAAgB;AACZJ,iBAAG,CAACjH,kBAAJ,CAAuBwQ,WAAvB,EAAoC,UAAUtoB,EAAV,EAAc;AAC9C,uBAAO5V,CAAC,CAACwqB,EAAF,KAAS5U,EAAE,CAAC4U,EAAnB;AACH,eAFD;;AAIA0Y,6BAAe,CAACljC,CAAD,EAAImV,MAAM,CAACsC,SAAP,KAAqB,KAArB,GAA6B,KAA7B,GAAqC,CAACzX,CAAC,CAAC2iC,OAA5C,EAAqDxtB,MAAM,CAACc,aAA5D,CAAf;AACA,kBAAIu0B,YAAY,GAAGr1B,MAAM,CAAC4zB,qBAAP,IAAgC,IAAhC,GAAuC,IAAvC,GAA8C,CAAC5zB,MAAM,CAAC4zB,qBAAzE;AAEA/oC,eAAC,CAACu0B,SAAF,CAAY,CAAZ,EAAegU,oBAAf,CAAoCvoC,CAApC,EAAuC,IAAvC,EAA6CwqC,YAA7C;AACAxqC,eAAC,CAACu0B,SAAF,CAAY,CAAZ,EAAegU,oBAAf,CAAoCvoC,CAApC,EAAuC,IAAvC,EAA6CwqC,YAA7C;AAEAxqC,eAAC,CAAC+pC,OAAF,CAAU,IAAV;AACA/pC,eAAC,CAAC0mB,OAAF,CAAU,IAAV;AACH;AACJ,WA3DiC,CA6DlC;;;AACA,eAAK,IAAI5lB,CAAT,IAAc0jB,MAAM,CAAC+P,SAArB,EAAgC;AAC5B,gBAAI9mB,CAAC,GAAG+W,MAAM,CAAC+P,SAAP,CAAiBzzB,CAAjB,CAAR;;AACA,gBAAI2M,CAAC,CAACsnB,QAAN,EAAgB;AACZuH,8BAAgB,CAACmN,kBAAjB,CAAoCh8B,CAApC,EADY,CAEZ;;;AACAA,eAAC,CAACs8B,OAAF,CAAU,IAAV;AACAt8B,eAAC,CAACiZ,OAAF,CAAU,IAAV;AACH;AACJ;;AAED,iBAAOlC,MAAP;AACH,SAzED,CAjkC8D,CA6oC9D;;;AACA,YAAIimB,aAAa,GAAG,SAAhBA,aAAgB,CAAUn+B,IAAV,EAAgBm3B,IAAhB,EAAsBzT,IAAtB,EAA4BljB,QAA5B,EAAsC;AAClD,eAAK,IAAIrN,CAAC,GAAG,CAAR,EAAWqB,CAAC,GAAGwL,IAAI,CAACnN,MAAzB,EAAiCM,CAAC,GAAGqB,CAArC,EAAwCrB,CAAC,EAAzC,EAA6C;AACzC6M,gBAAI,CAAC7M,CAAD,CAAJ,CAAQgkC,IAAR,EAAc38B,KAAd,CAAoBwF,IAAI,CAAC7M,CAAD,CAAxB,EAA6BuwB,IAA7B;AACH;;AACD,iBAAOljB,QAAQ,CAACR,IAAD,CAAf;AACH,SALL;AAAA,YAMIo+B,aAAa,GAAG,SAAhBA,aAAgB,CAAUp+B,IAAV,EAAgBm3B,IAAhB,EAAsBzT,IAAtB,EAA4B;AACxC,cAAI/hB,GAAG,GAAG,EAAV;;AACA,eAAK,IAAIxO,CAAC,GAAG,CAAR,EAAWqB,CAAC,GAAGwL,IAAI,CAACnN,MAAzB,EAAiCM,CAAC,GAAGqB,CAArC,EAAwCrB,CAAC,EAAzC,EAA6C;AACzCwO,eAAG,CAAC9J,IAAJ,CAAS,CAAEmI,IAAI,CAAC7M,CAAD,CAAJ,CAAQgkC,IAAR,EAAc38B,KAAd,CAAoBwF,IAAI,CAAC7M,CAAD,CAAxB,EAA6BuwB,IAA7B,CAAF,EAAsC1jB,IAAI,CAAC7M,CAAD,CAA1C,CAAT;AACH;;AACD,iBAAOwO,GAAP;AACH,SAZL;AAAA,YAaI08B,MAAM,GAAG,SAATA,MAAS,CAAUr+B,IAAV,EAAgBm3B,IAAhB,EAAsB32B,QAAtB,EAAgC;AACrC,iBAAO,YAAY;AACf,mBAAO29B,aAAa,CAACn+B,IAAD,EAAOm3B,IAAP,EAAaj3B,SAAb,EAAwBM,QAAxB,CAApB;AACH,WAFD;AAGH,SAjBL;AAAA,YAkBI89B,MAAM,GAAG,SAATA,MAAS,CAAUt+B,IAAV,EAAgBm3B,IAAhB,EAAsB;AAC3B,iBAAO,YAAY;AACf,mBAAOiH,aAAa,CAACp+B,IAAD,EAAOm3B,IAAP,EAAaj3B,SAAb,CAApB;AACH,WAFD;AAGH,SAtBL;AAAA,YAuBIq+B,WAAW,GAAG,SAAdA,WAAc,CAAUC,KAAV,EAAiBC,WAAjB,EAA8B;AACxC,cAAInkC,CAAC,GAAG,EAAR;;AACA,cAAIkkC,KAAJ,EAAW;AACP,gBAAI,OAAOA,KAAP,KAAiB,QAArB,EAA+B;AAC3B,kBAAIA,KAAK,KAAK,GAAd,EAAmB;AACf,uBAAOA,KAAP;AACH;;AACDlkC,eAAC,CAACzC,IAAF,CAAO2mC,KAAP;AACH,aALD,MAMK;AACD,kBAAIC,WAAJ,EAAiB;AACbnkC,iBAAC,GAAGkkC,KAAJ;AACH,eAFD,MAGK;AACD,oBAAIA,KAAK,CAAC3rC,MAAV,EAAkB;AACd,uBAAK,IAAIM,CAAC,GAAG,CAAR,EAAWqB,CAAC,GAAGgqC,KAAK,CAAC3rC,MAA1B,EAAkCM,CAAC,GAAGqB,CAAtC,EAAyCrB,CAAC,EAA1C,EAA8C;AAC1CmH,qBAAC,CAACzC,IAAF,CAAOu4B,KAAK,CAACoO,KAAK,CAACrrC,CAAD,CAAN,CAAL,CAAgB+qB,EAAvB;AACH;AACJ,iBAJD,MAKK;AACD5jB,mBAAC,CAACzC,IAAF,CAAOu4B,KAAK,CAACoO,KAAD,CAAL,CAAatgB,EAApB;AACH;AACJ;AACJ;AACJ;;AACD,iBAAO5jB,CAAP;AACH,SAjDL;AAAA,YAkDIokC,UAAU,GAAG,SAAbA,UAAa,CAAU1+B,IAAV,EAAgBzJ,KAAhB,EAAuBooC,cAAvB,EAAuC;AAChD,cAAI3+B,IAAI,KAAK,GAAb,EAAkB;AACd,mBAAO,IAAP;AACH;;AACD,iBAAOA,IAAI,CAACnN,MAAL,GAAc,CAAd,GAAkBmN,IAAI,CAAC0B,OAAL,CAAanL,KAAb,MAAwB,CAAC,CAA3C,GAA+C,CAACooC,cAAvD;AACH,SAvDL,CA9oC8D,CAusC9D;;;AACA,aAAKC,cAAL,GAAsB,UAAUvY,OAAV,EAAmBwY,IAAnB,EAAyB;AAC3C,cAAI,CAACxY,OAAL,EAAc;AACVA,mBAAO,GAAG,EAAV;AACH,WAFD,MAEO,IAAIA,OAAO,CAACvlB,WAAR,KAAwBC,MAA5B,EAAoC;AACvCslB,mBAAO,GAAG;AAAE,uBAASA;AAAX,aAAV;AACH;;AACD,cAAIvW,KAAK,GAAGuW,OAAO,CAACvW,KAAR,IAAiBkgB,gBAAgB,CAAC3E,eAAjB,EAA7B;AAAA,cACI9a,MAAM,GAAGguB,WAAW,CAACzuB,KAAD,EAAQ,IAAR,CADxB;AAAA,cAEIgvB,OAAO,GAAGP,WAAW,CAAClY,OAAO,CAACO,MAAT,CAFzB;AAAA,cAGImY,OAAO,GAAGR,WAAW,CAAClY,OAAO,CAAChnB,MAAT,CAHzB;AAAA,cAIIs6B,OAAO,GAAI,CAACkF,IAAD,IAAStuB,MAAM,CAAC1d,MAAP,GAAgB,CAA1B,GAA+B,EAA/B,GAAoC,EAJlD;AAAA,cAKImsC,OAAO,GAAG,SAAVA,OAAU,CAAUlvB,KAAV,EAAiBxO,GAAjB,EAAsB;AAC5B,gBAAI,CAACu9B,IAAD,IAAStuB,MAAM,CAAC1d,MAAP,GAAgB,CAA7B,EAAgC;AAC5B,kBAAIosC,EAAE,GAAGtF,OAAO,CAAC7pB,KAAD,CAAhB;;AACA,kBAAImvB,EAAE,IAAI,IAAV,EAAgB;AACZA,kBAAE,GAAGtF,OAAO,CAAC7pB,KAAD,CAAP,GAAiB,EAAtB;AACH;;AACDmvB,gBAAE,CAACpnC,IAAH,CAAQyJ,GAAR;AACH,aAND,MAMO;AACHq4B,qBAAO,CAAC9hC,IAAR,CAAayJ,GAAb;AACH;AACJ,WAfL;;AAiBA,eAAK,IAAI9M,CAAC,GAAG,CAAR,EAAW6iC,EAAE,GAAGzF,WAAW,CAAC/+B,MAAjC,EAAyC2B,CAAC,GAAG6iC,EAA7C,EAAiD7iC,CAAC,EAAlD,EAAsD;AAClD,gBAAId,CAAC,GAAGk+B,WAAW,CAACp9B,CAAD,CAAnB;AAAA,gBACIm3B,QAAQ,GAAGj4B,CAAC,CAACwrC,OAAF,IAAaxrC,CAAC,CAACwrC,OAAF,CAAU,CAAV,CAAb,GAA4BxrC,CAAC,CAACwrC,OAAF,CAAU,CAAV,EAAaC,UAAb,CAAwBtI,SAApD,GAAgEnjC,CAAC,CAACi4B,QADjF;AAAA,gBAEIC,QAAQ,GAAGl4B,CAAC,CAACwrC,OAAF,IAAaxrC,CAAC,CAACwrC,OAAF,CAAU,CAAV,CAAb,GAA4BxrC,CAAC,CAACwrC,OAAF,CAAU,CAAV,EAAaC,UAAb,CAAwBtI,SAApD,GAAgEnjC,CAAC,CAACk4B,QAFjF;;AAIA,gBAAI8S,UAAU,CAACnuB,MAAD,EAAS7c,CAAC,CAACoc,KAAX,CAAV,IAA+B4uB,UAAU,CAACI,OAAD,EAAUnT,QAAV,CAAzC,IAAgE+S,UAAU,CAACK,OAAD,EAAUnT,QAAV,CAA9E,EAAmG;AAC/FoT,qBAAO,CAACtrC,CAAC,CAACoc,KAAH,EAAUpc,CAAV,CAAP;AACH;AACJ;;AAED,iBAAOimC,OAAP;AACH,SAlCD;;AAoCA,YAAIyF,UAAU,GAAG,SAAbA,UAAa,CAAUp/B,IAAV,EAAgBq/B,QAAhB,EAA0B;AACnC,iBAAO,UAAUjzB,CAAV,EAAa;AAChB,iBAAK,IAAIjZ,CAAC,GAAG,CAAR,EAAWikC,EAAE,GAAGp3B,IAAI,CAACnN,MAA1B,EAAkCM,CAAC,GAAGikC,EAAtC,EAA0CjkC,CAAC,EAA3C,EAA+C;AAC3CiZ,eAAC,CAACpM,IAAI,CAAC7M,CAAD,CAAL,CAAD;AACH;;AACD,mBAAOksC,QAAQ,CAACr/B,IAAD,CAAf;AACH,WALD;AAMH,SAPL;AAAA,YAQIs/B,SAAS,GAAG,SAAZA,SAAY,CAAUt/B,IAAV,EAAgB;AACxB,iBAAO,UAAU2H,GAAV,EAAe;AAClB,mBAAO3H,IAAI,CAAC2H,GAAD,CAAX;AACH,WAFD;AAGH,SAZL;;AAcA,YAAI43B,wBAAwB,GAAG,SAA3BA,wBAA2B,CAAUv/B,IAAV,EAAgBq/B,QAAhB,EAA0B;AACrD,cAAI19B,GAAG,GAAG;AACF9O,kBAAM,EAAEmN,IAAI,CAACnN,MADX;AAEFiwB,gBAAI,EAAEsc,UAAU,CAACp/B,IAAD,EAAOq/B,QAAP,CAFd;AAGFG,eAAG,EAAEF,SAAS,CAACt/B,IAAD;AAHZ,WAAV;AAAA,cAKIy/B,OAAO,GAAG,CAAC,UAAD,EAAa,mBAAb,EAAkC,UAAlC,EAA8C,UAA9C,EAA0D,YAA1D,EAAwE,eAAxE,EACN,gBADM,EACY,aADZ,EAC2B,aAD3B,EAC0C,cAD1C,EAC0D,cAD1D,EAC0E,eAD1E,EAEN,oBAFM,EAEgB,kBAFhB,EAEoC,cAFpC,EAEoD,eAFpD,EAEqE,YAFrE,EAGN,SAHM,EAGK,SAHL,EAGgB,YAHhB,EAG8B,YAH9B,EAG4C,aAH5C,EAG2D,SAH3D,EAGsE,MAHtE,EAG8E,QAH9E,CALd;AAAA,cAUIC,OAAO,GAAG,CAAC,UAAD,EAAa,YAAb,EAA2B,SAA3B,EAAsC,cAAtC,EAAsD,eAAtD,EAAuE,eAAvE,EACN,oBADM,EACgB,WADhB,EAC6B,SAD7B,EACwC,SADxC,EACmD,iBADnD,CAVd;AAAA,cAYIvsC,CAZJ;AAAA,cAYOikC,EAZP;;AAcA,eAAKjkC,CAAC,GAAG,CAAJ,EAAOikC,EAAE,GAAGqI,OAAO,CAAC5sC,MAAzB,EAAiCM,CAAC,GAAGikC,EAArC,EAAyCjkC,CAAC,EAA1C,EAA8C;AAC1CwO,eAAG,CAAC89B,OAAO,CAACtsC,CAAD,CAAR,CAAH,GAAkBkrC,MAAM,CAACr+B,IAAD,EAAOy/B,OAAO,CAACtsC,CAAD,CAAd,EAAmBksC,QAAnB,CAAxB;AACH;;AAED,eAAKlsC,CAAC,GAAG,CAAJ,EAAOikC,EAAE,GAAGsI,OAAO,CAAC7sC,MAAzB,EAAiCM,CAAC,GAAGikC,EAArC,EAAyCjkC,CAAC,EAA1C,EAA8C;AAC1CwO,eAAG,CAAC+9B,OAAO,CAACvsC,CAAD,CAAR,CAAH,GAAkBmrC,MAAM,CAACt+B,IAAD,EAAO0/B,OAAO,CAACvsC,CAAD,CAAd,CAAxB;AACH;;AAED,iBAAOwO,GAAP;AACH,SAxBD;;AA0BA,YAAIg+B,4BAA4B,GAAG,SAA/BA,4BAA+B,CAAU3/B,IAAV,EAAgB;AAC/C,cAAI4/B,MAAM,GAAGL,wBAAwB,CAACv/B,IAAD,EAAO2/B,4BAAP,CAArC;;AACA,iBAAO9W,OAAO,CAAClH,MAAR,CAAeie,MAAf,EAAuB;AAC1B;AACAC,yBAAa,EAAExB,MAAM,CAACr+B,IAAD,EAAO,eAAP,EAAwB2/B,4BAAxB,CAFK;AAG1BG,uBAAW,EAAEzB,MAAM,CAACr+B,IAAD,EAAO,aAAP,EAAsB2/B,4BAAtB,CAHO;AAI1BI,wBAAY,EAAE1B,MAAM,CAACr+B,IAAD,EAAO,cAAP,EAAuB2/B,4BAAvB,CAJM;AAK1B,sBAAQ,mBAAY;AAChB,mBAAK,IAAIxsC,CAAC,GAAG,CAAR,EAAWikC,EAAE,GAAGp3B,IAAI,CAACnN,MAA1B,EAAkCM,CAAC,GAAGikC,EAAtC,EAA0CjkC,CAAC,EAA3C,EAA+C;AAC3C68B,gCAAgB,CAACwN,gBAAjB,CAAkCx9B,IAAI,CAAC7M,CAAD,CAAtC;AACH;AACJ,aATyB;AAU1B;AACA6iC,wBAAY,EAAEsI,MAAM,CAACt+B,IAAD,EAAO,cAAP,CAXM;AAY1BggC,sBAAU,EAAE1B,MAAM,CAACt+B,IAAD,EAAO,YAAP;AAZQ,WAAvB,CAAP;AAcH,SAhBD;;AAkBA,YAAIigC,0BAA0B,GAAG,SAA7BA,0BAA6B,CAAUjgC,IAAV,EAAgB;AAC7C,cAAI4/B,MAAM,GAAGL,wBAAwB,CAACv/B,IAAD,EAAOigC,0BAAP,CAArC;;AACA,iBAAOpX,OAAO,CAAClH,MAAR,CAAeie,MAAf,EAAuB;AAC1BzvB,sBAAU,EAAEkuB,MAAM,CAACr+B,IAAD,EAAO,YAAP,EAAqBigC,0BAArB,CADQ;AAE1BC,qBAAS,EAAE7B,MAAM,CAACr+B,IAAD,EAAO,WAAP,EAAoBigC,0BAApB,CAFS;AAG1B7vB,qBAAS,EAAEkuB,MAAM,CAACt+B,IAAD,EAAO,WAAP,CAHS;AAI1B09B,iCAAqB,EAAE,iCAAY;AAC/B,mBAAK,IAAIvqC,CAAC,GAAG,CAAR,EAAWikC,EAAE,GAAGp3B,IAAI,CAACnN,MAA1B,EAAkCM,CAAC,GAAGikC,EAAtC,EAA0CjkC,CAAC,EAA3C,EAA+C;AAC3C6M,oBAAI,CAAC7M,CAAD,CAAJ,CAAQuqC,qBAAR;AACH;AACJ,aARyB;AAS1B,sBAAU,mBAAY;AAClB,mBAAK,IAAIvqC,CAAC,GAAG,CAAR,EAAWikC,EAAE,GAAGp3B,IAAI,CAACnN,MAA1B,EAAkCM,CAAC,GAAGikC,EAAtC,EAA0CjkC,CAAC,EAA3C,EAA+C;AAC3C68B,gCAAgB,CAACsM,cAAjB,CAAgCt8B,IAAI,CAAC7M,CAAD,CAApC;AACH;AACJ;AAbyB,WAAvB,CAAP;AAeH,SAjBD;;AAmBA,aAAKqpB,MAAL,GAAc,UAAU3T,MAAV,EAAkB;AAC5BA,gBAAM,GAAGA,MAAM,IAAI,EAAnB;AACAA,gBAAM,CAACiH,KAAP,GAAejH,MAAM,CAACiH,KAAP,IAAgB,GAA/B;AACA,iBAAO6vB,4BAA4B,CAAC92B,MAAM,CAAC+oB,WAAP,IAAsB5B,gBAAgB,CAAC4O,cAAjB,CAAgC/1B,MAAhC,EAAwC,IAAxC,CAAvB,CAAnC;AACH,SAJD;;AAMA,aAAKkoB,eAAL,GAAuB,UAAUloB,MAAV,EAAkB;AACrCA,gBAAM,GAAGA,MAAM,IAAI,EAAnB;AACAA,gBAAM,CAACiH,KAAP,GAAejH,MAAM,CAACiH,KAAP,IAAgB,GAA/B;AACA,cAAIqwB,gBAAgB,GAAG,CAACt3B,MAAM,CAAC+pB,OAAR,IAAmB,CAAC/pB,MAAM,CAAC+d,MAA3B,IAAqC,CAAC/d,MAAM,CAACxJ,MAApE;AAAA,cACI+gC,QAAQ,GAAGD,gBAAgB,GAAG,GAAH,GAAS5B,WAAW,CAAC11B,MAAM,CAAC+pB,OAAR,CADnD;AAAA,cAEIkM,OAAO,GAAGqB,gBAAgB,GAAG,GAAH,GAAS5B,WAAW,CAAC11B,MAAM,CAAC+d,MAAR,CAFlD;AAAA,cAGImY,OAAO,GAAGoB,gBAAgB,GAAG,GAAH,GAAS5B,WAAW,CAAC11B,MAAM,CAACxJ,MAAR,CAHlD;AAAA,cAIIkR,MAAM,GAAGguB,WAAW,CAAC11B,MAAM,CAACiH,KAAR,EAAe,IAAf,CAJxB;AAMA,cAAI+V,EAAE,GAAG,EAAT;;AAEA,eAAK,IAAItlB,EAAT,IAAesxB,kBAAf,EAAmC;AAC/B,gBAAIwO,MAAM,GAAG3B,UAAU,CAAC0B,QAAD,EAAW7/B,EAAX,EAAe,IAAf,CAAvB;AAAA,gBACIqmB,MAAM,GAAG8X,UAAU,CAACI,OAAD,EAAUv+B,EAAV,EAAc,IAAd,CADvB;AAAA,gBAEI+/B,gBAAgB,GAAGxB,OAAO,KAAK,GAFnC;AAAA,gBAGIz/B,MAAM,GAAGq/B,UAAU,CAACK,OAAD,EAAUx+B,EAAV,EAAc,IAAd,CAHvB;AAAA,gBAIIggC,gBAAgB,GAAGxB,OAAO,KAAK,GAJnC,CAD+B,CAO/B;;AACA,gBAAIsB,MAAM,IAAIzZ,MAAV,IAAoBvnB,MAAxB,EAAgC;AAC5BmhC,mBAAK,EACD,KAAK,IAAIrtC,CAAC,GAAG,CAAR,EAAWikC,EAAE,GAAGvF,kBAAkB,CAACtxB,EAAD,CAAlB,CAAuB1N,MAA5C,EAAoDM,CAAC,GAAGikC,EAAxD,EAA4DjkC,CAAC,EAA7D,EAAiE;AAC7D,oBAAIstC,GAAG,GAAG5O,kBAAkB,CAACtxB,EAAD,CAAlB,CAAuBpN,CAAvB,CAAV;;AACA,oBAAIurC,UAAU,CAACnuB,MAAD,EAASkwB,GAAG,CAAC3wB,KAAb,EAAoB,IAApB,CAAd,EAAyC;AAErC,sBAAI4wB,aAAa,GAAIJ,gBAAgB,IAAIxB,OAAO,CAACjsC,MAAR,GAAiB,CAArC,IAA0C,CAAC4tC,GAAG,CAACE,QAApE;AAAA,sBACIC,aAAa,GAAIL,gBAAgB,IAAIxB,OAAO,CAAClsC,MAAR,GAAiB,CAArC,IAA0C,CAAC4tC,GAAG,CAACI,QADpE;;AAGA,sBAAIH,aAAa,IAAIE,aAArB,EAAoC;AAChC,6BAASJ,KAAT;AACH;;AAED3a,oBAAE,CAAChuB,IAAH,CAAQ4oC,GAAR;AACH;AACJ;AACR;AACJ;;AAED,iBAAOR,0BAA0B,CAACpa,EAAD,CAAjC;AACH,SAvCD,CA/zC8D,CAw2C9D;;;AACA,aAAKib,iBAAL,GAAyB,YAAY;AACjC,iBAAOlP,WAAP;AACH,SAFD;;AAGA,aAAKvG,eAAL,GAAuB,YAAY;AAC/B,iBAAOiH,aAAP;AACH,SAFD,CA52C8D,CA+2C9D;;;AACA,aAAKyO,WAAL,GAAmB3N,YAAnB;AACA;;;;;;;AAMA,aAAK4N,YAAL,GAAoB,UAAUzgC,EAAV,EAAc;AAC9B,iBAAOsxB,kBAAkB,CAACzB,KAAK,CAAC7vB,EAAD,CAAL,CAAU2d,EAAX,CAAlB,IAAoC,EAA3C;AACH,SAFD,CAv3C8D,CA03C9D;;;AACA,aAAK+iB,sBAAL,GAA8B,YAAY;AACtC,iBAAOpY,OAAO,CAAC8F,QAAf;AACH,SAFD,CA33C8D,CA83C9D;;;AACA,aAAKgH,wBAAL,GAAgC,YAAY;AACxC,iBAAO9M,OAAO,CAACqY,UAAf;AACH,SAFD;AAGA;;;;;;;;AAMA,aAAKpZ,KAAL,GAAa0I,MAAb;AACA,aAAK2Q,IAAL,GAAYxO,KAAZ;AACA,aAAKiF,IAAL,GAAYxH,KAAZ;AAEA,aAAKgR,aAAL,GAAqB3O,cAArB;AAEA,YAAI4O,eAAe,GAAG,KAAtB;;AACA,aAAKzT,gBAAL,GAAwB,YAAY;AAChC,iBAAOyT,eAAP;AACH,SAFD;;AAGA,aAAKC,iBAAL,GAAyB,UAAUpvC,CAAV,EAAa;AAClCmvC,yBAAe,GAAGnvC,CAAlB;AACH,SAFD,CAl5C8D,CAs5C9D;;;AACA,aAAKqvC,IAAL,GAAY,UAAUhhC,EAAV,EAAcy3B,eAAd,EAA+B;AACvCP,qBAAW,CAACl3B,EAAD,EAAK,MAAL,EAAay3B,eAAb,CAAX;;AACA,iBAAOhI,gBAAP;AACH,SAHD,CAv5C8D,CA45C9D;;;AACA,aAAKwR,OAAL,GAAehP,QAAf,CA75C8D,CA+5C9D;AACA;AACA;AACA;AACA;AACA;;AACA,YAAIqH,gBAAgB,GAAG,SAAnBA,gBAAmB,CAAU4H,SAAV,EAAqB;AACxC,cAAI,CAAC/Q,UAAD,IAAe+Q,SAAnB,EAA8B;AAC1B,gBAAIC,GAAG,GAAG1R,gBAAgB,CAACO,UAAjB,CAA4BkR,SAA5B,CAAV;;AACA,gBAAIC,GAAG,CAACC,YAAR,EAAsB;AAClB3R,8BAAgB,CAACa,YAAjB,CAA8B6Q,GAAG,CAACC,YAAlC;AACH;AACJ;AACJ,SAPD;;AASA,YAAIC,yBAAyB,GAAG,SAA5BA,yBAA4B,GAAY;AACxC,cAAI5R,gBAAgB,CAACtF,QAAjB,CAA0B6D,SAA9B,EAAyC;AACrCyB,4BAAgB,CAACa,YAAjB,CAA8Bb,gBAAgB,CAACtF,QAAjB,CAA0B6D,SAAxD;AACH;AACJ,SAJD,CA96C8D,CAo7C9D;AACA;;;AACA,YAAIuI,OAAO,GAAG9G,gBAAgB,CAAC6R,MAAjB,GAA0B,UAAU3jB,EAAV,EAAc0U,OAAd,EAAuBkP,UAAvB,EAAmCC,OAAnC,EAA4C;AAChF,cAAI,CAACvQ,eAAe,CAACtT,EAAD,CAApB,EAA0B;AACtBsT,2BAAe,CAACtT,EAAD,CAAf,GAAsB;AAClB3d,gBAAE,EAAEqyB,OADc;AAElB3K,uBAAS,EAAE,EAFO;AAGlB2J,yBAAW,EAAE;AAHK,aAAtB;AAMAJ,2BAAe,CAACtT,EAAD,CAAf,CAAoB0Z,IAApB,GAA2B5E,aAAa,CAAC;AAAEnL,kBAAI,EAAE3J,EAAR;AAAY+K,uBAAS,EAAEoJ;AAAvB,aAAD,CAAxC;;AACArC,4BAAgB,CAACjgB,QAAjB,CAA0B6iB,OAA1B,EAAmC,aAAnC;;AAEA,gBAAI,CAACkP,UAAL,EAAiB;AACb9R,8BAAgB,CAACtL,IAAjB,CAAsB,eAAtB,EAAuC;AAAExG,kBAAE,EAACA,EAAL;AAAS0Z,oBAAI,EAACpG,eAAe,CAACtT,EAAD,CAAf,CAAoB0Z,IAAlC;AAAwCr3B,kBAAE,EAACqyB;AAA3C,eAAvC;AACH;AACJ,WAbD,MAaO;AACH,gBAAImP,OAAJ,EAAa;AACTvQ,6BAAe,CAACtT,EAAD,CAAf,CAAoB0Z,IAApB,GAA2B5E,aAAa,CAAC;AAAEnL,oBAAI,EAAE3J,EAAR;AAAY+K,yBAAS,EAAEoJ,YAAvB;AAAqCtE,sBAAM,EAAC;AAA5C,eAAD,CAAxC;AACH;AACJ;;AAED,iBAAOyD,eAAe,CAACtT,EAAD,CAAtB;AACH,SArBD;;AAuBA,YAAI8jB,SAAS,GAAGhS,gBAAgB,CAACiS,QAAjB,GAA4B,UAAS/jB,EAAT,EAAa;AACrD,cAAIsT,eAAe,CAACtT,EAAD,CAAnB,EAAyB;AACrB,gBAAI3d,EAAE,GAAGixB,eAAe,CAACtT,EAAD,CAAf,CAAoB3d,EAA7B;;AACDyvB,4BAAgB,CAAC3Y,WAAjB,CAA6B9W,EAA7B,EAAiC,aAAjC;;AACC,mBAAOixB,eAAe,CAACtT,EAAD,CAAtB;;AACA8R,4BAAgB,CAACtL,IAAjB,CAAsB,iBAAtB,EAAyC;AAACxG,gBAAE,EAACA,EAAJ;AAAQ3d,gBAAE,EAACA;AAAX,aAAzC;AACH;AACJ,SAPD;AASA;;;;;;;;;AAOA,YAAIyyB,aAAa,GAAG,SAAhBA,aAAgB,CAAUnqB,MAAV,EAAkB;AAElC,cAAIogB,SAAS,GAAGpgB,MAAM,CAACogB,SAAvB;AAAA,cAAkC8E,MAAM,GAAGllB,MAAM,CAACklB,MAAlD;AAAA,cAA0DkF,MAAM,GAAGpqB,MAAM,CAACoqB,MAA1E;AAAA,cAAkFpL,IAAI,GAAGhf,MAAM,CAACgf,IAAhG;AAAA,cAAsG31B,CAAtG;;AACA,cAAIkgC,eAAe,IAAI,CAACnJ,SAAxB,EAAmC;AAC/BA,qBAAS,GAAGoJ,YAAZ;AACH;;AACD,cAAI,CAACtE,MAAL,EAAa;AACT,gBAAI9E,SAAS,IAAIA,SAAS,KAAK+I,gBAAgB,CAACnK,IAAD,CAA/C,EAAuD;AACnD,qBAAO;AAACxL,iBAAC,EAAExT,MAAM,CAACoqB,MAAP,IAAiBlB,OAAO,CAAClK,IAAD,CAA5B;AAAoC31B,iBAAC,EAAEigC,KAAK,CAACtK,IAAD;AAA5C,eAAP;AACH;AACJ;;AACD,cAAIkG,MAAM,IAAK,CAACkF,MAAD,IAAWlB,OAAO,CAAClK,IAAD,CAAP,IAAiB,IAA3C,EAAkD;AAAE;AAEhD;AACA31B,aAAC,GAAGs/B,eAAe,CAAC3J,IAAD,CAAf,GAAwB2J,eAAe,CAAC3J,IAAD,CAAf,CAAsBtnB,EAA9C,GAAmD,IAAvD;;AACA,gBAAIrO,CAAC,IAAI,IAAT,EAAe;AACXigC,mBAAK,CAACtK,IAAD,CAAL,GAAcmI,gBAAgB,CAAClX,OAAjB,CAAyB5mB,CAAzB,CAAd;AACA6/B,qBAAO,CAAClK,IAAD,CAAP,GAAgBmI,gBAAgB,CAACkS,SAAjB,CAA2BhwC,CAA3B,CAAhB;AACA8/B,8BAAgB,CAACnK,IAAD,CAAhB,GAAyBoB,SAAzB;AACH;AACJ,WATD,MASO;AACH8I,mBAAO,CAAClK,IAAD,CAAP,GAAgBoL,MAAM,IAAIlB,OAAO,CAAClK,IAAD,CAAjC;;AACA,gBAAIsK,KAAK,CAACtK,IAAD,CAAL,IAAe,IAAnB,EAAyB;AACrB31B,eAAC,GAAGs/B,eAAe,CAAC3J,IAAD,CAAf,CAAsBtnB,EAA1B;;AACA,kBAAIrO,CAAC,IAAI,IAAT,EAAe;AACXigC,qBAAK,CAACtK,IAAD,CAAL,GAAcmI,gBAAgB,CAAClX,OAAjB,CAAyB5mB,CAAzB,CAAd;AACH;AACJ;;AACD8/B,4BAAgB,CAACnK,IAAD,CAAhB,GAAyBoB,SAAzB;AACH;;AAED,cAAI8I,OAAO,CAAClK,IAAD,CAAP,IAAiB,CAACkK,OAAO,CAAClK,IAAD,CAAP,CAAclzB,KAApC,EAA2C;AACvCo9B,mBAAO,CAAClK,IAAD,CAAP,CAAclzB,KAAd,GAAsBo9B,OAAO,CAAClK,IAAD,CAAP,CAAcnzB,IAAd,GAAqBy9B,KAAK,CAACtK,IAAD,CAAL,CAAY,CAAZ,CAA3C;AACAkK,mBAAO,CAAClK,IAAD,CAAP,CAAc9B,MAAd,GAAuBgM,OAAO,CAAClK,IAAD,CAAP,CAAcrf,GAAd,GAAoB2pB,KAAK,CAACtK,IAAD,CAAL,CAAY,CAAZ,CAA3C;AACAkK,mBAAO,CAAClK,IAAD,CAAP,CAAcpC,KAAd,GAAsB0M,KAAK,CAACtK,IAAD,CAAL,CAAY,CAAZ,CAAtB;AACAkK,mBAAO,CAAClK,IAAD,CAAP,CAAcrC,MAAd,GAAuB2M,KAAK,CAACtK,IAAD,CAAL,CAAY,CAAZ,CAAvB;AACAkK,mBAAO,CAAClK,IAAD,CAAP,CAAcsa,OAAd,GAAwBpQ,OAAO,CAAClK,IAAD,CAAP,CAAcnzB,IAAd,GAAsBq9B,OAAO,CAAClK,IAAD,CAAP,CAAcpC,KAAd,GAAsB,CAApE;AACAsM,mBAAO,CAAClK,IAAD,CAAP,CAAcua,OAAd,GAAwBrQ,OAAO,CAAClK,IAAD,CAAP,CAAcrf,GAAd,GAAqBupB,OAAO,CAAClK,IAAD,CAAP,CAAcrC,MAAd,GAAuB,CAApE;AACH;;AAED,iBAAO;AAACnJ,aAAC,EAAE0V,OAAO,CAAClK,IAAD,CAAX;AAAmB31B,aAAC,EAAEigC,KAAK,CAACtK,IAAD;AAA3B,WAAP;AACH,SAzCD;;AA2CA,aAAKwa,YAAL,GAAoBrP,aAApB;AAEA;;;;;AAIA,aAAKxoB,IAAL,GAAY,YAAY;AACpB,cAAI,CAACinB,WAAL,EAAkB;AACdmQ,qCAAyB;;AACzB5R,4BAAgB,CAACuG,MAAjB,GAA0B,IAAInlC,IAAI,CAACy3B,OAAL,CAAayZ,aAAjB,CAA+BtS,gBAA/B,CAA1B;AACAA,4BAAgB,CAACkD,aAAjB,GAAiClD,gBAAgB,CAACuG,MAAjB,CAAwBrD,aAAzD;AACAzB,uBAAW,GAAG,IAAd;;AACAzB,4BAAgB,CAACtL,IAAjB,CAAsB,OAAtB,EAA+BsL,gBAA/B;AACH;AACJ,SARW,CAQV3b,IARU,CAQL,IARK,CAAZ;;AAUA,aAAKpb,GAAL,GAAWA,GAAX;AACA,aAAKixB,kBAAL,GAA0BA,kBAA1B;AAEA;;;;;;;;AAOA,aAAKqY,UAAL,GAAkB,YAAY;AAC1B,cAAIC,EAAJ;AAAA,cAAQC,EAAE,GAAG,SAALA,EAAK,CAAUvvC,CAAV,EAAa0E,CAAb,EAAgB;AACzB,gBAAIxG,IAAI,CAACy3B,OAAL,CAAasF,OAAb,CAAqBj7B,CAArB,CAAJ,EAA6B;AACzB,qBAAO,IAAI9B,IAAI,CAACy3B,OAAL,CAAasF,OAAb,CAAqBj7B,CAArB,CAAJ,CAA4B0E,CAA5B,CAAP;AACH;;AACD,gBAAI,CAACo4B,gBAAgB,CAACtF,QAAjB,CAA0B8D,gBAA/B,EAAiD;AAC7C,oBAAM;AAAE5K,mBAAG,EAAE,mCAAmC1wB,CAAnC,GAAuC;AAA9C,eAAN;AACH;AACJ,WAPD;;AAQA,cAAIgN,SAAS,CAACrN,MAAV,KAAqB,CAAzB,EAA4B;AACxB,mBAAO,IAAP;AACH;;AACD,cAAI6vC,QAAQ,GAAGxiC,SAAS,CAAC,CAAD,CAAxB;AAAA,cAA6B22B,SAAS,GAAG32B,SAAS,CAAC,CAAD,CAAlD;AAAA,cAAuD+lB,eAAe,GAAG/lB,SAAS,CAAC,CAAD,CAAlF;AAAA,cAAuFyiC,SAAS,GAAG,IAAnG,CAZ0B,CAa1B;;AACA,cAAID,QAAQ,CAACzI,OAAT,IAAoByI,QAAQ,CAACE,cAAjC,EAAiD;AAC7C,mBAAOF,QAAP;AACH,WAFD,CAEG;AACH;AAHA,eAIK,IAAI,OAAOA,QAAP,KAAoB,QAAxB,EAAkC;AACnCC,uBAAS,GAAGF,EAAE,CAACviC,SAAS,CAAC,CAAD,CAAV,EAAe;AAAC22B,yBAAS,EAAEA,SAAZ;AAAuB5Q,+BAAe,EAAE+J;AAAxC,eAAf,CAAd;AACH,aAFI,CAGL;AACA;AACA;AACA;AANK,iBAOA,IAAI3H,GAAG,CAACtJ,OAAJ,CAAY2jB,QAAZ,CAAJ,EAA2B;AAC5B,oBAAIra,GAAG,CAACtJ,OAAJ,CAAY2jB,QAAQ,CAAC,CAAD,CAApB,KAA4Bra,GAAG,CAACpJ,QAAJ,CAAayjB,QAAQ,CAAC,CAAD,CAArB,CAAhC,EAA2D;AACvD;AACA,sBAAIA,QAAQ,CAAC7vC,MAAT,KAAoB,CAApB,IAAyBw1B,GAAG,CAACjJ,QAAJ,CAAasjB,QAAQ,CAAC,CAAD,CAArB,CAA7B,EAAwD;AACpD;AACA,wBAAIra,GAAG,CAACpJ,QAAJ,CAAayjB,QAAQ,CAAC,CAAD,CAArB,CAAJ,EAA+B;AAC3BF,wBAAE,GAAGpxC,IAAI,CAACy3B,OAAL,CAAalH,MAAb,CAAoB;AAACkV,iCAAS,EAAEA,SAAZ;AAAuB5Q,uCAAe,EAAE+J;AAAxC,uBAApB,EAA+E0S,QAAQ,CAAC,CAAD,CAAvF,CAAL;AACAC,+BAAS,GAAGF,EAAE,CAACC,QAAQ,CAAC,CAAD,CAAT,EAAcF,EAAd,CAAd;AACH,qBAHD,CAIA;AACA;AALA,yBAMK;AACDA,0BAAE,GAAGpxC,IAAI,CAACy3B,OAAL,CAAalH,MAAb,CAAoB;AAACkV,mCAAS,EAAEA,SAAZ;AAAuB5Q,yCAAe,EAAE+J,gBAAxC;AAA0DqE,iCAAO,EAAEqO,QAAQ,CAAC,CAAD;AAA3E,yBAApB,EAAqGA,QAAQ,CAAC,CAAD,CAA7G,CAAL;AACAC,iCAAS,GAAG,IAAIvxC,IAAI,CAACy3B,OAAL,CAAaga,aAAjB,CAA+BL,EAA/B,CAAZ;AACH;AACJ,mBAZD,MAaK;AACDG,6BAAS,GAAG,IAAI9Z,OAAO,CAACga,aAAZ,CAA0B;AAACxO,6BAAO,EAAEqO,QAAV;AAAoBliC,8BAAQ,EAAE,IAA9B;AAAoCq2B,+BAAS,EAAEA,SAA/C;AAA0D5Q,qCAAe,EAAE+J;AAA3E,qBAA1B,CAAZ;AACH;AAEJ,iBAnBD,MAoBK;AACD,sBAAI8S,YAAY,GAAG;AACfvxC,qBAAC,EAAEmxC,QAAQ,CAAC,CAAD,CADI;AACC9wC,qBAAC,EAAE8wC,QAAQ,CAAC,CAAD,CADZ;AAEfK,+BAAW,EAAGL,QAAQ,CAAC7vC,MAAT,IAAmB,CAApB,GAAyB,CAAE6vC,QAAQ,CAAC,CAAD,CAAV,EAAeA,QAAQ,CAAC,CAAD,CAAvB,CAAzB,GAAwD,CAAC,CAAD,EAAI,CAAJ,CAFtD;AAGf3Q,2BAAO,EAAG2Q,QAAQ,CAAC7vC,MAAT,IAAmB,CAApB,GAAyB,CAAE6vC,QAAQ,CAAC,CAAD,CAAV,EAAeA,QAAQ,CAAC,CAAD,CAAvB,CAAzB,GAAwD,CAAE,CAAF,EAAK,CAAL,CAHlD;AAIf7L,6BAAS,EAAEA,SAJI;AAKf5Q,mCAAe,EAAE+J,gBALF;AAMf7D,4BAAQ,EAAEuW,QAAQ,CAAC7vC,MAAT,KAAoB,CAApB,GAAwB6vC,QAAQ,CAAC,CAAD,CAAhC,GAAsC;AANjC,mBAAnB;AAQAC,2BAAS,GAAG,IAAIvxC,IAAI,CAACy3B,OAAL,CAAaqF,MAAjB,CAAwB4U,YAAxB,CAAZ;;AACAH,2BAAS,CAACnxB,KAAV,GAAkB,YAAY;AAC1B,2BAAO,IAAIpgB,IAAI,CAACy3B,OAAL,CAAaqF,MAAjB,CAAwB4U,YAAxB,CAAP;AACH,mBAFD;AAGH;AACJ;;AAED,cAAI,CAACH,SAAS,CAACzkB,EAAf,EAAmB;AACfykB,qBAAS,CAACzkB,EAAV,GAAe,YAAYsU,QAAQ,EAAnC;AACH;;AACD,iBAAOmQ,SAAP;AACH,SAlED;AAoEA;;;;;;AAIA,aAAKK,WAAL,GAAmB,UAAUnZ,KAAV,EAAiBgN,SAAjB,EAA4B5Q,eAA5B,EAA6C;AAC5D,cAAI3rB,CAAC,GAAG,EAAR;;AACA,eAAK,IAAInH,CAAC,GAAG,CAAR,EAAWikC,EAAE,GAAGvN,KAAK,CAACh3B,MAA3B,EAAmCM,CAAC,GAAGikC,EAAvC,EAA2CjkC,CAAC,EAA5C,EAAgD;AAC5C,gBAAI,OAAO02B,KAAK,CAAC12B,CAAD,CAAZ,KAAoB,QAAxB,EAAkC;AAC9BmH,eAAC,CAACzC,IAAF,CAAOzG,IAAI,CAACy3B,OAAL,CAAasF,OAAb,CAAqBtE,KAAK,CAAC12B,CAAD,CAA1B,EAA+B;AAAC0jC,yBAAS,EAAEA,SAAZ;AAAuB5Q,+BAAe,EAAEA;AAAxC,eAA/B,CAAP;AACH,aAFD,MAGK,IAAIoC,GAAG,CAACtJ,OAAJ,CAAY8K,KAAK,CAAC12B,CAAD,CAAjB,CAAJ,EAA2B;AAC5BmH,eAAC,CAACzC,IAAF,CAAOm4B,gBAAgB,CAACuS,UAAjB,CAA4B1Y,KAAK,CAAC12B,CAAD,CAAjC,EAAsC0jC,SAAtC,EAAiD5Q,eAAjD,CAAP;AACH;AACJ;;AACD,iBAAO3rB,CAAP;AACH,SAXD;AAaA;;;;;;;AAKA,aAAK2oC,iBAAL,GAAyB,UAAU5O,OAAV,EAAmB6O,cAAnB,EAAmC;AACxD,iBAAO,IAAI9xC,IAAI,CAACy3B,OAAL,CAAaga,aAAjB,CAA+B;AAACxO,mBAAO,EAAEA,OAAV;AAAmB7zB,oBAAQ,EAAE0iC,cAA7B;AAA6CrM,qBAAS,EAAE,IAAxD;AAA8D5Q,2BAAe,EAAE+J;AAA/E,WAA/B,CAAP;AACH,SAFD,CA5nD8D,CAgoDtE;;;AAEQ,aAAKuF,yBAAL,GAAiC,EAAjC;AACA,aAAKD,yBAAL,GAAiC,EAAjC;;AAEA,YAAI6N,cAAc,GAAG,SAAjBA,cAAiB,CAAUvgC,GAAV,EAAeuF,GAAf,EAAoB3H,QAApB,EAA8B4iC,SAA9B,EAAyCC,MAAzC,EAAiD;AAClE,cAAInwC,CAAC,GAAG0P,GAAG,CAACvD,MAAJ,IAAcuD,GAAG,CAACxB,UAA1B;AAAA,cAAsCkiC,EAAE,GAAG,KAA3C;AAAA,cACIhrB,GAAG,GAAG8qB,SAAS,CAAC1c,WAAV,CAAsBve,GAAtB,EAA2B3H,QAA3B,CADV;;AAEA,eAAK,IAAIhM,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG8jB,GAAG,CAACzlB,MAAxB,EAAgC2B,CAAC,EAAjC,EAAqC;AACjC,gBAAI8jB,GAAG,CAAC9jB,CAAD,CAAH,KAAWtB,CAAf,EAAkB;AACdowC,gBAAE,GAAG,IAAL;AACA;AACH;AACJ;;AACD,iBAAOD,MAAM,GAAG,CAACC,EAAJ,GAASA,EAAtB;AACH,SAVD;;AAYA,YAAIC,uBAAuB,GAAG,SAA1BA,uBAA0B,CAAUC,MAAV,EAAkB5rC,CAAlB,EAAqB6rC,WAArB,EAAkC9C,QAAlC,EAA4CE,QAA5C,EAAsD;AAChF,cAAI6C,cAAc,GAAG,IAAIxZ,kBAAJ,CAAuBtyB,CAAvB,CAArB;;AACA,cAAI+rC,KAAK,GAAG/rC,CAAC,CAAC6wB,QAAF,CAAWmb,mBAAX,CAA+B;AACvC/a,mBAAO,EAAEmH,gBAD8B;AAEvC9f,mBAAO,EAAE,mBAAY;AACjB,qBAAOszB,MAAM,CAACrgB,GAAP,CAAWjT,OAAlB;AACH,aAJsC;AAKvC8jB,kBAAM,EAAE,kBAAY;AAChB,kBAAI6P,WAAW,GAAG7T,gBAAgB,CAACxT,MAAjB,CAAwB;AAACnd,sBAAM,EAAEmkC,MAAM,CAACtlB;AAAhB,eAAxB,EAA6CrrB,MAA/D;;AACA,qBAAO2wC,MAAM,CAACrgB,GAAP,CAAW2gB,cAAX,GAA4B,CAA5B,IAAiCD,WAAW,IAAIL,MAAM,CAACrgB,GAAP,CAAW2gB,cAAlE;AACH,aARsC;AASvClR,mBAAO,EAAE4Q,MAAM,CAACjjC,EATuB;AAUvCs2B,qBAAS,EAAE2M,MAAM,CAACtlB,EAVqB;AAWvCyiB,oBAAQ,EAAEA,QAX6B;AAYvCE,oBAAQ,EAAEA,QAZ6B;AAavC9wB,oBAAQ,EAAE,kBAAU2c,KAAV,EAAiB;AACvBsD,8BAAgB,CAACjgB,QAAjB,CAA0ByzB,MAAM,CAACjjC,EAAjC,EAAqCmsB,KAArC;AACH,aAfsC;AAgBvCrV,uBAAW,EAAE,qBAAUqV,KAAV,EAAiB;AAC1BsD,8BAAgB,CAAC3Y,WAAjB,CAA6BmsB,MAAM,CAACjjC,EAApC,EAAwCmsB,KAAxC;AACH,aAlBsC;AAmBvCqX,kBAAM,EAAE,gBAAU7N,GAAV,EAAe;AACnB,kBAAItP,MAAM,GAAGsP,GAAG,CAACjO,SAAJ,CAAc,CAAd,CAAb;AACArB,oBAAM,CAACU,MAAP,CAAc0c,MAAd;AACH,aAtBsC;AAuBvCtY,yBAAa,EAAE,yBAAY;AACvB,qBAAOgY,cAAc,CAAChY,aAAf,CAA6BlxB,KAA7B,CAAmCkpC,cAAnC,EAAmDxjC,SAAnD,CAAP;AACH,aAzBsC;AA0BvC+jC,oBAAQ,EAAC,kBAAS/N,GAAT,EAAc;AACnB,qBAAQA,GAAG,CAACgO,gBAAJ,IAAwB,IAAxB,IAAgChO,GAAG,CAACE,iBAAJ,IAAyB,IAAzD,IAAiEF,GAAG,CAACE,iBAAJ,CAAsBxD,OAAtB,KAAkC4Q,MAAM,CAACjjC,EAAlH;AACH,aA5BsC;AA6BvCwgC,uBAAW,EAAE,qBAAU7K,GAAV,EAAe;AAExB;AACA;AAEA,kBAAIhB,WAAW,GAAGsO,MAAM,CAACrgB,GAAP,CAAWqE,QAA7B,CALwB,CAOxB;AACA;;AACA,kBAAI0N,WAAW,IAAI,IAAf,IAAuBA,WAAW,CAACzM,QAAZ,IAAwB,IAAnD,EAAyD;AACrD,oBAAI0b,GAAG,GAAGnU,gBAAgB,CAACoU,2BAAjB,CAA6ClO,GAAG,CAACnM,OAAJ,GAAc/C,IAAd,CAAmB,GAAnB,CAA7C,EAAsE,IAAtE,CAAV;;AACA,oBAAIwb,EAAE,GAAG2B,GAAG,CAAClc,SAAJ,GAAgB72B,IAAI,CAACy3B,OAAL,CAAalH,MAAb,CAAoB/pB,CAApB,EAAuB;AAC5C4vB,0BAAQ,EAACgc,MAAM,CAACrgB,GAAP,CAAWA,GAAX,CAAeqE,QAAf,IAA2B2c,GAAG,CAAClc,SAAJ,CAAc,CAAd;AADQ,iBAAvB,CAAhB,GAELrwB,CAFJ;;AAGA,oBAAIusC,GAAG,CAAC9P,OAAR,EAAiB;AACbmO,oBAAE,GAAGpxC,IAAI,CAACy3B,OAAL,CAAalH,MAAb,CAAoB6gB,EAApB,EAAwB;AACzBlb,0BAAM,EAACkc,MAAM,CAACrgB,GAAP,CAAWA,GAAX,CAAemE,MAAf,IAAyB6c,GAAG,CAAC9P,OAAJ,CAAY,CAAZ;AADP,mBAAxB,CAAL;AAGH;;AACDa,2BAAW,GAAGlF,gBAAgB,CAAC0E,WAAjB,CAA6B8O,MAAM,CAACjjC,EAApC,EAAwCiiC,EAAxC,CAAd;AACAtN,2BAAW,CAACmP,MAAZ,GAAqB,IAArB;AACH;;AAED,kBAAIzsC,CAAC,CAACu9B,cAAN,EAAsB;AAClBqO,sBAAM,CAACrgB,GAAP,CAAWqE,QAAX,GAAsB0N,WAAtB;AACH;;AAEDA,yBAAW,CAACE,gBAAZ,CAA6B,IAA7B,EA3BwB,CA6BxB;;AACA,kBAAIc,GAAG,CAACF,YAAJ,EAAJ,EAAwB;AACpBd,2BAAW,CAACe,aAAZ;AACH,eAhCuB,CAkCxB;AACA;;;AACA,kBAAIf,WAAW,CAAC5N,MAAZ,CAAmBgd,cAAnB,IAAqC,IAAzC,EAA+C;AAC3C,oBAAIC,YAAY,GAAGvU,gBAAgB,CAACwU,aAAjB,CAA+BtkC,SAA/B,EAA0C8vB,gBAAgB,CAAChZ,OAAjB,EAA1C,CAAnB;AAAA,oBACIytB,UAAU,GAAGzU,gBAAgB,CAACkS,SAAjB,CAA2BsB,MAAM,CAACjjC,EAAlC,CADjB;AAAA,oBAEImkC,MAAM,GAAG1U,gBAAgB,CAAClX,OAAjB,CAAyB0qB,MAAM,CAACjjC,EAAhC,CAFb;AAAA,oBAGIokC,EAAE,GAAGJ,YAAY,IAAI,IAAhB,GAAuB,CAAC,CAAD,EAAG,CAAH,CAAvB,GAA+BrP,WAAW,CAAC5N,MAAZ,CAAmBgd,cAAnB,CAAkCC,YAAlC,EAAgDE,UAAhD,EAA4DC,MAA5D,EAAoExP,WAAW,CAAC5N,MAAZ,CAAmBsd,iBAAvF,CAHxC;;AAKA1P,2BAAW,CAAC5N,MAAZ,CAAmB/1B,CAAnB,GAAuBozC,EAAE,CAAC,CAAD,CAAzB;AACAzP,2BAAW,CAAC5N,MAAZ,CAAmB11B,CAAnB,GAAuB+yC,EAAE,CAAC,CAAD,CAAzB,CAP2C,CAQ3C;AACA;AACA;AACA;AACA;AACH;;AAED,qBAAOzP,WAAP;AACH,aAjFsC;AAkFvC2P,wBAAY,EAAE,sBAAUhf,EAAV,EAAc;AACxB,kBAAIA,EAAE,CAACwe,MAAH,IAAaxe,EAAE,CAAC+L,WAAH,CAAe/+B,MAAf,KAA0B,CAA3C,EAA8C;AAC1Cm9B,gCAAgB,CAAC0M,YAAjB,CAA8B;AAAClV,0BAAQ,EAAE3B;AAAX,iBAA9B;AACH,eAFD,MAGK;AACD,uBAAOA,EAAE,CAACwe,MAAV;AACH;AACJ;AAzFsC,WAA/B,CAAZ,CAFgF,CA8FhF;;;AACA,cAAIS,SAAS,GAAG1zC,IAAI,CAACy3B,OAAL,CAAakc,UAAb,CAAwBrrB,IAAxC;AACA+pB,qBAAW,CAAC3zB,KAAZ,GAAoB2zB,WAAW,CAAC3zB,KAAZ,IAAsBlY,CAAC,CAACkY,KAAF,IAAWkgB,gBAAgB,CAACtF,QAAjB,CAA0BmF,KAA/E;AACA4T,qBAAW,CAACqB,SAAD,CAAX,GAAyBzc,GAAG,CAACxE,IAAJ,CAAS4f,WAAW,CAACqB,SAAD,CAApB,EAAiCnB,KAAjC,EAAwC,IAAxC,CAAzB;AACAF,qBAAW,CAAClpB,IAAZ,GAAmB3iB,CAAC,CAAC2iB,IAAF,IAAU,CAA7B,CAlGgF,CAoGhF;AACA;;AACA,cAAIsmB,QAAJ,EAAc;AACV4C,uBAAW,CAACryC,IAAI,CAACy3B,OAAL,CAAakc,UAAb,CAAwBl/B,IAAzB,CAAX,GAA4C,YAAY;AAAE,qBAAO,IAAP;AAAc,aAAxE;AACH,WAxG+E,CA0GhF;;;AACA,cAAIjO,CAAC,CAACgjB,aAAF,KAAoB,KAAxB,EAA+B;AAC3B6oB,uBAAW,CAACvpB,OAAZ,GAAsB,UAAU8qB,KAAV,EAAiB;AACnC,kBAAIC,EAAE,GAAGD,KAAK,CAACptB,cAAN,GAAuBstB,sBAAhC;;AACA,qBAAOD,EAAE,KAAKzB,MAAM,CAACjjC,EAArB;AACH,aAHD;AAIH;;AACDyvB,0BAAgB,CAACmV,aAAjB,CAA+B3B,MAAM,CAACjjC,EAAtC,EAA0CkjC,WAA1C,EAAuD,UAAvD;;AAEA,iBAAOE,KAAP;AAEH,SArHD,CAjpD8D,CAwwD9D;;;AACA,aAAKyB,UAAL,GAAkB,UAAU7kC,EAAV,EAAcsI,MAAd,EAAsB+qB,eAAtB,EAAuC;AAErD;AACA,cAAIh8B,CAAC,GAAGxG,IAAI,CAACy3B,OAAL,CAAalH,MAAb,CAAoB;AAAC8G,oBAAQ,EAAE;AAAX,WAApB,EAAsCmL,eAAtC,CAAR;AACAxiC,cAAI,CAACy3B,OAAL,CAAalH,MAAb,CAAoB/pB,CAApB,EAAuBiR,MAAvB;;AAEA,cAAIi7B,cAAc,GAAGlsC,CAAC,CAACksC,cAAF,IAAoB,CAAC,CAA1C;AAAA,cAEIuB,MAAM,GAAG,UAAU9kC,EAAV,EAAc;AAEnB;AACA;AACA;AACA,gBAAIijC,MAAM,GAAGpT,KAAK,CAAC7vB,EAAD,CAAlB;AAAA,gBACI+kC,IAAI,GAAG9B,MAAM,CAACtlB,EADlB;AAAA,gBAEIulB,WAAW,GAAGryC,IAAI,CAACy3B,OAAL,CAAalH,MAAb,CAAoB,EAApB,EAAwB/pB,CAAC,CAAC6rC,WAAF,IAAiB,EAAzC,CAFlB;AAAA,gBAGIh+B,IAAI,GAAG7N,CAAC,CAACq8B,cAAF,IAAoB,SAH/B;;AAKA,iBAAKsB,yBAAL,CAA+B+P,IAA/B,IAAuC,KAAK/P,yBAAL,CAA+B+P,IAA/B,KAAwC,EAA/E;;AAEAzL,4BAAgB,CAACyL,IAAD,CAAhB,CAZmB,CAcnB;AACA;;;AACA,gBAAI9B,MAAM,CAACjjC,EAAP,CAAUglC,eAAV,IAA6B9B,WAAW,CAAClpB,IAAZ,IAAoB,IAArD,EAA2D;AACvDkpB,yBAAW,CAAClpB,IAAZ,GAAmB,CAAC,CAApB;AACH,aAlBkB,CAoBnB;;;AACA,gBAAI0I,IAAI,GAAG;AACPE,iBAAG,EAAE/xB,IAAI,CAACy3B,OAAL,CAAalH,MAAb,CAAoB,EAApB,EAAwB/pB,CAAxB,CADE;AAEPu9B,4BAAc,EAAEv9B,CAAC,CAACu9B,cAFX;AAGP2O,4BAAc,EAAEA,cAHT;AAIP5zB,qBAAO,EAAE;AAJF,aAAX;;AAOA,gBAAItY,CAAC,CAAC4tC,cAAN,EAAsB;AAClBviB,kBAAI,CAACkS,cAAL,GAAsB,IAAtB;AACAlS,kBAAI,CAACuE,QAAL,GAAgBwI,gBAAgB,CAAC0E,WAAjB,CAA6Bn0B,EAA7B,EAAiC0iB,IAAI,CAACE,GAAtC,CAAhB;;AACAF,kBAAI,CAACuE,QAAL,CAAc4N,gBAAd,CAA+B,KAA/B;AACH;;AAEDoO,kBAAM,CAACrgB,GAAP,GAAaF,IAAb;AACA,iBAAKsS,yBAAL,CAA+B+P,IAA/B,EAAqC7/B,IAArC,IAA6Cwd,IAA7C;;AACAsgB,mCAAuB,CAACC,MAAD,EAAS5rC,CAAT,EAAY6rC,WAAZ,EAAyB7rC,CAAC,CAAC+oC,QAAF,KAAe,IAAxC,EAA8C,IAA9C,CAAvB,CApCmB,CAqCnB;;;AACA6C,kBAAM,CAACjjC,EAAP,CAAUgc,cAAV,CAAyBinB,MAAM,CAACjjC,EAAP,CAAUgc,cAAV,CAAyB1pB,MAAzB,GAAkC,CAA3D,EAA8D4yC,SAA9D,GAA0ExiB,IAA1E;AAEH,WAxCQ,CAwCP5O,IAxCO,CAwCF,IAxCE,CAFb,CANqD,CAkDrD;;;AACA,cAAIulB,MAAM,GAAGr5B,EAAE,CAAC1N,MAAH,IAAa0N,EAAE,CAACO,WAAH,KAAmBC,MAAhC,GAAyCR,EAAzC,GAA8C,CAAEA,EAAF,CAA3D,CAnDqD,CAqDrD;;AACA,eAAK,IAAIpN,CAAC,GAAG,CAAR,EAAWikC,EAAE,GAAGwC,MAAM,CAAC/mC,MAA5B,EAAoCM,CAAC,GAAGikC,EAAxC,EAA4CjkC,CAAC,EAA7C,EAAiD;AAC7CkyC,kBAAM,CAACzL,MAAM,CAACzmC,CAAD,CAAP,CAAN;AACH;;AAED,iBAAO,IAAP;AACH,SA3DD,CAzwD8D,CAs0D9D;;;AACA,aAAKuyC,YAAL,GAAoB,UAAUnlC,EAAV,EAAcolC,gBAAd,EAAgC;AAChD,cAAI/N,IAAI,GAAGxH,KAAK,CAAC7vB,EAAD,CAAhB;;AACAyvB,0BAAgB,CAACpS,gBAAjB,CAAkCga,IAAI,CAACr3B,EAAvC,EAA2C,UAA3C;;AACA,cAAI,CAAColC,gBAAL,EAAuB;AACnB,mBAAO,KAAKpQ,yBAAL,CAA+BqC,IAAI,CAAC1Z,EAApC,CAAP;AACH;;AAED,iBAAO,IAAP;AACH,SARD,CAv0D8D,CAi1D9D;;;AACA,aAAK0nB,UAAL,GAAkB,UAAUrlC,EAAV,EAAcsI,MAAd,EAAsB+qB,eAAtB,EAAuC;AACrD,cAAIh8B,CAAC,GAAGxG,IAAI,CAACy3B,OAAL,CAAalH,MAAb,CAAoB;AAAC8G,oBAAQ,EAAE;AAAX,WAApB,EAAsCmL,eAAtC,CAAR;AACAxiC,cAAI,CAACy3B,OAAL,CAAalH,MAAb,CAAoB/pB,CAApB,EAAuBiR,MAAvB;AACA,cAAIpD,IAAI,GAAG7N,CAAC,CAACq8B,cAAF,IAAoB,SAA/B;;AACA,cAAI4R,GAAG,GAAG7V,gBAAgB,CAACoU,2BAAjB,CAA6C3+B,IAA7C,CAAV;;AACA7N,WAAC,CAAC4vB,QAAF,GAAa5vB,CAAC,CAAC4vB,QAAF,IAAcqe,GAAG,CAAC5d,SAAJ,CAAc,CAAd,CAA3B;AACArwB,WAAC,CAAC0vB,MAAF,GAAW1vB,CAAC,CAAC0vB,MAAF,IAAYue,GAAG,CAACxR,OAAJ,CAAY,CAAZ,CAAvB;;AACA,cAAIyP,cAAc,GAAGlsC,CAAC,CAACksC,cAAF,IAAoB,CAAC,CAA1C;AAAA,cACIgC,gBAAgB,GAAGluC,CAAC,CAACkuC,gBADzB;AAAA,cAEIT,MAAM,GAAG,UAAU7B,MAAV,EAAkB;AACvB;AACA;AACA,gBAAI8B,IAAI,GAAG9B,MAAM,CAACtlB,EAAlB;AAAA,gBACI6nB,IAAI,GAAG,KAAKxV,UAAL,CAAgBiT,MAAM,CAACjjC,EAAvB,CADX;;AAGA,iBAAK+0B,yBAAL,CAA+BgQ,IAA/B,IAAuC,KAAKhQ,yBAAL,CAA+BgQ,IAA/B,KAAwC,EAA/E;;AACAzL,4BAAgB,CAACyL,IAAD,CAAhB;;AAEA,gBAAIriB,IAAI,GAAG;AACPE,iBAAG,EAAC/xB,IAAI,CAACy3B,OAAL,CAAalH,MAAb,CAAoB,EAApB,EAAwB/pB,CAAxB,CADG;AAEPu9B,4BAAc,EAAEv9B,CAAC,CAACu9B,cAFX;AAGP2O,4BAAc,EAAEA,cAHT;AAIP5zB,qBAAO,EAAE;AAJF,aAAX;;AAOA,gBAAItY,CAAC,CAAC4tC,cAAN,EAAsB;AAClBviB,kBAAI,CAACkS,cAAL,GAAsB,IAAtB;AACAlS,kBAAI,CAACuE,QAAL,GAAgBwI,gBAAgB,CAAC0E,WAAjB,CAA6Bn0B,EAA7B,EAAiC0iB,IAAI,CAACE,GAAtC,CAAhB;;AACAF,kBAAI,CAACuE,QAAL,CAAc4N,gBAAd,CAA+B,KAA/B;AACH;;AAED,iBAAKE,yBAAL,CAA+BgQ,IAA/B,EAAqC7/B,IAArC,IAA6Cwd,IAA7C;AACAugB,kBAAM,CAACrgB,GAAP,GAAaF,IAAb;AAEA,gBAAI+iB,SAAS,GAAG50C,IAAI,CAACy3B,OAAL,CAAakc,UAAb,CAAwBttB,IAAxC;AAAA,gBACIwuB,SAAS,GAAG70C,IAAI,CAACy3B,OAAL,CAAakc,UAAb,CAAwB52B,IADxC;AAAA,gBAEI+3B,WAAW,GAAG90C,IAAI,CAACy3B,OAAL,CAAalH,MAAb,CAAoB,EAApB,EAAyB/pB,CAAC,CAACsuC,WAAF,IAAiB,EAA1C,CAFlB;AAAA,gBAGInqB,YAAY,GAAGmqB,WAAW,CAAC/3B,IAH/B;AAAA,gBAIIg4B,YAAY,GAAGD,WAAW,CAACzuB,IAJ/B;AAAA,gBAKIoO,EAAE,GAAG,IALT;AAAA,gBAMIugB,yBAAyB,GAAG,KANhC,CAzBuB,CAiCvB;;AACAF,uBAAW,CAACp2B,KAAZ,GAAoBo2B,WAAW,CAACp2B,KAAZ,IAAqBlY,CAAC,CAACkY,KAA3C;AAEAo2B,uBAAW,CAACD,SAAD,CAAX,GAAyB5d,GAAG,CAACxE,IAAJ,CAASqiB,WAAW,CAACD,SAAD,CAApB,EAAiC,YAAY;AAClE,kBAAIlqB,YAAJ,EAAkB;AACdA,4BAAY,CAACvhB,KAAb,CAAmB,IAAnB,EAAyB0F,SAAzB;AACH;;AACDkmC,uCAAyB,GAAG,KAA5B;AACH,aALwB,CAAzB;AAOAF,uBAAW,CAACF,SAAD,CAAX,GAAyB3d,GAAG,CAACxE,IAAJ,CAASqiB,WAAW,CAACF,SAAD,CAApB,EAAiC,YAAY;AAElE,kBAAIG,YAAJ,EAAkB;AACdA,4BAAY,CAAC3rC,KAAb,CAAmB,IAAnB,EAAyB0F,SAAzB;AACH;;AACD,mBAAKytB,iBAAL,GAAyB,KAAzB;;AACA,kBAAI9H,EAAE,CAAC4C,QAAH,IAAe,IAAnB,EAAyB;AAAE;AAEvB;AACA;AACA;AACA,oBAAI4d,SAAS,GAAGzuC,CAAC,CAAC0vB,MAAF,IAAY,KAAKoD,QAAL,CAAcwD,MAA1C;AAAA,oBACIoY,SAAS,GAAGzgB,EAAE,CAACyB,MADnB;AAAA,oBAEIif,aAAa,GAAG1gB,EAAE,CAAC+L,WAAH,CAAe,CAAf,CAFpB;AAIA,oBAAO+Q,SAAS,GAAG,KAAKJ,UAAL,CAAgB8D,SAAhB,EAA2Bf,IAA3B,EAAiC,IAAjC,CAAnB;AAAA,oBACIn9B,GAAG,GAAG0d,EAAE,CAAC+M,OADb,CATqB,CAYrB;AACA;;AACA,oBAAI+P,SAAS,CAAC2B,cAAV,IAA4B,IAAhC,EAAsC;AAClC,sBAAIG,UAAU,GAAGzU,gBAAgB,CAACkS,SAAjB,CAA2B/5B,GAA3B,CAAjB;AAAA,sBACIu8B,MAAM,GAAG,KAAK5rB,OAAL,CAAa3Q,GAAb,CADb;AAAA,sBAEIo8B,YAAY,GAAG;AAAE7vC,wBAAI,EAAE+vC,UAAU,CAAC/vC,IAAX,GAAmB4xC,SAAS,CAAC/0C,CAAV,GAAcmzC,MAAM,CAAC,CAAD,CAA/C;AAAqDl8B,uBAAG,EAAEi8B,UAAU,CAACj8B,GAAX,GAAkB89B,SAAS,CAAC10C,CAAV,GAAc8yC,MAAM,CAAC,CAAD;AAAhG,mBAFnB;AAAA,sBAGIC,EAAE,GAAGhC,SAAS,CAAC2B,cAAV,CAAyBC,YAAzB,EAAuCE,UAAvC,EAAmDC,MAAnD,EAA2D/B,SAAS,CAACiC,iBAArE,CAHT;;AAKAjC,2BAAS,CAACpxC,CAAV,GAAcozC,EAAE,CAAC,CAAD,CAAhB;AACAhC,2BAAS,CAAC/wC,CAAV,GAAc+yC,EAAE,CAAC,CAAD,CAAhB;AACH;;AAED9e,kBAAE,CAACqa,SAAH,CAAayC,SAAb,EAAwB,IAAxB;AACA9c,kBAAE,CAACoE,OAAH;AACA,qBAAKA,OAAL,CAAapE,EAAE,CAACgR,SAAhB;;AACA,oBAAI0P,aAAa,IAAI,IAArB,EAA2B;AACvB,uBAAKtc,OAAL,CAAasc,aAAa,CAAC3a,QAA3B;AACH;AACJ;AACJ,aArCyD,CAqCxDvX,IArCwD,CAqCnD,IArCmD,CAAjC,CAAzB,CA3CuB,CAkFvB;;AACA,gBAAImyB,iBAAiB,GAAG,UAAUrlC,CAAV,EAAa;AACjC;AACA,kBAAIA,CAAC,CAAC4U,KAAF,KAAY,CAAZ,IAAiB5U,CAAC,CAAC6U,MAAF,KAAa,CAAlC,EAAqC;AACjC;AACH;;AAEDsvB,kBAAI,GAAG,KAAKxd,KAAL,CAAW,KAAKyI,UAAL,CAAgBiT,MAAM,CAACjjC,EAAvB,CAAX,CAAP,CANiC,CAMc;AAE/C;;AACA,kBAAI4iB,GAAG,GAAG,KAAKmS,yBAAL,CAA+BgQ,IAA/B,EAAqC7/B,IAArC,CAAV,CATiC,CAWjC;;AACA,kBAAI,CAAC0d,GAAG,CAACjT,OAAT,EAAkB;AACd;AACH,eAdgC,CAgBjC;;;AACA,kBAAItY,CAAC,CAAC2V,MAAN,EAAc;AACV,oBAAIjT,CAAC,GAAG+tB,GAAG,CAACpJ,QAAJ,CAAarnB,CAAC,CAAC2V,MAAf,IAAyB41B,cAAc,CAAChiC,CAAD,EAAIqiC,MAAM,CAACjjC,EAAX,EAAe3I,CAAC,CAAC2V,MAAjB,EAAyB,IAAzB,EAA+B3V,CAAC,CAAC8V,aAAjC,CAAvC,GAAyF9V,CAAC,CAAC2V,MAAF,CAASpM,CAAT,EAAYqiC,MAAM,CAACjjC,EAAnB,CAAjG;;AACA,oBAAIjG,CAAC,KAAK,KAAV,EAAiB;AACb;AACH;AACJ,eAtBgC,CAwBjC;;;AACA,kBAAImsC,WAAW,GAAG,KAAKjqB,MAAL,CAAY;AAACoK,sBAAM,EAAE0e;AAAT,eAAZ,EAA4BzyC,MAA9C;;AACA,kBAAIswB,GAAG,CAAC2gB,cAAJ,IAAsB,CAAtB,IAA4B2C,WAAW,IAAItjB,GAAG,CAAC2gB,cAAnD,EAAoE;AAChE,oBAAIgC,gBAAJ,EAAsB;AAClBA,kCAAgB,CAAC;AACblT,2BAAO,EAAE4Q,MAAM,CAACjjC,EADH;AAEbujC,kCAAc,EAAEA;AAFH,mBAAD,EAGb3iC,CAHa,CAAhB;AAIH;;AACD,uBAAO,KAAP;AACH,eAlCgC,CAoCjC;AACA;;;AACA,kBAAIulC,IAAI,GAAGt1C,IAAI,CAACy3B,OAAL,CAAa8d,oBAAb,CAAkCxlC,CAAlC,EAAqC4kC,IAArC,EAA2C3qB,KAA3C,CAAX,CAtCiC,CAwCjC;AACA;AACA;;AACA,kBAAIwrB,kBAAkB,GAAG,EAAzB;AACAx1C,kBAAI,CAACy3B,OAAL,CAAalH,MAAb,CAAoBilB,kBAApB,EAAwCzjB,GAAG,CAACA,GAA5C;AACAyjB,gCAAkB,CAACtQ,iBAAnB,GAAuC,IAAvC;AACAsQ,gCAAkB,CAACtf,MAAnB,GAA4B,CAAEof,IAAI,CAAC,CAAD,CAAN,EAAWA,IAAI,CAAC,CAAD,CAAf,EAAqB,CAArB,EAAwB,CAAxB,CAA5B;AACAE,gCAAkB,CAACV,WAAnB,GAAiCA,WAAjC;;AAEA,kBAAI/iB,GAAG,CAACA,GAAJ,CAAQrT,KAAZ,EAAmB;AACf82B,kCAAkB,CAAC92B,KAAnB,GAA2BqT,GAAG,CAACA,GAAJ,CAAQrT,KAAnC;AACH;;AAED+V,gBAAE,GAAG,KAAK6O,WAAL,CAAiB4Q,IAAjB,EAAuBsB,kBAAvB,CAAL;AACAR,uCAAyB,GAAG,IAA5B;AACAvgB,gBAAE,CAACuP,gBAAH,CAAoB,IAApB,EAvDiC,CAyDjC;AACA;AACA;;AACA,kBAAIjS,GAAG,CAACgS,cAAR,EAAwB;AACpB,oBAAI,CAAChS,GAAG,CAACqE,QAAT,EAAmB;AACfrE,qBAAG,CAACqE,QAAJ,GAAe3B,EAAf;AACAA,oBAAE,CAACuP,gBAAH,CAAoB,KAApB;AACH,iBAHD,MAIK;AACDvP,oBAAE,CAACwP,aAAH,GAAmBlS,GAAG,CAACqE,QAAvB;AACH;AACJ;;AAED,kBAAIqf,gBAAgB,GAAG,SAAnBA,gBAAmB,GAAY;AAC/B;AACA;AACA;AACA;AACA7W,gCAAgB,CAACvmB,GAAjB,CAAqBoc,EAAE,CAACuG,MAAxB,EAAgC,SAAhC,EAA2Cya,gBAA3C;;AACA7W,gCAAgB,CAACvmB,GAAjB,CAAqB+5B,MAAM,CAACjjC,EAA5B,EAAgC,SAAhC,EAA2CsmC,gBAA3C;;AACA,oBAAIT,yBAAJ,EAA+B;AAC3BA,2CAAyB,GAAG,KAA5B;;AACApW,kCAAgB,CAACsM,cAAjB,CAAgCzW,EAAhC;AACH;AACJ,eAXD;;AAaAmK,8BAAgB,CAAC3mB,EAAjB,CAAoBwc,EAAE,CAACuG,MAAvB,EAA+B,SAA/B,EAA0Cya,gBAA1C;;AACA7W,8BAAgB,CAAC3mB,EAAjB,CAAoBm6B,MAAM,CAACjjC,EAA3B,EAA+B,SAA/B,EAA0CsmC,gBAA1C,EApFiC,CAsFjC;;;AACA,kBAAIj9B,OAAO,GAAG,EAAd;;AACA,kBAAIuZ,GAAG,CAACA,GAAJ,CAAQ2jB,OAAZ,EAAqB;AACjB,qBAAK,IAAIC,GAAT,IAAgB5jB,GAAG,CAACA,GAAJ,CAAQ2jB,OAAxB,EAAiC;AAC7B,sBAAI/0C,CAAC,GAAG,CAACoP,CAAC,CAACC,UAAF,IAAgBD,CAAC,CAAC9B,MAAnB,EAA2BkE,YAA3B,CAAwCwjC,GAAxC,CAAR;;AACA,sBAAIh1C,CAAJ,EAAO;AACH6X,2BAAO,CAACuZ,GAAG,CAACA,GAAJ,CAAQ2jB,OAAR,CAAgBC,GAAhB,CAAD,CAAP,GAAgCh1C,CAAhC;AACH;AACJ;AACJ,eA/FgC,CAiGjC;AACA;;;AACAi+B,8BAAgB,CAACtmB,OAAjB,CAAyBmc,EAAE,CAACuG,MAA5B,EAAoC,WAApC,EAAiDjrB,CAAjD,EAAoDyI,OAApD;;AAEAye,iBAAG,CAACjd,OAAJ,CAAYjK,CAAZ;AAEH,aAvGuB,CAuGtBkT,IAvGsB,CAuGjB,IAvGiB,CAAxB;;AAyGA,iBAAKhL,EAAL,CAAQm6B,MAAM,CAACjjC,EAAf,EAAmB,WAAnB,EAAgCimC,iBAAhC;AACAvjB,gBAAI,CAACvZ,OAAL,GAAe88B,iBAAf,CA7LuB,CA+LvB;AACA;AACA;;AACA,gBAAI5uC,CAAC,CAAC2V,MAAF,KAAa8a,GAAG,CAACpJ,QAAJ,CAAarnB,CAAC,CAAC2V,MAAf,KAA0B8a,GAAG,CAAC/I,UAAJ,CAAe1nB,CAAC,CAAC2V,MAAjB,CAAvC,CAAJ,EAAsE;AAClEyiB,8BAAgB,CAACgX,aAAjB,CAA+BxD,MAAM,CAACjjC,EAAtC,EAA0C3I,CAAC,CAAC2V,MAA5C;AACH;;AAED,gBAAIk2B,WAAW,GAAGryC,IAAI,CAACy3B,OAAL,CAAalH,MAAb,CAAoB,EAApB,EAAwB/pB,CAAC,CAAC6rC,WAAF,IAAiB,EAAzC,CAAlB;;AAEAF,mCAAuB,CAACC,MAAD,EAAS5rC,CAAT,EAAY6rC,WAAZ,EAAyB,IAAzB,EAA+B7rC,CAAC,CAACipC,QAAF,KAAe,IAA9C,CAAvB;AAEH,WA1MQ,CA0MPxsB,IA1MO,CA0MF,IA1ME,CAFb;;AA8MA,cAAIulB,MAAM,GAAGr5B,EAAE,CAAC1N,MAAH,IAAa0N,EAAE,CAACO,WAAH,KAAmBC,MAAhC,GAAyCR,EAAzC,GAA8C,CAAEA,EAAF,CAA3D;;AACA,eAAK,IAAIpN,CAAC,GAAG,CAAR,EAAWikC,EAAE,GAAGwC,MAAM,CAAC/mC,MAA5B,EAAoCM,CAAC,GAAGikC,EAAxC,EAA4CjkC,CAAC,EAA7C,EAAiD;AAC7CkyC,kBAAM,CAACjV,KAAK,CAACwJ,MAAM,CAACzmC,CAAD,CAAP,CAAN,CAAN;AACH;;AAED,iBAAO,IAAP;AACH,SA3ND,CAl1D8D,CA+iE9D;;;AACA,aAAK8zC,YAAL,GAAoB,UAAU1mC,EAAV,EAAc0zB,cAAd,EAA8B0R,gBAA9B,EAAgD;AAChE,cAAI/N,IAAI,GAAGxH,KAAK,CAAC7vB,EAAD,CAAhB;;AACAyvB,0BAAgB,CAACpS,gBAAjB,CAAkCga,IAAI,CAACr3B,EAAvC,EAA2C,UAA3C;;AACA,cAAI2mC,MAAM,GAAG,KAAK5R,yBAAL,CAA+BsC,IAAI,CAAC1Z,EAApC,CAAb;;AACA,cAAIgpB,MAAJ,EAAY;AACR,iBAAK,IAAI/jB,GAAT,IAAgB+jB,MAAhB,EAAwB;AACpB,kBAAIjT,cAAc,IAAI,IAAlB,IAA0BA,cAAc,KAAK9Q,GAAjD,EAAsD;AAClD,oBAAIqjB,iBAAiB,GAAGU,MAAM,CAAC/jB,GAAD,CAAN,CAAYzZ,OAApC;;AACA,oBAAI88B,iBAAJ,EAAuB;AACnBxW,kCAAgB,CAACvmB,GAAjB,CAAqBmuB,IAAI,CAACr3B,EAA1B,EAA8B,WAA9B,EAA2CimC,iBAA3C;AACH;;AACD,oBAAI,CAACb,gBAAL,EAAuB;AACnB,yBAAO,KAAKrQ,yBAAL,CAA+BsC,IAAI,CAAC1Z,EAApC,EAAwCiF,GAAxC,CAAP;AACH;AACJ;AACJ;AACJ;;AAED,iBAAO,IAAP;AACH,SAnBD,CAhjE8D,CAqkE9D;;;AACA,aAAKgkB,iBAAL,GAAyB,YAAY;AACjC,eAAK,IAAIh0C,CAAT,IAAc,KAAKmiC,yBAAnB,EAA8C;AAC1CtF,4BAAgB,CAACiX,YAAjB,CAA8B9zC,CAA9B,EAAiC,IAAjC,EAAuC,IAAvC;AACH;;AAED,eAAKmiC,yBAAL,GAAiC,EAAjC;AACA,iBAAO,IAAP;AACH,SAPD;;AASA,YAAI8R,SAAS,GAAG,UAAU7mC,EAAV,EAAcspB,KAAd,EAAqBoK,cAArB,EAAqC;AACjDpK,eAAK,GAAGxB,GAAG,CAACtJ,OAAJ,CAAY8K,KAAZ,IAAqBA,KAArB,GAA6B,CAAEA,KAAF,CAArC;;AACA,cAAI3L,EAAE,GAAGsS,MAAM,CAACjwB,EAAD,CAAf;;AACA0zB,wBAAc,GAAGA,cAAc,IAAI,SAAnC;;AACA,eAAK,IAAI9gC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG02B,KAAK,CAACh3B,MAA1B,EAAkCM,CAAC,EAAnC,EAAuC;AACnC,gBAAI+zC,MAAM,GAAG,KAAKrd,KAAK,CAAC12B,CAAD,CAAV,EAAe+qB,EAAf,CAAb;;AACA,gBAAIgpB,MAAM,IAAIA,MAAM,CAACjT,cAAD,CAApB,EAAsC;AAClC,qBAAOiT,MAAM,CAACjT,cAAD,CAAN,CAAuB9Q,GAAvB,CAA2BrT,KAA3B,IAAoC,KAAK4a,QAAL,CAAcmF,KAAzD;AACH;AACJ;AACJ,SAVe,CAUdxb,IAVc,CAUT,IAVS,CAAhB;;AAYA,YAAIgzB,SAAS,GAAG,UAAU9mC,EAAV,EAAcuP,KAAd,EAAqB+Z,KAArB,EAA4BoK,cAA5B,EAA4C;AACxDpK,eAAK,GAAGxB,GAAG,CAACtJ,OAAJ,CAAY8K,KAAZ,IAAqBA,KAArB,GAA6B,CAAEA,KAAF,CAArC;;AACA,cAAI3L,EAAE,GAAGsS,MAAM,CAACjwB,EAAD,CAAf;;AACA0zB,wBAAc,GAAGA,cAAc,IAAI,SAAnC;;AACA,eAAK,IAAI9gC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG02B,KAAK,CAACh3B,MAA1B,EAAkCM,CAAC,EAAnC,EAAuC;AACnC,gBAAI+zC,MAAM,GAAG,KAAKrd,KAAK,CAAC12B,CAAD,CAAV,EAAe+qB,EAAf,CAAb;;AACA,gBAAIgpB,MAAM,IAAIA,MAAM,CAACjT,cAAD,CAApB,EAAsC;AAClCiT,oBAAM,CAACjT,cAAD,CAAN,CAAuB9Q,GAAvB,CAA2BrT,KAA3B,GAAmCA,KAAnC;AACH;AACJ;AAEJ,SAXe,CAWduE,IAXc,CAWT,IAXS,CAAhB;;AAaA,aAAKizB,QAAL,GAAgB,UAAU/mC,EAAV,EAAcuP,KAAd,EAAqB;AACjC,iBAAOs3B,SAAS,CAAC7mC,EAAD,EAAK,CAAE,2BAAF,EAA+B,2BAA/B,CAAL,CAAhB;AACH,SAFD;;AAGA,aAAKgnC,cAAL,GAAsB,UAAUhnC,EAAV,EAAc;AAChC,iBAAO6mC,SAAS,CAAC7mC,EAAD,EAAK,2BAAL,CAAhB;AACH,SAFD;;AAGA,aAAKinC,cAAL,GAAsB,UAAUjnC,EAAV,EAAc;AAChC,iBAAO6mC,SAAS,CAAC7mC,EAAD,EAAK,2BAAL,CAAhB;AACH,SAFD;;AAGA,aAAK+P,QAAL,GAAgB,UAAU/P,EAAV,EAAcuP,KAAd,EAAqBmkB,cAArB,EAAqC;AACjD,eAAKwT,cAAL,CAAoBlnC,EAApB,EAAwBuP,KAAxB,EAA+BmkB,cAA/B;AACA,eAAKyT,cAAL,CAAoBnnC,EAApB,EAAwBuP,KAAxB,EAA+BmkB,cAA/B;AACH,SAHD;;AAIA,aAAKwT,cAAL,GAAsB,UAAUlnC,EAAV,EAAcuP,KAAd,EAAqBmkB,cAArB,EAAqC;AACvDoT,mBAAS,CAAC9mC,EAAD,EAAKuP,KAAL,EAAY,2BAAZ,EAAyCmkB,cAAzC,CAAT,CADuD,CAEvD;;;AACA,eAAK0T,YAAL,CAAkBpnC,EAAlB,EAAsBuP,KAAtB;AACH,SAJD;;AAKA,aAAK43B,cAAL,GAAsB,UAAUnnC,EAAV,EAAcuP,KAAd,EAAqBmkB,cAArB,EAAqC;AACvDoT,mBAAS,CAAC9mC,EAAD,EAAKuP,KAAL,EAAY,2BAAZ,EAAyCmkB,cAAzC,CAAT;;AACA,eAAK2T,YAAL,CAAkBrnC,EAAlB,EAAsBuP,KAAtB;AACH,SAHD,CA1nE8D,CA+nE9D;;;AACA,aAAK+3B,iBAAL,GAAyB,YAAY;AACjC,eAAK,IAAI10C,CAAT,IAAc,KAAKoiC,yBAAnB,EAA8C;AAC1CvF,4BAAgB,CAAC0V,YAAjB,CAA8BvyC,CAA9B,EAAiC,IAAjC;AACH;;AAED,eAAKoiC,yBAAL,GAAiC,EAAjC;AACA,iBAAO,IAAP;AACH,SAPD,CAhoE8D,CAyoE9D;;;AACA,YAAIuS,WAAW,GAAG,UAAUriC,IAAV,EAAgBlF,EAAhB,EAAoBse,KAApB,EAA2BkpB,MAA3B,EAAmC9T,cAAnC,EAAmD;AACjE,cAAIt+B,CAAC,GAAG8P,IAAI,KAAK,QAAT,GAAoB,KAAK6vB,yBAAzB,GAAqD,KAAKC,yBAAlE;AAAA,cACIyS,aADJ;AAAA,cACmBpQ,IADnB;AAAA,cACyBqQ,QADzB;AAGAhU,wBAAc,GAAGA,cAAc,IAAI,SAAnC,CAJiE,CAMjE;;AACA,cAAI1zB,EAAE,CAAC1N,MAAH,IAAa,CAACw1B,GAAG,CAACpJ,QAAJ,CAAa1e,EAAb,CAAlB,EAAoC;AAChCynC,yBAAa,GAAG,EAAhB;;AACA,iBAAK,IAAI70C,CAAC,GAAG,CAAR,EAAWikC,EAAE,GAAG72B,EAAE,CAAC1N,MAAxB,EAAgCM,CAAC,GAAGikC,EAApC,EAAwCjkC,CAAC,EAAzC,EAA6C;AACzCykC,kBAAI,GAAGxH,KAAK,CAAC7vB,EAAE,CAACpN,CAAD,CAAH,CAAZ;;AACA,kBAAIwC,CAAC,CAACiiC,IAAI,CAAC1Z,EAAN,CAAD,IAAcvoB,CAAC,CAACiiC,IAAI,CAAC1Z,EAAN,CAAD,CAAW+V,cAAX,CAAlB,EAA8C;AAC1C+T,6BAAa,CAAC70C,CAAD,CAAb,GAAmBwC,CAAC,CAACiiC,IAAI,CAAC1Z,EAAN,CAAD,CAAW+V,cAAX,EAA2B/jB,OAA9C;AACA+3B,wBAAQ,GAAGF,MAAM,GAAG,CAACC,aAAa,CAAC70C,CAAD,CAAjB,GAAuB0rB,KAAxC;AACAlpB,iBAAC,CAACiiC,IAAI,CAAC1Z,EAAN,CAAD,CAAW+V,cAAX,EAA2B/jB,OAA3B,GAAqC+3B,QAArC;;AACAjY,gCAAgB,CAACiY,QAAQ,GAAG,aAAH,GAAmB,UAA5B,CAAhB,CAAwDrQ,IAAI,CAACr3B,EAA7D,EAAiE,SAASkF,IAAT,GAAgB,WAAjF;AACH;AACJ;AACJ,WAXD,CAYA;AAZA,eAaK;AACDmyB,kBAAI,GAAGxH,KAAK,CAAC7vB,EAAD,CAAZ;AACA,kBAAI2d,EAAE,GAAG0Z,IAAI,CAAC1Z,EAAd;;AACA,kBAAIvoB,CAAC,CAACuoB,EAAD,CAAD,IAASvoB,CAAC,CAACuoB,EAAD,CAAD,CAAM+V,cAAN,CAAb,EAAoC;AAChC+T,6BAAa,GAAGryC,CAAC,CAACuoB,EAAD,CAAD,CAAM+V,cAAN,EAAsB/jB,OAAtC;AACA+3B,wBAAQ,GAAGF,MAAM,GAAG,CAACC,aAAJ,GAAoBnpB,KAArC;AACAlpB,iBAAC,CAACuoB,EAAD,CAAD,CAAM+V,cAAN,EAAsB/jB,OAAtB,GAAgC+3B,QAAhC;;AACAjY,gCAAgB,CAACiY,QAAQ,GAAG,aAAH,GAAmB,UAA5B,CAAhB,CAAwDrQ,IAAI,CAACr3B,EAA7D,EAAiE,SAASkF,IAAT,GAAgB,WAAjF;AACH;AACJ;;AACD,iBAAOuiC,aAAP;AACH,SA/BiB,CA+BhB3zB,IA/BgB,CA+BX,IA/BW,CAAlB;;AAiCA,YAAI6zB,MAAM,GAAG,UAAU3nC,EAAV,EAAcpD,EAAd,EAAkB;AAC3B,cAAIkrB,GAAG,CAACpJ,QAAJ,CAAa1e,EAAb,KAAoB,CAACA,EAAE,CAAC1N,MAA5B,EAAoC;AAChC,mBAAOsK,EAAE,CAAC3C,KAAH,CAAS,IAAT,EAAe,CAAE+F,EAAF,CAAf,CAAP;AACH,WAFD,MAGK,IAAIA,EAAE,CAAC1N,MAAP,EAAe;AAChB,mBAAOsK,EAAE,CAAC3C,KAAH,CAAS,IAAT,EAAe,CAAE+F,EAAE,CAAC,CAAD,CAAJ,CAAf,CAAP;AACH;AAEJ,SARY,CAQX8T,IARW,CAQN,IARM,CAAb;;AAUA,aAAK8zB,mBAAL,GAA2B,UAAU5nC,EAAV,EAAc0zB,cAAd,EAA8B;AACrD6T,qBAAW,CAAC,QAAD,EAAWvnC,EAAX,EAAe,IAAf,EAAqB,IAArB,EAA2B0zB,cAA3B,CAAX;;AACA,iBAAO,KAAKmU,eAAL,CAAqB7nC,EAArB,EAAyB0zB,cAAzB,CAAP;AACH,SAHD;;AAKA,aAAKoU,gBAAL,GAAwB,UAAU9nC,EAAV,EAAcse,KAAd,EAAqBoV,cAArB,EAAqC;AACzD,iBAAO6T,WAAW,CAAC,QAAD,EAAWvnC,EAAX,EAAese,KAAf,EAAsB,IAAtB,EAA4BoV,cAA5B,CAAlB;AACH,SAFD;;AAGA,aAAK0M,QAAL,GAAgB,UAAUpgC,EAAV,EAAc0zB,cAAd,EAA8B;AAC1CA,wBAAc,GAAGA,cAAc,IAAI,SAAnC;AACA,iBAAOiU,MAAM,CAAC3nC,EAAD,EAAK,UAAU4H,GAAV,EAAe;AAC7B,gBAAI++B,MAAM,GAAG,KAAK5R,yBAAL,CAA+BlF,KAAK,CAACjoB,GAAD,CAAL,CAAW+V,EAA1C,CAAb;;AACA,mBAAOgpB,MAAM,IAAI,IAAV,IAAkBA,MAAM,CAACjT,cAAD,CAAN,IAA0B,IAAnD;AACH,WAHiB,CAGhB5f,IAHgB,CAGX,IAHW,CAAL,CAAb;AAIH,SAND;;AAOA,aAAK+zB,eAAL,GAAuB,UAAU7nC,EAAV,EAAc0zB,cAAd,EAA8B;AACjDA,wBAAc,GAAGA,cAAc,IAAI,SAAnC;AACA,iBAAOiU,MAAM,CAAC3nC,EAAD,EAAK,UAAU4H,GAAV,EAAe;AAC7B,gBAAIqzB,GAAG,GAAG,KAAKlG,yBAAL,CAA+BlF,KAAK,CAACjoB,GAAD,CAAL,CAAW+V,EAA1C,CAAV;;AACA,mBAAOsd,GAAG,IAAIA,GAAG,CAACvH,cAAD,CAAV,IAA8BuH,GAAG,CAACvH,cAAD,CAAH,CAAoB/jB,OAApB,KAAgC,IAArE;AACH,WAHiB,CAGhBmE,IAHgB,CAGX,IAHW,CAAL,CAAb;AAIH,SAND;;AAQA,aAAKi0B,mBAAL,GAA2B,UAAU/nC,EAAV,EAAc0zB,cAAd,EAA8B;AACrD6T,qBAAW,CAAC,QAAD,EAAWvnC,EAAX,EAAe,IAAf,EAAqB,IAArB,EAA2B0zB,cAA3B,CAAX;;AACA,iBAAO,KAAKsU,eAAL,CAAqBhoC,EAArB,EAAyB0zB,cAAzB,CAAP;AACH,SAHD;;AAKA,aAAK4M,QAAL,GAAgB,UAAUtgC,EAAV,EAAc0zB,cAAd,EAA8B;AAC1CA,wBAAc,GAAGA,cAAc,IAAI,SAAnC;AACA,iBAAOiU,MAAM,CAAC3nC,EAAD,EAAK,UAAU4H,GAAV,EAAe;AAC7B,gBAAI++B,MAAM,GAAG,KAAK3R,yBAAL,CAA+BnF,KAAK,CAACjoB,GAAD,CAAL,CAAW+V,EAA1C,CAAb;;AACA,mBAAOgpB,MAAM,IAAI,IAAV,IAAkBA,MAAM,CAACjT,cAAD,CAAN,IAA0B,IAAnD;AACH,WAHiB,CAGhB5f,IAHgB,CAGX,IAHW,CAAL,CAAb;AAIH,SAND;;AAOA,aAAKk0B,eAAL,GAAuB,UAAUhoC,EAAV,EAAc0zB,cAAd,EAA8B;AACjDA,wBAAc,GAAGA,cAAc,IAAI,SAAnC;AACA,iBAAOiU,MAAM,CAAC3nC,EAAD,EAAK,UAAU4H,GAAV,EAAe;AAC7B,gBAAI4sB,GAAG,GAAG,KAAKQ,yBAAL,CAA+BnF,KAAK,CAACjoB,GAAD,CAAL,CAAW+V,EAA1C,CAAV;;AACA,mBAAO6W,GAAG,IAAIA,GAAG,CAACd,cAAD,CAAV,IAA8Bc,GAAG,CAACd,cAAD,CAAH,CAAoB/jB,OAApB,KAAgC,IAArE;AACH,WAHiB,CAGhBmE,IAHgB,CAGX,IAHW,CAAL,CAAb;AAIH,SAND;;AAOA,aAAKm0B,gBAAL,GAAwB,UAAUjoC,EAAV,EAAcse,KAAd,EAAqBoV,cAArB,EAAqC;AACzD,iBAAO6T,WAAW,CAAC,QAAD,EAAWvnC,EAAX,EAAese,KAAf,EAAsB,IAAtB,EAA4BoV,cAA5B,CAAlB;AACH,SAFD,CA/tE8D,CAmuEtE;;;AAEQ,aAAKwU,KAAL,GAAa,UAAUtrC,EAAV,EAAc;AACvB6yB,0BAAgB,CAAC3b,IAAjB,CAAsB,OAAtB,EAA+BlX,EAA/B;AACH,SAFD;;AAIA,YAAIurC,OAAO,GAAG,SAAVA,OAAU,CAASnoC,EAAT,EAAapD,EAAb,EAAiB;AAC3B;AACA,cAAI,OAAOoD,EAAP,KAAc,QAAd,IAA0BA,EAAE,CAAC1N,MAAjC,EAAyC;AACrC,iBAAK,IAAIM,CAAC,GAAG,CAAR,EAAWikC,EAAE,GAAG72B,EAAE,CAAC1N,MAAxB,EAAgCM,CAAC,GAAGikC,EAApC,EAAwCjkC,CAAC,EAAzC,EAA6C;AACzCgK,gBAAE,CAACoD,EAAE,CAACpN,CAAD,CAAH,CAAF;AACH;AACJ,WAJD,MAKK;AAAC;AACFgK,cAAE,CAACoD,EAAD,CAAF;AACH;;AAED,iBAAOyvB,gBAAP;AACH,SAZD,CAzuE8D,CAuvE9D;;;AACA,aAAK/F,OAAL,GAAe,UAAU1pB,EAAV,EAAcsyB,EAAd,EAAkB5J,SAAlB,EAA6B;AACxC,iBAAOyf,OAAO,CAACnoC,EAAD,EAAK,UAAS4H,GAAT,EAAc;AAC7BwqB,iBAAK,CAACxqB,GAAD,EAAM0qB,EAAN,EAAU5J,SAAV,CAAL;AACH,WAFa,CAAd;AAGH,SAJD;;AAMA,aAAKb,UAAL,GAAkB,UAAU7nB,EAAV,EAAc0oB,SAAd,EAAyB0f,WAAzB,EAAsC;AACpD,iBAAOD,OAAO,CAACnoC,EAAD,EAAK,UAAS4H,GAAT,EAAc;AAC7B,gBAAI0f,IAAI,GAAG8gB,WAAW,GAAGxgC,GAAH,GAAS6nB,gBAAgB,CAAClI,KAAjB,CAAuB3f,GAAvB,CAA/B;;AACA6nB,4BAAgB,CAACqS,YAAjB,CAA8B;AAAExa,kBAAI,EAAEA,IAAR;AAAckG,oBAAM,EAAE,IAAtB;AAA4B9E,uBAAS,EAACA;AAAtC,aAA9B;;AACA,gBAAI6T,EAAE,GAAG9M,gBAAgB,CAACgH,cAAjB,EAAT;;AACA,gBAAI8F,EAAJ,EAAQ;AACJA,gBAAE,CAAC8L,aAAH,CAAiB/gB,IAAjB;AACH;;AACDmI,4BAAgB,CAAC/F,OAAjB,CAAyB9hB,GAAzB;AACH,WARa,CAAd;AASH,SAVD,CA9vE8D,CA0wE9D;;;AACA,aAAKsoB,iBAAL,GAAyB,YAAY;AACjC;AACA;AACA;AACA,cAAIxH,SAAS,GAAGX,UAAU,EAA1B;AAAA,cAA8BT,IAA9B;;AAEA,eAAKA,IAAL,IAAagK,kBAAb,EAAiC;AAC7B7B,4BAAgB,CAACqS,YAAjB,CAA8B;AAAExa,kBAAI,EAAEA,IAAR;AAAckG,oBAAM,EAAE,IAAtB;AAA4B9E,uBAAS,EAAEA;AAAvC,aAA9B;AACH;;AAED,eAAKpB,IAAL,IAAagK,kBAAb,EAAiC;AAC7Bc,iBAAK,CAAC9K,IAAD,EAAO,IAAP,EAAaoB,SAAb,CAAL;AACH;;AAED,iBAAO,IAAP;AACH,SAfD;;AAiBA,aAAK4f,kBAAL,GAA0B,UAAUtoC,EAAV,EAAcuoC,OAAd,EAAuB3f,gBAAvB,EAAyC;AAC/DA,0BAAgB,GAAGA,gBAAgB,IAAI,EAAvC;;AACA,cAAIvnB,IAAI,GAAG,SAAPA,IAAO,CAAUuG,GAAV,EAAe;AACtB,gBAAIyvB,IAAI,GAAGxH,KAAK,CAACjoB,GAAD,CAAhB;AAAA,gBACI4gC,GAAG,GAAGlX,kBAAkB,CAAC+F,IAAI,CAAC1Z,EAAN,CAD5B;AAAA,gBAEI/qB,CAFJ;AAAA,gBAEOikC,EAFP;;AAIA,gBAAI2R,GAAJ,EAAS;AACL5f,8BAAgB,CAACtxB,IAAjB,CAAsB+/B,IAAtB;;AACA,mBAAKzkC,CAAC,GAAG,CAAJ,EAAOikC,EAAE,GAAG2R,GAAG,CAACl2C,MAArB,EAA6BM,CAAC,GAAGikC,EAAjC,EAAqCjkC,CAAC,EAAtC,EAA0C;AACtC68B,gCAAgB,CAACsM,cAAjB,CAAgCyM,GAAG,CAAC51C,CAAD,CAAnC,EAAwC,KAAxC;AACH;AACJ;;AACD,mBAAO0+B,kBAAkB,CAAC+F,IAAI,CAAC1Z,EAAN,CAAzB;;AAEA,gBAAI4qB,OAAJ,EAAa;AACT,kBAAIlR,IAAI,CAACr3B,EAAL,IAAWq3B,IAAI,CAACr3B,EAAL,CAAQ8vB,QAAR,KAAqB,CAAhC,IAAqCuH,IAAI,CAACr3B,EAAL,CAAQ8vB,QAAR,KAAqB,CAA9D,EAAiE;AAC7D,qBAAKl9B,CAAC,GAAG,CAAJ,EAAOikC,EAAE,GAAGQ,IAAI,CAACr3B,EAAL,CAAQyoC,UAAR,CAAmBn2C,MAApC,EAA4CM,CAAC,GAAGikC,EAAhD,EAAoDjkC,CAAC,EAArD,EAAyD;AACrDyO,sBAAI,CAACg2B,IAAI,CAACr3B,EAAL,CAAQyoC,UAAR,CAAmB71C,CAAnB,CAAD,CAAJ;AACH;AACJ;AACJ;AAEJ,WArBD;;AAsBAyO,cAAI,CAACrB,EAAD,CAAJ;;AACA,iBAAO,IAAP;AACH,SA1BD;;AA4BA,YAAI0oC,SAAS,GAAG,SAAZA,SAAY,CAASrR,IAAT,EAAezO,gBAAf,EAAiC;AAC7C6G,0BAAgB,CAAC6Y,kBAAjB,CAAoCjR,IAAI,CAAC1Z,EAAzC,EAA6C,IAA7C,EAAmDiL,gBAAnD;;AACA,cAAI2T,EAAE,GAAG9M,gBAAgB,CAACgH,cAAjB,EAAT;;AACA,cAAIp1B,IAAI,GAAG,SAAPA,IAAO,CAASwuB,KAAT,EAAgB;AAEvB,gBAAI0M,EAAJ,EAAQ;AACJA,gBAAE,CAACpf,cAAH,CAAkB0S,KAAK,CAAClS,EAAxB;AACH;;AACD8R,4BAAgB,CAACuG,MAAjB,CAAwB7Y,cAAxB,CAAuC0S,KAAK,CAAClS,EAA7C;;AAEA,gBAAI8R,gBAAgB,CAAC2Q,QAAjB,CAA0BvQ,KAAK,CAAC7vB,EAAhC,CAAJ,EAAyC;AACrCyvB,8BAAgB,CAACiX,YAAjB,CAA8B7W,KAAK,CAAC7vB,EAApC;AACH;;AACD,gBAAIyvB,gBAAgB,CAAC6Q,QAAjB,CAA0BzQ,KAAK,CAAC7vB,EAAhC,CAAJ,EAAyC;AACrCyvB,8BAAgB,CAAC0V,YAAjB,CAA8BtV,KAAK,CAAC7vB,EAApC;AACH;;AACDyvB,4BAAgB,CAACrS,gBAAjB,CAAkCyS,KAAK,CAAC7vB,EAAxC;;AACAyvB,4BAAgB,CAACpS,gBAAjB,CAAkCwS,KAAK,CAAC7vB,EAAxC;;AAGA,mBAAOyvB,gBAAgB,CAACkZ,mBAAjB,CAAqC9Y,KAAK,CAAClS,EAA3C,CAAP;AACA,mBAAOsT,eAAe,CAACpB,KAAK,CAAClS,EAAP,CAAtB;AACA,mBAAO6T,OAAO,CAAC3B,KAAK,CAAClS,EAAP,CAAd;;AACA,gBAAIkS,KAAK,CAAC7vB,EAAV,EAAc;AACVyvB,8BAAgB,CAACmZ,aAAjB,CAA+B/Y,KAAK,CAAC7vB,EAArC;;AACA6vB,mBAAK,CAAC7vB,EAAN,CAASkoB,QAAT,GAAoB,IAApB;AACH;AACJ,WAxBD,CAH6C,CA6B7C;;;AACA,eAAK,IAAI2gB,EAAE,GAAG,CAAd,EAAiBA,EAAE,GAAGjgB,gBAAgB,CAACt2B,MAAvC,EAA+Cu2C,EAAE,EAAjD,EAAqD;AACjDxnC,gBAAI,CAACunB,gBAAgB,CAACigB,EAAD,CAAjB,CAAJ;AACH,WAhC4C,CAiC7C;;;AACAxnC,cAAI,CAACg2B,IAAD,CAAJ;AACH,SAnCD;AAqCA;;;;;;;AAKA,aAAKzuB,MAAL,GAAc,UAAU5I,EAAV,EAAckpB,YAAd,EAA4B;AACtC,cAAImO,IAAI,GAAGxH,KAAK,CAAC7vB,EAAD,CAAhB;AAAA,cAAsB4oB,gBAAgB,GAAG,EAAzC;;AACA,cAAIyO,IAAI,CAACtH,IAAL,IAAasH,IAAI,CAACr3B,EAAL,CAAQG,UAAzB,EAAqC;AACjCk3B,gBAAI,CAACr3B,EAAL,CAAQG,UAAR,CAAmB0I,WAAnB,CAA+BwuB,IAAI,CAACr3B,EAApC;AACH,WAFD,MAGK,IAAIq3B,IAAI,CAAC1Z,EAAT,EAAa;AACd8R,4BAAgB,CAAC4N,KAAjB,CAAuB,YAAY;AAC/BqL,uBAAS,CAACrR,IAAD,EAAOzO,gBAAP,CAAT;AACH,aAFD,EAEGM,YAAY,KAAK,IAFpB;AAGH;;AACD,iBAAOuG,gBAAP;AACH,SAXD;;AAaA,aAAKqZ,KAAL,GAAa,UAAU9oC,EAAV,EAAckpB,YAAd,EAA4B;AACrC,cAAIN,gBAAgB,GAAG,EAAvB;;AACA,cAAIvnB,IAAI,GAAG,SAAPA,IAAO,CAASrB,EAAT,EAAa+oC,eAAb,EAA8B;AACrC,gBAAI1R,IAAI,GAAGxH,KAAK,CAAC7vB,EAAD,CAAhB;;AACA,gBAAIq3B,IAAI,CAACtH,IAAT,EAAe;AACXsH,kBAAI,CAACr3B,EAAL,CAAQG,UAAR,CAAmB0I,WAAnB,CAA+BwuB,IAAI,CAACr3B,EAApC;AACH,aAFD,MAGK,IAAIq3B,IAAI,CAACr3B,EAAT,EAAa;AACd,qBAAMq3B,IAAI,CAACr3B,EAAL,CAAQyoC,UAAR,CAAmBn2C,MAAnB,GAA4B,CAAlC,EAAqC;AACjC+O,oBAAI,CAACg2B,IAAI,CAACr3B,EAAL,CAAQyoC,UAAR,CAAmB,CAAnB,CAAD,CAAJ;AACH;;AACD,kBAAI,CAACM,eAAL,EAAsB;AAClBL,yBAAS,CAACrR,IAAD,EAAOzO,gBAAP,CAAT;AACH;AACJ;AACJ,WAbD;;AAeA6G,0BAAgB,CAAC4N,KAAjB,CAAuB,YAAW;AAC9Bh8B,gBAAI,CAACrB,EAAD,EAAK,IAAL,CAAJ;AACH,WAFD,EAEGkpB,YAAY,KAAK,KAFpB;;AAIA,iBAAOuG,gBAAP;AACH,SAtBD;;AAwBA,aAAKnS,KAAL,GAAa,UAAU0rB,iCAAV,EAA6C;AACtDvZ,0BAAgB,CAAC3K,QAAjB,CAA0B,YAAW;AACjCgc,2BAAe,GAAG,KAAlB;;AACArR,4BAAgB,CAACwZ,eAAjB;;AACAxZ,4BAAgB,CAACyZ,kBAAjB;;AACAzZ,4BAAgB,CAAC2M,mBAAjB;;AACA,gBAAI,CAAC4M,iCAAL,EAAwC;AACpCvZ,8BAAgB,CAAC5Y,MAAjB;AACH;;AACD,iBAAKme,yBAAL,GAAiC,EAAjC;AACA,iBAAKD,yBAAL,GAAiC,EAAjC;AACA1D,uBAAW,CAAC/+B,MAAZ,GAAqB,CAArB;;AACA,gBAAI,KAAK62C,OAAT,EAAkB;AACd,mBAAKA,OAAL;AACH;AACJ,WAdyB,CAcxBr1B,IAdwB,CAcnB,IAdmB,CAA1B;AAeH,SAhBD;;AAkBA,YAAIs1B,YAAY,GAAG,SAAfA,YAAe,CAAUroC,GAAV,EAAe;AAC9B,cAAIA,GAAG,CAAC8qB,MAAJ,IAAc9qB,GAAG,CAAC8qB,MAAJ,CAAW1rB,UAA7B,EAAyC;AACrCY,eAAG,CAAC8qB,MAAJ,CAAW1rB,UAAX,CAAsB0I,WAAtB,CAAkC9H,GAAG,CAAC8qB,MAAtC;AACH;;AACD9qB,aAAG,CAACm8B,OAAJ;AACAn8B,aAAG,CAAC8Y,OAAJ;AACH,SAND;;AAQA,aAAKwvB,KAAL,GAAa,YAAY;AACrB5Z,0BAAgB,CAACxT,MAAjB,GAA0BsG,IAA1B,CAA+B6mB,YAA/B;;AACA3Z,0BAAgB,CAACe,eAAjB,GAAmCjO,IAAnC,CAAwC6mB,YAAxC;;AAEA9X,4BAAkB,GAAG,EAArB;AACAC,yBAAe,GAAG,EAAlB;AACH,SAND;;AAQA,aAAK+X,eAAL,GAAuB,UAAU/5B,KAAV,EAAiB;AACpCwiB,uBAAa,GAAGxiB,KAAhB;AACA,iBAAOkgB,gBAAP;AACH,SAHD;;AAKA,aAAKoU,2BAAL,GAAmC,UAAS3+B,IAAT,EAAeqkC,kBAAf,EAAmC;AAClE,cAAIC,IAAI,GAAG,CAAC,CAACD,kBAAkB,GAAG,EAAH,GAAQ,UAA3B,IAAyCrkC,IAA1C,EAAgD5C,KAAhD,CAAsD,MAAtD,CAAX;AAAA,cAA0EshC,GAAG,GAAG,IAAhF;AAAA,cAAsFte,EAAE,GAAG,IAA3F;AAAA,cAAiGlwB,CAAC,GAAG,IAArG;AAAA,cAA2Gq0C,EAAE,GAAG,IAAhH;;AACA,eAAK,IAAI72C,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG42C,IAAI,CAACl3C,MAAzB,EAAiCM,CAAC,EAAlC,EAAsC;AAClC,gBAAI+N,EAAE,GAAG8uB,gBAAgB,CAACjG,OAAjB,CAAyBggB,IAAI,CAAC52C,CAAD,CAA7B,EAAkC,YAAlC,CAAT;;AACA,gBAAI+N,EAAJ,EAAQ;AACJ,kBAAIA,EAAE,CAAC+mB,SAAP,EAAkB;AACdkc,mBAAG,GAAGjjC,EAAE,CAAC+mB,SAAT;AACH;;AACD,kBAAI/mB,EAAE,CAACsmB,QAAP,EAAiB;AACb3B,kBAAE,GAAG3kB,EAAE,CAACsmB,QAAR;AACH;;AACD,kBAAItmB,EAAE,CAACmzB,OAAP,EAAgB;AACZ2V,kBAAE,GAAG9oC,EAAE,CAACmzB,OAAR;AACH;;AACD,kBAAInzB,EAAE,CAAComB,MAAP,EAAe;AACX3xB,iBAAC,GAAGuL,EAAE,CAAComB,MAAP;AACH;AACJ;AACJ;;AACD,iBAAO;AAAEW,qBAAS,EAAEkc,GAAG,GAAGA,GAAH,GAAS,CAAEte,EAAF,EAAMA,EAAN,CAAzB;AAAqCwO,mBAAO,EAAE2V,EAAE,GAAGA,EAAH,GAAQ,CAACr0C,CAAD,EAAIA,CAAJ;AAAxD,WAAP;AACH,SApBD,CA96E8D,CAo8E9D;;;AACA,aAAKs0C,KAAL,GAAa,UAAU1pC,EAAV,EAAc2pC,KAAd,EAAqBC,iBAArB,EAAwC;AACjD;AACA,cAAIjsB,EAAJ;;AAEA,cAAImK,GAAG,CAACpJ,QAAJ,CAAa1e,EAAb,CAAJ,EAAsB;AAClB2d,cAAE,GAAG3d,EAAL;AACH,WAFD,MAGK;AACDA,cAAE,GAAG,KAAKgwB,UAAL,CAAgBhwB,EAAhB,CAAL;AACA2d,cAAE,GAAG,KAAK4J,KAAL,CAAWvnB,EAAX,CAAL;AACH;;AAED,cAAI6pC,MAAM,GAAG,KAAKxL,cAAL,CAAoB;AAAChY,kBAAM,EAAE1I,EAAT;AAAapO,iBAAK,EAAE;AAApB,WAApB,EAA8C,IAA9C,CAAb;AAAA,cACIu6B,MAAM,GAAG,KAAKzL,cAAL,CAAoB;AAACv/B,kBAAM,EAAE6e,EAAT;AAAapO,iBAAK,EAAE;AAApB,WAApB,EAA8C,IAA9C,CADb;AAGAo6B,eAAK,GAAG,KAAKA,KAAb;;AAEA,cAAI,CAACC,iBAAL,EAAwB;AACpB5pC,cAAE,GAAG,KAAKgwB,UAAL,CAAgBrS,EAAhB,CAAL;AACA,iBAAK1a,YAAL,CAAkBjD,EAAlB,EAAsB,IAAtB,EAA4B2pC,KAA5B;AACH,WAHD,MAIK;AACD3pC,cAAE,GAAG,KAAKgwB,UAAL,CAAgB2Z,KAAhB,CAAL;AACH;;AAEDrY,4BAAkB,CAACqY,KAAD,CAAlB,GAA4BrY,kBAAkB,CAAC3T,EAAD,CAAlB,IAA0B,EAAtD;;AACA,eAAK,IAAI/qB,CAAC,GAAG,CAAR,EAAWikC,EAAE,GAAGvF,kBAAkB,CAACqY,KAAD,CAAlB,CAA0Br3C,MAA/C,EAAuDM,CAAC,GAAGikC,EAA3D,EAA+DjkC,CAAC,EAAhE,EAAoE;AAChE0+B,8BAAkB,CAACqY,KAAD,CAAlB,CAA0B/2C,CAA1B,EAA6Bm3C,YAA7B,CAA0CJ,KAA1C;AACArY,8BAAkB,CAACqY,KAAD,CAAlB,CAA0B/2C,CAA1B,EAA6Bo3C,mBAA7B,CAAiDhqC,EAAjD;AACH;;AACD,iBAAOsxB,kBAAkB,CAAC3T,EAAD,CAAzB;AAEA,eAAKoX,yBAAL,CAA+B4U,KAA/B,IAAwC,KAAK5U,yBAAL,CAA+BpX,EAA/B,CAAxC;AACA,iBAAO,KAAKoX,yBAAL,CAA+BpX,EAA/B,CAAP;AACA,eAAKqX,yBAAL,CAA+B2U,KAA/B,IAAwC,KAAK3U,yBAAL,CAA+BrX,EAA/B,CAAxC;AACA,iBAAO,KAAKqX,yBAAL,CAA+BrX,EAA/B,CAAP;AAEA,eAAKqY,MAAL,CAAYiU,QAAZ,CAAqBtsB,EAArB,EAAyBgsB,KAAzB;AACA,cAAIpN,EAAE,GAAG,KAAK9F,cAAL,EAAT;;AACA,cAAI8F,EAAJ,EAAQ;AACJA,cAAE,CAAC0N,QAAH,CAAYtsB,EAAZ,EAAgBgsB,KAAhB;AACH;;AACD1Y,yBAAe,CAAC0Y,KAAD,CAAf,GAAyB1Y,eAAe,CAACtT,EAAD,CAAxC;AACA,iBAAOsT,eAAe,CAACtT,EAAD,CAAtB;;AAEA,cAAIusB,MAAM,GAAG,SAATA,MAAS,CAAUzqC,IAAV,EAAgB0qC,KAAhB,EAAuBjlC,IAAvB,EAA6B;AACtC,iBAAK,IAAItS,CAAC,GAAG,CAAR,EAAWikC,EAAE,GAAGp3B,IAAI,CAACnN,MAA1B,EAAkCM,CAAC,GAAGikC,EAAtC,EAA0CjkC,CAAC,EAA3C,EAA+C;AAC3C6M,kBAAI,CAAC7M,CAAD,CAAJ,CAAQ80B,SAAR,CAAkByiB,KAAlB,EAAyBJ,YAAzB,CAAsCJ,KAAtC;AACAlqC,kBAAI,CAAC7M,CAAD,CAAJ,CAAQ80B,SAAR,CAAkByiB,KAAlB,EAAyBH,mBAAzB,CAA6ChqC,EAA7C;AACAP,kBAAI,CAAC7M,CAAD,CAAJ,CAAQsS,IAAI,GAAG,IAAf,IAAuBykC,KAAvB;AACAlqC,kBAAI,CAAC7M,CAAD,CAAJ,CAAQsS,IAAR,IAAgBlF,EAAhB;AACH;AACJ,WAPD;;AAQAkqC,gBAAM,CAACL,MAAD,EAAS,CAAT,EAAY,QAAZ,CAAN;;AACAK,gBAAM,CAACJ,MAAD,EAAS,CAAT,EAAY,QAAZ,CAAN;;AAEA,eAAKpgB,OAAL,CAAaigB,KAAb;AACH,SAzDD;;AA2DA,aAAKS,WAAL,GAAmB,UAAUC,QAAV,EAAoB;AACnC3xC,aAAG,GAAG2xC,QAAN;AACH,SAFD;;AAIA,aAAK/N,iBAAL,GAAyB,UAAU3tB,GAAV,EAAe27B,iBAAf,EAAkC;AACvD,cAAIC,MAAM,GAAG1Y,eAAb;AACAA,yBAAe,GAAGljB,GAAlB;;AACA,cAAIA,GAAJ,EAAS;AACLmjB,wBAAY,GAAG,IAAIv5B,IAAJ,GAAWC,OAAX,EAAf;AACH,WAFD,MAEO;AACHs5B,wBAAY,GAAG,IAAf;AACH;;AACD,cAAIwY,iBAAJ,EAAuB;AACnB,iBAAKpa,iBAAL;AACH;;AACD,iBAAOqa,MAAP;AACH,SAZD,CApgF8D,CAkhF9D;;;AACA,aAAKhd,gBAAL,GAAwB,YAAY;AAChC,iBAAOsE,eAAP;AACH,SAFD,CAnhF8D,CAuhF9D;;;AACA,aAAK2Y,cAAL,GAAsB,YAAY;AAC9B,iBAAO1Y,YAAP;AACH,SAFD;;AAIA,aAAKuL,KAAL,GAAa,UAAUzgC,EAAV,EAAc6tC,sBAAd,EAAsC;AAC/C,cAAIC,aAAa,GAAG,KAAKnd,gBAAL,EAApB;;AACA,cAAI,CAACmd,aAAL,EAAoB;AAChB,iBAAKpO,iBAAL,CAAuB,IAAvB;AACH;;AACD,cAAI;AACA1/B,cAAE;AACL,WAFD,CAGA,OAAOgE,CAAP,EAAU;AACNknB,eAAG,CAACpvB,GAAJ,CAAQ,qCAAR,EAA+CkI,CAA/C;AACH;;AACD,cAAI,CAAC8pC,aAAL,EAAoB;AAChB,iBAAKpO,iBAAL,CAAuB,KAAvB,EAA8B,CAACmO,sBAA/B;AACH;AACJ,SAdD;;AAgBA,aAAKE,gBAAL,GAAwB,KAAKtN,KAA7B;AAEA,aAAKuN,aAAL,GAAqBlT,cAArB;AACA,aAAKhP,SAAL,GAAiBX,UAAjB;;AACA,aAAK8iB,IAAL,GAAY,UAAU7qC,EAAV,EAAcy3B,eAAd,EAA+B;AACvCP,qBAAW,CAACl3B,EAAD,EAAK,OAAL,EAAcy3B,eAAd,CAAX;;AACA,iBAAOhI,gBAAP;AACH,SAHD,CAhjF8D,CAqjF9D;;;AACA,aAAKqb,aAAL,GAAqBtT,cAArB;AACA,aAAKuT,WAAL,GAAmB,KAAKj3B,IAAxB;AAEA,YAAI60B,mBAAmB,GAAG,EAA1B;;AACA,aAAKqC,0BAAL,GAAkC,UAAS3T,IAAT,EAAe9R,IAAf,EAAqBD,EAArB,EAAyB;AACvDqjB,6BAAmB,CAACtR,IAAI,CAAC1Z,EAAN,CAAnB,GAA+B4H,IAA/B,CADuD,CAEvD;AACA;;AACAuC,aAAG,CAAC9G,SAAJ,CAAcsQ,kBAAd,EAAkC+F,IAAI,CAAC1Z,EAAvC,EAA2C2H,EAA3C;AACH,SALD;;AAMA,aAAK2lB,wBAAL,GAAgC,UAASttB,EAAT,EAAa;AACzC,iBAAOgrB,mBAAmB,CAAChrB,EAAD,CAA1B;AACH,SAFD;;AAIA,aAAKqI,WAAL,GAAmB,IAAIn1B,IAAI,CAACy1B,kBAAT,CAA4B,IAA5B,EAAkC,KAAK6D,QAAL,CAAc2E,SAAhD,CAAnB;AACH,OArkFD;;AAukFAhH,SAAG,CAAC1G,MAAJ,CAAWvwB,IAAI,CAAC60B,eAAhB,EAAiCoC,GAAG,CAACpE,cAArC,EAAqD;AACjDzgB,oBAAY,EAAE,sBAAUjD,EAAV,EAAc5K,CAAd,EAAiB5D,CAAjB,EAAoB;AAC9B,eAAKyR,YAAL,CAAkBjD,EAAlB,EAAsB5K,CAAtB,EAAyB5D,CAAzB;AACH,SAHgD;AAIjDwR,oBAAY,EAAE,sBAAUhD,EAAV,EAAc5K,CAAd,EAAiB;AAC3B,iBAAO,KAAK4N,YAAL,CAAkBnS,IAAI,CAACy3B,OAAL,CAAa0H,UAAb,CAAwBhwB,EAAxB,CAAlB,EAA+C5K,CAA/C,CAAP;AACH,SANgD;AAOjDw1B,gCAAwB,EAAE,kCAAS7M,IAAT,EAAe;AACrC,cAAI+J,GAAG,CAACpJ,QAAJ,CAAaX,IAAb,CAAJ,EAAwB;AACpBA,gBAAI,GAAG,CAAEA,IAAF,EAAQ,EAAR,CAAP;AACH;;AACDA,cAAI,CAAC,CAAD,CAAJ,CAAQJ,EAAR,GAAaI,IAAI,CAAC,CAAD,CAAJ,CAAQJ,EAAR,IAAcmK,GAAG,CAACpY,IAAJ,EAA3B;AACA,iBAAOqO,IAAP;AACH,SAbgD;AAcjDmtB,8BAAsB,EAAE,gCAAUvtB,EAAV,EAAczY,IAAd,EAAoB;AACxC,eAAKqqB,gBAAL,CAAsB5R,EAAtB,IAA4B9sB,IAAI,CAACy3B,OAAL,CAAalH,MAAb,CAAoB,EAApB,EAAwBlc,IAAxB,CAA5B;;AACA,cAAIA,IAAI,CAACslB,QAAT,EAAmB;AACf,gBAAI2gB,EAAE,GAAG,EAAT;;AACA,iBAAK,IAAIv4C,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGsS,IAAI,CAACslB,QAAL,CAAcl4B,MAAlC,EAA0CM,CAAC,EAA3C,EAA+C;AAC3C;AACA;AACA,kBAAI+3B,EAAE,GAAG,KAAKC,wBAAL,CAA8B1lB,IAAI,CAACslB,QAAL,CAAc53B,CAAd,CAA9B,CAAT;AACAu4C,gBAAE,CAACxgB,EAAE,CAAC,CAAD,CAAF,CAAMhN,EAAP,CAAF,GAAegN,EAAf;AACH;;AACD,iBAAK4E,gBAAL,CAAsB5R,EAAtB,EAA0B6M,QAA1B,GAAqC2gB,EAArC;AACH;AACJ,SA1BgD;AA2BjDC,+BAAuB,EAAE,iCAAU9hB,KAAV,EAAiB;AACtC,eAAK,IAAI12B,CAAT,IAAc02B,KAAd,EAAqB;AACjB,iBAAK4hB,sBAAL,CAA4Bt4C,CAA5B,EAA+B02B,KAAK,CAAC12B,CAAD,CAApC;AACH;AACJ,SA/BgD;AAgCjDy4C,4BAAoB,EAAE,8BAAU1tB,EAAV,EAAczY,IAAd,EAAoB;AACtC,eAAKsqB,cAAL,CAAoB7R,EAApB,IAA0B9sB,IAAI,CAACy3B,OAAL,CAAalH,MAAb,CAAoB,EAApB,EAAwBlc,IAAxB,CAA1B;;AACA,cAAIA,IAAI,CAACslB,QAAT,EAAmB;AACf,gBAAI2gB,EAAE,GAAG,EAAT;;AACA,iBAAK,IAAIv4C,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGsS,IAAI,CAACslB,QAAL,CAAcl4B,MAAlC,EAA0CM,CAAC,EAA3C,EAA+C;AAC3C;AACA;AACA,kBAAI+3B,EAAE,GAAG,KAAKC,wBAAL,CAA8B1lB,IAAI,CAACslB,QAAL,CAAc53B,CAAd,CAA9B,CAAT;AACAu4C,gBAAE,CAACxgB,EAAE,CAAC,CAAD,CAAF,CAAMhN,EAAP,CAAF,GAAegN,EAAf;AACH;;AACD,iBAAK6E,cAAL,CAAoB7R,EAApB,EAAwB6M,QAAxB,GAAmC2gB,EAAnC;AACH;AACJ,SA5CgD;AA6CjDG,6BAAqB,EAAE,+BAAUhiB,KAAV,EAAiB;AACpC,eAAK,IAAI12B,CAAT,IAAc02B,KAAd,EAAqB;AACjB,iBAAK+hB,oBAAL,CAA0Bz4C,CAA1B,EAA6B02B,KAAK,CAAC12B,CAAD,CAAlC;AACH;AACJ,SAjDgD;AAkDjD42B,eAAO,EAAE,iBAAU7L,EAAV,EAAc4tB,cAAd,EAA8B;AACnC,iBAAOA,cAAc,KAAK,YAAnB,GAAkC,KAAKhc,gBAAL,CAAsB5R,EAAtB,CAAlC,GAA8D,KAAK6R,cAAL,CAAoB7R,EAApB,CAArE;AACH,SApDgD;AAqDjD6tB,oBAAY,EAAE,sBAAUC,KAAV,EAAiB9B,KAAjB,EAAwB;AAClC,eAAKD,KAAL,CAAW+B,KAAX,EAAkB9B,KAAlB,EAAyB,IAAzB;AACH,SAvDgD;AAwDjD;AACA+B,iBAAS,EAAE,mBAAU1rC,EAAV,EAAc2rC,SAAd,EAAyB;AAChC,cAAIC,IAAI,GAAG,KAAK5b,UAAL,CAAgBhwB,EAAhB,CAAX;AAAA,cACI6rC,GAAG,GAAG,KAAKtkB,KAAL,CAAWqkB,IAAX,CADV;AAAA,cAEIE,KAAK,GAAG,KAAK9b,UAAL,CAAgB2b,SAAhB,CAFZ;AAAA,cAGII,IAAI,GAAG,KAAKxkB,KAAL,CAAWukB,KAAX,CAHX;AAAA,cAIIvP,EAAE,GAAG,KAAK9F,cAAL,EAJT;;AAMAmV,cAAI,CAACzrC,UAAL,CAAgB0I,WAAhB,CAA4B+iC,IAA5B;;AACAE,eAAK,CAACh2B,WAAN,CAAkB81B,IAAlB;;AACA,cAAIrP,EAAJ,EAAQ;AACJA,cAAE,CAACmP,SAAH,CAAaE,IAAb,EAAmBC,GAAnB,EAAwBC,KAAxB,EAA+BC,IAA/B;AACH;AACJ,SArEgD;AAsEjD3qB,cAAM,EAAE,gBAAU4qB,EAAV,EAAcC,EAAd,EAAkBC,KAAlB,EAAyB;AAC7B,cAAIt5C,CAAJ;;AACA,cAAIs5C,KAAJ,EAAW;AACP,iBAAKt5C,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGs5C,KAAK,CAAC55C,MAAtB,EAA8BM,CAAC,EAA/B,EAAmC;AAC/Bo5C,gBAAE,CAACE,KAAK,CAACt5C,CAAD,CAAN,CAAF,GAAeq5C,EAAE,CAACC,KAAK,CAACt5C,CAAD,CAAN,CAAjB;AACH;AACJ,WAJD,MAKK;AACD,iBAAKA,CAAL,IAAUq5C,EAAV,EAAc;AACVD,gBAAE,CAACp5C,CAAD,CAAF,GAAQq5C,EAAE,CAACr5C,CAAD,CAAV;AACH;AACJ;;AAED,iBAAOo5C,EAAP;AACH,SApFgD;AAqFjDrD,2BAAmB,EAAE,EArF4B;AAsFjDwD,8BAAsB,EAAE,gCAAUxW,GAAV,EAAe;AACnC,iBAAOA,GAAG,CAACjO,SAAJ,CAAc,CAAd,EAAiB0kB,UAAjB,KAAgC,CAAhC,GAAoCzW,GAAG,CAACjO,SAAJ,CAAc,CAAd,EAAiB0kB,UAAjB,KAAgC,CAAhC,GAAoC,CAAC,CAAhF;AACH,SAxFgD;AAyFjD3kB,uBAAe,EAAE,yBAASyD,UAAT,EAAqBrrB,KAArB,EAA4BwsC,OAA5B,EAAqCC,SAArC,EAAgDC,iBAAhD,EAAmEC,eAAnE,EAAoF;AACjG,cAAIC,OAAJ;AAAA,cACIC,iBAAiB,GAAGxhB,UAAU,CAACxD,SAAX,CAAqB7nB,KAArB,EAA4By2B,SADpD;AAAA,cAEIqW,gBAAgB,GAAGzhB,UAAU,CAACxD,SAAX,CAAqB7nB,KAArB,CAFvB;AAIAqrB,oBAAU,CAACyT,OAAX,GAAqBzT,UAAU,CAACyT,OAAX,IAAsB,EAA3C;;AACA,cAAGzT,UAAU,CAACyT,OAAX,CAAmB9+B,KAAnB,CAAH,EAA8B;AAC1B4sC,mBAAO,GAAGvhB,UAAU,CAACyT,OAAX,CAAmB9+B,KAAnB,EAA0BylB,EAApC;AACH,WAFD,MAEM;AACFmnB,mBAAO,GAAG,KAAKtY,WAAL,CAAiBkY,OAAjB,EAA0B;AAChCplB,sBAAQ,EAACslB,iBAAiB,CAACrhB,UAAD,EAAarrB,KAAb,CADM;AAEhCknB,oBAAM,EAACylB,eAAe,CAACthB,UAAD,EAAarrB,KAAb,CAFU;AAGhCiqB,wBAAU,EAAC;AACP8iB,+BAAe,EAAC;AADT;AAHqB,aAA1B,CAAV;AAOH;;AACDH,iBAAO,CAAC5X,gBAAR,CAAyB,IAAzB,EAjBiG,CAmBjG;;AACA3J,oBAAU,CAACyT,OAAX,CAAmB9+B,KAAnB,IAA4B;AAAEylB,cAAE,EAACmnB,OAAL;AAAc7N,sBAAU,EAAE+N;AAA1B,WAA5B,CApBiG,CAsBjG;;AACA,cAAI9sC,KAAK,KAAK,CAAd,EAAiB;AACb,iBAAKm2B,MAAL,CAAY6F,qBAAZ,CAAkC6Q,iBAAlC,EAAqDJ,SAArD,EAAgEphB,UAAhE,EAA4EmhB,OAA5E,EAAqF,CAArF;AACH,WAFD,MAGK;AACD,iBAAKrW,MAAL,CAAY6F,qBAAZ,CAAkC6Q,iBAAlC,EAAqDJ,SAArD,EAAgEphB,UAAhE,EAA4EmhB,OAA5E,EAAqF,CAArF;AACH,WA5BgG,CA8BjG;;;AACAM,0BAAgB,CAACjR,oBAAjB,CAAsCxQ,UAAtC,EAAkD,IAAlD,EAAwD,IAAxD,EA/BiG,CAiCjG;;AACAuhB,iBAAO,CAACpb,WAAR,GAAsB,CAAEnG,UAAF,CAAtB;AACAA,oBAAU,CAACxD,SAAX,CAAqB7nB,KAArB,IAA8B4sC,OAA9B;AAEAE,0BAAgB,CAACvV,UAAjB,CAA4B,KAA5B;AAEAlM,oBAAU,CAACkM,UAAX,CAAsB,IAAtB;AAEA,eAAKvP,UAAL,CAAgBwkB,OAAhB;AACH,SAnIgD;AAoIjDzkB,yBAAiB,EAAG,2BAASsD,UAAT,EAAqBrrB,KAArB,EAA4BysC,SAA5B,EAAuC;AACvD;AACA,cAAIphB,UAAU,CAAChD,QAAX,IAAuB,IAAvB,IAA+BgD,UAAU,CAACyT,OAAX,IAAsB,IAArD,IAA6DzT,UAAU,CAACyT,OAAX,CAAmB9+B,KAAnB,KAA6B,IAA9F,EAAoG;AAChG;AACH;;AAED,cAAIgtC,eAAe,GAAG3hB,UAAU,CAACyT,OAAX,CAAmB9+B,KAAnB,EAA0B++B,UAA1B,CAAqCvM,OAA3D;AAAA,cACIqa,iBAAiB,GAAGxhB,UAAU,CAACyT,OAAX,CAAmB9+B,KAAnB,EAA0B++B,UAA1B,CAAqCtI,SAD7D;AAGApL,oBAAU,CAACxD,SAAX,CAAqB7nB,KAArB,IAA8BqrB,UAAU,CAACyT,OAAX,CAAmB9+B,KAAnB,EAA0B++B,UAAxD,CATuD,CAUvD;;AACA,cAAI/+B,KAAK,KAAK,CAAd,EAAiB;AACb;AACA;AACA,iBAAKm2B,MAAL,CAAY6F,qBAAZ,CAAkCyQ,SAAlC,EAA6CI,iBAA7C,EAAgExhB,UAAhE,EAA4E2hB,eAA5E,EAA6F,CAA7F;AACH,WAJD,MAKK;AACD,iBAAK7W,MAAL,CAAY6F,qBAAZ,CAAkCyQ,SAAlC,EAA6CI,iBAA7C,EAAgExhB,UAAhE,EAA4E2hB,eAA5E,EAA6F,CAA7F;AACH,WAlBsD,CAoBvD;;;AACA3hB,oBAAU,CAACyT,OAAX,CAAmB9+B,KAAnB,EAA0BylB,EAA1B,CAA6BoW,oBAA7B,CAAkDxQ,UAAlD,EAA8D,IAA9D;AAEAA,oBAAU,CAACyT,OAAX,CAAmB9+B,KAAnB,EAA0B++B,UAA1B,CAAqCpD,aAArC,CAAmDtQ,UAAnD;;AACA,cAAGA,UAAU,CAACqM,SAAX,EAAH,EAA2B;AACvBrM,sBAAU,CAACyT,OAAX,CAAmB9+B,KAAnB,EAA0B++B,UAA1B,CAAqCxH,UAArC,CAAgD,IAAhD;AACH,WA1BsD,CA4BvD;;;AACA,iBAAOlM,UAAU,CAACyT,OAAX,CAAmB9+B,KAAnB,CAAP;AACH;AAlKgD,OAArD,EAvhGU,CA4rGd;AAEA;;;AACI,UAAIyoB,OAAO,GAAG,IAAI5C,eAAJ,EAAd,CA/rGU,CAgsGV;;AACA70B,UAAI,CAACy3B,OAAL,GAAeA,OAAf,CAjsGU,CAksGV;;AACAA,aAAO,CAACwkB,WAAR,GAAsB,UAAUpf,SAAV,EAAqBqf,WAArB,EAAkC;AACpD,YAAI94C,CAAC,GAAG,IAAIyxB,eAAJ,CAAoBgI,SAApB,CAAR;;AACA,YAAIqf,WAAJ,EAAiB;AACb,eAAK,IAAIC,GAAT,IAAgBD,WAAhB,EAA6B;AACzB94C,aAAC,CAAC+4C,GAAD,CAAD,GAASD,WAAW,CAACC,GAAD,CAApB;AACH;AACJ;;AACD/4C,SAAC,CAACgW,IAAF;AACA,eAAOhW,CAAP;AACH,OATD;;AAUAq0B,aAAO,CAAC/F,IAAR,GAAe,UAAUxE,IAAV,EAAgBnhB,EAAhB,EAAoB;AAC/B,YAAImhB,IAAI,IAAI,IAAZ,EAAkB;AACd;AACH;;AACD,YAAI,OAAOA,IAAP,KAAgB,QAApB,EAA8B;AAC1BnhB,YAAE,CAAC0rB,OAAO,CAAC0H,UAAR,CAAmBjS,IAAnB,CAAD,CAAF;AACH,SAFD,MAGK,IAAIA,IAAI,CAACzrB,MAAL,IAAe,IAAnB,EAAyB;AAC1B,eAAK,IAAIM,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGmrB,IAAI,CAACzrB,MAAzB,EAAiCM,CAAC,EAAlC,EAAsC;AAClCgK,cAAE,CAAC0rB,OAAO,CAAC0H,UAAR,CAAmBjS,IAAI,CAACnrB,CAAD,CAAvB,CAAD,CAAF;AACH;AACJ,SAJI,MAKA;AACDgK,YAAE,CAACmhB,IAAD,CAAF;AACH,SAd8B,CAc7B;;AACL,OAfD,CA7sGU,CA8tGV;;;AACA,UAAI,IAAJ,EAAoC;AAChC5hB,eAAO,CAACmsB,OAAR,GAAkBA,OAAlB;AACH,OAjuGS,CAmuGd;;AAEC,KAruGA,EAquGElsB,IAruGF,CAquGO,OAAOC,MAAP,KAAkB,WAAlB,GAAgCA,MAAhC,GAAyC,IAruGhD;AAuuGD;;;;;;;;;AAQA;AAAC,KAAC,YAAW;AAET;;AACA,UAAIxL,IAAI,GAAG,IAAX;AAAA,UAAiBo8C,GAAG,GAAGp8C,IAAI,CAACy3B,OAA5B;AAAA,UAAqCR,GAAG,GAAGj3B,IAAI,CAAC0tB,WAAhD,CAHS,CAKT;;AAEA,UAAI2uB,uBAAuB,GAAG,SAA9B;AAAA,UACA;AACA;AACIC,uBAAiB,GAAG,SAApBA,iBAAoB,CAAUllB,SAAV,EAAqB3f,MAArB,EAA6B;AAE7C,YAAI8kC,OAAO,GAAG;AACNxhB,kBAAQ,EAAEtjB,MAAM,CAACsjB,QADX;AAENyhB,oBAAU,EAAEplB,SAAS,CAAColB,UAFhB;AAGN1vB,YAAE,EAAEuvB,uBAHE;AAINjlB,mBAAS,EAAEA,SAJL;AAKNC,kBAAQ,EAAED,SAAS,CAACC,QAAV,CAAmBtC,QALvB,CAKiC;;AALjC,SAAd;AAAA,YAOI0nB,YAAY,GAAGL,GAAG,CAAC7rB,MAAJ,CAAWgsB,OAAX,EAAoB9kC,MAApB,CAPnB;;AASA,eAAO,IAAI2kC,GAAG,CAACje,QAAJ,CAAa/G,SAAS,CAACC,QAAV,CAAmBtC,QAAnB,CAA4B2nB,aAA5B,EAAb,EAA0DC,KAA9D,CAAoEF,YAApE,CAAP;AACH,OAfL;AAAA,UAgBIG,eAAe,GAAG,SAAlBA,eAAkB,CAAUxlB,SAAV,EAAqBnM,CAArB,EAAwB;AACtC,YAAI4xB,WAAW,GAAG,IAAlB;;AACA,YAAI5lB,GAAG,CAACtJ,OAAJ,CAAY1C,CAAZ,CAAJ,EAAoB;AAAE;AAClB;AACA;AACA;AACA,cAAI5W,IAAI,GAAG4W,CAAC,CAAC,CAAD,CAAZ;AAAA,cACA;AACIzkB,WAAC,GAAG41C,GAAG,CAAC7rB,MAAJ,CAAW;AAAC6G,qBAAS,EAAEA,SAAZ;AAAuBC,oBAAQ,EAAED,SAAS,CAACC,QAAV,CAAmBtC;AAApD,WAAX,EAA0E9J,CAAC,CAAC,CAAD,CAA3E,CAFR;;AAGA,cAAIA,CAAC,CAACxpB,MAAF,KAAa,CAAjB,EAAoB;AAChB26C,eAAG,CAAC7rB,MAAJ,CAAW/pB,CAAX,EAAcykB,CAAC,CAAC,CAAD,CAAf;AACH;;AACD4xB,qBAAW,GAAG,IAAIT,GAAG,CAACje,QAAJ,CAAa/G,SAAS,CAACC,QAAV,CAAmBtC,QAAnB,CAA4B2nB,aAA5B,EAAb,EAA0DroC,IAA1D,CAAJ,CAAoE7N,CAApE,CAAd;AACH,SAXD,MAWO,IAAIykB,CAAC,CAACvb,WAAF,KAAkBC,MAAtB,EAA8B;AACjCktC,qBAAW,GAAG,IAAIT,GAAG,CAACje,QAAJ,CAAa/G,SAAS,CAACC,QAAV,CAAmBtC,QAAnB,CAA4B2nB,aAA5B,EAAb,EAA0DzxB,CAA1D,CAAJ,CAAiE;AAACmM,qBAAS,EAAEA,SAAZ;AAAuBC,oBAAQ,EAAED,SAAS,CAACC,QAAV,CAAmBtC;AAApD,WAAjE,CAAd;AACH,SAFM,MAEA;AACH8nB,qBAAW,GAAG5xB,CAAd;AACH;;AAED4xB,mBAAW,CAAC/vB,EAAZ,GAAiB+vB,WAAW,CAAC/vB,EAAZ,IAAkBmK,GAAG,CAACpY,IAAJ,EAAnC;AACAuY,iBAAS,CAACqC,aAAV,CAAwB,SAAxB,EAAmCojB,WAAnC,EAAgDA,WAAW,CAAC/vB,EAA5D;AACAsK,iBAAS,CAACC,QAAV,CAAmBsC,QAAnB,CAA4BkjB,WAAW,CAAC/vB,EAAxC,IAA8C+vB,WAA9C;AAEA,eAAOA,WAAP;AACH,OAxCL;;AA0CAT,SAAG,CAACU,gCAAJ,GAAuC,UAAUrlC,MAAV,EAAkB;AAErDzX,YAAI,CAAC84B,kBAAL,CAAwB1vB,KAAxB,CAA8B,IAA9B,EAAoC0F,SAApC;AACA,aAAKuoB,QAAL,CAAcsC,QAAd,GAAyB,EAAzB;AACA,aAAKtC,QAAL,CAAc0lB,gBAAd,GAAiC,EAAjC;;AAEA,YAAItlC,MAAM,CAACosB,KAAX,EAAkB;AACd,eAAKvL,cAAL,GAAsBqB,QAAtB,CAA+B0iB,uBAA/B,IAA0D,CAAC,OAAD,EAAU;AAChExY,iBAAK,EAAEpsB,MAAM,CAACosB,KADkD;AAEhE3hC,oBAAQ,EAAEuV,MAAM,CAACulC,aAAP,IAAwB,KAAKC,oBAA7B,IAAqD,GAFC;AAGhET,sBAAU,EAAE/kC,MAAM,CAAC+kC,UAAP,IAAqB,KAAKnlB,QAAL,CAActC,QAAd,CAAuBuE,QAAvB,CAAgCyE,UAHD;AAIhEjR,cAAE,EAACuvB;AAJ6D,WAAV,CAA1D;AAMH;;AAED,aAAKzhB,oBAAL,GAA4B,UAAUt4B,CAAV,EAAa;AACrC,cAAI,KAAK+0B,QAAT,EAAmB;AACf,iBAAK,IAAIt1B,CAAT,IAAc,KAAKs1B,QAAL,CAAcsC,QAA5B,EAAsC;AAClC,mBAAKtC,QAAL,CAAcsC,QAAd,CAAuB53B,CAAvB,EAA0B64B,oBAA1B,CAA+Ct4B,CAA/C;AACH;AACJ;AACJ,SAND;AAOH,OAtBD;;AAwBA85C,SAAG,CAACU,gCAAJ,CAAqClkB,SAArC,GAAiD,UAAUxB,SAAV,EAAqBt1B,CAArB,EAAwB;AACrE,YAAIA,CAAC,CAAC63B,QAAN,EAAgB;AACZ;AACA;AACA,cAAIujB,IAAI,GAAG,EAAX;AAAA,cAAen7C,CAAf;;AAEA,eAAKA,CAAL,IAAUD,CAAC,CAAC63B,QAAZ,EAAsB;AAElB,gBAAIwjB,QAAQ,GAAG/lB,SAAS,CAACC,QAAV,CAAmBsC,QAAnB,CAA4B73B,CAAC,CAAC63B,QAAF,CAAW53B,CAAX,EAAc,CAAd,EAAiB+qB,EAA7C,CAAf;;AACA,gBAAIqwB,QAAJ,EAAc;AACV;AACAA,sBAAQ,CAACC,UAAT,CAAoBt7C,CAAC,CAAC63B,QAAF,CAAW53B,CAAX,EAAc,CAAd,CAApB;AACAm7C,kBAAI,CAACp7C,CAAC,CAAC63B,QAAF,CAAW53B,CAAX,EAAc,CAAd,EAAiB+qB,EAAlB,CAAJ,GAA4B,IAA5B;AAEAqwB,sBAAQ,CAACE,QAAT,CAAkBjmB,SAAS,CAACC,QAAV,CAAmBtC,QAArC,EAA+CqC,SAA/C;AACH,aAND,MAOK;AACD,kBAAI90B,CAAC,GAAG80B,SAAS,CAACsC,iBAAV,CAA4B,SAA5B,EAAuC53B,CAAC,CAAC63B,QAAF,CAAW53B,CAAX,EAAc,CAAd,EAAiB+qB,EAAxD,CAAR;;AACA,kBAAIxqB,CAAC,IAAI,IAAT,EAAe;AACXA,iBAAC,CAAC+6C,QAAF,CAAWjmB,SAAS,CAACC,QAAV,CAAmBtC,QAA9B,EAAwCqC,SAAxC;AACA90B,iBAAC,CAACikC,UAAF,CAAa,IAAb,EAFW,CAGX;;AACAjkC,iBAAC,CAAC86C,UAAF,CAAat7C,CAAC,CAAC63B,QAAF,CAAW53B,CAAX,EAAc,CAAd,CAAb;AACAq1B,yBAAS,CAACC,QAAV,CAAmBsC,QAAnB,CAA4Br3B,CAAC,CAACwqB,EAA9B,IAAoCxqB,CAApC;AACH,eAND,MAOK;AACDA,iBAAC,GAAG80B,SAAS,CAACkmB,UAAV,CAAqBx7C,CAAC,CAAC63B,QAAF,CAAW53B,CAAX,CAArB,EAAoC,IAApC,CAAJ;AACH;;AACDm7C,kBAAI,CAAC56C,CAAC,CAACwqB,EAAH,CAAJ,GAAa,IAAb;AACH;AACJ,WA7BW,CA+BZ;;;AACA,eAAK/qB,CAAL,IAAUq1B,SAAS,CAACC,QAAV,CAAmBsC,QAA7B,EAAuC;AACnC,gBAAIujB,IAAI,CAAC9lB,SAAS,CAACC,QAAV,CAAmBsC,QAAnB,CAA4B53B,CAA5B,EAA+B+qB,EAAhC,CAAJ,IAA2C,IAA/C,EAAqD;AACjDsK,uBAAS,CAACmmB,aAAV,CAAwBnmB,SAAS,CAACC,QAAV,CAAmBsC,QAAnB,CAA4B53B,CAA5B,EAA+B+qB,EAAvD,EAA2D,IAA3D,EADiD,CACiB;AAClE;AACA;AACH;AACJ;AACJ;AACJ,OAzCD;;AA2CAmK,SAAG,CAAC1G,MAAJ,CAAW6rB,GAAG,CAACU,gCAAf,EAAiD98C,IAAI,CAAC84B,kBAAtD,EAA0E;AAEtE5a,gBAAQ,EAAE,kBAAUhB,KAAV,EAAiBof,sBAAjB,EAAyC;AAC/C,cAAI,KAAKjF,QAAL,IAAiB,CAAC,KAAKA,QAAL,CAActC,QAAd,CAAuBkS,wBAAvB,EAAtB,EAAyE;AACrE,iBAAK,IAAIllC,CAAT,IAAc,KAAKs1B,QAAL,CAAcsC,QAA5B,EAAsC;AAClC,mBAAKtC,QAAL,CAAcsC,QAAd,CAAuB53B,CAAvB,EAA0Bmb,KAAK,GAAG,UAAH,GAAgB,aAA/C,EAA8D,KAAKma,QAAL,CAActC,QAAd,CAAuBxL,UAArF;AACH;AACJ;AACJ,SARqE;AAStE+zB,kBAAU,EAAE,oBAAUE,OAAV,EAAmBnlB,YAAnB,EAAiC;AACzC,cAAIpN,CAAC,GAAG2xB,eAAe,CAAC,IAAD,EAAOY,OAAP,CAAvB;;AAEA,cAAI,KAAKC,OAAL,IAAgBxyB,CAAC,CAAC5W,IAAF,KAAW,OAA3B,IAAsC4iB,GAAG,CAACtJ,OAAJ,CAAY6vB,OAAZ,CAA1C,EAAgE;AAC5D;AACA;AACA,gBAAIj7C,CAAC,GAAG,KAAKk7C,OAAL,EAAR;AAAA,gBAAwBj3C,CAAC,GAAGg3C,OAAO,CAAC,CAAD,CAAnC;;AACA,gBAAIj7C,CAAJ,EAAO;AACH,kBAAIm7C,iBAAiB,GAAGl3C,CAAC,CAACm3C,sBAAF,IAA4B,eAApD;AACA,kBAAIC,GAAG,GAAGr7C,CAAC,GAAGA,CAAC,CAACm7C,iBAAD,CAAJ,GAA0B,IAArC;;AAEA,kBAAIE,GAAJ,EAAS;AACL3yB,iBAAC,CAAC2yB,GAAF,GAAQA,GAAR;AACH;AACJ;AACJ;;AAED,cAAI,CAACvlB,YAAL,EAAmB;AACf,iBAAKQ,OAAL;AACH;;AACD,iBAAO5N,CAAP;AACH,SA9BqE;AA+BtE4yB,kBAAU,EAAE,oBAAU/wB,EAAV,EAAc;AACtB,iBAAO,KAAKuK,QAAL,CAAcsC,QAAd,CAAuB7M,EAAvB,CAAP;AACH,SAjCqE;AAkCtEgxB,mBAAW,EAAE,uBAAY;AACrB,iBAAO,KAAKzmB,QAAL,CAAcsC,QAArB;AACH,SApCqE;AAqCtEokB,mBAAW,EAAE,qBAAUjxB,EAAV,EAAc;AACvB,cAAI7B,CAAC,GAAG,KAAK4yB,UAAL,CAAgB/wB,EAAhB,CAAR;;AACA,cAAI7B,CAAJ,EAAO;AACHA,aAAC,CAACklB,IAAF;AACH;AACJ,SA1CqE;AA2CtE6N,oBAAY,EAAE,wBAAY;AACtB,eAAK,IAAIj8C,CAAT,IAAc,KAAKs1B,QAAL,CAAcsC,QAA5B,EAAsC;AAClC,iBAAKtC,QAAL,CAAcsC,QAAd,CAAuB53B,CAAvB,EAA0BouC,IAA1B;AACH;AACJ,SA/CqE;AAgDtE8N,mBAAW,EAAE,qBAAUnxB,EAAV,EAAc;AACvB,cAAI7B,CAAC,GAAG,KAAK4yB,UAAL,CAAgB/wB,EAAhB,CAAR;;AACA,cAAI7B,CAAJ,EAAO;AACHA,aAAC,CAAC+uB,IAAF;AACH;AACJ,SArDqE;AAsDtEkE,oBAAY,EAAE,wBAAY;AACtB,eAAK,IAAIn8C,CAAT,IAAc,KAAKs1B,QAAL,CAAcsC,QAA5B,EAAsC;AAClC,iBAAKtC,QAAL,CAAcsC,QAAd,CAAuB53B,CAAvB,EAA0Bi4C,IAA1B;AACH;AACJ,SA1DqE;AA2DtEmE,yBAAiB,EAAE,2BAAU9lB,YAAV,EAAwB;AACvC,eAAK,IAAIt2B,CAAT,IAAc,KAAKs1B,QAAL,CAAcsC,QAA5B,EAAsC;AAClC,gBAAI,KAAKtC,QAAL,CAAcsC,QAAd,CAAuB53B,CAAvB,EAA0BsqC,OAA9B,EAAuC;AACnC,mBAAKhV,QAAL,CAAcsC,QAAd,CAAuB53B,CAAvB,EAA0BsqC,OAA1B;AACH;AACJ;;AAED,eAAKhV,QAAL,CAAcsC,QAAd,GAAyB,EAAzB;AACA,eAAKtC,QAAL,CAAc0lB,gBAAd,GAAiC,IAAjC;AACA,eAAK1lB,QAAL,CAAcgC,iBAAd,GAAiC,EAAjC;;AACA,cAAI,CAAChB,YAAL,EAAmB;AACf,iBAAKQ,OAAL;AACH;AACJ,SAxEqE;AAyEtE0kB,qBAAa,EAAE,uBAAUa,SAAV,EAAqBC,WAArB,EAAkC;AAC7C,cAAIpzB,CAAC,GAAG,KAAKoM,QAAL,CAAcsC,QAAd,CAAuBykB,SAAvB,CAAR;;AACA,cAAInzB,CAAJ,EAAO;AACHA,aAAC,CAACsb,UAAF,CAAa,KAAb;;AACA,gBAAI,CAAC8X,WAAD,IAAgBpzB,CAAC,CAACohB,OAAtB,EAA+B;AAC3BphB,eAAC,CAACohB,OAAF;AACH;;AACD,mBAAO,KAAKhV,QAAL,CAAcsC,QAAd,CAAuBykB,SAAvB,CAAP;;AACA,gBAAI,KAAK/mB,QAAL,CAAc0lB,gBAAlB,EAAoC;AAChC,qBAAO,KAAK1lB,QAAL,CAAc0lB,gBAAd,CAA+BqB,SAA/B,CAAP;AACH;;AAED,gBAAI,KAAK/mB,QAAL,CAAcgC,iBAAlB,EAAqC;AACjC,qBAAO,KAAKhC,QAAL,CAAcgC,iBAAd,CAAgC+kB,SAAhC,CAAP;AACH;AACJ;AACJ,SAzFqE;AA0FtEE,sBAAc,EAAE,0BAAY;AACxB,eAAK,IAAIv8C,CAAC,GAAG,CAAR,EAAWqB,CAAC,GAAG0L,SAAS,CAACrN,MAA9B,EAAsCM,CAAC,GAAGqB,CAA1C,EAA6CrB,CAAC,EAA9C,EAAkD;AAC9C,iBAAKw7C,aAAL,CAAmBzuC,SAAS,CAAC/M,CAAD,CAA5B;AACH;AACJ,SA9FqE;AA+FtE29B,kBAAU,EAAE,oBAAUob,SAAV,EAAqB;AAC7B,cAAI,KAAKyD,QAAT,EAAmB;AACf,iBAAKA,QAAL,CAAcjvC,UAAd,CAAyB0I,WAAzB,CAAqC,KAAKumC,QAA1C;AACAzD,qBAAS,CAAC71B,WAAV,CAAsB,KAAKs5B,QAA3B;AACH;;AAED,cAAI,KAAKvjB,MAAL,IAAe,KAAKA,MAAL,CAAY1rB,UAA/B,EAA2C;AACvC,iBAAK0rB,MAAL,CAAY1rB,UAAZ,CAAuB0I,WAAvB,CAAmC,KAAKgjB,MAAxC;AACA8f,qBAAS,CAAC71B,WAAV,CAAsB,KAAK+V,MAA3B;;AAEA,iBAAK,IAAIj5B,CAAT,IAAc,KAAKs1B,QAAL,CAAcsC,QAA5B,EAAsC;AAClC,kBAAI,KAAKtC,QAAL,CAAcsC,QAAd,CAAuB53B,CAAvB,EAA0By8C,oBAA9B,EAAoD;AAChD,oBAAIrvC,EAAE,GAAG,KAAKkoB,QAAL,CAAcsC,QAAd,CAAuB53B,CAAvB,EAA0Bo9B,UAA1B,EAAT;;AACAhwB,kBAAE,CAACG,UAAH,CAAc0I,WAAd,CAA0B7I,EAA1B;AACA2rC,yBAAS,CAAC71B,WAAV,CAAsB9V,EAAtB;AACH;AACJ;AACJ;AACJ,SAjHqE;AAkHtEsvC,gBAAQ,EAAE,oBAAY;AAClB,cAAIC,EAAE,GAAG,KAAKb,UAAL,CAAgBxB,uBAAhB,CAAT;AACA,iBAAOqC,EAAE,IAAI,IAAN,GAAaA,EAAE,CAACD,QAAH,EAAb,GAA6B,IAApC;AACH,SArHqE;AAsHtEE,uBAAe,EAAE,2BAAY;AACzB,iBAAO,KAAKd,UAAL,CAAgBxB,uBAAhB,CAAP;AACH,SAxHqE;AAyHtEuC,gBAAQ,EAAE,kBAAUluC,CAAV,EAAa;AACnB,cAAIguC,EAAE,GAAG,KAAKb,UAAL,CAAgBxB,uBAAhB,CAAT;;AACA,cAAI,CAACqC,EAAL,EAAS;AACL,gBAAIjnC,MAAM,GAAG/G,CAAC,CAAChB,WAAF,KAAkBC,MAAlB,IAA4Be,CAAC,CAAChB,WAAF,KAAkBmvC,QAA9C,GAAyD;AAAEhb,mBAAK,EAAEnzB;AAAT,aAAzD,GAAwEA,CAArF;AACAguC,cAAE,GAAGpC,iBAAiB,CAAC,IAAD,EAAO7kC,MAAP,CAAtB;AACA,iBAAK4f,QAAL,CAAcsC,QAAd,CAAuB0iB,uBAAvB,IAAkDqC,EAAlD;AACH,WAJD,MAKK;AACD,gBAAIhuC,CAAC,CAAChB,WAAF,KAAkBC,MAAlB,IAA4Be,CAAC,CAAChB,WAAF,KAAkBmvC,QAAlD,EAA4D;AACxDH,gBAAE,CAACE,QAAH,CAAYluC,CAAZ;AACH,aAFD,MAGK;AACD,kBAAIA,CAAC,CAACmzB,KAAN,EAAa;AACT6a,kBAAE,CAACE,QAAH,CAAYluC,CAAC,CAACmzB,KAAd;AACH;;AACD,kBAAInzB,CAAC,CAACxO,QAAN,EAAgB;AACZw8C,kBAAE,CAACI,WAAH,CAAepuC,CAAC,CAACxO,QAAjB;AACH;AACJ;AACJ;;AAED,cAAI,CAAC,KAAKm1B,QAAL,CAActC,QAAd,CAAuB2H,gBAAvB,EAAL,EAAgD;AAC5C,iBAAK7D,OAAL;AACH;AACJ,SAjJqE;AAkJtEwT,eAAO,EAAE,iBAAUrlB,KAAV,EAAiB;AACtB,eAAK,IAAIjlB,CAAT,IAAc,KAAKs1B,QAAL,CAAcsC,QAA5B,EAAsC;AAClC,iBAAKtC,QAAL,CAAcsC,QAAd,CAAuB53B,CAAvB,EAA0BsqC,OAA1B,CAAkCrlB,KAAlC;;AACA,iBAAKqQ,QAAL,CAAcsC,QAAd,CAAuB53B,CAAvB,EAA0BinB,OAA1B,CAAkChC,KAAlC;AACH;;AACD,cAAIA,KAAJ,EAAW;AACP,iBAAKqQ,QAAL,CAAcsC,QAAd,GAAyB,EAAzB;AACA,iBAAKtC,QAAL,CAAc0lB,gBAAd,GAAiC,IAAjC;AACH;AACJ,SA3JqE;AA4JtExW,kBAAU,EAAE,oBAAU5lC,CAAV,EAAa;AACrB,eAAKA,CAAC,GAAG,cAAH,GAAoB,cAA1B;AACH,SA9JqE;AA+JtEo+C,kCAA0B,EAAE,oCAAUvB,OAAV,EAAmB1U,EAAnB,EAAuB;AAC/C,eAAKzR,QAAL,CAAc0lB,gBAAd,CAA+BS,OAAO,CAAC1wB,EAAvC,IAA6Cgc,EAA7C;AACH,SAjKqE;AAkKtEkW,kCAA0B,EAAE,oCAAUxB,OAAV,EAAmB;AAC3C,iBAAO,KAAKnmB,QAAL,CAAc0lB,gBAAd,GAAiC,KAAK1lB,QAAL,CAAc0lB,gBAAd,CAA+BS,OAAO,CAAC1wB,EAAvC,CAAjC,GAA8E,IAArF;AACH,SApKqE;AAqKtEmyB,mBAAW,EAAC,qBAASC,MAAT,EAAiB5jB,KAAjB,EAAwB6jB,kBAAxB,EAA4C;AACpD,cAAI,CAACA,kBAAL,EAAyB;AACrB,iBAAK,IAAIp9C,CAAT,IAAc,KAAKs1B,QAAL,CAAcsC,QAA5B,EAAsC;AAClC,mBAAKtC,QAAL,CAAcsC,QAAd,CAAuB53B,CAAvB,EAA0Bm9C,MAAM,GAAG,OAAnC,EAA4C5jB,KAA5C;AACH;AACJ;AACJ,SA3KqE;AA4KtE3c,gBAAQ,EAAC,kBAAS2c,KAAT,EAAgB6jB,kBAAhB,EAAoC;AACzC,eAAKF,WAAL,CAAiB,KAAjB,EAAwB3jB,KAAxB,EAA+B6jB,kBAA/B;AACH,SA9KqE;AA+KtEl5B,mBAAW,EAAC,qBAASqV,KAAT,EAAgB6jB,kBAAhB,EAAoC;AAC5C,eAAKF,WAAL,CAAiB,QAAjB,EAA2B3jB,KAA3B,EAAkC6jB,kBAAlC;AACH;AAjLqE,OAA1E,EApHS,CAwSb;;AAEC,KA1SA,EA0SE5zC,IA1SF,CA0SO,OAAOC,MAAP,KAAkB,WAAlB,GAAgCA,MAAhC,GAAyC,IA1ShD;AA4SD;;;;;;;;;;;AAUA;AAAC,KAAC,YAAY;AAEV;;AACA,UAAIxL,IAAI,GAAG,IAAX;AAAA,UAAiBo8C,GAAG,GAAGp8C,IAAI,CAACy3B,OAA5B;AAAA,UAAqCR,GAAG,GAAGj3B,IAAI,CAAC0tB,WAAhD,CAHU,CAKV;;AACA,UAAI0xB,0BAA0B,GAAG,SAA7BA,0BAA6B,CAAUhpB,QAAV,EAAoBipB,WAApB,EAAiChoB,QAAjC,EAA2C;AACxE,YAAIioB,OAAO,GAAG,KAAd;AACA,eAAO;AACHviC,cAAI,EAAE,gBAAY;AACd,gBAAIuiC,OAAJ,EAAa;AACTA,qBAAO,GAAG,KAAV;AACA,qBAAO,IAAP;AACH;;AAED,gBAAID,WAAW,CAAC7d,OAAhB,EAAyB;AACrB,kBAAI+d,GAAG,GAAGloB,QAAQ,CAAC+b,aAAT,CAAuBtkC,SAAvB,EAAkCuoB,QAAQ,CAACzR,OAAT,EAAlC,CAAV;;AACA,kBAAI25B,GAAG,IAAI,IAAX,EAAiB;AACbloB,wBAAQ,CAAC5U,WAAT,CAAqB48B,WAAW,CAAC7d,OAAjC,EAA0C+d,GAA1C;AACH;;AACDloB,sBAAQ,CAACwB,OAAT,CAAiBwmB,WAAW,CAAC7d,OAA7B,EAAsC+d,GAAtC,EALqB,CAMrB;AACA;;;AACAnpB,sBAAQ,CAACuS,KAAT,CAAe;AAAC6W,2BAAW,EAACppB,QAAQ,CAACF,MAAT,CAAgBupB,kBAAhB,CAAmC;AAACje,yBAAO,EAACpL;AAAT,iBAAnC;AAAb,eAAf;AACH;AACJ,WAjBE;AAkBHspB,kBAAQ,EAAE,oBAAY;AAClBJ,mBAAO,GAAG,IAAV;AACH;AApBE,SAAP;AAsBH,OAxBD,CANU,CAgCV;;;AACA,UAAIK,yBAAyB,GAAG,SAA5BA,yBAA4B,CAAUN,WAAV,EAAuBhoB,QAAvB,EAAiCuoB,IAAjC,EAAuCC,GAAvC,EAA4C;AACxE,YAAIh9C,CAAC,GAAGw0B,QAAQ,CAACyoB,aAAT,CAAuB,KAAvB,EAA8B;AAAE/6B,kBAAQ,EAAG;AAAb,SAA9B,CAAR;;AACAsS,gBAAQ,CAAC2Y,aAAT,CAAuBntC,CAAvB;;AACA,YAAIiqB,EAAE,GAAGuK,QAAQ,CAACX,KAAT,CAAe7zB,CAAf,CAAT;;AACAw0B,gBAAQ,CAAC5U,WAAT,CAAqB5f,CAArB,EAAwB+8C,IAAxB;;AACA/8C,SAAC,CAACiiB,KAAF,CAAQuP,KAAR,GAAgBwrB,GAAG,CAAC,CAAD,CAAH,GAAS,IAAzB;AACAh9C,SAAC,CAACiiB,KAAF,CAAQsP,MAAR,GAAiByrB,GAAG,CAAC,CAAD,CAAH,GAAS,IAA1B;;AACAxoB,gBAAQ,CAACoZ,MAAT,CAAgB3jB,EAAhB,EAAoBjqB,CAApB,EAAuB,IAAvB,EAPwE,CAO1C;AAC9B;;;AACAw8C,mBAAW,CAACvyB,EAAZ,GAAiBA,EAAjB;AACAuyB,mBAAW,CAAC7d,OAAZ,GAAsB3+B,CAAtB;AACH,OAXD,CAjCU,CA8CV;;;AACA,UAAIk9C,qBAAqB,GAAG,SAAxBA,qBAAwB,CAAUzoB,UAAV,EAAsB0oB,eAAtB,EAAuC5pB,QAAvC,EAAiD6pB,eAAjD,EAAkEnoB,aAAlE,EAAiFT,QAAjF,EAA2FmN,YAA3F,EAAyG9lB,KAAzG,EAAgH;AACxI,YAAIwhC,cAAc,GAAG,IAAI9D,GAAG,CAAC+D,cAAR,CAAuB;AAAEC,mBAAS,EAAEJ,eAAb;AAA8BC,yBAAe,EAAEA,eAA/C;AAAgEprB,yBAAe,EAAEwC;AAAjF,SAAvB,CAArB;AACA,eAAOmN,YAAY,CAAC;AAChBlN,oBAAU,EAAEA,UADI;AAEhBlB,kBAAQ,EAAEA,QAFM;AAGhBF,gBAAM,EAAEgqB,cAHQ;AAIhB1qB,gBAAM,EAAEsC,aAJQ;AAKhBpZ,eAAK,EAAEA;AALS,SAAD,CAAnB;AAOH,OATD;;AAWA,UAAI2hC,cAAc,GAAG,CAAE,gBAAF,EAAoB,qBAApB,EAA2C,mBAA3C,EACjB,WADiB,EACJ,gBADI,EACc,gBADd,EACgC,qBADhC,CAArB,CA1DU,CA6DV;AACA;;AACA,UAAIC,mCAAmC,GAAG,SAAtCA,mCAAsC,CAAU7rB,EAAV,EAAc8rB,qBAAd,EAAqC;AAC3E,YAAIhqC,GAAG,GAAG,CAAV;;AACA,YAAIgqC,qBAAqB,IAAI,IAA7B,EAAmC;AAC/B,eAAK,IAAIx+C,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG0yB,EAAE,CAAC+L,WAAH,CAAe/+B,MAAnC,EAA2CM,CAAC,EAA5C,EAAgD;AAC5C,gBAAI0yB,EAAE,CAAC+L,WAAH,CAAez+B,CAAf,EAAkBw4B,QAAlB,KAA+BgmB,qBAA/B,IAAwD9rB,EAAE,CAAC+L,WAAH,CAAez+B,CAAf,EAAkBy4B,QAAlB,KAA+B+lB,qBAA3F,EAAkH;AAC9GhqC,iBAAG,GAAGxU,CAAN;AACA;AACH;AACJ;AACJ;;AAED,eAAO0yB,EAAE,CAAC+L,WAAH,CAAejqB,GAAf,CAAP;AACH,OAZD;;AAcA6lC,SAAG,CAAC7e,QAAJ,GAAe,UAAU9lB,MAAV,EAAkB;AAC7B,YAAI4f,QAAQ,GAAG5f,MAAM,CAAC4f,QAAtB;AAAA,YACI+M,cAAc,GAAG3sB,MAAM,CAACisB,aAD5B;AAAA,YAEIc,YAAY,GAAG/sB,MAAM,CAACqsB,WAF1B;AAIA,aAAK9K,QAAL,GAAgB,aAAhB;AACA,aAAKikB,oBAAL,GAA4B,CAAE,GAAF,EAAO,GAAP,CAA5B;AACA,aAAKpjB,kBAAL,GAA0B,CAAC,UAAD,EAAa,kBAAb,CAA1B;;AACAuiB,WAAG,CAACU,gCAAJ,CAAqC1zC,KAArC,CAA2C,IAA3C,EAAiD0F,SAAjD,EAR6B,CAUrC;;;AAEQ,aAAKorB,mBAAL,CAAyB;AACrB2I,wBAAc,EAACprB,MAAM,CAACorB,cADD;AAErB6P,wBAAc,EAAEj7B,MAAM,CAACi7B,cAAP,IAAyB,IAAzB,GAAgC,KAAKrb,QAAL,CAActC,QAAd,CAAuBuE,QAAvB,CAAgC8E,cAAhE,GAAiF3mB,MAAM,CAACi7B,cAFnF;AAEmG;AACxHpb,oBAAU,EAAE7f,MAAM,CAAC0rB,aAAP,IAAwB1rB,MAAM,CAAC6f,UAA/B,IAA6C7f,MAAM,CAACqN,KAApD,IAA6D,KAAKuS,QAAL,CAActC,QAAd,CAAuBuE,QAAvB,CAAgCoE,aAA7F,IAA8G0e,GAAG,CAAC9iB,QAAJ,CAAaoE,aAHlH;AAIrBnG,yBAAe,EAAE9f,MAAM,CAAC4rB,kBAAP,IAA6B5rB,MAAM,CAAC8f,eAApC,IAAuD,KAAKF,QAAL,CAActC,QAAd,CAAuBuE,QAAvB,CAAgCsE,kBAAvF,IAA6Gwe,GAAG,CAAC9iB,QAAJ,CAAasE,kBAJtH;AAKrB4iB,wBAAc,EAAE/oC,MAAM,CAAC+oC,cALF;AAMrBC,6BAAmB,EAAEhpC,MAAM,CAACgpC,mBANP;AAOrBtZ,wBAAc,EAAE1vB,MAAM,CAAC0vB,cAPF;AAQrBuZ,6BAAmB,EAAEjpC,MAAM,CAACipC,mBARP;AASrB5d,2BAAiB,EAAErrB,MAAM,CAACqrB,iBATL;AAUrB6d,mBAAS,EAAElpC,MAAM,CAACkpC,SAVG;AAWrBC,0BAAgB,EAAEnpC,MAAM,CAACmpC;AAXJ,SAAzB,EAZ6B,CA0BrC;;AAEQ,aAAKvpB,QAAL,CAAcvY,OAAd,GAAwB,EAAErH,MAAM,CAACqH,OAAP,KAAmB,KAArB,CAAxB;AACA,aAAKuY,QAAL,CAAcwpB,OAAd,GAAwB,IAAxB;AACA,aAAKrf,OAAL,GAAe4a,GAAG,CAACjd,UAAJ,CAAe1nB,MAAM,CAAC+d,MAAtB,CAAf;AACA,aAAK6B,QAAL,CAAcxY,IAAd,GAAqBpH,MAAM,CAACoH,IAA5B;AACA,aAAKwY,QAAL,CAAcypB,gBAAd,GAAiC,IAAjC;AACA,YAAIC,WAAW,GAAG,IAAlB;;AACA,YAAI,KAAK1pB,QAAL,CAAcxY,IAAlB,EAAwB;AACpBpH,gBAAM,CAACipB,eAAP,CAAuB,KAAKrJ,QAAL,CAAcxY,IAArC,IAA6C,IAA7C;AACH;;AACD,aAAK4mB,SAAL,GAAiBhuB,MAAM,CAACguB,SAAxB;AACA,aAAKub,SAAL,GAAiBvpC,MAAM,CAACupC,SAAxB;AAEA,aAAK3pB,QAAL,CAAc4pB,cAAd,GAA+BxpC,MAAM,CAACwpC,cAAtC;AACA,aAAK5pB,QAAL,CAAc6pB,mBAAd,GAAoCzpC,MAAM,CAACypC,mBAA3C;AACA,aAAK7pB,QAAL,CAAc8pB,kBAAd,GAAmC,EAAnC;AACA,aAAK9pB,QAAL,CAAc1Q,MAAd,GAAuB,EAAvB;AAEA,YAAIy6B,aAAa,GAAG3pC,MAAM,CAAC2pC,aAAP,KAAyB,IAA7C;;AACA,aAAKpd,gBAAL,GAAwB,UAASzhC,CAAT,EAAY;AAChC6+C,uBAAa,GAAG7+C,CAAhB;AACH,SAFD;;AAIA,YAAI8+C,kBAAkB,GAAG,YAAY;AACjC;AACA,cAAIC,cAAc,GAAGjqB,QAAQ,CAAC2Q,yBAAT,GAAqC,GAArC,GAA2C,KAAK3Q,QAAL,CAAc8pB,kBAA9E;AACA,eAAK9pB,QAAL,CAAc8pB,kBAAd,GAAmC,KAAKjrB,MAAL,CAAYqrB,WAAZ,EAAnC;AACA,cAAIC,WAAW,GAAGnqB,QAAQ,CAAC2Q,yBAAT,IAAsC,KAAK3Q,QAAL,CAAc8pB,kBAAd,GAAmC,MAAM,KAAK9pB,QAAL,CAAc8pB,kBAAvD,GAA4E,EAAlH,CAAlB;AAEA,eAAKl7B,WAAL,CAAiBq7B,cAAjB;AACA,eAAK3iC,QAAL,CAAc6iC,WAAd,EAPiC,CAQjC;;AACApF,aAAG,CAAC7gB,aAAJ,CAAkB,KAAKiG,OAAvB,EAAgCggB,WAAhC,EAA6CF,cAA7C;AACH,SAVwB,CAUvBr+B,IAVuB,CAUlB,IAVkB,CAAzB;;AAYA,aAAKw+B,aAAL,GAAqB,UAAS/P,YAAT,EAAuB;AACxC,cAAIntC,CAAC,GAAG,KAAK8yB,QAAL,CAActC,QAAd,CAAuBoc,UAAvB,CAAkCO,YAAlC,EAAgD,KAAKjM,SAArD,EAAgEpO,QAAhE,CAAR;;AACA9yB,WAAC,CAAC0e,IAAF,CAAO,eAAP,EAAwB,UAAUy+B,aAAV,EAAyB;AAC7C,iBAAKpuB,IAAL,CAAU,eAAV,EAA2B;AAAC8C,sBAAQ,EAAE,IAAX;AAAiBF,oBAAM,EAAEwrB;AAAzB,aAA3B;;AACAL,8BAAkB;AACrB,WAHuB,CAGtBp+B,IAHsB,CAGjB,IAHiB,CAAxB;AAIA,iBAAO1e,CAAP;AACH,SAPD;;AASA,aAAKo9C,iBAAL,GAAyB,UAASzrB,MAAT,EAAiBmC,YAAjB,EAA+B;AACpD,eAAKhB,QAAL,CAActC,QAAd,CAAuB6sB,uBAAvB,CAA+CpJ,KAA/C,CAAqD,KAAK/S,SAA1D;;AACA,eAAKvP,MAAL,GAAcA,MAAd;;AACAmrB,4BAAkB;;AAElB,cAAI,CAAChpB,YAAL,EAAmB;AACf,iBAAKhB,QAAL,CAActC,QAAd,CAAuB8D,OAAvB,CAA+B,KAAK4M,SAApC;AACH;;AAED,iBAAO,IAAP;AACH,SAVD;;AAYA,aAAKqJ,SAAL,GAAiB,UAAU4C,YAAV,EAAwBrZ,YAAxB,EAAsC;AACnD,cAAI9zB,CAAC,GAAG,KAAKk9C,aAAL,CAAmB/P,YAAnB,CAAR;AACA,eAAKiQ,iBAAL,CAAuBp9C,CAAvB,EAA0B8zB,YAA1B;AACA,iBAAO,IAAP;AACH,SAJD;;AAMA,YAAIwpB,aAAa,GAAG,UAAUp0B,KAAV,EAAiB;AACjC,cAAI,KAAK+S,WAAL,CAAiB/+B,MAAjB,GAA0B,CAA9B,EAAiC;AAC7B,iBAAK,IAAIM,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKy+B,WAAL,CAAiB/+B,MAArC,EAA6CM,CAAC,EAA9C,EAAkD;AAC9C,mBAAKy+B,WAAL,CAAiBz+B,CAAjB,EAAoBmc,QAApB,CAA6BuP,KAA7B,EAAoC,KAApC;AACH;AACJ,WAJD,MAKK;AACD,iBAAKvP,QAAL,CAAcuP,KAAd;AACH;AACJ,SATmB,CASlBxK,IATkB,CASb,IATa,CAApB;;AAWA,aAAKA,IAAL,CAAU,WAAV,EAAuB,YAAY;AAC/B4+B,uBAAa,CAAC,IAAD,CAAb;AACH,SAFD;AAGA,aAAK5+B,IAAL,CAAU,UAAV,EAAsB,YAAY;AAC9B4+B,uBAAa,CAAC,KAAD,CAAb;AACH,SAFD,EAvG6B,CA2G7B;;AACA,YAAI,CAACpqC,MAAM,CAACi5B,UAAZ,EAAwB;AAAE;AACtB,eAAKrZ,QAAL,CAActC,QAAd,CAAuB+M,aAAvB,CAAqCggB,GAArC,CAAyC,IAAzC,EAA+C,KAAKrc,SAApD;AACH;;AAED,aAAKsc,eAAL,GAAuB,UAASttB,EAAT,EAAa0D,MAAb,EAAqB;AACxC,cAAIhgB,EAAE,GAAG,SAALA,EAAK,CAAUrW,CAAV,EAAa0E,CAAb,EAAgB;AACrB,gBAAIw7C,EAAE,GAAG3qB,QAAQ,CAACqlB,aAAT,EAAT;;AACA,gBAAIN,GAAG,CAAC3e,SAAJ,CAAcukB,EAAd,EAAkBlgD,CAAlB,CAAJ,EAA0B;AACtB,qBAAO,IAAIs6C,GAAG,CAAC3e,SAAJ,CAAcukB,EAAd,EAAkBlgD,CAAlB,CAAJ,CAAyB0E,CAAzB,CAAP;AACH;;AACD,gBAAI,CAAC6wB,QAAQ,CAACiC,QAAT,CAAkB8D,gBAAvB,EAAyC;AACrC,oBAAM;AAAE5K,mBAAG,EAAE,qCAAqC1wB,CAArC,GAAyC;AAAhD,eAAN;AACH;AACJ,WARD;;AAUA,cAAImgD,YAAY,GAAG;AACf5qB,oBAAQ,EAAE,KAAKA,QAAL,CAActC,QADT;AAEfgG,oBAAQ,EAAEtjB,MAAM,CAACsjB,QAFF;AAGfhF,qBAAS,EAAEte,MAAM,CAACse,SAHH;AAIfmsB,mBAAO,EAAEzqC,MAAM,CAACyqC,OAJD;AAKftB,4BAAgB,EAAEnpC,MAAM,CAACmpC,gBALV;AAMfxqB,oBAAQ,EAAE;AANK,WAAnB;AASA,cAAIA,QAAJ;;AAEA,cAAIa,GAAG,CAACpJ,QAAJ,CAAa4G,EAAb,CAAJ,EAAsB;AAClB2B,oBAAQ,GAAGje,EAAE,CAACsc,EAAD,EAAKwtB,YAAL,CAAb;AACH,WAFD,MAGK,IAAIhrB,GAAG,CAACtJ,OAAJ,CAAY8G,EAAZ,CAAJ,EAAqB;AACtBwtB,wBAAY,GAAGhrB,GAAG,CAAC5I,KAAJ,CAAUoG,EAAE,CAAC,CAAD,CAAZ,EAAiBwtB,YAAjB,CAAf;AACA7rB,oBAAQ,GAAGje,EAAE,CAACsc,EAAE,CAAC,CAAD,CAAH,EAAQwtB,YAAR,CAAb;AACH,WAHI,MAIA;AACD7rB,oBAAQ,GAAG3B,EAAE,CAACrU,KAAH,EAAX;AACH,WA/BuC,CAiCxC;AACA;AACA;AACA;AACA;;;AACAgW,kBAAQ,CAAChW,KAAT,GAAiB,YAAY;AACzB;AACA,gBAAI6W,GAAG,CAACpJ,QAAJ,CAAa4G,EAAb,CAAJ,EAAsB;AAClB,qBAAOtc,EAAE,CAACsc,EAAD,EAAKwtB,YAAL,CAAT;AACH,aAFD,MAGK,IAAIhrB,GAAG,CAACtJ,OAAJ,CAAY8G,EAAZ,CAAJ,EAAqB;AACtBwtB,0BAAY,GAAGhrB,GAAG,CAAC5I,KAAJ,CAAUoG,EAAE,CAAC,CAAD,CAAZ,EAAiBwtB,YAAjB,CAAf;AACA,qBAAO9pC,EAAE,CAACsc,EAAE,CAAC,CAAD,CAAH,EAAQwtB,YAAR,CAAT;AACH;AACJ,WATgB,CASfh/B,IATe,CASV,IATU,CAAjB;;AAWAmT,kBAAQ,CAAC+B,MAAT,GAAkBA,MAAlB;AACA,iBAAO/B,QAAP;AACH,SAnDD;;AAqDA,aAAK+rB,WAAL,GAAmB,UAAS1tB,EAAT,EAAa4D,YAAb,EAA2B;AAC1C,cAAIgX,GAAG,GAAG,KAAK0S,eAAL,CAAqBttB,EAArB,CAAV;;AACA,eAAK2tB,mBAAL,CAAyB/S,GAAzB,EAA8B,IAA9B;AACH,SAHD;;AAKA,aAAK+S,mBAAL,GAA2B,UAAU3tB,EAAV,EAAc4D,YAAd,EAA4B;AACnD,cAAI,KAAKjC,QAAL,IAAiB,IAArB,EAA2B;AACvB,iBAAKA,QAAL,CAAciW,OAAd;AACA,iBAAKjW,QAAL,CAAcpN,OAAd;AACH;;AACD,eAAKoN,QAAL,GAAgB3B,EAAhB;AACA,eAAKpgB,IAAL,GAAY,KAAK+hB,QAAL,CAAc/hB,IAA1B;AACA,eAAK2mB,MAAL,GAAc,KAAK5E,QAAL,CAAc4E,MAA5B;AACH,SARD;;AAUAohB,WAAG,CAAC7rB,MAAJ,CAAW,IAAX,EAAiB9Y,MAAjB,EAAyB4oC,cAAzB;;AAEA,aAAK9Q,QAAL,GAAgB93B,MAAM,CAAC83B,QAAP,IAAmB,KAAnC;AACA,aAAKrK,iBAAL,GAAyBztB,MAAM,CAACytB,iBAAP,IAA4B,KAArD;AACA,aAAKuK,QAAL,GAAgBh4B,MAAM,CAACg4B,QAAP,IAAmB,KAAnC;AAEA,aAAKjP,WAAL,GAAmB/oB,MAAM,CAAC+oB,WAAP,IAAsB,EAAzC;AACA,aAAKuC,sBAAL,GAA8BtrB,MAAM,CAAC,0BAAD,CAApC;AAEA,aAAKiH,KAAL,GAAajH,MAAM,CAACiH,KAAP,IAAgB2Y,QAAQ,CAAC4C,eAAT,EAA7B;AACA,aAAKpC,SAAL,GAAiB,IAAjB;AACA,aAAKwqB,mBAAL,GAA2B5qC,MAAM,CAAC4lC,QAAP,IAAmBhmB,QAAQ,CAACiC,QAAT,CAAkBiF,mBAAhE;AACA,aAAK+jB,qBAAL,GAA6BjrB,QAAQ,CAACiC,QAAT,CAAkB0D,qBAA/C;;AACA,YAAIvlB,MAAM,CAAC6qC,qBAAP,KAAiC,KAAjC,IAA0C7qC,MAAM,CAAC8qC,UAAP,KAAsB,KAApE,EAA2E;AACvE,eAAKD,qBAAL,GAA6B,KAA7B;AACH;;AACD,aAAKE,mBAAL,GAA2B/qC,MAAM,CAAC+qC,mBAAP,KAA+B,KAA1D;;AAEA,YAAI/qC,MAAM,CAACi9B,gBAAX,EAA6B;AACzB,eAAKzxB,IAAL,CAAU,gBAAV,EAA4BxL,MAAM,CAACi9B,gBAAnC;AACH,SAxM4B,CA0M7B;AACA;AACA;;;AACA,aAAK/J,aAAL,GAAqB,UAAUtQ,UAAV,EAAsB;AACvC,eAAKmG,WAAL,CAAiB/5B,IAAjB,CAAsB4zB,UAAtB;AACA,eAAK,CAAC,KAAKmG,WAAL,CAAiB/+B,MAAjB,GAA0B,CAA1B,GAA8B,KAA9B,GAAsC,QAAvC,IAAmD,OAAxD,EAAiE41B,QAAQ,CAACkQ,sBAA1E;AACA,eAAK,CAAC,KAAK3E,MAAL,KAAgB,KAAhB,GAAwB,QAAzB,IAAqC,OAA1C,EAAmDvL,QAAQ,CAACmQ,iBAA5D;AACH,SAJD;;AAMA,aAAKqD,oBAAL,GAA4B,UAAUxQ,UAAV,EAAsB9jB,GAAtB,EAA2Bu2B,YAA3B,EAAyC;AACjEv2B,aAAG,GAAGA,GAAG,IAAI,IAAP,GAAc,KAAKiqB,WAAL,CAAiBlwB,OAAjB,CAAyB+pB,UAAzB,CAAd,GAAqD9jB,GAA3D;;AACA,cAAIA,GAAG,IAAI,CAAX,EAAc;AACV,iBAAKiqB,WAAL,CAAiB7vB,MAAjB,CAAwB4F,GAAxB,EAA6B,CAA7B;AACA,iBAAK,CAAC,KAAKiqB,WAAL,CAAiB/+B,MAAjB,GAA0B,CAA1B,GAA8B,KAA9B,GAAsC,QAAvC,IAAmD,OAAxD,EAAiE41B,QAAQ,CAACkQ,sBAA1E;AACA,iBAAK,CAAC,KAAK3E,MAAL,KAAgB,KAAhB,GAAwB,QAAzB,IAAqC,OAA1C,EAAmDvL,QAAQ,CAACmQ,iBAA5D;AACH;;AAED,cAAI,CAACsF,YAAD,IAAiBsU,aAAjB,IAAkC,KAAK5gB,WAAL,CAAiB/+B,MAAjB,KAA4B,CAAlE,EAAqE;AACjE41B,oBAAQ,CAACiU,YAAT,CAAsB;AAClBlV,sBAAQ,EAAE,IADQ;AAElBrc,uBAAS,EAAE,KAFO;AAGlBsxB,mCAAqB,EAAEyB,YAAY,KAAK;AAHtB,aAAtB;AAKH;AACJ,SAfD;;AAiBA,aAAKR,qBAAL,GAA6B,UAAS70B,MAAT,EAAiB;AAC1C,cAAInV,CAAC,GAAG,KAAKk+B,WAAL,CAAiB/+B,MAAzB;;AACA,eAAK,IAAIM,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGO,CAApB,EAAuBP,CAAC,EAAxB,EAA4B;AACxBs1B,oBAAQ,CAAC+U,gBAAT,CAA0B,KAAK5L,WAAL,CAAiB,CAAjB,CAA1B,EAA+C/oB,MAA/C;AACH;AACJ,SALD;;AAOA,aAAKgrC,UAAL,GAAkB,UAAU/f,cAAV,EAA0B3oB,SAA1B,EAAqCxB,aAArC,EAAoD;AAClE,cAAIjW,CAAC,GAAG,EAAR;;AACA,eAAK,IAAIP,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKy+B,WAAL,CAAiB/+B,MAArC,EAA6CM,CAAC,EAA9C,EAAkD;AAC9C,gBAAI,KAAKy+B,WAAL,CAAiBz+B,CAAjB,EAAoB80B,SAApB,CAA8B,CAA9B,MAAqC6L,cAArC,IAAuD,KAAKlC,WAAL,CAAiBz+B,CAAjB,EAAoB80B,SAApB,CAA8B,CAA9B,MAAqC6L,cAAhG,EAAgH;AAC5GpgC,eAAC,CAACmE,IAAF,CAAO,KAAK+5B,WAAL,CAAiBz+B,CAAjB,CAAP;AACH;AACJ;;AACD,eAAK,IAAIqB,CAAC,GAAG,CAAR,EAAW0xB,KAAK,GAAGxyB,CAAC,CAACb,MAA1B,EAAkC2B,CAAC,GAAG0xB,KAAtC,EAA6C1xB,CAAC,EAA9C,EAAkD;AAC9Ci0B,oBAAQ,CAAC+U,gBAAT,CAA0B9pC,CAAC,CAAC,CAAD,CAA3B;AACH;;AACD,iBAAO,IAAP;AACH,SAXD;;AAaA,aAAK68B,UAAL,GAAkB,YAAY;AAC1B,iBAAO,KAAKqC,OAAZ;AACH,SAFD;;AAIA,aAAKkhB,UAAL,GAAkB,UAAUvzC,EAAV,EAAc;AAC5B,cAAIwzC,QAAQ,GAAG,KAAKtrB,QAAL,CAActC,QAAd,CAAuB2B,KAAvB,CAA6BvnB,EAA7B,CAAf;AAAA,cACIyzC,KAAK,GAAG,KAAKnd,SADjB,CAD4B,CAG5B;;;AACAxO,aAAG,CAACjH,kBAAJ,CAAuBvY,MAAM,CAACgpB,kBAAP,CAA0B,KAAKgF,SAA/B,CAAvB,EAAkE,UAAU11B,CAAV,EAAa;AAC3E,mBAAOA,CAAC,CAAC+c,EAAF,KAAS,KAAKA,EAArB;AACH,WAFiE,CAEhE7J,IAFgE,CAE3D,IAF2D,CAAlE;;AAGA,eAAKue,OAAL,GAAe4a,GAAG,CAACjd,UAAJ,CAAehwB,EAAf,CAAf;AACA,eAAKs2B,SAAL,GAAiBpO,QAAQ,CAACX,KAAT,CAAe,KAAK8K,OAApB,CAAjB;;AACAnK,kBAAQ,CAACyK,aAAT,CAAuB+gB,cAAvB,CAAsC,IAAtC,EAA4CD,KAA5C,EAAmD,KAAKphB,OAAxD;;AACAnK,kBAAQ,CAACyrB,WAAT,CAAqBjd,aAArB,CAAmC,KAAKrE,OAAxC;;AACAvK,aAAG,CAAC9G,SAAJ,CAAc1Y,MAAM,CAACgpB,kBAArB,EAAyCkiB,QAAzC,EAAmD,IAAnD;;AACA,iBAAO,IAAP;AACH,SAbD;AAeA;;;;;AAGA,aAAKI,eAAL,GAAuB,YAAY;AAC/B,cAAInF,GAAG,GAAG,KAAK1nB,MAAL,CAAYupB,kBAAZ,CAA+B;AAACje,mBAAO,EAAE;AAAV,WAA/B,CAAV;AAAA,cACIvW,CAAC,GAAG,KAAKiL,MAAL,CAAYsb,cAAZ,CAA2B,IAA3B,CADR;AAAA,cAEIwR,GAAG,GAAG,KAAK9sB,MAAL,CAAYqrB,WAAZ,EAFV;AAAA,cAGI0B,aAAa,GAAG;AACZhgC,gBAAI,EAAE,gBAAY,CACjB,CAFW;AAGZ4lB,mBAAO,EAAE,mBAAY;AACjB,qBAAO,CAAE+U,GAAG,CAAC,CAAD,CAAL,EAAUA,GAAG,CAAC,CAAD,CAAb,CAAP;AACH,aALW;AAMZ6B,8BAAkB,EAAE,8BAAY;AAC5B,qBAAO,CAAE7B,GAAG,CAAC,CAAD,CAAL,EAAUA,GAAG,CAAC,CAAD,CAAb,CAAP;AACH,aARW;AASZpM,0BAAc,EAAE,0BAAY;AACxB,qBAAOvmB,CAAP;AACH,aAXW;AAYZs2B,uBAAW,EAAE,uBAAY;AACrB,qBAAOyB,GAAP;AACH;AAdW,WAHpB;AAoBA,iBAAOxe,YAAY,CAAC;AAChB6N,uBAAW,EAAE56B,MAAM,CAAC46B,WADJ;AAEhBnc,kBAAM,EAAE+sB,aAFQ;AAGhBztB,kBAAM,EAAE,KAAKgM,OAHG;AAIhBlK,sBAAU,EAAE,KAAK8E,aAAL,EAJI;AAKhBhG,oBAAQ,EAAE3e,MAAM,CAACyrC,UAAP,GAAoB,OAApB,GAA8B,KAAK9sB,QAL7B;AAMhBsa,sBAAU,EAAE,IANI;AAOhBhyB,iBAAK,EAAE,KAAKA,KAPI;AAQhB0hC,qBAAS,EAAC;AARM,WAAD,CAAnB;AAUH,SA/BD;AAiCA;;;;;AAGA,aAAK+C,iBAAL,GAAyB,YAAY;AACjC,iBAAO,KAAK3iB,WAAL,CAAiB,CAAjB,CAAP;AACH,SAFD;;AAIA,aAAK4iB,QAAL,GAAgB,KAAKlnB,aAArB;;AAEA,aAAKyM,KAAL,GAAa,UAAUlxB,MAAV,EAAkB;AAC3BA,gBAAM,GAAGA,MAAM,IAAI,EAAnB;AACA,cAAIogB,SAAS,GAAGpgB,MAAM,CAACogB,SAAvB;AAAA,cAAkC8E,MAAM,GAAG,EAAEllB,MAAM,CAACklB,MAAP,KAAkB,KAApB,CAA3C;;AACA,cAAI,CAAC9E,SAAD,IAAc,KAAKA,SAAL,KAAmBA,SAArC,EAAgD;AAE5C,gBAAI2O,IAAI,GAAGnP,QAAQ,CAAC4Z,YAAT,CAAsB;AAAExa,kBAAI,EAAE,KAAKgP,SAAb;AAAwB5N,uBAAS,EAAEA;AAAnC,aAAtB,CAAX;;AAEA,gBAAIiR,EAAE,GAAGrxB,MAAM,CAACoqB,MAAP,GAAgBpqB,MAAM,CAACoqB,MAAP,CAAc5W,CAA9B,GAAkCub,IAAI,CAACvb,CAAhD;;AACA,gBAAI6d,EAAE,IAAI,IAAV,EAAgB;AACZ,kBAAIyK,EAAE,GAAG97B,MAAM,CAAC+nC,WAAhB;AAAA,kBAA6B6D,mBAAmB,GAAG5rC,MAAM,CAAC4rC,mBAA1D;;AACA,kBAAI9P,EAAE,IAAI,IAAV,EAAgB;AACZ,oBAAIxK,EAAE,GAAGtxB,MAAM,CAAC6rC,UAAP,IAAqB9c,IAAI,CAAC1lC,CAAnC;AAAA,oBACI4wC,YAAY,GAAG;AAAE5I,oBAAE,EAAE,CAAEA,EAAE,CAACxlC,IAAL,EAAWwlC,EAAE,CAAC1xB,GAAd,CAAN;AAA2B2xB,oBAAE,EAAEA,EAA/B;AAAmCvH,yBAAO,EAAE,IAA5C;AAAkD3J,2BAAS,EAAEA;AAA7D,iBADnB;;AAEA,oBAAI8E,MAAM,IAAI,KAAKzG,MAAL,CAAYqtB,SAAtB,IAAmC,KAAK/iB,WAAL,CAAiB/+B,MAAjB,GAA0B,CAAjE,EAAoE;AAChE,sBAAIa,CAAC,GAAGg+C,mCAAmC,CAAC,IAAD,EAAO7oC,MAAM,CAAC8oC,qBAAd,CAA3C;AAAA,sBACIiD,IAAI,GAAGlhD,CAAC,CAACu0B,SAAF,CAAY,CAAZ,MAAmB,IAAnB,GAA0B,CAA1B,GAA8B,CADzC;AAAA,sBAEI4sB,GAAG,GAAGD,IAAI,KAAK,CAAT,GAAalhD,CAAC,CAACi4B,QAAf,GAA0Bj4B,CAAC,CAACk4B,QAFtC;AAAA,sBAGIkpB,KAAK,GAAGrsB,QAAQ,CAAC0iB,aAAT,CAAuB0J,GAAvB,CAHZ;AAAA,sBAIIE,OAAO,GAAGD,KAAK,CAACz4B,CAJpB;AAAA,sBAIuB24B,GAAG,GAAGF,KAAK,CAAC5iD,CAJnC;;AAMA4wC,8BAAY,CAAC1iC,KAAb,GAAqBw0C,IAAI,KAAK,CAAT,GAAa,CAAb,GAAiB,CAAtC;AACA9R,8BAAY,CAACrX,UAAb,GAA0B/3B,CAA1B;AACAovC,8BAAY,CAACmS,GAAb,GAAmB,CAAEF,OAAO,CAACrgD,IAAV,EAAgBqgD,OAAO,CAACvsC,GAAxB,CAAnB;AACAs6B,8BAAY,CAACoS,GAAb,GAAmBF,GAAnB;AACAlS,8BAAY,CAACqS,QAAb,GAAwBzhD,CAAC,CAACu0B,SAAF,CAAY2sB,IAAZ,CAAxB;AACH,iBAZD,MAYO,IAAI,KAAKhjB,WAAL,CAAiB/+B,MAAjB,GAA0B,CAA9B,EAAiC;AACpCiwC,8BAAY,CAACrX,UAAb,GAA0B,KAAKmG,WAAL,CAAiB,CAAjB,CAA1B;AACH;;AACD+S,kBAAE,GAAG,KAAKrd,MAAL,CAAY2S,OAAZ,CAAoB6I,YAApB,CAAL;AACH;;AAED,mBAAKtb,QAAL,CAAcyS,OAAd,CAAsB0K,EAAtB,EAA0B,KAAKrd,MAAL,CAAYsb,cAAZ,CAA2B,IAA3B,CAA1B,EAA4D,KAAKna,QAAL,CAAc6B,eAA1E,EAA2FmqB,mBAAmB,IAAI,KAAKnqB,eAAvH;AACA,mBAAK9C,QAAL,CAAcuS,KAAd,CAAoB,KAAKtR,QAAL,CAAc6B,eAAlC,EAAmD,KAAKhD,MAAxD;AACA,mBAAK2B,SAAL,GAAiBA,SAAjB,CAzBY,CA2BZ;;AACA,mBAAK,IAAI91B,CAAT,IAAc,KAAKs1B,QAAL,CAAcsC,QAA5B,EAAsC;AAClC,oBAAI,KAAKtC,QAAL,CAAcsC,QAAd,CAAuBzlB,cAAvB,CAAsCnS,CAAtC,CAAJ,EAA8C;AAC1C,sBAAIkpB,CAAC,GAAG,KAAKoM,QAAL,CAAcsC,QAAd,CAAuB53B,CAAvB,CAAR;;AACA,sBAAIkpB,CAAC,CAACyb,SAAF,EAAJ,EAAmB;AACf,yBAAKrP,QAAL,CAAcgC,iBAAd,CAAgCt3B,CAAhC,IAAqCkpB,CAAC,CAAC8kB,IAAF,CAAO,KAAK3Z,QAAZ,EAAsB,KAAKiB,QAAL,CAAc6B,eAApC,CAArC;AACAjO,qBAAC,CAAC0d,KAAF,CAAQ,KAAKtR,QAAL,CAAcgC,iBAAd,CAAgCt3B,CAAhC,CAAR;AACH;AACJ;AACJ;AACJ;AACJ;AACJ,SA/CD;;AAiDA,aAAKw2B,iBAAL,GAAyB,YAAY;AACjC,iBAAO,UAAP;AACH,SAFD;;AAGA,aAAKmO,SAAL,GAAiB,YAAY;AACzB,iBAAO,KAAKrP,QAAL,CAAcwpB,OAArB;AACH,SAFD;;AAIA,aAAKhoB,OAAL,GAAe,KAAK8P,KAApB;AAEA,YAAIqb,mBAAmB,GAAG,KAA1B;;AACA,aAAKnf,aAAL,GAAqB,YAAY;AAE7B;AACA;AACA,cAAI,CAACmf,mBAAD,IAAwB5H,GAAG,CAACjW,eAAJ,CAAoB,KAAK3E,OAAzB,CAA5B,EAA+D;AAC3D,gBAAIyiB,eAAe,GAAG;AAAEn3B,gBAAE,EAAE,IAAN;AAAY0U,qBAAO,EAAE;AAArB,aAAtB;AAAA,gBACIsD,GAAG,GAAG,IADV;AAAA,gBAEIof,WAAW,GAAG,KAFlB;AAAA,gBAGIC,iBAAiB,GAAG,IAHxB;AAAA,gBAIIC,YAAY,GAAGhF,0BAA0B,CAAC,IAAD,EAAO6E,eAAP,EAAwB5sB,QAAxB,CAJ7C;AAAA,gBAKIyd,WAAW,GAAGr9B,MAAM,CAACq9B,WAAP,IAAsB,EALxC;AAAA,gBAMIuP,WAAW,GAAG,EANlB;AAAA,gBAOIC,UAAU,GAAGlI,GAAG,CAACzI,UAAJ,CAAe/sB,KAPhC;AAAA,gBAQIguB,SAAS,GAAGwH,GAAG,CAACzI,UAAJ,CAAettB,IAR/B;AAAA,gBASIwuB,SAAS,GAAGuH,GAAG,CAACzI,UAAJ,CAAe52B,IAT/B;AAAA,gBAUIwnC,gBAAgB,GAAGnI,GAAG,CAACzI,UAAJ,CAAe9sB,WAVtC;AAAA,gBAWIrO,OAXJ,CAD2D,CAc3D;AACA;;;AACA,gBAAIqO,WAAW,GAAG,SAAdA,WAAc,CAAS29B,iBAAT,EAA4B;AAC1ChsC,qBAAO,GAAGgsC,iBAAiB,CAACz0C,CAAlB,CAAoByI,OAApB,IAA+B,EAAzC;AACH,aAFD;;AAIA,gBAAIoO,KAAK,GAAG,UAAU69B,WAAV,EAAuB;AAEnD;AAEoB3f,iBAAG,GAAG,KAAKqe,iBAAL,EAAN,CAJ+B,CAMnD;;AAEoB,kBAAI39B,SAAS,GAAG,IAAhB,CAR+B,CAS/B;;AACA,kBAAI,CAAC,KAAKxG,SAAL,EAAL,EAAuB;AACnBwG,yBAAS,GAAG,KAAZ;AACH,eAZ8B,CAa/B;;;AACA,kBAAIsf,GAAG,IAAI,IAAP,IAAe,CAAC,KAAKyK,QAArB,IAAiC,CAAC,KAAKrK,iBAA3C,EAA8D;AAC1D1f,yBAAS,GAAG,KAAZ;AACH,eAhB8B,CAiB/B;;;AACA,kBAAI,KAAK+pB,QAAL,IAAiB,KAAK3M,MAAL,EAAjB,IAAkC,EAAEkC,GAAG,IAAI,IAAP,IAAe,KAAK0d,mBAAtB,CAAtC,EAAkF;AAC9Eh9B,yBAAS,GAAG,KAAZ;AACH,eApB8B,CAqB/B;AACA;AACA;;;AACA,kBAAIsf,GAAG,IAAI,IAAP,IAAe,CAACA,GAAG,CAACF,YAAJ,CAAiB,IAAjB,CAApB,EAA4C;AACxC;AACA,oBAAI,KAAKhC,MAAL,EAAJ,EAAmB;AACfpd,2BAAS,GAAG,KAAZ;AACH,iBAFD,MAEO;AACH;AACA;AACAsf,qBAAG,GAAG,IAAN;AACH;AACJ;;AAED,kBAAI4f,UAAU,GAAGrtB,QAAQ,CAACqD,cAAT,CAAwBoK,GAAG,IAAI,IAAP,GAAc,YAAd,GAA6B,mBAArD,EAA0E;AACvF1O,wBAAQ,EAAC,IAD8E;AAEvFZ,sBAAM,EAAC,KAAKgM,OAF2E;AAGvFjH,wBAAQ,EAAC,KAAKkL,SAHyE;AAIvFpL,0BAAU,EAACyK;AAJ4E,eAA1E,CAAjB;;AAMA,kBAAI4f,UAAU,KAAK,KAAnB,EAA0B;AACtBl/B,yBAAS,GAAG,KAAZ;AACH,eAFD,CAGA;AACA;AAJA,mBAKK,IAAI,OAAOk/B,UAAP,KAAsB,QAA1B,EAAoC;AACrCtI,qBAAG,CAAC7rB,MAAJ,CAAWm0B,UAAX,EAAuBlsC,OAAO,IAAI,EAAlC;AACH,iBAFI,MAGA;AACD;AACAksC,4BAAU,GAAGlsC,OAAO,IAAI,EAAxB;AACH;;AAED,kBAAIgN,SAAS,KAAK,KAAlB,EAAyB;AACrB;AACA;AACA;AACA,oBAAI6R,QAAQ,CAACqoB,QAAb,EAAuB;AACnBroB,0BAAQ,CAACqoB,QAAT,CAAkB,KAAK1kB,MAAvB;AACH;;AACDopB,4BAAY,CAAC1E,QAAb;;AACA,uBAAO,KAAP;AACH,eA/D8B,CAiEnD;AAEoB;AAEA;;;AACA,mBAAK,IAAI39C,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKy+B,WAAL,CAAiB/+B,MAArC,EAA6CM,CAAC,EAA9C,EAAkD;AAC9C,qBAAKy+B,WAAL,CAAiBz+B,CAAjB,EAAoBmc,QAApB,CAA6B,KAA7B;AACH;;AAED,mBAAKS,QAAL,CAAc,cAAd;;AACA0Y,sBAAQ,CAAC2P,yBAAT,CAAmC,IAAnC,EA3E+B,CA6E/B;;;AACA,kBAAIlC,GAAG,IAAI,CAAC,KAAKlC,MAAL,EAAR,IAAyB,KAAK2M,QAAlC,EAA4C;AACxCzK,mBAAG,GAAG,IAAN;AACH;;AAEDzN,sBAAQ,CAAC4Z,YAAT,CAAsB;AAAExa,oBAAI,EAAE,KAAKgP;AAAb,eAAtB,EAlF+B,CAoFnD;;;AAEoB,kBAAIma,IAAI,GAAG,KAAKvoB,QAAL,CAActC,QAAd,CAAuB+b,SAAvB,CAAiC,KAAK9V,MAAtC,CAAX;AAAA,kBACI2pB,aAAa,GAAG,KAAK3pB,MADzB;AAAA,kBAEI6kB,GAAG,GAAG,KAAKxoB,QAAL,CAActC,QAAd,CAAuBrN,OAAvB,CAA+B,KAAKsT,MAApC,CAFV;;AAIA2kB,uCAAyB,CAACsE,eAAD,EAAkB5sB,QAAlB,EAA4BuoB,IAA5B,EAAkCC,GAAlC,CAAzB,CA1F+B,CA4F/B;;;AACAxoB,sBAAQ,CAACutB,aAAT,CAAuB,KAAK5pB,MAA5B,EAAoC;AAChC,0BAAUipB,eAAe,CAACn3B,EADM;AAEhC,wBAAQ,KAAK2Y;AAFmB,eAApC,EA7F+B,CAkGnD;;;AAEoB,kBAAIof,eAAe,GAAG,KAAK7D,SAAL,IAAkB,KAAK5qB,QAA7C;;AACA,kBAAI,KAAK4qB,SAAL,IAAkB,IAAlB,IAA0B,KAAKne,cAAL,IAAuB,IAArD,EAA2D;AACvD,oBAAI4R,GAAG,GAAG,KAAKpd,QAAL,CAActC,QAAd,CAAuBie,2BAAvB,CAAmD,KAAKnQ,cAAxD,CAAV;;AACA,oBAAI4R,GAAG,CAAC5d,SAAJ,CAAc,CAAd,CAAJ,EAAsB;AAClBguB,iCAAe,GAAGpQ,GAAG,CAAC5d,SAAJ,CAAc,CAAd,CAAlB;AACH;AACJ;;AACD,kBAAIiuB,YAAY,GAAG,KAAKztB,QAAL,CAActC,QAAd,CAAuBoc,UAAvB,CAAkC,QAAlC,CAAnB;;AACA2T,0BAAY,CAACvJ,UAAb,GAA0B,IAA1B;AACA,mBAAKlkB,QAAL,CAAcypB,gBAAd,GAAiCf,qBAAqB,CAAC,KAAK3jB,aAAL,EAAD,EAAuB0oB,YAAvB,EAAqCD,eAArC,EAAsD,KAAK7pB,MAA3D,EAAmEipB,eAAe,CAACziB,OAAnF,EAA4FnK,QAA5F,EAAsGmN,YAAtG,EAAoH,KAAK9lB,KAAzH,CAAtD;AACA,kBAAIqmC,YAAY,GAAG,KAAK1tB,QAAL,CAAcypB,gBAAd,CAA+B5qB,MAAlD;;AAGA,kBAAI4O,GAAG,IAAI,IAAX,EAAiB;AAEb,qBAAK5mB,QAAL,CAAc,KAAd,EAAqB,KAArB,EAFa,CAGb;;AACA4mB,mBAAG,GAAGV,cAAc,CAAC;AACjB3B,gCAAc,EAAE,IADC;AAEjBC,gCAAc,EAAE,KAAKrL,QAAL,CAAcypB,gBAFb;AAGjBtrB,wBAAM,EAAE,KAAKgM,OAHI;AAGM;AACvBvzB,wBAAM,EAAEg2C,eAAe,CAACziB,OAJP;AAKjByB,yBAAO,EAAE,CAAE,KAAK/M,MAAP,EAAe,KAAKmB,QAAL,CAAcypB,gBAAd,CAA+B5qB,MAA9C,CALQ;AAMjBoB,4BAAU,EAAE7f,MAAM,CAAC+oC,cANF;AAMkB;AACnCjpB,iCAAe,EAAE9f,MAAM,CAACgpC,mBAPP;AAQjBE,2BAAS,EAAElpC,MAAM,CAACkpC,SARD;AAQY;AAC7BhnB,0BAAQ,EAAEliB,MAAM,CAACqrB,iBATA;AAUjBzuB,sBAAI,EAAE,KAAKwuB,cAVM;AAWjB9H,0BAAQ,EAAE,KAAKoM,cAXE;AAYjB5d,4BAAU,EAAE,KAAKm3B,mBAZA;AAajBhiC,uBAAK,EAACjH,MAAM,CAACiH,KAbI;AAcjBsmC,sBAAI,EAACN;AAdY,iBAAD,CAApB;AAgBA5f,mBAAG,CAACG,OAAJ,GAAc,IAAd;AACAH,mBAAG,CAACnmB,QAAJ,CAAa0Y,QAAQ,CAACuQ,aAAtB;;AACA,qBAAKvQ,QAAL,CAAcypB,gBAAd,CAA+BniC,QAA/B,CAAwC0Y,QAAQ,CAACuQ,aAAjD;;AACA,qBAAKvQ,QAAL,CAAcypB,gBAAd,CAA+B5qB,MAA/B,GAAwC6uB,YAAxC,CAvBa,CAwBb;;AACA1tB,wBAAQ,CAAC/D,IAAT,CAAc,gBAAd,EAAgCwR,GAAhC,EAzBa,CA2Bb;AACA;AACA;AACA;;;AAEAzN,wBAAQ,CAAC8N,MAAT,CAAgBzB,aAAhB,CAA8BoB,GAA9B;AAEH,eAlCD,MAkCO;AACHof,2BAAW,GAAG,IAAd;AACApf,mBAAG,CAAC5mB,QAAJ,CAAa,KAAb,EAFG,CAGH;;AACA,oBAAI+mC,SAAS,GAAGngB,GAAG,CAACjO,SAAJ,CAAc,CAAd,EAAiB/J,EAAjB,KAAwB,KAAKA,EAA7B,GAAkC,CAAlC,GAAsC,CAAtD;AACA,qBAAK+d,oBAAL,CAA0B/F,GAA1B,EAA+B,IAA/B,EAAqC,IAArC,EALG,CAKiE;AAEpE;;AACA,oBAAIogB,SAAS,GAAG7tB,QAAQ,CAAC8tB,YAAT,CAAsBR,aAAtB,CAAhB;;AACAttB,wBAAQ,CAACjlB,YAAT,CAAsB,KAAK4oB,MAA3B,EAAmC,eAAnC,EAAoDkqB,SAApD,EATG,CAWH;AACA;;;AACA7tB,wBAAQ,CAAC/D,IAAT,CAAc,gBAAd,EAAgCwR,GAAhC,EAbG,CAeH;;;AACA,oBAAImgB,SAAS,KAAK,CAAlB,EAAqB;AACjBd,mCAAiB,GAAG,CAAErf,GAAG,CAACtP,MAAN,EAAcsP,GAAG,CAACvK,QAAlB,EAA4BoqB,aAA5B,EAA2CO,SAA3C,CAApB;;AACA7tB,0BAAQ,CAAC8N,MAAT,CAAgB6F,qBAAhB,CAAsClG,GAAG,CAACjO,SAAJ,CAAcouB,SAAd,EAAyBxf,SAA/D,EAA0Ewe,eAAe,CAACn3B,EAA1F,EAA8FgY,GAA9F,EAAmGmf,eAAe,CAACziB,OAAnH,EAA4H,CAA5H;AAEH,iBAJD,MAIO;AACH2iB,mCAAiB,GAAG,CAAErf,GAAG,CAAC72B,MAAN,EAAc62B,GAAG,CAACtK,QAAlB,EAA4BmqB,aAA5B,EAA2CO,SAA3C,CAApB;;AACA7tB,0BAAQ,CAAC8N,MAAT,CAAgB6F,qBAAhB,CAAsClG,GAAG,CAACjO,SAAJ,CAAcouB,SAAd,EAAyBxf,SAA/D,EAA0Ewe,eAAe,CAACn3B,EAA1F,EAA8FgY,GAA9F,EAAmGmf,eAAe,CAACziB,OAAnH,EAA4H,CAA5H;AACH,iBAvBE,CAyBH;;;AACAsD,mBAAG,CAACE,iBAAJ,GAAwBF,GAAG,CAACjO,SAAJ,CAAcouB,SAAd,CAAxB,CA1BG,CA4BH;;AACAngB,mBAAG,CAACgO,gBAAJ,GAAuBhO,GAAG,CAACjO,SAAJ,CAAcouB,SAAd,EAAyB9lB,UAAzB,EAAvB;AACA2F,mBAAG,CAACsgB,kBAAJ,GAAyBtgB,GAAG,CAACjO,SAAJ,CAAcouB,SAAd,EAAyBxf,SAAlD;AACAX,mBAAG,CAACugB,oBAAJ,GAA2BJ,SAAS,KAAK,CAAd,GAAkB,QAAlB,GAA6B,QAAxD;AAEAngB,mBAAG,CAACE,iBAAJ,CAAsB9mB,QAAtB,CAA+B,KAA/B;AACA,qBAAKmZ,QAAL,CAAcypB,gBAAd,CAA+BwE,iBAA/B,GAAmDxgB,GAAG,CAACE,iBAAvD;AACAF,mBAAG,CAACjO,SAAJ,CAAcouB,SAAd,IAA2B,KAAK5tB,QAAL,CAAcypB,gBAAzC;AAEAhc,mBAAG,CAACnmB,QAAJ,CAAa0Y,QAAQ,CAACuQ,aAAtB;;AACA,qBAAKvQ,QAAL,CAAcypB,gBAAd,CAA+BniC,QAA/B,CAAwC0Y,QAAQ,CAACuQ,aAAjD;AACH;;AAEDvQ,sBAAQ,CAAC8iB,0BAAT,CAAoC8J,eAApC,EAAqDnf,GAArD,EAA0D,KAAKzN,QAAL,CAAcypB,gBAAxE,EA5L+B,CA8L/B;;;AACAzpB,sBAAQ,CAACkF,iBAAT,GAA6B,IAA7B;AACH,aAhMW,CAgMVtZ,IAhMU,CAgML,IAhMK,CAAZ;;AAkMA,gBAAIoD,IAAI,GAAG,YAAY;AACnBgR,sBAAQ,CAAC2P,yBAAT,CAAmC,KAAnC;;AAEA,kBAAIlC,GAAG,IAAIA,GAAG,CAACjO,SAAJ,IAAiB,IAA5B,EAAkC;AAC9B;AACA,oBAAIte,aAAa,GAAG8e,QAAQ,CAACkuB,YAAT,CAAsBz2C,SAAtB,CAApB,CAF8B,CAG9B;;;AACA,oBAAIyH,GAAG,GAAG8gB,QAAQ,CAACikB,sBAAT,CAAgCxW,GAAhC,CAAV;;AACAA,mBAAG,CAACjO,SAAJ,CAActgB,GAAG,KAAK,CAAR,GAAY,CAAZ,GAAgB,CAA9B,EAAiC2f,MAAjC,CAAwC0c,MAAxC;AACA9N,mBAAG,CAAC7e,WAAJ,CAAgBoR,QAAQ,CAACuQ,aAAzB,EAN8B,CAO9B;AACA;AACA;AACA;;AACA,oBAAI,KAAKvQ,QAAL,KAAkByN,GAAG,CAAC0gB,mBAAJ,IAA2B1gB,GAAG,CAACjO,SAAJ,CAActgB,GAAd,MAAuB,KAAK8gB,QAAL,CAAcypB,gBAAlF,CAAJ,EAAyG;AACrG;AACA,sBAAIoD,WAAW,IAAIpf,GAAG,CAACE,iBAAvB,EAA0C;AACtC;AACA;AACA,wBAAIzuB,GAAG,KAAK,CAAZ,EAAe;AACXuuB,yBAAG,CAAC2gB,eAAJ,GAAsB3gB,GAAG,CAACtP,MAA1B;AACAsP,yBAAG,CAAC4gB,UAAJ,GAAiB5gB,GAAG,CAACvK,QAArB;AACAuK,yBAAG,CAACgc,gBAAJ,GAAuBhc,GAAG,CAACjO,SAAJ,CAAc,CAAd,CAAvB;AACAiO,yBAAG,CAAC6gB,aAAJ,GAAoB,CAApB;AACA7gB,yBAAG,CAACtP,MAAJ,GAAa2uB,iBAAiB,CAAC,CAAD,CAA9B;AACArf,yBAAG,CAACvK,QAAJ,GAAe4pB,iBAAiB,CAAC,CAAD,CAAhC;AACH,qBAPD,MAOO;AACH;AACArf,yBAAG,CAAC2gB,eAAJ,GAAsB3gB,GAAG,CAAC72B,MAA1B;AACA62B,yBAAG,CAAC4gB,UAAJ,GAAiB5gB,GAAG,CAACtK,QAArB;AACAsK,yBAAG,CAACgc,gBAAJ,GAAuBhc,GAAG,CAACjO,SAAJ,CAAc,CAAd,CAAvB;AACAiO,yBAAG,CAAC6gB,aAAJ,GAAoB,CAApB;AACA7gB,yBAAG,CAAC72B,MAAJ,GAAak2C,iBAAiB,CAAC,CAAD,CAA9B;AACArf,yBAAG,CAACtK,QAAJ,GAAe2pB,iBAAiB,CAAC,CAAD,CAAhC;AACH;;AAED,wBAAIyB,EAAE,GAAG,KAAKvuB,QAAL,CAAcypB,gBAAvB,CApBsC,CAoBG;AACzC;;AACAzpB,4BAAQ,CAACkf,YAAT,CAAsB4N,iBAAiB,CAAC,CAAD,CAAvC,EAA4CA,iBAAiB,CAAC,CAAD,CAA7D;;AACArf,uBAAG,CAACjO,SAAJ,CAActgB,GAAd,IAAqBuuB,GAAG,CAACE,iBAAzB,CAvBsC,CAwBtC;AACA;;AACA,wBAAIF,GAAG,CAAC8J,UAAJ,MAAoB9J,GAAG,CAAC+gB,cAAxB,IAA0C/gB,GAAG,CAACghB,YAA9C,IAA8D,CAACzuB,QAAQ,CAAC+U,gBAAT,CAA0BtH,GAA1B,EAA+B;AAACvsB,mCAAa,EAAEA;AAAhB,qBAA/B,CAAnE,EAAmI;AAE/HusB,yBAAG,CAAC5mB,QAAJ,CAAa,KAAb;AACA4mB,yBAAG,CAACghB,YAAJ,GAAmB,IAAnB;AACAhhB,yBAAG,CAAC+gB,cAAJ,GAAqB,IAArB;;AACA,2BAAKxuB,QAAL,CAAcypB,gBAAd,CAA+BjW,oBAA/B,CAAoD/F,GAApD;;AACAA,yBAAG,CAACE,iBAAJ,CAAsB2F,aAAtB,CAAoC7F,GAApC,EAN+H,CAQ/H;AACA;AACA;;AACA,0BAAIvuB,GAAG,KAAK,CAAZ,EAAe;AACX8gB,gCAAQ,CAAC8N,MAAT,CAAgB6F,qBAAhB,CAAsClG,GAAG,CAAC4gB,UAA1C,EAAsD5gB,GAAG,CAACtK,QAA1D,EAAoEsK,GAApE,EAAyEA,GAAG,CAAC72B,MAA7E,EAAqFsI,GAArF;AACH,uBAFD,MAGK;AACD8gB,gCAAQ,CAAC8N,MAAT,CAAgB6F,qBAAhB,CAAsClG,GAAG,CAAC4gB,UAA1C,EAAsD5gB,GAAG,CAACvK,QAA1D,EAAoEuK,GAApE,EAAyEA,GAAG,CAACtP,MAA7E,EAAqFjf,GAArF;AACH;;AAED8gB,8BAAQ,CAACwB,OAAT,CAAiBsrB,iBAAiB,CAAC,CAAD,CAAlC;AACH,qBAnBD,MAoBK;AACD9sB,8BAAQ,CAACiU,YAAT,CAAsB;AAAClV,gCAAQ,EAAEwvB;AAAX,uBAAtB;AACH;AACJ;AACJ,iBA/D6B,CAiE9B;;;AACA,oBAAI,KAAKG,mBAAT,EAA8B;AAC1B1uB,0BAAQ,CAACiU,YAAT,CAAsB;AAAClV,4BAAQ,EAAE;AAAX,mBAAtB;AACH,iBAFD,MAGK;AACD,sBAAI,KAAKiB,QAAT,EAAmB;AACd,yBAAKsR,KAAL,CAAW;AAAChM,4BAAM,EAAE;AAAT,qBAAX;AACJ;AACJ,iBAzE6B,CA2E9B;;;AACAtF,wBAAQ,CAAC/D,IAAT,CAAc,oBAAd,EAAoCwR,GAApC,EAAyCvsB,aAAzC,EA5E8B,CA6E9B;;;AACA,oBAAIusB,GAAG,CAACG,OAAR,EAAiB;AACb5N,0BAAQ,CAAC/D,IAAT,CAAc,mBAAd,EAAmCwR,GAAnC,EAAwCvsB,aAAxC;AACH,iBAhF6B,CAiF9B;;;AACA8e,wBAAQ,CAACkF,iBAAT,GAA6B,KAA7B;AACAuI,mBAAG,CAACgO,gBAAJ,GAAuB,IAAvB;AACAhO,mBAAG,CAACE,iBAAJ,GAAwB,IAAxB;AACAF,mBAAG,GAAG,IAAN;AACH,eAzFkB,CA2FnB;AACA;AACA;;;AACA,kBAAImf,eAAe,IAAIA,eAAe,CAACziB,OAAvC,EAAgD;AAC5CnK,wBAAQ,CAACtf,MAAT,CAAgBksC,eAAe,CAACziB,OAAhC,EAAyC,KAAzC,EAAgD,KAAhD;AACH,eAhGkB,CAiGnB;;;AACA,kBAAIuf,WAAJ,EAAiB;AACb1pB,wBAAQ,CAACiU,YAAT,CAAsB;AAAClV,0BAAQ,EAAE2qB;AAAX,iBAAtB;AACH;;AAED,kBAAI,KAAK1pB,QAAT,EAAmB;AACf;AACA,qBAAK2D,MAAL,CAAYlW,KAAZ,CAAkBkhC,UAAlB,GAA+B,SAA/B,CAFe,CAGf;;AACA,qBAAK9vB,MAAL,CAAY0c,MAAZ,GAJe,CAKf;;AACA,qBAAKvb,QAAL,CAAcypB,gBAAd,GAAiC,IAAjC;AACH;AAEJ,aA/GU,CA+GT79B,IA/GS,CA+GJ,IA/GI,CAAX;;AAiHA6xB,uBAAW,GAAGsH,GAAG,CAAC7rB,MAAJ,CAAW8zB,WAAX,EAAwBvP,WAAxB,CAAd;AACAA,uBAAW,CAACp2B,KAAZ,GAAoB,KAAKA,KAAL,IAAco2B,WAAW,CAACp2B,KAA9C;AACAo2B,uBAAW,CAACyP,gBAAD,CAAX,GAAgCttB,GAAG,CAACxE,IAAJ,CAASqiB,WAAW,CAACyP,gBAAD,CAApB,EAAwC19B,WAAxC,EAAqD,KAArD,CAAhC;AACAiuB,uBAAW,CAACwP,UAAD,CAAX,GAA0BrtB,GAAG,CAACxE,IAAJ,CAASqiB,WAAW,CAACwP,UAAD,CAApB,EAAkC19B,KAAlC,EAAyC,KAAzC,CAA1B,CA1U2D,CA2U3D;;AACAkuB,uBAAW,CAACD,SAAD,CAAX,GAAyB5d,GAAG,CAACxE,IAAJ,CAASqiB,WAAW,CAACD,SAAD,CAApB,EAAiCuP,YAAY,CAACrnC,IAA9C,CAAzB;AACA+3B,uBAAW,CAACF,SAAD,CAAX,GAAyB3d,GAAG,CAACxE,IAAJ,CAASqiB,WAAW,CAACF,SAAD,CAApB,EAAiCvuB,IAAjC,CAAzB;AACAyuB,uBAAW,CAACv0B,YAAZ,GAA2B,KAA3B;;AAEAu0B,uBAAW,CAAC3wB,OAAZ,GAAsB,YAAY;AAC9B,qBAAO,KAAKorB,QAAL,IAAiB,KAAKrK,iBAAtB,IAA4C,KAAK1E,WAAL,CAAiB/+B,MAAjB,GAA0B,CAA1B,IAA+B,KAAK6gD,qBAAL,KAA+B,KAAjH;AACH,aAFqB,CAEpBr/B,IAFoB,CAEf,IAFe,CAAtB;;AAIAoU,oBAAQ,CAACwN,aAAT,CAAuB,KAAK7J,MAA5B,EAAoC8Z,WAApC,EAAiD,UAAjD;;AAEA,iBAAK9Z,MAAL,CAAY8Y,sBAAZ,GAAqC,KAAKtS,OAA1C;AAEAwiB,+BAAmB,GAAG,IAAtB;AACH;AACJ,SA9VD;;AAgWA,YAAIvvB,EAAE,GAAGhd,MAAM,CAAC2e,QAAP,IAAmB,KAAKiB,QAAL,CAActC,QAAd,CAAuBuE,QAAvB,CAAgCiE,QAAnD,IAA+D6e,GAAG,CAAC9iB,QAAJ,CAAaiE,QAArF;AACA,aAAK4kB,WAAL,CAAiB1tB,EAAjB,EAAqB,IAArB;AACA,YAAIwxB,iBAAiB,GAAGxuC,MAAM,CAACye,MAAP,GAAgBze,MAAM,CAACye,MAAvB,GAAgCze,MAAM,CAACwrB,OAAP,GAAiBxrB,MAAM,CAACwrB,OAAxB,GAAmC5L,QAAQ,CAACiC,QAAT,CAAkBwD,MAAlB,IAA4B,KAAvH;AACA,aAAKgS,SAAL,CAAemX,iBAAf,EAAkC,IAAlC,EAttB6B,CAwtB7B;;AACA,YAAI5xC,IAAI,GAAG,CAAE,SAAF,EAAcoD,MAAM,CAACpD,IAAP,IAAe,EAA7B,EAAkCuhB,IAAlC,CAAuC,GAAvC,CAAX;AACA,aAAKkG,OAAL,CAAaznB,IAAb,EAAmBoD,MAAM,CAACutC,IAA1B,EAAgC,IAAhC;AACA,aAAKhqB,MAAL,GAAc,KAAK5E,QAAL,CAAc4E,MAA5B;AACA,aAAKA,MAAL,CAAY3D,QAAZ,GAAuB,IAAvB;AAEA,aAAKwN,aAAL,GA9tB6B,CAguB7B;AACA;;AACA,YAAIqhB,eAAe,GAAG,UAAUlrB,MAAV,EAAkBmrB,WAAlB,EAA+B/vB,QAA/B,EAAyCkvB,iBAAzC,EAA4D;AAE9E,cAAIlJ,GAAG,CAACgK,eAAJ,CAAoB,KAAK5kB,OAAzB,CAAJ,EAAuC;AACnC,gBAAI6Q,WAAW,GAAG56B,MAAM,CAAC46B,WAAP,IAAsBhb,QAAQ,CAACiC,QAAT,CAAkBgE,WAAxC,IAAuD8e,GAAG,CAAC9iB,QAAJ,CAAagE,WAAtF;AACA+U,uBAAW,GAAG+J,GAAG,CAAC7rB,MAAJ,CAAW,EAAX,EAAe8hB,WAAf,CAAd;AACAA,uBAAW,CAAC3zB,KAAZ,GAAoB2zB,WAAW,CAAC3zB,KAAZ,IAAqB,KAAKA,KAA9C;;AACA,gBAAIg1B,SAAS,GAAG0I,GAAG,CAACzI,UAAJ,CAAerrB,IAA/B;AAAA,gBACI+9B,SAAS,GAAGjK,GAAG,CAACzI,UAAJ,CAAel/B,IAD/B;AAAA,gBAEI6xC,QAAQ,GAAGlK,GAAG,CAACzI,UAAJ,CAAepjC,GAF9B;AAAA,gBAGI8+B,GAAG,GAAG,IAHV;AAAA,gBAII/mB,IAAI,GAAG+O,QAAQ,CAACmb,mBAAT,CAA6B;AAChC7C,yBAAW,EAAE,uBAAY;AACrB,uBAAON,GAAP;AACH,eAH+B;AAIhC5X,qBAAO,EAAEJ,QAJuB;AAKhCvY,qBAAO,EAAE,mBAAY;AACjB,uBAAOsX,QAAQ,IAAI,IAAZ,GAAmBA,QAAQ,CAACpX,SAAT,EAAnB,GAA0C,IAAjD;AACH,eAP+B;AAQhC4jB,oBAAM,EAAE,kBAAY;AAChB,uBAAOxM,QAAQ,CAACwM,MAAT,EAAP;AACH,eAV+B;AAWhCpB,qBAAO,EAAE,KAAKA,OAXkB;AAYhCiE,uBAAS,EAAE,KAAKA,SAZgB;AAahC8J,sBAAQ,EAAE,KAAKA,QAbiB;AAchCE,sBAAQ,EAAE,KAAKA,QAdiB;AAehC9wB,sBAAQ,EAAE,kBAAU2c,KAAV,EAAiB;AACvB+T,mBAAG,CAAC1wB,QAAJ,CAAa2c,KAAb;AACH,eAjB+B;AAkBhCrV,yBAAW,EAAE,qBAAUqV,KAAV,EAAiB;AAC1B+T,mBAAG,CAACppB,WAAJ,CAAgBqV,KAAhB;AACH,eApB+B;AAqBhChB,2BAAa,EAAE,yBAAY;AACvB,uBAAO+U,GAAG,CAAC/U,aAAJ,CAAkBlxB,KAAlB,CAAwBimC,GAAxB,EAA6BvgC,SAA7B,CAAP;AACH,eAvB+B;AAwBhCsxC,uBAAS,EAACkF,iBAxBsB;AAyBhCzS,sBAAQ,EAAC,kBAAS/N,GAAT,EAAcyhB,QAAd,EAAwB;AAC7B,uBAAOzhB,GAAG,CAACE,iBAAJ,IAAyBuhB,QAAQ,CAACnG,SAAlC,IAAgDtb,GAAG,CAACE,iBAAJ,CAAsBlY,EAAtB,KAA6By5B,QAAQ,CAACnG,SAAT,CAAmBtzB,EAAvG;AACH;AA3B+B,aAA7B,CAJX;;AAkCAulB,uBAAW,CAACqB,SAAD,CAAX,GAAyBzc,GAAG,CAACxE,IAAJ,CAAS4f,WAAW,CAACqB,SAAD,CAApB,EAAiCprB,IAAjC,EAAuC,IAAvC,CAAzB;AACA+pB,uBAAW,CAACgU,SAAD,CAAX,GAAyBpvB,GAAG,CAACxE,IAAJ,CAAS4f,WAAW,CAACgU,SAAD,CAApB,EAAiC,YAAY;AAClE,kBAAIxpC,SAAS,GAAGu/B,GAAG,CAACoK,aAAJ,CAAkB13C,SAAlB,CAAhB;AAAA,kBACIge,EAAE,GAAGuK,QAAQ,CAACllB,YAAT,CAAsBiqC,GAAG,CAACjd,UAAJ,CAAetiB,SAAf,CAAtB,EAAiD,QAAjD,CADT;AAAA,kBAEI4pC,IAAI,GAAGpvB,QAAQ,CAAC+iB,wBAAT,CAAkCttB,EAAlC,CAFX,CADkE,CAGjB;;;AAEjD,kBAAI25B,IAAI,IAAI,IAAZ,EAAkB;AACd,oBAAIlwC,GAAG,GAAG8gB,QAAQ,CAACikB,sBAAT,CAAgCmL,IAAhC,CAAV,CADc,CAEd;AACA;;;AACA,oBAAI1qB,KAAK,GAAI,KAAK0T,QAAL,IAAiBl5B,GAAG,KAAK,CAA1B,IAAiCkwC,IAAI,CAACzhB,iBAAL,IAA0B,KAAKsgB,iBAA/B,IAAoD,KAAKA,iBAAL,CAAuBx4B,EAAvB,KAA8B25B,IAAI,CAACzhB,iBAAL,CAAuBlY,EAAtJ;;AACA,oBAAIiP,KAAJ,EAAW;AACP,sBAAI2qB,EAAE,GAAGrvB,QAAQ,CAACqD,cAAT,CAAwB,kBAAxB,EAA4C;AACjD+H,kCAAc,EAAEgkB,IAAI,CAAC5vB,SAAL,CAAetgB,GAAf,CADiC;AAEjDmsB,kCAAc,EAAE,IAFiC;AAGjDrI,8BAAU,EAAEosB;AAHqC,mBAA5C,CAAT;;AAKA,uBAAK,CAACC,EAAE,GAAG,KAAH,GAAW,QAAd,IAA0B,OAA/B,EAAwCrvB,QAAQ,CAACoQ,wBAAjD;AACA,uBAAK,CAACif,EAAE,GAAG,QAAH,GAAc,KAAjB,IAA0B,OAA/B,EAAwCrvB,QAAQ,CAACqQ,0BAAjD;;AACA+e,sBAAI,CAAC5vB,SAAL,CAAetgB,GAAf,EAAoB2f,MAApB,CAA2BzhB,IAA3B,CAAgC,KAAKyhB,MAArC,EAA6C,IAA7C;AACH;AACJ;AACJ,aArByD,CAqBxDjT,IArBwD,CAqBnD,IArBmD,CAAjC,CAAzB;AAuBAovB,uBAAW,CAACiU,QAAD,CAAX,GAAwBrvB,GAAG,CAACxE,IAAJ,CAAS4f,WAAW,CAACiU,QAAD,CAApB,EAAgC,YAAY;AAChE,kBAAIzpC,SAAS,GAAGu/B,GAAG,CAACoK,aAAJ,CAAkB13C,SAAlB,CAAhB;AAAA,kBACIge,EAAE,GAAGjQ,SAAS,IAAI,IAAb,GAAoB,IAApB,GAA2Bwa,QAAQ,CAACllB,YAAT,CAAsBiqC,GAAG,CAACjd,UAAJ,CAAetiB,SAAf,CAAtB,EAAiD,QAAjD,CADpC;AAAA,kBAEI4pC,IAAI,GAAG35B,EAAE,GAAGuK,QAAQ,CAAC+iB,wBAAT,CAAkCttB,EAAlC,CAAH,GAA2C,IAFxD;;AAIA,kBAAI25B,IAAI,IAAI,IAAZ,EAAkB;AACd,oBAAIlwC,GAAG,GAAG8gB,QAAQ,CAACikB,sBAAT,CAAgCmL,IAAhC,CAAV;;AACA,oBAAI1qB,KAAK,GAAI,KAAK0T,QAAL,IAAiBl5B,GAAG,KAAK,CAA1B,IAAiCkwC,IAAI,CAACzhB,iBAAL,IAA0B,KAAKsgB,iBAA/B,IAAoD,KAAKA,iBAAL,CAAuBx4B,EAAvB,KAA8B25B,IAAI,CAACzhB,iBAAL,CAAuBlY,EAAtJ;;AACA,oBAAIiP,KAAJ,EAAW;AACP,uBAAK9V,WAAL,CAAiBoR,QAAQ,CAACoQ,wBAA1B;AACA,uBAAKxhB,WAAL,CAAiBoR,QAAQ,CAACqQ,0BAA1B;;AACA+e,sBAAI,CAAC5vB,SAAL,CAAetgB,GAAf,EAAoB2f,MAApB,CAA2B3lB,GAA3B;AACH;AACJ;AACJ,aAduD,CActD0S,IAdsD,CAcjD,IAdiD,CAAhC,CAAxB;;AAgBAoU,oBAAQ,CAAC0c,aAAT,CAAuB/Y,MAAvB,EAA+BqX,WAA/B,EAA4C,UAA5C,EAAwD8T,WAAxD;AACH;AACJ,SAlFqB,CAkFpBljC,IAlFoB,CAkFf,IAlFe,CAAtB,CAluB6B,CAszB7B;AACA;;;AACA,YAAI,CAAC,KAAKiT,MAAL,CAAYqlB,UAAjB,EAA6B;AACzB2K,yBAAe,CAAC,KAAKlrB,MAAN,EAAc,EAAEvjB,MAAM,CAACi5B,UAAP,IAAqB,KAAKxa,MAAL,CAAYqlB,UAAnC,CAAd,EAA8D,IAA9D,EAAoE9jC,MAAM,CAAC2oC,SAA3E,CAAf;AACH;;AAED,eAAO,IAAP;AACH,OA7zBD;;AA+zBAnpB,SAAG,CAAC1G,MAAJ,CAAW6rB,GAAG,CAAC7e,QAAf,EAAyB6e,GAAG,CAACU,gCAA7B,EAA+D;AAE3DvW,kBAAU,EAAE,oBAAU5lC,CAAV,EAAagmD,sBAAb,EAAqCC,wBAArC,EAA+D;AACvE,eAAKvvB,QAAL,CAAcwpB,OAAd,GAAwBlgD,CAAxB;;AACA,cAAI,KAAKq6B,MAAT,EAAiB;AACb,iBAAKA,MAAL,CAAYlW,KAAZ,CAAkB+hC,OAAlB,GAA4BlmD,CAAC,GAAG,OAAH,GAAa,MAA1C;AACH;;AACD,eAAKA,CAAC,GAAG,cAAH,GAAoB,cAA1B;;AACA,cAAI,CAACgmD,sBAAL,EAA6B;AACzB,iBAAK,IAAI5kD,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKy+B,WAAL,CAAiB/+B,MAArC,EAA6CM,CAAC,EAA9C,EAAkD;AAC9C,mBAAKy+B,WAAL,CAAiBz+B,CAAjB,EAAoBwkC,UAApB,CAA+B5lC,CAA/B;;AACA,kBAAI,CAACimD,wBAAL,EAA+B;AAC3B,oBAAIpD,IAAI,GAAG,SAAS,KAAKhjB,WAAL,CAAiBz+B,CAAjB,EAAoB80B,SAApB,CAA8B,CAA9B,CAAT,GAA4C,CAA5C,GAAgD,CAA3D,CAD2B,CAE3B;;AACA,oBAAI,KAAK2J,WAAL,CAAiBz+B,CAAjB,EAAoB80B,SAApB,CAA8B2sB,IAA9B,EAAoChjB,WAApC,CAAgD/+B,MAAhD,KAA2D,CAA/D,EAAkE;AAC9D,uBAAK++B,WAAL,CAAiBz+B,CAAjB,EAAoB80B,SAApB,CAA8B2sB,IAA9B,EAAoCjd,UAApC,CAA+C5lC,CAA/C,EAAkD,IAAlD,EAAwD,IAAxD;AACH;AACJ;AACJ;AACJ;AACJ,SApB0D;AAqB3Dq3B,2BAAmB,EAAE,+BAAY;AAC7B,iBAAO,KAAKwI,WAAZ;AACH,SAvB0D;AAwB3D5H,iBAAS,EAAE,mBAAU92B,CAAV,EAAau2B,YAAb,EAA2B;AAClC,eAAK6D,aAAL,CAAmBp6B,CAAC,CAACqhC,aAAF,IAAmBrhC,CAAC,CAACw1B,UAAxC,EAAoDe,YAApD;AACA,eAAK8D,kBAAL,CAAwBr6B,CAAC,CAACuhC,kBAAF,IAAwBvhC,CAAC,CAACy1B,eAAlD,EAAmEc,YAAnE;;AACA,cAAIv2B,CAAC,CAAC4wC,cAAF,IAAoB,IAAxB,EAA8B;AAC1B,iBAAKrb,QAAL,CAAcqb,cAAd,GAA+B5wC,CAAC,CAAC4wC,cAAjC;AACH;;AACD,cAAI5wC,CAAC,CAAC4c,KAAN,EAAa;AACT,iBAAKA,KAAL,GAAa5c,CAAC,CAAC4c,KAAf;AACH;;AACD09B,aAAG,CAAC7rB,MAAJ,CAAW,IAAX,EAAiBzuB,CAAjB,EAAoBu+C,cAApB;;AACA,cAAIv+C,CAAC,CAACi5B,QAAF,IAAc,IAAd,IAAsB,KAAKC,MAA/B,EAAuC;AACnC,iBAAK3D,QAAL,CAActC,QAAd,CAAuBpW,QAAvB,CAAgC,KAAKqc,MAArC,EAA6Cl5B,CAAC,CAACi5B,QAA/C;AACH;;AACDqhB,aAAG,CAACU,gCAAJ,CAAqClkB,SAArC,CAA+C,IAA/C,EAAqD92B,CAArD;AACH,SAtC0D;AAuC3Dkd,iBAAS,EAAE,qBAAY;AACnB,iBAAO,KAAKqY,QAAL,CAAcvY,OAArB;AACH,SAzC0D;AA0C3DC,kBAAU,EAAE,oBAAUhP,CAAV,EAAa;AACrB,eAAKsnB,QAAL,CAAcvY,OAAd,GAAwB/O,CAAxB;AACH,SA5C0D;AA6C3Ds8B,eAAO,EAAE,mBAAY;AACjB,cAAImV,WAAW,GAAG,KAAKnqB,QAAL,CAActC,QAAd,CAAuBiT,yBAAvB,IAAoD,KAAK3Q,QAAL,CAAc8pB,kBAAd,GAAmC,MAAM,KAAK9pB,QAAL,CAAc8pB,kBAAvD,GAA4E,EAAhI,CAAlB;;AACA/E,aAAG,CAACn2B,WAAJ,CAAgB,KAAKub,OAArB,EAA8BggB,WAA9B;;AACA,eAAKtrB,MAAL,GAAc,IAAd;AACA,eAAKE,QAAL,CAAciW,OAAd,CAAsB,IAAtB;AACA,eAAKjW,QAAL,CAAcpN,OAAd;AACA,eAAKoN,QAAL,GAAgB,IAAhB,CANiB,CAOjB;;AACA,eAAKiB,QAAL,CAActC,QAAd,CAAuBxI,gBAAvB,CAAwC,KAAKyO,MAA7C,EAAqD,UAArD;;AACA,eAAK3D,QAAL,CAActC,QAAd,CAAuBvI,gBAAvB,CAAwC,KAAKwO,MAA7C,EAAqD,UAArD;AACH,SAvD0D;AAwD3D9c,gBAAQ,EAAE,kBAAUzU,CAAV,EAAa;AACnB,cAAI,KAAK2sB,QAAL,IAAiB,KAAKiB,QAAtB,IAAkC,CAAC,KAAKA,QAAL,CAActC,QAAd,CAAuBkS,wBAAvB,EAAvC,EAA0F;AACtF,iBAAK7Q,QAAL,CAAclY,QAAd,CAAuBzU,CAAvB;AACH;AACJ,SA5D0D;AA6D3Dm5B,cAAM,EAAE,kBAAY;AAChB,iBAAO,KAAKvL,QAAL,CAAcqb,cAAd,KAAiC,CAAjC,GAAqC,IAArC,GAA4C,EAAE,KAAK6I,UAAL,MAAqB,KAAKlkB,QAAL,CAAcqb,cAAd,GAA+B,CAApD,IAAyD,KAAKlS,WAAL,CAAiB/+B,MAAjB,GAA0B,KAAK41B,QAAL,CAAcqb,cAAnG,CAAnD;AACH,SA/D0D;;AAgE3D;;;AAGA6I,kBAAU,EAAE,sBAAY;AACpB,iBAAO,KAAKrlB,MAAL,IAAe,IAAf,IAAuB,KAAKA,MAAL,CAAYqlB,UAA1C;AACH,SArE0D;AAsE3DuL,qBAAa,EAAE,uBAAU1wB,QAAV,EAAoB;AAC/B,cAAI2wB,KAAK,GAAG,KAAZ;;AACA,cAAI3wB,QAAJ,EAAc;AACV,iBAAK,IAAIr0B,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKy+B,WAAL,CAAiB/+B,MAArC,EAA6CM,CAAC,EAA9C,EAAkD;AAC9C,kBAAI,KAAKy+B,WAAL,CAAiBz+B,CAAjB,EAAoB80B,SAApB,CAA8B,CAA9B,MAAqCT,QAArC,IAAiD,KAAKoK,WAAL,CAAiBz+B,CAAjB,EAAoB80B,SAApB,CAA8B,CAA9B,MAAqCT,QAA1F,EAAoG;AAChG2wB,qBAAK,GAAG,IAAR;AACA;AACH;AACJ;AACJ;;AACD,iBAAOA,KAAP;AACH,SAjF0D;AAkF3DC,yBAAiB,EAAE,6BAAY;AAC3B,iBAAO,KAAK3vB,QAAL,CAAc4pB,cAArB;AACH,SApF0D;AAqF3DgG,yBAAiB,EAAE,2BAAU3kD,CAAV,EAAa;AAC5B,eAAK+0B,QAAL,CAAc4pB,cAAd,GAA+B3+C,CAA/B;AACH,SAvF0D;AAwF3D4kD,8BAAsB,EAAE,kCAAY;AAChC,iBAAO,KAAK7vB,QAAL,CAAc6pB,mBAArB;AACH,SA1F0D;AA2F3DiG,8BAAsB,EAAE,gCAAU3iD,CAAV,EAAa;AACjC,eAAK6yB,QAAL,CAAc6pB,mBAAd,GAAoC18C,CAApC;AACH,SA7F0D;AA8F3D00C,oBAAY,EAAE,sBAAUkO,KAAV,EAAiB;AAC3B,eAAK3hB,SAAL,GAAiB2hB,KAAjB;AACA,eAAKlxB,MAAL,CAAYuP,SAAZ,GAAwB2hB,KAAxB;AACH,SAjG0D;AAkG3DjO,2BAAmB,EAAE,6BAAUpiC,GAAV,EAAe;AAChC,eAAKyqB,OAAL,GAAe4a,GAAG,CAACjd,UAAJ,CAAepoB,GAAf,CAAf;AACH,SApG0D;AAqG3DswC,8BAAsB,EAAE,gCAAUC,OAAV,EAAmB;AACvC,eAAK9E,mBAAL,GAA2B8E,OAA3B;AACH,SAvG0D;AAwG3DC,cAAM,EAAE,gBAAUnxB,QAAV,EAAoB;AACxB,iBAAO,KAAKF,MAAL,CAAYqxB,MAAZ,CAAmBnxB,QAAQ,CAACF,MAA5B,CAAP;AACH,SA1G0D;AA2G3DsxB,eAAO,EAAE,mBAAY;AACjB,iBAAO,KAAKnwB,QAAL,CAAcxY,IAArB;AACH,SA7G0D;AA8G3D4oC,qBAAa,EAAE,uBAAUhwC,MAAV,EAAkB;AAC7B,iBAAO,KAAKye,MAAL,CAAY2S,OAAZ,CAAoBpxB,MAApB,CAAP;AACH;AAhH0D,OAA/D;;AAmHAzX,UAAI,CAAC60B,eAAL,CAAqBjpB,SAArB,CAA+B4mC,mBAA/B,GAAqD,UAAU+T,QAAV,EAAoB;AACrE,eAAO,UAAUx2C,CAAV,EAAa;AAEhB,cAAIsnB,QAAQ,GAAGkvB,QAAQ,CAAC9uB,OAAxB,CAFgB,CAIhB;AACA;;AACA8uB,kBAAQ,CAACtgC,WAAT,CAAqBoR,QAAQ,CAACoQ,wBAA9B;AACA8e,kBAAQ,CAACtgC,WAAT,CAAqBoR,QAAQ,CAACqQ,0BAA9B;;AAEA,cAAInvB,aAAa,GAAG8e,QAAQ,CAACkuB,YAAT,CAAsBz2C,SAAtB,CAApB;AAAA,cACI+N,SAAS,GAAGwa,QAAQ,CAACmvB,aAAT,CAAuB13C,SAAvB,CADhB;AAAA,cAEIge,EAAE,GAAGuK,QAAQ,CAACllB,YAAT,CAAsB0K,SAAtB,EAAiC,QAAjC,CAFT;AAAA,cAGI4Z,IAAI,GAAGY,QAAQ,CAACllB,YAAT,CAAsB0K,SAAtB,EAAiC,MAAjC,CAHX;AAAA,cAII6B,KAAK,GAAG2Y,QAAQ,CAACllB,YAAT,CAAsB0K,SAAtB,EAAiC,eAAjC,CAJZ;AAAA,cAKIioB,GAAG,GAAGzN,QAAQ,CAAC+iB,wBAAT,CAAkCttB,EAAlC,CALV,CATgB,CAgBhB;;;AACA,cAAIgY,GAAG,IAAI,IAAX,EAAiB;AACb;AACH,WAnBe,CAqBhB;;;AACA,cAAI4iB,kBAAkB,GAAG5iB,GAAG,CAACE,iBAAJ,IAAyB,IAAlD,CAtBgB,CAwBhB;AACA;;AACA,cAAI0iB,kBAAkB,IAAI5iB,GAAG,CAACE,iBAAJ,CAAsB3N,QAAtB,IAAkC,IAA5D,EAAkE;AAC9D;AACH,WA5Be,CA8BhB;AACA;AACA;;;AACA,cAAIgY,GAAG,GAAGkX,QAAQ,CAAC5W,WAAT,CAAqB7K,GAArB,CAAV,CAjCgB,CAmChB;;;AACA,cAAIuK,GAAG,IAAI,IAAX,EAAiB;AACb;AACH,WAtCe,CAwChB;AACA;;;AACA,cAAIkX,QAAQ,CAAC1T,QAAT,CAAkB/N,GAAlB,EAAuByhB,QAAvB,CAAJ,EAAsC;AAClCzhB,eAAG,CAAC+gB,cAAJ,GAAqB,IAArB;AACA/gB,eAAG,CAAC5mB,QAAJ,CAAa,KAAb;;AACA,gBAAIqoC,QAAQ,CAAC9S,YAAb,EAA2B;AACvB8S,sBAAQ,CAAC9S,YAAT,CAAsBpE,GAAtB;AACH;;AACD;AACH,WAjDe,CAmDhB;;;AACA,cAAI94B,GAAG,GAAG8gB,QAAQ,CAACikB,sBAAT,CAAgCxW,GAAhC,CAAV;;AACA,cAAKvuB,GAAG,KAAK,CAAR,IAAa,CAACgwC,QAAQ,CAAChX,QAAxB,IAAqCh5B,GAAG,KAAK,CAAR,IAAa,CAACgwC,QAAQ,CAAC9W,QAAhE,EAA0E;AACtE,gBAAI8W,QAAQ,CAAC9S,YAAb,EAA2B;AACvB8S,sBAAQ,CAAC9S,YAAT,CAAsBpE,GAAtB;AACH;;AACD;AACH;;AAED,cAAIkX,QAAQ,CAAC5T,MAAb,EAAqB;AACjB4T,oBAAQ,CAAC5T,MAAT,CAAgB7N,GAAhB;AACH,WA9De,CAgEhB;;;AACA,cAAIpmB,KAAJ,EAAW;AACP2Y,oBAAQ,CAACkf,YAAT,CAAsB15B,SAAtB,EAAiC6B,KAAjC;AACH,WAnEe,CAqEhB;AACA;;;AACA,cAAIkkB,MAAM,GAAG2jB,QAAQ,CAAC3jB,MAAT,CAAgB7yB,CAAhB,CAAb;;AACA,cAAI6yB,MAAJ,EAAY;AACRyM,eAAG,CAAC/b,IAAJ,CAAS,gBAAT,EAA2B;AACvB8C,sBAAQ,EAAE,IADa;AAEvBiE,wBAAU,EAAEyK,GAFW;AAGvB4N,4BAAc,EAAErD,GAAG,CAAChY,QAAJ,CAAaqb;AAHN,aAA3B,EAIGn6B,aAJH;AAKH,WA9Ee,CA+EhB;AACA;;;AACA,cAAI,CAACqqB,MAAD,IAAY2jB,QAAQ,CAACznC,OAAT,EAAhB,EAAoC;AAChC,gBAAI6oC,WAAW,GAAG,IAAlB,CADgC,CAGhC;AACA;AACA;;AACA,gBAAIpxC,GAAG,KAAK,CAAZ,EAAe;AACXuuB,iBAAG,CAAC2gB,eAAJ,GAAsB3gB,GAAG,CAACtP,MAA1B;AACAsP,iBAAG,CAAC4gB,UAAJ,GAAiB5gB,GAAG,CAACvK,QAArB;AACAuK,iBAAG,CAACgc,gBAAJ,GAAuBhc,GAAG,CAACjO,SAAJ,CAAc,CAAd,CAAvB;AACAiO,iBAAG,CAAC6gB,aAAJ,GAAoB,CAApB;AACA7gB,iBAAG,CAACtP,MAAJ,GAAa+wB,QAAQ,CAAC/kB,OAAtB;AACAsD,iBAAG,CAACvK,QAAJ,GAAelD,QAAQ,CAACX,KAAT,CAAe6vB,QAAQ,CAAC/kB,OAAxB,CAAf;AACH,aAPD,MAOO;AACHsD,iBAAG,CAAC2gB,eAAJ,GAAsB3gB,GAAG,CAAC72B,MAA1B;AACA62B,iBAAG,CAAC4gB,UAAJ,GAAiB5gB,GAAG,CAACtK,QAArB;AACAsK,iBAAG,CAACgc,gBAAJ,GAAuBhc,GAAG,CAACjO,SAAJ,CAAc,CAAd,CAAvB;AACAiO,iBAAG,CAAC6gB,aAAJ,GAAoB,CAApB;AACA7gB,iBAAG,CAAC72B,MAAJ,GAAas4C,QAAQ,CAAC/kB,OAAtB;AACAsD,iBAAG,CAACtK,QAAJ,GAAenD,QAAQ,CAACX,KAAT,CAAe6vB,QAAQ,CAAC/kB,OAAxB,CAAf;AACH,aApB+B,CAsBhC;AACA;;;AACA,gBAAIkmB,kBAAkB,IAAI5iB,GAAG,CAACE,iBAAJ,CAAsBlY,EAAtB,KAA6BuiB,GAAG,CAACviB,EAA3D,EAA+D;AAC3D,kBAAI,CAACgY,GAAG,CAAC1K,eAAJ,CAAoB0K,GAApB,CAAD,IAA6B,CAACA,GAAG,CAACjO,SAAJ,CAActgB,GAAd,EAAmB6jB,eAAnB,CAAmC0K,GAAnC,CAA9B,IAAyE,CAACA,GAAG,CAACE,iBAAJ,CAAsB5K,eAAtB,CAAsC0K,GAAtC,CAA1E,IAAwH,CAACzN,QAAQ,CAACqD,cAAT,CAAwB,cAAxB,EAAwCoK,GAAxC,CAA7H,EAA2K;AACvK6iB,2BAAW,GAAG,KAAd;AACH;AACJ,aA5B+B,CA8BhD;;;AAEgB,gBAAIC,gBAAgB,GAAG,UAAUC,YAAV,EAAwB;AAC3C;AACA;AACA/iB,iBAAG,CAACjO,SAAJ,CAActgB,GAAd,EAAmBs0B,oBAAnB,CAAwC/F,GAAxC,EAH2C,CAK3C;;AACA,kBAAIA,GAAG,CAACE,iBAAR,EAA2B;AACvBF,mBAAG,CAACE,iBAAJ,CAAsB6F,oBAAtB,CAA2C/F,GAA3C;AACH;;AAEDA,iBAAG,CAACjO,SAAJ,CAActgB,GAAd,IAAqB84B,GAArB;;AACAA,iBAAG,CAAC1E,aAAJ,CAAkB7F,GAAlB,EAX2C,CAa3C;;;AACA,kBAAIrtB,MAAM,GAAG43B,GAAG,CAAClU,aAAJ,EAAb;;AACA,mBAAK,IAAI2sB,MAAT,IAAmBrwC,MAAnB,EAA2B;AACvBqtB,mBAAG,CAAC5J,YAAJ,CAAiB4sB,MAAjB,EAAyBrwC,MAAM,CAACqwC,MAAD,CAA/B;AACH;;AAED,kBAAI,CAACJ,kBAAL,EAAyB;AACrB;AACA,oBAAIjwC,MAAM,CAACoF,SAAX,EAAsB;AAClBwa,0BAAQ,CAACwN,aAAT,CAAuB,KAAKrD,OAA5B,EAAqC+kB,QAAQ,CAACzR,WAA9C,EAA2D,UAA3D,EAAuEzd,QAAvE;AACH;AACJ,eALD,MAMK;AACD,oBAAI+tB,kBAAkB,GAAGtgB,GAAG,CAACE,iBAAJ,CAAsBS,SAA/C;;AACApO,wBAAQ,CAACyT,aAAT,CAAuB;AACnB97B,uBAAK,EAAEuH,GADY;AAEnBg0B,kCAAgB,EAAEh0B,GAAG,KAAK,CAAR,GAAY6uC,kBAAZ,GAAiCtgB,GAAG,CAACvK,QAFpC;AAGnBiQ,6BAAW,EAAEj0B,GAAG,KAAK,CAAR,GAAY84B,GAAG,CAAC5J,SAAhB,GAA4BX,GAAG,CAACvK,QAH1B;AAInBkQ,kCAAgB,EAAEl0B,GAAG,KAAK,CAAR,GAAY6uC,kBAAZ,GAAiCtgB,GAAG,CAACtK,QAJpC;AAKnBkQ,6BAAW,EAAEn0B,GAAG,KAAK,CAAR,GAAY84B,GAAG,CAAC5J,SAAhB,GAA4BX,GAAG,CAACtK,QAL1B;AAMnButB,wCAAsB,EAAExxC,GAAG,KAAK,CAAR,GAAYuuB,GAAG,CAACE,iBAAhB,GAAoCF,GAAG,CAACjO,SAAJ,CAAc,CAAd,CANzC;AAOnBmxB,mCAAiB,EAAEzxC,GAAG,KAAK,CAAR,GAAY84B,GAAZ,GAAkBvK,GAAG,CAACjO,SAAJ,CAAc,CAAd,CAPlB;AAQnBoxB,wCAAsB,EAAE1xC,GAAG,KAAK,CAAR,GAAYuuB,GAAG,CAACE,iBAAhB,GAAoCF,GAAG,CAACjO,SAAJ,CAAc,CAAd,CARzC;AASnBqxB,mCAAiB,EAAE3xC,GAAG,KAAK,CAAR,GAAY84B,GAAZ,GAAkBvK,GAAG,CAACjO,SAAJ,CAAc,CAAd,CATlB;AAUnBwD,4BAAU,EAAEyK;AAVO,iBAAvB,EAWGvsB,aAXH;AAYH;;AAED,kBAAIhC,GAAG,KAAK,CAAZ,EAAe;AACX8gB,wBAAQ,CAAC8N,MAAT,CAAgB6F,qBAAhB,CAAsClG,GAAG,CAAC4gB,UAA1C,EAAsD5gB,GAAG,CAACtK,QAA1D,EAAoEsK,GAApE,EAAyEA,GAAG,CAAC72B,MAA7E,EAAqF,CAArF;AACH,eAFD,MAGK;AACDopB,wBAAQ,CAAC8N,MAAT,CAAgB6F,qBAAhB,CAAsClG,GAAG,CAAC4gB,UAA1C,EAAsD5gB,GAAG,CAACvK,QAA1D,EAAoEuK,GAApE,EAAyEA,GAAG,CAACtP,MAA7E,EAAqF,CAArF;AACH,eA9C0C,CAgD3C;AACA;AACA;AACA;;;AACA,kBAAIsP,GAAG,CAACjO,SAAJ,CAAc,CAAd,EAAiBoN,aAArB,EAAoC;AAChC,oBAAIkkB,SAAS,GAAGrjB,GAAG,CAACjO,SAAJ,CAAc,CAAd,CAAhB;;AACAsxB,yBAAS,CAACtd,oBAAV,CAA+B/F,GAA/B;;AACAA,mBAAG,CAACjO,SAAJ,CAAc,CAAd,IAAmBiO,GAAG,CAACjO,SAAJ,CAAc,CAAd,EAAiBoN,aAApC;AACAa,mBAAG,CAACjO,SAAJ,CAAc,CAAd,EAAiB8T,aAAjB,CAA+B7F,GAA/B;AACH,eAzD0C,CA2D3C;;;AACA,kBAAI7N,GAAG,CAACjJ,QAAJ,CAAa65B,YAAb,CAAJ,EAAgC;AAC5B/iB,mBAAG,CAACsjB,SAAJ,CAAcP,YAAd;AACH,eA9D0C,CA+D3C;AACA;;;AACAxwB,sBAAQ,CAACoN,kBAAT,CAA4BK,GAA5B,EAAiC,IAAjC,EAAuCvsB,aAAvC,EAAsD,KAAtD;;AACAusB,iBAAG,CAAC5mB,QAAJ,CAAa,KAAb,EAlE2C,CAoE3C;;AACAmZ,sBAAQ,CAACL,UAAT,CAAoB8N,GAAG,CAACjO,SAAJ,CAAc,CAAd,EAAiB2K,OAArC;AAEH,aAvEsB,CAuErBve,IAvEqB,CAuEhB,IAvEgB,CAAvB;;AAyEA,gBAAIolC,oBAAoB,GAAG,SAAvBA,oBAAuB,GAAY;AACnC;AACA,kBAAIvjB,GAAG,CAACE,iBAAR,EAA2B;AACvBF,mBAAG,CAACjO,SAAJ,CAActgB,GAAd,IAAqBuuB,GAAG,CAACE,iBAAzB;AACAF,mBAAG,CAAC5mB,QAAJ,CAAa,KAAb;AACA4mB,mBAAG,CAACghB,YAAJ,GAAmB,IAAnB;;AACA,oBAAIvvC,GAAG,KAAK,CAAZ,EAAe;AACXuuB,qBAAG,CAACtP,MAAJ,GAAasP,GAAG,CAACE,iBAAJ,CAAsBxD,OAAnC;AACAsD,qBAAG,CAACvK,QAAJ,GAAeuK,GAAG,CAACE,iBAAJ,CAAsBS,SAArC;AACH,iBAHD,MAGO;AACHX,qBAAG,CAAC72B,MAAJ,GAAa62B,GAAG,CAACE,iBAAJ,CAAsBxD,OAAnC;AACAsD,qBAAG,CAACtK,QAAJ,GAAesK,GAAG,CAACE,iBAAJ,CAAsBS,SAArC;AACH;;AACDX,mBAAG,CAACE,iBAAJ,CAAsB2F,aAAtB,CAAoC7F,GAApC,EAXuB,CAavB;;AACA,oBAAIvuB,GAAG,KAAK,CAAZ,EAAe;AACX8gB,0BAAQ,CAAC8N,MAAT,CAAgB6F,qBAAhB,CAAsClG,GAAG,CAAC4gB,UAA1C,EAAsD5gB,GAAG,CAACtK,QAA1D,EAAoEsK,GAApE,EAAyEA,GAAG,CAAC72B,MAA7E,EAAqF,CAArF;AACH,iBAFD,MAGK;AACDopB,0BAAQ,CAAC8N,MAAT,CAAgB6F,qBAAhB,CAAsClG,GAAG,CAAC4gB,UAA1C,EAAsD5gB,GAAG,CAACvK,QAA1D,EAAoEuK,GAApE,EAAyEA,GAAG,CAACtP,MAA7E,EAAqF,CAArF;AACH;;AAED6B,wBAAQ,CAACwB,OAAT,CAAiBiM,GAAG,CAACvK,QAArB;;AACAuK,mBAAG,CAACghB,YAAJ,GAAmB,KAAnB;AACH;AACJ,aA1BD,CAzGgC,CAqIhD;AACgB;AACA;AACA;AACA;;;AACA6B,uBAAW,GAAGA,WAAW,IAAIpB,QAAQ,CAACjsB,aAAT,CAAuBwK,GAAG,CAACvK,QAA3B,EAAqCuK,GAAG,CAACtK,QAAzC,EAAmDsK,GAAG,CAACpmB,KAAvD,EAA8DomB,GAA9D,EAAmEuK,GAAnE,CAA7B,CA1IgC,CA0IqE;;AAErG,gBAAIsY,WAAJ,EAAiB;AACbC,8BAAgB,CAACD,WAAD,CAAhB;AACA,qBAAO,IAAP;AACH,aAHD,MAIK;AACDU,kCAAoB;AACvB;AACJ;;AAED,cAAI9B,QAAQ,CAAC9S,YAAb,EAA2B;AACvB8S,oBAAQ,CAAC9S,YAAT,CAAsBpE,GAAtB;AACH;;AAEDhY,kBAAQ,CAACkF,iBAAT,GAA6B,KAA7B;AACH,SA3OD;AA4OH,OA7OD;AA8OH,KA7uCA,EA6uCEhxB,IA7uCF,CA6uCO,OAAOC,MAAP,KAAkB,WAAlB,GAAgCA,MAAhC,GAAyC,IA7uChD;AA+uCD;;;;;;;;;;;AAUA;AACA,KAAC,YAAY;AAET;;AACA,UAAIxL,IAAI,GAAG,IAAX;AAAA,UACIo8C,GAAG,GAAGp8C,IAAI,CAACy3B,OADf;AAAA,UAEIR,GAAG,GAAGj3B,IAAI,CAAC0tB,WAFf;;AAIA,UAAI46B,aAAa,GAAG,SAAhBA,aAAgB,CAAUjxB,QAAV,EAAoBkxB,UAApB,EAAgCC,aAAhC,EAA+CC,aAA/C,EAA8DC,YAA9D,EAA4E;AACxF;AACAtM,WAAG,CAAChU,UAAJ,CAAemgB,UAAf,IAA6BnM,GAAG,CAAChU,UAAJ,CAAemgB,UAAf,KAA8B,EAA3D,CAFwF,CAIxF;;AACA,YAAInM,GAAG,CAAChU,UAAJ,CAAemgB,UAAf,EAA2BC,aAA3B,KAA6C,IAAjD,EAAuD;AAEnD,cAAIpM,GAAG,CAAChU,UAAJ,CAAeogB,aAAf,KAAiC,IAArC,EAA2C;AACvC,gBAAI,CAACnxB,QAAQ,CAACiC,QAAT,CAAkB8D,gBAAvB,EAAyC;AACrC,oBAAM,IAAI9P,SAAJ,CAAc,sCAAsCk7B,aAAtC,GAAsD,GAApE,CAAN;AACH,aAFD,MAEO;AACH,qBAAO,IAAP;AACH;AACJ;;AAEDpM,aAAG,CAAChU,UAAJ,CAAemgB,UAAf,EAA2BC,aAA3B,IAA4C,YAAW;AACnDpM,eAAG,CAAChU,UAAJ,CAAeogB,aAAf,EAA8Bp/C,KAA9B,CAAoC,IAApC,EAA0C0F,SAA1C;;AACAstC,eAAG,CAAC/T,kBAAJ,CAAuBkgB,UAAvB,EAAmCn/C,KAAnC,CAAyC,IAAzC,EAA+C0F,SAA/C;AACH,WAHD;;AAKAmoB,aAAG,CAAC1G,MAAJ,CAAW6rB,GAAG,CAAChU,UAAJ,CAAemgB,UAAf,EAA2BC,aAA3B,CAAX,EAAsD,CAAEpM,GAAG,CAAChU,UAAJ,CAAeogB,aAAf,CAAF,EAAiCpM,GAAG,CAAC/T,kBAAJ,CAAuBkgB,UAAvB,CAAjC,CAAtD;AAEH;;AAED,eAAO,IAAInM,GAAG,CAAChU,UAAJ,CAAemgB,UAAf,EAA2BC,aAA3B,CAAJ,CAA8CC,aAA9C,EAA6DC,YAA7D,CAAP;AACH,OAzBL;AAAA,UA0BIC,WAAW,GAAG,SAAdA,WAAc,CAAUjX,YAAV,EAAwBjM,SAAxB,EAAmCpO,QAAnC,EAA6C;AACvD,eAAQqa,YAAD,GAAiBra,QAAQ,CAAC8Z,UAAT,CAAoBO,YAApB,EAAkCjM,SAAlC,EAA6CpO,QAA7C,CAAjB,GAA0E,IAAjF;AACH,OA5BL;AAAA,UA6BIuxB,qBAAqB,GAAG,SAAxBA,qBAAwB,CAAUl0B,IAAV,EAAgB8M,OAAhB,EAAyBnK,QAAzB,EAAmCtf,MAAnC,EAA2C;AAC/D,YAAIypB,OAAO,IAAI,IAAf,EAAqB;AACjBA,iBAAO,CAACqnB,mBAAR,GAA8BrnB,OAAO,CAACqnB,mBAAR,IAA+B,EAA7D;;AACA,cAAI9wC,MAAJ,EAAY;AACR,mBAAOypB,OAAO,CAACqnB,mBAAR,CAA4Bn0B,IAAI,CAAC5H,EAAjC,CAAP;AACH,WAFD,MAGK;AACD0U,mBAAO,CAACqnB,mBAAR,CAA4Bn0B,IAAI,CAAC5H,EAAjC,IAAuC,IAAvC;AACH;;AAED,cAAImK,GAAG,CAAC7I,OAAJ,CAAYoT,OAAO,CAACqnB,mBAApB,CAAJ,EAA8C;AAC1CxxB,oBAAQ,CAACpR,WAAT,CAAqBub,OAArB,EAA8BnK,QAAQ,CAACgQ,cAAvC;AACH,WAFD,MAGK;AACDhQ,oBAAQ,CAAC1Y,QAAT,CAAkB6iB,OAAlB,EAA2BnK,QAAQ,CAACgQ,cAApC;AACH;AACJ;AACJ,OA9CL;;AAgDA+U,SAAG,CAACtM,UAAJ,GAAiB,UAAUr4B,MAAV,EAAkB;AAC/B,YAAI+sB,YAAY,GAAG/sB,MAAM,CAACqsB,WAA1B;AAEA,aAAKhX,EAAL,GAAUrV,MAAM,CAACqV,EAAjB;AACA,aAAK6zB,SAAL,GAAiB,IAAjB;AACA,aAAK3nB,QAAL,GAAgB,aAAhB;AACA,aAAKikB,oBAAL,GAA4B,GAA5B;AACA,aAAKpjB,kBAAL,GAA0B,CAAC,UAAD,EAAa,oBAAb,CAA1B,CAP+B,CAQ/B;AACA;AACA;;AACA,aAAKivB,kBAAL,GAA0BrxC,MAAM,CAACqxC,kBAAjC;AACA,aAAKtzB,MAAL,GAAc4mB,GAAG,CAACjd,UAAJ,CAAe1nB,MAAM,CAAC+d,MAAtB,CAAd;AACA,aAAKvnB,MAAL,GAAcmuC,GAAG,CAACjd,UAAJ,CAAe1nB,MAAM,CAACxJ,MAAtB,CAAd;;AAGAmuC,WAAG,CAACU,gCAAJ,CAAqC1zC,KAArC,CAA2C,IAA3C,EAAiD0F,SAAjD,EAhB+B,CAkB/B;AACA;AACA;;;AACA,YAAI2I,MAAM,CAACgrB,cAAX,EAA2B;AACvB,eAAKjN,MAAL,GAAc/d,MAAM,CAACgrB,cAAP,CAAsBtD,UAAtB,EAAd;AACA,eAAK5E,QAAL,GAAgB9iB,MAAM,CAACgrB,cAAP,CAAsBgD,SAAtC;AACH,SAHD,MAGO;AACH,eAAKlL,QAAL,GAAgB,KAAKlD,QAAL,CAActC,QAAd,CAAuB2B,KAAvB,CAA6B,KAAKlB,MAAlC,CAAhB;AACH;;AAED,YAAI/d,MAAM,CAACirB,cAAX,EAA2B;AACvB,eAAKz0B,MAAL,GAAcwJ,MAAM,CAACirB,cAAP,CAAsBvD,UAAtB,EAAd;AACA,eAAK3E,QAAL,GAAgB/iB,MAAM,CAACirB,cAAP,CAAsB+C,SAAtC;AACH,SAHD,MAGO;AACH,eAAKjL,QAAL,GAAgB,KAAKnD,QAAL,CAActC,QAAd,CAAuB2B,KAAvB,CAA6B,KAAKzoB,MAAlC,CAAhB;AACH;;AAGD,aAAKyQ,KAAL,GAAajH,MAAM,CAACiH,KAApB,CApC+B,CAoCJ;;AAC3B,aAAKmY,SAAL,GAAiB,EAAjB;AACA,aAAKqM,cAAL,GAAsB,EAAtB;AAEA,YAAI7L,QAAQ,GAAG,KAAKA,QAAL,CAActC,QAA7B;;AAEAsC,gBAAQ,CAACoZ,MAAT,CAAgB,KAAKlW,QAArB,EAA+B,KAAK/E,MAApC;;AACA6B,gBAAQ,CAACoZ,MAAT,CAAgB,KAAKjW,QAArB,EAA+B,KAAKvsB,MAApC;;AAEA,aAAKopB,QAAL,CAAcwpB,OAAd,GAAwB,IAAxB;AAEA,aAAKxpB,QAAL,CAAc5f,MAAd,GAAuB;AACnBsjB,kBAAQ,EAAEtjB,MAAM,CAACsjB,QADE;AAEnBhF,mBAAS,EAAEte,MAAM,CAACse,SAFC;AAGnB,4BAAkBte,MAAM,CAAC,gBAAD,CAHL;AAInBsxC,sBAAY,EAAEtxC,MAAM,CAACsxC,YAJF;AAKnBpvB,kBAAQ,EAAEliB,MAAM,CAACkiB;AALE,SAAvB;AAOA,aAAKtC,QAAL,CAAc2xB,aAAd,GAA8B,IAA9B,CAtD+B,CAwD/B;;AACA,aAAK/lC,IAAL,CAAU,WAAV,EAAuB,YAAY;AAC/B,eAAK/E,QAAL,CAAc,IAAd;AACH,SAFsB,CAErB+E,IAFqB,CAEhB,IAFgB,CAAvB;AAGA,aAAKA,IAAL,CAAU,UAAV,EAAsB,YAAY;AAC9B,eAAK/E,QAAL,CAAc,KAAd;AACH,SAFqB,CAEpB+E,IAFoB,CAEf,IAFe,CAAtB,EA5D+B,CAiEvC;;AAEQ,aAAK2nB,YAAL,GAAoB,UAAU2E,QAAV,EAAoBpgC,EAApB,EAAwBsnB,IAAxB,EAA8BhC,EAA9B,EAAkCw0B,UAAlC,EAA8C;AAC9DxyB,cAAI,GAAGA,IAAI,IAAI,KAAKY,QAAL,CAActC,QAAd,CAAuB2B,KAAvB,CAA6BvnB,EAA7B,CAAf;AACA,iBAAO,KAAK4yC,eAAL,CAAqB1qB,QAArB,EAA+BmN,YAA/B,EAA6C,IAA7C,EAAmD/P,EAAnD,EAAuD8a,QAAQ,GAAG,CAAH,GAAO,CAAtE,EAAyE93B,MAAzE,EAAiFtI,EAAjF,EAAqFsnB,IAArF,EAA2FwyB,UAA3F,CAAP;AACH,SAHD,CAnE+B,CAwE/B;AACA;AACA;;;AACA,YAAIxxC,MAAM,CAACpD,IAAX,EAAiB;AACboD,gBAAM,CAACof,SAAP,GAAmBpf,MAAM,CAACof,SAAP,IAAoB,KAAKQ,QAAL,CAActC,QAAd,CAAuBie,2BAAvB,CAAmDv7B,MAAM,CAACpD,IAA1D,EAAgEwiB,SAAvG;AACH;;AAED,YAAIqyB,EAAE,GAAG,KAAKte,YAAL,CAAkB,IAAlB,EAAwB,KAAKpV,MAA7B,EAAqC,KAAK+E,QAA1C,EAAoD9iB,MAAM,CAACgrB,cAA3D,CAAT;AAAA,YACI0mB,EAAE,GAAG,KAAKve,YAAL,CAAkB,KAAlB,EAAyB,KAAK38B,MAA9B,EAAsC,KAAKusB,QAA3C,EAAqD/iB,MAAM,CAACirB,cAA5D,CADT;;AAGA,YAAIwmB,EAAJ,EAAQ;AACJjyB,aAAG,CAAC9G,SAAJ,CAAc1Y,MAAM,CAACgpB,kBAArB,EAAyC,KAAKlG,QAA9C,EAAwD2uB,EAAxD;AACH;;AACD,YAAIC,EAAJ,EAAQ;AACJlyB,aAAG,CAAC9G,SAAJ,CAAc1Y,MAAM,CAACgpB,kBAArB,EAAyC,KAAKjG,QAA9C,EAAwD2uB,EAAxD;AACH,SAvF8B,CAwF/B;;;AACA,YAAI,CAAC,KAAKzqC,KAAV,EAAiB;AACb,eAAKA,KAAL,GAAa,KAAKmY,SAAL,CAAe,CAAf,EAAkBnY,KAA/B;AACH,SA3F8B,CA6F/B;;;AACA,YAAIjH,MAAM,CAAC2xC,sBAAP,IAAiC,IAArC,EAA2C;AACvC,eAAKvyB,SAAL,CAAe,CAAf,EAAkBmN,gBAAlB,CAAmCvsB,MAAM,CAAC2xC,sBAA1C;AACA,eAAKvyB,SAAL,CAAe,CAAf,EAAkBmN,gBAAlB,CAAmCvsB,MAAM,CAAC2xC,sBAA1C;AACH,SAjG8B,CAmGvC;AAEQ;;;AACA,YAAIC,WAAW,GAAGhyB,QAAQ,CAACiC,QAAT,CAAkB0D,qBAApC;;AACA,YAAIvlB,MAAM,CAAC8qC,UAAP,KAAsB,KAA1B,EAAiC;AAC7B8G,qBAAW,GAAG,KAAd;AACH;;AACD,YAAI,KAAKxyB,SAAL,CAAe,CAAf,EAAkByrB,qBAAlB,KAA4C,KAAhD,EAAuD;AACnD+G,qBAAW,GAAG,KAAd;AACH;;AACD,YAAI,KAAKxyB,SAAL,CAAe,CAAf,EAAkByrB,qBAAlB,KAA4C,KAAhD,EAAuD;AACnD+G,qBAAW,GAAG,KAAd;AACH,SA/G8B,CAgH/B;;;AACA,YAAIC,SAAS,GAAG7xC,MAAM,CAAC4lC,QAAP,IAAmB,KAAKxmB,SAAL,CAAe,CAAf,EAAkBwrB,mBAArC,IAA4D,KAAKxrB,SAAL,CAAe,CAAf,EAAkBwrB,mBAA9E,IAAqGhrB,QAAQ,CAACiC,QAAT,CAAkBiF,mBAAvI;;AAEA,aAAKrE,mBAAL,CAAyB;AACrBqoB,oBAAU,EAAE8G,WADS;AAErBhM,kBAAQ,EAAEiM,SAFW;AAGrBhyB,oBAAU,EAAC,KAAKT,SAAL,CAAe,CAAf,EAAkB2pB,cAAlB,IAAoC,KAAK3pB,SAAL,CAAe,CAAf,EAAkB2pB,cAAtD,IAAwE/oC,MAAM,CAAC6f,UAA/E,IAA6FD,QAAQ,CAACiC,QAAT,CAAkB+E,UAA/G,IAA6H+d,GAAG,CAAC9iB,QAAJ,CAAa+E,UAHhI;AAIrB9G,yBAAe,EAAC,KAAKV,SAAL,CAAe,CAAf,EAAkB4pB,mBAAlB,IAAyC,KAAK5pB,SAAL,CAAe,CAAf,EAAkB4pB,mBAA3D,IAAkFhpC,MAAM,CAAC8f,eAAzF,IAA4GF,QAAQ,CAACiC,QAAT,CAAkBwE,eAA9H,IAAiJse,GAAG,CAAC9iB,QAAJ,CAAawE;AAJzJ,SAAzB;;AAOA,YAAImD,YAAY,GAAG5J,QAAQ,CAACsiB,cAAT,EAAnB;;AACA,YAAI,CAACtiB,QAAQ,CAACqF,gBAAT,EAAL,EAAkC;AAC9B;AACA,cAAI6sB,MAAM,GAAGlyB,QAAQ,CAAC0iB,aAAT,CAAuB,KAAKxf,QAA5B,CAAb;AAAA,cACImO,QAAQ,GAAG6gB,MAAM,CAACt+B,CADtB;AAAA,cACyBu+B,IAAI,GAAGD,MAAM,CAACzoD,CADvC;AAAA,cAEI2oD,SAAS,GAAGpyB,QAAQ,CAAC0iB,aAAT,CAAuB,KAAKvf,QAA5B,CAFhB;AAAA,cAGIkvB,WAAW,GAAGD,SAAS,CAACx+B,CAH5B;AAAA,cAII0+B,OAAO,GAAGF,SAAS,CAAC3oD,CAJxB;AAAA,cAKI8oD,gBAAgB,GAAG3oB,YAAY,IAAI5J,QAAQ,CAACQ,SAAT,EALvC;AAAA,cAMI+Q,SAAS,GAAG,KAAK/R,SAAL,CAAe,CAAf,EAAkBX,MAAlB,CAAyB2S,OAAzB,CAAiC;AACzCC,cAAE,EAAE,CAAEJ,QAAQ,CAACplC,IAAX,EAAiBolC,QAAQ,CAACtxB,GAA1B,CADqC;AACJ2xB,cAAE,EAAEygB,IADA;AACMhoB,mBAAO,EAAE,KAAK3K,SAAL,CAAe,CAAf,CADf;AAEzC4O,qBAAS,EAAE,KAAK5O,SAAL,CAAe,CAAf,EAAkB4O,SAFY;AAGzCoe,eAAG,EAAE,CAAE6F,WAAW,CAACpmD,IAAd,EAAoBomD,WAAW,CAACtyC,GAAhC,CAHoC;AAGG0sC,eAAG,EAAE6F,OAHR;AAGiB5F,oBAAQ,EAAE,KAAKltB,SAAL,CAAe,CAAf,CAH3B;AAIzCgB,qBAAS,EAAE+xB;AAJ8B,WAAjC,CANhB;;AAaA,eAAK/yB,SAAL,CAAe,CAAf,EAAkB8R,KAAlB,CAAwB;AAAEC,qBAAS,EAAEA,SAAb;AAAwB/Q,qBAAS,EAAE+xB;AAAnC,WAAxB;AAEAhhB,mBAAS,GAAG,KAAK/R,SAAL,CAAe,CAAf,EAAkBX,MAAlB,CAAyB2S,OAAzB,CAAiC;AACzCC,cAAE,EAAE,CAAE4gB,WAAW,CAACpmD,IAAd,EAAoBomD,WAAW,CAACtyC,GAAhC,CADqC;AACE2xB,cAAE,EAAE4gB,OADN;AACenoB,mBAAO,EAAE,KAAK3K,SAAL,CAAe,CAAf,CADxB;AAEzC4O,qBAAS,EAAE,KAAK5O,SAAL,CAAe,CAAf,EAAkB4O,SAFY;AAGzCoe,eAAG,EAAE,CAAEnb,QAAQ,CAACplC,IAAX,EAAiBolC,QAAQ,CAACtxB,GAA1B,CAHoC;AAGH0sC,eAAG,EAAE0F,IAHF;AAGQzF,oBAAQ,EAAE,KAAKltB,SAAL,CAAe,CAAf,CAHlB;AAIzCgB,qBAAS,EAAE+xB;AAJ8B,WAAjC,CAAZ;AAMA,eAAK/yB,SAAL,CAAe,CAAf,EAAkB8R,KAAlB,CAAwB;AAAEC,qBAAS,EAAEA,SAAb;AAAwB/Q,qBAAS,EAAE+xB;AAAnC,WAAxB;AACH;;AAED,aAAKrxB,iBAAL,GAAyB,YAAY;AACjC,iBAAO,YAAP;AACH,SAFD;;AAGA,aAAKP,mBAAL,GAA2B,YAAY;AACnC,iBAAO,KAAKnB,SAAZ;AACH,SAFD;;AAIA,aAAK+N,YAAL,GAAoB,UAAUnQ,EAAV,EAAc;AAC9B,iBAAO,KAAK4C,QAAL,CAAckrB,UAAd,KAA6B,KAA7B,GAAqC,KAArC,GAA6C9tB,EAAE,IAAI,IAAN,GAAaA,EAAE,CAAC6tB,qBAAH,KAA6B,IAA1C,GAAiD,KAAKjrB,QAAL,CAAckrB,UAAd,KAA6B,IAAlI;AACH,SAFD;;AAGA,aAAK9T,aAAL,GAAqB,UAAU8T,UAAV,EAAsB;AACvC,eAAKlrB,QAAL,CAAckrB,UAAd,GAA2BA,UAAU,KAAK,IAA1C;AACH,SAFD;;AAGA,aAAK3T,UAAL,GAAkB,YAAY;AAC1B,iBAAO,KAAKvX,QAAL,CAAcgmB,QAAd,KAA2B,IAA3B,IAAmC,KAAKxmB,SAAL,CAAe,CAAf,EAAkBwrB,mBAAlB,KAA0C,IAA7E,IAAqF,KAAKxrB,SAAL,CAAe,CAAf,EAAkBwrB,mBAAlB,KAA0C,IAAtI;AACH,SAFD;;AAGA,aAAK3T,WAAL,GAAmB,UAAU2O,QAAV,EAAoB;AACnC,eAAKhmB,QAAL,CAAcgmB,QAAd,GAAyBA,QAAQ,KAAK,IAAtC;AACH,SAFD,CArK+B,CAyKvC;AAGA;AACQ;;;AACA,aAAKhmB,QAAL,CAAcwyB,IAAd,GAAqBpyC,MAAM,CAACoyC,IAAP,IAAe,KAAKhzB,SAAL,CAAe,CAAf,EAAkBmwB,iBAAlB,EAApC;AACA,aAAK3vB,QAAL,CAAcyyB,QAAd,GAAyBryC,MAAM,CAACqyC,QAAhC,CA/K+B,CAgL/B;;AACA,YAAIryC,MAAM,CAACqyC,QAAP,IAAmB,IAAvB,EAA6B;AACzB,eAAKzyB,QAAL,CAAcyyB,QAAd,GAAyB,KAAKjzB,SAAL,CAAe,CAAf,EAAkBqwB,sBAAlB,EAAzB;AACH,SAnL8B,CAoLvC;AAEA;AACQ;AACA;AACA;;;AACA,YAAIz8B,EAAE,GAAG2xB,GAAG,CAAC7rB,MAAJ,CAAW,EAAX,EAAe,KAAKsG,SAAL,CAAe,CAAf,EAAkBsE,aAAlB,EAAf,CAAT;;AACAihB,WAAG,CAAC7rB,MAAJ,CAAW9F,EAAX,EAAe,KAAKoM,SAAL,CAAe,CAAf,EAAkBsE,aAAlB,EAAf;;AACAihB,WAAG,CAAC7rB,MAAJ,CAAW9F,EAAX,EAAe,KAAK0Q,aAAL,EAAf;;AACA,aAAKC,aAAL,CAAmB3Q,EAAnB,EA7L+B,CA8LvC;AAEA;;AAEQ,aAAKkkB,YAAL,CAAkB,KAAK9X,SAAL,CAAe,CAAf,EAAkB8pB,SAAlB,IAA+B,KAAK9pB,SAAL,CAAe,CAAf,EAAkB8pB,SAAjD,IAA8DlpC,MAAM,CAACkpC,SAArE,IAAkFtpB,QAAQ,CAACiC,QAAT,CAAkB4D,SAApG,IAAiHkf,GAAG,CAAC9iB,QAAJ,CAAa4D,SAAhJ,EAA2J,IAA3J;AACA,YAAI8nB,IAAI,GAAGvtC,MAAM,CAACutC,IAAP,IAAe,IAAf,IAAuB,CAAC/tB,GAAG,CAACjJ,QAAJ,CAAavW,MAAM,CAACutC,IAApB,CAAxB,GAAoD,EAApD,GAAyDvtC,MAAM,CAACutC,IAA3E;;AACA,aAAKvH,OAAL,GAAe,YAAW;AAAE,iBAAOuH,IAAP;AAAc,SAA1C;;AACA,aAAK+E,OAAL,GAAe,UAASxnD,CAAT,EAAY;AAAEyiD,cAAI,GAAGziD,CAAC,IAAI,EAAZ;AAAiB,SAA9C;;AACA,aAAK6lD,SAAL,GAAiB,UAAS7lD,CAAT,EAAY;AAAEyiD,cAAI,GAAG5I,GAAG,CAAC7rB,MAAJ,CAAWy0B,IAAX,EAAiBziD,CAAjB,CAAP;AAA6B,SAA5D,CAtM+B,CAwM/B;;;AACA,YAAIynD,MAAM,GAAG,CAAE,SAAF,EAAa,KAAKnzB,SAAL,CAAe,CAAf,EAAkBgM,cAA/B,EAA+C,KAAKhM,SAAL,CAAe,CAAf,EAAkBgM,cAAjE,EAAkFprB,MAAM,CAACpD,IAAzF,EAAgGuhB,IAAhG,CAAqG,GAArG,CAAb;;AACA,YAAI,QAAQpE,IAAR,CAAaw4B,MAAb,CAAJ,EAA0B;AACtB,eAAKluB,OAAL,CAAakuB,MAAb,EAAqBvyC,MAAM,CAACutC,IAA5B,EAAkC,IAAlC;AACH;;AAED,aAAKiF,oBAAL,GA9M+B,CAgNvC;AACK,OAjND;;AAmNAhzB,SAAG,CAAC1G,MAAJ,CAAW6rB,GAAG,CAACtM,UAAf,EAA2BsM,GAAG,CAACU,gCAA/B,EAAiE;AAC7DlkB,iBAAS,EAAE,mBAAU92B,CAAV,EAAau2B,YAAb,EAA2B6xB,OAA3B,EAAoC;AAE3C,cAAIC,UAAU,GAAG,IAAjB;;AACA,cAAIroD,CAAC,CAAC6+C,SAAF,IAAe,IAAnB,EAAyB;AACrBwJ,sBAAU,GAAG,KAAKzwB,iBAAL,CAAuB,WAAvB,EAAoCwwB,OAAO,CAACvJ,SAA5C,CAAb;;AACA,gBAAIwJ,UAAU,IAAI,IAAlB,EAAwB;AACpBA,wBAAU,GAAG,KAAKC,gBAAL,CAAsBtoD,CAAC,CAAC6+C,SAAxB,EAAmCuJ,OAAO,CAACvJ,SAA3C,CAAb;AACA,mBAAKlnB,aAAL,CAAmB,WAAnB,EAAgC0wB,UAAhC,EAA4CD,OAAO,CAACvJ,SAApD;AACH;;AACD,iBAAK0J,oBAAL,CAA0BF,UAA1B;AACH,WAV0C,CAY3C;;;AACA,cAAIroD,CAAC,CAACygD,UAAF,IAAgB,IAApB,EAA0B;AACtB,iBAAK9T,aAAL,CAAmB3sC,CAAC,CAACygD,UAArB;AACH;;AACD,cAAIzgD,CAAC,CAACu7C,QAAF,IAAc,IAAlB,EAAwB;AACpB,iBAAK3O,WAAL,CAAiB5sC,CAAC,CAACu7C,QAAnB;AACH;;AACD,cAAIv7C,CAAC,CAAC4c,KAAN,EAAa;AACT,iBAAKA,KAAL,GAAa5c,CAAC,CAAC4c,KAAf;AACH;;AAED,cAAI5c,CAAC,CAACi5B,QAAF,IAAc,IAAd,IAAsB,KAAKC,MAA/B,EAAuC;AACnC,iBAAK3D,QAAL,CAActC,QAAd,CAAuBpW,QAAvB,CAAgC,KAAKqc,MAArC,EAA6Cl5B,CAAC,CAACi5B,QAA/C;AACH;;AAED,cAAIuvB,QAAQ,GAAG,IAAf,CA3B2C,CA4B3C;;AACA,cAAIxoD,CAAC,CAACo0B,MAAN,EAAc;AACV;AACAo0B,oBAAQ,GAAG,KAAK5wB,iBAAL,CAAuB,SAAvB,EAAkCwwB,OAAO,CAACh0B,MAA1C,CAAX;;AACA,gBAAIo0B,QAAQ,IAAI,IAAhB,EAAsB;AAClBA,sBAAQ,GAAG,CAAE,KAAKjzB,QAAL,CAActC,QAAd,CAAuBoc,UAAvB,CAAkCrvC,CAAC,CAACo0B,MAApC,CAAF,EAA+C,KAAKmB,QAAL,CAActC,QAAd,CAAuBoc,UAAvB,CAAkCrvC,CAAC,CAACo0B,MAApC,CAA/C,CAAX;AACA,mBAAKuD,aAAL,CAAmB,SAAnB,EAA8B6wB,QAA9B,EAAwCJ,OAAO,CAACh0B,MAAhD;AACH;AACJ,WAPD,MAQK,IAAIp0B,CAAC,CAACmhC,OAAN,EAAe;AAChBqnB,oBAAQ,GAAG,KAAK5wB,iBAAL,CAAuB,SAAvB,EAAkCwwB,OAAO,CAACjnB,OAA1C,CAAX;;AACA,gBAAIqnB,QAAQ,IAAI,IAAhB,EAAsB;AAClBA,sBAAQ,GAAG,CACP,KAAKjzB,QAAL,CAActC,QAAd,CAAuBoc,UAAvB,CAAkCrvC,CAAC,CAACmhC,OAAF,CAAU,CAAV,CAAlC,CADO,EAEP,KAAK5L,QAAL,CAActC,QAAd,CAAuBoc,UAAvB,CAAkCrvC,CAAC,CAACmhC,OAAF,CAAU,CAAV,CAAlC,CAFO,CAAX;AAIA,mBAAKxJ,aAAL,CAAmB,SAAnB,EAA8B6wB,QAA9B,EAAwCJ,OAAO,CAACjnB,OAAhD;AACH;AACJ;;AACD,cAAIqnB,QAAQ,IAAI,IAAhB,EAAsB;AAClB,iBAAKzzB,SAAL,CAAe,CAAf,EAAkBX,MAAlB,GAA2Bo0B,QAAQ,CAAC,CAAD,CAAnC;AACA,iBAAKzzB,SAAL,CAAe,CAAf,EAAkBX,MAAlB,GAA2Bo0B,QAAQ,CAAC,CAAD,CAAnC;;AACA,gBAAI,KAAKzzB,SAAL,CAAe,CAAf,EAAkBX,MAAlB,CAAyBqtB,SAA7B,EAAwC;AACpC,mBAAKlsB,QAAL,CAActC,QAAd,CAAuB8D,OAAvB,CAA+B,KAAKhC,SAAL,CAAe,CAAf,EAAkB4O,SAAjD;AACH;AACJ;;AAED2W,aAAG,CAACU,gCAAJ,CAAqClkB,SAArC,CAA+C,IAA/C,EAAqD92B,CAArD;AACH,SAzD4D;AA0D7D6c,gBAAQ,EAAE,kBAAUrc,CAAV,EAAaioD,eAAb,EAA8B;AACpC,cAAIA,eAAJ,EAAqB;AACjB,iBAAK1zB,SAAL,CAAe,CAAf,EAAkBlY,QAAlB,CAA2Brc,CAA3B;AACA,iBAAKu0B,SAAL,CAAe,CAAf,EAAkBlY,QAAlB,CAA2Brc,CAA3B;;AACA,gBAAI,KAAK0iC,iBAAT,EAA4B;AACxB,mBAAKA,iBAAL,CAAuBrmB,QAAvB,CAAgCrc,CAAhC;AACH;AACJ;;AACD,cAAI,KAAKq+C,SAAT,EAAoB;AAChB,iBAAKA,SAAL,CAAehiC,QAAf,CAAwBrc,CAAxB;AACH;AACJ,SArE4D;AAsE7D2jB,mBAAW,EAAE,qBAAU3jB,CAAV,EAAaioD,eAAb,EAA8B;AACvC,cAAIA,eAAJ,EAAqB;AACjB,iBAAK1zB,SAAL,CAAe,CAAf,EAAkB5Q,WAAlB,CAA8B3jB,CAA9B;AACA,iBAAKu0B,SAAL,CAAe,CAAf,EAAkB5Q,WAAlB,CAA8B3jB,CAA9B;;AACA,gBAAI,KAAK0iC,iBAAT,EAA4B;AACxB,mBAAKA,iBAAL,CAAuB/e,WAAvB,CAAmC3jB,CAAnC;AACH;AACJ;;AACD,cAAI,KAAKq+C,SAAT,EAAoB;AAChB,iBAAKA,SAAL,CAAe16B,WAAf,CAA2B3jB,CAA3B;AACH;AACJ,SAjF4D;AAkF7DokC,iBAAS,EAAE,qBAAY;AACnB,iBAAO,KAAKrP,QAAL,CAAcwpB,OAArB;AACH,SApF4D;AAqF7Dta,kBAAU,EAAE,oBAAU5lC,CAAV,EAAa;AACrB,eAAK02B,QAAL,CAAcwpB,OAAd,GAAwBlgD,CAAxB;;AACA,cAAI,KAAKggD,SAAT,EAAoB;AAChB,iBAAKA,SAAL,CAAepa,UAAf,CAA0B5lC,CAA1B;AACH;;AACD,eAAKk4B,OAAL;AACH,SA3F4D;AA4F7DwT,eAAO,EAAE,mBAAY;AACjB,eAAK4d,oBAAL,CAA0B,IAA1B;AACA,eAAKpzB,SAAL,GAAiB,IAAjB;AACA,eAAKrB,MAAL,GAAc,IAAd;AACA,eAAKvnB,MAAL,GAAc,IAAd;;AACA,cAAI,KAAK0yC,SAAL,IAAkB,IAAtB,EAA4B;AACxB,iBAAKA,SAAL,CAAetU,OAAf,CAAuB,IAAvB;AACA,iBAAKsU,SAAL,CAAe33B,OAAf,CAAuB,IAAvB;AACH;;AACD,eAAK23B,SAAL,GAAiB,IAAjB;AACH,SAtG4D;AAuG7DsJ,4BAAoB,EAAC,8BAASlyC,MAAT,EAAiB;AAClC,cAAI,KAAKsf,QAAT,EAAmB;AACfuxB,iCAAqB,CAAC,IAAD,EAAO,KAAKpzB,MAAZ,EAAoB,KAAK6B,QAAL,CAActC,QAAlC,EAA4Chd,MAA5C,CAArB;;AACA6wC,iCAAqB,CAAC,IAAD,EAAO,KAAK36C,MAAZ,EAAoB,KAAKopB,QAAL,CAActC,QAAlC,EAA4Chd,MAA5C,CAArB;AACH;AACJ,SA5G4D;AA6G7DmG,gBAAQ,EAAE,kBAAUuP,KAAV,EAAiB;AACvB,cAAI,KAAKkzB,SAAL,IAAkB,KAAKtpB,QAAvB,IAAmC,CAAC,KAAKA,QAAL,CAActC,QAAd,CAAuBkS,wBAAvB,EAAxC,EAA2F;AACvF,iBAAK0Z,SAAL,CAAeziC,QAAf,CAAwBuP,KAAxB;AACAztB,gBAAI,CAACy3B,OAAL,CAAahK,KAAK,GAAG,UAAH,GAAgB,aAAlC,EAAiD,KAAK+H,MAAtD,EAA8D,KAAK6B,QAAL,CAActC,QAAd,CAAuBkT,gBAArF;AACAjoC,gBAAI,CAACy3B,OAAL,CAAahK,KAAK,GAAG,UAAH,GAAgB,aAAlC,EAAiD,KAAKxf,MAAtD,EAA8D,KAAKopB,QAAL,CAActC,QAAd,CAAuBmT,gBAArF;AACH;AACJ,SAnH4D;AAoH7DsiB,gBAAQ,EAAC,oBAAW;AAChB,iBAAO,CAAE,KAAK3zB,SAAL,CAAe,CAAf,EAAkB2wB,OAAlB,EAAF,EAA+B,KAAK3wB,SAAL,CAAe,CAAf,EAAkB2wB,OAAlB,EAA/B,CAAP;AACH,SAtH4D;AAuH7DiD,eAAO,EAAE,mBAAY;AACjB,iBAAO,KAAKpzB,QAAL,GAAgB,KAAKA,QAAL,CAAcwyB,IAA9B,GAAqC,CAACzhD,QAA7C;AACH,SAzH4D;AA0H7DsiD,eAAO,EAAE,iBAAUpoD,CAAV,EAAa;AAClB,eAAK+0B,QAAL,CAAcwyB,IAAd,GAAqBvnD,CAArB;AACH,SA5H4D;AA6H7DqoD,kBAAU,EAAE,sBAAY;AACpB,iBAAO,KAAKtzB,QAAL,CAAcyyB,QAArB;AACH,SA/H4D;AAgI7Dc,oBAAY,EAAE,wBAAY;AACtB,iBAAO,KAAKjK,SAAZ;AACH,SAlI4D;AAmI7DyJ,wBAAgB,EAAC,0BAASS,aAAT,EAAwB1yB,MAAxB,EAAgC;AAC7C,cAAIswB,aAAa,GAAG;AACZpxB,oBAAQ,EAAE,KAAKA,QAAL,CAActC,QADZ;AAEZgG,oBAAQ,EAAE,KAAK1D,QAAL,CAAc5f,MAAd,CAAqBsjB,QAFnB;AAGZhF,qBAAS,EAAE,KAAKsB,QAAL,CAAc5f,MAAd,CAAqBse,SAHpB;AAIZ,8BAAkB,KAAKsB,QAAL,CAAc5f,MAAd,CAAqB,gBAArB;AAJN,WAApB;AAAA,cAMI8wC,UAAU,GAAG,KAAKlxB,QAAL,CAActC,QAAd,CAAuB2nB,aAAvB,EANjB;AAAA,cAOIiE,SAPJ;;AASA,cAAI1pB,GAAG,CAACpJ,QAAJ,CAAag9B,aAAb,CAAJ,EAAiC;AAC7BlK,qBAAS,GAAG2H,aAAa,CAAC,KAAKjxB,QAAL,CAActC,QAAf,EAAyBwzB,UAAzB,EAAqCsC,aAArC,EAAoDpC,aAApD,EAAmE,IAAnE,CAAzB;AACH,WAFD,CAEE;AAFF,eAGK,IAAIxxB,GAAG,CAACtJ,OAAJ,CAAYk9B,aAAZ,CAAJ,EAAgC;AACjC,kBAAIA,aAAa,CAACppD,MAAd,KAAyB,CAA7B,EAAgC;AAC5Bk/C,yBAAS,GAAG2H,aAAa,CAAC,KAAKjxB,QAAL,CAActC,QAAf,EAAyBwzB,UAAzB,EAAqCsC,aAAa,CAAC,CAAD,CAAlD,EAAuDpC,aAAvD,EAAsE,IAAtE,CAAzB;AACH,eAFD,MAGK;AACD9H,yBAAS,GAAG2H,aAAa,CAAC,KAAKjxB,QAAL,CAActC,QAAf,EAAyBwzB,UAAzB,EAAqCsC,aAAa,CAAC,CAAD,CAAlD,EAAuD5zB,GAAG,CAAC5I,KAAJ,CAAUw8B,aAAa,CAAC,CAAD,CAAvB,EAA4BpC,aAA5B,CAAvD,EAAmG,IAAnG,CAAzB;AACH;AACJ;;AACD,cAAItwB,MAAM,IAAI,IAAd,EAAoB;AAChBwoB,qBAAS,CAACxoB,MAAV,GAAmBA,MAAnB;AACH;;AACD,iBAAOwoB,SAAP;AACH,SA5J4D;AA6J7D0J,4BAAoB,EAAE,8BAAS1J,SAAT,EAAoBtoB,YAApB,EAAkCyyB,4BAAlC,EAAgE3yB,MAAhE,EAAwE;AAE1F,cAAI,KAAKwoB,SAAL,KAAmBA,SAAvB,EAAkC;AAE9B,gBAAIoK,QAAJ;AAAA,gBAAcC,eAAe,GAAG,EAAhC,CAF8B,CAG9B;AACA;;AACA,gBAAI,KAAKrK,SAAL,IAAkB,IAAtB,EAA4B;AACxBoK,sBAAQ,GAAG,KAAKpK,SAAhB;AACAqK,6BAAe,GAAGD,QAAQ,CAAC1vB,QAAT,EAAlB;AACA,mBAAKslB,SAAL,CAAetU,OAAf;AACA,mBAAKsU,SAAL,CAAe33B,OAAf;AACH;;AAED,iBAAK23B,SAAL,GAAiBA,SAAjB;;AACA,gBAAIxoB,MAAJ,EAAY;AACR,mBAAKsB,aAAL,CAAmB,WAAnB,EAAgCknB,SAAhC,EAA2CxoB,MAA3C;AACH;;AAED,iBAAK6C,MAAL,GAAc,KAAK2lB,SAAL,CAAe3lB,MAA7B;AACA,iBAAKujB,QAAL,GAAgB,KAAKoC,SAAL,CAAepC,QAA/B;AAEA,iBAAKoC,SAAL,CAAetD,QAAf,CAAwB,KAAKhmB,QAAL,CAActC,QAAtC,EApB8B,CAsB9B;;AACA,iBAAKpW,QAAL,CAAcqsC,eAAd,EAvB8B,CAyB9B;AACA;AACA;;AACA,gBAAI,KAAKhwB,MAAT,EAAiB;AACb,mBAAKA,MAAL,CAAY3D,QAAZ,GAAuB,IAAvB;AACH;;AACD,gBAAI,KAAKknB,QAAT,EAAmB;AACf,mBAAKA,QAAL,CAAclnB,QAAd,GAAyB,IAAzB;AACH;;AAED,gBAAI0zB,QAAQ,IAAI,IAAhB,EAAsB;AAClB,kBAAI9/B,CAAC,GAAG,KAAK6yB,WAAL,EAAR;;AACA,mBAAK,IAAI/7C,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGkpB,CAAC,CAACxpB,MAAtB,EAA8BM,CAAC,EAA/B,EAAmC;AAC/B,oBAAIkpB,CAAC,CAAClpB,CAAD,CAAD,CAAKkpD,QAAT,EAAmB;AACfhgC,mBAAC,CAAClpB,CAAD,CAAD,CAAKkpD,QAAL,CAAc,KAAKtK,SAAnB;AACH;AACJ;AACJ;;AAED,gBAAI,CAACmK,4BAAL,EAAmC;AAC/B,mBAAKlwB,oBAAL,CAA0B,KAAK+lB,SAA/B;AACH;;AACD,gBAAI,CAACtoB,YAAL,EAAmB;AACf,mBAAKQ,OAAL;AACH;AACJ;AACJ,SAlN4D;AAmN7D8V,oBAAY,EAAE,sBAAUkc,aAAV,EAAyBxyB,YAAzB,EAAuCyyB,4BAAvC,EAAqE3yB,MAArE,EAA6E;AACvF,cAAIwoB,SAAS,GAAG,KAAKyJ,gBAAL,CAAsBS,aAAtB,EAAqC1yB,MAArC,CAAhB;AACA,eAAKkyB,oBAAL,CAA0B1J,SAA1B,EAAqCtoB,YAArC,EAAmDyyB,4BAAnD,EAAiF3yB,MAAjF;AACH,SAtN4D;AAuN7DwQ,aAAK,EAAE,eAAUlxB,MAAV,EAAkB;AAErB,cAAI,CAAC,KAAK4f,QAAL,CAActC,QAAd,CAAuB2H,gBAAvB,EAAD,IAA8C,KAAKrF,QAAL,CAAcwpB,OAAhE,EAAyE;AACrEppC,kBAAM,GAAGA,MAAM,IAAI,EAAnB;AACA,gBAAIogB,SAAS,GAAGpgB,MAAM,CAACogB,SAAvB;AAAA,gBACA;AACIqzB,gBAAI,GAAG,KAFX;AAAA,gBAGIC,GAAG,GAAGD,IAAI,GAAG,KAAK3wB,QAAR,GAAmB,KAAKC,QAHtC;AAAA,gBAGgD4wB,GAAG,GAAGF,IAAI,GAAG,KAAK1wB,QAAR,GAAmB,KAAKD,QAHlF;AAAA,gBAII8wB,IAAI,GAAGH,IAAI,GAAG,CAAH,GAAO,CAJtB;AAAA,gBAIyBI,IAAI,GAAGJ,IAAI,GAAG,CAAH,GAAO,CAJ3C;;AAMA,gBAAIrzB,SAAS,IAAI,IAAb,IAAqBA,SAAS,KAAK,KAAKR,QAAL,CAAc2xB,aAArD,EAAoE;AAChE,kBAAIuC,UAAU,GAAG,KAAKl0B,QAAL,CAActC,QAAd,CAAuBkc,YAAvB,CAAoC;AAACxa,oBAAI,EAAC20B;AAAN,eAApC,EAAgDngC,CAAjE;AAAA,kBACIugC,UAAU,GAAG,KAAKn0B,QAAL,CAActC,QAAd,CAAuBkc,YAAvB,CAAoC;AAACxa,oBAAI,EAAC00B;AAAN,eAApC,EAAgDlgC,CADjE;AAAA,kBAEIwgC,EAAE,GAAG,KAAK50B,SAAL,CAAey0B,IAAf,CAFT;AAAA,kBAE+BI,EAAE,GAAG,KAAK70B,SAAL,CAAew0B,IAAf,CAFpC;;AAIA,kBAAIM,QAAQ,GAAGF,EAAE,CAACv1B,MAAH,CAAUupB,kBAAV,CAA6B;AAAC3W,kBAAE,EAAE,CAACyiB,UAAU,CAACjoD,IAAZ,EAAkBioD,UAAU,CAACn0C,GAA7B,CAAL;AAAwC2xB,kBAAE,EAAE,CAACwiB,UAAU,CAACl3B,KAAZ,EAAmBk3B,UAAU,CAACn3B,MAA9B,CAA5C;AAAmFoN,uBAAO,EAAEiqB,EAA5F;AAAgG5zB,yBAAS,EAAEA;AAA3G,eAA7B,CAAf;AAAA,kBACI+zB,QAAQ,GAAGF,EAAE,CAACx1B,MAAH,CAAUupB,kBAAV,CAA6B;AAAC3W,kBAAE,EAAE,CAAC0iB,UAAU,CAACloD,IAAZ,EAAkBkoD,UAAU,CAACp0C,GAA7B,CAAL;AAAwC2xB,kBAAE,EAAE,CAACyiB,UAAU,CAACn3B,KAAZ,EAAmBm3B,UAAU,CAACp3B,MAA9B,CAA5C;AAAmFoN,uBAAO,EAAEkqB,EAA5F;AAAgG7zB,yBAAS,EAAEA;AAA3G,eAA7B,CADf;AAGA,mBAAK8oB,SAAL,CAAekL,WAAf;AAEA,mBAAKlL,SAAL,CAAe9X,OAAf,CAAuB;AACnBijB,yBAAS,EAAEH,QADQ;AAEnBI,yBAAS,EAAEH,QAFQ;AAGnBI,iCAAiB,EAACP,EAAE,CAACv1B,MAAH,CAAUsb,cAAV,CAAyBia,EAAzB,CAHC;AAInBQ,iCAAiB,EAACP,EAAE,CAACx1B,MAAH,CAAUsb,cAAV,CAAyBka,EAAzB,CAJC;AAKnBjpB,8BAAc,EAAE,KAAK5L,SAAL,CAAey0B,IAAf,CALG;AAMnB5oB,8BAAc,EAAE,KAAK7L,SAAL,CAAew0B,IAAf,CANG;AAOnB,gCAAgB,KAAKh0B,QAAL,CAAc6B,eAAd,CAA8BgzB,WAP3B;AAQnBX,0BAAU,EAAEA,UARO;AASnBC,0BAAU,EAAEA;AATO,eAAvB;AAYA,kBAAIW,OAAO,GAAG;AACVC,oBAAI,EAAEnsD,IAAI,CAACkD,GAAL,CAAS,KAAKw9C,SAAL,CAAe0L,MAAf,CAAsBC,IAA/B,CADI;AAEVC,oBAAI,EAAEtsD,IAAI,CAACkD,GAAL,CAAS,KAAKw9C,SAAL,CAAe0L,MAAf,CAAsBG,IAA/B,CAFI;AAGVC,oBAAI,EAAExsD,IAAI,CAACgD,GAAL,CAAS,KAAK09C,SAAL,CAAe0L,MAAf,CAAsBK,IAA/B,CAHI;AAIVC,oBAAI,EAAE1sD,IAAI,CAACgD,GAAL,CAAS,KAAK09C,SAAL,CAAe0L,MAAf,CAAsBO,IAA/B;AAJI,eAAd,CAtBgE,CA6BhE;;AACA,mBAAKjM,SAAL,CAAekM,YAAf,GAA8BV,OAA9B;AACA,mBAAKxL,SAAL,CAAehY,KAAf,CAAqB,KAAKtR,QAAL,CAAc6B,eAAnC,EAAoD,IAApD,EAA0DizB,OAA1D,EA/BgE,CAiChE;AACA;;AACA,mBAAK,IAAIpqD,CAAT,IAAc,KAAKs1B,QAAL,CAAcsC,QAA5B,EAAsC;AAClC,oBAAI,KAAKtC,QAAL,CAAcsC,QAAd,CAAuBzlB,cAAvB,CAAsCnS,CAAtC,CAAJ,EAA8C;AAC1C,sBAAIkpB,CAAC,GAAG,KAAKoM,QAAL,CAAcsC,QAAd,CAAuB53B,CAAvB,CAAR;;AACA,sBAAIkpB,CAAC,CAACyb,SAAF,EAAJ,EAAmB;AACf,yBAAKrP,QAAL,CAAcgC,iBAAd,CAAgCt3B,CAAhC,IAAqCkpB,CAAC,CAAC8kB,IAAF,CAAO,KAAK4Q,SAAZ,EAAuB,KAAKtpB,QAAL,CAAc6B,eAArC,EAAsD,KAAK8lB,0BAAL,CAAgC/zB,CAAhC,CAAtD,CAArC;AACAA,qBAAC,CAAC0d,KAAF,CAAQ,KAAKtR,QAAL,CAAcgC,iBAAd,CAAgCt3B,CAAhC,CAAR,EAA4CoqD,OAA5C;AACH;AACJ;AACJ;AACJ;;AACD,iBAAK90B,QAAL,CAAc2xB,aAAd,GAA8BnxB,SAA9B;AACH;AACJ,SAhR4D;AAiR7DgB,eAAO,EAAE,iBAAUphB,MAAV,EAAkB;AACvB,cAAIjR,CAAC,GAAGixB,OAAO,CAAClH,MAAR,CAAe9Y,MAAM,IAAI,EAAzB,EAA6B,EAA7B,CAAR;AACAjR,WAAC,CAACiwB,IAAF,GAAS,KAAK8D,QAAd;AACA,eAAKoO,KAAL,CAAWniC,CAAX;AACH,SArR4D;AAsR7Du7C,uBAAe,EAAE,yBAAU1qB,QAAV,EAAoBmN,YAApB,EAAkC9P,IAAlC,EAAwCyoB,QAAxC,EAAkDnuC,KAAlD,EAAyDyI,MAAzD,EAAiE+pB,OAAjE,EAA0EiE,SAA1E,EAAqFwjB,UAArF,EAAiG;AAC9G,cAAIl5C,CAAJ;;AACA,cAAIotC,QAAJ,EAAc;AACVzoB,gBAAI,CAACmC,SAAL,CAAe7nB,KAAf,IAAwBmuC,QAAxB;AACAA,oBAAQ,CAACxS,aAAT,CAAuBjW,IAAvB;AACH,WAHD,MAGO;AACH,gBAAI,CAACjd,MAAM,CAACof,SAAZ,EAAuB;AACnBpf,oBAAM,CAACof,SAAP,GAAmB,CAAE,IAAF,EAAQ,IAAR,CAAnB;AACH;;AACD,gBAAIpC,EAAE,GAAGw0B,UAAU,IAAIxxC,MAAM,CAACof,SAAP,CAAiB7nB,KAAjB,CAAd,IAAyCyI,MAAM,CAAC2e,QAAhD,IAA4DiB,QAAQ,CAACiC,QAAT,CAAkBmE,SAAlB,CAA4BzuB,KAA5B,CAA5D,IAAkGotC,GAAG,CAAC9iB,QAAJ,CAAamE,SAAb,CAAuBzuB,KAAvB,CAAlG,IAAmIqoB,QAAQ,CAACiC,QAAT,CAAkBiE,QAArJ,IAAiK6e,GAAG,CAAC9iB,QAAJ,CAAaiE,QAAvL;;AACA,gBAAI,CAAC9lB,MAAM,CAACyrB,cAAZ,EAA4B;AACxBzrB,oBAAM,CAACyrB,cAAP,GAAwB,CAAE,IAAF,EAAQ,IAAR,CAAxB;AACH;;AACD,gBAAI,CAACzrB,MAAM,CAAC2rB,mBAAZ,EAAiC;AAC7B3rB,oBAAM,CAAC2rB,mBAAP,GAA6B,CAAE,IAAF,EAAQ,IAAR,CAA7B;AACH;;AACD,gBAAI0pB,EAAE,GAAGr1C,MAAM,CAACyrB,cAAP,CAAsBl0B,KAAtB,KAAgCyI,MAAM,CAAC0rB,aAAvC,IAAwD9L,QAAQ,CAACiC,QAAT,CAAkBqE,cAAlB,CAAiC3uB,KAAjC,CAAxD,IAAmGotC,GAAG,CAAC9iB,QAAJ,CAAaqE,cAAb,CAA4B3uB,KAA5B,CAAnG,IAAyIqoB,QAAQ,CAACiC,QAAT,CAAkBoE,aAA3J,IAA4K0e,GAAG,CAAC9iB,QAAJ,CAAaoE,aAAlM,CAXG,CAYH;;AACA,gBAAIovB,EAAE,CAACp1B,IAAH,IAAW,IAAX,IAAmBjgB,MAAM,CAAC6f,UAAP,IAAqB,IAA5C,EAAkD;AAC9Cw1B,gBAAE,CAACp1B,IAAH,GAAUjgB,MAAM,CAAC6f,UAAP,CAAkBgH,MAA5B;AACH;;AAED,gBAAIwuB,EAAE,CAACC,aAAH,IAAoB,IAApB,IAA4Bt1C,MAAM,CAAC6f,UAAP,IAAqB,IAArD,EAA2D;AACvDw1B,gBAAE,CAACC,aAAH,GAAmBt1C,MAAM,CAAC6f,UAAP,CAAkBy1B,aAArC;AACH;;AACD,gBAAID,EAAE,CAACE,YAAH,IAAmB,IAAnB,IAA2Bv1C,MAAM,CAAC6f,UAAP,IAAqB,IAApD,EAA0D;AACtDw1B,gBAAE,CAACE,YAAH,GAAkBv1C,MAAM,CAAC6f,UAAP,CAAkB01B,YAApC;AACH;;AAED,gBAAIC,GAAG,GAAGx1C,MAAM,CAAC2rB,mBAAP,CAA2Bp0B,KAA3B,KAAqCyI,MAAM,CAAC4rB,kBAA5C,IAAkEhM,QAAQ,CAACiC,QAAT,CAAkBuE,mBAAlB,CAAsC7uB,KAAtC,CAAlE,IAAkHotC,GAAG,CAAC9iB,QAAJ,CAAauE,mBAAb,CAAiC7uB,KAAjC,CAAlH,IAA6JqoB,QAAQ,CAACiC,QAAT,CAAkBsE,kBAA/K,IAAqMwe,GAAG,CAAC9iB,QAAJ,CAAasE,kBAA5N,CAxBG,CAyBH;;AACA,gBAAInmB,MAAM,CAAC8f,eAAP,IAA0B,IAA9B,EAAoC;AAChC,kBAAI01B,GAAG,IAAI,IAAX,EAAiB;AACbA,mBAAG,GAAG,EAAN;AACH;;AACD,kBAAIA,GAAG,CAACv1B,IAAJ,IAAY,IAAhB,EAAsB;AAClBu1B,mBAAG,CAACv1B,IAAJ,GAAWjgB,MAAM,CAAC8f,eAAP,CAAuB+G,MAAlC;AACH;AACJ;;AACD,gBAAI/5B,CAAC,GAAGkT,MAAM,CAACwrB,OAAP,GAAiBxrB,MAAM,CAACwrB,OAAP,CAAej0B,KAAf,CAAjB,GACAyI,MAAM,CAACye,MAAP,GAAgBze,MAAM,CAACye,MAAvB,GACIyyB,WAAW,CAACtxB,QAAQ,CAACiC,QAAT,CAAkByD,OAAlB,CAA0B/tB,KAA1B,CAAD,EAAmCy2B,SAAnC,EAA8CpO,QAA9C,CAAX,IACAsxB,WAAW,CAACvM,GAAG,CAAC9iB,QAAJ,CAAayD,OAAb,CAAqB/tB,KAArB,CAAD,EAA8By2B,SAA9B,EAAyCpO,QAAzC,CADX,IAEAsxB,WAAW,CAACtxB,QAAQ,CAACiC,QAAT,CAAkBwD,MAAnB,EAA2B2I,SAA3B,EAAsCpO,QAAtC,CAFX,IAGAsxB,WAAW,CAACvM,GAAG,CAAC9iB,QAAJ,CAAawD,MAAd,EAAsB2I,SAAtB,EAAiCpO,QAAjC,CALvB;AAAA,gBAMI61B,CAAC,GAAGz1C,MAAM,CAACkrB,KAAP,GAAelrB,MAAM,CAACkrB,KAAP,CAAa3zB,KAAb,CAAf,GAAqC,IAN7C;AAQAe,aAAC,GAAGy0B,YAAY,CAAC;AACblN,wBAAU,EAAEw1B,EADC;AACGv1B,6BAAe,EAAE01B,GADpB;AACyB72B,sBAAQ,EAAE3B,EADnC;AACuC+L,yBAAW,EAAE,CAAE9L,IAAF,CADpD;AAEb7V,kBAAI,EAAEquC,CAFO;AAEJh3B,oBAAM,EAAE3xB,CAFJ;AAEOixB,oBAAM,EAAEgM,OAFf;AAEwB9iB,mBAAK,EAAEjH,MAAM,CAACiH,KAFtC;AAGb2+B,sBAAQ,EAAE5lC,MAAM,CAAC4lC,QAAP,IAAmBhmB,QAAQ,CAACiC,QAAT,CAAkBiF,mBAHlC;AAIbgkB,wBAAU,EAAE9qC,MAAM,CAAC8qC,UAAP,IAAqBlrB,QAAQ,CAACiC,QAAT,CAAkB0D;AAJtC,aAAD,CAAhB;;AAMA,gBAAImgB,QAAQ,IAAI,IAAhB,EAAsB;AAClBptC,eAAC,CAACi0B,gBAAF,CAAmB,IAAnB;AACH;;AACDtP,gBAAI,CAACmC,SAAL,CAAe7nB,KAAf,IAAwBe,CAAxB;;AAEA,gBAAI0H,MAAM,CAAC01C,aAAP,KAAyB,KAA7B,EAAoC;AAChCp9C,eAAC,CAACw2B,UAAF,CAAa,KAAb,EAAoB,IAApB,EAA0B,IAA1B;AACH;AAEJ;;AACD,iBAAOx2B,CAAP;AACH,SAtV4D;AAuV7Dq9C,uBAAe,EAAC,yBAAS72C,GAAT,EAAc82C,WAAd,EAA2B;AAEvC,cAAIC,OAAO,GAAG,KAAKz2B,SAAL,CAAetgB,GAAf,CAAd;AAAA,cACIkgB,IAAI,GAAG62B,OAAO,CAAC7nB,SADnB;AAAA,cAEIkS,GAAG,GAAG,KAAKtgB,QAAL,CAActC,QAAd,CAAuB6a,YAAvB,CAAoCnZ,IAApC,CAFV;AAAA,cAGI82B,IAAI,GAAG5V,GAAG,CAACrnC,OAAJ,CAAYg9C,OAAZ,CAHX;AAAA,cAIIE,IAAI,GAAG,KAAK5iB,YAAL,CAAkBr0B,GAAG,KAAK,CAA1B,EAA6B+2C,OAAO,CAAC9rB,OAArC,EAA8C/K,IAA9C,EAAoD,IAApD,EAA0D42B,WAA1D,CAJX;;AAMA,eAAKx2B,SAAL,CAAetgB,GAAf,IAAsBi3C,IAAtB;AAEA7V,aAAG,CAAChnC,MAAJ,CAAW48C,IAAX,EAAiB,CAAjB,EAAoBC,IAApB;;AACA,eAAKn2B,QAAL,CAActC,QAAd,CAAuBuW,YAAvB,CAAoC;AAAClV,oBAAQ,EAACk3B,OAAV;AAAmBjiB,iCAAqB,EAAC;AAAzC,WAApC;;AACA,eAAKhU,QAAL,CAActC,QAAd,CAAuBzB,IAAvB,CAA4B,kBAA5B,EAAgD;AAACy3B,oBAAQ,EAACuC,OAAV;AAAmBA,mBAAO,EAACE;AAA3B,WAAhD;;AAEA,eAAKn2B,QAAL,CAActC,QAAd,CAAuBoQ,MAAvB,CAA8B6F,qBAA9B,CAAoD,KAAKnU,SAAL,CAAe,CAAf,EAAkB4O,SAAtE,EAAiF,KAAK5O,SAAL,CAAe,CAAf,EAAkB4O,SAAnG,EAA8G,IAA9G,EAAoH,KAAK5O,SAAL,CAAe,CAAf,EAAkB2K,OAAtI,EAA+I,CAA/I;AAEH;AAvW4D,OAAjE,EA1QS,CAmnBL;;AACP,KApnBD,EAonBGj2B,IApnBH,CAonBQ,OAAOC,MAAP,KAAkB,WAAlB,GAAgCA,MAAhC,GAAyC,IApnBjD;AAsnBA;;;;;;;;;;;AAUA;AACA,KAAC,YAAY;AAET;;AAEA,UAAIxL,IAAI,GAAG,IAAX;AAAA,UACIi3B,GAAG,GAAGj3B,IAAI,CAAC0tB,WADf;AAAA,UAEI0uB,GAAG,GAAGp8C,IAAI,CAACy3B,OAFf,CAJS,CAQT;AACA;AACA;;AACA2kB,SAAG,CAACqR,aAAJ,GAAoB,UAAUh2C,MAAV,EAAkB;AAClC,YAAIi2C,YAAY,GAAG,EAAnB;AAAA,YACIC,yBAAyB,GAAG,EADhC;AAAA,YAEIC,4BAA4B,GAAG,EAFnC;AAAA,YAGIC,sBAAsB,GAAG,EAH7B;AAAA,YAII90B,IAAI,GAAG,IAJX;AAAA,YAKI+0B,WAAW,GAAG,EALlB;AAAA,YAMIj5B,eAAe,GAAGpd,MAAM,CAACod,eAN7B;AAAA,YAOIijB,mBAAmB,GAAG,EAP1B;AAAA,YAQI;AACAiW,0BAAkB,GAAG,SAArBA,kBAAqB,CAAUC,IAAV,EAAgBC,iBAAhB,EAAmCC,eAAnC,EAAoD1tB,WAApD,EAAiE2tB,UAAjE,EAA6EC,eAA7E,EAA8FC,OAA9F,EAAuG;AACxH,cAAI9pD,CAAC,GAAG,EAAR;AAAA,cAAYglC,IAAI,GAAG0kB,iBAAiB,CAACE,UAAU,GAAG,CAAH,GAAO,CAAlB,CAAjB,IAAyC3tB,WAAW,CAAC/+B,MAAZ,GAAqB,CAA9D,CAAnB;;AAEA,eAAK,IAAIM,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGy+B,WAAW,CAAC/+B,MAAhC,EAAwCM,CAAC,EAAzC,EAA6C;AACzC,gBAAI+b,GAAG,GAAG,CAAC/b,CAAC,GAAG,CAAL,IAAUwnC,IAApB;AAAA,gBAA0B+kB,KAAK,GAAGF,eAAe,GAAGH,iBAAiB,CAACE,UAAU,GAAG,CAAH,GAAO,CAAlB,CAArE;;AACA,gBAAIE,OAAJ,EAAa;AACTvwC,iBAAG,GAAGmwC,iBAAiB,CAACE,UAAU,GAAG,CAAH,GAAO,CAAlB,CAAjB,GAAwCrwC,GAA9C;AACH;;AAED,gBAAI3V,EAAE,GAAIgmD,UAAU,GAAGrwC,GAAH,GAASwwC,KAA7B;AAAA,gBAAqCnuD,CAAC,GAAG+tD,eAAe,CAAC,CAAD,CAAf,GAAqB/lD,EAA9D;AAAA,gBAAkEomD,EAAE,GAAGpmD,EAAE,GAAG8lD,iBAAiB,CAAC,CAAD,CAA7F;AAAA,gBACI/lD,EAAE,GAAIimD,UAAU,GAAGG,KAAH,GAAWxwC,GAD/B;AAAA,gBACqCtd,CAAC,GAAG0tD,eAAe,CAAC,CAAD,CAAf,GAAqBhmD,EAD9D;AAAA,gBACkEsmD,EAAE,GAAGtmD,EAAE,GAAG+lD,iBAAiB,CAAC,CAAD,CAD7F;AAGA1pD,aAAC,CAACkC,IAAF,CAAO,CAAEtG,CAAF,EAAKK,CAAL,EAAQ+tD,EAAR,EAAYC,EAAZ,EAAgBhuB,WAAW,CAACz+B,CAAD,CAAX,CAAe,CAAf,CAAhB,EAAmCy+B,WAAW,CAACz+B,CAAD,CAAX,CAAe,CAAf,CAAnC,CAAP;AACH;;AAED,iBAAOwC,CAAP;AACH,SAzBL;AAAA,YA0BIkqD,kBAAkB,GAAG,SAArBA,kBAAqB,CAASlqD,CAAT,EAAYC,CAAZ,EAAe;AAChC,iBAAOA,CAAC,CAAC,CAAD,CAAD,CAAK,CAAL,IAAUD,CAAC,CAAC,CAAD,CAAD,CAAK,CAAL,CAAjB;AACH,SA5BL;AAAA,YA6BI;AACAmqD,sBAAc,GAAG,SAAjBA,cAAiB,CAAUnqD,CAAV,EAAaC,CAAb,EAAgB;AAC7B,cAAIuC,EAAE,GAAGxC,CAAC,CAAC,CAAD,CAAD,CAAK,CAAL,IAAU,CAAV,GAAc,CAACtE,IAAI,CAACsK,EAAN,GAAWhG,CAAC,CAAC,CAAD,CAAD,CAAK,CAAL,CAAzB,GAAmCtE,IAAI,CAACsK,EAAL,GAAUhG,CAAC,CAAC,CAAD,CAAD,CAAK,CAAL,CAAtD;AAAA,cACIyC,EAAE,GAAGxC,CAAC,CAAC,CAAD,CAAD,CAAK,CAAL,IAAU,CAAV,GAAc,CAACvE,IAAI,CAACsK,EAAN,GAAW/F,CAAC,CAAC,CAAD,CAAD,CAAK,CAAL,CAAzB,GAAmCvE,IAAI,CAACsK,EAAL,GAAU/F,CAAC,CAAC,CAAD,CAAD,CAAK,CAAL,CADtD;AAGA,iBAAOuC,EAAE,GAAGC,EAAZ;AACH,SAnCL;AAAA,YAoCI;AACA2nD,yBAAiB,GAAG;AAChB,iBAAMD,cADU;AAEhB,mBAASD,kBAFO;AAGhB,oBAAUA,kBAHM;AAIhB,kBAAQC;AAJQ,SArCxB;AAAA,YA2CI;AACAE,mBAAW,GAAG,SAAdA,WAAc,CAAUC,MAAV,EAAkBn9C,GAAlB,EAAuB;AACjC,iBAAOm9C,MAAM,CAAC1mC,IAAP,CAAYzW,GAAZ,CAAP;AACH,SA9CL;AAAA,YA+CI;AACAo9C,oBAAY,GAAG,SAAfA,YAAe,CAAUrpB,SAAV,EAAqBspB,YAArB,EAAmC;AAC9C,cAAIC,EAAE,GAAGn6B,eAAe,CAACklB,aAAhB,CAA8BtU,SAA9B,CAAT;AAAA,cAAmDwpB,EAAE,GAAGD,EAAE,CAACluD,CAA3D;AAAA,cAA8DouD,EAAE,GAAGF,EAAE,CAAC/jC,CAAtE;AAAA,cACIkkC,gBAAgB,GAAG,SAAnBA,gBAAmB,CAAUnB,IAAV,EAAgBC,iBAAhB,EAAmCC,eAAnC,EAAoDkB,mBAApD,EAAyEC,YAAzE,EAAuFjB,eAAvF,EAAwGzc,WAAxG,EAAqH;AACpI,gBAAIyd,mBAAmB,CAAC3tD,MAApB,GAA6B,CAAjC,EAAoC;AAChC,kBAAI6tD,EAAE,GAAGV,WAAW,CAACQ,mBAAD,EAAsBT,iBAAiB,CAACX,IAAD,CAAvC,CAApB;AAAA,kBAAoE;AAChEK,qBAAO,GAAGL,IAAI,KAAK,OAAT,IAAoBA,IAAI,KAAK,KAD3C;AAAA,kBAEI/qB,OAAO,GAAG8qB,kBAAkB,CAACC,IAAD,EAAOC,iBAAP,EACxBC,eADwB,EACPoB,EADO,EAExBD,YAFwB,EAEVjB,eAFU,EAEOC,OAFP,CAFhC,CADgC,CAOhC;;;AACA,kBAAIkB,kBAAkB,GAAG,SAArBA,kBAAqB,CAAUn5B,QAAV,EAAoBo5B,SAApB,EAA+B;AACpD7B,yCAAyB,CAACv3B,QAAQ,CAACtJ,EAAV,CAAzB,GAAyC,CAAE0iC,SAAS,CAAC,CAAD,CAAX,EAAgBA,SAAS,CAAC,CAAD,CAAzB,EAA8BA,SAAS,CAAC,CAAD,CAAvC,EAA4CA,SAAS,CAAC,CAAD,CAArD,CAAzC;AACA5B,4CAA4B,CAACx3B,QAAQ,CAACtJ,EAAV,CAA5B,GAA4C6kB,WAA5C;AACH,eAHD;;AAKA,mBAAK,IAAI5vC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGkhC,OAAO,CAACxhC,MAA5B,EAAoCM,CAAC,EAArC,EAAyC;AACrC,oBAAIO,CAAC,GAAG2gC,OAAO,CAAClhC,CAAD,CAAP,CAAW,CAAX,CAAR;AAAA,oBAAuB0tD,WAAW,GAAGntD,CAAC,CAACu0B,SAAF,CAAY,CAAZ,EAAe4O,SAAf,KAA6BA,SAAlE;AAAA,oBAA6EiqB,WAAW,GAAGptD,CAAC,CAACu0B,SAAF,CAAY,CAAZ,EAAe4O,SAAf,KAA6BA,SAAxH;;AACA,oBAAIgqB,WAAJ,EAAiB;AACbF,oCAAkB,CAACjtD,CAAC,CAACu0B,SAAF,CAAY,CAAZ,CAAD,EAAiBoM,OAAO,CAAClhC,CAAD,CAAxB,CAAlB;AACH;;AACD,oBAAI2tD,WAAJ,EAAiB;AACbH,oCAAkB,CAACjtD,CAAC,CAACu0B,SAAF,CAAY,CAAZ,CAAD,EAAiBoM,OAAO,CAAClhC,CAAD,CAAxB,CAAlB;AACH;AACJ;AACJ;AACJ,WAzBL;;AA2BAotD,0BAAgB,CAAC,QAAD,EAAWF,EAAX,EAAe,CAACC,EAAE,CAAC5rD,IAAJ,EAAU4rD,EAAE,CAAC93C,GAAb,CAAf,EAAkC23C,YAAY,CAACp6B,MAA/C,EAAuD,IAAvD,EAA6D,CAA7D,EAAgE,CAAC,CAAD,EAAI,CAAJ,CAAhE,CAAhB;AACAw6B,0BAAgB,CAAC,KAAD,EAAQF,EAAR,EAAY,CAACC,EAAE,CAAC5rD,IAAJ,EAAU4rD,EAAE,CAAC93C,GAAb,CAAZ,EAA+B23C,YAAY,CAAC33C,GAA5C,EAAiD,IAAjD,EAAuD,CAAvD,EAA0D,CAAC,CAAD,EAAI,CAAC,CAAL,CAA1D,CAAhB;AACA+3C,0BAAgB,CAAC,MAAD,EAASF,EAAT,EAAa,CAACC,EAAE,CAAC5rD,IAAJ,EAAU4rD,EAAE,CAAC93C,GAAb,CAAb,EAAgC23C,YAAY,CAACzrD,IAA7C,EAAmD,KAAnD,EAA0D,CAA1D,EAA6D,CAAC,CAAC,CAAF,EAAK,CAAL,CAA7D,CAAhB;AACA6rD,0BAAgB,CAAC,OAAD,EAAUF,EAAV,EAAc,CAACC,EAAE,CAAC5rD,IAAJ,EAAU4rD,EAAE,CAAC93C,GAAb,CAAd,EAAiC23C,YAAY,CAACxrD,KAA9C,EAAqD,KAArD,EAA4D,CAA5D,EAA+D,CAAC,CAAD,EAAI,CAAJ,CAA/D,CAAhB;AACH,SAhFL;;AAkFA,aAAKkpB,KAAL,GAAa,YAAY;AACrBihC,sBAAY,GAAG,EAAf;AACAG,gCAAsB,GAAG,EAAzB;AACAC,qBAAW,GAAG,EAAd;AACH,SAJD;;AAKA,aAAK6B,qBAAL,GAA6B,UAAU94C,GAAV,EAAe6d,IAAf,EAAqB;AAC9CojB,6BAAmB,CAACjhC,GAAD,CAAnB,GAA2B6d,IAA3B;AACH,SAFD;;AAGA,aAAKgP,aAAL,GAAqB,UAAUhP,IAAV,EAAgB;AACjC,cAAI6F,QAAQ,GAAG7F,IAAI,CAAC6F,QAApB;AAAA,cAA8BC,QAAQ,GAAG9F,IAAI,CAAC8F,QAA9C;AAAA,cACI/F,EAAE,GAAGC,IAAI,CAACmC,SADd;AAAA,cAEI+4B,gBAAgB,GAAG,IAFvB;AAAA,cAGIC,kBAAkB,GAAG,SAArBA,kBAAqB,CAAUC,UAAV,EAAsBC,aAAtB,EAAqCC,WAArC,EAAkDv5B,IAAlD,EAAwDn0B,CAAxD,EAA2D;AAC5E,gBAAKi4B,QAAQ,KAAKC,QAAd,IAA2Bw1B,WAAW,CAACC,YAA3C,EAAyD;AACrD;AACAv7B,kBAAI,CAAC2C,QAAL,CAActC,QAAd,CAAuBgjB,aAAvB,CAAqCtjB,EAAE,CAAC,CAAD,CAAF,CAAMuG,MAA3C;;AACA40B,8BAAgB,GAAG,KAAnB;AACH;;AACD34B,eAAG,CAAC9G,SAAJ,CAAc09B,sBAAd,EAAsCp3B,IAAtC,EAA4C,CAACn0B,CAAD,EAAIytD,aAAJ,EAAmBC,WAAW,CAACtgD,WAAZ,KAA4B0sC,GAAG,CAAC3K,aAAnD,CAA5C;AACH,WAVL;;AAYAoe,4BAAkB,CAAC,CAAD,EAAIp7B,EAAE,CAAC,CAAD,CAAN,EAAWA,EAAE,CAAC,CAAD,CAAF,CAAMyB,MAAjB,EAAyBsE,QAAzB,EAAmC9F,IAAnC,CAAlB;;AACA,cAAIk7B,gBAAJ,EAAsB;AAClBC,8BAAkB,CAAC,CAAD,EAAIp7B,EAAE,CAAC,CAAD,CAAN,EAAWA,EAAE,CAAC,CAAD,CAAF,CAAMyB,MAAjB,EAAyBqE,QAAzB,EAAmC7F,IAAnC,CAAlB;AACH;AACJ,SAjBD;;AAkBA,YAAIw7B,6BAA6B,GAAG,SAAhCA,6BAAgC,CAAU95B,QAAV,EAAoB;AACpD,WAAC,UAAUxnB,IAAV,EAAgBuhD,GAAhB,EAAqB;AAClB,gBAAIvhD,IAAJ,EAAU;AAAG;AACT,kBAAIoM,CAAC,GAAG,SAAJA,CAAI,CAAUjL,CAAV,EAAa;AACjB,uBAAOA,CAAC,CAAC,CAAD,CAAD,KAASogD,GAAhB;AACH,eAFD;;AAGAl5B,iBAAG,CAACjH,kBAAJ,CAAuBphB,IAAI,CAACwI,GAA5B,EAAiC4D,CAAjC;;AACAic,iBAAG,CAACjH,kBAAJ,CAAuBphB,IAAI,CAACtL,IAA5B,EAAkC0X,CAAlC;;AACAic,iBAAG,CAACjH,kBAAJ,CAAuBphB,IAAI,CAAC+lB,MAA5B,EAAoC3Z,CAApC;;AACAic,iBAAG,CAACjH,kBAAJ,CAAuBphB,IAAI,CAACrL,KAA5B,EAAmCyX,CAAnC;AACH;AACJ,WAVD,EAUG8yC,WAAW,CAAC13B,QAAQ,CAACqP,SAAV,CAVd,EAUoCrP,QAAQ,CAACtJ,EAV7C;AAWH,SAZD;;AAaA,aAAKgf,kBAAL,GAA0B,UAAUskB,QAAV,EAAoBC,WAApB,EAAiC;AACvD,cAAIh2B,UAAU,GAAG+1B,QAAQ,CAAC/1B,UAAT,IAAuB+1B,QAAxC;AAAA,cACI71B,QAAQ,GAAG61B,QAAQ,CAAC71B,QADxB;AAAA,cAEIC,QAAQ,GAAG41B,QAAQ,CAAC51B,QAFxB;AAAA,cAGI/F,EAAE,GAAG4F,UAAU,CAACxD,SAHpB;AAAA,cAIIy5B,gBAAgB,GAAG,SAAnBA,gBAAmB,CAAUR,UAAV,EAAsBC,aAAtB,EAAqCC,WAArC,EAAkDv5B,IAAlD,EAAwDn0B,CAAxD,EAA2D;AAC1E20B,eAAG,CAACjH,kBAAJ,CAAuB69B,sBAAsB,CAACp3B,IAAD,CAA7C,EAAqD,UAAUve,EAAV,EAAc;AAC/D,qBAAOA,EAAE,CAAC,CAAD,CAAF,CAAM4U,EAAN,KAAaxqB,CAAC,CAACwqB,EAAtB;AACH,aAFD;AAGH,WARL;;AAUAwjC,0BAAgB,CAAC,CAAD,EAAI77B,EAAE,CAAC,CAAD,CAAN,EAAWA,EAAE,CAAC,CAAD,CAAF,CAAMyB,MAAjB,EAAyBqE,QAAzB,EAAmCF,UAAnC,CAAhB;AACAi2B,0BAAgB,CAAC,CAAD,EAAI77B,EAAE,CAAC,CAAD,CAAN,EAAWA,EAAE,CAAC,CAAD,CAAF,CAAMyB,MAAjB,EAAyBsE,QAAzB,EAAmCH,UAAnC,CAAhB;;AACA,cAAIA,UAAU,CAACqrB,UAAf,EAA2B;AACvB4K,4BAAgB,CAACj2B,UAAU,CAACsrB,aAAZ,EAA2BtrB,UAAU,CAACymB,gBAAtC,EAAwDzmB,UAAU,CAACymB,gBAAX,CAA4B5qB,MAApF,EAA4FmE,UAAU,CAACqrB,UAAvG,EAAmHrrB,UAAnH,CAAhB;AACA61B,yCAA6B,CAAC71B,UAAU,CAACymB,gBAAZ,CAA7B;AACH,WAhBsD,CAkBvD;;;AACAoP,uCAA6B,CAAC71B,UAAU,CAACxD,SAAX,CAAqB,CAArB,CAAD,CAA7B;AACAq5B,uCAA6B,CAAC71B,UAAU,CAACxD,SAAX,CAAqB,CAArB,CAAD,CAA7B;;AAEA,cAAI,CAACw5B,WAAL,EAAkB;AACdt3B,gBAAI,CAACgJ,MAAL,CAAY1H,UAAU,CAACE,QAAvB;;AACA,gBAAIF,UAAU,CAACG,QAAX,KAAwBH,UAAU,CAACE,QAAvC,EAAiD;AAC7CxB,kBAAI,CAACgJ,MAAL,CAAY1H,UAAU,CAACG,QAAvB;AACH;AACJ;AACJ,SA5BD;;AA6BA,aAAKsnB,GAAL,GAAW,UAAU1rB,QAAV,EAAoBqP,SAApB,EAA+B;AACtCxO,aAAG,CAAC9G,SAAJ,CAAcu9B,YAAd,EAA4BjoB,SAA5B,EAAuCrP,QAAvC;AACH,SAFD;;AAGA,aAAKgjB,QAAL,GAAgB,UAAUwB,KAAV,EAAiB9B,KAAjB,EAAwB;AACpC+U,gCAAsB,CAAC/U,KAAD,CAAtB,GAAgC+U,sBAAsB,CAACjT,KAAD,CAAtD;AACA8S,sBAAY,CAAC5U,KAAD,CAAZ,GAAsB4U,YAAY,CAAC9S,KAAD,CAAlC;AACA,iBAAOiT,sBAAsB,CAACjT,KAAD,CAA7B;AACA,iBAAO8S,YAAY,CAAC9S,KAAD,CAAnB;AACH,SALD;;AAMA,aAAK2V,iBAAL,GAAyB,UAAU9qB,SAAV,EAAqB;AAC1C,iBAAOooB,sBAAsB,CAACpoB,SAAD,CAAtB,IAAqC,EAA5C;AACH,SAFD;;AAGA,aAAK+qB,eAAL,GAAuB,UAAU/qB,SAAV,EAAqB;AACxC,iBAAOioB,YAAY,CAACjoB,SAAD,CAAZ,IAA2B,EAAlC;AACH,SAFD;;AAGA,aAAKyF,cAAL,GAAsB,UAAU9U,QAAV,EAAoB;AACtCa,aAAG,CAACjH,kBAAJ,CAAuB09B,YAAY,CAACt3B,QAAQ,CAACqP,SAAV,CAAnC,EAAyD,UAAU11B,CAAV,EAAa;AAClE,mBAAOA,CAAC,CAAC+c,EAAF,KAASsJ,QAAQ,CAACtJ,EAAzB;AACH,WAFD;;AAGAojC,uCAA6B,CAAC95B,QAAD,CAA7B;AACH,SALD;;AAMA,aAAK9J,cAAL,GAAsB,UAAUmZ,SAAV,EAAqB;AACvC,iBAAOqS,mBAAmB,CAACrS,SAAD,CAA1B;AACA,iBAAOioB,YAAY,CAACjoB,SAAD,CAAnB;AACAioB,sBAAY,CAACjoB,SAAD,CAAZ,GAA0B,EAA1B;AACH,SAJD,CA5KkC,CAiLlC;AACA;AACA;AACA;AACA;;;AACA,YAAIgrB,iBAAiB,GAAG,SAApBA,iBAAoB,CAAUz7B,KAAV,EAAiBroB,KAAjB,EAAwB5G,KAAxB,EAA+B2uB,IAA/B,EAAqCg8B,QAArC,EAA+CC,SAA/C,EAA0Dp6C,GAA1D,EAA+D83C,OAA/D,EAAwEuC,MAAxE,EAAgFn6B,IAAhF,EAAsFo6B,YAAtF,EAAoGC,gBAApG,EAAsH;AAC1I;AACA,cAAIC,QAAQ,GAAG,CAAC,CAAhB;AAAA,cACIC,kBAAkB,GAAG,CAAC,CAD1B;AAAA,cAEI56B,QAAQ,GAAG1B,IAAI,CAACmC,SAAL,CAAetgB,GAAf,CAFf;AAAA,cAGI06C,UAAU,GAAG76B,QAAQ,CAACtJ,EAH1B;AAAA,cAII02B,IAAI,GAAG,CAAC,CAAD,EAAI,CAAJ,EAAOjtC,GAAP,CAJX;AAAA,cAKIkZ,MAAM,GAAG,CACL,CAAE9iB,KAAF,EAAS5G,KAAT,CADK,EAEL2uB,IAFK,EAGLg8B,QAHK,EAILC,SAJK,EAKLM,UALK,CALb;AAAA,cAYIC,WAAW,GAAGl8B,KAAK,CAAC47B,MAAD,CAZvB;AAAA,cAaIO,gBAAgB,GAAG/6B,QAAQ,CAACg7B,qBAAT,GAAiCp8B,KAAK,CAACoB,QAAQ,CAACg7B,qBAAV,CAAtC,GAAyE,IAbhG;AAAA,cAcIrvD,CAdJ;AAAA,cAeIsuC,SAfJ;;AAiBA,cAAI8gB,gBAAJ,EAAsB;AAClB,gBAAIE,IAAI,GAAGp6B,GAAG,CAAClH,gBAAJ,CAAqBohC,gBAArB,EAAuC,UAAUphD,CAAV,EAAa;AAC3D,qBAAOA,CAAC,CAAC,CAAD,CAAD,KAASkhD,UAAhB;AACH,aAFU,CAAX;;AAGA,gBAAII,IAAI,KAAK,CAAC,CAAd,EAAiB;AACbF,8BAAgB,CAACxgD,MAAjB,CAAwB0gD,IAAxB,EAA8B,CAA9B,EADa,CAEb;;AACA,mBAAKtvD,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGovD,gBAAgB,CAAC1vD,MAAjC,EAAyCM,CAAC,EAA1C,EAA8C;AAC1CsuC,yBAAS,GAAG8gB,gBAAgB,CAACpvD,CAAD,CAAhB,CAAoB,CAApB,CAAZ;;AACAk1B,mBAAG,CAAChH,eAAJ,CAAoB4gC,YAApB,EAAkCxgB,SAAlC,EAA6C,UAAU/tC,CAAV,EAAa;AACtD,yBAAOA,CAAC,CAACwqB,EAAF,KAASujB,SAAS,CAACvjB,EAA1B;AACH,iBAFD;;AAGAmK,mBAAG,CAAChH,eAAJ,CAAoB6gC,gBAApB,EAAsCK,gBAAgB,CAACpvD,CAAD,CAAhB,CAAoB,CAApB,EAAuB80B,SAAvB,CAAiCtgB,GAAjC,CAAtC,EAA6E,UAAUxG,CAAV,EAAa;AACtF,yBAAOA,CAAC,CAAC+c,EAAF,KAASujB,SAAS,CAACxZ,SAAV,CAAoBtgB,GAApB,EAAyBuW,EAAzC;AACH,iBAFD;;AAGAmK,mBAAG,CAAChH,eAAJ,CAAoB6gC,gBAApB,EAAsCK,gBAAgB,CAACpvD,CAAD,CAAhB,CAAoB,CAApB,EAAuB80B,SAAvB,CAAiC2sB,IAAjC,CAAtC,EAA8E,UAAUzzC,CAAV,EAAa;AACvF,yBAAOA,CAAC,CAAC+c,EAAF,KAASujB,SAAS,CAACxZ,SAAV,CAAoB2sB,IAApB,EAA0B12B,EAA1C;AACH,iBAFD;AAGH;AACJ;AACJ;;AAED,eAAK/qB,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGmvD,WAAW,CAACzvD,MAA5B,EAAoCM,CAAC,EAArC,EAAyC;AACrCsuC,qBAAS,GAAG6gB,WAAW,CAACnvD,CAAD,CAAX,CAAe,CAAf,CAAZ;;AACA,gBAAI0V,MAAM,CAAClB,GAAP,KAAe,CAAf,IAAoB26C,WAAW,CAACnvD,CAAD,CAAX,CAAe,CAAf,MAAsB4uD,SAA1C,IAAuDK,kBAAkB,KAAK,CAAC,CAAnF,EAAsF;AAClFA,gCAAkB,GAAGjvD,CAArB;AACH;;AACDk1B,eAAG,CAAChH,eAAJ,CAAoB4gC,YAApB,EAAkCxgB,SAAlC,EAA6C,UAAU/tC,CAAV,EAAa;AACtD,qBAAOA,CAAC,CAACwqB,EAAF,KAASujB,SAAS,CAACvjB,EAA1B;AACH,aAFD;;AAGAmK,eAAG,CAAChH,eAAJ,CAAoB6gC,gBAApB,EAAsCI,WAAW,CAACnvD,CAAD,CAAX,CAAe,CAAf,EAAkB80B,SAAlB,CAA4BtgB,GAA5B,CAAtC,EAAwE,UAAUxG,CAAV,EAAa;AACjF,qBAAOA,CAAC,CAAC+c,EAAF,KAASujB,SAAS,CAACxZ,SAAV,CAAoBtgB,GAApB,EAAyBuW,EAAzC;AACH,aAFD;;AAGAmK,eAAG,CAAChH,eAAJ,CAAoB6gC,gBAApB,EAAsCI,WAAW,CAACnvD,CAAD,CAAX,CAAe,CAAf,EAAkB80B,SAAlB,CAA4B2sB,IAA5B,CAAtC,EAAyE,UAAUzzC,CAAV,EAAa;AAClF,qBAAOA,CAAC,CAAC+c,EAAF,KAASujB,SAAS,CAACxZ,SAAV,CAAoB2sB,IAApB,EAA0B12B,EAA1C;AACH,aAFD;AAGH;;AACD,cAAIikC,QAAQ,KAAK,CAAC,CAAlB,EAAqB;AACjBG,uBAAW,CAACH,QAAD,CAAX,GAAwBthC,MAAxB;AACH,WAFD,MAGK;AACD,gBAAI6hC,SAAS,GAAGjD,OAAO,GAAG2C,kBAAkB,KAAK,CAAC,CAAxB,GAA4BA,kBAA5B,GAAiD,CAApD,GAAwDE,WAAW,CAACzvD,MAA3F,CADC,CACkG;;AACnGyvD,uBAAW,CAACvgD,MAAZ,CAAmB2gD,SAAnB,EAA8B,CAA9B,EAAiC7hC,MAAjC;AACH,WA9DyI,CAgE1I;;;AACA2G,kBAAQ,CAACg7B,qBAAT,GAAiCR,MAAjC;AACH,SAlED,CAtLkC,CA0PlC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA,aAAK5lB,qBAAL,GAA6B,UAAUumB,UAAV,EAAsBzY,KAAtB,EAA6Bze,UAA7B,EAAyCm3B,UAAzC,EAAqDC,WAArD,EAAkE;AAC3F,cAAIA,WAAW,KAAK,CAApB,EAAuB;AACnB,gBAAIF,UAAU,KAAKzY,KAAnB,EAA0B;AAEtBze,wBAAU,CAACE,QAAX,GAAsBue,KAAtB;AACAze,wBAAU,CAAC7E,MAAX,GAAoBg8B,UAApB,CAHsB,CAKtB;;AACAv6B,iBAAG,CAACjH,kBAAJ,CAAuB69B,sBAAsB,CAAC0D,UAAD,CAA7C,EAA2D,UAAU/qB,IAAV,EAAgB;AACvE,uBAAOA,IAAI,CAAC,CAAD,CAAJ,CAAQ1Z,EAAR,KAAeuN,UAAU,CAACvN,EAAjC;AACH,eAFD,EANsB,CAStB;;;AACA,kBAAIu+B,IAAI,GAAGp0B,GAAG,CAAClH,gBAAJ,CAAqB89B,sBAAsB,CAACxzB,UAAU,CAACG,QAAZ,CAA3C,EAAkE,UAAUz4B,CAAV,EAAa;AACtF,uBAAOA,CAAC,CAAC,CAAD,CAAD,CAAK+qB,EAAL,KAAYuN,UAAU,CAACvN,EAA9B;AACH,eAFU,CAAX;;AAGA,kBAAIu+B,IAAI,GAAG,CAAC,CAAZ,EAAe;AACXwC,sCAAsB,CAACxzB,UAAU,CAACG,QAAZ,CAAtB,CAA4C6wB,IAA5C,EAAkD,CAAlD,IAAuDhxB,UAAvD;AACAwzB,sCAAsB,CAACxzB,UAAU,CAACG,QAAZ,CAAtB,CAA4C6wB,IAA5C,EAAkD,CAAlD,IAAuDhxB,UAAU,CAACxD,SAAX,CAAqB,CAArB,CAAvD;AACAg3B,sCAAsB,CAACxzB,UAAU,CAACG,QAAZ,CAAtB,CAA4C6wB,IAA5C,EAAkD,CAAlD,IAAuDhxB,UAAU,CAACxD,SAAX,CAAqB,CAArB,EAAwBX,MAAxB,CAA+BxmB,WAA/B,KAA+C0sC,GAAG,CAAC3K,aAA1G;AACH,eAjBqB,CAkBtB;;;AACAxa,iBAAG,CAAC9G,SAAJ,CAAc09B,sBAAd,EAAsC/U,KAAtC,EAA6C,CAACze,UAAD,EAAaA,UAAU,CAACxD,SAAX,CAAqB,CAArB,CAAb,EAAsCwD,UAAU,CAACxD,SAAX,CAAqB,CAArB,EAAwBX,MAAxB,CAA+BxmB,WAA/B,KAA+C0sC,GAAG,CAAC3K,aAAzF,CAA7C,EAnBsB,CAqBtB;AACA;AACA;;;AACA,kBAAIpX,UAAU,CAACxD,SAAX,CAAqB,CAArB,EAAwBX,MAAxB,CAA+B+5B,YAAnC,EAAiD;AAC7C,oBAAI51B,UAAU,CAAC7E,MAAX,KAAsB6E,UAAU,CAACpsB,MAArC,EAA6C;AACzCosB,4BAAU,CAAChD,QAAX,CAAoBtC,QAApB,CAA6BgjB,aAA7B,CAA2C1d,UAAU,CAACxD,SAAX,CAAqB,CAArB,EAAwBmE,MAAnE;AACH,iBAFD,MAEO;AACH,sBAAIX,UAAU,CAACxD,SAAX,CAAqB,CAArB,EAAwBmE,MAAxB,CAA+B1rB,UAA/B,IAA6C,IAAjD,EAAuD;AACnD+qB,8BAAU,CAAChD,QAAX,CAAoBtC,QAApB,CAA6Bib,aAA7B,CAA2C3V,UAAU,CAACxD,SAAX,CAAqB,CAArB,EAAwBmE,MAAnE;AACH;AACJ;AACJ;;AAEDX,wBAAU,CAAC4vB,oBAAX;AACH;AACJ,WArCD,MAqCO,IAAIwH,WAAW,KAAK,CAApB,EAAuB;AAC1B,gBAAIC,UAAU,GAAGr3B,UAAU,CAACxD,SAAX,CAAqB,CAArB,EAAwB4O,SAAzC;AAEApL,sBAAU,CAACpsB,MAAX,GAAoBujD,UAApB;AACAn3B,sBAAU,CAACG,QAAX,GAAsBse,KAAtB;;AAEA,gBAAI6Y,MAAM,GAAG16B,GAAG,CAAClH,gBAAJ,CAAqB89B,sBAAsB,CAAC6D,UAAD,CAA3C,EAAyD,UAAU3vD,CAAV,EAAa;AAC3E,qBAAOA,CAAC,CAAC,CAAD,CAAD,CAAK+qB,EAAL,KAAYuN,UAAU,CAACvN,EAA9B;AACH,aAFQ,CAAb;AAAA,gBAGI8kC,MAAM,GAAG36B,GAAG,CAAClH,gBAAJ,CAAqB89B,sBAAsB,CAAC0D,UAAD,CAA3C,EAAyD,UAAUxvD,CAAV,EAAa;AAC3E,qBAAOA,CAAC,CAAC,CAAD,CAAD,CAAK+qB,EAAL,KAAYuN,UAAU,CAACvN,EAA9B;AACH,aAFQ,CAHb,CAN0B,CAa1B;;;AACA,gBAAI6kC,MAAM,KAAK,CAAC,CAAhB,EAAmB;AACf9D,oCAAsB,CAAC6D,UAAD,CAAtB,CAAmCC,MAAnC,EAA2C,CAA3C,IAAgDt3B,UAAhD;AACAwzB,oCAAsB,CAAC6D,UAAD,CAAtB,CAAmCC,MAAnC,EAA2C,CAA3C,IAAgDt3B,UAAU,CAACxD,SAAX,CAAqB,CAArB,CAAhD;AACAg3B,oCAAsB,CAAC6D,UAAD,CAAtB,CAAmCC,MAAnC,EAA2C,CAA3C,IAAgDt3B,UAAU,CAACxD,SAAX,CAAqB,CAArB,EAAwBX,MAAxB,CAA+BxmB,WAA/B,KAA+C0sC,GAAG,CAAC3K,aAAnG;AACH,aAlByB,CAoB1B;;;AACA,gBAAImgB,MAAM,GAAG,CAAC,CAAd,EAAiB;AACb/D,oCAAsB,CAAC0D,UAAD,CAAtB,CAAmC5gD,MAAnC,CAA0CihD,MAA1C,EAAkD,CAAlD,EADa,CAEb;;AACA36B,iBAAG,CAAC9G,SAAJ,CAAc09B,sBAAd,EAAsC/U,KAAtC,EAA6C,CAACze,UAAD,EAAaA,UAAU,CAACxD,SAAX,CAAqB,CAArB,CAAb,EAAsCwD,UAAU,CAACxD,SAAX,CAAqB,CAArB,EAAwBX,MAAxB,CAA+BxmB,WAA/B,KAA+C0sC,GAAG,CAAC3K,aAAzF,CAA7C;AACH;;AAEDpX,sBAAU,CAAC4vB,oBAAX;AACH;AACJ,SAnED,CArQkC,CA0UlC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA,aAAKpH,cAAL,GAAsB,UAAUpuB,EAAV,EAAco9B,SAAd,EAAyBrwB,OAAzB,EAAkC;AACpD,cAAIuR,GAAG,GAAG2a,YAAY,CAACmE,SAAD,CAAZ,IAA2B,EAArC;AAAA,cACIpsB,SAAS,GAAG5Q,eAAe,CAAC6B,KAAhB,CAAsB8K,OAAtB,CADhB;;AAGA,cAAIiE,SAAS,KAAKosB,SAAlB,EAA6B;AACzB,gBAAIt7C,GAAG,GAAGw8B,GAAG,CAACziC,OAAJ,CAAYmkB,EAAZ,CAAV;;AACA,gBAAIle,GAAG,GAAG,CAAC,CAAX,EAAc;AACV,kBAAI84B,GAAG,GAAG0D,GAAG,CAACpiC,MAAJ,CAAW4F,GAAX,EAAgB,CAAhB,EAAmB,CAAnB,CAAV;AACAwiB,kBAAI,CAAC+oB,GAAL,CAASzS,GAAT,EAAc5J,SAAd;AACH;AACJ;;AAED,eAAK,IAAI1jC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG0yB,EAAE,CAAC+L,WAAH,CAAe/+B,MAAnC,EAA2CM,CAAC,EAA5C,EAAgD;AAC5C,gBAAI0yB,EAAE,CAAC+L,WAAH,CAAez+B,CAAf,EAAkBw4B,QAAlB,KAA+Bs3B,SAAnC,EAA8C;AAC1C94B,kBAAI,CAACiS,qBAAL,CAA2B6mB,SAA3B,EAAsCp9B,EAAE,CAACgR,SAAzC,EAAoDhR,EAAE,CAAC+L,WAAH,CAAez+B,CAAf,CAApD,EAAuE0yB,EAAE,CAAC+M,OAA1E,EAAmF,CAAnF;AACH,aAFD,MAGK,IAAI/M,EAAE,CAAC+L,WAAH,CAAez+B,CAAf,EAAkBy4B,QAAlB,KAA+Bq3B,SAAnC,EAA8C;AAC/C94B,kBAAI,CAACiS,qBAAL,CAA2B6mB,SAA3B,EAAsCp9B,EAAE,CAACgR,SAAzC,EAAoDhR,EAAE,CAAC+L,WAAH,CAAez+B,CAAf,CAApD,EAAuE0yB,EAAE,CAAC+M,OAA1E,EAAmF,CAAnF;AACH;AACJ;AACJ,SApBD;;AAsBA,aAAKO,MAAL,GAAc,UAAU0D,SAAV,EAAqBhE,EAArB,EAAyB5J,SAAzB,EAAoCi6B,UAApC,EAAgDpwB,UAAhD,EAA4DqwB,mBAA5D,EAAiF;AAE3F,cAAI,CAACl9B,eAAe,CAAC6H,gBAAhB,EAAL,EAAyC;AACrC;AACA,gBAAIjI,EAAE,GAAGi5B,YAAY,CAACjoB,SAAD,CAAZ,IAA2B,EAApC;AAAA,gBACIusB,mBAAmB,GAAGnE,sBAAsB,CAACpoB,SAAD,CAAtB,IAAqC,EAD/D;AAAA,gBAEIwsB,kBAAkB,GAAG,EAFzB;AAAA,gBAGInB,gBAAgB,GAAG,EAHvB;AAAA,gBAIIoB,eAAe,GAAG,EAJtB;AAMAr6B,qBAAS,GAAGA,SAAS,IAAIhD,eAAe,CAACgD,SAAhB,EAAzB,CARqC,CASrC;AACA;AACA;;AACAi6B,sBAAU,GAAGA,UAAU,IAAI;AAACxuD,kBAAI,EAAE,CAAP;AAAU8T,iBAAG,EAAE;AAAf,aAA3B;;AACA,gBAAIqqB,EAAJ,EAAQ;AACJA,gBAAE,GAAG;AACDn+B,oBAAI,EAAEm+B,EAAE,CAACn+B,IAAH,GAAUwuD,UAAU,CAACxuD,IAD1B;AAED8T,mBAAG,EAAEqqB,EAAE,CAACrqB,GAAH,GAAS06C,UAAU,CAAC16C;AAFxB,eAAL;AAIH,aAlBoC,CAoBrC;;;AACA,gBAAIsxB,QAAQ,GAAG7T,eAAe,CAACoc,YAAhB,CAA6B;AAAExa,kBAAI,EAAEgP,SAAR;AAAmB5D,oBAAM,EAAEJ,EAA3B;AAA+B9E,oBAAM,EAAE,KAAvC;AAA8C9E,uBAAS,EAAEA;AAAzD,aAA7B,CAAf;AAAA,gBACIs6B,gBAAgB,GAAG,EADvB,CArBqC,CAwBrC;AACA;AACA;;AAEA,iBAAK,IAAIpwD,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGiwD,mBAAmB,CAACvwD,MAAxC,EAAgDM,CAAC,EAAjD,EAAqD;AACjD,kBAAI2yB,IAAI,GAAGs9B,mBAAmB,CAACjwD,CAAD,CAAnB,CAAuB,CAAvB,CAAX;AAAA,kBACIw4B,QAAQ,GAAG7F,IAAI,CAAC6F,QADpB;AAAA,kBAEIC,QAAQ,GAAG9F,IAAI,CAAC8F,QAFpB;AAAA,kBAGI43B,gBAAgB,GAAG19B,IAAI,CAACmC,SAAL,CAAe,CAAf,EAAkBX,MAAlB,CAAyB+5B,YAHhD;AAAA,kBAIIoC,gBAAgB,GAAG39B,IAAI,CAACmC,SAAL,CAAe,CAAf,EAAkBX,MAAlB,CAAyB+5B,YAJhD;;AAMA,kBAAImC,gBAAgB,IAAIC,gBAAxB,EAA0C;AACtC,oBAAIC,IAAI,GAAG/3B,QAAQ,GAAG,GAAX,GAAiBC,QAA5B;AAAA,oBACIvP,CAAC,GAAGknC,gBAAgB,CAACG,IAAD,CADxB;AAAA,oBAEI9O,IAAI,GAAG9uB,IAAI,CAAC6F,QAAL,KAAkBkL,SAAlB,GAA8B,CAA9B,GAAkC,CAF7C;;AAIA,oBAAI2sB,gBAAgB,IAAI,CAACtE,WAAW,CAACvzB,QAAD,CAApC,EAAgD;AAC5CuzB,6BAAW,CAACvzB,QAAD,CAAX,GAAwB;AAAEnjB,uBAAG,EAAE,EAAP;AAAW7T,yBAAK,EAAE,EAAlB;AAAsBoxB,0BAAM,EAAE,EAA9B;AAAkCrxB,wBAAI,EAAE;AAAxC,mBAAxB;AACH;;AACD,oBAAI+uD,gBAAgB,IAAI,CAACvE,WAAW,CAACtzB,QAAD,CAApC,EAAgD;AAC5CszB,6BAAW,CAACtzB,QAAD,CAAX,GAAwB;AAAEpjB,uBAAG,EAAE,EAAP;AAAW7T,yBAAK,EAAE,EAAlB;AAAsBoxB,0BAAM,EAAE,EAA9B;AAAkCrxB,wBAAI,EAAE;AAAxC,mBAAxB;AACH;;AAED,oBAAImiC,SAAS,KAAKjL,QAAlB,EAA4B;AACxB3F,iCAAe,CAACoc,YAAhB,CAA6B;AAAExa,wBAAI,EAAE+D,QAAR;AAAkB3C,6BAAS,EAAEA;AAA7B,mBAA7B;AACH;;AACD,oBAAI4N,SAAS,KAAKlL,QAAlB,EAA4B;AACxB1F,iCAAe,CAACoc,YAAhB,CAA6B;AAAExa,wBAAI,EAAE8D,QAAR;AAAkB1C,6BAAS,EAAEA;AAA7B,mBAA7B;AACH;;AAED,oBAAIx1B,EAAE,GAAGwyB,eAAe,CAACklB,aAAhB,CAA8Bvf,QAA9B,CAAT;AAAA,oBACI+3B,EAAE,GAAG19B,eAAe,CAACklB,aAAhB,CAA8Bxf,QAA9B,CADT;;AAGA,oBAAIC,QAAQ,KAAKD,QAAb,KAA0B63B,gBAAgB,IAAIC,gBAA9C,CAAJ,EAAqE;AACjE;AACA;AACA;AACA;AACA5B,mCAAiB,CAAE3C,WAAW,CAACvzB,QAAD,CAAb,EAAyB,CAACt6B,IAAI,CAACsK,EAAN,GAAW,CAApC,EAAuC,CAAvC,EAA0CmqB,IAA1C,EAAgD,KAAhD,EAAuD8F,QAAvD,EAAiE,CAAjE,EAAoE,KAApE,EAA2E,KAA3E,EAAkFD,QAAlF,EAA4F03B,kBAA5F,EAAgHnB,gBAAhH,CAAjB;;AACAL,mCAAiB,CAAE3C,WAAW,CAACtzB,QAAD,CAAb,EAAyB,CAACv6B,IAAI,CAACsK,EAAN,GAAW,CAApC,EAAuC,CAAvC,EAA0CmqB,IAA1C,EAAgD,KAAhD,EAAuD6F,QAAvD,EAAiE,CAAjE,EAAoE,KAApE,EAA2E,KAA3E,EAAkFC,QAAlF,EAA4Fy3B,kBAA5F,EAAgHnB,gBAAhH,CAAjB;AACH,iBAPD,MAQK;AACD,sBAAI,CAAC7lC,CAAL,EAAQ;AACJA,qBAAC,GAAG,KAAKunC,oBAAL,CAA0Bj4B,QAA1B,EAAoCC,QAApC,EAA8C+3B,EAAE,CAACtnC,CAAjD,EAAoD5oB,EAAE,CAAC4oB,CAAvD,EAA0DyJ,IAAI,CAACmC,SAAL,CAAe,CAAf,EAAkBX,MAA5E,EAAoFxB,IAAI,CAACmC,SAAL,CAAe,CAAf,EAAkBX,MAAtG,EAA8GxB,IAA9G,CAAJ;AACAy9B,oCAAgB,CAACG,IAAD,CAAhB,GAAyBrnC,CAAzB,CAFI,CAGJ;AACA;;AACA;;;;;;AAMH;;AACD,sBAAImnC,gBAAJ,EAAsB;AAClB3B,qCAAiB,CAAC3C,WAAW,CAACvzB,QAAD,CAAZ,EAAwBtP,CAAC,CAACte,KAA1B,EAAiC,CAAjC,EAAoC+nB,IAApC,EAA0C,KAA1C,EAAiD8F,QAAjD,EAA2D,CAA3D,EAA8D,KAA9D,EAAqEvP,CAAC,CAAC1mB,CAAF,CAAI,CAAJ,CAArE,EAA6Eg2B,QAA7E,EAAuF03B,kBAAvF,EAA2GnB,gBAA3G,CAAjB;AACH;;AACD,sBAAIuB,gBAAJ,EAAsB;AAClB5B,qCAAiB,CAAC3C,WAAW,CAACtzB,QAAD,CAAZ,EAAwBvP,CAAC,CAACnd,MAA1B,EAAkC,CAAC,CAAnC,EAAsC4mB,IAAtC,EAA4C,IAA5C,EAAkD6F,QAAlD,EAA4D,CAA5D,EAA+D,IAA/D,EAAqEtP,CAAC,CAAC1mB,CAAF,CAAI,CAAJ,CAArE,EAA6Ei2B,QAA7E,EAAuFy3B,kBAAvF,EAA2GnB,gBAA3G,CAAjB;AACH;AACJ;;AAED,oBAAIsB,gBAAJ,EAAsB;AAClBn7B,qBAAG,CAAChH,eAAJ,CAAoBiiC,eAApB,EAAqC33B,QAArC,EAA+C,UAAUh2B,CAAV,EAAa;AACxD,2BAAOA,CAAC,KAAKg2B,QAAb;AACH,mBAFD;AAGH;;AACD,oBAAI83B,gBAAJ,EAAsB;AAClBp7B,qBAAG,CAAChH,eAAJ,CAAoBiiC,eAApB,EAAqC13B,QAArC,EAA+C,UAAUj2B,CAAV,EAAa;AACxD,2BAAOA,CAAC,KAAKi2B,QAAb;AACH,mBAFD;AAGH;;AACDvD,mBAAG,CAAChH,eAAJ,CAAoBgiC,kBAApB,EAAwCv9B,IAAxC,EAA8C,UAAUpyB,CAAV,EAAa;AACvD,yBAAOA,CAAC,CAACwqB,EAAF,KAAS4H,IAAI,CAAC5H,EAArB;AACH,iBAFD;;AAGA,oBAAKslC,gBAAgB,IAAI5O,IAAI,KAAK,CAA9B,IAAqC6O,gBAAgB,IAAI7O,IAAI,KAAK,CAAtE,EAA0E;AACtEvsB,qBAAG,CAAChH,eAAJ,CAAoB6gC,gBAApB,EAAsCp8B,IAAI,CAACmC,SAAL,CAAe2sB,IAAf,CAAtC,EAA4D,UAAUzzC,CAAV,EAAa;AACrE,2BAAOA,CAAC,CAAC+c,EAAF,KAAS4H,IAAI,CAACmC,SAAL,CAAe2sB,IAAf,EAAqB12B,EAArC;AACH,mBAFD;AAGH;AACJ;AACJ,aAzGoC,CA2GrC;;;AACA,iBAAK/qB,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAG0yB,EAAE,CAAChzB,MAAnB,EAA2BM,CAAC,EAA5B,EAAgC;AAC5B,kBAAI0yB,EAAE,CAAC1yB,CAAD,CAAF,CAAMy+B,WAAN,CAAkB/+B,MAAlB,KAA6B,CAA7B,IAAkCgzB,EAAE,CAAC1yB,CAAD,CAAF,CAAMm0B,MAAN,CAAa+5B,YAAnD,EAAiE;AAC7D,oBAAI,CAACnC,WAAW,CAACroB,SAAD,CAAhB,EAA6B;AACzBqoB,6BAAW,CAACroB,SAAD,CAAX,GAAyB;AAAEruB,uBAAG,EAAE,EAAP;AAAW7T,yBAAK,EAAE,EAAlB;AAAsBoxB,0BAAM,EAAE,EAA9B;AAAkCrxB,wBAAI,EAAE;AAAxC,mBAAzB;AACH;;AACDmtD,iCAAiB,CAAC3C,WAAW,CAACroB,SAAD,CAAZ,EAAyB,CAACxlC,IAAI,CAACsK,EAAN,GAAW,CAApC,EAAuC,CAAvC,EAA0C;AAACssB,2BAAS,EAAE,CAACpC,EAAE,CAAC1yB,CAAD,CAAH,EAAQ0yB,EAAE,CAAC1yB,CAAD,CAAV,CAAZ;AAA4B4mC,uBAAK,EAAE,iBAAY,CACzG;AAD0D,iBAA1C,EACb,KADa,EACNlD,SADM,EACK,CADL,EACQ,KADR,EACehR,EAAE,CAAC1yB,CAAD,CAAF,CAAMm0B,MAAN,CAAau8B,cAAb,EADf,EAC8ChtB,SAD9C,EACyDwsB,kBADzD,EAC6EnB,gBAD7E,CAAjB;;AAEA75B,mBAAG,CAAChH,eAAJ,CAAoBiiC,eAApB,EAAqCzsB,SAArC,EAAgD,UAAUlhC,CAAV,EAAa;AACzD,yBAAOA,CAAC,KAAKkhC,SAAb;AACH,iBAFD;AAGH;AACJ,aAvHoC,CAyHrC;;;AACA,iBAAK1jC,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGmwD,eAAe,CAACzwD,MAAhC,EAAwCM,CAAC,EAAzC,EAA6C;AACzC+sD,0BAAY,CAACoD,eAAe,CAACnwD,CAAD,CAAhB,EAAqB+rD,WAAW,CAACoE,eAAe,CAACnwD,CAAD,CAAhB,CAAhC,CAAZ;AACH,aA5HoC,CA8HrC;;;AACA,iBAAKA,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAG0yB,EAAE,CAAChzB,MAAnB,EAA2BM,CAAC,EAA5B,EAAgC;AAC5B0yB,gBAAE,CAAC1yB,CAAD,CAAF,CAAM4mC,KAAN,CAAY;AAAE9Q,yBAAS,EAAEA,SAAb;AAAwBgK,sBAAM,EAAE6G,QAAhC;AAA0C4a,0BAAU,EAAE5a,QAAQ,CAAC5nC,CAA/D;AAAkE67B,sBAAM,EAAEo1B,mBAAmB,KAAK;AAAlG,eAAZ;AACH,aAjIoC,CAmIrC;;;AACA,iBAAKhwD,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAG+uD,gBAAgB,CAACrvD,MAAjC,EAAyCM,CAAC,EAA1C,EAA8C;AAC1C,kBAAIitD,EAAE,GAAGn6B,eAAe,CAACklB,aAAhB,CAA8B+W,gBAAgB,CAAC/uD,CAAD,CAAhB,CAAoB0jC,SAAlD,CAAT,CAD0C,CAE1C;;AACAqrB,8BAAgB,CAAC/uD,CAAD,CAAhB,CAAoB4mC,KAApB,CAA0B;AAAE9Q,yBAAS,EAAE,IAAb;AAAmBgK,sBAAM,EAAEmtB,EAA3B;AAA+B1L,0BAAU,EAAE0L,EAAE,CAACluD;AAA9C,eAA1B;AACH,aAxIoC,CA0IrC;AACA;AAEA;;;AACA,iBAAKiB,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGiwD,mBAAmB,CAACvwD,MAApC,EAA4CM,CAAC,EAA7C,EAAiD;AAC7C,kBAAIguD,aAAa,GAAGiC,mBAAmB,CAACjwD,CAAD,CAAnB,CAAuB,CAAvB,CAApB;;AACA,kBAAIguD,aAAa,CAAC75B,MAAd,CAAqBxmB,WAArB,KAAqC0sC,GAAG,CAAC3K,aAA7C,EAA4D;AACxDse,6BAAa,CAACpnB,KAAd,CAAoB;AAAE4X,uCAAqB,EAAE9a,SAAzB;AAAoC5N,2BAAS,EAAEA;AAA/C,iBAApB;;AACAZ,mBAAG,CAAChH,eAAJ,CAAoBgiC,kBAApB,EAAwCD,mBAAmB,CAACjwD,CAAD,CAAnB,CAAuB,CAAvB,CAAxC,EAAmE,UAAUO,CAAV,EAAa;AAC5E,yBAAOA,CAAC,CAACwqB,EAAF,KAASklC,mBAAmB,CAACjwD,CAAD,CAAnB,CAAuB,CAAvB,EAA0B+qB,EAA1C;AACH,iBAFD,EAFwD,CAKxD;;;AACA,qBAAK,IAAI/pB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGgtD,aAAa,CAACvvB,WAAd,CAA0B/+B,MAA9C,EAAsDsB,CAAC,EAAvD,EAA2D;AACvD,sBAAIgtD,aAAa,CAACvvB,WAAd,CAA0Bz9B,CAA1B,MAAiCivD,mBAAmB,CAACjwD,CAAD,CAAnB,CAAuB,CAAvB,CAArC,EAAgE;AAC5Dk1B,uBAAG,CAAChH,eAAJ,CAAoBgiC,kBAApB,EAAwClC,aAAa,CAACvvB,WAAd,CAA0Bz9B,CAA1B,CAAxC,EAAsE,UAAUT,CAAV,EAAa;AAC/E,6BAAOA,CAAC,CAACwqB,EAAF,KAASijC,aAAa,CAACvvB,WAAd,CAA0Bz9B,CAA1B,EAA6B+pB,EAA7C;AACH,qBAFD;AAGH;AACJ;AACJ,eAbD,MAaO;AACHmK,mBAAG,CAAChH,eAAJ,CAAoBgiC,kBAApB,EAAwCD,mBAAmB,CAACjwD,CAAD,CAAnB,CAAuB,CAAvB,CAAxC,EAAmE,UAAUO,CAAV,EAAa;AAC5E,yBAAOA,CAAC,CAACwqB,EAAF,KAASklC,mBAAmB,CAACjwD,CAAD,CAAnB,CAAuB,CAAvB,EAA0B+qB,EAA1C;AACH,iBAFD;AAGH;AACJ,aAlKoC,CAoKrC;;;AACA,gBAAI4lC,EAAE,GAAG5a,mBAAmB,CAACrS,SAAD,CAA5B;;AACA,gBAAIitB,EAAJ,EAAQ;AACJA,gBAAE,CAAC/pB,KAAH,CAAS;AAAC9Q,yBAAS,EAAEA,SAAZ;AAAuB8E,sBAAM,EAAE,KAA/B;AAAsClG,oBAAI,EAAEgP;AAA5C,eAAT;AACH,aAxKoC,CA0KrC;;;AACA,iBAAK1jC,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGkwD,kBAAkB,CAACxwD,MAAnC,EAA2CM,CAAC,EAA5C,EAAgD;AAC5CkwD,gCAAkB,CAAClwD,CAAD,CAAlB,CAAsB4mC,KAAtB,CAA4B;AAAClS,oBAAI,EAAEgP,SAAP;AAAkB5N,yBAAS,EAAE,IAA7B;AAAmC8E,sBAAM,EAAE,KAA3C;AAAkD+E,0BAAU,EAAEA;AAA9D,eAA5B;AACH;AACJ;AACJ,SAjLD;;AAmLA,YAAIixB,gBAAgB,GAAG,SAAnBA,gBAAmB,CAAUjhB,YAAV,EAAwB;AAC3Cza,aAAG,CAACpE,cAAJ,CAAmBzpB,KAAnB,CAAyB,IAAzB;;AACA,eAAKiL,IAAL,GAAY,YAAZ;AACA,eAAKkvC,SAAL,GAAiB,IAAjB;AACA,eAAK0M,YAAL,GAAoB,IAApB;AACA,cAAI2C,KAAK,GAAGlhB,YAAY,CAACkhB,KAAb,IAAsB,CAAC,KAAD,EAAQ,OAAR,EAAiB,QAAjB,EAA2B,MAA3B,CAAlC;AAAA,cACIC,SAAS,GAAG,EAAEnhB,YAAY,CAACmhB,SAAb,KAA2B,KAA7B,CADhB;AAAA,cAEIC,cAAc,GAAG,EAFrB;AAAA,cAGIC,SAAS,GAAG;AAAE,mBAAO,QAAT;AAAmB,qBAAS,MAA5B;AAAoC,oBAAQ,OAA5C;AAAqD,sBAAU;AAA/D,WAHhB;AAAA,cAIIC,gBAAgB,GAAG;AAAE,mBAAO,OAAT;AAAkB,qBAAS,QAA3B;AAAqC,oBAAQ,KAA7C;AAAoD,sBAAU;AAA9D,WAJvB;AAAA,cAKIC,oBAAoB,GAAG;AAAE,mBAAO,MAAT;AAAiB,qBAAS,KAA1B;AAAiC,oBAAQ,QAAzC;AAAmD,sBAAU;AAA7D,WAL3B;AAAA,cAMIC,UAAU,GAAGL,SAAS,GAAGG,gBAAH,GAAsBC,oBANhD;AAAA,cAOIE,UAAU,GAAGN,SAAS,GAAGI,oBAAH,GAA0BD,gBAPpD;AAAA,cAQIj4B,QAAQ,GAAG2W,YAAY,CAAC3W,QAAb,IAAyB,EARxC;AAAA,cASIq4B,YAAY,GAAG,IATnB;AAAA,cASyBC,WAAW,GAAG,IATvC;AAAA,cAS6CC,YAAY,GAAG,CAAC,MAAD,EAAS,OAAT,CAT5D;AAAA,cAS+EC,YAAY,GAAG,CAAC,KAAD,EAAQ,QAAR,CAT9F;AAAA,cAUIC,WAAW,GAAG,IAVlB;;AAYA,eAAK,IAAIzxD,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG6wD,KAAK,CAACnxD,MAA1B,EAAkCM,CAAC,EAAnC,EAAuC;AACnC+wD,0BAAc,CAACF,KAAK,CAAC7wD,CAAD,CAAN,CAAd,GAA2B,IAA3B;AACH;;AAED,eAAK0wD,cAAL,GAAsB,YAAY;AAC9B,mBAAOG,KAAK,CAACnxD,MAAN,KAAiB,CAAjB,GAAqB,KAArB,GAA6BmxD,KAAK,CAAC,CAAD,CAAzC;AACH,WAFD;;AAIA,eAAKa,aAAL,GAAqB,YAAW;AAAE,mBAAO,IAAP;AAAc,WAAhD;;AACA,eAAKC,gBAAL,GAAwB,YAAW;AAAE,mBAAO,IAAP;AAAc,WAAnD,CA1B2C,CA4B3C;AACA;;;AACA,eAAKC,UAAL,GAAkB,UAAUn/B,IAAV,EAAgB;AAC9B,gBAAIs+B,cAAc,CAACt+B,IAAD,CAAlB,EAA0B;AACtB,qBAAOA,IAAP;AACH,aAFD,MAGK,IAAIs+B,cAAc,CAACC,SAAS,CAACv+B,IAAD,CAAV,CAAlB,EAAqC;AACtC,qBAAOu+B,SAAS,CAACv+B,IAAD,CAAhB;AACH,aAFI,MAGA,IAAIs+B,cAAc,CAACI,UAAU,CAAC1+B,IAAD,CAAX,CAAlB,EAAsC;AACvC,qBAAO0+B,UAAU,CAAC1+B,IAAD,CAAjB;AACH,aAFI,MAGA,IAAIs+B,cAAc,CAACK,UAAU,CAAC3+B,IAAD,CAAX,CAAlB,EAAsC;AACvC,qBAAO2+B,UAAU,CAAC3+B,IAAD,CAAjB;AACH;;AACD,mBAAOA,IAAP,CAb8B,CAajB;AAChB,WAdD;;AAgBA,eAAKo/B,eAAL,GAAuB,UAAUp/B,IAAV,EAAgB;AACnC,mBAAQg/B,WAAW,IAAI,IAAf,GAEHH,WAAW,IAAI,IAAf,GAAsBP,cAAc,CAACt+B,IAAD,CAAd,KAAyB,IAA/C,GAAsD6+B,WAAW,KAAK7+B,IAFnE,GAIFg/B,WAAW,CAACljD,OAAZ,CAAoBkkB,IAApB,MAA8B,CAAC,CAJrC;AAKH,WAND;;AAQA,eAAKq/B,cAAL,GAAsB,UAASC,IAAT,EAAeC,YAAf,EAA6B;AAC/CX,wBAAY,GAAGU,IAAf,CAD+C,CAE/C;;AACA,gBAAIC,YAAY,IAAIV,WAAW,IAAI,IAAnC,EAAyC;AACrCA,yBAAW,GAAGD,YAAd;AACH;AACJ,WAND;;AAQA,eAAKY,cAAL,GAAsB,YAAW;AAAE,mBAAOZ,YAAP;AAAsB,WAAzD;;AACA,eAAKa,iBAAL,GAAyB,YAAW;AAChC,gBAAIC,EAAE,GAAG,EAAT;;AACA,iBAAK,IAAInxD,CAAT,IAAc+vD,cAAd,EAA8B;AAC1B,kBAAIA,cAAc,CAAC/vD,CAAD,CAAlB,EAAuB;AACnBmxD,kBAAE,CAACztD,IAAH,CAAQ1D,CAAR;AACH;AACJ;;AACD,mBAAOmxD,EAAP;AACH,WARD;;AAUA,eAAKC,IAAL,GAAY,YAAW;AACnBd,uBAAW,GAAGD,YAAd;AACH,WAFD;;AAGA,eAAKxgB,MAAL,GAAc,YAAW;AACrBygB,uBAAW,GAAG,IAAd;AACH,WAFD;;AAGA,eAAKe,QAAL,GAAgB,YAAW;AACvB,mBAAOf,WAAW,IAAI,IAAtB;AACH,WAFD;;AAIA,eAAKgB,eAAL,GAAuB,YAAW;AAC9B,gBAAIjB,YAAY,IAAI,IAApB,EAA0B;AACtBI,yBAAW,GAAIJ,YAAY,KAAK,MAAjB,IAA2BA,YAAY,KAAK,OAA7C,GAAwDE,YAAxD,GAAuEC,YAArF;AACH;AACJ,WAJD;;AAMA,eAAKe,iBAAL,GAAyB,YAAW;AAChCd,uBAAW,GAAG,IAAd;AACH,WAFD;;AAIA,eAAK3qB,OAAL,GAAe,UAAUpxB,MAAV,EAAkB;AAC7B,mBAAOk2C,yBAAyB,CAACl2C,MAAM,CAAC+pB,OAAP,CAAe1U,EAAhB,CAAzB,IAAgD,CAAC,CAAD,EAAI,CAAJ,CAAvD;AACH,WAFD;;AAGA,eAAK2yB,kBAAL,GAA0B,UAAUhoC,MAAV,EAAkB;AACxC,mBAAOk2C,yBAAyB,CAACl2C,MAAM,CAAC+pB,OAAP,CAAe1U,EAAhB,CAAzB,IAAgD,CAAC,CAAD,EAAI,CAAJ,CAAvD;AACH,WAFD;;AAGA,eAAK0kB,cAAL,GAAsB,UAAUpb,QAAV,EAAoB;AACtC,mBAAOw3B,4BAA4B,CAACx3B,QAAQ,CAACtJ,EAAV,CAA5B,IAA6C,CAAC,CAAD,EAAI,CAAJ,CAApD;AACH,WAFD;;AAGA,eAAKy0B,WAAL,GAAmB,YAAY;AAC3B,mBAAOxmB,QAAP;AACH,WAFD;AAGH,SAzGD,CA5hBkC,CAuoBlC;;;AACAlG,uBAAe,CAAC+sB,uBAAhB,GAA0C;AACtCxT,aAAG,EAAE,aAAU32B,MAAV,EAAkB;AACnB,mBAAO,IAAIk7C,gBAAJ,CAAqBl7C,MAArB,CAAP;AACH,WAHqC;AAItC+gC,eAAK,EAAE,eAAU/S,SAAV,EAAqB;AACxB,mBAAOkoB,yBAAyB,CAACloB,SAAD,CAAhC;AACH;AANqC,SAA1C;AAQH,OAhpBD;;AAkpBA2W,SAAG,CAACqR,aAAJ,CAAkB7hD,SAAlB,CAA4B4mD,oBAA5B,GAAmD,UAAUj4B,QAAV,EAAoBC,QAApB,EAA8B+3B,EAA9B,EAAkClwD,EAAlC,EAAsCkyD,YAAtC,EAAoDC,YAApD,EAAkE;AAEjH,YAAIC,WAAW,GAAG;AAAEC,oBAAU,EAAE,YAAd;AAA4BC,kBAAQ,EAAE,UAAtC;AAAkDC,kBAAQ,EAAE,UAA5D;AAAwEC,kBAAQ,EAAE;AAAlF,SAAlB;AAAA,YACIC,IAAI,GAAG,CAAC,MAAD,EAAS,KAAT,EAAgB,OAAhB,EAAyB,QAAzB,CADX;;AAGA,YAAIv6B,QAAQ,KAAKC,QAAjB,EAA2B;AACvB,iBAAO;AACHmX,uBAAW,EAAE8iB,WAAW,CAACI,QADtB;AAEHtwD,aAAC,EAAE,CAAC,KAAD,EAAQ,KAAR;AAFA,WAAP;AAIH;;AAED,YAAIoI,KAAK,GAAG1M,IAAI,CAAC80D,KAAL,CAAY1yD,EAAE,CAAC2uC,OAAH,GAAauhB,EAAE,CAACvhB,OAA5B,EAAuC3uC,EAAE,CAAC0uC,OAAH,GAAawhB,EAAE,CAACxhB,OAAvD,CAAZ;AAAA,YACIjjC,MAAM,GAAG7N,IAAI,CAAC80D,KAAL,CAAYxC,EAAE,CAACvhB,OAAH,GAAa3uC,EAAE,CAAC2uC,OAA5B,EAAuCuhB,EAAE,CAACxhB,OAAH,GAAa1uC,EAAE,CAAC0uC,OAAvD,CADb,CAZiH,CAezH;AAEQ;AACA;AACA;;AACA,YAAI1vC,UAAU,GAAG,EAAjB;AAAA,YAAqB2zD,SAAS,GAAG,EAAjC;;AACA,SAAC,UAAUv8B,KAAV,EAAiBw8B,GAAjB,EAAsB;AACnB,eAAK,IAAIlzD,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG02B,KAAK,CAACh3B,MAA1B,EAAkCM,CAAC,EAAnC,EAAuC;AACnCizD,qBAAS,CAACv8B,KAAK,CAAC12B,CAAD,CAAN,CAAT,GAAsB;AAClB,sBAAQ,CAAEkzD,GAAG,CAAClzD,CAAD,CAAH,CAAOuB,IAAT,EAAe2xD,GAAG,CAAClzD,CAAD,CAAH,CAAOivC,OAAtB,CADU;AAElB,uBAAS,CAAEikB,GAAG,CAAClzD,CAAD,CAAH,CAAOwB,KAAT,EAAgB0xD,GAAG,CAAClzD,CAAD,CAAH,CAAOivC,OAAvB,CAFS;AAGlB,qBAAO,CAAEikB,GAAG,CAAClzD,CAAD,CAAH,CAAOgvC,OAAT,EAAkBkkB,GAAG,CAAClzD,CAAD,CAAH,CAAOqV,GAAzB,CAHW;AAIlB,wBAAU,CAAE69C,GAAG,CAAClzD,CAAD,CAAH,CAAOgvC,OAAT,EAAmBkkB,GAAG,CAAClzD,CAAD,CAAH,CAAO4yB,MAA1B;AAJQ,aAAtB;AAMH;AACJ,SATD,EASG,CAAE,QAAF,EAAY,QAAZ,CATH,EAS2B,CAAE49B,EAAF,EAAMlwD,EAAN,CAT3B;;AAWA,aAAK,IAAI6yD,EAAE,GAAG,CAAd,EAAiBA,EAAE,GAAGJ,IAAI,CAACrzD,MAA3B,EAAmCyzD,EAAE,EAArC,EAAyC;AACrC,eAAK,IAAIC,EAAE,GAAG,CAAd,EAAiBA,EAAE,GAAGL,IAAI,CAACrzD,MAA3B,EAAmC0zD,EAAE,EAArC,EAAyC;AACrC9zD,sBAAU,CAACoF,IAAX,CAAgB;AACZ+uB,oBAAM,EAAEs/B,IAAI,CAACI,EAAD,CADA;AAEZjnD,oBAAM,EAAE6mD,IAAI,CAACK,EAAD,CAFA;AAGZtzD,kBAAI,EAAE4J,OAAO,CAACc,UAAR,CAAmByoD,SAAS,CAACx/B,MAAV,CAAiBs/B,IAAI,CAACI,EAAD,CAArB,CAAnB,EAA+CF,SAAS,CAAC/mD,MAAV,CAAiB6mD,IAAI,CAACK,EAAD,CAArB,CAA/C;AAHM,aAAhB;AAKH;AACJ;;AAED9zD,kBAAU,CAAC8mB,IAAX,CAAgB,UAAU5jB,CAAV,EAAaC,CAAb,EAAgB;AAC5B,iBAAOD,CAAC,CAAC1C,IAAF,GAAS2C,CAAC,CAAC3C,IAAX,GAAkB,CAAC,CAAnB,GAAuB0C,CAAC,CAAC1C,IAAF,GAAS2C,CAAC,CAAC3C,IAAX,GAAkB,CAAlB,GAAsB,CAApD;AACH,SAFD,EA1CiH,CA8CjH;AACA;;AACA,YAAIuzD,UAAU,GAAG/zD,UAAU,CAAC,CAAD,CAAV,CAAcm0B,MAA/B;AAAA,YAAuC6/B,UAAU,GAAGh0D,UAAU,CAAC,CAAD,CAAV,CAAc4M,MAAlE;;AACA,aAAK,IAAIlM,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGV,UAAU,CAACI,MAA/B,EAAuCM,CAAC,EAAxC,EAA4C;AAExC,cAAI,CAACwyD,YAAY,CAACtE,YAAd,IAA8BsE,YAAY,CAACX,eAAb,CAA6BvyD,UAAU,CAACU,CAAD,CAAV,CAAcyzB,MAA3C,CAAlC,EAAsF;AAClF4/B,sBAAU,GAAG/zD,UAAU,CAACU,CAAD,CAAV,CAAcyzB,MAA3B;AACH,WAFD,MAGK;AACD4/B,sBAAU,GAAG,IAAb;AACH;;AAED,cAAI,CAACZ,YAAY,CAACvE,YAAd,IAA8BuE,YAAY,CAACZ,eAAb,CAA6BvyD,UAAU,CAACU,CAAD,CAAV,CAAckM,MAA3C,CAAlC,EAAsF;AAClFonD,sBAAU,GAAGh0D,UAAU,CAACU,CAAD,CAAV,CAAckM,MAA3B;AACH,WAFD,MAGK;AACDonD,sBAAU,GAAG,IAAb;AACH;;AAED,cAAID,UAAU,IAAI,IAAd,IAAsBC,UAAU,IAAI,IAAxC,EAA8C;AAC1C;AACH;AACJ;;AAED,YAAId,YAAY,CAACtE,YAAjB,EAA+B;AAC3BsE,sBAAY,CAACV,cAAb,CAA4BuB,UAA5B;AACH;;AAED,YAAIZ,YAAY,CAACvE,YAAjB,EAA+B;AAC3BuE,sBAAY,CAACX,cAAb,CAA4BwB,UAA5B;AACH,SA5EgH,CA8EzH;;;AAEQ,eAAO;AACH9wD,WAAC,EAAE,CAAE6wD,UAAF,EAAcC,UAAd,CADA;AAEH1oD,eAAK,EAAEA,KAFJ;AAGHmB,gBAAM,EAAEA;AAHL,SAAP;AAKH,OArFD;AAuFA;;;;;;;;AAMAsuC,SAAG,CAACtf,MAAJ,GAAa,UAAUrlB,MAAV,EAAkB;AAC3B,aAAKtX,CAAL,GAASsX,MAAM,CAACtX,CAAP,IAAY,CAArB;AACA,aAAKK,CAAL,GAASiX,MAAM,CAACjX,CAAP,IAAY,CAArB;AACA,aAAKilC,SAAL,GAAiBhuB,MAAM,CAACguB,SAAxB;AACA,aAAK1K,QAAL,GAAgBtjB,MAAM,CAACsjB,QAAP,IAAmB,EAAnC;AACA,aAAKu6B,mBAAL,GAA2B,IAA3B;AACA,aAAK3jB,WAAL,GAAmBl6B,MAAM,CAACk6B,WAAP,IAAsB,CAAE,CAAF,EAAK,CAAL,CAAzC;AACA,aAAK4jB,eAAL,GAAuB,IAAvB;AACA,aAAK50B,OAAL,GAAelpB,MAAM,CAACkpB,OAAP,IAAkB,CAAE,CAAF,EAAK,CAAL,CAAjC;AACA,aAAK9I,SAAL,GAAiB,IAAjB;AAEA,YAAI29B,WAAW,GAAG/9C,MAAM,CAAC+9C,WAAP,KAAuB,KAAzC;;AACA,aAAK/B,aAAL,GAAqB,YAAW;AAAE,iBAAO+B,WAAP;AAAqB,SAAvD;;AACA,aAAKC,cAAL,GAAsB,UAASC,YAAT,EAAuB;AAAEF,qBAAW,GAAGE,YAAd;AAA6B,SAA5E;;AACA,YAAIC,cAAc,GAAGl+C,MAAM,CAACk+C,cAAP,KAA0B,KAA/C;;AACA,aAAKjC,gBAAL,GAAwB,YAAW;AAAE,iBAAOiC,cAAP;AAAwB,SAA7D;;AAEA,YAAIC,MAAM,GAAG,KAAb;;AACA,aAAKzB,IAAL,GAAY,YAAW;AAAEyB,gBAAM,GAAG,IAAT;AAAgB,SAAzC;;AACA,aAAKhjB,MAAL,GAAc,YAAW;AAAEgjB,gBAAM,GAAG,KAAT;AAAiB,SAA5C;;AACA,aAAKxB,QAAL,GAAgB,YAAW;AAAE,iBAAOwB,MAAP;AAAgB,SAA7C;;AAEA3+B,WAAG,CAACpE,cAAJ,CAAmBzpB,KAAnB,CAAyB,IAAzB;;AAEA,aAAKy/B,OAAL,GAAe,UAAUpxB,MAAV,EAAkB;AAE7B,cAAIqxB,EAAE,GAAGrxB,MAAM,CAACqxB,EAAhB;AAAA,cAAoBC,EAAE,GAAGtxB,MAAM,CAACsxB,EAAhC;AAAA,cAAoClR,SAAS,GAAGpgB,MAAM,CAACogB,SAAvD;;AAEA,cAAIpgB,MAAM,CAACo+C,wBAAX,EAAqC;AACjC,iBAAKP,mBAAL,GAA2B,IAA3B;AACH;;AAED,cAAIz9B,SAAS,IAAIA,SAAS,KAAK,KAAKA,SAApC,EAA+C;AAC3C,mBAAO,KAAK09B,eAAZ;AACH;;AAED,cAAI,KAAKD,mBAAL,IAA4B,IAAhC,EAAsC;AAClC,iBAAKC,eAAL,GAAuB,KAAKD,mBAA5B;AACH,WAFD,MAGK;AACD,iBAAKC,eAAL,GAAuB,CAAEzsB,EAAE,CAAC,CAAD,CAAF,GAAS,KAAK3oC,CAAL,GAAS4oC,EAAE,CAAC,CAAD,CAApB,GAA2B,KAAKpI,OAAL,CAAa,CAAb,CAA7B,EAA8CmI,EAAE,CAAC,CAAD,CAAF,GAAS,KAAKtoC,CAAL,GAASuoC,EAAE,CAAC,CAAD,CAApB,GAA2B,KAAKpI,OAAL,CAAa,CAAb,CAAzE,EAA0F,KAAKxgC,CAA/F,EAAkG,KAAKK,CAAvG,CAAvB;AACH;;AAED,eAAKq3B,SAAL,GAAiBA,SAAjB;AACA,iBAAO,KAAK09B,eAAZ;AACH,SArBD;;AAuBA,aAAK9V,kBAAL,GAA0B,UAAUhoC,MAAV,EAAkB;AACxCA,gBAAM,GAAGA,MAAM,IAAI,EAAnB;AACA,iBAAQ,KAAK89C,eAAL,IAAwB,IAAxB,IAAiC99C,MAAM,CAACogB,SAAP,IAAoB,IAApB,IAA4B,KAAKA,SAAL,KAAmBpgB,MAAM,CAACogB,SAAxF,GAAsG,KAAKgR,OAAL,CAAapxB,MAAb,CAAtG,GAA6H,KAAK89C,eAAzI;AACH,SAHD;;AAKA,aAAK9yC,WAAL,GAAmB,UAAStiB,CAAT,EAAYK,CAAZ,EAAes1D,EAAf,EAAmBC,EAAnB,EAAuBhC,YAAvB,EAAqC;AACpD,cAAI,CAAC6B,MAAD,IAAW7B,YAAf,EAA6B;AACzB,iBAAK5zD,CAAL,GAASA,CAAT;AACA,iBAAKK,CAAL,GAASA,CAAT;AACA,iBAAKmxC,WAAL,GAAmB,CAAEmkB,EAAF,EAAMC,EAAN,CAAnB;AACA,iBAAKR,eAAL,GAAuB,IAAvB;AACH;AACJ,SAPD;AAQH,OA5DD;;AA6DAt+B,SAAG,CAAC1G,MAAJ,CAAW6rB,GAAG,CAACtf,MAAf,EAAuB7F,GAAG,CAACpE,cAA3B,EAA2C;AACvC00B,cAAM,EAAE,gBAAUrxB,MAAV,EAAkB;AACtB,cAAI,CAACA,MAAL,EAAa;AACT,mBAAO,KAAP;AACH;;AACD,cAAI8/B,EAAE,GAAG9/B,MAAM,CAACsb,cAAP,EAAT;AAAA,cACIvmB,CAAC,GAAG,KAAKumB,cAAL,EADR;AAEA,iBAAO,KAAKrxC,CAAL,KAAW+1B,MAAM,CAAC/1B,CAAlB,IAAuB,KAAKK,CAAL,KAAW01B,MAAM,CAAC11B,CAAzC,IAA8C,KAAKmgC,OAAL,CAAa,CAAb,MAAoBzK,MAAM,CAACyK,OAAP,CAAe,CAAf,CAAlE,IAAuF,KAAKA,OAAL,CAAa,CAAb,MAAoBzK,MAAM,CAACyK,OAAP,CAAe,CAAf,CAA3G,IAAgI1V,CAAC,CAAC,CAAD,CAAD,KAAS+qC,EAAE,CAAC,CAAD,CAA3I,IAAkJ/qC,CAAC,CAAC,CAAD,CAAD,KAAS+qC,EAAE,CAAC,CAAD,CAApK;AACH,SARsC;AASvCC,8BAAsB,EAAE,kCAAY;AAChC,iBAAO,KAAKX,mBAAZ;AACH,SAXsC;AAYvCY,8BAAsB,EAAE,gCAAUxlD,CAAV,EAAa;AACjC,eAAK4kD,mBAAL,GAA2B5kD,CAA3B;AACH,SAdsC;AAevCmlD,gCAAwB,EAAE,oCAAY;AAClC,eAAKP,mBAAL,GAA2B,IAA3B;AACH,SAjBsC;AAkBvC9jB,sBAAc,EAAE,0BAAY;AACxB,iBAAO,KAAKG,WAAZ;AACH,SApBsC;AAqBvC4P,mBAAW,EAAE,uBAAY;AACrB,iBAAO,KAAKxmB,QAAZ;AACH;AAvBsC,OAA3C;AA0BA;;;;;;;;;AAOAqhB,SAAG,CAAC+D,cAAJ,GAAqB,UAAU1oC,MAAV,EAAkB;AAEnC2kC,WAAG,CAACtf,MAAJ,CAAW1zB,KAAX,CAAiB,IAAjB,EAAuB0F,SAAvB,EAFmC,CAInC;AACA;;;AACA,YAAIqnD,GAAG,GAAG1+C,MAAM,CAAC2oC,SAAjB;AAAA,YACI;AACAgW,iBAAS,GAAG3+C,MAAM,CAACwoC,eAFvB;AAAA,YAGIx4B,IAAI,GAAG20B,GAAG,CAAC10B,OAAJ,CAAY0uC,SAAZ,CAHX;AAAA,YAII;AACA;AACA;AACA;AACA;AACAC,YAAI,GAAG,CATX;AAAA,YAScC,IAAI,GAAG,CATrB;AAAA,YAUI;AACA;AACA3kB,mBAAW,GAAG,IAZlB;AAAA,YAaI4kB,WAAW,GAAG,IAblB,CANmC,CAqBnC;;;AACA,aAAK5kB,WAAL,GAAmB,IAAnB,CAtBmC,CAwBnC;AACA;AACA;;AACA,aAAKxxC,CAAL,GAAS,CAAT;AACA,aAAKK,CAAL,GAAS,CAAT;AAEA,aAAK+6C,UAAL,GAAkB,IAAlB;;AAEA,aAAK1S,OAAL,GAAe,UAAUpxB,MAAV,EAAkB;AAC7B,cAAIqxB,EAAE,GAAGrxB,MAAM,CAACqxB,EAAhB;AAAA,cACIhiB,MAAM,GAAG,CAAEgiB,EAAE,CAAC,CAAD,CAAF,GAASrhB,IAAI,CAAC,CAAD,CAAJ,GAAU,CAArB,EAAyBqhB,EAAE,CAAC,CAAD,CAAF,GAASrhB,IAAI,CAAC,CAAD,CAAJ,GAAU,CAA5C,CADb,CAD6B,CAEkC;;AAC/D8uC,qBAAW,GAAGzvC,MAAd;AACA,iBAAOA,MAAP;AACH,SALD;;AAOA,aAAK0qB,cAAL,GAAsB,UAAUglB,SAAV,EAAqB;AACvC,cAAI7kB,WAAJ,EAAiB;AACb,mBAAOA,WAAP;AACH,WAFD,MAGK;AACD,gBAAI1mB,CAAC,GAAGkrC,GAAG,CAAC3kB,cAAJ,CAAmBglB,SAAnB,CAAR,CADC,CAED;AACA;AACA;;AACA,mBAAO,CAAEv2D,IAAI,CAACuH,GAAL,CAASyjB,CAAC,CAAC,CAAD,CAAV,IAAiBorC,IAAjB,GAAwB,CAAC,CAA3B,EACHp2D,IAAI,CAACuH,GAAL,CAASyjB,CAAC,CAAC,CAAD,CAAV,IAAiBqrC,IAAjB,GAAwB,CAAC,CADtB,CAAP;AAEH;AACJ,SAZD;AAcA;;;;;;;AAKA,aAAK7hD,IAAL,GAAY,UAAUyhB,MAAV,EAAkBE,QAAlB,EAA4B;AACpCub,qBAAW,GAAGzb,MAAM,CAACsb,cAAP,CAAsBpb,QAAtB,CAAd;AACH,SAFD;AAIA;;;;;;;AAKA,aAAK7lB,GAAL,GAAW,YAAY;AACnBohC,qBAAW,GAAG,IAAd;AACH,SAFD;;AAIA,aAAK8N,kBAAL,GAA0B,UAAUhoC,MAAV,EAAkB;AACxC,iBAAO8+C,WAAW,IAAI,IAAf,GAAsB,KAAK1tB,OAAL,CAAapxB,MAAb,CAAtB,GAA6C8+C,WAApD;AACH,SAFD;AAGH,OA1ED;;AA2EAt/B,SAAG,CAAC1G,MAAJ,CAAW6rB,GAAG,CAAC+D,cAAf,EAA+B/D,GAAG,CAACtf,MAAnC;;AAEA,UAAI25B,cAAc,GAAG,SAAjBA,cAAiB,CAAUvgC,MAAV,EAAkBrB,eAAlB,EAAmC4Q,SAAnC,EAA8C;AAC/D,eAAOvP,MAAM,CAACxmB,WAAP,KAAuB0sC,GAAG,CAACtf,MAA3B,GAAoC5G,MAApC,GAA6CrB,eAAe,CAACsc,UAAhB,CAA2Bjb,MAA3B,EAAmCuP,SAAnC,EAA8C5Q,eAA9C,CAApD;AACH,OAFD;AAIA;;;;;;;;;;;AASAunB,SAAG,CAAC3K,aAAJ,GAAoB,UAAUh6B,MAAV,EAAkB;AAClC2kC,WAAG,CAACtf,MAAJ,CAAW1zB,KAAX,CAAiB,IAAjB,EAAuB0F,SAAvB;;AAEA,aAAKy0C,SAAL,GAAiB,IAAjB;AACA,aAAKtgB,OAAL,GAAe,EAAf;AACA,aAAKwC,SAAL,GAAiBhuB,MAAM,CAACguB,SAAxB;AACA,aAAK5Q,eAAL,GAAuBpd,MAAM,CAACod,eAA9B;;AAEA,aAAK,IAAI9yB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG0V,MAAM,CAACwrB,OAAP,CAAexhC,MAAnC,EAA2CM,CAAC,EAA5C,EAAgD;AAC5C,eAAKkhC,OAAL,CAAalhC,CAAb,IAAkB00D,cAAc,CAACh/C,MAAM,CAACwrB,OAAP,CAAelhC,CAAf,CAAD,EAAoB,KAAK8yB,eAAzB,EAA0C,KAAK4Q,SAA/C,CAAhC;AACH;;AAED,aAAKixB,UAAL,GAAkB,YAAY;AAC1B,iBAAO,KAAKzzB,OAAZ;AACH,SAFD;;AAIA,YAAI0zB,UAAU,GAAG,KAAK1zB,OAAL,CAAaxhC,MAAb,GAAsB,CAAtB,GAA0B,KAAKwhC,OAAL,CAAa,CAAb,CAA1B,GAA4C,IAA7D;AAAA,YACI2zB,WAAW,GAAGD,UADlB;AAAA,YAEI59B,IAAI,GAAG,IAFX;AAAA,YAII;AACA89B,iBAAS,GAAG,SAAZA,SAAY,CAAU3gC,MAAV,EAAkB4gC,EAAlB,EAAsBC,EAAtB,EAA0BjuB,EAA1B,EAA8BC,EAA9B,EAAkC;AAC1C,cAAIiuB,EAAE,GAAGluB,EAAE,CAAC,CAAD,CAAF,GAAS5S,MAAM,CAAC/1B,CAAP,GAAW4oC,EAAE,CAAC,CAAD,CAA/B;AAAA,cAAqCkuB,EAAE,GAAGnuB,EAAE,CAAC,CAAD,CAAF,GAAS5S,MAAM,CAAC11B,CAAP,GAAWuoC,EAAE,CAAC,CAAD,CAAhE;AAAA,cACImuB,GAAG,GAAGpuB,EAAE,CAAC,CAAD,CAAF,GAASC,EAAE,CAAC,CAAD,CAAF,GAAQ,CAD3B;AAAA,cAC+BouB,GAAG,GAAGruB,EAAE,CAAC,CAAD,CAAF,GAASC,EAAE,CAAC,CAAD,CAAF,GAAQ,CADtD;AAEA,iBAAQ9oC,IAAI,CAACW,IAAL,CAAUX,IAAI,CAACgB,GAAL,CAAS61D,EAAE,GAAGE,EAAd,EAAkB,CAAlB,IAAuB/2D,IAAI,CAACgB,GAAL,CAAS81D,EAAE,GAAGE,EAAd,EAAkB,CAAlB,CAAjC,IACRh3D,IAAI,CAACW,IAAL,CAAUX,IAAI,CAACgB,GAAL,CAASi2D,GAAG,GAAGF,EAAf,EAAmB,CAAnB,IAAwB/2D,IAAI,CAACgB,GAAL,CAASk2D,GAAG,GAAGF,EAAf,EAAmB,CAAnB,CAAlC,CADA;AAEH,SAVL;AAAA,YAWI;AACA;AACA;AACA;AACA;AACA;AACA;AACAG,uBAAe,GAAG3/C,MAAM,CAACrI,QAAP,IAAmB,UAAU05B,EAAV,EAAcC,EAAd,EAAkB8a,GAAlB,EAAuBC,GAAvB,EAA4B7gB,OAA5B,EAAqC;AAClE,cAAI6zB,EAAE,GAAGjT,GAAG,CAAC,CAAD,CAAH,GAAUC,GAAG,CAAC,CAAD,CAAH,GAAS,CAA5B;AAAA,cAAgCiT,EAAE,GAAGlT,GAAG,CAAC,CAAD,CAAH,GAAUC,GAAG,CAAC,CAAD,CAAH,GAAS,CAAxD;AACA,cAAIuT,MAAM,GAAG,CAAC,CAAd;AAAA,cAAiBC,OAAO,GAAGlvD,QAA3B;;AACA,eAAK,IAAIrG,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGkhC,OAAO,CAACxhC,MAA5B,EAAoCM,CAAC,EAArC,EAAyC;AACrC,gBAAIQ,CAAC,GAAGs0D,SAAS,CAAC5zB,OAAO,CAAClhC,CAAD,CAAR,EAAa+0D,EAAb,EAAiBC,EAAjB,EAAqBjuB,EAArB,EAAyBC,EAAzB,CAAjB;;AACA,gBAAIxmC,CAAC,GAAG+0D,OAAR,EAAiB;AACbD,oBAAM,GAAGt1D,CAAC,GAAG,CAAb;AACAu1D,qBAAO,GAAG/0D,CAAV;AACH;AACJ;;AACD,iBAAO0gC,OAAO,CAACo0B,MAAD,CAAd;AACH,SA7BT;;AA+BA,aAAKxuB,OAAL,GAAe,UAAUpxB,MAAV,EAAkB;AAC7B,cAAIqxB,EAAE,GAAGrxB,MAAM,CAACqxB,EAAhB;AAAA,cAAoBC,EAAE,GAAGtxB,MAAM,CAACsxB,EAAhC;AAAA,cAAoC8a,GAAG,GAAGpsC,MAAM,CAACosC,GAAjD;AAAA,cAAsDC,GAAG,GAAGrsC,MAAM,CAACqsC,GAAnE;AAEA,eAAKjsB,SAAL,GAAiBpgB,MAAM,CAACogB,SAAxB;AAEA,cAAI0/B,GAAG,GAAGx+B,IAAI,CAACk9B,sBAAL,EAAV;;AACA,cAAIsB,GAAG,IAAI,IAAX,EAAiB;AACb,mBAAOA,GAAP;AACH,WAR4B,CAU7B;AACA;AACA;;;AACA,cAAI,KAAKnD,QAAL,MAAmBvQ,GAAG,IAAI,IAA1B,IAAkCC,GAAG,IAAI,IAA7C,EAAmD;AAC/C,mBAAO6S,UAAU,CAAC9tB,OAAX,CAAmBpxB,MAAnB,CAAP;AACH,WAFD,MAGK;AACDA,kBAAM,CAACogB,SAAP,GAAmB,IAAnB,CADC,CACwB;AAC5B;;AAED8+B,oBAAU,GAAGS,eAAe,CAACtuB,EAAD,EAAKC,EAAL,EAAS8a,GAAT,EAAcC,GAAd,EAAmB,KAAK7gB,OAAxB,CAA5B;AACA,eAAK9iC,CAAL,GAASw2D,UAAU,CAACx2D,CAApB;AACA,eAAKK,CAAL,GAASm2D,UAAU,CAACn2D,CAApB;;AAEA,cAAIm2D,UAAU,KAAKC,WAAnB,EAAgC;AAC5B,iBAAKtjC,IAAL,CAAU,eAAV,EAA2BqjC,UAA3B;AACH;;AAEDC,qBAAW,GAAGD,UAAd;AAEA,iBAAOA,UAAU,CAAC9tB,OAAX,CAAmBpxB,MAAnB,CAAP;AACH,SA/BD;;AAiCA,aAAKgoC,kBAAL,GAA0B,UAAUhoC,MAAV,EAAkB;AACxC,iBAAO,KAAKw+C,sBAAL,OAAkCU,UAAU,IAAI,IAAd,GAAqBA,UAAU,CAAClX,kBAAX,CAA8BhoC,MAA9B,CAArB,GAA6D,IAA/F,CAAP;AACH,SAFD;;AAIA,aAAK+5B,cAAL,GAAsB,UAAUglB,SAAV,EAAqB;AACvC,iBAAOG,UAAU,IAAI,IAAd,GAAqBA,UAAU,CAACnlB,cAAX,CAA0BglB,SAA1B,CAArB,GAA4D,CAAE,CAAF,EAAK,CAAL,CAAnE;AACH,SAFD;;AAGA,aAAK/hD,IAAL,GAAY,UAAUyhB,MAAV,EAAkBE,QAAlB,EAA4B;AACpC,cAAIugC,UAAU,IAAI,IAAlB,EAAwB;AACpBA,sBAAU,CAACliD,IAAX,CAAgByhB,MAAhB,EAAwBE,QAAxB;AACH;AACJ,SAJD;;AAKA,aAAK7lB,GAAL,GAAW,YAAY;AACnB,cAAIomD,UAAU,IAAI,IAAlB,EAAwB;AACpBA,sBAAU,CAACpmD,GAAX;AACH;AACJ,SAJD;;AAMA,aAAKu+B,SAAL,GAAiB,UAASvqC,CAAT,EAAY;AACzBoyD,oBAAU,GAAGpyD,CAAb;AACH,SAFD;;AAIA,aAAKg9C,WAAL,GAAmB,YAAY;AAC3B,iBAAQoV,UAAU,IAAIA,UAAU,CAACpV,WAAX,EAAf,IAA4C,EAAnD;AACH,SAFD;AAIA;;;;;;;AAKA,aAAKiW,oBAAL,GAA4B,UAASC,MAAT,EAAiB;AACzC,cAAIlhD,GAAG,GAAGmX,WAAW,CAACqC,gBAAZ,CAA6B,KAAKkT,OAAlC,EAA2C,UAAS1+B,CAAT,EAAY;AAC7D,mBAAOA,CAAC,CAACpE,CAAF,KAAQs3D,MAAM,CAAC,CAAD,CAAd,IAAqBlzD,CAAC,CAAC/D,CAAF,KAAQi3D,MAAM,CAAC,CAAD,CAA1C;AACH,WAFS,CAAV;;AAGA,cAAIlhD,GAAG,KAAK,CAAC,CAAb,EAAgB;AACZ,iBAAKu4B,SAAL,CAAe,KAAK7L,OAAL,CAAa1sB,GAAb,CAAf;AACA,mBAAO,IAAP;AACH,WAHD,MAGO;AACH,mBAAO,KAAP;AACH;AACJ,SAVD;AAWH,OA1HD;;AA2HA0gB,SAAG,CAAC1G,MAAJ,CAAW6rB,GAAG,CAAC3K,aAAf,EAA8B2K,GAAG,CAACtf,MAAlC,EA7iCS,CA+iCb;;;AACI,UAAI46B,YAAY,GAAG,SAAfA,YAAe,CAAUv3D,CAAV,EAAaK,CAAb,EAAgBs1D,EAAhB,EAAoBC,EAApB,EAAwB1hD,IAAxB,EAA8BsjD,MAA9B,EAAsC;AACrDvb,WAAG,CAACrf,OAAJ,CAAY1oB,IAAZ,IAAoB,UAAUoD,MAAV,EAAkB;AAClC,cAAIlT,CAAC,GAAGkT,MAAM,CAACod,eAAP,CAAuBsc,UAAvB,CAAkC,CAAEhxC,CAAF,EAAKK,CAAL,EAAQs1D,EAAR,EAAYC,EAAZ,EAAgB,CAAhB,EAAmB,CAAnB,CAAlC,EAA0Dt+C,MAAM,CAACguB,SAAjE,EAA4EhuB,MAAM,CAACod,eAAnF,CAAR;AACAtwB,WAAC,CAAC8P,IAAF,GAASA,IAAT;;AACA,cAAIsjD,MAAJ,EAAY;AACRA,kBAAM,CAACpzD,CAAD,EAAIkT,MAAJ,CAAN;AACH;;AACD,iBAAOlT,CAAP;AACH,SAPD;AAQH,OATD;;AAWAmzD,kBAAY,CAAC,GAAD,EAAM,CAAN,EAAS,CAAT,EAAY,CAAC,CAAb,EAAgB,WAAhB,CAAZ;;AACAA,kBAAY,CAAC,GAAD,EAAM,CAAN,EAAS,CAAT,EAAY,CAAZ,EAAe,cAAf,CAAZ;;AACAA,kBAAY,CAAC,CAAD,EAAI,GAAJ,EAAS,CAAC,CAAV,EAAa,CAAb,EAAgB,YAAhB,CAAZ;;AACAA,kBAAY,CAAC,CAAD,EAAI,GAAJ,EAAS,CAAT,EAAY,CAAZ,EAAe,aAAf,CAAZ;;AAEAA,kBAAY,CAAC,GAAD,EAAM,CAAN,EAAS,CAAT,EAAY,CAAC,CAAb,EAAgB,KAAhB,CAAZ;;AACAA,kBAAY,CAAC,GAAD,EAAM,CAAN,EAAS,CAAT,EAAY,CAAZ,EAAe,QAAf,CAAZ;;AACAA,kBAAY,CAAC,CAAD,EAAI,GAAJ,EAAS,CAAC,CAAV,EAAa,CAAb,EAAgB,MAAhB,CAAZ;;AACAA,kBAAY,CAAC,CAAD,EAAI,GAAJ,EAAS,CAAT,EAAY,CAAZ,EAAe,OAAf,CAAZ;;AACAA,kBAAY,CAAC,GAAD,EAAM,GAAN,EAAW,CAAX,EAAc,CAAd,EAAiB,QAAjB,CAAZ;;AACAA,kBAAY,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAC,CAAX,EAAc,UAAd,CAAZ;;AACAA,kBAAY,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,EAAa,aAAb,CAAZ;;AACAA,kBAAY,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAC,CAAX,EAAc,SAAd,CAAZ;;AACAA,kBAAY,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,EAAa,YAAb,CAAZ,CAxkCS,CA0kCb;AAEI;;;AACAtb,SAAG,CAAC9iB,QAAJ,CAAas+B,cAAb,GAA8B,UAAUngD,MAAV,EAAkB;AAC5C,eAAOA,MAAM,CAACod,eAAP,CAAuB+c,WAAvB,CAAmC,CAAC,WAAD,EAAc,aAAd,EAA6B,cAA7B,EAA6C,YAA7C,CAAnC,EAA+Fn6B,MAAM,CAACguB,SAAtG,EAAiHhuB,MAAM,CAACod,eAAxH,CAAP;AACH,OAFD,CA7kCS,CAilCT;;;AACAunB,SAAG,CAACrf,OAAJ,CAAY86B,WAAZ,GAA0B,UAAUpgD,MAAV,EAAkB;AACxC,YAAIlT,CAAC,GAAGkT,MAAM,CAACod,eAAP,CAAuBgd,iBAAvB,CAAyCuK,GAAG,CAAC9iB,QAAJ,CAAas+B,cAAb,CAA4BngD,MAA5B,CAAzC,CAAR;AACAlT,SAAC,CAAC8P,IAAF,GAAS,aAAT;AACA,eAAO9P,CAAP;AACH,OAJD,CAllCS,CAwlCb;;;AAEI,UAAIuzD,sBAAsB,GAAG,SAAzBA,sBAAyB,CAAUzjD,IAAV,EAAgBu+C,KAAhB,EAAuB;AAChDxW,WAAG,CAACrf,OAAJ,CAAY1oB,IAAZ,IAAoB,UAAUoD,MAAV,EAAkB;AAClC,cAAIlT,CAAC,GAAGkT,MAAM,CAACod,eAAP,CAAuBsc,UAAvB,CAAkC,CAAC,YAAD,EAAe;AAAEyhB,iBAAK,EAAEA;AAAT,WAAf,CAAlC,EAAoEn7C,MAAM,CAACguB,SAA3E,EAAsFhuB,MAAM,CAACod,eAA7F,CAAR;AACAtwB,WAAC,CAAC8P,IAAF,GAASA,IAAT;AACA,iBAAO9P,CAAP;AACH,SAJD;AAKH,OAND;;AAQA63C,SAAG,CAACrf,OAAJ,CAAYg7B,UAAZ,GAAyB,UAAUtgD,MAAV,EAAkB;AACvC,eAAOA,MAAM,CAACod,eAAP,CAAuB+sB,uBAAvB,CAA+CxT,GAA/C,CAAmD32B,MAAnD,CAAP;AACH,OAFD;;AAIAqgD,4BAAsB,CAAC,gBAAD,EAAmB,CAAC,MAAD,CAAnB,CAAtB;;AACAA,4BAAsB,CAAC,eAAD,EAAkB,CAAC,KAAD,CAAlB,CAAtB;;AACAA,4BAAsB,CAAC,kBAAD,EAAqB,CAAC,QAAD,CAArB,CAAtB;;AACAA,4BAAsB,CAAC,iBAAD,EAAoB,CAAC,OAAD,CAApB,CAAtB,CAzmCS,CA2mCb;AAEI;;;AACAJ,kBAAY,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,EAAa,QAAb,EAAuB,UAAUxhC,MAAV,EAAkBze,MAAlB,EAA0B;AACzD;AACA;AACA;AACA,YAAIugD,EAAE,GAAGvgD,MAAM,CAACsN,QAAP,IAAmB,OAA5B;AACAmR,cAAM,CAACgd,cAAP,GAAwB8kB,EAAE,CAACtoD,WAAH,KAAmBC,MAAnB,GAA4B8H,MAAM,CAACod,eAAP,CAAuBojC,qBAAvB,CAA6CD,EAA7C,CAA5B,GAA+EA,EAAvG,CALyD,CAMzD;AACA;;AACA9hC,cAAM,CAACsd,iBAAP,GAA2B/7B,MAA3B;AACH,OATW,CAAZ,CA9mCS,CAynCT;AACA;AACA;;;AACAzX,UAAI,CAAC60B,eAAL,CAAqBjpB,SAArB,CAA+BqsD,qBAA/B,GAAuD;AACnD,iBAAS,eAAUviC,EAAV,EAAcjB,EAAd,EAAkBq4B,EAAlB,EAAsB;AAC3B,iBAAO,CAAE,CAACp3B,EAAE,CAACpyB,IAAH,GAAUmxB,EAAE,CAACnxB,IAAd,IAAsBwpD,EAAE,CAAC,CAAD,CAA1B,EAA+B,CAACp3B,EAAE,CAACte,GAAH,GAASqd,EAAE,CAACrd,GAAb,IAAoB01C,EAAE,CAAC,CAAD,CAArD,CAAP;AACH,SAHkD;AAInD,gBAAQ,cAAUp3B,EAAV,EAAcjB,EAAd,EAAkBq4B,EAAlB,EAAsBr1C,MAAtB,EAA8B;AAClC,cAAItP,EAAE,GAAGutB,EAAE,CAACpyB,IAAH,GAAUmxB,EAAE,CAACnxB,IAAtB;AAAA,cAA4B4E,EAAE,GAAGwtB,EAAE,CAACte,GAAH,GAASqd,EAAE,CAACrd,GAA7C;AAAA,cACI8gD,EAAE,GAAGpL,EAAE,CAAC,CAAD,CAAF,GAASr1C,MAAM,CAAC0K,IAAP,CAAY,CAAZ,CADlB;AAAA,cACmCg2C,EAAE,GAAGrL,EAAE,CAAC,CAAD,CAAF,GAASr1C,MAAM,CAAC0K,IAAP,CAAY,CAAZ,CADjD;AAAA,cAEIi2C,EAAE,GAAGn4D,IAAI,CAACyhB,KAAL,CAAWvZ,EAAE,GAAG+vD,EAAhB,CAFT;AAAA,cAE8BG,EAAE,GAAGp4D,IAAI,CAACyhB,KAAL,CAAWxZ,EAAE,GAAGiwD,EAAhB,CAFnC;AAGA,iBAAO,CAAE,CAAEC,EAAE,GAAGF,EAAN,GAAaA,EAAE,GAAG,CAAnB,IAAyBpL,EAAE,CAAC,CAAD,CAA7B,EAAkC,CAAEuL,EAAE,GAAGF,EAAN,GAAaA,EAAE,GAAG,CAAnB,IAAyBrL,EAAE,CAAC,CAAD,CAA7D,CAAP;AACH;AATkD,OAAvD,CA5nCS,CAwoCb;;AAEI1Q,SAAG,CAACrf,OAAJ,CAAYu7B,SAAZ,GAAwB,UAAU7gD,MAAV,EAAkB;AACtCA,cAAM,GAAGA,MAAM,IAAI,EAAnB;AACA,YAAI8gD,WAAW,GAAG9gD,MAAM,CAAC8gD,WAAP,IAAsB,EAAxC;AAAA,YACIC,KAAK,GAAG/gD,MAAM,CAAC+gD,KADnB;;AAGA,YAAI,CAACA,KAAL,EAAY;AACR,gBAAM,IAAIC,KAAJ,CAAU,4CAAV,CAAN;AACH;;AAED,YAAIC,OAAO,GAAG,SAAVA,OAAU,GAAY;AAClB,cAAIxvD,CAAC,GAAG,GAAR;AAAA,cAAaqgC,IAAI,GAAGtpC,IAAI,CAACsK,EAAL,GAAU,CAAV,GAAcguD,WAAlC;AAAA,cAA+CjL,OAAO,GAAG,CAAzD;AAAA,cAA4D/oD,CAAC,GAAG,EAAhE;;AACA,eAAK,IAAIxC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGw2D,WAApB,EAAiCx2D,CAAC,EAAlC,EAAsC;AAClC,gBAAI5B,CAAC,GAAG+I,CAAC,GAAIA,CAAC,GAAGjJ,IAAI,CAACwI,GAAL,CAAS6kD,OAAT,CAAjB;AAAA,gBACI9sD,CAAC,GAAG0I,CAAC,GAAIA,CAAC,GAAGjJ,IAAI,CAACyI,GAAL,CAAS4kD,OAAT,CADjB;AAEA/oD,aAAC,CAACkC,IAAF,CAAO,CAAEtG,CAAF,EAAKK,CAAL,EAAQ,CAAR,EAAW,CAAX,CAAP;AACA8sD,mBAAO,IAAI/jB,IAAX;AACH;;AACD,iBAAOhlC,CAAP;AACH,SATL;AAAA,YAUIo0D,KAAK,GAAG,SAARA,KAAQ,CAAUC,QAAV,EAAoB;AACxB,cAAIC,cAAc,GAAGN,WAAW,GAAGK,QAAQ,CAACn3D,MAA5C;AAAA,cAAoD8C,CAAC,GAAG,EAAxD;AAAA,cACIu0D,YAAY,GAAG,SAAfA,YAAe,CAAUlwD,EAAV,EAAcC,EAAd,EAAkBC,EAAlB,EAAsBC,EAAtB,EAA0BgwD,gBAA1B,EAA4CjD,EAA5C,EAAgDC,EAAhD,EAAoD;AAC/D8C,0BAAc,GAAGN,WAAW,GAAGQ,gBAA/B;AACA,gBAAI5wD,EAAE,GAAG,CAACW,EAAE,GAAGF,EAAN,IAAYiwD,cAArB;AAAA,gBAAqC3wD,EAAE,GAAG,CAACa,EAAE,GAAGF,EAAN,IAAYgwD,cAAtD;;AACA,iBAAK,IAAI92D,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG82D,cAApB,EAAoC92D,CAAC,EAArC,EAAyC;AACrCwC,eAAC,CAACkC,IAAF,CAAO,CACHmC,EAAE,GAAIT,EAAE,GAAGpG,CADR,EAEH8G,EAAE,GAAIX,EAAE,GAAGnG,CAFR,EAGH+zD,EAAE,IAAI,IAAN,GAAa,CAAb,GAAiBA,EAHd,EAIHC,EAAE,IAAI,IAAN,GAAa,CAAb,GAAiBA,EAJd,CAAP;AAMH;AACJ,WAZL;;AAcA,eAAK,IAAIh0D,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG62D,QAAQ,CAACn3D,MAA7B,EAAqCM,CAAC,EAAtC,EAA0C;AACtC+2D,wBAAY,CAAC1vD,KAAb,CAAmB,IAAnB,EAAyBwvD,QAAQ,CAAC72D,CAAD,CAAjC;AACH;;AAED,iBAAOwC,CAAP;AACH,SA9BL;AAAA,YA+BIy0D,MAAM,GAAG,SAATA,MAAS,CAAUpG,KAAV,EAAiB;AACtB,cAAI9xD,CAAC,GAAG,EAAR;;AACA,eAAK,IAAIiB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG6wD,KAAK,CAACnxD,MAA1B,EAAkCM,CAAC,EAAnC,EAAuC;AACnCjB,aAAC,CAAC2F,IAAF,CAAO,CAACmsD,KAAK,CAAC7wD,CAAD,CAAL,CAAS,CAAT,CAAD,EAAc6wD,KAAK,CAAC7wD,CAAD,CAAL,CAAS,CAAT,CAAd,EAA2B6wD,KAAK,CAAC7wD,CAAD,CAAL,CAAS,CAAT,CAA3B,EAAwC6wD,KAAK,CAAC7wD,CAAD,CAAL,CAAS,CAAT,CAAxC,EAAqD,IAAI6wD,KAAK,CAACnxD,MAA/D,EAAuEmxD,KAAK,CAAC7wD,CAAD,CAAL,CAAS,CAAT,CAAvE,EAAoF6wD,KAAK,CAAC7wD,CAAD,CAAL,CAAS,CAAT,CAApF,CAAP;AACH;;AACD,iBAAO42D,KAAK,CAAC73D,CAAD,CAAZ;AACH,SArCL;AAAA,YAsCIm4D,UAAU,GAAG,SAAbA,UAAa,GAAY;AACrB,iBAAOD,MAAM,CAAC,CACV,CAAE,CAAF,EAAK,CAAL,EAAQ,CAAR,EAAW,CAAX,EAAc,CAAd,EAAiB,CAAC,CAAlB,CADU,EAEV,CAAE,CAAF,EAAK,CAAL,EAAQ,CAAR,EAAW,CAAX,EAAc,CAAd,EAAiB,CAAjB,CAFU,EAGV,CAAE,CAAF,EAAK,CAAL,EAAQ,CAAR,EAAW,CAAX,EAAc,CAAd,EAAiB,CAAjB,CAHU,EAIV,CAAE,CAAF,EAAK,CAAL,EAAQ,CAAR,EAAW,CAAX,EAAc,CAAC,CAAf,EAAkB,CAAlB,CAJU,CAAD,CAAb;AAMH,SA7CL;;AA+CA,YAAIE,OAAO,GAAG;AACN,oBAAUR,OADJ;AAEN,qBAAWA,OAFL;AAGN,qBAAW,mBAAY;AACnB,mBAAOM,MAAM,CAAC,CACV,CAAE,GAAF,EAAO,CAAP,EAAU,CAAV,EAAa,GAAb,CADU,EAEV,CAAE,CAAF,EAAK,GAAL,EAAU,GAAV,EAAe,CAAf,CAFU,EAGV,CAAE,GAAF,EAAO,CAAP,EAAU,CAAV,EAAa,GAAb,CAHU,EAIV,CAAE,CAAF,EAAK,GAAL,EAAU,GAAV,EAAe,CAAf,CAJU,CAAD,CAAb;AAMH,WAVK;AAWN,uBAAaC,UAXP;AAYN,oBAAUA,UAZJ;AAaN,sBAAY,oBAAY;AACpB,mBAAOD,MAAM,CAAC,CACV,CAAE,GAAF,EAAO,CAAP,EAAU,CAAV,EAAa,CAAb,CADU,EAEV,CAAE,CAAF,EAAK,CAAL,EAAQ,CAAR,EAAW,CAAX,CAFU,EAGV,CAAE,CAAF,EAAK,CAAL,EAAQ,GAAR,EAAa,CAAb,CAHU,CAAD,CAAb;AAKH,WAnBK;AAoBN,kBAAQ,cAAUvhD,MAAV,EAAkB;AACtB,gBAAI0hD,MAAM,GAAG1hD,MAAM,CAAC0hD,MAApB;AAAA,gBAA4B3yD,CAAC,GAAG,EAAhC;AAAA,gBAAoC4yD,EAAE,GAAG,CAAzC;;AACA,iBAAK,IAAIr3D,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGo3D,MAAM,CAAC13D,MAAP,GAAgB,CAApC,EAAuCM,CAAC,EAAxC,EAA4C;AACxC,kBAAI2O,CAAC,GAAGzQ,IAAI,CAACW,IAAL,CAAUX,IAAI,CAACgB,GAAL,CAASk4D,MAAM,CAACp3D,CAAD,CAAN,CAAU,CAAV,IAAeo3D,MAAM,CAACp3D,CAAD,CAAN,CAAU,CAAV,CAAxB,IAAwC9B,IAAI,CAACgB,GAAL,CAASk4D,MAAM,CAACp3D,CAAD,CAAN,CAAU,CAAV,IAAeo3D,MAAM,CAACp3D,CAAD,CAAN,CAAU,CAAV,CAAxB,CAAlD,CAAR;AACAq3D,gBAAE,IAAI1oD,CAAN;AACAlK,eAAC,CAACC,IAAF,CAAO,CAAC0yD,MAAM,CAACp3D,CAAD,CAAN,CAAU,CAAV,CAAD,EAAeo3D,MAAM,CAACp3D,CAAD,CAAN,CAAU,CAAV,CAAf,EAA6Bo3D,MAAM,CAACp3D,CAAC,GAAG,CAAL,CAAN,CAAc,CAAd,CAA7B,EAA+Co3D,MAAM,CAACp3D,CAAC,GAAG,CAAL,CAAN,CAAc,CAAd,CAA/C,EAAiE2O,CAAjE,CAAP;AACH;;AACD,iBAAK,IAAItN,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGoD,CAAC,CAAC/E,MAAtB,EAA8B2B,CAAC,EAA/B,EAAmC;AAC/BoD,eAAC,CAACpD,CAAD,CAAD,CAAK,CAAL,IAAUoD,CAAC,CAACpD,CAAD,CAAD,CAAK,CAAL,IAAUg2D,EAApB;AACH;;AACD,mBAAOT,KAAK,CAACnyD,CAAD,CAAZ;AACH;AA/BK,SAAd;AAAA,YAiCI6yD,OAAO,GAAG,SAAVA,OAAU,CAAUF,MAAV,EAAkBG,eAAlB,EAAmC;AACzC,cAAIruC,CAAC,GAAG,EAAR;AAAA,cAAYte,KAAK,GAAG2sD,eAAe,GAAG,GAAlB,GAAwBr5D,IAAI,CAACsK,EAAjD;;AACA,eAAK,IAAIxI,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGo3D,MAAM,CAAC13D,MAA3B,EAAmCM,CAAC,EAApC,EAAwC;AACpC,gBAAI6E,EAAE,GAAGuyD,MAAM,CAACp3D,CAAD,CAAN,CAAU,CAAV,IAAe,GAAxB;AAAA,gBACI8E,EAAE,GAAGsyD,MAAM,CAACp3D,CAAD,CAAN,CAAU,CAAV,IAAe,GADxB;;AAGAkpB,aAAC,CAACxkB,IAAF,CAAO,CACH,OAAQG,EAAE,GAAG3G,IAAI,CAACyI,GAAL,CAASiE,KAAT,CAAN,GAA0B9F,EAAE,GAAG5G,IAAI,CAACwI,GAAL,CAASkE,KAAT,CAAtC,CADG,EAEH,OAAQ/F,EAAE,GAAG3G,IAAI,CAACwI,GAAL,CAASkE,KAAT,CAAN,GAA0B9F,EAAE,GAAG5G,IAAI,CAACyI,GAAL,CAASiE,KAAT,CAAtC,CAFG,EAGHwsD,MAAM,CAACp3D,CAAD,CAAN,CAAU,CAAV,CAHG,EAIHo3D,MAAM,CAACp3D,CAAD,CAAN,CAAU,CAAV,CAJG,CAAP;AAMH;;AACD,iBAAOkpB,CAAP;AACH,SA/CL;;AAiDA,YAAI,CAACiuC,OAAO,CAACV,KAAD,CAAZ,EAAqB;AACjB,gBAAM,IAAIC,KAAJ,CAAU,YAAYD,KAAZ,GAAoB,uCAA9B,CAAN;AACH;;AAED,YAAIe,EAAE,GAAGL,OAAO,CAACV,KAAD,CAAP,CAAe/gD,MAAf,CAAT;;AACA,YAAIA,MAAM,CAAC+hD,QAAX,EAAqB;AACjBD,YAAE,GAAGF,OAAO,CAACE,EAAD,EAAK9hD,MAAM,CAAC+hD,QAAZ,CAAZ;AACH;;AACD,YAAIj1D,CAAC,GAAGkT,MAAM,CAACod,eAAP,CAAuBgd,iBAAvB,CAAyC0nB,EAAzC,CAAR;AACAh1D,SAAC,CAAC8P,IAAF,GAAS,WAAT;AACA,eAAO9P,CAAP;AACH,OApHD;AAqHH,KA/vCD,EA+vCGgH,IA/vCH,CA+vCQ,OAAOC,MAAP,KAAkB,WAAlB,GAAgCA,MAAhC,GAAyC,IA/vCjD;AAiwCA;;;;;;;;;;;;;AAaA;AACA,KAAC,YAAY;AAET;;AAEA,UAAIxL,IAAI,GAAG,IAAX;AAAA,UACIi3B,GAAG,GAAGj3B,IAAI,CAAC0tB,WADf;AAAA,UAEI0uB,GAAG,GAAGp8C,IAAI,CAACy3B,OAFf;;AAIA2kB,SAAG,CAAClL,aAAJ,GAAoB,UAASrc,eAAT,EAA0B;AAC1C,aAAKA,eAAL,GAAuBA,eAAvB;AACA,aAAKiN,aAAL,GAAqB,IAAIsa,GAAG,CAACqR,aAAR,CAAsB;AAAC54B,yBAAe,EAACA;AAAjB,SAAtB,CAArB;;AAEA,aAAKmW,qBAAL,GAA6B,UAAUumB,UAAV,EAAsBzY,KAAtB,EAA6Bze,UAA7B,EAAyCm3B,UAAzC,EAAqDC,WAArD,EAAkE;AAC3F,eAAK3vB,aAAL,CAAmBkJ,qBAAnB,CAAyCumB,UAAzC,EAAqDzY,KAArD,EAA4Dze,UAA5D,EAAwEm3B,UAAxE,EAAoFC,WAApF;AACH,SAFD;;AAIA,aAAKhlC,KAAL,GAAa,YAAW;AACpB,eAAKqV,aAAL,CAAmBrV,KAAnB;AACH,SAFD;;AAIA,aAAK2sB,QAAL,GAAgB,UAAUwB,KAAV,EAAiB9B,KAAjB,EAAwB;AACpC,eAAKhX,aAAL,CAAmBsX,QAAnB,CAA4BwB,KAA5B,EAAmC9B,KAAnC;AACH,SAFD;;AAIA,aAAKxsB,cAAL,GAAsB,UAAUmZ,SAAV,EAAqB;AACvC,eAAK3D,aAAL,CAAmBxV,cAAnB,CAAkCmZ,SAAlC;AACH,SAFD;;AAIA,aAAK/B,aAAL,GAAqB,UAAUhP,IAAV,EAAgB;AACjC,eAAKoN,aAAL,CAAmB4B,aAAnB,CAAiChP,IAAjC;AACH,SAFD;;AAIA,aAAKoX,kBAAL,GAA0B,UAAUskB,QAAV,EAAoBC,WAApB,EAAiC;AACvD,eAAKvuB,aAAL,CAAmBgK,kBAAnB,CAAsCskB,QAAtC,EAAgDC,WAAhD;AACH,SAFD;AAGH,OA3BD;AA+BH,KAvCD,EAuCG9kD,IAvCH,CAuCQ,OAAOC,MAAP,KAAkB,WAAlB,GAAgCA,MAAhC,GAAyC,IAvCjD;AA2CA;;;;;;;;;;;AAUA;AACA,KAAC,YAAY;AAET;;AACA,UAAIxL,IAAI,GAAG,IAAX;AAAA,UAAiBo8C,GAAG,GAAGp8C,IAAI,CAACy3B,OAA5B;AAAA,UAAqCR,GAAG,GAAGj3B,IAAI,CAAC0tB,WAAhD;AAAA,UAA6D+rC,GAAG,GAAGz5D,IAAI,CAACyL,OAAxE;AAEA2wC,SAAG,CAACsd,QAAJ,GAAe;AAEX;;;;;;;;;;AAUAC,uBAAe,EAAE,yBAAUliD,MAAV,EAAkB;AAC/B,eAAKA,MAAL,GAAcA,MAAd;AAEA;;;;;;;;;;AASA,eAAKmiD,sBAAL,GAA8B,UAAUz5D,CAAV,EAAaK,CAAb,EAAgB;AAC1C,mBAAO;AACH+B,eAAC,EAAE6F,QADA;AAEHjI,eAAC,EAAE,IAFA;AAGHK,eAAC,EAAE,IAHA;AAIHkQ,eAAC,EAAE;AAJA,aAAP;AAMH,WAPD;;AASA,eAAKmpD,SAAL,GAAiB,YAAY;AACzB,mBAAO;AACHvN,kBAAI,EAAErsD,IAAI,CAACkD,GAAL,CAASsU,MAAM,CAAC7O,EAAhB,EAAoB6O,MAAM,CAAC3O,EAA3B,CADH;AAEH0jD,kBAAI,EAAEvsD,IAAI,CAACkD,GAAL,CAASsU,MAAM,CAAC5O,EAAhB,EAAoB4O,MAAM,CAAC1O,EAA3B,CAFH;AAGH2jD,kBAAI,EAAEzsD,IAAI,CAACgD,GAAL,CAASwU,MAAM,CAAC7O,EAAhB,EAAoB6O,MAAM,CAAC3O,EAA3B,CAHH;AAIH8jD,kBAAI,EAAE3sD,IAAI,CAACgD,GAAL,CAASwU,MAAM,CAAC5O,EAAhB,EAAoB4O,MAAM,CAAC1O,EAA3B;AAJH,aAAP;AAMH,WAPD;AASA;;;;;;;;;;;AASA,eAAKmC,gBAAL,GAAwB,UAAStC,EAAT,EAAaC,EAAb,EAAiBC,EAAjB,EAAqBC,EAArB,EAAyB;AAC7C,mBAAO,EAAP;AACH,WAFD;AAIA;;;;;;;;;;;AASA,eAAKoC,eAAL,GAAuB,UAAShL,CAAT,EAAYK,CAAZ,EAAec,CAAf,EAAkBmI,CAAlB,EAAqB;AACxC,gBAAIlF,CAAC,GAAG,EAAR;AACAA,aAAC,CAACkC,IAAF,CAAO2C,KAAP,CAAa7E,CAAb,EAAgB,KAAK2G,gBAAL,CAAsB/K,CAAtB,EAAyBK,CAAzB,EAA4BL,CAAC,GAAGmB,CAAhC,EAAmCd,CAAnC,CAAhB;AACA+D,aAAC,CAACkC,IAAF,CAAO2C,KAAP,CAAa7E,CAAb,EAAgB,KAAK2G,gBAAL,CAAsB/K,CAAC,GAAGmB,CAA1B,EAA6Bd,CAA7B,EAAgCL,CAAC,GAAGmB,CAApC,EAAuCd,CAAC,GAAGiJ,CAA3C,CAAhB;AACAlF,aAAC,CAACkC,IAAF,CAAO2C,KAAP,CAAa7E,CAAb,EAAgB,KAAK2G,gBAAL,CAAsB/K,CAAC,GAAGmB,CAA1B,EAA6Bd,CAAC,GAAGiJ,CAAjC,EAAoCtJ,CAApC,EAAuCK,CAAC,GAAGiJ,CAA3C,CAAhB;AACAlF,aAAC,CAACkC,IAAF,CAAO2C,KAAP,CAAa7E,CAAb,EAAgB,KAAK2G,gBAAL,CAAsB/K,CAAtB,EAAyBK,CAAC,GAAGiJ,CAA7B,EAAgCtJ,CAAhC,EAAmCK,CAAnC,CAAhB;AACA,mBAAO+D,CAAP;AACH,WAPD;AASA;;;;;;;;AAMA,eAAK6G,uBAAL,GAA+B,UAAS+P,GAAT,EAAc;AACzC,mBAAO,KAAKhQ,eAAL,CAAqBgQ,GAAG,CAAChb,CAAzB,EAA4Bgb,GAAG,CAAC3a,CAAhC,EAAmC2a,GAAG,CAAC7Z,CAAvC,EAA0C6Z,GAAG,CAAC3a,CAA9C,CAAP;AACH,WAFD;AAGH,SAlFU;AAmFXs5D,gBAAQ,EAAE,kBAAUriD,MAAV,EAAkB;AACxB,cAAIsiD,MAAM,GAAG3d,GAAG,CAACsd,QAAJ,CAAaC,eAAb,CAA6BvwD,KAA7B,CAAmC,IAAnC,EAAyC0F,SAAzC,CAAb;AAAA,cACIrN,MADJ;AAAA,cACYqB,CADZ;AAAA,cACek3D,EADf;AAAA,cACmBpxD,EADnB;AAAA,cACuBE,EADvB;AAAA,cAC2BD,EAD3B;AAAA,cAC+BE,EAD/B;AAAA,cAEI4nC,OAAO,GAAG,SAAVA,OAAU,GAAY;AAClBlvC,kBAAM,GAAGxB,IAAI,CAACW,IAAL,CAAUX,IAAI,CAACgB,GAAL,CAAS6H,EAAE,GAAGF,EAAd,EAAkB,CAAlB,IAAuB3I,IAAI,CAACgB,GAAL,CAAS8H,EAAE,GAAGF,EAAd,EAAkB,CAAlB,CAAjC,CAAT;AACA/F,aAAC,GAAG22D,GAAG,CAACxtD,QAAJ,CAAa;AAAC9L,eAAC,EAAEyI,EAAJ;AAAQpI,eAAC,EAAEqI;AAAX,aAAb,EAA6B;AAAC1I,eAAC,EAAE2I,EAAJ;AAAQtI,eAAC,EAAEuI;AAAX,aAA7B,CAAJ;AACAixD,cAAE,GAAG,CAAC,CAAD,GAAKl3D,CAAV;AACH,WANL;;AAQA,eAAKuR,IAAL,GAAY,UAAZ;;AAEA,eAAKpJ,SAAL,GAAiB,YAAY;AACzB,mBAAOxJ,MAAP;AACH,WAFD;;AAGA,eAAKw4D,WAAL,GAAmB,YAAY;AAC3B,mBAAOn3D,CAAP;AACH,WAFD;;AAIA,eAAKo3D,cAAL,GAAsB,YAAY;AAC9B,mBAAO;AAAEtxD,gBAAE,EAAEA,EAAN;AAAUC,gBAAE,EAAEA,EAAd;AAAkBC,gBAAE,EAAEA,EAAtB;AAA0BC,gBAAE,EAAEA;AAA9B,aAAP;AACH,WAFD;;AAGA,eAAKoxD,cAAL,GAAsB,UAAU1C,MAAV,EAAkB;AACpC7uD,cAAE,GAAG6uD,MAAM,CAAC7uD,EAAZ;AACAC,cAAE,GAAG4uD,MAAM,CAAC5uD,EAAZ;AACAC,cAAE,GAAG2uD,MAAM,CAAC3uD,EAAZ;AACAC,cAAE,GAAG0uD,MAAM,CAAC1uD,EAAZ;;AACA4nC,mBAAO;AACV,WAND;;AAOA,eAAKwpB,cAAL,CAAoB;AAACvxD,cAAE,EAAE6O,MAAM,CAAC7O,EAAZ;AAAgBC,cAAE,EAAE4O,MAAM,CAAC5O,EAA3B;AAA+BC,cAAE,EAAE2O,MAAM,CAAC3O,EAA1C;AAA8CC,cAAE,EAAE0O,MAAM,CAAC1O;AAAzD,WAApB;;AAEA,eAAK8wD,SAAL,GAAiB,YAAY;AACzB,mBAAO;AACHvN,kBAAI,EAAErsD,IAAI,CAACkD,GAAL,CAASyF,EAAT,EAAaE,EAAb,CADH;AAEH0jD,kBAAI,EAAEvsD,IAAI,CAACkD,GAAL,CAAS0F,EAAT,EAAaE,EAAb,CAFH;AAGH2jD,kBAAI,EAAEzsD,IAAI,CAACgD,GAAL,CAAS2F,EAAT,EAAaE,EAAb,CAHH;AAIH8jD,kBAAI,EAAE3sD,IAAI,CAACgD,GAAL,CAAS4F,EAAT,EAAaE,EAAb;AAJH,aAAP;AAMH,WAPD;AASA;;;;;;AAIA,eAAKqxD,WAAL,GAAmB,UAAUl4D,QAAV,EAAoBm4D,QAApB,EAA8B;AAC7C,gBAAIn4D,QAAQ,KAAK,CAAb,IAAkB,CAACm4D,QAAvB,EAAiC;AAC7B,qBAAO;AAAEl6D,iBAAC,EAAEyI,EAAL;AAASpI,iBAAC,EAAEqI;AAAZ,eAAP;AACH,aAFD,MAGK,IAAI3G,QAAQ,KAAK,CAAb,IAAkB,CAACm4D,QAAvB,EAAiC;AAClC,qBAAO;AAAEl6D,iBAAC,EAAE2I,EAAL;AAAStI,iBAAC,EAAEuI;AAAZ,eAAP;AACH,aAFI,MAGA;AACD,kBAAI2H,CAAC,GAAG2pD,QAAQ,GAAGn4D,QAAQ,GAAG,CAAX,GAAeA,QAAf,GAA0BT,MAAM,GAAGS,QAAtC,GAAiDA,QAAQ,GAAGT,MAA5E;AACA,qBAAOg4D,GAAG,CAACjsD,WAAJ,CAAgB;AAACrN,iBAAC,EAAEyI,EAAJ;AAAQpI,iBAAC,EAAEqI;AAAX,eAAhB,EAAgC;AAAC1I,iBAAC,EAAE2I,EAAJ;AAAQtI,iBAAC,EAAEuI;AAAX,eAAhC,EAAgD2H,CAAhD,CAAP;AACH;AACJ,WAXD;AAaA;;;;;AAGA,eAAKhG,eAAL,GAAuB,UAAU4vD,CAAV,EAAa;AAChC,mBAAOx3D,CAAP;AACH,WAFD;AAIA;;;;;;;AAKA,eAAKy3D,kBAAL,GAA0B,UAAUr4D,QAAV,EAAoBC,QAApB,EAA8Bk4D,QAA9B,EAAwC;AAC9D,gBAAI7zD,CAAC,GAAG,KAAK4zD,WAAL,CAAiBl4D,QAAjB,EAA2Bm4D,QAA3B,CAAR;AAAA,gBACIG,YAAY,GAAGr4D,QAAQ,IAAI,CAAZ,GAAgB;AAAChC,eAAC,EAAEyI,EAAJ;AAAQpI,eAAC,EAAEqI;AAAX,aAAhB,GAAiC;AAAC1I,eAAC,EAAE2I,EAAJ;AAAQtI,eAAC,EAAEuI;AAAX,aADpD;AAGA;;;;;;;AAOA,gBAAI5G,QAAQ,IAAI,CAAZ,IAAiBlC,IAAI,CAACuH,GAAL,CAASrF,QAAT,IAAqB,CAA1C,EAA6C;AACzCA,sBAAQ,IAAI,CAAC,CAAb;AACH;;AAED,mBAAOs3D,GAAG,CAACjsD,WAAJ,CAAgBhH,CAAhB,EAAmBg0D,YAAnB,EAAiCr4D,QAAjC,CAAP;AACH,WAhBD,CApEwB,CAsFxB;;;AACA,cAAIs4D,MAAM,GAAG,SAATA,MAAS,CAAUl2D,CAAV,EAAaC,CAAb,EAAgBlC,CAAhB,EAAmB;AAC5B,mBAAOA,CAAC,IAAIrC,IAAI,CAACkD,GAAL,CAASoB,CAAT,EAAYC,CAAZ,CAAL,IAAuBlC,CAAC,IAAIrC,IAAI,CAACgD,GAAL,CAASsB,CAAT,EAAYC,CAAZ,CAAnC;AACH,WAFD,CAvFwB,CA0FxB;;;AACA,cAAIk2D,OAAO,GAAG,SAAVA,OAAU,CAAUn2D,CAAV,EAAaC,CAAb,EAAgBlC,CAAhB,EAAmB;AAC7B,mBAAOrC,IAAI,CAACuH,GAAL,CAASlF,CAAC,GAAGiC,CAAb,IAAkBtE,IAAI,CAACuH,GAAL,CAASlF,CAAC,GAAGkC,CAAb,CAAlB,GAAoCD,CAApC,GAAwCC,CAA/C;AACH,WAFD;AAIA;;;;;;;AAKA,eAAKo1D,sBAAL,GAA8B,UAAUz5D,CAAV,EAAaK,CAAb,EAAgB;AAC1C,gBAAI+P,GAAG,GAAG;AACNhO,eAAC,EAAE6F,QADG;AAENjI,eAAC,EAAE,IAFG;AAGNK,eAAC,EAAE,IAHG;AAINkQ,eAAC,EAAE,IAJG;AAKN9H,gBAAE,EAAEA,EALE;AAMNE,gBAAE,EAAEA,EANE;AAOND,gBAAE,EAAEA,EAPE;AAQNE,gBAAE,EAAEA;AARE,aAAV;;AAWA,gBAAIjG,CAAC,KAAK,CAAV,EAAa;AACTyN,iBAAG,CAAC/P,CAAJ,GAAQqI,EAAR;AACA0H,iBAAG,CAACpQ,CAAJ,GAAQs6D,MAAM,CAAC7xD,EAAD,EAAKE,EAAL,EAAS3I,CAAT,CAAN,GAAoBA,CAApB,GAAwBu6D,OAAO,CAAC9xD,EAAD,EAAKE,EAAL,EAAS3I,CAAT,CAAvC;AACH,aAHD,MAIK,IAAI2C,CAAC,KAAKsF,QAAN,IAAkBtF,CAAC,KAAK,CAACsF,QAA7B,EAAuC;AACxCmI,iBAAG,CAACpQ,CAAJ,GAAQyI,EAAR;AACA2H,iBAAG,CAAC/P,CAAJ,GAAQi6D,MAAM,CAAC5xD,EAAD,EAAKE,EAAL,EAASvI,CAAT,CAAN,GAAoBA,CAApB,GAAwBk6D,OAAO,CAAC7xD,EAAD,EAAKE,EAAL,EAASvI,CAAT,CAAvC;AACH,aAHI,MAIA;AACD;AACA,kBAAIgE,CAAC,GAAGqE,EAAE,GAAI/F,CAAC,GAAG8F,EAAlB;AAAA,kBACI7D,EAAE,GAAGvE,CAAC,GAAIw5D,EAAE,GAAG75D,CADnB;AAAA,kBAEA;AACA;AACA;AACA;AACIw6D,iBAAG,GAAG,CAAC51D,EAAE,GAAGP,CAAN,KAAY1B,CAAC,GAAGk3D,EAAhB,CANV;AAAA,kBAOIY,GAAG,GAAI93D,CAAC,GAAG63D,GAAL,GAAYn2D,CAPtB;;AASA+L,iBAAG,CAACpQ,CAAJ,GAAQs6D,MAAM,CAAC7xD,EAAD,EAAKE,EAAL,EAAS6xD,GAAT,CAAN,GAAsBA,GAAtB,GAA4BD,OAAO,CAAC9xD,EAAD,EAAKE,EAAL,EAAS6xD,GAAT,CAA3C,CAXC,CAWwD;;AACzDpqD,iBAAG,CAAC/P,CAAJ,GAAQi6D,MAAM,CAAC5xD,EAAD,EAAKE,EAAL,EAAS6xD,GAAT,CAAN,GAAsBA,GAAtB,GAA4BF,OAAO,CAAC7xD,EAAD,EAAKE,EAAL,EAAS6xD,GAAT,CAA3C,CAZC,CAYwD;AAC5D;;AAED,gBAAIC,iBAAiB,GAAGpB,GAAG,CAACltD,UAAJ,CAAe,CAAEgE,GAAG,CAACpQ,CAAN,EAASoQ,GAAG,CAAC/P,CAAb,CAAf,EAAiC,CAAEoI,EAAF,EAAMC,EAAN,CAAjC,CAAxB;;AACA0H,eAAG,CAAChO,CAAJ,GAAQk3D,GAAG,CAACltD,UAAJ,CAAe,CAACpM,CAAD,EAAIK,CAAJ,CAAf,EAAuB,CAAC+P,GAAG,CAACpQ,CAAL,EAAQoQ,GAAG,CAAC/P,CAAZ,CAAvB,CAAR;AACA+P,eAAG,CAACG,CAAJ,GAAQmqD,iBAAiB,GAAGp5D,MAA5B;AACA,mBAAO8O,GAAP;AACH,WAvCD;;AAyCA,cAAIuqD,iBAAiB,GAAG,SAApBA,iBAAoB,CAASlsC,CAAT,EAAY7nB,EAAZ,EAAgBC,EAAhB,EAAoB;AACxC,mBAAQA,EAAE,GAAGD,EAAN,GAAaA,EAAE,IAAI6nB,CAAN,IAAWA,CAAC,IAAI5nB,EAA7B,GAAoCD,EAAE,IAAI6nB,CAAN,IAAWA,CAAC,IAAI5nB,EAA3D;AACH,WAFD;AAAA,cAEG+zD,IAAI,GAAGD,iBAFV;AAIA;;;;;;;;;;AAQA,eAAK5vD,gBAAL,GAAwB,UAASyvD,GAAT,EAAcC,GAAd,EAAmBI,GAAnB,EAAwBC,GAAxB,EAA6B;AACjD,gBAAIjB,EAAE,GAAG/5D,IAAI,CAACuH,GAAL,CAASiyD,GAAG,CAACxtD,QAAJ,CAAa;AAAC9L,eAAC,EAAEw6D,GAAJ;AAASn6D,eAAC,EAAEo6D;AAAZ,aAAb,EAA+B;AAACz6D,eAAC,EAAE66D,GAAJ;AAASx6D,eAAC,EAAEy6D;AAAZ,aAA/B,CAAT,CAAT;AAAA,gBACIC,EAAE,GAAGj7D,IAAI,CAACuH,GAAL,CAAS1E,CAAT,CADT;AAAA,gBAEI0B,CAAC,GAAG02D,EAAE,KAAK9yD,QAAP,GAAkBQ,EAAlB,GAAuBC,EAAE,GAAIqyD,EAAE,GAAGtyD,EAF1C;AAAA,gBAGI2H,GAAG,GAAG,EAHV;AAAA,gBAIIxL,EAAE,GAAGi1D,EAAE,KAAK5xD,QAAP,GAAkBuyD,GAAlB,GAAwBC,GAAG,GAAIZ,EAAE,GAAGW,GAJ7C,CADiD,CAOjD;;AACA,gBAAKX,EAAE,KAAKkB,EAAZ,EAAgB;AACZ;AACA,kBAAGlB,EAAE,KAAK5xD,QAAP,IAAoB8yD,EAAE,KAAK,CAA9B,EAAiC;AAC7B,oBAAIH,IAAI,CAACJ,GAAD,EAAM/xD,EAAN,EAAUE,EAAV,CAAJ,IAAqBiyD,IAAI,CAAClyD,EAAD,EAAK+xD,GAAL,EAAUK,GAAV,CAA7B,EAA6C;AACzC1qD,qBAAG,GAAG,CAAEoqD,GAAF,EAAO9xD,EAAP,CAAN,CADyC,CACrB;AACvB;AACJ,eAJD,MAIO,IAAGmxD,EAAE,KAAK,CAAP,IAAYkB,EAAE,KAAK9yD,QAAtB,EAAgC;AACnC;AACA,oBAAG2yD,IAAI,CAACH,GAAD,EAAM/xD,EAAN,EAAUE,EAAV,CAAJ,IAAqBgyD,IAAI,CAACnyD,EAAD,EAAK+xD,GAAL,EAAUK,GAAV,CAA5B,EAA4C;AACxCzqD,qBAAG,GAAG,CAAC3H,EAAD,EAAKgyD,GAAL,CAAN,CADwC,CACtB;AACrB;AACJ,eALM,MAKA;AACH,oBAAIO,CAAJ,EAAOC,CAAP;;AACA,oBAAIpB,EAAE,KAAK5xD,QAAX,EAAqB;AACjB;AACA+yD,mBAAC,GAAGR,GAAJ;;AACA,sBAAII,IAAI,CAACI,CAAD,EAAIvyD,EAAJ,EAAQE,EAAR,CAAR,EAAqB;AACjBsyD,qBAAC,GAAIF,EAAE,GAAGP,GAAN,GAAan2D,CAAjB;;AACA,wBAAIu2D,IAAI,CAACK,CAAD,EAAIR,GAAJ,EAASK,GAAT,CAAR,EAAuB;AACnB1qD,yBAAG,GAAG,CAAE4qD,CAAF,EAAKC,CAAL,CAAN;AACH;AACJ;AACJ,iBATD,MASO,IAAIpB,EAAE,KAAK,CAAX,EAAc;AACjBoB,mBAAC,GAAGR,GAAJ,CADiB,CAEjB;;AACA,sBAAIG,IAAI,CAACK,CAAD,EAAIvyD,EAAJ,EAAQE,EAAR,CAAR,EAAqB;AACjBoyD,qBAAC,GAAG,CAACP,GAAG,GAAGp2D,CAAP,IAAY02D,EAAhB;;AACA,wBAAIH,IAAI,CAACI,CAAD,EAAIR,GAAJ,EAASK,GAAT,CAAR,EAAuB;AACnBzqD,yBAAG,GAAG,CAAE4qD,CAAF,EAAKC,CAAL,CAAN;AACH;AACJ;AACJ,iBATM,MASA;AACH;AACA;AACA;AACA;AACA;AACAD,mBAAC,GAAG,CAACp2D,EAAE,GAAGP,CAAN,KAAY02D,EAAE,GAAGlB,EAAjB,CAAJ;AACAoB,mBAAC,GAAIF,EAAE,GAAGC,CAAN,GAAW32D,CAAf;;AACA,sBAAGu2D,IAAI,CAACI,CAAD,EAAIvyD,EAAJ,EAAQE,EAAR,CAAJ,IAAmBiyD,IAAI,CAACK,CAAD,EAAIvyD,EAAJ,EAAQE,EAAR,CAA1B,EAAuC;AACnCwH,uBAAG,GAAG,CAAE4qD,CAAF,EAAMC,CAAN,CAAN;AACH;AACJ;AACJ;AACJ;;AAED,mBAAO7qD,GAAP;AACH,WAvDD;AAyDA;;;;;;;;;;;AASA,eAAKpF,eAAL,GAAuB,UAAShL,CAAT,EAAYK,CAAZ,EAAec,CAAf,EAAkBmI,CAAlB,EAAqB;AACxC,gBAAIlF,CAAC,GAAG,EAAR;AACAA,aAAC,CAACkC,IAAF,CAAO2C,KAAP,CAAa7E,CAAb,EAAgB,KAAK2G,gBAAL,CAAsB/K,CAAtB,EAAyBK,CAAzB,EAA4BL,CAAC,GAAGmB,CAAhC,EAAmCd,CAAnC,CAAhB;AACA+D,aAAC,CAACkC,IAAF,CAAO2C,KAAP,CAAa7E,CAAb,EAAgB,KAAK2G,gBAAL,CAAsB/K,CAAC,GAAGmB,CAA1B,EAA6Bd,CAA7B,EAAgCL,CAAC,GAAGmB,CAApC,EAAuCd,CAAC,GAAGiJ,CAA3C,CAAhB;AACAlF,aAAC,CAACkC,IAAF,CAAO2C,KAAP,CAAa7E,CAAb,EAAgB,KAAK2G,gBAAL,CAAsB/K,CAAC,GAAGmB,CAA1B,EAA6Bd,CAAC,GAAGiJ,CAAjC,EAAoCtJ,CAApC,EAAuCK,CAAC,GAAGiJ,CAA3C,CAAhB;AACAlF,aAAC,CAACkC,IAAF,CAAO2C,KAAP,CAAa7E,CAAb,EAAgB,KAAK2G,gBAAL,CAAsB/K,CAAtB,EAAyBK,CAAC,GAAGiJ,CAA7B,EAAgCtJ,CAAhC,EAAmCK,CAAnC,CAAhB;AACA,mBAAO+D,CAAP;AACH,WAPD;AASA;;;;;;;;AAMA,eAAK6G,uBAAL,GAA+B,UAAS+P,GAAT,EAAc;AACzC,mBAAO,KAAKhQ,eAAL,CAAqBgQ,GAAG,CAAChb,CAAzB,EAA4Bgb,GAAG,CAAC3a,CAAhC,EAAmC2a,GAAG,CAAC7Z,CAAvC,EAA0C6Z,GAAG,CAAC1R,CAA9C,CAAP;AACH,WAFD;AAGH,SAhUU;;AAkUX;;;;;;;;;;;;;;;AAqBA4xD,WAAG,EAAE,aAAU5jD,MAAV,EAAkB;AACnB,cAAIsiD,MAAM,GAAG3d,GAAG,CAACsd,QAAJ,CAAaC,eAAb,CAA6BvwD,KAA7B,CAAmC,IAAnC,EAAyC0F,SAAzC,CAAb;AAAA,cACIwsD,UAAU,GAAG,SAAbA,UAAa,CAAU10D,EAAV,EAAcC,EAAd,EAAkB;AAC3B,mBAAO4yD,GAAG,CAAC9sD,KAAJ,CAAU,CAAC8K,MAAM,CAACq/C,EAAR,EAAYr/C,MAAM,CAACs/C,EAAnB,CAAV,EAAkC,CAACnwD,EAAD,EAAKC,EAAL,CAAlC,CAAP;AACH,WAHL;AAAA,cAII00D,qBAAqB,GAAG,SAAxBA,qBAAwB,CAAUC,OAAV,EAAmBt5D,QAAnB,EAA6B;AACjD,gBAAIs5D,OAAO,CAACC,aAAZ,EAA2B;AACvB,kBAAIC,EAAE,GAAGF,OAAO,CAACG,UAAR,GAAqBH,OAAO,CAACI,QAA7B,GAAwCJ,OAAO,CAACG,UAAR,GAAqBE,MAA7D,GAAsEL,OAAO,CAACG,UAAvF;AAAA,kBACI76D,CAAC,GAAGb,IAAI,CAACuH,GAAL,CAASk0D,EAAE,GAAGF,OAAO,CAACI,QAAtB,CADR;AAEA,qBAAOF,EAAE,GAAI56D,CAAC,GAAGoB,QAAjB;AACH,aAJD,MAKK;AACD,kBAAI45D,EAAE,GAAGN,OAAO,CAACI,QAAR,GAAmBJ,OAAO,CAACG,UAA3B,GAAwCH,OAAO,CAACI,QAAR,GAAmBC,MAA3D,GAAoEL,OAAO,CAACI,QAArF;AAAA,kBACI/tB,EAAE,GAAG5tC,IAAI,CAACuH,GAAL,CAASs0D,EAAE,GAAGN,OAAO,CAACG,UAAtB,CADT;AAGA,qBAAOH,OAAO,CAACG,UAAR,GAAsB9tB,EAAE,GAAG3rC,QAAlC;AACH;AACJ,WAhBL;AAAA,cAiBI25D,MAAM,GAAG,IAAI57D,IAAI,CAACsK,EAjBtB;;AAmBA,eAAKwxD,MAAL,GAActkD,MAAM,CAACvO,CAArB;AACA,eAAKuyD,aAAL,GAAqBhkD,MAAM,CAACukD,EAA5B;AACA,eAAK3nD,IAAL,GAAY,KAAZ;;AAEA,cAAIoD,MAAM,CAACkkD,UAAP,IAAqBlkD,MAAM,CAACmkD,QAAhC,EAA0C;AACtC,iBAAKD,UAAL,GAAkBlkD,MAAM,CAACkkD,UAAzB;AACA,iBAAKC,QAAL,GAAgBnkD,MAAM,CAACmkD,QAAvB;AACA,iBAAKhzD,EAAL,GAAU6O,MAAM,CAACq/C,EAAP,GAAa,KAAKiF,MAAL,GAAc97D,IAAI,CAACyI,GAAL,CAAS+O,MAAM,CAACkkD,UAAhB,CAArC;AACA,iBAAK9yD,EAAL,GAAU4O,MAAM,CAACs/C,EAAP,GAAa,KAAKgF,MAAL,GAAc97D,IAAI,CAACwI,GAAL,CAASgP,MAAM,CAACkkD,UAAhB,CAArC;AACA,iBAAK7yD,EAAL,GAAU2O,MAAM,CAACq/C,EAAP,GAAa,KAAKiF,MAAL,GAAc97D,IAAI,CAACyI,GAAL,CAAS+O,MAAM,CAACmkD,QAAhB,CAArC;AACA,iBAAK7yD,EAAL,GAAU0O,MAAM,CAACs/C,EAAP,GAAa,KAAKgF,MAAL,GAAc97D,IAAI,CAACwI,GAAL,CAASgP,MAAM,CAACmkD,QAAhB,CAArC;AACH,WAPD,MAQK;AACD,iBAAKD,UAAL,GAAkBL,UAAU,CAAC7jD,MAAM,CAAC7O,EAAR,EAAY6O,MAAM,CAAC5O,EAAnB,CAA5B;AACA,iBAAK+yD,QAAL,GAAgBN,UAAU,CAAC7jD,MAAM,CAAC3O,EAAR,EAAY2O,MAAM,CAAC1O,EAAnB,CAA1B;AACA,iBAAKH,EAAL,GAAU6O,MAAM,CAAC7O,EAAjB;AACA,iBAAKC,EAAL,GAAU4O,MAAM,CAAC5O,EAAjB;AACA,iBAAKC,EAAL,GAAU2O,MAAM,CAAC3O,EAAjB;AACA,iBAAKC,EAAL,GAAU0O,MAAM,CAAC1O,EAAjB;AACH;;AAED,cAAI,KAAK6yD,QAAL,GAAgB,CAApB,EAAuB;AACnB,iBAAKA,QAAL,IAAiBC,MAAjB;AACH;;AACD,cAAI,KAAKF,UAAL,GAAkB,CAAtB,EAAyB;AACrB,iBAAKA,UAAL,IAAmBE,MAAnB;AACH,WA9CkB,CAgDnB;AACA;AAEA;AACA;AACA;;;AAEA,cAAIC,EAAE,GAAG,KAAKF,QAAL,GAAgB,KAAKD,UAArB,GAAkC,KAAKC,QAAL,GAAgBC,MAAlD,GAA2D,KAAKD,QAAzE;AACA,eAAKK,KAAL,GAAah8D,IAAI,CAACuH,GAAL,CAASs0D,EAAE,GAAG,KAAKH,UAAnB,CAAb;;AACA,cAAI,KAAKF,aAAT,EAAwB;AACpB,iBAAKQ,KAAL,GAAaJ,MAAM,GAAG,KAAKI,KAA3B;AACH;;AACD,cAAIC,aAAa,GAAG,IAAIj8D,IAAI,CAACsK,EAAT,GAAc,KAAKwxD,MAAvC;AAAA,cACII,IAAI,GAAG,KAAKF,KAAL,GAAaJ,MADxB;AAAA,cAEIp6D,MAAM,GAAGy6D,aAAa,GAAGC,IAF7B;;AAIA,eAAKlxD,SAAL,GAAiB,YAAY;AACzB,mBAAOxJ,MAAP;AACH,WAFD;;AAIA,eAAKo4D,SAAL,GAAiB,YAAY;AACzB,mBAAO;AACHvN,kBAAI,EAAE70C,MAAM,CAACq/C,EAAP,GAAYr/C,MAAM,CAACvO,CADtB;AAEHwjD,kBAAI,EAAEj1C,MAAM,CAACq/C,EAAP,GAAYr/C,MAAM,CAACvO,CAFtB;AAGHsjD,kBAAI,EAAE/0C,MAAM,CAACs/C,EAAP,GAAYt/C,MAAM,CAACvO,CAHtB;AAIH0jD,kBAAI,EAAEn1C,MAAM,CAACs/C,EAAP,GAAYt/C,MAAM,CAACvO;AAJtB,aAAP;AAMH,WAPD;;AASA,cAAIkzD,gBAAgB,GAAG,YAAvB;AAAA,cACIC,WAAW,GAAG,SAAdA,WAAc,CAAUx5D,CAAV,EAAa;AACvB,gBAAImY,CAAC,GAAG/a,IAAI,CAACyhB,KAAL,CAAW7e,CAAX,CAAR;AAAA,gBAAuBqG,CAAC,GAAGjJ,IAAI,CAACq8D,IAAL,CAAUz5D,CAAV,CAA3B;;AACA,gBAAIA,CAAC,GAAGmY,CAAJ,GAAQohD,gBAAZ,EAA8B;AAC1B,qBAAOphD,CAAP;AACH,aAFD,MAGK,IAAI9R,CAAC,GAAGrG,CAAJ,GAAQu5D,gBAAZ,EAA8B;AAC/B,qBAAOlzD,CAAP;AACH;;AACD,mBAAOrG,CAAP;AACH,WAVL;AAYA;;;;;;AAIA,eAAKu3D,WAAL,GAAmB,UAAUl4D,QAAV,EAAoBm4D,QAApB,EAA8B;AAE7C,gBAAIn4D,QAAQ,KAAK,CAAjB,EAAoB;AAChB,qBAAO;AAAE/B,iBAAC,EAAE,KAAKyI,EAAV;AAAcpI,iBAAC,EAAE,KAAKqI,EAAtB;AAA0B8D,qBAAK,EAAE,KAAKgvD;AAAtC,eAAP;AACH,aAFD,MAGK,IAAIz5D,QAAQ,KAAK,CAAjB,EAAoB;AACrB,qBAAO;AAAE/B,iBAAC,EAAE,KAAK2I,EAAV;AAActI,iBAAC,EAAE,KAAKuI,EAAtB;AAA0B4D,qBAAK,EAAE,KAAKivD;AAAtC,eAAP;AACH;;AAED,gBAAIvB,QAAJ,EAAc;AACVn4D,sBAAQ,GAAGA,QAAQ,GAAGT,MAAtB;AACH;;AAED,gBAAI86D,KAAK,GAAGhB,qBAAqB,CAAC,IAAD,EAAOr5D,QAAP,CAAjC;AAAA,gBACI0E,EAAE,GAAG6Q,MAAM,CAACq/C,EAAP,GAAar/C,MAAM,CAACvO,CAAP,GAAWjJ,IAAI,CAACyI,GAAL,CAAS6zD,KAAT,CADjC;AAAA,gBAEI11D,EAAE,GAAG4Q,MAAM,CAACs/C,EAAP,GAAat/C,MAAM,CAACvO,CAAP,GAAWjJ,IAAI,CAACwI,GAAL,CAAS8zD,KAAT,CAFjC;;AAIA,mBAAO;AAAEp8D,eAAC,EAAEk8D,WAAW,CAACz1D,EAAD,CAAhB;AAAsBpG,eAAC,EAAE67D,WAAW,CAACx1D,EAAD,CAApC;AAA0C8F,mBAAK,EAAE4vD;AAAjD,aAAP;AACH,WAlBD;AAoBA;;;;;AAGA,eAAK7xD,eAAL,GAAuB,UAAUxI,QAAV,EAAoBm4D,QAApB,EAA8B;AACjD,gBAAI7zD,CAAC,GAAG,KAAK4zD,WAAL,CAAiBl4D,QAAjB,EAA2Bm4D,QAA3B,CAAR;;AACA,gBAAIv3D,CAAC,GAAG22D,GAAG,CAACptD,MAAJ,CAAW,CAAEoL,MAAM,CAACq/C,EAAT,EAAar/C,MAAM,CAACs/C,EAApB,CAAX,EAAqC,CAACvwD,CAAC,CAACrG,CAAH,EAAMqG,CAAC,CAAChG,CAAR,CAArC,CAAR;;AACA,gBAAI,CAAC,KAAKi7D,aAAN,KAAwB34D,CAAC,KAAKsF,QAAN,IAAkBtF,CAAC,KAAK,CAACsF,QAAjD,CAAJ,EAAgE;AAC5DtF,eAAC,IAAI,CAAC,CAAN;AACH;;AACD,mBAAOA,CAAP;AACH,WAPD;;AASA,eAAKy3D,kBAAL,GAA0B,UAAUr4D,QAAV,EAAoBC,QAApB,EAA8Bk4D,QAA9B,EAAwC;AAC9D,gBAAI7zD,CAAC,GAAG,KAAK4zD,WAAL,CAAiBl4D,QAAjB,EAA2Bm4D,QAA3B,CAAR;AAAA,gBACImC,OAAO,GAAGr6D,QAAQ,GAAG+5D,aAAX,GAA2B,CAA3B,GAA+Bj8D,IAAI,CAACsK,EADlD;AAAA,gBAEIkyD,GAAG,GAAG,KAAKhB,aAAL,GAAqB,CAAC,CAAtB,GAA0B,CAFpC;AAAA,gBAGIE,UAAU,GAAGn1D,CAAC,CAACmG,KAAF,GAAW8vD,GAAG,GAAGD,OAHlC;AAAA,gBAIIE,MAAM,GAAGjlD,MAAM,CAACq/C,EAAP,GAAa,KAAKiF,MAAL,GAAc97D,IAAI,CAACyI,GAAL,CAASizD,UAAT,CAJxC;AAAA,gBAKIgB,MAAM,GAAGllD,MAAM,CAACs/C,EAAP,GAAa,KAAKgF,MAAL,GAAc97D,IAAI,CAACwI,GAAL,CAASkzD,UAAT,CALxC;AAOA,mBAAO;AAACx7D,eAAC,EAAEu8D,MAAJ;AAAYl8D,eAAC,EAAEm8D;AAAf,aAAP;AACH,WATD,CA7HmB,CAwInB;;AACH,SAheU;AAkeXC,cAAM,EAAE,gBAAUnlD,MAAV,EAAkB;AACtB,eAAKrW,KAAL,GAAa,CACT;AAAEjB,aAAC,EAAEsX,MAAM,CAAC7O,EAAZ;AAAgBpI,aAAC,EAAEiX,MAAM,CAAC5O;AAA1B,WADS,EAET;AAAE1I,aAAC,EAAEsX,MAAM,CAAColD,IAAZ;AAAkBr8D,aAAC,EAAEiX,MAAM,CAACqlD;AAA5B,WAFS,EAGT;AAAE38D,aAAC,EAAEsX,MAAM,CAACslD,IAAZ;AAAkBv8D,aAAC,EAAEiX,MAAM,CAACulD;AAA5B,WAHS,EAIT;AAAE78D,aAAC,EAAEsX,MAAM,CAAC3O,EAAZ;AAAgBtI,aAAC,EAAEiX,MAAM,CAAC1O;AAA1B,WAJS,CAAb;;AAOA,cAAI9B,QAAQ,GAAG,SAAXA,QAAW,CAAS3E,CAAT,EAAY;AACvB,mBAAOA,CAAC,CAAC,CAAD,CAAD,CAAKnC,CAAL,KAAWmC,CAAC,CAAC,CAAD,CAAD,CAAKnC,CAAhB,IAAqBmC,CAAC,CAAC,CAAD,CAAD,CAAK9B,CAAL,KAAW8B,CAAC,CAAC,CAAD,CAAD,CAAK9B,CAA5C;AACH,WAFD;;AAIA,cAAIsG,KAAK,GAAG,SAARA,KAAQ,CAASC,EAAT,EAAaC,EAAb,EAAkB;AAC1B,mBAAO/G,IAAI,CAACW,IAAL,CAAUX,IAAI,CAACgB,GAAL,CAAS8F,EAAE,CAAC5G,CAAH,GAAO6G,EAAE,CAAC7G,CAAnB,EAAsB,CAAtB,IAA2BF,IAAI,CAACgB,GAAL,CAAS8F,EAAE,CAACvG,CAAH,GAAOwG,EAAE,CAACxG,CAAnB,EAAsB,CAAtB,CAArC,CAAP;AACH,WAFD;;AAIA,cAAIy8D,QAAQ,GAAG,UAASrf,GAAT,EAAc;AAEzB,gBAAIsf,WAAW,GAAI;AAAC/8D,eAAC,EAAC,CAAH;AAAMK,eAAC,EAAC;AAAR,aAAnB;;AAEA,gBAAIo9C,GAAG,KAAK,CAAZ,EAAe;AACX,qBAAO,KAAKx8C,KAAL,CAAW,CAAX,CAAP;AACH;;AAED,gBAAII,MAAM,GAAG,KAAKJ,KAAL,CAAWK,MAAX,GAAoB,CAAjC;;AAEA,gBAAIm8C,GAAG,KAAK,CAAZ,EAAe;AACX,qBAAO,KAAKx8C,KAAL,CAAWI,MAAX,CAAP;AACH;;AAED,gBAAIypB,CAAC,GAAG,KAAK7pB,KAAb;AACA,gBAAIN,CAAC,GAAG,IAAI88C,GAAZ;;AAEA,gBAAIp8C,MAAM,KAAK,CAAf,EAAkB;AACd,qBAAO,KAAKJ,KAAL,CAAW,CAAX,CAAP;AACH;;AAED,gBAAII,MAAM,KAAK,CAAf,EAAkB;AACd,qBAAO;AACHrB,iBAAC,EAAEW,CAAC,GAAGmqB,CAAC,CAAC,CAAD,CAAD,CAAK9qB,CAAT,GAAay9C,GAAG,GAAG3yB,CAAC,CAAC,CAAD,CAAD,CAAK9qB,CADxB;AAEHK,iBAAC,EAAEM,CAAC,GAAGmqB,CAAC,CAAC,CAAD,CAAD,CAAKzqB,CAAT,GAAao9C,GAAG,GAAG3yB,CAAC,CAAC,CAAD,CAAD,CAAKzqB;AAFxB,eAAP;AAIH;;AAED,gBAAIgB,MAAM,GAAG,CAAb,EAAgB;AAEZ,kBAAIkP,CAAC,GAAG5P,CAAC,GAAGA,CAAZ;AAAA,kBAAe2I,CAAC,GAAGm0C,GAAG,GAAGA,GAAzB;AAAA,kBAA8BsP,CAAC,GAAG,CAAlC;AAAA,kBAAqCpqD,CAArC;AAAA,kBAAwCiO,CAAxC;AAAA,kBAA2CiK,CAA3C;;AAEA,kBAAIxZ,MAAM,KAAK,CAAf,EAAkB;AACdypB,iBAAC,GAAG,CAACA,CAAC,CAAC,CAAD,CAAF,EAAOA,CAAC,CAAC,CAAD,CAAR,EAAaA,CAAC,CAAC,CAAD,CAAd,EAAmBiyC,WAAnB,CAAJ;AACAp6D,iBAAC,GAAG4N,CAAJ;AACAK,iBAAC,GAAG,KAAKjQ,CAAC,GAAG88C,GAAT,CAAJ;AACA5iC,iBAAC,GAAGvR,CAAJ;AACH,eALD,MAKO,IAAIjI,MAAM,KAAK,CAAf,EAAkB;AACrBsB,iBAAC,GAAG4N,CAAC,GAAG5P,CAAR;AACAiQ,iBAAC,GAAG,KAAKL,CAAC,GAAGktC,GAAT,CAAJ;AACA5iC,iBAAC,GAAG,KAAKla,CAAC,GAAG2I,CAAT,CAAJ;AACAyjD,iBAAC,GAAGtP,GAAG,GAAGn0C,CAAV;AACH;;AAED,qBAAO;AACHtJ,iBAAC,EAAE2C,CAAC,GAAGmoB,CAAC,CAAC,CAAD,CAAD,CAAK9qB,CAAT,GAAa4Q,CAAC,GAAGka,CAAC,CAAC,CAAD,CAAD,CAAK9qB,CAAtB,GAA0B6a,CAAC,GAAGiQ,CAAC,CAAC,CAAD,CAAD,CAAK9qB,CAAnC,GAAuC+sD,CAAC,GAAGjiC,CAAC,CAAC,CAAD,CAAD,CAAK9qB,CADhD;AAEHK,iBAAC,EAAEsC,CAAC,GAAGmoB,CAAC,CAAC,CAAD,CAAD,CAAKzqB,CAAT,GAAauQ,CAAC,GAAGka,CAAC,CAAC,CAAD,CAAD,CAAKzqB,CAAtB,GAA0Bwa,CAAC,GAAGiQ,CAAC,CAAC,CAAD,CAAD,CAAKzqB,CAAnC,GAAuC0sD,CAAC,GAAGjiC,CAAC,CAAC,CAAD,CAAD,CAAKzqB;AAFhD,eAAP;AAIH,aApBD,MAoBO;AACH,qBAAO08D,WAAP,CADG,CACiB;AACvB;AACJ,WAnDc,CAmDbj6C,IAnDa,CAmDR,IAnDQ,CAAf;;AAqDA,cAAIk6C,OAAO,GAAG,SAAVA,OAAU,CAASC,KAAT,EAAgB;AAC1B,gBAAI7sD,GAAG,GAAG,EAAV;AACA6sD,iBAAK;;AACL,iBAAK,IAAIv6D,CAAC,GAAG,CAAb,EAAgBA,CAAC,IAAIu6D,KAArB,EAA4Bv6D,CAAC,EAA7B,EAAiC;AAC7B0N,iBAAG,CAAC9J,IAAJ,CAASw2D,QAAQ,CAACp6D,CAAC,GAAGu6D,KAAL,CAAjB;AACH;;AACD,mBAAO7sD,GAAP;AACH,WAPD;;AASA,cAAI8sD,cAAc,GAAG,YAAW;AAE5B,gBAAIp2D,QAAQ,CAAC,KAAK7F,KAAN,CAAZ,EAA0B;AACtB,mBAAKK,MAAL,GAAc,CAAd;AACH;;AAED,gBAAI27D,KAAK,GAAG,EAAZ;;AACA,gBAAKnsC,GAAG,GAAGksC,OAAO,CAACC,KAAD,CAAlB;;AACA,iBAAK37D,MAAL,GAAc,CAAd;;AAEA,iBAAK,IAAIM,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGq7D,KAAK,GAAG,CAA5B,EAA+Br7D,CAAC,EAAhC,EAAoC;AAChC,kBAAIwC,CAAC,GAAG0sB,GAAG,CAAClvB,CAAD,CAAX;AAAA,kBAAgByC,CAAC,GAAGysB,GAAG,CAAClvB,CAAC,GAAG,CAAL,CAAvB;AACA,mBAAKN,MAAL,IAAeqF,KAAK,CAACvC,CAAD,EAAIC,CAAJ,CAApB;AACH;AACJ,WAdoB,CAcnBye,IAdmB,CAcd,IAdc,CAArB;;AAgBA,cAAI82C,MAAM,GAAG3d,GAAG,CAACsd,QAAJ,CAAaC,eAAb,CAA6BvwD,KAA7B,CAAmC,IAAnC,EAAyC0F,SAAzC,CAAb,CA9FsB,CA+FtB;AACA;AACA;;;AACA,eAAKu9C,MAAL,GAAc;AACVC,gBAAI,EAAErsD,IAAI,CAACkD,GAAL,CAASsU,MAAM,CAAC7O,EAAhB,EAAoB6O,MAAM,CAAC3O,EAA3B,EAA+B2O,MAAM,CAAColD,IAAtC,EAA4CplD,MAAM,CAACslD,IAAnD,CADI;AAEVvQ,gBAAI,EAAEvsD,IAAI,CAACkD,GAAL,CAASsU,MAAM,CAAC5O,EAAhB,EAAoB4O,MAAM,CAAC1O,EAA3B,EAA+B0O,MAAM,CAACqlD,IAAtC,EAA4CrlD,MAAM,CAACulD,IAAnD,CAFI;AAGVtQ,gBAAI,EAAEzsD,IAAI,CAACgD,GAAL,CAASwU,MAAM,CAAC7O,EAAhB,EAAoB6O,MAAM,CAAC3O,EAA3B,EAA+B2O,MAAM,CAAColD,IAAtC,EAA4CplD,MAAM,CAACslD,IAAnD,CAHI;AAIVnQ,gBAAI,EAAE3sD,IAAI,CAACgD,GAAL,CAASwU,MAAM,CAAC5O,EAAhB,EAAoB4O,MAAM,CAAC1O,EAA3B,EAA+B0O,MAAM,CAACqlD,IAAtC,EAA4CrlD,MAAM,CAACulD,IAAnD;AAJI,WAAd;AAOA,eAAK3oD,IAAL,GAAY,QAAZ;;AAEAgpD,wBAAc;;AAEd,cAAIC,kBAAkB,GAAG,SAArBA,kBAAqB,CAAUC,MAAV,EAAkBr7D,QAAlB,EAA4Bm4D,QAA5B,EAAsC;AAC3D,gBAAIA,QAAJ,EAAc;AACVn4D,sBAAQ,GAAGlC,IAAI,CAACwK,QAAL,CAAcQ,sBAAd,CAAqCuyD,MAArC,EAA6Cr7D,QAAQ,GAAG,CAAX,GAAe,CAAf,GAAmB,CAAhE,EAAmEA,QAAnE,CAAX;AACH;;AAED,mBAAOA,QAAP;AACH,WAND;AAQA;;;;;;AAIA,eAAKk4D,WAAL,GAAmB,UAAUl4D,QAAV,EAAoBm4D,QAApB,EAA8B;AAC7Cn4D,oBAAQ,GAAGo7D,kBAAkB,CAAC,KAAKl8D,KAAN,EAAac,QAAb,EAAuBm4D,QAAvB,CAA7B;AACA,mBAAOr6D,IAAI,CAACwK,QAAL,CAAcK,YAAd,CAA2B,KAAKzJ,KAAhC,EAAuCc,QAAvC,CAAP;AACH,WAHD;AAKA;;;;;AAGA,eAAKwI,eAAL,GAAuB,UAAUxI,QAAV,EAAoBm4D,QAApB,EAA8B;AACjDn4D,oBAAQ,GAAGo7D,kBAAkB,CAAC,KAAKl8D,KAAN,EAAac,QAAb,EAAuBm4D,QAAvB,CAA7B;AACA,mBAAOr6D,IAAI,CAACwK,QAAL,CAAcE,eAAd,CAA8B,KAAKtJ,KAAnC,EAA0Cc,QAA1C,CAAP;AACH,WAHD;;AAKA,eAAKq4D,kBAAL,GAA0B,UAAUr4D,QAAV,EAAoBC,QAApB,EAA8Bk4D,QAA9B,EAAwC;AAC9Dn4D,oBAAQ,GAAGo7D,kBAAkB,CAAC,KAAKl8D,KAAN,EAAac,QAAb,EAAuBm4D,QAAvB,CAA7B;AACA,mBAAOr6D,IAAI,CAACwK,QAAL,CAAcM,mBAAd,CAAkC,KAAK1J,KAAvC,EAA8Cc,QAA9C,EAAwDC,QAAxD,CAAP;AACH,WAHD;;AAKA,eAAK8I,SAAL,GAAiB,YAAY;AACzB,mBAAO,KAAKxJ,MAAZ;AACH,WAFD;;AAIA,eAAKo4D,SAAL,GAAiB,YAAY;AACzB,mBAAO,KAAKxN,MAAZ;AACH,WAFD;;AAIA,eAAKuN,sBAAL,GAA8B,UAAUz5D,CAAV,EAAaK,CAAb,EAAgB;AAC1C,gBAAIgG,CAAC,GAAGxG,IAAI,CAACwK,QAAL,CAAcI,mBAAd,CAAkC;AAACzK,eAAC,EAACA,CAAH;AAAKK,eAAC,EAACA;AAAP,aAAlC,EAA6C,KAAKY,KAAlD,CAAR;AACA,mBAAO;AACHmB,eAAC,EAACtC,IAAI,CAACW,IAAL,CAAUX,IAAI,CAACgB,GAAL,CAASuF,CAAC,CAACrF,KAAF,CAAQhB,CAAR,GAAYA,CAArB,EAAwB,CAAxB,IAA6BF,IAAI,CAACgB,GAAL,CAASuF,CAAC,CAACrF,KAAF,CAAQX,CAAR,GAAYA,CAArB,EAAwB,CAAxB,CAAvC,CADC;AAEHL,eAAC,EAACqG,CAAC,CAACrF,KAAF,CAAQhB,CAFP;AAGHK,eAAC,EAACgG,CAAC,CAACrF,KAAF,CAAQX,CAHP;AAIHkQ,eAAC,EAAC,IAAIlK,CAAC,CAACtE,QAJL;AAKHpB,eAAC,EAAC;AALC,aAAP;AAOH,WATD;;AAWA,eAAKoK,gBAAL,GAAwB,UAAStC,EAAT,EAAaC,EAAb,EAAiBC,EAAjB,EAAqBC,EAArB,EAAyB;AAC7C,mBAAO/I,IAAI,CAACwK,QAAL,CAAcU,gBAAd,CAA+BtC,EAA/B,EAAmCC,EAAnC,EAAuCC,EAAvC,EAA2CC,EAA3C,EAA+C,KAAK3H,KAApD,CAAP;AACH,WAFD;AAGH;AAnoBU,OAAf;AAsoBAg7C,SAAG,CAACohB,eAAJ,GAAsB;AAClBC,eAAO,EAAE,iBAAUjC,OAAV,EAAmBkC,cAAnB,EAAmC;AACxC,iBAAQ;AACJ,wBAAY,kBAAUA,cAAV,EAA0B;AAClC,kBAAIn7D,CAAC,GAAGi5D,OAAO,CAACtB,cAAR,EAAR;AACA,qBAAO,CAACwD,cAAc,GAAG,OAAOn7D,CAAC,CAACqG,EAAT,GAAc,GAAd,GAAoBrG,CAAC,CAACsG,EAAtB,GAA2B,GAA9B,GAAoC,EAAnD,IAAyD,IAAzD,GAAgEtG,CAAC,CAACuG,EAAlE,GAAuE,GAAvE,GAA6EvG,CAAC,CAACwG,EAAtF;AACH,aAJG;AAKJ,sBAAU,gBAAU20D,cAAV,EAA0B;AAChC,kBAAIn7D,CAAC,GAAGi5D,OAAO,CAAC/jD,MAAhB;AACA,qBAAO,CAACimD,cAAc,GAAG,OAAOn7D,CAAC,CAACuG,EAAT,GAAc,GAAd,GAAoBvG,CAAC,CAACwG,EAAtB,GAA2B,GAA9B,GAAoC,EAAnD,IACH,IADG,GACIxG,CAAC,CAACw6D,IADN,GACa,GADb,GACmBx6D,CAAC,CAACy6D,IADrB,GAC4B,GAD5B,GACkCz6D,CAAC,CAACs6D,IADpC,GAC2C,GAD3C,GACiDt6D,CAAC,CAACu6D,IADnD,GAC0D,GAD1D,GACgEv6D,CAAC,CAACqG,EADlE,GACuE,GADvE,GAC6ErG,CAAC,CAACsG,EADtF;AAEH,aATG;AAUJ,mBAAO,aAAU60D,cAAV,EAA0B;AAC7B,kBAAIn7D,CAAC,GAAGi5D,OAAO,CAAC/jD,MAAhB;AAAA,kBACIkmD,GAAG,GAAGnC,OAAO,CAACS,KAAR,GAAgBh8D,IAAI,CAACsK,EAArB,GAA0B,CAA1B,GAA8B,CADxC;AAAA,kBAEI2qD,EAAE,GAAGsG,OAAO,CAACC,aAAR,GAAwB,CAAxB,GAA4B,CAFrC;AAIA,qBAAQ,CAACiC,cAAc,GAAG,MAAMlC,OAAO,CAAC5yD,EAAd,GAAmB,GAAnB,GAAyB4yD,OAAO,CAAC3yD,EAAjC,GAAuC,GAA1C,GAAgD,EAA/D,IAAsE,IAAtE,GAA6E2yD,OAAO,CAACO,MAArF,GAA8F,GAA9F,GAAoGx5D,CAAC,CAAC2G,CAAtG,GAA0G,KAA1G,GAAkHy0D,GAAlH,GAAwH,GAAxH,GAA8HzI,EAA9H,GAAmI,GAAnI,GAAyIsG,OAAO,CAAC1yD,EAAjJ,GAAsJ,GAAtJ,GAA4J0yD,OAAO,CAACzyD,EAA5K;AACH;AAhBG,WAAD,CAiBJyyD,OAAO,CAACnnD,IAjBJ,EAiBUqpD,cAjBV,CAAP;AAkBH;AApBiB,OAAtB;AAuBA;;;;;AAIA,UAAIE,iBAAiB,GAAG,SAApBA,iBAAoB,GAAY;AAChC,aAAK/R,WAAL,GAAmB,YAAY;AAC3B,eAAKQ,MAAL,GAAc;AAAEC,gBAAI,EAAElkD,QAAR;AAAkBokD,gBAAI,EAAEpkD,QAAxB;AAAkCskD,gBAAI,EAAE,CAACtkD,QAAzC;AAAmDwkD,gBAAI,EAAE,CAACxkD;AAA1D,WAAd;AACH,SAFD;;AAGA,aAAKyjD,WAAL;AACH,OALD;AAOA;;;;;;;;;;;;AAUAzP,SAAG,CAAChU,UAAJ,CAAey1B,iBAAf,GAAmC,UAAUpmD,MAAV,EAAkB;AAEjDmmD,yBAAiB,CAACx0D,KAAlB,CAAwB,IAAxB,EAA8B0F,SAA9B;AAEA,YAAI8pD,QAAQ,GAAG,EAAf;AAAA,YACIkF,WAAW,GAAG,CADlB;AAAA,YAEIC,kBAAkB,GAAG,EAFzB;AAAA,YAGIC,0BAA0B,GAAG,EAHjC;AAAA,YAIIC,IAAI,GAAGxmD,MAAM,CAACwmD,IAAP,IAAe,CAJ1B;AAAA,YAKIC,UAAU,GAAGjnC,GAAG,CAACtJ,OAAJ,CAAYswC,IAAZ,IAAoBA,IAAI,CAAC,CAAD,CAAxB,GAA8BA,IAL/C;AAAA,YAMIE,UAAU,GAAGlnC,GAAG,CAACtJ,OAAJ,CAAYswC,IAAZ,IAAoBA,IAAI,CAAC,CAAD,CAAxB,GAA8BA,IAN/C;AAAA,YAOIG,GAAG,GAAG3mD,MAAM,CAAC2mD,GAAP,IAAc,CAPxB;AAAA,YAQIC,SAAS,GAAGpnC,GAAG,CAACtJ,OAAJ,CAAYywC,GAAZ,IAAmBA,GAAG,CAAC,CAAD,CAAtB,GAA4BA,GAR5C;AAAA,YASIE,SAAS,GAAGrnC,GAAG,CAACtJ,OAAJ,CAAYywC,GAAZ,IAAmBA,GAAG,CAAC,CAAD,CAAtB,GAA4BA,GAT5C;AAAA,YAUIG,oBAAoB,GAAG,IAV3B;AAAA,YAWIC,SAAS,GAAG,IAXhB;;AAaA,aAAKC,WAAL,GAAmB,YAAW;AAC1B,cAAIj4D,CAAC,GAAG,EAAR;;AACA,eAAK,IAAIzE,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG62D,QAAQ,CAACn3D,MAA7B,EAAqCM,CAAC,EAAtC,EAA0C;AACtCyE,aAAC,IAAI41C,GAAG,CAACohB,eAAJ,CAAoBC,OAApB,CAA4B7E,QAAQ,CAAC72D,CAAD,CAApC,EAAyCA,CAAC,KAAK,CAA/C,CAAL;AACAyE,aAAC,IAAI,GAAL;AACH;;AACD,iBAAOA,CAAP;AACH,SAPD;AASA;;;;;;;;;;;;;;;AAaA,aAAKk4D,mBAAL,GAA2B,UAAUv+D,CAAV,EAAaK,CAAb,EAAgB;AACvC,cAAI+P,GAAG,GAAG;AAAEhO,aAAC,EAAE6F,QAAL;AAAetH,aAAC,EAAE,IAAlB;AAAwBX,aAAC,EAAE,IAA3B;AAAiCK,aAAC,EAAE,IAApC;AAA0CkQ,aAAC,EAAE;AAA7C,WAAV;;AACA,eAAK,IAAI3O,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG62D,QAAQ,CAACn3D,MAA7B,EAAqCM,CAAC,EAAtC,EAA0C;AACtC,gBAAIupB,EAAE,GAAGstC,QAAQ,CAAC72D,CAAD,CAAR,CAAY63D,sBAAZ,CAAmCz5D,CAAnC,EAAsCK,CAAtC,CAAT;;AACA,gBAAI8qB,EAAE,CAAC/oB,CAAH,GAAOgO,GAAG,CAAChO,CAAf,EAAkB;AACdgO,iBAAG,CAAChO,CAAJ,GAAQ+oB,EAAE,CAAC/oB,CAAX;AACAgO,iBAAG,CAACG,CAAJ,GAAQ4a,EAAE,CAAC5a,CAAX;AACAH,iBAAG,CAACpQ,CAAJ,GAAQmrB,EAAE,CAACnrB,CAAX;AACAoQ,iBAAG,CAAC/P,CAAJ,GAAQ8qB,EAAE,CAAC9qB,CAAX;AACA+P,iBAAG,CAACzP,CAAJ,GAAQ83D,QAAQ,CAAC72D,CAAD,CAAhB;AACAwO,iBAAG,CAAC3H,EAAJ,GAAS0iB,EAAE,CAAC1iB,EAAZ;AACA2H,iBAAG,CAACzH,EAAJ,GAASwiB,EAAE,CAACxiB,EAAZ;AACAyH,iBAAG,CAAC1H,EAAJ,GAASyiB,EAAE,CAACziB,EAAZ;AACA0H,iBAAG,CAACxH,EAAJ,GAASuiB,EAAE,CAACviB,EAAZ;AACAwH,iBAAG,CAACvB,KAAJ,GAAYjN,CAAZ;AACAwO,iBAAG,CAACouD,iBAAJ,GAAwBZ,kBAAkB,CAACh8D,CAAD,CAAlB,CAAsB,CAAtB,IAA4BupB,EAAE,CAAC5a,CAAH,IAAQqtD,kBAAkB,CAACh8D,CAAD,CAAlB,CAAsB,CAAtB,IAA2Bg8D,kBAAkB,CAACh8D,CAAD,CAAlB,CAAsB,CAAtB,CAAnC,CAApD;AACH;AACJ;;AAED,iBAAOwO,GAAP;AACH,SApBD;;AAsBA,aAAKrF,gBAAL,GAAwB,UAAStC,EAAT,EAAaC,EAAb,EAAiBC,EAAjB,EAAqBC,EAArB,EAAyB;AAC7C,cAAIwH,GAAG,GAAG,EAAV;;AACA,eAAK,IAAIxO,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG62D,QAAQ,CAACn3D,MAA7B,EAAqCM,CAAC,EAAtC,EAA0C;AACtCwO,eAAG,CAAC9J,IAAJ,CAAS2C,KAAT,CAAemH,GAAf,EAAoBqoD,QAAQ,CAAC72D,CAAD,CAAR,CAAYmJ,gBAAZ,CAA6BtC,EAA7B,EAAiCC,EAAjC,EAAqCC,EAArC,EAAyCC,EAAzC,CAApB;AACH;;AACD,iBAAOwH,GAAP;AACH,SAND;;AAQA,aAAKpF,eAAL,GAAuB,UAAShL,CAAT,EAAYK,CAAZ,EAAec,CAAf,EAAkBmI,CAAlB,EAAqB;AACxC,cAAI8G,GAAG,GAAG,EAAV;;AACA,eAAK,IAAIxO,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG62D,QAAQ,CAACn3D,MAA7B,EAAqCM,CAAC,EAAtC,EAA0C;AACtCwO,eAAG,CAAC9J,IAAJ,CAAS2C,KAAT,CAAemH,GAAf,EAAoBqoD,QAAQ,CAAC72D,CAAD,CAAR,CAAYoJ,eAAZ,CAA4BhL,CAA5B,EAA+BK,CAA/B,EAAkCc,CAAlC,EAAqCmI,CAArC,CAApB;AACH;;AACD,iBAAO8G,GAAP;AACH,SAND;;AAQA,aAAKnF,uBAAL,GAA+B,UAAS+P,GAAT,EAAc;AACzC,cAAI5K,GAAG,GAAG,EAAV;;AACA,eAAK,IAAIxO,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG62D,QAAQ,CAACn3D,MAA7B,EAAqCM,CAAC,EAAtC,EAA0C;AACtCwO,eAAG,CAAC9J,IAAJ,CAAS2C,KAAT,CAAemH,GAAf,EAAoBqoD,QAAQ,CAAC72D,CAAD,CAAR,CAAYqJ,uBAAZ,CAAoC+P,GAApC,CAApB;AACH;;AACD,iBAAO5K,GAAP;AACH,SAND;;AAQA,YAAIquD,yBAAyB,GAAG,SAA5BA,yBAA4B,GAAY;AACpC,cAAIv3D,MAAM,GAAG,CAAb;;AACA,eAAK,IAAItF,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG62D,QAAQ,CAACn3D,MAA7B,EAAqCM,CAAC,EAAtC,EAA0C;AACtC,gBAAI+W,EAAE,GAAG8/C,QAAQ,CAAC72D,CAAD,CAAR,CAAYkJ,SAAZ,EAAT;AACA+yD,sCAA0B,CAACj8D,CAAD,CAA1B,GAAgC+W,EAAE,GAAGglD,WAArC;AACAC,8BAAkB,CAACh8D,CAAD,CAAlB,GAAwB,CAACsF,MAAD,EAAUA,MAAM,IAAKyR,EAAE,GAAGglD,WAA1B,CAAxB;AACH;AACJ,SAPL;;AASI;;;;;;;;;AASAe,+BAAuB,GAAG,SAA1BA,uBAA0B,CAAU38D,QAAV,EAAoBm4D,QAApB,EAA8B;AAEpD,cAAI9jD,GAAJ,EAASxU,CAAT,EAAY+8D,mBAAZ;;AAEA,cAAIzE,QAAJ,EAAc;AACVn4D,oBAAQ,GAAGA,QAAQ,GAAG,CAAX,GAAeA,QAAQ,GAAG47D,WAA1B,GAAwC,CAACA,WAAW,GAAG57D,QAAf,IAA2B47D,WAA9E;AACH,WANmD,CAQpD;;;AACA,cAAI57D,QAAQ,KAAK,CAAjB,EAAoB;AAChBqU,eAAG,GAAGqiD,QAAQ,CAACn3D,MAAT,GAAkB,CAAxB;AACAq9D,+BAAmB,GAAG,CAAtB;AACH,WAHD,MAGO,IAAI58D,QAAQ,KAAK,CAAjB,EAAoB;AACvB;AACA48D,+BAAmB,GAAG,CAAtB;AACAvoD,eAAG,GAAG,CAAN;AACH,WAJM,MAIA;AAEH;AACA;AACA,gBAAIrU,QAAQ,IAAI,GAAhB,EAAqB;AAEjBqU,iBAAG,GAAG,CAAN;AACAuoD,iCAAmB,GAAG,CAAtB;;AACA,mBAAK/8D,CAAC,GAAGg8D,kBAAkB,CAACt8D,MAAnB,GAA4B,CAArC,EAAwCM,CAAC,GAAG,CAAC,CAA7C,EAAgDA,CAAC,EAAjD,EAAqD;AACjD,oBAAIg8D,kBAAkB,CAACh8D,CAAD,CAAlB,CAAsB,CAAtB,KAA4BG,QAA5B,IAAwC67D,kBAAkB,CAACh8D,CAAD,CAAlB,CAAsB,CAAtB,KAA4BG,QAAxE,EAAkF;AAC9EqU,qBAAG,GAAGxU,CAAN;AACA+8D,qCAAmB,GAAG,CAAC58D,QAAQ,GAAG67D,kBAAkB,CAACh8D,CAAD,CAAlB,CAAsB,CAAtB,CAAZ,IAAwCi8D,0BAA0B,CAACj8D,CAAD,CAAxF;AACA;AACH;AACJ;AAEJ,aAZD,MAYO;AACHwU,iBAAG,GAAGwnD,kBAAkB,CAACt8D,MAAnB,GAA4B,CAAlC;AACAq9D,iCAAmB,GAAG,CAAtB;;AACA,mBAAK/8D,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGg8D,kBAAkB,CAACt8D,MAAnC,EAA2CM,CAAC,EAA5C,EAAgD;AAC5C,oBAAIg8D,kBAAkB,CAACh8D,CAAD,CAAlB,CAAsB,CAAtB,KAA4BG,QAAhC,EAA0C;AACtCqU,qBAAG,GAAGxU,CAAN;AACA+8D,qCAAmB,GAAG,CAAC58D,QAAQ,GAAG67D,kBAAkB,CAACh8D,CAAD,CAAlB,CAAsB,CAAtB,CAAZ,IAAwCi8D,0BAA0B,CAACj8D,CAAD,CAAxF;AACA;AACH;AACJ;AACJ;AACJ;;AAED,iBAAO;AAAEy5D,mBAAO,EAAE5C,QAAQ,CAACriD,GAAD,CAAnB;AAA0BwoD,sBAAU,EAAED,mBAAtC;AAA2D9vD,iBAAK,EAAEuH;AAAlE,WAAP;AACH,SAhEL;AAAA,YAiEIyoD,WAAW,GAAG,SAAdA,WAAc,CAAUtqC,IAAV,EAAgBrgB,IAAhB,EAAsBoD,MAAtB,EAA8B;AACxC,cAAIA,MAAM,CAAC7O,EAAP,KAAc6O,MAAM,CAAC3O,EAArB,IAA2B2O,MAAM,CAAC5O,EAAP,KAAc4O,MAAM,CAAC1O,EAApD,EAAwD;AACpD;AACH;;AACD,cAAIjI,CAAC,GAAG,IAAIs7C,GAAG,CAACsd,QAAJ,CAAarlD,IAAb,CAAJ,CAAuBoD,MAAvB,CAAR;AACAmhD,kBAAQ,CAACnyD,IAAT,CAAc3F,CAAd;AACAg9D,qBAAW,IAAIh9D,CAAC,CAACmK,SAAF,EAAf;AACAypB,cAAI,CAACuqC,YAAL,CAAkBn+D,CAAlB;AACH,SAzEL;AAAA,YA0EIo+D,cAAc,GAAG,SAAjBA,cAAiB,GAAY;AACzBpB,qBAAW,GAAGlF,QAAQ,CAACn3D,MAAT,GAAkBs8D,kBAAkB,CAACt8D,MAAnB,GAA4Bu8D,0BAA0B,CAACv8D,MAA3B,GAAoC,CAAhG;AACH,SA5EL;;AA8EA,aAAK09D,WAAL,GAAmB,UAAUC,KAAV,EAAiB;AAChCb,8BAAoB,GAAG,EAAvB;AACAT,qBAAW,GAAG,CAAd;;AACA,eAAK,IAAI/7D,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGq9D,KAAK,CAAC39D,MAA1B,EAAkCM,CAAC,EAAnC,EAAuC;AACnCw8D,gCAAoB,CAAC93D,IAArB,CAA0B24D,KAAK,CAACr9D,CAAD,CAA/B;AACA+7D,uBAAW,IAAIsB,KAAK,CAACr9D,CAAD,CAAL,CAASkJ,SAAT,EAAf;AACH;AACJ,SAPD;;AASA,aAAKA,SAAL,GAAiB,YAAW;AACxB,iBAAO6yD,WAAP;AACH,SAFD;;AAIA,YAAIuB,eAAe,GAAG,SAAlBA,eAAkB,CAAU5nD,MAAV,EAAkB;AACpC,eAAKy0C,WAAL,GAAmBz0C,MAAM,CAACy0C,WAA1B;;AACA,cAAIsP,OAAO,GAAG/B,GAAG,CAAChtD,QAAJ,CAAagL,MAAM,CAACq0C,SAApB,EAA+Br0C,MAAM,CAACs0C,SAAtC,CAAd;AAAA,cACIuT,KAAK,GAAG7nD,MAAM,CAACs0C,SAAP,CAAiB,CAAjB,IAAsBt0C,MAAM,CAACq0C,SAAP,CAAiB,CAAjB,CADlC;AAAA,cAEIyT,KAAK,GAAG9nD,MAAM,CAACs0C,SAAP,CAAiB,CAAjB,IAAsBt0C,MAAM,CAACq0C,SAAP,CAAiB,CAAjB,CAFlC;AAAA,cAGI0T,EAAE,GAAG/nD,MAAM,CAACy0C,WAAP,IAAsB,CAH/B;AAAA,cAIIuT,EAAE,GAAGhoD,MAAM,CAACgrB,cAAP,CAAsBvM,MAAtB,CAA6Bsb,cAA7B,CAA4C/5B,MAAM,CAACgrB,cAAnD,CAJT;AAAA,cAKI6X,EAAE,GAAG7iC,MAAM,CAACirB,cAAP,CAAsBxM,MAAtB,CAA6Bsb,cAA7B,CAA4C/5B,MAAM,CAACirB,cAAnD,CALT;AAAA,cAMIviC,CAAC,GAAGm/D,KAAK,GAAG7nD,MAAM,CAACs0C,SAAP,CAAiB,CAAjB,CAAH,GAAyBt0C,MAAM,CAACq0C,SAAP,CAAiB,CAAjB,CANtC;AAAA,cAOItrD,CAAC,GAAG++D,KAAK,GAAG9nD,MAAM,CAACs0C,SAAP,CAAiB,CAAjB,CAAH,GAAyBt0C,MAAM,CAACq0C,SAAP,CAAiB,CAAjB,CAPtC;AAAA,cAQIxqD,CAAC,GAAGrB,IAAI,CAACuH,GAAL,CAASiQ,MAAM,CAACs0C,SAAP,CAAiB,CAAjB,IAAsBt0C,MAAM,CAACq0C,SAAP,CAAiB,CAAjB,CAA/B,CARR;AAAA,cASIriD,CAAC,GAAGxJ,IAAI,CAACuH,GAAL,CAASiQ,MAAM,CAACs0C,SAAP,CAAiB,CAAjB,IAAsBt0C,MAAM,CAACq0C,SAAP,CAAiB,CAAjB,CAA/B,CATR,CAFoC,CAapC;AACA;AACA;;;AACA,cAAI2T,EAAE,CAAC,CAAD,CAAF,KAAU,CAAV,IAAeA,EAAE,CAAC,CAAD,CAAF,KAAU,CAAzB,IAA8BnlB,EAAE,CAAC,CAAD,CAAF,KAAU,CAAV,IAAeA,EAAE,CAAC,CAAD,CAAF,KAAU,CAA3D,EAA8D;AAC1D,gBAAItrC,KAAK,GAAG1N,CAAC,GAAGmI,CAAJ,GAAQ,CAAR,GAAY,CAAxB;AAAA,gBAA2Bi2D,MAAM,GAAG,CAAC,CAAD,EAAI,CAAJ,EAAO1wD,KAAP,CAApC;AACAywD,cAAE,GAAG,EAAL;AACAnlB,cAAE,GAAG,EAAL;AACAmlB,cAAE,CAACzwD,KAAD,CAAF,GAAYyI,MAAM,CAACq0C,SAAP,CAAiB98C,KAAjB,IAA0ByI,MAAM,CAACs0C,SAAP,CAAiB/8C,KAAjB,CAA1B,GAAoD,CAAC,CAArD,GAAyD,CAArE;AACAsrC,cAAE,CAACtrC,KAAD,CAAF,GAAYyI,MAAM,CAACq0C,SAAP,CAAiB98C,KAAjB,IAA0ByI,MAAM,CAACs0C,SAAP,CAAiB/8C,KAAjB,CAA1B,GAAoD,CAApD,GAAwD,CAAC,CAArE;AACAywD,cAAE,CAACC,MAAD,CAAF,GAAa,CAAb;AACAplB,cAAE,CAAColB,MAAD,CAAF,GAAa,CAAb;AACH;;AAED,cAAIC,EAAE,GAAGL,KAAK,GAAGh+D,CAAC,GAAI+8D,SAAS,GAAGoB,EAAE,CAAC,CAAD,CAAtB,GAA6BpB,SAAS,GAAGoB,EAAE,CAAC,CAAD,CAAzD;AAAA,cACIG,EAAE,GAAGL,KAAK,GAAG91D,CAAC,GAAI40D,SAAS,GAAGoB,EAAE,CAAC,CAAD,CAAtB,GAA6BpB,SAAS,GAAGoB,EAAE,CAAC,CAAD,CADzD;AAAA,cAEIr9C,EAAE,GAAGk9C,KAAK,GAAGhB,SAAS,GAAGhkB,EAAE,CAAC,CAAD,CAAjB,GAAuBh5C,CAAC,GAAIg9D,SAAS,GAAGhkB,EAAE,CAAC,CAAD,CAFxD;AAAA,cAGIj4B,EAAE,GAAGk9C,KAAK,GAAGjB,SAAS,GAAGhkB,EAAE,CAAC,CAAD,CAAjB,GAAuB7wC,CAAC,GAAI60D,SAAS,GAAGhkB,EAAE,CAAC,CAAD,CAHxD;AAAA,cAIIulB,QAAQ,GAAKJ,EAAE,CAAC,CAAD,CAAF,GAAQnlB,EAAE,CAAC,CAAD,CAAX,GAAmBmlB,EAAE,CAAC,CAAD,CAAF,GAAQnlB,EAAE,CAAC,CAAD,CAJ7C;AAMA,cAAIxzB,MAAM,GAAG;AACT64C,cAAE,EAAEA,EADK;AACDC,cAAE,EAAEA,EADH;AACOx9C,cAAE,EAAEA,EADX;AACeC,cAAE,EAAEA,EADnB;AACuBm9C,cAAE,EAAEA,EAD3B;AAETM,iBAAK,EAAE7/D,IAAI,CAACuH,GAAL,CAAS4a,EAAE,GAAGu9C,EAAd,CAFE;AAGTI,iBAAK,EAAE9/D,IAAI,CAACuH,GAAL,CAAS6a,EAAE,GAAGu9C,EAAd,CAHE;AAITxH,cAAE,EAAE,CAACuH,EAAE,GAAGv9C,EAAN,IAAY,CAJP;AAKTi2C,cAAE,EAAE,CAACuH,EAAE,GAAGv9C,EAAN,IAAY,CALP;AAMTo9C,cAAE,EAAEA,EANK;AAMDnlB,cAAE,EAAEA,EANH;AAMOn6C,aAAC,EAAEA,CANV;AAMaK,aAAC,EAAEA,CANhB;AAMmBc,aAAC,EAAEA,CANtB;AAMyBmI,aAAC,EAAEA,CAN5B;AAOT+xD,mBAAO,EAAEA,OAPA;AAQTwE,sBAAU,EAAEL,EAAE,GAAIF,EAAE,CAAC,CAAD,CAAF,GAAQvB,UARjB;AAST+B,sBAAU,EAAEL,EAAE,GAAIH,EAAE,CAAC,CAAD,CAAF,GAAQvB,UATjB;AAUTgC,oBAAQ,EAAE99C,EAAE,GAAIk4B,EAAE,CAAC,CAAD,CAAF,GAAQ6jB,UAVf;AAWTgC,oBAAQ,EAAE99C,EAAE,GAAIi4B,EAAE,CAAC,CAAD,CAAF,GAAQ6jB,UAXf;AAYTiC,oCAAwB,EAAEngE,IAAI,CAACuH,GAAL,CAASm4D,EAAE,GAAGv9C,EAAd,IAAqB87C,UAAU,GAAGC,UAZnD;AAaTkC,oCAAwB,EAAEpgE,IAAI,CAACuH,GAAL,CAASo4D,EAAE,GAAGv9C,EAAd,IAAqB67C,UAAU,GAAGC,UAbnD;AAcTmC,oBAAQ,EAAET,QAAQ,KAAK,CAAC,CAdf;AAeTU,yBAAa,EAAEV,QAAQ,KAAK,CAfnB;AAgBTW,sBAAU,EAAEX,QAAQ,KAAK,CAhBhB;AAiBTY,sBAAU,EAAEhB,EAAE,CAAC,CAAD,CAAF,KAAU,CAAV,GAAc,GAAd,GAAoB,GAjBvB;AAkBTtG,kBAAM,EAAE,CAACh5D,CAAD,EAAIK,CAAJ,EAAOc,CAAP,EAAUmI,CAAV,EAAak2D,EAAb,EAAiBC,EAAjB,EAAqBx9C,EAArB,EAAyBC,EAAzB,CAlBC;AAmBTq+C,iBAAK,EAAC,CAACxC,UAAD,EAAaC,UAAb;AAnBG,WAAb;AAqBAr3C,gBAAM,CAAC65C,iBAAP,GAA2B75C,MAAM,CAACw5C,QAAP,GAAkB,UAAlB,GAA+Bx5C,MAAM,CAAC05C,UAAP,GAAoB,YAApB,GAAmC,eAA7F;AACA,iBAAO15C,MAAP;AACH,SAvDD;;AAyDA,aAAK85C,WAAL,GAAmB,YAAY;AAC3B,iBAAOhI,QAAP;AACH,SAFD;;AAIA,aAAKqG,YAAL,GAAoB,UAAUzD,OAAV,EAAmB;AACnC,cAAIqF,SAAS,GAAGrF,OAAO,CAAC3B,SAAR,EAAhB;AACA,eAAKxN,MAAL,CAAYC,IAAZ,GAAmBrsD,IAAI,CAACkD,GAAL,CAAS,KAAKkpD,MAAL,CAAYC,IAArB,EAA2BuU,SAAS,CAACvU,IAArC,CAAnB;AACA,eAAKD,MAAL,CAAYK,IAAZ,GAAmBzsD,IAAI,CAACgD,GAAL,CAAS,KAAKopD,MAAL,CAAYK,IAArB,EAA2BmU,SAAS,CAACnU,IAArC,CAAnB;AACA,eAAKL,MAAL,CAAYG,IAAZ,GAAmBvsD,IAAI,CAACkD,GAAL,CAAS,KAAKkpD,MAAL,CAAYG,IAArB,EAA2BqU,SAAS,CAACrU,IAArC,CAAnB;AACA,eAAKH,MAAL,CAAYO,IAAZ,GAAmB3sD,IAAI,CAACgD,GAAL,CAAS,KAAKopD,MAAL,CAAYO,IAArB,EAA2BiU,SAAS,CAACjU,IAArC,CAAnB;AACH,SAND;;AAQA,YAAIkU,qBAAqB,GAAG,SAAxBA,qBAAwB,GAAY;AACpCl5D,iBAAO,CAACC,GAAR,CAAY,WAAZ;;AACA,eAAK,IAAI9F,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG62D,QAAQ,CAACn3D,MAA7B,EAAqCM,CAAC,EAAtC,EAA0C;AACtC6F,mBAAO,CAACC,GAAR,CAAY+wD,QAAQ,CAAC72D,CAAD,CAAR,CAAYsS,IAAxB,EAA8BukD,QAAQ,CAAC72D,CAAD,CAAR,CAAYkJ,SAAZ,EAA9B,EAAuD8yD,kBAAkB,CAACh8D,CAAD,CAAzE;AACH;AACJ,SALD;;AAOA,aAAKq4D,WAAL,GAAmB,UAAUl4D,QAAV,EAAoBm4D,QAApB,EAA8B;AAC7C,cAAI0G,GAAG,GAAGlC,uBAAuB,CAAC38D,QAAD,EAAWm4D,QAAX,CAAjC;;AACA,iBAAO0G,GAAG,CAACvF,OAAJ,IAAeuF,GAAG,CAACvF,OAAJ,CAAYpB,WAAZ,CAAwB2G,GAAG,CAAChC,UAA5B,EAAwC,KAAxC,CAAf,IAAiE,CAAC,CAAD,EAAI,CAAJ,CAAxE;AACH,SAHD;;AAKA,aAAKr0D,eAAL,GAAuB,UAAUxI,QAAV,EAAoBm4D,QAApB,EAA8B;AACjD,cAAI0G,GAAG,GAAGlC,uBAAuB,CAAC38D,QAAD,EAAWm4D,QAAX,CAAjC;;AACA,iBAAO0G,GAAG,CAACvF,OAAJ,IAAeuF,GAAG,CAACvF,OAAJ,CAAY9wD,eAAZ,CAA4Bq2D,GAAG,CAAChC,UAAhC,EAA4C,KAA5C,CAAf,IAAqE,CAA5E;AACH,SAHD;;AAKA,aAAKxE,kBAAL,GAA0B,UAAUr4D,QAAV,EAAoBC,QAApB,EAA8Bk4D,QAA9B,EAAwC;AAC9D,cAAI0G,GAAG,GAAGlC,uBAAuB,CAAC38D,QAAD,EAAWm4D,QAAX,CAAjC,CAD8D,CAE9D;;;AACA,iBAAO0G,GAAG,CAACvF,OAAJ,IAAeuF,GAAG,CAACvF,OAAJ,CAAYjB,kBAAZ,CAA+BwG,GAAG,CAAChC,UAAnC,EAA+C58D,QAA/C,EAAyD,KAAzD,CAAf,IAAkF,CAAC,CAAD,EAAI,CAAJ,CAAzF;AACH,SAJD;;AAMA,aAAK0mC,OAAL,GAAe,UAAUpxB,MAAV,EAAkB;AAC7B+mD,mBAAS,GAAGa,eAAe,CAAC9zD,IAAhB,CAAqB,IAArB,EAA2BkM,MAA3B,CAAZ;;AAEAynD,wBAAc;;AACd,eAAKjC,QAAL,CAAcuB,SAAd,EAAyB/mD,MAAzB;;AACA,eAAKtX,CAAL,GAASq+D,SAAS,CAACrF,MAAV,CAAiB,CAAjB,CAAT;AACA,eAAK34D,CAAL,GAASg+D,SAAS,CAACrF,MAAV,CAAiB,CAAjB,CAAT;AACA,eAAK73D,CAAL,GAASk9D,SAAS,CAACrF,MAAV,CAAiB,CAAjB,CAAT;AACA,eAAK1vD,CAAL,GAAS+0D,SAAS,CAACrF,MAAV,CAAiB,CAAjB,CAAT;AACA,eAAKqC,OAAL,GAAegD,SAAS,CAAChD,OAAzB;;AACAoD,mCAAyB;AAC5B,SAXD;;AAaA,eAAO;AACHoC,oBAAU,EAAEhC,WADT;AAEHiC,wBAAc,EAAE5B,eAFb;AAGHnB,oBAAU,EAAEA,UAHT;AAIHC,oBAAU,EAAEA,UAJT;AAKH+C,iBAAO,EAAEjhE,IAAI,CAACgD,GAAL,CAASi7D,UAAT,EAAqBC,UAArB,CALN;AAMHE,mBAAS,EAAEA,SANR;AAOHC,mBAAS,EAAEA,SAPR;AAQH6C,gBAAM,EAAElhE,IAAI,CAACgD,GAAL,CAASo7D,SAAT,EAAoBC,SAApB;AARL,SAAP;AAUH,OAnSD;;AAoSArnC,SAAG,CAAC1G,MAAJ,CAAW6rB,GAAG,CAAChU,UAAJ,CAAey1B,iBAA1B,EAA6CD,iBAA7C,EA39BS,CA89BT;AAEA;;;AAEAxhB,SAAG,CAAC3e,SAAJ,CAAc2jC,gBAAd,GAAiC,UAAU3pD,MAAV,EAAkB;AAC/CmmD,yBAAiB,CAACx0D,KAAlB,CAAwB,IAAxB,EAA8B0F,SAA9B;;AACA,YAAI+5B,OAAO,GAAG,KAAKA,OAAL,GAAe,UAAU2W,WAAV,EAAuB7N,WAAvB,EAAoCxO,aAApC,EAAmDkgB,mBAAnD,EAAwE;AACjG,cAAI9yC,GAAG,GAAG,KAAK0sD,QAAL,CAAc7zD,KAAd,CAAoB,IAApB,EAA0B0F,SAA1B,CAAV;;AACA,eAAK3O,CAAL,GAASoQ,GAAG,CAAC,CAAD,CAAZ;AACA,eAAK/P,CAAL,GAAS+P,GAAG,CAAC,CAAD,CAAZ;AACA,eAAKjP,CAAL,GAASiP,GAAG,CAAC,CAAD,CAAZ;AACA,eAAK9G,CAAL,GAAS8G,GAAG,CAAC,CAAD,CAAZ;AACA,eAAK87C,MAAL,CAAYC,IAAZ,GAAmB,KAAKnsD,CAAxB;AACA,eAAKksD,MAAL,CAAYG,IAAZ,GAAmB,KAAKhsD,CAAxB;AACA,eAAK6rD,MAAL,CAAYK,IAAZ,GAAmB,KAAKvsD,CAAL,GAAS,KAAKmB,CAAjC;AACA,eAAK+qD,MAAL,CAAYO,IAAZ,GAAmB,KAAKpsD,CAAL,GAAS,KAAKiJ,CAAjC;AACA,iBAAO8G,GAAP;AACH,SAXD;;AAYA,eAAO;AACHs4B,iBAAO,EAAEA,OADN;AAEH9N,kBAAQ,EAAEtjB,MAAM,CAACsjB;AAFd,SAAP;AAIH,OAlBD;;AAmBA9D,SAAG,CAAC1G,MAAJ,CAAW6rB,GAAG,CAAC3e,SAAJ,CAAc2jC,gBAAzB,EAA2CxD,iBAA3C;AAEA;;;;;AAKA;;;;;;;;;AAOAxhB,SAAG,CAAC3e,SAAJ,CAAc4jC,GAAd,GAAoB,UAAU5pD,MAAV,EAAkB;AAClC,aAAKpD,IAAL,GAAY,KAAZ;;AACA,YAAI0lD,MAAM,GAAG3d,GAAG,CAAC3e,SAAJ,CAAc2jC,gBAAd,CAA+Bh4D,KAA/B,CAAqC,IAArC,EAA2C0F,SAA3C,CAAb;;AACA2I,cAAM,GAAGA,MAAM,IAAI,EAAnB;AACA,aAAKskD,MAAL,GAActkD,MAAM,CAACskD,MAAP,IAAiB,EAA/B;AACA,aAAKuF,aAAL,GAAqB,MAAM,KAAKvF,MAAhC;AACA,aAAKwF,kBAAL,GAA0B,KAAKxF,MAAL,GAAc,CAAxC;;AAEA,aAAKkB,QAAL,GAAgB,UAAUzd,WAAV,EAAuB7N,WAAvB,EAAoCxO,aAApC,EAAmDkgB,mBAAnD,EAAwE;AACpF,eAAK0Y,MAAL,GAAc54B,aAAa,CAAC44B,MAAd,IAAwB,KAAKA,MAA3C;AACA,cAAI57D,CAAC,GAAGq/C,WAAW,CAAC,CAAD,CAAX,GAAiB,KAAKuc,MAA9B;AAAA,cACIv7D,CAAC,GAAGg/C,WAAW,CAAC,CAAD,CAAX,GAAiB,KAAKuc,MAD9B;AAAA,cAEIz6D,CAAC,GAAG,KAAKy6D,MAAL,GAAc,CAFtB;AAAA,cAGItyD,CAAC,GAAG,KAAKsyD,MAAL,GAAc,CAHtB;;AAKA,cAAI54B,aAAa,CAAC7E,MAAlB,EAA0B;AACtB,gBAAIkhC,EAAE,GAAGr8B,aAAa,CAAC+oB,WAAd,IAA6B,CAAtC;AACA/rD,aAAC,IAAIq/D,EAAL;AACAh/D,aAAC,IAAIg/D,EAAL;AACAl+D,aAAC,IAAKk+D,EAAE,GAAG,CAAX;AACA/1D,aAAC,IAAK+1D,EAAE,GAAG,CAAX;AACH;;AACD,iBAAO,CAAEr/D,CAAF,EAAKK,CAAL,EAAQc,CAAR,EAAWmI,CAAX,EAAc,KAAKsyD,MAAnB,CAAP;AACH,SAfD;AAgBH,OAxBD;;AAyBA9kC,SAAG,CAAC1G,MAAJ,CAAW6rB,GAAG,CAAC3e,SAAJ,CAAc4jC,GAAzB,EAA8BjlB,GAAG,CAAC3e,SAAJ,CAAc2jC,gBAA5C;;AAEAhlB,SAAG,CAAC3e,SAAJ,CAAc+jC,SAAd,GAA0B,UAAU/pD,MAAV,EAAkB;AACxC,aAAKpD,IAAL,GAAY,WAAZ;;AACA,YAAI0lD,MAAM,GAAG3d,GAAG,CAAC3e,SAAJ,CAAc2jC,gBAAd,CAA+Bh4D,KAA/B,CAAqC,IAArC,EAA2C0F,SAA3C,CAAb;;AACA2I,cAAM,GAAGA,MAAM,IAAI,EAAnB;AACA,aAAK4c,KAAL,GAAa5c,MAAM,CAAC4c,KAAP,IAAgB,EAA7B;AACA,aAAKD,MAAL,GAAc3c,MAAM,CAAC2c,MAAP,IAAiB,EAA/B;;AAEA,aAAK6oC,QAAL,GAAgB,UAAUzd,WAAV,EAAuB7N,WAAvB,EAAoCxO,aAApC,EAAmDkgB,mBAAnD,EAAwE;AACpF,cAAIhvB,KAAK,GAAG8O,aAAa,CAAC9O,KAAd,IAAuB,KAAKA,KAAxC;AAAA,cACID,MAAM,GAAG+O,aAAa,CAAC/O,MAAd,IAAwB,KAAKA,MAD1C;AAAA,cAEIj0B,CAAC,GAAGq/C,WAAW,CAAC,CAAD,CAAX,GAAkBnrB,KAAK,GAAG,CAFlC;AAAA,cAGI7zB,CAAC,GAAGg/C,WAAW,CAAC,CAAD,CAAX,GAAkBprB,MAAM,GAAG,CAHnC;AAKA,iBAAO,CAAEj0B,CAAF,EAAKK,CAAL,EAAQ6zB,KAAR,EAAeD,MAAf,CAAP;AACH,SAPD;AAQH,OAfD;;AAgBA6C,SAAG,CAAC1G,MAAJ,CAAW6rB,GAAG,CAAC3e,SAAJ,CAAc+jC,SAAzB,EAAoCplB,GAAG,CAAC3e,SAAJ,CAAc2jC,gBAAlD;;AAEA,UAAIK,kBAAkB,GAAG,SAArBA,kBAAqB,CAAUhqD,MAAV,EAAkB;AACvC2kC,WAAG,CAACtjB,kBAAJ,CAAuB1vB,KAAvB,CAA6B,IAA7B,EAAmC0F,SAAnC;;AACA,aAAKuoB,QAAL,CAAcqqC,eAAd,GAAgC,EAAhC;AACH,OAHD;;AAIAzqC,SAAG,CAAC1G,MAAJ,CAAWkxC,kBAAX,EAA+BrlB,GAAG,CAACtjB,kBAAnC,EAAuD;AACnD6oC,0BAAkB,EAAE,8BAAY;AAC5B,iBAAO,KAAKtqC,QAAL,CAAcqqC,eAArB;AACH,SAHkD;AAInDE,4BAAoB,EAAE,8BAAUzyD,EAAV,EAAc;AAChC,eAAKkoB,QAAL,CAAcqqC,eAAd,CAA8Bj7D,IAA9B,CAAmC0I,EAAnC;AACH;AANkD,OAAvD;AASA;;;;;AAIA;;;;;;;;;;;;AAaAitC,SAAG,CAAC3e,SAAJ,CAAcokC,KAAd,GAAsB,UAAUpqD,MAAV,EAAkB;AAEpC,aAAKpD,IAAL,GAAY,OAAZ;AACAotD,0BAAkB,CAACr4D,KAAnB,CAAyB,IAAzB,EAA+B0F,SAA/B;;AACAstC,WAAG,CAAC3e,SAAJ,CAAc2jC,gBAAd,CAA+Bh4D,KAA/B,CAAqC,IAArC,EAA2C0F,SAA3C;;AAEA,YAAIgzD,OAAO,GAAGrqD,MAAM,CAACsqD,MAArB;AAAA,YACIC,GAAG,GAAGvqD,MAAM,CAACuqD,GAAP,IAAcvqD,MAAM,CAACwqD,GAD/B;AAAA,YAEI3mC,KAAK,GAAG7jB,MAAM,CAACsjB,QAAP,GAAkB,MAAMtjB,MAAM,CAACsjB,QAA/B,GAA0C,EAFtD;AAIA,aAAK1D,QAAL,CAAc6qC,GAAd,GAAoB,IAAIL,KAAJ,EAApB;AACA,aAAKxqC,QAAL,CAAcggB,KAAd,GAAsB,KAAtB;AACA,aAAKhgB,QAAL,CAAcgJ,WAAd,GAA4B,KAA5B;AACA,aAAKhJ,QAAL,CAAc8qC,OAAd,GAAwB,KAAxB;AACA,aAAK9qC,QAAL,CAAc+qC,UAAd,GAA2B3qD,MAAM,CAAC4c,KAAlC;AACA,aAAKgD,QAAL,CAAcgrC,WAAd,GAA4B5qD,MAAM,CAAC2c,MAAnC;AACA,aAAKiD,QAAL,CAAcjB,QAAd,GAAyB3e,MAAM,CAAC2e,QAAhC;;AAEA,aAAKiB,QAAL,CAAc6qC,GAAd,CAAkBH,MAAlB,GAA2B,YAAY;AACnC,cAAI,KAAK1qC,QAAL,IAAiB,IAArB,EAA2B;AACvB,iBAAKA,QAAL,CAAcggB,KAAd,GAAsB,IAAtB;AACA,iBAAKhgB,QAAL,CAAc+qC,UAAd,GAA2B,KAAK/qC,QAAL,CAAc+qC,UAAd,IAA4B,KAAK/qC,QAAL,CAAc6qC,GAAd,CAAkB7tC,KAAzE;AACA,iBAAKgD,QAAL,CAAcgrC,WAAd,GAA4B,KAAKhrC,QAAL,CAAcgrC,WAAd,IAA6B,KAAKhrC,QAAL,CAAc6qC,GAAd,CAAkB9tC,MAA3E;;AACA,gBAAI0tC,OAAJ,EAAa;AACTA,qBAAO,CAAC,IAAD,CAAP;AACH;AACJ;AACJ,SAT0B,CASzB7+C,IATyB,CASpB,IAToB,CAA3B;AAWA;;;;;;;;;AAQA,aAAKoU,QAAL,CAAcjB,QAAd,CAAuBksC,QAAvB,GAAkC,UAAUC,IAAV,EAAgBR,MAAhB,EAAwB;AACtD,cAAIjhE,CAAC,GAAGyhE,IAAI,CAAC7yD,WAAL,KAAqBC,MAArB,GAA8B4yD,IAA9B,GAAqCA,IAAI,CAACP,GAAlD;AACAF,iBAAO,GAAGC,MAAV;AACA,eAAK1qC,QAAL,CAAc6qC,GAAd,CAAkBF,GAAlB,GAAwBlhE,CAAxB;;AAEA,cAAI,KAAKk6B,MAAL,IAAe,IAAnB,EAAyB;AACrB,iBAAKA,MAAL,CAAY5oB,YAAZ,CAAyB,KAAzB,EAAgC,KAAKilB,QAAL,CAAc6qC,GAAd,CAAkBF,GAAlD;AACH;AACJ,SARiC,CAQhC/+C,IARgC,CAQ3B,IAR2B,CAAlC;;AAUA,aAAKoU,QAAL,CAAcjB,QAAd,CAAuBksC,QAAvB,CAAgCN,GAAhC,EAAqCF,OAArC;;AACA,aAAK7E,QAAL,GAAgB,UAAUzd,WAAV,EAAuB7N,WAAvB,EAAoCxO,aAApC,EAAmDkgB,mBAAnD,EAAwE;AACpF,eAAK7D,WAAL,GAAmBA,WAAnB;;AACA,cAAI,KAAKnoB,QAAL,CAAcggB,KAAlB,EAAyB;AACrB,mBAAO,CAACmI,WAAW,CAAC,CAAD,CAAX,GAAiB,KAAKnoB,QAAL,CAAc+qC,UAAd,GAA2B,CAA7C,EAAgD5iB,WAAW,CAAC,CAAD,CAAX,GAAiB,KAAKnoB,QAAL,CAAcgrC,WAAd,GAA4B,CAA7F,EACH,KAAKhrC,QAAL,CAAc+qC,UADX,EACuB,KAAK/qC,QAAL,CAAcgrC,WADrC,CAAP;AAEH,WAHD,MAIK;AACD,mBAAO,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,CAAP;AACH;AACJ,SATD;;AAWA,aAAKrnC,MAAL,GAAcohB,GAAG,CAAC0D,aAAJ,CAAkB,KAAlB,EAAyB;AACnC/6B,kBAAQ,EAAC,UAD0B;AAEnCy9C,gBAAM,EAAC,CAF4B;AAGnCC,iBAAO,EAAC,CAH2B;AAInCC,iBAAO,EAAC;AAJ2B,SAAzB,EAKX,KAAKrrC,QAAL,CAActC,QAAd,CAAuBuS,aAAvB,GAAuChM,KAL5B,CAAd;;AAOA,YAAI,KAAKjE,QAAL,CAAc+qC,UAAlB,EAA8B;AAC1B,eAAKpnC,MAAL,CAAY5oB,YAAZ,CAAyB,OAAzB,EAAkC,KAAKilB,QAAL,CAAc+qC,UAAhD;AACH;;AACD,YAAI,KAAK/qC,QAAL,CAAcgrC,WAAlB,EAA+B;AAC3B,eAAKrnC,MAAL,CAAY5oB,YAAZ,CAAyB,QAAzB,EAAmC,KAAKilB,QAAL,CAAcgrC,WAAjD;AACH;;AACD,aAAKhrC,QAAL,CAActC,QAAd,CAAuBib,aAAvB,CAAqC,KAAKhV,MAA1C;;AAEA,aAAK2nC,aAAL,GAAqB,UAAUpgE,CAAV,EAAauiB,KAAb,EAAoBoR,MAApB,EAA4B;AAC7C,cAAI,CAAC,KAAKmB,QAAL,CAAc8qC,OAAnB,EAA4B;AACxB,gBAAI,CAAC,KAAK9qC,QAAL,CAAcgJ,WAAnB,EAAgC;AAC5B,mBAAKrF,MAAL,CAAY5oB,YAAZ,CAAyB,KAAzB,EAAgC,KAAKilB,QAAL,CAAc6qC,GAAd,CAAkBF,GAAlD;AACA,mBAAKJ,oBAAL,CAA0B,KAAK5mC,MAA/B;AACA,mBAAK3D,QAAL,CAAcgJ,WAAd,GAA4B,IAA5B;AACH;;AACD,gBAAIlgC,CAAC,GAAG,KAAKq/C,WAAL,CAAiB,CAAjB,IAAuB,KAAKnoB,QAAL,CAAc+qC,UAAd,GAA2B,CAA1D;AAAA,gBACI5hE,CAAC,GAAG,KAAKg/C,WAAL,CAAiB,CAAjB,IAAuB,KAAKnoB,QAAL,CAAcgrC,WAAd,GAA4B,CAD3D;;AAEAprC,eAAG,CAAC9C,WAAJ,CAAgB,KAAK6G,MAArB,EAA6B76B,CAA7B,EAAgCK,CAAhC,EAAmC,KAAK62B,QAAL,CAAc+qC,UAAjD,EAA6D,KAAK/qC,QAAL,CAAcgrC,WAA3E;AACH;AACJ,SAXD;;AAaA,aAAK15B,KAAL,GAAa,UAAU7jB,KAAV,EAAiBoR,MAAjB,EAAyB;AAClC,cAAI,KAAKmB,QAAL,IAAiB,IAArB,EAA2B;AAAG;AAC1B,gBAAI,KAAKA,QAAL,CAAcggB,KAAlB,EAAyB;AACrB,mBAAKsrB,aAAL,CAAmB79C,KAAnB,EAA0BoR,MAA1B;AACH,aAFD,MAGK;AACDl2B,kBAAI,CAAC2T,UAAL,CAAgB,YAAY;AACxB,qBAAKg1B,KAAL,CAAW7jB,KAAX,EAAkBoR,MAAlB;AACH,eAFe,CAEdjT,IAFc,CAET,IAFS,CAAhB,EAEc,GAFd;AAGH;AACJ;AACJ,SAXD;AAYH,OAnGD;;AAoGAgU,SAAG,CAAC1G,MAAJ,CAAW6rB,GAAG,CAAC3e,SAAJ,CAAcokC,KAAzB,EAAgC,CAAEJ,kBAAF,EAAsBrlB,GAAG,CAAC3e,SAAJ,CAAc2jC,gBAApC,CAAhC,EAAwF;AACpF/0B,eAAO,EAAE,iBAAUrlB,KAAV,EAAiB;AACtB,cAAIA,KAAJ,EAAW;AACP,iBAAKqQ,QAAL,CAAc8qC,OAAd,GAAwB,IAAxB;;AACA,gBAAI,KAAKnnC,MAAT,EAAiB;AACb,mBAAKA,MAAL,CAAY1rB,UAAZ,CAAuB0I,WAAvB,CAAmC,KAAKgjB,MAAxC;AACH;;AACD,iBAAKA,MAAL,GAAc,IAAd;AACH;AACJ;AATmF,OAAxF;AAYA;;;;;;AAIAohB,SAAG,CAAC3e,SAAJ,CAAcmlC,KAAd,GAAsB,UAAUnrD,MAAV,EAAkB;AACpC,YAAIsiD,MAAM,GAAG3d,GAAG,CAAC3e,SAAJ,CAAc2jC,gBAAd,CAA+Bh4D,KAA/B,CAAqC,IAArC,EAA2C0F,SAA3C,CAAb;;AACA,aAAKuF,IAAL,GAAY,OAAZ;AACAotD,0BAAkB,CAACr4D,KAAnB,CAAyB,IAAzB,EAA+B0F,SAA/B;;AACA,aAAKmuD,QAAL,GAAgB,UAAUzd,WAAV,EAAuB7N,WAAvB,EAAoCxO,aAApC,EAAmDkgB,mBAAnD,EAAwE;AACpF,iBAAO,CAAC7D,WAAW,CAAC,CAAD,CAAZ,EAAiBA,WAAW,CAAC,CAAD,CAA5B,EAAiC,EAAjC,EAAqC,CAArC,CAAP;AACH,SAFD;;AAIA,YAAIlkB,KAAK,GAAG7jB,MAAM,CAACsjB,QAAP,GAAkB,MAAMtjB,MAAM,CAACsjB,QAA/B,GAA0C,EAAtD;AAEA,aAAKC,MAAL,GAAcohB,GAAG,CAAC0D,aAAJ,CAAkB,KAAlB,EAAyB;AACnC+G,iBAAO,EAAE,OAD0B;AAEnCxyB,eAAK,EAAE,KAF4B;AAGnCD,gBAAM,EAAE,KAH2B;AAInCyuC,oBAAU,EAAE,aAJuB;AAKnC99C,kBAAQ,EAAE;AALyB,SAAzB,EAMX,KAAKsS,QAAL,CAActC,QAAd,CAAuBuS,aAAvB,GAAuChM,KAN5B,CAAd;;AAQA,aAAKjE,QAAL,CAActC,QAAd,CAAuBib,aAAvB,CAAqC,KAAKhV,MAA1C;;AAEA,aAAK2N,KAAL,GAAa,UAAU7jB,KAAV,EAAiBoR,MAAjB,EAAyB;AAClCe,aAAG,CAAC9C,WAAJ,CAAgB,KAAK6G,MAArB,EAA6B,KAAK76B,CAAlC,EAAqC,KAAKK,CAA1C,EAA6C,KAAKc,CAAlD,EAAqD,KAAKmI,CAA1D;AACH,SAFD;AAGH,OAvBD;;AAwBAwtB,SAAG,CAAC1G,MAAJ,CAAW6rB,GAAG,CAAC3e,SAAJ,CAAcmlC,KAAzB,EAAgC,CAACxmB,GAAG,CAAC3e,SAAJ,CAAc2jC,gBAAf,EAAiCK,kBAAjC,CAAhC,EAAsF;AAClFp1B,eAAO,EAAE,mBAAY;AACjB,cAAI,KAAKrR,MAAL,IAAe,KAAKA,MAAL,CAAY1rB,UAA/B,EAA2C;AACvC,iBAAK0rB,MAAL,CAAY1rB,UAAZ,CAAuB0I,WAAvB,CAAmC,KAAKgjB,MAAxC;AACH;AACJ;AALiF,OAAtF;AAQA;;;;;AAIA;;;;;;;;;;AAQAohB,SAAG,CAAC3e,SAAJ,CAAcqlC,QAAd,GAAyB,UAAUrrD,MAAV,EAAkB;AACvC,aAAKpD,IAAL,GAAY,UAAZ;;AACA+nC,WAAG,CAAC3e,SAAJ,CAAc2jC,gBAAd,CAA+Bh4D,KAA/B,CAAqC,IAArC,EAA2C0F,SAA3C;;AACA,YAAIiqB,IAAI,GAAG,IAAX;AACAthB,cAAM,GAAGA,MAAM,IAAI,EAAnB;AACAA,cAAM,CAAC4c,KAAP,GAAe5c,MAAM,CAAC4c,KAAP,IAAgB,EAA/B;AACA5c,cAAM,CAAC2c,MAAP,GAAgB3c,MAAM,CAAC2c,MAAP,IAAiB,EAAjC;AACA,aAAKC,KAAL,GAAa5c,MAAM,CAAC4c,KAApB;AACA,aAAKD,MAAL,GAAc3c,MAAM,CAAC2c,MAArB;;AACA,aAAK6oC,QAAL,GAAgB,UAAUzd,WAAV,EAAuB7N,WAAvB,EAAoCxO,aAApC,EAAmDkgB,mBAAnD,EAAwE;AACpF,cAAIhvB,KAAK,GAAG8O,aAAa,CAAC9O,KAAd,IAAuB0E,IAAI,CAAC1E,KAAxC;AAAA,cACID,MAAM,GAAG+O,aAAa,CAAC/O,MAAd,IAAwB2E,IAAI,CAAC3E,MAD1C;AAAA,cAEIj0B,CAAC,GAAGq/C,WAAW,CAAC,CAAD,CAAX,GAAkBnrB,KAAK,GAAG,CAFlC;AAAA,cAGI7zB,CAAC,GAAGg/C,WAAW,CAAC,CAAD,CAAX,GAAkBprB,MAAM,GAAG,CAHnC;AAIA,iBAAO,CAAEj0B,CAAF,EAAKK,CAAL,EAAQ6zB,KAAR,EAAeD,MAAf,CAAP;AACH,SAND;AAOH,OAhBD,CA9uCS,CA+vCb;AAGA;;;AAEI,UAAI2uC,eAAe,GAAG3mB,GAAG,CAACje,QAAJ,CAAa4kC,eAAb,GAA+B,UAAUtrD,MAAV,EAAkB;AACnE,aAAKopC,OAAL,GAAe,IAAf;AACA,aAAKrC,oBAAL,GAA4B,IAA5B;AACA,aAAKpnB,SAAL,GAAiB3f,MAAM,CAAC2f,SAAxB;AACA,aAAKwmB,GAAL,GAAWnmC,MAAM,CAACvV,QAAP,IAAmB,IAAnB,GAA0B,GAA1B,GAAgCuV,MAAM,CAACvV,QAAlD;AACA,aAAK8gE,WAAL,GAAmBvrD,MAAM,CAACwrD,gBAAP,IAA2B,IAA3B,GAAkC,CAAE,GAAF,EAAO,GAAP,CAAlC,GAAgDxrD,MAAM,CAACwrD,gBAA1E;AACA,aAAKpiB,OAAL,GAAeppC,MAAM,CAACopC,OAAP,KAAmB,KAAlC;AACH,OAPD;;AAQAkiB,qBAAe,CAACn3D,SAAhB,GAA4B;AACxBygC,eAAO,EAAE,iBAAUrlB,KAAV,EAAiB;AACtB,cAAIA,KAAJ,EAAW;AACP,iBAAKoQ,SAAL,GAAiB,IAAjB;AACA,iBAAK4D,MAAL,GAAc,IAAd;AACA,iBAAKgoC,WAAL,GAAmB,IAAnB;AACH;AACJ,SAPuB;AAQxB3lB,gBAAQ,EAAC,kBAAStoB,QAAT,EAAmBqC,SAAnB,EAA8B,CAAG,CARlB;AASxBmP,kBAAU,EAAE,oBAAUzoB,GAAV,EAAe;AACvB,eAAK+iC,OAAL,GAAe/iC,GAAf;AACA,eAAKsZ,SAAL,CAAeyB,OAAf;AACH,SAZuB;AAaxB6N,iBAAS,EAAE,qBAAY;AACnB,iBAAO,KAAKma,OAAZ;AACH,SAfuB;AAgBxB1Q,YAAI,EAAE,gBAAY;AACd,eAAK5J,UAAL,CAAgB,KAAhB;AACH,SAlBuB;AAmBxByT,YAAI,EAAE,gBAAY;AACd,eAAKzT,UAAL,CAAgB,IAAhB;AACH,SArBuB;AAsBxB28B,yBAAiB,EAAE,2BAAUC,MAAV,EAAkB;AACjC,eAAKvlB,GAAL,IAAYulB,MAAZ;AACA,eAAK/rC,SAAL,CAAeyB,OAAf;AACH,SAzBuB;AA0BxBimB,mBAAW,EAAE,qBAAUpuC,CAAV,EAAa;AACtB,eAAKktC,GAAL,GAAWltC,CAAX;AACA,eAAK0mB,SAAL,CAAeyB,OAAf;AACH,SA7BuB;AA8BxBuqC,mBAAW,EAAE,uBAAY;AACrB,iBAAO,KAAKxlB,GAAZ;AACH,SAhCuB;AAiCxBR,kBAAU,EAAC,sBAAW,CAAG;AAjCD,OAA5B;AAqCA;;;;;;;;;AAQA;;;;;;;;;;;;;;AAaAhB,SAAG,CAACje,QAAJ,CAAaklC,KAAb,GAAqB,UAAU5rD,MAAV,EAAkB;AACnC,aAAKpD,IAAL,GAAY,OAAZ;AACA0uD,uBAAe,CAAC35D,KAAhB,CAAsB,IAAtB,EAA4B0F,SAA5B;AACA,aAAK0vC,oBAAL,GAA4B,KAA5B;AACA/mC,cAAM,GAAGA,MAAM,IAAI,EAAnB;AACA,YAAIshB,IAAI,GAAG,IAAX;AAEA,aAAKt3B,MAAL,GAAcgW,MAAM,CAAChW,MAAP,IAAiB,EAA/B;AACA,aAAK4yB,KAAL,GAAa5c,MAAM,CAAC4c,KAAP,IAAgB,EAA7B;AACA,aAAKvH,EAAL,GAAUrV,MAAM,CAACqV,EAAjB;AACA,aAAKxlB,SAAL,GAAiB,CAACmQ,MAAM,CAACnQ,SAAP,IAAoB,CAArB,IAA0B,CAA1B,GAA8B,CAAC,CAA/B,GAAmC,CAApD;AACA,YAAIgwB,UAAU,GAAG7f,MAAM,CAAC6f,UAAP,IAAqB;AAAE,0BAAgB;AAAlB,SAAtC;AAAA,YACA;AACIgsC,gBAAQ,GAAG7rD,MAAM,CAAC6rD,QAAP,IAAmB,KAFlC;;AAIA,aAAKC,cAAL,GAAsB,YAAY;AAC9B,iBAAOxqC,IAAI,CAAC1E,KAAL,GAAa,GAApB;AACH,SAFD;;AAIA,aAAKmvC,cAAL,GAAsB,UAASh9D,CAAT,EAAY4wB,SAAZ,EAAuB;AACzC,eAAKhnB,IAAL,GAAY5J,CAAZ;;AACA,cAAIiR,MAAM,CAACkP,MAAX,EAAmB;AACf,iBAAK,IAAI5kB,CAAT,IAAc0V,MAAM,CAACkP,MAArB,EAA6B;AACzBy1B,iBAAG,CAACnkC,EAAJ,CAAOzR,CAAP,EAAUzE,CAAV,EAAa0V,MAAM,CAACkP,MAAP,CAAc5kB,CAAd,CAAb;AACH;AACJ;AACJ,SAPD;;AASA,aAAKguC,IAAL,GAAY,UAAU3Y,SAAV,EAAqBqsC,2BAArB,EAAkD;AAE1D,cAAIC,GAAJ,EAASC,GAAT,EAAc9f,GAAd,EAAmB+f,IAAnB,EAAyBC,GAAzB;;AACA,cAAIzsC,SAAS,CAACmjC,kBAAd,EAAkC;AAE9B,gBAAItjC,GAAG,CAACpJ,QAAJ,CAAa,KAAK+vB,GAAlB,KAA0B,KAAKA,GAAL,GAAW,CAArC,IAA0C,KAAKA,GAAL,GAAW,CAAzD,EAA4D;AACxD,kBAAIltC,CAAC,GAAGozD,QAAQ,CAAC,KAAKlmB,GAAN,EAAW,EAAX,CAAhB;AAAA,kBACImmB,OAAO,GAAG,KAAKnmB,GAAL,GAAW,CAAX,GAAe,CAAf,GAAmB,CADjC;AAEA8lB,iBAAG,GAAGtsC,SAAS,CAACmjC,kBAAV,CAA6BwJ,OAA7B,EAAsCrzD,CAAtC,EAAyC,KAAzC,CAAN;AACAizD,iBAAG,GAAGvsC,SAAS,CAACmjC,kBAAV,CAA6BwJ,OAA7B,EAAsCrzD,CAAC,GAAI,KAAKpJ,SAAL,GAAiB,KAAK7F,MAAtB,GAA+B,CAA1E,EAA8E,KAA9E,CAAN;AACAoiD,iBAAG,GAAG4V,GAAG,CAACjsD,WAAJ,CAAgBk2D,GAAhB,EAAqBC,GAArB,EAA0B,KAAKliE,MAA/B,CAAN;AACH,aAND,MAOK,IAAI,KAAKm8C,GAAL,KAAa,CAAjB,EAAoB;AACrB8lB,iBAAG,GAAGtsC,SAAS,CAACgjC,WAAV,CAAsB,KAAKxc,GAA3B,CAAN;AACA+lB,iBAAG,GAAGvsC,SAAS,CAACmjC,kBAAV,CAA6B,KAAK3c,GAAlC,EAAuC,CAAE,KAAKn8C,MAA9C,CAAN;AACAoiD,iBAAG,GAAG4V,GAAG,CAACjsD,WAAJ,CAAgBk2D,GAAhB,EAAqBC,GAArB,EAA0B,KAAKliE,MAA/B,CAAN;;AAEA,kBAAI,KAAK6F,SAAL,KAAmB,CAAC,CAAxB,EAA2B;AACvB,oBAAIgzD,CAAC,GAAGzW,GAAR;AACAA,mBAAG,GAAG6f,GAAN;AACAA,mBAAG,GAAGpJ,CAAN;AACH;AACJ,aAVI,MAWA,IAAI,KAAK1c,GAAL,KAAa,CAAjB,EAAoB;AACrBiG,iBAAG,GAAGzsB,SAAS,CAACgjC,WAAV,CAAsB,KAAKxc,GAA3B,CAAN;AACA+lB,iBAAG,GAAGvsC,SAAS,CAACmjC,kBAAV,CAA6B,KAAK3c,GAAlC,EAAuC,KAAKn8C,MAA5C,CAAN;AACAiiE,iBAAG,GAAGjK,GAAG,CAACjsD,WAAJ,CAAgBq2C,GAAhB,EAAqB8f,GAArB,EAA0B,KAAKliE,MAA/B,CAAN;;AACA,kBAAI,KAAK6F,SAAL,KAAmB,CAAC,CAAxB,EAA2B;AACvB,oBAAI08D,EAAE,GAAGngB,GAAT;AACAA,mBAAG,GAAG6f,GAAN;AACAA,mBAAG,GAAGM,EAAN;AACH;AACJ,aATI,MAUA;AACDN,iBAAG,GAAGtsC,SAAS,CAACmjC,kBAAV,CAA6B,KAAK3c,GAAlC,EAAuC,KAAKt2C,SAAL,GAAiB,KAAK7F,MAAtB,GAA+B,CAAtE,CAAN;AACAkiE,iBAAG,GAAGvsC,SAAS,CAACgjC,WAAV,CAAsB,KAAKxc,GAA3B,CAAN;AACAiG,iBAAG,GAAG4V,GAAG,CAACjsD,WAAJ,CAAgBk2D,GAAhB,EAAqBC,GAArB,EAA0B,KAAKliE,MAA/B,CAAN;AACH;;AAEDmiE,gBAAI,GAAGnK,GAAG,CAAC5rD,mBAAJ,CAAwB61D,GAAxB,EAA6B7f,GAA7B,EAAkC,KAAKxvB,KAAvC,CAAP;AACAwvC,eAAG,GAAGpK,GAAG,CAACjsD,WAAJ,CAAgBk2D,GAAhB,EAAqB7f,GAArB,EAA0Byf,QAAQ,GAAG,KAAK7hE,MAA1C,CAAN;AAEA,gBAAIc,CAAC,GAAG;AAAEmhE,iBAAG,EAAEA,GAAP;AAAYE,kBAAI,EAAEA,IAAlB;AAAwBC,iBAAG,EAAEA;AAA7B,aAAR;AAAA,gBACIvlC,MAAM,GAAGhH,UAAU,CAACgH,MAAX,IAAqBmlC,2BAA2B,CAACnlC,MAD9D;AAAA,gBAEI5G,IAAI,GAAGJ,UAAU,CAACI,IAAX,IAAmB+rC,2BAA2B,CAACnlC,MAF1D;AAAA,gBAGI2lC,SAAS,GAAG3sC,UAAU,CAAC40B,WAAX,IAA0BuX,2BAA2B,CAACvX,WAHtE;AAKA,mBAAO;AACH90B,uBAAS,EAAEA,SADR;AAEH70B,eAAC,EAAEA,CAFA;AAGH,8BAAgB0hE,SAHb;AAIH3lC,oBAAM,EAAEA,MAJL;AAKH5G,kBAAI,EAAEA,IALH;AAMH40B,kBAAI,EAAErsD,IAAI,CAACkD,GAAL,CAASugE,GAAG,CAACvjE,CAAb,EAAgByjE,IAAI,CAAC,CAAD,CAAJ,CAAQzjE,CAAxB,EAA2ByjE,IAAI,CAAC,CAAD,CAAJ,CAAQzjE,CAAnC,CANH;AAOHusD,kBAAI,EAAEzsD,IAAI,CAACgD,GAAL,CAASygE,GAAG,CAACvjE,CAAb,EAAgByjE,IAAI,CAAC,CAAD,CAAJ,CAAQzjE,CAAxB,EAA2ByjE,IAAI,CAAC,CAAD,CAAJ,CAAQzjE,CAAnC,CAPH;AAQHqsD,kBAAI,EAAEvsD,IAAI,CAACkD,GAAL,CAASugE,GAAG,CAACljE,CAAb,EAAgBojE,IAAI,CAAC,CAAD,CAAJ,CAAQpjE,CAAxB,EAA2BojE,IAAI,CAAC,CAAD,CAAJ,CAAQpjE,CAAnC,CARH;AASHosD,kBAAI,EAAE3sD,IAAI,CAACgD,GAAL,CAASygE,GAAG,CAACljE,CAAb,EAAgBojE,IAAI,CAAC,CAAD,CAAJ,CAAQpjE,CAAxB,EAA2BojE,IAAI,CAAC,CAAD,CAAJ,CAAQpjE,CAAnC;AATH,aAAP;AAWH,WAvDD,MAwDK;AACD,mBAAO;AAAC42B,uBAAS,EAAEA,SAAZ;AAAuBk1B,kBAAI,EAAE,CAA7B;AAAgCI,kBAAI,EAAE,CAAtC;AAAyCF,kBAAI,EAAE,CAA/C;AAAkDI,kBAAI,EAAE;AAAxD,aAAP;AACH;AACJ,SA9DD;AA+DH,OA3FD;;AA4FA31B,SAAG,CAAC1G,MAAJ,CAAW6rB,GAAG,CAACje,QAAJ,CAAaklC,KAAxB,EAA+BN,eAA/B,EAAgD;AAC5C3lB,kBAAU,EAAC,oBAAS76C,CAAT,EAAY;AACnB,eAAKd,MAAL,GAAcc,CAAC,CAACd,MAAF,IAAY,KAAKA,MAA/B;AACA,eAAK4yB,KAAL,GAAa9xB,CAAC,CAAC8xB,KAAF,IAAU,KAAKA,KAA5B;AACA,eAAK/sB,SAAL,GAAiB/E,CAAC,CAAC+E,SAAF,IAAe,IAAf,GAAsB/E,CAAC,CAAC+E,SAAxB,GAAoC,KAAKA,SAA1D;AACA,eAAKg8D,QAAL,GAAgB/gE,CAAC,CAAC+gE,QAAF,IAAa,KAAKA,QAAlC;AACH,SAN2C;AAO5Cj3B,eAAO,EAAC,mBAAW;AACf,cAAI,KAAKj8B,IAAL,IAAa,KAAKA,IAAL,CAAUd,UAA3B,EAAuC;AACnC,iBAAKc,IAAL,CAAUd,UAAV,CAAqB0I,WAArB,CAAiC,KAAK5H,IAAtC;AACH;AACJ;AAX2C,OAAhD;AAcA;;;;;;;;AAOA;;;;;;AAIAgsC,SAAG,CAACje,QAAJ,CAAa+lC,UAAb,GAA0B,UAAUzsD,MAAV,EAAkB;AACxCA,cAAM,GAAGA,MAAM,IAAI,EAAnB;;AACA,YAAIjR,CAAC,GAAG41C,GAAG,CAAC7rB,MAAJ,CAAW9Y,MAAX,EAAmB;AAAC6rD,kBAAQ,EAAE;AAAX,SAAnB,CAAR;;AACAlnB,WAAG,CAACje,QAAJ,CAAaklC,KAAb,CAAmB93D,IAAnB,CAAwB,IAAxB,EAA8B/E,CAA9B;;AACA,aAAK6N,IAAL,GAAY,YAAZ;AACH,OALD;;AAMA4iB,SAAG,CAAC1G,MAAJ,CAAW6rB,GAAG,CAACje,QAAJ,CAAa+lC,UAAxB,EAAoC9nB,GAAG,CAACje,QAAJ,CAAaklC,KAAjD;AAEA;;;;;;;;;;;;AAWA;;;;;;AAIAjnB,SAAG,CAACje,QAAJ,CAAagmC,OAAb,GAAuB,UAAU1sD,MAAV,EAAkB;AACrCA,cAAM,GAAGA,MAAM,IAAI,EAAnB;;AACA,YAAI/G,CAAC,GAAG+G,MAAM,CAAChW,MAAP,IAAiB,EAAzB;AAAA,YACI+E,CAAC,GAAG41C,GAAG,CAAC7rB,MAAJ,CAAW9Y,MAAX,EAAmB;AAAChW,gBAAM,EAAEiP,CAAC,GAAG,CAAb;AAAgB4yD,kBAAQ,EAAE;AAA1B,SAAnB,CADR;;AAEAlnB,WAAG,CAACje,QAAJ,CAAaklC,KAAb,CAAmB93D,IAAnB,CAAwB,IAAxB,EAA8B/E,CAA9B;;AACA,aAAK6N,IAAL,GAAY,SAAZ;AACH,OAND;;AAOA4iB,SAAG,CAAC1G,MAAJ,CAAW6rB,GAAG,CAACje,QAAJ,CAAagmC,OAAxB,EAAiC/nB,GAAG,CAACje,QAAJ,CAAaklC,KAA9C;;AAEA,UAAIe,cAAc,GAAG,SAAjBA,cAAiB,CAAUhtC,SAAV,EAAqBitC,YAArB,EAAmC;AACpD,YAAIjtC,SAAS,CAACC,QAAV,CAAmBitC,gBAAnB,IAAuC,IAAvC,IAA+CD,YAAnD,EAAiE;AAC7DjtC,mBAAS,CAACC,QAAV,CAAmBitC,gBAAnB,GAAsCltC,SAAS,CAACmtC,aAAV,EAAtC;AACH;;AACD,eAAOntC,SAAS,CAACC,QAAV,CAAmBitC,gBAA1B;AACH,OALD,CA39CS,CAk+CT;;;AACA,UAAIE,kBAAkB,GAAG,SAArBA,kBAAqB,CAAU/sD,MAAV,EAAkB;AACvC2kC,WAAG,CAACtjB,kBAAJ,CAAuB1vB,KAAvB,CAA6B,IAA7B,EAAmC0F,SAAnC;;AACAi0D,uBAAe,CAAC35D,KAAhB,CAAsB,IAAtB,EAA4B0F,SAA5B,EAFuC,CAIvC;;AACA,YAAIsJ,EAAE,GAAG,KAAKkb,IAAd;;AACA,aAAKA,IAAL,GAAY,YAAY;AACpBlb,YAAE,CAAChP,KAAH,CAAS,IAAT,EAAe0F,SAAf;;AACA,cAAI,KAAKsoB,SAAT,EAAoB;AAChB,iBAAKA,SAAL,CAAe9D,IAAf,CAAoBlqB,KAApB,CAA0B,KAAKguB,SAA/B,EAA0CtoB,SAA1C;AACH;AACJ,SALD;;AAOA,aAAK21D,QAAL,GAAc,KAAd;AACA,aAAK33C,EAAL,GAAUrV,MAAM,CAACqV,EAAjB;AACA,aAAKuK,QAAL,CAAcqtC,GAAd,GAAoB,IAApB;AACA,aAAKrtC,QAAL,CAAcstC,WAAd,GAA4B,KAA5B;AACA,aAAKttC,QAAL,CAAcD,SAAd,GAA0B3f,MAAM,CAAC2f,SAAjC;AACA,aAAKC,QAAL,CAAcitC,gBAAd,GAAiC,IAAjC;AACA,aAAKjtC,QAAL,CAAc8C,MAAd,GAAuB1iB,MAAM,CAAC0iB,MAA9B;AACA,aAAK9C,QAAL,CAAcutC,kBAAd,GAAmCntD,MAAM,CAACopC,OAAP,KAAmB,KAAtD;;AAEA,aAAK1hB,UAAL,GAAkB,YAAY;AAC1B,cAAI,KAAK9H,QAAL,CAAcqtC,GAAd,IAAqB,IAAzB,EAA+B;AAC3B,gBAAIA,GAAG,GAAG,KAAKrtC,QAAL,CAAcqtC,GAAd,GAAoBtoB,GAAG,CAACjd,UAAJ,CAAe,KAAK9H,QAAL,CAAc8C,MAAd,CAAqB,KAAK9C,QAAL,CAAcD,SAAnC,CAAf,CAA9B;;AACAstC,eAAG,CAAC5/C,KAAJ,CAAUC,QAAV,GAAqB,UAArB;AACA0S,mBAAO,CAAC9Y,QAAR,CAAiB+lD,GAAjB,EAAsB,KAAKrtC,QAAL,CAActC,QAAd,CAAuB4S,YAAvB,GAAsC,GAAtC,IACjB,KAAK5M,QAAL,GAAgB,KAAKA,QAArB,GACGtjB,MAAM,CAACsjB,QAAP,GAAkBtjB,MAAM,CAACsjB,QAAzB,GAAoC,EAFtB,CAAtB;;AAGA,iBAAK1D,QAAL,CAActC,QAAd,CAAuBib,aAAvB,CAAqC00B,GAArC;;AACA,iBAAKrtC,QAAL,CAActC,QAAd,CAAuB2B,KAAvB,CAA6BguC,GAA7B;;AACA,iBAAK1pC,MAAL,GAAc0pC,GAAd,CAR2B,CAU3B;AACA;;AACA,gBAAI1uD,EAAE,GAAG,uBAAT;AACA0uD,eAAG,CAAC5/C,KAAJ,CAAU+/C,eAAV,GAA4B7uD,EAA5B;AACA0uD,eAAG,CAAC5/C,KAAJ,CAAUggD,YAAV,GAAyB9uD,EAAzB;AACA0uD,eAAG,CAAC5/C,KAAJ,CAAUigD,WAAV,GAAwB/uD,EAAxB;AACA0uD,eAAG,CAAC5/C,KAAJ,CAAUkgD,UAAV,GAAuBhvD,EAAvB;AACA0uD,eAAG,CAAC5/C,KAAJ,CAAUmgD,SAAV,GAAsBjvD,EAAtB,CAjB2B,CAmB3B;;AACA0uD,eAAG,CAACrtC,QAAJ,GAAe,IAAf;;AAEA,gBAAI5f,MAAM,CAACopC,OAAP,KAAmB,KAAvB,EAA8B;AAC1B6jB,iBAAG,CAAC5/C,KAAJ,CAAU+hC,OAAV,GAAoB,MAApB;AACH;AACJ;;AACD,iBAAO,KAAKxvB,QAAL,CAAcqtC,GAArB;AACH,SA5BD;;AA8BA,aAAK30B,IAAL,GAAY,UAAU3Y,SAAV,EAAqBqsC,2BAArB,EAAkDyB,gBAAlD,EAAoE;AAC5E,cAAI7iE,EAAE,GAAG+hE,cAAc,CAAC,IAAD,CAAvB;;AACA,cAAI/hE,EAAE,IAAI,IAAN,IAAcA,EAAE,CAACZ,MAAH,KAAc,CAAhC,EAAmC;AAC/B,gBAAIoiE,GAAG,GAAG;AAAE1jE,eAAC,EAAE,CAAL;AAAQK,eAAC,EAAE;AAAX,aAAV,CAD+B,CAG/B;;AACA,gBAAI0kE,gBAAJ,EAAsB;AAClBrB,iBAAG,GAAG;AAAE1jE,iBAAC,EAAE+kE,gBAAgB,CAAC,CAAD,CAArB;AAA0B1kE,iBAAC,EAAE0kE,gBAAgB,CAAC,CAAD;AAA7C,eAAN;AACH,aAFD,MAGK,IAAI9tC,SAAS,CAACgjC,WAAd,EAA2B;AAC5B,kBAAIxc,GAAG,GAAG,KAAKA,GAAf;AAAA,kBAAoByc,QAAQ,GAAG,KAA/B;;AACA,kBAAIpjC,GAAG,CAACpJ,QAAJ,CAAa,KAAK+vB,GAAlB,KAA0B,KAAKA,GAAL,GAAW,CAArC,IAA0C,KAAKA,GAAL,GAAW,CAAzD,EAA4D;AACxDA,mBAAG,GAAGkmB,QAAQ,CAAC,KAAKlmB,GAAN,EAAW,EAAX,CAAd;AACAyc,wBAAQ,GAAG,IAAX;AACH;;AACDwJ,iBAAG,GAAGzsC,SAAS,CAACgjC,WAAV,CAAsBxc,GAAtB,EAA2Byc,QAA3B,CAAN,CAN4B,CAMiB;AAChD,aAPI,MAQA;AACD,kBAAI8K,QAAQ,GAAG,KAAKvnB,GAAL,CAASluC,WAAT,KAAyBb,KAAzB,GAAiC,KAAK+uC,GAAtC,GAA4C,KAAKolB,WAAhE;AACAa,iBAAG,GAAG;AAAE1jE,iBAAC,EAAEglE,QAAQ,CAAC,CAAD,CAAR,GAAc/tC,SAAS,CAAC91B,CAA7B;AACFd,iBAAC,EAAE2kE,QAAQ,CAAC,CAAD,CAAR,GAAc/tC,SAAS,CAAC3tB;AADzB,eAAN;AAEH;;AAED,gBAAI27D,IAAI,GAAGvB,GAAG,CAAC1jE,CAAJ,GAASkC,EAAE,CAAC,CAAD,CAAF,GAAQ,CAA5B;AAAA,gBACIgjE,IAAI,GAAGxB,GAAG,CAACrjE,CAAJ,GAAS6B,EAAE,CAAC,CAAD,CAAF,GAAQ,CAD5B;AAGA,mBAAO;AACH+0B,uBAAS,EAAEA,SADR;AAEH70B,eAAC,EAAE;AAAE6iE,oBAAI,EAAEA,IAAR;AAAcC,oBAAI,EAAEA,IAApB;AAA0BhjE,kBAAE,EAAEA,EAA9B;AAAkCwhE,mBAAG,EAAEA;AAAvC,eAFA;AAGHvX,kBAAI,EAAE8Y,IAHH;AAIH1Y,kBAAI,EAAE0Y,IAAI,GAAG/iE,EAAE,CAAC,CAAD,CAJZ;AAKHmqD,kBAAI,EAAE6Y,IALH;AAMHzY,kBAAI,EAAEyY,IAAI,GAAGhjE,EAAE,CAAC,CAAD;AANZ,aAAP;AAQH,WAhCD,MAiCK;AACD,mBAAO;AAACiqD,kBAAI,EAAE,CAAP;AAAUI,kBAAI,EAAE,CAAhB;AAAmBF,kBAAI,EAAE,CAAzB;AAA4BI,kBAAI,EAAE;AAAlC,aAAP;AACH;AACJ,SAtCD;AAuCH,OA3FD;;AA4FA31B,SAAG,CAAC1G,MAAJ,CAAWi0C,kBAAX,EAA+B,CAACpoB,GAAG,CAACtjB,kBAAL,EAAyBiqC,eAAzB,CAA/B,EAA0E;AACtEwB,qBAAa,EAAE,yBAAY;AACvB,iBAAO,CAAC,CAAD,EAAG,CAAH,CAAP;AACH,SAHqE;AAItEh+B,kBAAU,EAAE,oBAAU9Y,KAAV,EAAiB;AACzB,cAAI,KAAK4J,QAAL,CAAcqtC,GAAlB,EAAuB;AACnB,iBAAKrtC,QAAL,CAAcqtC,GAAd,CAAkB5/C,KAAlB,CAAwB+hC,OAAxB,GAAkCp5B,KAAK,GAAG,OAAH,GAAa,MAApD,CADmB,CAEnB;;AACA,gBAAIA,KAAK,IAAI,KAAK4J,QAAL,CAAcutC,kBAA3B,EAA+C;AAC3CR,4BAAc,CAAC,IAAD,EAAO,IAAP,CAAd;;AACA,mBAAKhtC,SAAL,CAAeyB,OAAf;AACA,mBAAKxB,QAAL,CAAcutC,kBAAd,GAAmC,KAAnC;AACH;AACJ;AACJ,SAdqE;;AAetE;;;;;;;AAOAU,6BAAqB,EAAE,iCAAY;AAC/B,eAAKjuC,QAAL,CAAcitC,gBAAd,GAAiC,IAAjC;AACH,SAxBqE;AAyBtEj4B,eAAO,EAAE,iBAAUrlB,KAAV,EAAiB;AACtB,cAAIA,KAAJ,EAAW;AACP,gBAAI,KAAKqQ,QAAL,CAAcqtC,GAAd,IAAqB,IAAzB,EAA+B;AAC3B,mBAAKrtC,QAAL,CAAcqtC,GAAd,CAAkBrtC,QAAlB,GAA6B,IAA7B;;AACA,mBAAKA,QAAL,CAActC,QAAd,CAAuBgjB,aAAvB,CAAqC,KAAK1gB,QAAL,CAAcqtC,GAAnD;AACH;AACJ,WALD,MAMK;AACD;AACA,gBAAI,KAAKrtC,QAAL,IAAiB,KAAKA,QAAL,CAAcqtC,GAA/B,IAAsC,KAAKrtC,QAAL,CAAcqtC,GAAd,CAAkBp1D,UAA5D,EAAwE;AACpE,mBAAK+nB,QAAL,CAAcqtC,GAAd,CAAkBp1D,UAAlB,CAA6B0I,WAA7B,CAAyC,KAAKqf,QAAL,CAAcqtC,GAAvD;AACH;;AACD,iBAAKD,QAAL,GAAgB,IAAhB;AACH;AAEJ,SAxCqE;AAyCtEpnB,gBAAQ,EAAC,kBAAStoB,QAAT,EAAmBqC,SAAnB,EAA8B;AACnC,cAAI,KAAKC,QAAL,CAAcqtC,GAAd,IAAqB,IAAzB,EAA+B;AAC3B3vC,oBAAQ,CAACiB,YAAT,GAAwB/Q,WAAxB,CAAoC,KAAKoS,QAAL,CAAcqtC,GAAlD;AACH;;AACD,eAAKD,QAAL,GAAgB,KAAhB;AACH,SA9CqE;AA+CtElB,sBAAc,EAAE,0BAAY;AACxB,cAAIlhE,EAAE,GAAG+hE,cAAc,CAAC,IAAD,CAAvB;;AACA,iBAAOnkE,IAAI,CAACgD,GAAL,CAASZ,EAAE,CAAC,CAAD,CAAX,EAAgBA,EAAE,CAAC,CAAD,CAAlB,CAAP;AACH,SAlDqE;AAmDtEsmC,aAAK,EAAE,eAAUniC,CAAV,EAAa++D,gBAAb,EAA+B;AAClC,cAAI,CAAC,KAAKluC,QAAL,CAAcstC,WAAnB,EAAgC;AAC5B,iBAAKxlC,UAAL;AACA34B,aAAC,CAAC4wB,SAAF,CAAYwqC,oBAAZ,CAAiC,KAAKvqC,QAAL,CAAcqtC,GAA/C;AACA,iBAAKrtC,QAAL,CAAcstC,WAAd,GAA4B,IAA5B;;AACA,gBAAI,KAAKF,QAAT,EAAmB;AACf,mBAAKptC,QAAL,CAAcqtC,GAAd,CAAkBp1D,UAAlB,CAA6B0I,WAA7B,CAAyC,KAAKqf,QAAL,CAAcqtC,GAAvD;AACH;AACJ;;AACD,eAAKrtC,QAAL,CAAcqtC,GAAd,CAAkB5/C,KAAlB,CAAwBxhB,IAAxB,GAAgCkD,CAAC,CAAC4wB,SAAF,CAAYj3B,CAAZ,GAAgBqG,CAAC,CAACjE,CAAF,CAAI6iE,IAArB,GAA6B,IAA5D;AACA,eAAK/tC,QAAL,CAAcqtC,GAAd,CAAkB5/C,KAAlB,CAAwB1N,GAAxB,GAA+B5Q,CAAC,CAAC4wB,SAAF,CAAY52B,CAAZ,GAAgBgG,CAAC,CAACjE,CAAF,CAAI8iE,IAArB,GAA6B,IAA3D;AACH;AA9DqE,OAA1E;AAiEA;;;;;;AAKA;;;;;;;;;;;AASAjpB,SAAG,CAACje,QAAJ,CAAaqnC,MAAb,GAAsB,UAAU/tD,MAAV,EAAkB;AACpC,aAAKpD,IAAL,GAAY,QAAZ;AACAmwD,0BAAkB,CAACp7D,KAAnB,CAAyB,IAAzB,EAA+B0F,SAA/B;AACH,OAHD;;AAIAmoB,SAAG,CAAC1G,MAAJ,CAAW6rB,GAAG,CAACje,QAAJ,CAAaqnC,MAAxB,EAAgChB,kBAAhC;;AAEApoB,SAAG,CAACje,QAAJ,CAAasnC,UAAb,GAA0B,YAAY;AAClC,YAAI1sC,IAAI,GAAG,IAAX;AACAA,YAAI,CAACt3B,MAAL,GAAc,EAAd;AACAs3B,YAAI,CAACmzB,WAAL,GAAmB,CAAnB;AACA,aAAK73C,IAAL,GAAY,YAAZ;AACA0uD,uBAAe,CAAC35D,KAAhB,CAAsB,IAAtB,EAA4B0F,SAA5B;;AACAstC,WAAG,CAACtjB,kBAAJ,CAAuB1vB,KAAvB,CAA6B,IAA7B,EAAmC0F,SAAnC;;AACA,aAAKihC,IAAL,GAAY,UAAU4Q,SAAV,EAAqB8iB,2BAArB,EAAkD;AAE1D,cAAIhpD,IAAI,GAAGkmC,SAAS,CAAC4Z,kBAAV,CAA6BxhC,IAAI,CAAC6kB,GAAlC,EAAuC7kB,IAAI,CAACt3B,MAAL,GAAc,CAArD,CAAX;AAAA,cACIkiE,GAAG,GAAGhjB,SAAS,CAACyZ,WAAV,CAAsBrhC,IAAI,CAAC6kB,GAA3B,CADV;AAAA,cAEIgmB,IAAI,GAAGnK,GAAG,CAACjsD,WAAJ,CAAgBiN,IAAhB,EAAsBkpD,GAAtB,EAA2B5qC,IAAI,CAACt3B,MAAhC,CAFX;AAAA,cAGIikE,QAAQ,GAAGjM,GAAG,CAAC5rD,mBAAJ,CAAwB4M,IAAxB,EAA8BmpD,IAA9B,EAAoC,EAApC,CAHf;AAAA,cAII+B,QAAQ,GAAGlM,GAAG,CAAC5rD,mBAAJ,CAAwB+1D,IAAxB,EAA8BnpD,IAA9B,EAAoC,EAApC,CAJf;;AAMA,iBAAO;AACHkmC,qBAAS,EAAEA,SADR;AAEHlmC,gBAAI,EAAEA,IAFH;AAGHmpD,gBAAI,EAAEA,IAHH;AAIH+B,oBAAQ,EAAEA,QAJP;AAKHD,oBAAQ,EAAEA,QALP;AAMHpZ,gBAAI,EAAErsD,IAAI,CAACkD,GAAL,CAASsX,IAAI,CAACta,CAAd,EAAiByjE,IAAI,CAACzjE,CAAtB,EAAyBwlE,QAAQ,CAAC,CAAD,CAAR,CAAYxlE,CAArC,EAAwCwlE,QAAQ,CAAC,CAAD,CAAR,CAAYxlE,CAApD,CANH;AAOHqsD,gBAAI,EAAEvsD,IAAI,CAACkD,GAAL,CAASsX,IAAI,CAACja,CAAd,EAAiBojE,IAAI,CAACpjE,CAAtB,EAAyBmlE,QAAQ,CAAC,CAAD,CAAR,CAAYnlE,CAArC,EAAwCmlE,QAAQ,CAAC,CAAD,CAAR,CAAYnlE,CAApD,CAPH;AAQHksD,gBAAI,EAAEzsD,IAAI,CAACgD,GAAL,CAASwX,IAAI,CAACta,CAAd,EAAiByjE,IAAI,CAACzjE,CAAtB,EAAyBwlE,QAAQ,CAAC,CAAD,CAAR,CAAYxlE,CAArC,EAAwCwlE,QAAQ,CAAC,CAAD,CAAR,CAAYxlE,CAApD,CARH;AASHysD,gBAAI,EAAE3sD,IAAI,CAACgD,GAAL,CAASwX,IAAI,CAACja,CAAd,EAAiBojE,IAAI,CAACpjE,CAAtB,EAAyBmlE,QAAQ,CAAC,CAAD,CAAR,CAAYnlE,CAArC,EAAwCmlE,QAAQ,CAAC,CAAD,CAAR,CAAYnlE,CAApD;AATH,WAAP;AAWH,SAnBD,CAPkC,CA4BlC;;AACH,OA7BD;AA+BA;;;;AAIA;;;;;;;;;;;;;;;AAaA47C,SAAG,CAACje,QAAJ,CAAawe,KAAb,GAAqB,UAAUllC,MAAV,EAAkB;AACnC,aAAK+kC,UAAL,GAAkB/kC,MAAM,CAAC+kC,UAAzB;AAEA,YAAIopB,UAAU,GAAG,IAAjB;AAAA,YAAuBC,WAAW,GAAG,IAArC;AAAA,YAA2CC,SAAS,GAAG,IAAvD;AAAA,YAA6DC,YAAY,GAAG,IAA5E;AACA,aAAKhrC,QAAL,GAAgB,KAAKyhB,UAAL,IAAmB,IAAnB,GAA0B,KAAKA,UAAL,CAAgBzhB,QAA1C,GAAqD,IAArE;;AACA,YAAIv0B,CAAC,GAAG41C,GAAG,CAAC7rB,MAAJ,CAAW;AACf4J,gBAAM,EAAE,kBAAY;AAChB,mBAAOiiB,GAAG,CAAC0D,aAAJ,CAAkB,KAAlB,CAAP;AACH;AAHc,SAAX,EAGAroC,MAHA,CAAR;;AAIA2kC,WAAG,CAACje,QAAJ,CAAaqnC,MAAb,CAAoBj6D,IAApB,CAAyB,IAAzB,EAA+B/E,CAA/B;;AACA,aAAK6N,IAAL,GAAY,OAAZ;AACA,aAAKwvB,KAAL,GAAapsB,MAAM,CAACosB,KAAP,IAAgB,EAA7B;AACA,aAAKiiC,SAAL,GAAiB,IAAjB;;AACA,YAAI,KAAKtpB,UAAT,EAAqB;AACjB,cAAIrtC,EAAE,GAAG,KAAKgwB,UAAL,EAAT;AACA,eAAKqd,UAAL,CAAgBwpB,IAAhB,GAAuB,KAAKxpB,UAAL,CAAgBwpB,IAAhB,IAAwB,iBAA/C;AACA72D,YAAE,CAAC2V,KAAH,CAASkhD,IAAT,GAAgB,KAAKxpB,UAAL,CAAgBwpB,IAAhC;AACA72D,YAAE,CAAC2V,KAAH,CAASkZ,KAAT,GAAiB,KAAKwe,UAAL,CAAgBxe,KAAhB,IAAyB,OAA1C;;AACA,cAAI,KAAKwe,UAAL,CAAgB9kB,IAApB,EAA0B;AACtBvoB,cAAE,CAAC2V,KAAH,CAAS+9C,UAAT,GAAsB,KAAKrmB,UAAL,CAAgB9kB,IAAtC;AACH;;AACD,cAAI,KAAK8kB,UAAL,CAAgBypB,WAAhB,GAA8B,CAAlC,EAAqC;AACjC,gBAAIC,MAAM,GAAG,KAAK1pB,UAAL,CAAgB2pB,WAAhB,GAA8B,KAAK3pB,UAAL,CAAgB2pB,WAA9C,GAA4D,OAAzE;AACAh3D,cAAE,CAAC2V,KAAH,CAASshD,MAAT,GAAkB,KAAK5pB,UAAL,CAAgBypB,WAAhB,GAA8B,WAA9B,GAA4CC,MAA9D;AACH;;AACD,cAAI,KAAK1pB,UAAL,CAAgBimB,OAApB,EAA6B;AACzBtzD,cAAE,CAAC2V,KAAH,CAAS29C,OAAT,GAAmB,KAAKjmB,UAAL,CAAgBimB,OAAnC;AACH;AACJ;AAEJ,OA9BD;;AA+BAxrC,SAAG,CAAC1G,MAAJ,CAAW6rB,GAAG,CAACje,QAAJ,CAAawe,KAAxB,EAA+BP,GAAG,CAACje,QAAJ,CAAaqnC,MAA5C,EAAoD;AAChDn5B,eAAO,EAAE,iBAAUrlB,KAAV,EAAiB;AACtB,cAAIA,KAAJ,EAAW;AACP,iBAAK09C,GAAL,GAAW,IAAX;AACA,iBAAK7gC,KAAL,GAAa,IAAb;AACA,iBAAKiiC,SAAL,GAAiB,IAAjB;AACA,iBAAK/qC,QAAL,GAAgB,IAAhB;AACA,iBAAKyhB,UAAL,GAAkB,IAAlB;AACH;AACJ,SAT+C;AAUhDiC,gBAAQ,EAAE,oBAAY;AAClB,iBAAO,KAAK5a,KAAZ;AACH,SAZ+C;;AAahD;;;;;;;AAOA+a,gBAAQ,EAAE,kBAAUluC,CAAV,EAAa;AACnB,eAAKmzB,KAAL,GAAanzB,CAAb;AACA,eAAKo1D,SAAL,GAAiB,IAAjB;AACA,eAAKR,qBAAL;AACA,eAAKe,MAAL;AACA,eAAKjvC,SAAL,CAAeyB,OAAf;AACH,SA1B+C;AA2BhD0rC,qBAAa,EAAE,yBAAY;AACvB,eAAK8B,MAAL;AACA,iBAAO7B,kBAAkB,CAAC54D,SAAnB,CAA6B24D,aAA7B,CAA2Cn7D,KAA3C,CAAiD,IAAjD,EAAuD0F,SAAvD,CAAP;AACH,SA9B+C;AA+BhDu3D,cAAM,EAAE,kBAAY;AAChB,cAAI,OAAO,KAAKxiC,KAAZ,KAAsB,UAA1B,EAAsC;AAClC,gBAAIyiC,EAAE,GAAG,KAAKziC,KAAL,CAAW,IAAX,CAAT;AACA,iBAAK1E,UAAL,GAAkBonC,SAAlB,GAA8BD,EAAE,CAAChvD,OAAH,CAAW,OAAX,EAAoB,OAApB,CAA9B;AACH,WAHD,MAIK;AACD,gBAAI,KAAKwuD,SAAL,IAAkB,IAAtB,EAA4B;AACxB,mBAAKA,SAAL,GAAiB,KAAKjiC,KAAtB;AACA,mBAAK1E,UAAL,GAAkBonC,SAAlB,GAA8B,KAAKT,SAAL,CAAexuD,OAAf,CAAuB,OAAvB,EAAgC,OAAhC,CAA9B;AACH;AACJ;AACJ,SA1C+C;AA2ChD8lC,kBAAU,EAAC,oBAAS76C,CAAT,EAAY;AACnB,cAAGA,CAAC,CAACshC,KAAF,IAAW,IAAd,EAAmB;AACf,iBAAK+a,QAAL,CAAcr8C,CAAC,CAACshC,KAAhB;AACH;AACJ;AA/C+C,OAApD,EAnuDS,CAqxDT;;AAEH,KAvxDD,EAuxDGt4B,IAvxDH,CAuxDQ,OAAOC,MAAP,KAAkB,WAAlB,GAAgCA,MAAhC,GAAyC,IAvxDjD;AAyxDA;;;;;;;;;AAQA;AAAC,KAAC,YAAW;AACT;;AAEA,UAAIxL,IAAI,GAAG,IAAX;AAAA,UACIi3B,GAAG,GAAGj3B,IAAI,CAAC0tB,WADf;AAAA,UAEI84C,IAAI,GAAGxmE,IAAI,CAAC60B,eAFhB;AAIA,UAAI4xC,qBAAqB,GAAG,qBAA5B;AACA,UAAIC,oBAAoB,GAAG,oBAA3B;AACA,UAAIC,wBAAwB,GAAG,qBAA/B;AACA,UAAIC,uBAAuB,GAAG,kBAA9B;AACA,UAAIC,IAAI,GAAG,MAAX;AACA,UAAIC,MAAM,GAAG,QAAb;AACA,UAAIC,aAAa,GAAG,eAApB;AACA,UAAIC,KAAK,GAAG,eAAZ;AACA,UAAIC,gBAAgB,GAAG,mBAAvB;AACA,UAAIC,eAAe,GAAG,iBAAtB;AACA,UAAIC,iBAAiB,GAAG,oBAAxB;AACA,UAAIC,eAAe,GAAG,WAAtB;AACA,UAAIC,iBAAiB,GAAG,cAAxB;AACA,UAAIC,UAAU,GAAG,cAAjB;AACA,UAAIC,YAAY,GAAG,gBAAnB;AACA,UAAIC,mBAAmB,GAAG,eAA1B;AACA,UAAIC,oBAAoB,GAAG,iBAA3B;AACA,UAAIC,gCAAgC,GAAG,6BAAvC;AAEA,UAAIC,cAAc,GAAG,WAArB;AACA,UAAIC,cAAc,GAAG,WAArB;AACA,UAAIC,QAAQ,GAAG,MAAf;AACA,UAAIC,QAAQ,GAAG,MAAf;;AAEA,UAAIC,YAAY,GAAG,SAAfA,YAAe,CAAS1wC,QAAT,EAAmB;AAClC,YAAI2wC,cAAc,GAAG,EAArB;AAAA,YAAyBC,oBAAoB,GAAG,EAAhD;AAAA,YAAoDC,oBAAoB,GAAG,EAA3E;AAAA,YAA+EnvC,IAAI,GAAG,IAAtF,CADkC,CAGlC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,iBAASovC,YAAT,CAAsBh5D,EAAtB,EAA0Bi5D,QAA1B,EAAoC;AAChC,cAAI9lE,CAAC,GAAG+0B,QAAQ,CAACrB,YAAT,EAAR;;AACA,cAAItQ,KAAK,GAAG,KAAZ;AAAA,cAAmB3U,CAAC,GAAG,IAAvB;AAAA,cAA6Byf,KAAK,GAAG,IAArC;;AACA,iBAAO,CAAC9K,KAAR,EAAe;AACX,gBAAIvW,EAAE,IAAI,IAAN,IAAcA,EAAE,KAAK7M,CAAzB,EAA4B;AACxB,qBAAO,KAAP;AACH,aAFD,MAEO;AACH,kBAAI6M,EAAE,KAAKi5D,QAAX,EAAqB;AACjB,uBAAO,IAAP;AACH,eAFD,MAEO;AACHj5D,kBAAE,GAAGA,EAAE,CAACG,UAAR;AACH;AACJ;AACJ;AACJ;;AAED+nB,gBAAQ,CAACpU,IAAT,CAAc,YAAd,EAA4B,UAASzc,CAAT,EAAY;AAEpC,cAAI6hE,WAAW,GAAGhxC,QAAQ,CAACixC,WAAT,CAAqB9hE,CAAC,CAACgvB,MAAvB,CAAlB;;AACA,cAAI+yC,WAAW,GAAGlxC,QAAQ,CAACixC,WAAT,CAAqB9hE,CAAC,CAACyH,MAAvB,CAAlB;;AAEA,cAAIo6D,WAAW,IAAI,IAAf,IAAuBE,WAAW,IAAI,IAAtC,IAA8CF,WAAW,KAAKE,WAAlE,EAA+E;AAC3EN,gCAAoB,CAACzhE,CAAC,CAAC6zB,UAAF,CAAavN,EAAd,CAApB,GAAwCu7C,WAAxC;AACAH,gCAAoB,CAAC1hE,CAAC,CAAC6zB,UAAF,CAAavN,EAAd,CAApB,GAAwCu7C,WAAxC;AACH,WAHD,MAIK;AACD,gBAAIA,WAAW,IAAI,IAAnB,EAAyB;AACrBpxC,iBAAG,CAAC5G,OAAJ,CAAYg4C,WAAW,CAAC7nC,WAAZ,CAAwBhL,MAApC,EAA4ChvB,CAAC,CAAC6zB,UAA9C;;AACA4tC,kCAAoB,CAACzhE,CAAC,CAAC6zB,UAAF,CAAavN,EAAd,CAApB,GAAwCu7C,WAAxC;AACH;;AACD,gBAAIE,WAAW,IAAI,IAAnB,EAAyB;AACrBtxC,iBAAG,CAAC5G,OAAJ,CAAYk4C,WAAW,CAAC/nC,WAAZ,CAAwBvyB,MAApC,EAA4CzH,CAAC,CAAC6zB,UAA9C;;AACA6tC,kCAAoB,CAAC1hE,CAAC,CAAC6zB,UAAF,CAAavN,EAAd,CAApB,GAAwCy7C,WAAxC;AACH;AACJ;AACJ,SAnBD;;AAqBA,iBAASC,0BAAT,CAAoC9zC,IAApC,EAA0C;AACtC,iBAAOA,IAAI,CAACoZ,OAAZ;AACA,cAAI26B,KAAK,GAAGR,oBAAoB,CAACvzC,IAAI,CAAC5H,EAAN,CAAhC;AAAA,cAA2C9R,CAA3C;;AACA,cAAIytD,KAAK,IAAI,IAAb,EAAmB;AACfztD,aAAC,GAAG,WAAS1Y,CAAT,EAAY;AAAE,qBAAOA,CAAC,CAACwqB,EAAF,KAAS4H,IAAI,CAAC5H,EAArB;AAA0B,aAA5C;;AACAmK,eAAG,CAACjH,kBAAJ,CAAuBy4C,KAAK,CAACjoC,WAAN,CAAkBhL,MAAzC,EAAiDxa,CAAjD;;AACAic,eAAG,CAACjH,kBAAJ,CAAuBy4C,KAAK,CAACjoC,WAAN,CAAkBvyB,MAAzC,EAAiD+M,CAAjD;;AACA,mBAAOitD,oBAAoB,CAACvzC,IAAI,CAAC5H,EAAN,CAA3B;AACH;;AAED27C,eAAK,GAAGP,oBAAoB,CAACxzC,IAAI,CAAC5H,EAAN,CAA5B;;AACA,cAAI27C,KAAK,IAAI,IAAb,EAAmB;AACfztD,aAAC,GAAG,WAAS1Y,CAAT,EAAY;AAAE,qBAAOA,CAAC,CAACwqB,EAAF,KAAS4H,IAAI,CAAC5H,EAArB;AAA0B,aAA5C;;AACAmK,eAAG,CAACjH,kBAAJ,CAAuBy4C,KAAK,CAACjoC,WAAN,CAAkBhL,MAAzC,EAAiDxa,CAAjD;;AACAic,eAAG,CAACjH,kBAAJ,CAAuBy4C,KAAK,CAACjoC,WAAN,CAAkBvyB,MAAzC,EAAiD+M,CAAjD;;AACA,mBAAOktD,oBAAoB,CAACxzC,IAAI,CAAC5H,EAAN,CAA3B;AACH;AACJ;;AAEDuK,gBAAQ,CAACpU,IAAT,CAAcykD,gCAAd,EAAgD,UAASlhE,CAAT,EAAY;AACxDgiE,oCAA0B,CAAChiE,CAAC,CAAC6zB,UAAH,CAA1B;AACH,SAFD;;AAIAhD,gBAAQ,CAACpU,IAAT,CAAcwkD,oBAAd,EAAoC,UAASjhE,CAAT,EAAY;AAC5C,cAAIkiE,OAAO,GAAGliE,CAAC,CAACwI,KAAF,KAAY,CAAZ,GAAgBi5D,oBAAhB,GAAuCC,oBAArD;AACA,cAAIO,KAAK,GAAGC,OAAO,CAACliE,CAAC,CAAC6zB,UAAF,CAAavN,EAAd,CAAnB;;AACA,cAAI27C,KAAJ,EAAW;AACP,gBAAI75D,IAAI,GAAG65D,KAAK,CAACjoC,WAAN,CAAkBh6B,CAAC,CAACwI,KAAF,KAAY,CAAZ,GAAgB,QAAhB,GAA2B,QAA7C,CAAX;AACA,gBAAIuH,GAAG,GAAG3H,IAAI,CAAC0B,OAAL,CAAa9J,CAAC,CAAC6zB,UAAf,CAAV;;AACA,gBAAI9jB,GAAG,KAAK,CAAC,CAAb,EAAgB;AACZ3H,kBAAI,CAAC+B,MAAL,CAAY4F,GAAZ,EAAiB,CAAjB;AACH;AACJ;AACJ,SAVD;;AAYA,aAAKoyD,QAAL,GAAgB,UAASF,KAAT,EAAgB;AAC5BpxC,kBAAQ,CAAC1Y,QAAT,CAAkB8pD,KAAK,CAACG,KAAN,EAAlB,EAAiClC,oBAAjC;;AACAsB,wBAAc,CAACS,KAAK,CAAC37C,EAAP,CAAd,GAA2B27C,KAA3B;AACAA,eAAK,CAACI,OAAN,GAAgB,IAAhB;;AACAC,oCAA0B,CAACL,KAAD,CAA1B;;AACApxC,kBAAQ,CAAC/D,IAAT,CAAc8zC,eAAd,EAA+B;AAAEqB,iBAAK,EAACA;AAAR,WAA/B;AACH,SAND;;AAQA,aAAKM,UAAL,GAAkB,UAASN,KAAT,EAAgBt5D,EAAhB,EAAoB65D,cAApB,EAAoC;AAClDP,eAAK,GAAG,KAAKQ,QAAL,CAAcR,KAAd,CAAR;;AACA,cAAIA,KAAJ,EAAW;AACP,gBAAIS,OAAO,GAAGT,KAAK,CAACG,KAAN,EAAd;;AAEA,gBAAIz5D,EAAE,CAACglC,eAAP,EAAwB;AACpB;AACH;;AACD,gBAAIg1B,YAAY,GAAGh6D,EAAE,CAACi6D,aAAtB,CANO,CAOP;;AACA,gBAAID,YAAY,KAAKV,KAArB,EAA4B;AAExBpxC,sBAAQ,CAACgyC,uBAAT,CAAiCl6D,EAAjC;;AAEA,kBAAIm6D,KAAK,GAAGjyC,QAAQ,CAACyZ,SAAT,CAAmB3hC,EAAnB,EAAuB,IAAvB,CAAZ;;AACA,kBAAIo6D,IAAI,GAAGd,KAAK,CAACe,SAAN,GAAkBnyC,QAAQ,CAACyZ,SAAT,CAAmBo4B,OAAnB,EAA4B,IAA5B,CAAlB,GAAsD7xC,QAAQ,CAACyZ,SAAT,CAAmB23B,KAAK,CAACgB,WAAN,EAAnB,EAAwC,IAAxC,CAAjE,CALwB,CAOxB;;AACA,kBAAIN,YAAY,IAAI,IAApB,EAA0B;AACtBA,4BAAY,CAACpxD,MAAb,CAAoB5I,EAApB,EAAwB,KAAxB,EAA+B65D,cAA/B,EAA+C,KAA/C,EAAsDP,KAAtD;AACA1vC,oBAAI,CAAC2wC,yBAAL,CAA+BP,YAA/B;AACH;;AACDV,mBAAK,CAAC3mB,GAAN,CAAU3yC,EAAV,EAAc65D;AAAc;AAA5B;;AAEA,kBAAIW,wBAAwB,GAAG,SAA3BA,wBAA2B,CAAU/6D,IAAV,EAAgBI,KAAhB,EAAuB;AAClD,oBAAIy3B,IAAI,GAAGz3B,KAAK,KAAK,CAAV,GAAc,CAAd,GAAkB,CAA7B;AACAJ,oBAAI,CAAC8iB,IAAL,CAAU,UAAUpvB,CAAV,EAAa;AACnBA,mBAAC,CAACikC,UAAF,CAAa,KAAb;;AACA,sBAAIjkC,CAAC,CAACu0B,SAAF,CAAY4P,IAAZ,EAAkBjF,OAAlB,CAA0B4nC,aAA1B,KAA4CX,KAAhD,EAAuD;AACnDnmE,qBAAC,CAACu0B,SAAF,CAAY4P,IAAZ,EAAkBF,UAAlB,CAA6B,KAA7B;;AACAqjC,qCAAiB,CAACtnE,CAAD,EAAImkC,IAAJ,EAAUgiC,KAAV,CAAjB;AACH,mBAHD,MAIK;AACDnmE,qBAAC,CAACu0B,SAAF,CAAY7nB,KAAZ,EAAmBu3B,UAAnB,CAA8B,KAA9B;;AACAsjC,uCAAmB,CAACvnE,CAAD,EAAI0M,KAAJ,EAAWy5D,KAAX,CAAnB;AACH;AACJ,iBAVD;AAWH,eAbD;;AAeA,kBAAIA,KAAK,CAACe,SAAV,EAAqB;AACjBG,wCAAwB,CAACtyC,QAAQ,CAACjM,MAAT,CAAgB;AAACoK,wBAAM,EAAErmB;AAAT,iBAAhB,CAAD,EAAgC,CAAhC,CAAxB;AACAw6D,wCAAwB,CAACtyC,QAAQ,CAACjM,MAAT,CAAgB;AAACnd,wBAAM,EAAEkB;AAAT,iBAAhB,CAAD,EAAgC,CAAhC,CAAxB;AACH;;AAED,kBAAIsnB,IAAI,GAAGY,QAAQ,CAACX,KAAT,CAAevnB,EAAf,CAAX;;AACAkoB,sBAAQ,CAACyrB,WAAT,CAAqBjI,SAArB,CAA+B1rC,EAA/B,EAAmCsnB,IAAnC,EAAyCyyC,OAAzC,EAAkD7xC,QAAQ,CAACX,KAAT,CAAewyC,OAAf,CAAlD,EAA2EI,KAA3E;;AAEA,kBAAIQ,WAAW,GAAG;AAAExmE,oBAAI,EAAEgmE,KAAK,CAAChmE,IAAN,GAAaimE,IAAI,CAACjmE,IAA1B;AAAgC8T,mBAAG,EAAEkyD,KAAK,CAAClyD,GAAN,GAAYmyD,IAAI,CAACnyD;AAAtD,eAAlB;;AAEAigB,sBAAQ,CAAC5U,WAAT,CAAqBtT,EAArB,EAAyB26D,WAAzB;;AAEAzyC,sBAAQ,CAACyrB,WAAT,CAAqBinB,gBAArB,CAAsC56D,EAAtC,EAA0CsnB,IAA1C,EAAgD6yC,KAAhD;;AAEAvwC,kBAAI,CAAC2wC,yBAAL,CAA+BjB,KAA/B;;AAEApxC,sBAAQ,CAACL,UAAT,CAAoBP,IAApB;;AAEA,kBAAI,CAACuyC,cAAL,EAAqB;AACjB,oBAAIxiE,CAAC,GAAG;AAACiiE,uBAAK,EAAEA,KAAR;AAAet5D,oBAAE,EAAEA,EAAnB;AAAuBiS,qBAAG,EAAC0oD;AAA3B,iBAAR;;AACA,oBAAIX,YAAJ,EAAkB;AACd3iE,mBAAC,CAAC6hE,WAAF,GAAgBc,YAAhB;AACH;;AACD9xC,wBAAQ,CAAC/D,IAAT,CAAc4zC,eAAd,EAA+B1gE,CAA/B;AACH;AACJ;AACJ;AACJ,SAlED;;AAoEA,aAAKwjE,eAAL,GAAuB,UAASvB,KAAT,EAAgBt5D,EAAhB,EAAoB65D,cAApB,EAAoC;AACvDP,eAAK,GAAG,KAAKQ,QAAL,CAAcR,KAAd,CAAR;;AACA,cAAIA,KAAJ,EAAW;AAEP;AACA;AACA,gBAAIA,KAAK,CAACe,SAAV,EAAqB;AACjB,kBAAIS,UAAU,GAAG,SAAbA,UAAa,CAAUC,KAAV,EAAiBl7D,KAAjB,EAAwB;AACrC,qBAAK,IAAIjN,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGmoE,KAAK,CAACzoE,MAA1B,EAAkCM,CAAC,EAAnC,EAAuC;AACnC,sBAAIO,CAAC,GAAG4nE,KAAK,CAACnoE,CAAD,CAAb;;AACA,sBAAIO,CAAC,CAACwrC,OAAN,EAAe;AACX,yBAAI,IAAI1qC,CAAC,GAAG,CAAZ,EAAeA,CAAC,GAAGd,CAAC,CAACwrC,OAAF,CAAUrsC,MAA7B,EAAqC2B,CAAC,EAAtC,EAA0C;AACtC,0BAAId,CAAC,CAACwrC,OAAF,CAAU1qC,CAAV,KAAgB,IAApB,EAA0B;AACtB,4BAAI+mE,cAAc,GAAG7nE,CAAC,CAACwrC,OAAF,CAAU1qC,CAAV,EAAa2qC,UAAb,CAAwBvM,OAA7C;;AACA,4BAAI2oC,cAAc,KAAKh7D,EAAnB,IAAyBg5D,YAAY,CAACgC,cAAD,EAAiBh7D,EAAjB,CAAzC,EAA+D;AAC3Dy6D,2CAAiB,CAACtnE,CAAD,EAAI0M,KAAJ,EAAWy5D,KAAX,CAAjB;AACH;AACJ;AAEJ;AACJ;AACJ;AACJ,eAfD,CADiB,CAkBjB;;;AACAwB,wBAAU,CAACxB,KAAK,CAACjoC,WAAN,CAAkBhL,MAAlB,CAAyBvtB,KAAzB,EAAD,EAAmC,CAAnC,CAAV;;AACAgiE,wBAAU,CAACxB,KAAK,CAACjoC,WAAN,CAAkBvyB,MAAlB,CAAyBhG,KAAzB,EAAD,EAAmC,CAAnC,CAAV;AACH;;AAEDwgE,iBAAK,CAAC1wD,MAAN,CAAa5I,EAAb,EAAiB,IAAjB,EAAuB65D,cAAvB;AACH;AACJ,SA/BD;;AAiCA,aAAKC,QAAL,GAAgB,UAASmB,OAAT,EAAkB;AAC9B,cAAI3B,KAAK,GAAG2B,OAAZ;;AACA,cAAInzC,GAAG,CAACpJ,QAAJ,CAAau8C,OAAb,CAAJ,EAA2B;AACvB3B,iBAAK,GAAGT,cAAc,CAACoC,OAAD,CAAtB;;AACA,gBAAI3B,KAAK,IAAI,IAAb,EAAmB;AACf,oBAAM,IAAIn7C,SAAJ,CAAc,oBAAoB88C,OAApB,GAA8B,GAA5C,CAAN;AACH;AACJ;;AACD,iBAAO3B,KAAP;AACH,SATD;;AAWA,aAAK4B,SAAL,GAAiB,YAAW;AACxB,cAAIp/C,CAAC,GAAG,EAAR;;AACA,eAAK,IAAIla,CAAT,IAAci3D,cAAd,EAA8B;AAC1B/8C,aAAC,CAACxkB,IAAF,CAAOuhE,cAAc,CAACj3D,CAAD,CAArB;AACH;;AACD,iBAAOka,CAAP;AACH,SAND;;AAQA,aAAKq/C,WAAL,GAAmB,UAAS7B,KAAT,EAAgB8B,aAAhB,EAA+BC,aAA/B,EAA8CxB,cAA9C,EAA8D;AAC7EP,eAAK,GAAG,KAAKQ,QAAL,CAAcR,KAAd,CAAR;AACA,eAAKgC,WAAL,CAAiBhC,KAAjB,EAAwB,IAAxB,EAF6E,CAE9C;;AAC/B,cAAIiC,YAAY,GAAGjC,KAAK,CAAC8B,aAAa,GAAG5C,cAAH,GAAoBC,cAAlC,CAAL,CAAuD4C,aAAvD,EAAsExB,cAAtE,CAAnB;;AACA3xC,kBAAQ,CAACtf,MAAT,CAAgB0wD,KAAK,CAACG,KAAN,EAAhB;;AACA,iBAAOZ,cAAc,CAACS,KAAK,CAAC37C,EAAP,CAArB;AACA,iBAAOuK,QAAQ,CAACszC,OAAT,CAAiBlC,KAAK,CAAC37C,EAAvB,CAAP;;AACAuK,kBAAQ,CAAC/D,IAAT,CAAc+zC,iBAAd,EAAiC;AAAEoB,iBAAK,EAACA;AAAR,WAAjC;;AACA,iBAAOiC,YAAP,CAR6E,CAQxD;AACxB,SATD;;AAWA,aAAKtyB,eAAL,GAAuB,UAASmyB,aAAT,EAAwBC,aAAxB,EAAuCxB,cAAvC,EAAuD;AAC1E,eAAK,IAAIj4D,CAAT,IAAci3D,cAAd,EAA8B;AAC1B,iBAAKsC,WAAL,CAAiBtC,cAAc,CAACj3D,CAAD,CAA/B,EAAoCw5D,aAApC,EAAmDC,aAAnD,EAAkExB,cAAlE;AACH;AACJ,SAJD;;AAMA,iBAAS3iC,WAAT,CAAqBoiC,KAArB,EAA4Bh7C,KAA5B,EAAmC;AAE/B;AACA,cAAI3qB,CAAC,GAAG2lE,KAAK,CAACG,KAAN,GAAcp5D,gBAAd,CAA+B,cAA/B,CAAR;;AACA,eAAK,IAAIzN,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGe,CAAC,CAACrB,MAAtB,EAA8BM,CAAC,EAA/B,EAAmC;AAC/Bs1B,oBAAQ,CAAC5J,KAAK,GAAGo6C,QAAH,GAAcC,QAApB,CAAR,CAAsChlE,CAAC,CAACf,CAAD,CAAvC,EAA4C,IAA5C;AACH;AACJ;;AAED,YAAI8nE,mBAAmB,GAAG,SAAtBA,mBAAsB,CAASvnE,CAAT,EAAY0M,KAAZ,EAAmBy5D,KAAnB,EAA0B;AAEhD,cAAImC,OAAO,GAAGtoE,CAAC,CAACu0B,SAAF,CAAY7nB,KAAK,KAAK,CAAV,GAAc,CAAd,GAAkB,CAA9B,EAAiCwyB,OAA/C;;AACA,cAAIopC,OAAO,CAAC5D,KAAD,CAAP,IAAmB,CAAC4D,OAAO,CAAC5D,KAAD,CAAP,CAAe6D,WAAf,EAAD,IAAiCD,OAAO,CAAC5D,KAAD,CAAP,CAAewC,SAAvE,EAAmF;AAC/E;AACH;;AAED,cAAIN,OAAO,GAAGT,KAAK,CAACG,KAAN,EAAd;AAAA,cAA6BkC,SAAS,GAAGzzC,QAAQ,CAACX,KAAT,CAAewyC,OAAf,CAAzC;;AAEA7xC,kBAAQ,CAACT,eAAT,CAAyBt0B,CAAzB,EAA4B0M,KAA5B,EAAmCk6D,OAAnC,EAA4C4B,SAA5C,EAAuD,UAASxoE,CAAT,EAAY0M,KAAZ,EAAmB;AAAE,mBAAOy5D,KAAK,CAAC94B,WAAN,CAAkBrtC,CAAlB,EAAqB0M,KAArB,CAAP;AAAqC,WAAjH,EAAmH,UAAS1M,CAAT,EAAY0M,KAAZ,EAAmB;AAAE,mBAAOy5D,KAAK,CAACsC,SAAN,CAAgBzoE,CAAhB,EAAmB0M,KAAnB,CAAP;AAAmC,WAA3K;AACH,SAVD;;AAYA,aAAKg8D,aAAL,GAAqB,UAASvC,KAAT,EAAgB;AACjCA,eAAK,GAAG,KAAKQ,QAAL,CAAcR,KAAd,CAAR;;AACA,cAAIA,KAAK,IAAI,IAAT,IAAiBA,KAAK,CAACe,SAA3B,EAAsC;AAClC;AACH;;AACD,cAAIN,OAAO,GAAGT,KAAK,CAACG,KAAN,EAAd,CALiC,CAOjC;AACA;AAEA;;AACAviC,qBAAW,CAACoiC,KAAD,EAAQ,KAAR,CAAX;;AAEA,cAAIA,KAAK,CAACoC,WAAN,EAAJ,EAAyB;AACrB;AACA,gBAAII,YAAY,GAAG,SAAfA,YAAe,CAAUf,KAAV,EAAiBl7D,KAAjB,EAAwB;AACvC,mBAAK,IAAIjN,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGmoE,KAAK,CAACzoE,MAA1B,EAAkCM,CAAC,EAAnC,EAAuC;AACnC,oBAAIO,CAAC,GAAG4nE,KAAK,CAACnoE,CAAD,CAAb;;AACA8nE,mCAAmB,CAACvnE,CAAD,EAAI0M,KAAJ,EAAWy5D,KAAX,CAAnB;AACH;AACJ,aALD,CAFqB,CASrB;;;AACAwC,wBAAY,CAACxC,KAAK,CAACjoC,WAAN,CAAkBhL,MAAnB,EAA2B,CAA3B,CAAZ;;AACAy1C,wBAAY,CAACxC,KAAK,CAACjoC,WAAN,CAAkBvyB,MAAnB,EAA2B,CAA3B,CAAZ;AACH;;AAEDw6D,eAAK,CAACe,SAAN,GAAkB,IAAlB;;AACAnyC,kBAAQ,CAACpR,WAAT,CAAqBijD,OAArB,EAA8BxC,oBAA9B;;AACArvC,kBAAQ,CAAC1Y,QAAT,CAAkBuqD,OAAlB,EAA2BzC,qBAA3B;;AACApvC,kBAAQ,CAACL,UAAT,CAAoBkyC,OAApB;;AACA7xC,kBAAQ,CAAC/D,IAAT,CAAci0C,YAAd,EAA4B;AAAEkB,iBAAK,EAACA;AAAR,WAA5B;AACH,SAhCD;;AAkCA,YAAImB,iBAAiB,GAAG,SAApBA,iBAAoB,CAAStnE,CAAT,EAAY0M,KAAZ,EAAmBy5D,KAAnB,EAA0B;AAC9CpxC,kBAAQ,CAACN,iBAAT,CAA2Bz0B,CAA3B,EAA8B0M,KAA9B,EAAqCqoB,QAAQ,CAACX,KAAT,CAAe+xC,KAAK,CAACG,KAAN,EAAf,CAArC;AACH,SAFD;;AAIA,aAAK6B,WAAL,GAAmB,UAAShC,KAAT,EAAgBO,cAAhB,EAAgC;AAE/CP,eAAK,GAAG,KAAKQ,QAAL,CAAcR,KAAd,CAAR;;AAEA,cAAIA,KAAK,IAAI,IAAT,IAAiB,CAACA,KAAK,CAACe,SAA5B,EAAuC;AACnC;AACH;;AACD,cAAIN,OAAO,GAAGT,KAAK,CAACG,KAAN,EAAd;;AAEAviC,qBAAW,CAACoiC,KAAD,EAAQ,IAAR,CAAX;;AAEA,cAAIA,KAAK,CAACoC,WAAN,EAAJ,EAAyB;AACrB;AACA,gBAAIZ,UAAU,GAAG,SAAbA,UAAa,CAAUC,KAAV,EAAiBl7D,KAAjB,EAAwB;AACrC,mBAAK,IAAIjN,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGmoE,KAAK,CAACzoE,MAA1B,EAAkCM,CAAC,EAAnC,EAAuC;AACnC,oBAAIO,CAAC,GAAG4nE,KAAK,CAACnoE,CAAD,CAAb;;AACA6nE,iCAAiB,CAACtnE,CAAD,EAAI0M,KAAJ,EAAWy5D,KAAX,CAAjB;AACH;AACJ,aALD,CAFqB,CASrB;;;AACAwB,sBAAU,CAACxB,KAAK,CAACjoC,WAAN,CAAkBhL,MAAnB,EAA2B,CAA3B,CAAV;;AACAy0C,sBAAU,CAACxB,KAAK,CAACjoC,WAAN,CAAkBvyB,MAAnB,EAA2B,CAA3B,CAAV;AACH;;AAEDw6D,eAAK,CAACe,SAAN,GAAkB,KAAlB;;AACAnyC,kBAAQ,CAAC1Y,QAAT,CAAkBuqD,OAAlB,EAA2BxC,oBAA3B;;AACArvC,kBAAQ,CAACpR,WAAT,CAAqBijD,OAArB,EAA8BzC,qBAA9B;;AACApvC,kBAAQ,CAACL,UAAT,CAAoBkyC,OAApB;;AACA,eAAKgC,YAAL,CAAkBzC,KAAlB;;AACA,cAAI,CAACO,cAAL,EAAqB;AACjB3xC,oBAAQ,CAAC/D,IAAT,CAAcg0C,UAAd,EAA0B;AAAEmB,mBAAK,EAAEA;AAAT,aAA1B;AACH;AACJ,SAjCD;;AAmCA,aAAKyC,YAAL,GAAoB,UAASzC,KAAT,EAAgB;AAChCA,eAAK,GAAG,KAAKQ,QAAL,CAAcR,KAAd,CAAR;AACA,cAAI3lE,CAAC,GAAG2lE,KAAK,CAAC0C,UAAN,EAAR;;AACA,eAAK,IAAIppE,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGe,CAAC,CAACrB,MAAtB,EAA8BM,CAAC,EAA/B,EAAmC;AAC/Bs1B,oBAAQ,CAACL,UAAT,CAAoBl0B,CAAC,CAACf,CAAD,CAArB;AACH;AACJ,SAND,CA7UkC,CAqVlC;;;AACA,iBAAS+mE,0BAAT,CAAoCL,KAApC,EAA2C;AACvC,cAAIh9C,OAAO,GAAGg9C,KAAK,CAAC0C,UAAN,GAAmBljE,KAAnB,EAAd;AAEA,cAAImjE,YAAY,GAAG,EAAnB;;AACA,eAAK,IAAIrpE,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG0pB,OAAO,CAAChqB,MAA5B,EAAoCM,CAAC,EAArC,EAAyC;AACrC8M,iBAAK,CAACjD,SAAN,CAAgBnF,IAAhB,CAAqB2C,KAArB,CAA2BgiE,YAA3B,EAAyC3/C,OAAO,CAAC1pB,CAAD,CAAP,CAAWyN,gBAAX,CAA4B,cAA5B,CAAzC;AACH;;AACDX,eAAK,CAACjD,SAAN,CAAgBnF,IAAhB,CAAqB2C,KAArB,CAA2BqiB,OAA3B,EAAoC2/C,YAApC;;AAEA,cAAIvmE,EAAE,GAAGwyB,QAAQ,CAACmW,cAAT,CAAwB;AAAChY,kBAAM,EAAC/J,OAAR;AAAiB/M,iBAAK,EAAC;AAAvB,WAAxB,EAAqD,IAArD,CAAT;;AACA,cAAI1Z,EAAE,GAAGqyB,QAAQ,CAACmW,cAAT,CAAwB;AAACv/B,kBAAM,EAACwd,OAAR;AAAiB/M,iBAAK,EAAC;AAAvB,WAAxB,EAAqD,IAArD,CAAT;;AAEA,cAAI2sD,SAAS,GAAG,EAAhB;AACA5C,eAAK,CAACjoC,WAAN,CAAkBhL,MAAlB,CAAyB/zB,MAAzB,GAAkC,CAAlC;AACAgnE,eAAK,CAACjoC,WAAN,CAAkBvyB,MAAlB,CAAyBxM,MAAzB,GAAkC,CAAlC;;AACA,cAAI6pE,MAAM,GAAG,SAATA,MAAS,CAAShpE,CAAT,EAAY;AACrB,iBAAK,IAAIP,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGO,CAAC,CAACb,MAAtB,EAA8BM,CAAC,EAA/B,EAAmC;AAC/B,kBAAIspE,SAAS,CAAC/oE,CAAC,CAACP,CAAD,CAAD,CAAK+qB,EAAN,CAAb,EAAwB;AACpB;AACH;;AACDu+C,uBAAS,CAAC/oE,CAAC,CAACP,CAAD,CAAD,CAAK+qB,EAAN,CAAT,GAAqB,IAArB;;AACA,kBAAIy+C,EAAE,GAAGl0C,QAAQ,CAACixC,WAAT,CAAqBhmE,CAAC,CAACP,CAAD,CAAD,CAAKyzB,MAA1B,CAAT;AAAA,kBACIg2C,EAAE,GAAGn0C,QAAQ,CAACixC,WAAT,CAAqBhmE,CAAC,CAACP,CAAD,CAAD,CAAKkM,MAA1B,CADT;;AAGA,kBAAIs9D,EAAE,KAAK9C,KAAX,EAAkB;AACd,oBAAI+C,EAAE,KAAK/C,KAAX,EAAkB;AACdA,uBAAK,CAACjoC,WAAN,CAAkBhL,MAAlB,CAAyB/uB,IAAzB,CAA8BnE,CAAC,CAACP,CAAD,CAA/B;AACH;;AACDkmE,oCAAoB,CAAC3lE,CAAC,CAACP,CAAD,CAAD,CAAK+qB,EAAN,CAApB,GAAgC27C,KAAhC;AACH,eALD,MAMK,IAAI+C,EAAE,KAAK/C,KAAX,EAAkB;AACnBA,qBAAK,CAACjoC,WAAN,CAAkBvyB,MAAlB,CAAyBxH,IAAzB,CAA8BnE,CAAC,CAACP,CAAD,CAA/B;AACAmmE,oCAAoB,CAAC5lE,CAAC,CAACP,CAAD,CAAD,CAAK+qB,EAAN,CAApB,GAAgC27C,KAAhC;AACH;AACJ;AACJ,WApBD;;AAqBA6C,gBAAM,CAACzmE,EAAD,CAAN;AAAYymE,gBAAM,CAACtmE,EAAD,CAAN;AACf;;AAED,aAAK0kE,yBAAL,GAAiCZ,0BAAjC;;AACA,aAAK2C,gBAAL,GAAwB,YAAW;AAC/B,eAAK,IAAI16D,CAAT,IAAci3D,cAAd,EAA8B;AAC1Bc,sCAA0B,CAACd,cAAc,CAACj3D,CAAD,CAAf,CAA1B;;AACAsmB,oBAAQ,CAACyrB,WAAT,CAAqBtL,aAArB,CAAmCngB,QAAQ,CAACX,KAAT,CAAesxC,cAAc,CAACj3D,CAAD,CAAd,CAAkB63D,KAAlB,EAAf,CAAnC;AACH;AACJ,SALD;AAMH,OApYD;AAsYA;;;;;;;;;;;;;;;AAaA,UAAI8C,KAAK,GAAG,SAARA,KAAQ,CAASr0C,QAAT,EAAmB5f,MAAnB,EAA2B;AACnC,YAAIshB,IAAI,GAAG,IAAX;AACA,YAAI5pB,EAAE,GAAGsI,MAAM,CAACtI,EAAhB;;AACA,aAAKy5D,KAAL,GAAa,YAAW;AAAE,iBAAOz5D,EAAP;AAAY,SAAtC;;AACA,aAAK2d,EAAL,GAAUrV,MAAM,CAACqV,EAAP,IAAamK,GAAG,CAACpY,IAAJ,EAAvB;AACA1P,UAAE,CAACglC,eAAH,GAAqB,IAArB;;AAEA,YAAIs1B,WAAW,GAAG,KAAKA,WAAL,GAAmB,YAAW;AAC5C,cAAIlQ,EAAE,GAAGliC,QAAQ,CAAC/B,WAAT,CAAqBnmB,EAArB,EAAyBw3D,wBAAzB,CAAT;;AACA,iBAAOpN,EAAE,IAAIA,EAAE,CAAC93D,MAAH,GAAY,CAAlB,GAAsB83D,EAAE,CAAC,CAAD,CAAxB,GAA8BpqD,EAArC;AACH,SAHD;;AAKA,YAAIw8D,KAAK,GAAGl0D,MAAM,CAACk0D,KAAP,KAAiB,IAA7B;AACA,YAAIhpD,SAAS,GAAGgpD,KAAK,IAAKl0D,MAAM,CAACkL,SAAP,KAAqB,IAA/C;AACA,YAAIW,MAAM,GAAG7L,MAAM,CAAC6L,MAAP,KAAkB,KAA/B;AACA,YAAIsoD,MAAM,GAAGn0D,MAAM,CAACm0D,MAAP,KAAkB,IAA/B;AACA,YAAIC,KAAK,GAAGp0D,MAAM,CAACo0D,KAAP,KAAiB,IAA7B;AACA,YAAIC,YAAY,GAAGr0D,MAAM,CAACq0D,YAAP,KAAwB,IAA3C;AACA,YAAIC,OAAO,GAAGt0D,MAAM,CAACs0D,OAAP,KAAmB,KAAjC;AACA,YAAI/8B,QAAQ,GAAG,EAAf;AACA,aAAKxO,WAAL,GAAmB;AAAEhL,gBAAM,EAAC,EAAT;AAAavnB,gBAAM,EAAC,EAApB;AAAwB+9D,kBAAQ,EAAC;AAAjC,SAAnB,CApBmC,CAsBnC;AACA;;AACA,aAAKjB,SAAL,GAAiB,UAASr2C,IAAT,EAAeu3C,aAAf,EAA8B;AAC3C,iBAAOx0D,MAAM,CAACye,MAAP,IAAiB,YAAxB;AACH,SAFD;;AAIA,aAAKyZ,WAAL,GAAmB,UAASjb,IAAT,EAAeu3C,aAAf,EAA8B;AAC7C,iBAAOx0D,MAAM,CAAC2e,QAAP,IAAmB,CAAE,KAAF,EAAS;AAAE2lC,kBAAM,EAAC;AAAT,WAAT,CAA1B;AACH,SAFD;;AAIA,aAAKyN,SAAL,GAAiB,KAAjB;;AACA,YAAI/xD,MAAM,CAACoF,SAAP,KAAqB,KAAzB,EAAgC;AAC5B,cAAIqvD,IAAI,GAAG;AACPnvD,gBAAI,EAAC,gBAAW;AACZ,mBAAK,IAAIhb,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGitC,QAAQ,CAACvtC,MAA7B,EAAqCM,CAAC,EAAtC,EAA0C;AACtCs1B,wBAAQ,CAAC0Y,IAAT,CAAcf,QAAQ,CAACjtC,CAAD,CAAtB;AACH;AACJ,aALM;AAMPskB,gBAAI,EAAC,cAAS5O,MAAT,EAAiB;AAClB4f,sBAAQ,CAAC/D,IAAT,CAAck0C,mBAAd,EAAmC/vC,OAAO,CAAClH,MAAR,CAAe9Y,MAAf,EAAuB;AAACgxD,qBAAK,EAAC1vC;AAAP,eAAvB,CAAnC;AACH,aARM;AASPra,iBAAK,EAACuoD;AATC,WAAX;;AAWA,cAAIxvD,MAAM,CAACq9B,WAAX,EAAwB;AACpB90C,gBAAI,CAACy3B,OAAL,CAAalH,MAAb,CAAoB27C,IAApB,EAA0Bz0D,MAAM,CAACq9B,WAAjC;AACH;;AACDzd,kBAAQ,CAACxa,SAAT,CAAmBpF,MAAM,CAACtI,EAA1B,EAA8B+8D,IAA9B;AACH;;AACD,YAAIz0D,MAAM,CAACqF,SAAP,KAAqB,KAAzB,EAAgC;AAC5Bua,kBAAQ,CAACva,SAAT,CAAmBrF,MAAM,CAACtI,EAA1B,EAA8B;AAC1BmZ,gBAAI,EAAC,cAAS9hB,CAAT,EAAY;AACb,kBAAI2I,EAAE,GAAG3I,CAAC,CAACuW,IAAF,CAAO5N,EAAhB;;AACA,kBAAIA,EAAE,CAACglC,eAAP,EAAwB;AACpB;AACH;;AACD,kBAAIg1B,YAAY,GAAGh6D,EAAE,CAACi6D,aAAtB;;AACA,kBAAID,YAAY,KAAKpwC,IAArB,EAA2B;AACvB,oBAAIowC,YAAY,IAAI,IAApB,EAA0B;AACtB,sBAAIA,YAAY,CAACgD,YAAb,CAA0Bh9D,EAA1B,EAA8B4pB,IAA9B,CAAJ,EAAyC;AACrC;AACH;AACJ;;AACD1B,wBAAQ,CAAC+0C,eAAT,GAA2BrD,UAA3B,CAAsChwC,IAAtC,EAA4C5pB,EAA5C,EAAgD,KAAhD;AACH;AAEJ;AAhByB,WAA9B;AAkBH;;AACD,YAAI2H,KAAK,GAAG,SAARA,KAAQ,CAASC,GAAT,EAAchL,EAAd,EAAkB;AAC1B,cAAIsgE,GAAG,GAAGt1D,GAAG,CAACkoB,QAAJ,IAAgB,IAAhB,GAAwBloB,GAAxB,GAA8B,CAAEA,GAAF,CAAxC;;AACA,eAAK,IAAIhV,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGsqE,GAAG,CAAC5qE,MAAxB,EAAgCM,CAAC,EAAjC,EAAqC;AACjCgK,cAAE,CAACsgE,GAAG,CAACtqE,CAAD,CAAJ,CAAF;AACH;AACJ,SALD;;AAOA,aAAKoqE,YAAL,GAAoB,UAASp1D,GAAT,EAAcwxD,WAAd,EAA2B;AAC3C,iBAAOuD,YAAY,KAAKxoD,MAAM,IAAIuoD,KAAV,IAAmBD,MAAxB,CAAnB;AACH,SAFD;;AAIA,aAAK9pB,GAAL,GAAW,UAAS/qC,GAAT,EAAciyD;AAAc;AAA5B,UAA+C;AACtD,cAAIsD,QAAQ,GAAG7C,WAAW,EAA1B;;AACA3yD,eAAK,CAACC,GAAD,EAAM,UAASw1D,IAAT,EAAe;AAEtB,gBAAIA,IAAI,CAACnD,aAAL,IAAsB,IAA1B,EAAgC;AAC5B,kBAAImD,IAAI,CAACnD,aAAL,KAAuBrwC,IAA3B,EAAiC;AAC7B;AACH,eAFD,MAEO;AACHwzC,oBAAI,CAACnD,aAAL,CAAmBrxD,MAAnB,CAA0Bw0D,IAA1B,EAAgC,IAAhC,EAAsCvD,cAAtC,EAAsD,KAAtD;AACH;AACJ;;AAEDuD,gBAAI,CAACnD,aAAL,GAAqBrwC,IAArB;AACAiW,oBAAQ,CAACvoC,IAAT,CAAc8lE,IAAd,EAXsB,CAYtB;;AACA,gBAAIl1C,QAAQ,CAACm1C,kBAAT,CAA4BD,IAA5B,CAAJ,EAAuC;AACnCE,+BAAiB,CAACF,IAAD,CAAjB;AACH;;AAED,gBAAIA,IAAI,CAACj9D,UAAL,KAAoBg9D,QAAxB,EAAkC;AAC9BA,sBAAQ,CAACrnD,WAAT,CAAqBsnD,IAArB;AACH,aAnBqB,CAqBtB;AACA;AACA;AACA;AACA;AACA;AACA;;AACH,WA5BI,CAAL;;AA8BAl1C,kBAAQ,CAAC+0C,eAAT,GAA2B1C,yBAA3B,CAAqD3wC,IAArD;AACH,SAjCD;;AAmCA,aAAKhhB,MAAL,GAAc,UAAS5I,EAAT,EAAaq7D,aAAb,EAA4BxB,cAA5B,EAA4C0D,sBAA5C,EAAoEnE,WAApE,EAAiF;AAE3FzxD,eAAK,CAAC3H,EAAD,EAAK,UAASo9D,IAAT,EAAe;AACrB,gBAAIA,IAAI,CAACnD,aAAL,KAAuBrwC,IAA3B,EAAiC;AAC7B,qBAAOwzC,IAAI,CAACnD,aAAZ;;AACAnyC,iBAAG,CAACjH,kBAAJ,CAAuBgf,QAAvB,EAAiC,UAAUj/B,CAAV,EAAa;AAC1C,uBAAOA,CAAC,KAAKw8D,IAAb;AACH,eAFD;;AAKA,kBAAI/B,aAAJ,EAAmB;AACf,oBAAI;AACAzxC,sBAAI,CAAC0wC,WAAL,GAAmBzxD,WAAnB,CAA+Bu0D,IAA/B;AACH,iBAFD,CAEE,OAAOx8D,CAAP,EAAU;AACR2d,6BAAW,CAAC7lB,GAAZ,CAAgB,yCAAyCkI,CAAzD;AACH;AACJ;;AACD48D,iCAAmB,CAACJ,IAAD,CAAnB;;AAEA,kBAAI,CAACvD,cAAL,EAAqB;AACjB,oBAAIxiE,CAAC,GAAG;AAACiiE,uBAAK,EAAE1vC,IAAR;AAAc5pB,oBAAE,EAAEo9D;AAAlB,iBAAR;;AACA,oBAAIhE,WAAJ,EAAiB;AACb/hE,mBAAC,CAAC+hE,WAAF,GAAgBA,WAAhB;AACH;;AACDlxC,wBAAQ,CAAC/D,IAAT,CAAc6zC,iBAAd,EAAiC3gE,CAAjC;AACH;AACJ;AACJ,WAzBI,CAAL;;AA0BA,cAAI,CAACkmE,sBAAL,EAA6B;AACzBr1C,oBAAQ,CAAC+0C,eAAT,GAA2B1C,yBAA3B,CAAqD3wC,IAArD;AACH;AACJ,SA/BD;;AAgCA,aAAK6zC,SAAL,GAAiB,UAASpC,aAAT,EAAwBxB,cAAxB,EAAwC;AACrD,eAAK,IAAIjnE,CAAC,GAAG,CAAR,EAAW2O,CAAC,GAAGs+B,QAAQ,CAACvtC,MAA7B,EAAqCM,CAAC,GAAG2O,CAAzC,EAA4C3O,CAAC,EAA7C,EAAiD;AAC7C,gBAAIoN,EAAE,GAAG6/B,QAAQ,CAAC,CAAD,CAAjB;AACAjW,gBAAI,CAAChhB,MAAL,CAAY5I,EAAZ,EAAgBq7D,aAAhB,EAA+BxB,cAA/B,EAA+C,IAA/C;;AACA3xC,oBAAQ,CAACtf,MAAT,CAAgB5I,EAAhB,EAAoB,IAApB;AACH;;AACD6/B,kBAAQ,CAACvtC,MAAT,GAAkB,CAAlB;;AACA41B,kBAAQ,CAAC+0C,eAAT,GAA2B1C,yBAA3B,CAAqD3wC,IAArD;AACH,SARD;;AASA,aAAK8zC,SAAL,GAAiB,YAAW;AACxB,cAAIC,iBAAiB,GAAG,EAAxB;;AACA,eAAK,IAAI/qE,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGitC,QAAQ,CAACvtC,MAA7B,EAAqCM,CAAC,EAAtC,EAA0C;AACtC,gBAAI+nE,WAAW,GAAGiD,OAAO,CAAC/9B,QAAQ,CAACjtC,CAAD,CAAT,CAAzB;;AACA+qE,6BAAiB,CAAChD,WAAW,CAAC,CAAD,CAAZ,CAAjB,GAAoCA,WAAW,CAAC,CAAD,CAA/C;AACH;;AACD96B,kBAAQ,CAACvtC,MAAT,GAAkB,CAAlB;AAEA,iBAAOqrE,iBAAP;AACH,SATD;;AAUA,aAAK3B,UAAL,GAAkB,YAAW;AAAE,iBAAOn8B,QAAP;AAAkB,SAAjD;;AAEA7/B,UAAE,CAAC63D,KAAD,CAAF,GAAY,IAAZ;;AAEA3vC,gBAAQ,CAACpU,IAAT,CAAc2jD,uBAAd,EAAuC,UAASoG,UAAT,EAAqB;AACxD;AACA,cAAIA,UAAU,CAAC79D,EAAX,CAAci6D,aAAd,KAAgC,IAApC,EAA0C;AACtCqD,6BAAiB,CAACO,UAAU,CAAC79D,EAAZ,CAAjB;AACH;AACJ,SALsC,CAKrC8T,IALqC,CAKhC,IALgC,CAAvC;;AAOA,iBAASgqD,WAAT,CAAqBl2D,GAArB,EAA0B;AACtB,iBAAOA,GAAG,CAACw5B,YAAX;AACH;;AAED,iBAAS28B,eAAT,CAAyBn2D,GAAzB,EAA8BqK,GAA9B,EAAmC;AAC/B,cAAI5a,CAAC,GAAGymE,WAAW,CAACl2D,GAAD,CAAnB;AAAA,cACIjW,CAAC,GAAGu2B,QAAQ,CAAC3P,OAAT,CAAiBlhB,CAAjB,CADR;AAAA,cAEIqnC,EAAE,GAAGxW,QAAQ,CAAC3P,OAAT,CAAiB3Q,GAAjB,CAFT;AAAA,cAGIo2D,QAAQ,GAAG/rD,GAAG,CAAC,CAAD,CAHlB;AAAA,cAIIgsD,SAAS,GAAGD,QAAQ,GAAGt/B,EAAE,CAAC,CAAD,CAJ7B;AAAA,cAKIw/B,OAAO,GAAGjsD,GAAG,CAAC,CAAD,CALjB;AAAA,cAMIksD,UAAU,GAAGD,OAAO,GAAGx/B,EAAE,CAAC,CAAD,CAN7B;;AAQA,iBAAOu/B,SAAS,GAAG,CAAZ,IAAiBD,QAAQ,GAAGrsE,CAAC,CAAC,CAAD,CAA7B,IAAoCwsE,UAAU,GAAG,CAAjD,IAAsDD,OAAO,GAAGvsE,CAAC,CAAC,CAAD,CAAxE;AACH,SAhMkC,CAkMnC;AACA;AACA;AACA;;;AACA,iBAASisE,OAAT,CAAiBh2D,GAAjB,EAAsB;AAClB,cAAI+V,EAAE,GAAGuK,QAAQ,CAACX,KAAT,CAAe3f,GAAf,CAAT;;AACA,cAAIqK,GAAG,GAAGiW,QAAQ,CAACyZ,SAAT,CAAmB/5B,GAAnB,CAAV;;AACAA,aAAG,CAACzH,UAAJ,CAAe0I,WAAf,CAA2BjB,GAA3B;;AACAsgB,kBAAQ,CAACrB,YAAT,GAAwB/Q,WAAxB,CAAoClO,GAApC;;AACAsgB,kBAAQ,CAAC5U,WAAT,CAAqB1L,GAArB,EAA0BqK,GAA1B;;AACAurD,6BAAmB,CAAC51D,GAAD,CAAnB;;AACAsgB,kBAAQ,CAACyrB,WAAT,CAAqByqB,WAArB,CAAiCx2D,GAAjC,EAAsC+V,EAAtC;;AACA,iBAAO,CAACA,EAAD,EAAK1L,GAAL,CAAP;AACH,SA/MkC,CAiNnC;AACA;AACA;;;AACA,iBAASosD,cAAT,CAAwBhnE,CAAxB,EAA2B;AAEvB,cAAI+J,GAAG,GAAG,EAAV;;AAEA,mBAASC,IAAT,CAAcrB,EAAd,EAAkB7L,IAAlB,EAAwB8T,GAAxB,EAA6B;AACzB,gBAAIq2D,gBAAgB,GAAG,IAAvB;;AACA,gBAAI,CAACP,eAAe,CAAC/9D,EAAD,EAAK,CAAC7L,IAAD,EAAO8T,GAAP,CAAL,CAApB,EAAuC;AACnC,kBAAIqxD,KAAK,GAAGt5D,EAAE,CAACi6D,aAAf;;AACA,kBAAIyC,KAAJ,EAAW;AACPx0C,wBAAQ,CAACtf,MAAT,CAAgB5I,EAAhB;AACH,eAFD,MAEO;AACHs+D,gCAAgB,GAAGV,OAAO,CAAC59D,EAAD,CAA1B;AACH;;AAEDs5D,mBAAK,CAAC1wD,MAAN,CAAa5I,EAAb;AACH;;AAED,mBAAOs+D,gBAAP;AACH;;AAED,eAAK,IAAI1rE,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGyE,CAAC,CAAC+gB,SAAF,CAAY9lB,MAAhC,EAAwCM,CAAC,EAAzC,EAA6C;AACzCwO,eAAG,CAAC9J,IAAJ,CAAS+J,IAAI,CAAChK,CAAC,CAAC+gB,SAAF,CAAYxlB,CAAZ,EAAe,CAAf,CAAD,EAAoByE,CAAC,CAAC+gB,SAAF,CAAYxlB,CAAZ,EAAe,CAAf,EAAkBuB,IAAtC,EAA4CkD,CAAC,CAAC+gB,SAAF,CAAYxlB,CAAZ,EAAe,CAAf,EAAkBqV,GAA9D,CAAb;AACH;;AAED,iBAAO7G,GAAG,CAAC9O,MAAJ,KAAe,CAAf,GAAmB8O,GAAG,CAAC,CAAD,CAAtB,GAA4BA,GAAnC;AAEH,SA9OkC,CAgPnC;AACA;AACA;;;AACA,iBAASm9D,WAAT,CAAqB32D,GAArB,EAA0B;AACtB,cAAI+V,EAAE,GAAGuK,QAAQ,CAACX,KAAT,CAAe3f,GAAf,CAAT;;AACAsgB,kBAAQ,CAACL,UAAT,CAAoBjgB,GAApB;;AACAsgB,kBAAQ,CAACyrB,WAAT,CAAqBinB,gBAArB,CAAsChzD,GAAtC,EAA2C+V,EAA3C;AACH,SAvPkC,CAyPnC;AACA;AACA;;;AACA,iBAAS6/C,mBAAT,CAA6B51D,GAA7B,EAAkC;AAC9B,cAAI,CAACA,GAAG,CAACmU,cAAT,EAAyB;AACrB;AACH;;AACD,cAAI2gD,KAAK,IAAID,MAAb,EAAqB;AACjB70D,eAAG,CAACmU,cAAJ,CAAmB7S,GAAnB,CAAuBwuD,IAAvB,EAA6B2G,cAA7B;AACH;;AACD,cAAI,CAAC3B,KAAD,IAAU,CAACD,MAAX,IAAqBtoD,MAAzB,EAAiC;AAC7BvM,eAAG,CAACmU,cAAJ,CAAmB7S,GAAnB,CAAuByuD,MAAvB,EAA+B4G,WAA/B;;AACA32D,eAAG,CAACmU,cAAJ,CAAmB7H,SAAnB,CAA6B,IAA7B;AACH;AACJ;;AAED,iBAASopD,iBAAT,CAA2B11D,GAA3B,EAAgC;AAC5B,cAAI,CAACA,GAAG,CAACmU,cAAT,EAAyB;AACrB;AACH;;AACD,cAAI2gD,KAAK,IAAID,MAAb,EAAqB;AACjB70D,eAAG,CAACmU,cAAJ,CAAmBjT,EAAnB,CAAsB4uD,IAAtB,EAA4B2G,cAA5B;AACH;;AAED,cAAI7qD,SAAJ,EAAe;AACX5L,eAAG,CAACmU,cAAJ,CAAmB/H,YAAnB,CAAgC,IAAhC;AACH;;AAED,cAAIwoD,KAAJ,EAAW;AACP50D,eAAG,CAACmU,cAAJ,CAAmBxI,gBAAnB,CAAoC,IAApC;AACH;;AAED,cAAI,CAACmpD,KAAD,IAAU,CAACD,MAAX,IAAqBtoD,MAAzB,EAAiC;AAC7BvM,eAAG,CAACmU,cAAJ,CAAmBjT,EAAnB,CAAsB6uD,MAAtB,EAA8B4G,WAA9B;;AACA32D,eAAG,CAACmU,cAAJ,CAAmB7H,SAAnB,CAA6B,UAASkpD,IAAT,EAAenrD,GAAf,EAAoB;AAC7C,qBAAO,CAAC8rD,eAAe,CAACX,IAAD,EAAOnrD,GAAP,CAAvB;AACH,aAFD;AAGH;AACJ;;AAED,aAAKypD,WAAL,GAAmB,YAAW;AAC1B,iBAAOkB,OAAP;AACH,SAFD;;AAIA10C,gBAAQ,CAAC+0C,eAAT,GAA2BzD,QAA3B,CAAoC,IAApC;AACH,OAtSD;AAwSA;;;;;;;;AAMAnC,UAAI,CAAC56D,SAAL,CAAe+8D,QAAf,GAA0B,UAASlxD,MAAT,EAAiB;AACvC,YAAIrU,CAAC,GAAG,IAAR;AACAA,SAAC,CAACunE,OAAF,GAAYvnE,CAAC,CAACunE,OAAF,IAAa,EAAzB;;AACA,YAAIvnE,CAAC,CAACunE,OAAF,CAAUlzD,MAAM,CAACqV,EAAjB,KAAwB,IAA5B,EAAkC;AAC9B,gBAAM,IAAIQ,SAAJ,CAAc,0BAA0B7V,MAAM,CAACqV,EAAjC,GAAsC,gCAApD,CAAN;AACH;;AACD,YAAIrV,MAAM,CAACtI,EAAP,CAAU63D,KAAV,KAAoB,IAAxB,EAA8B;AAC1B,gBAAM,IAAI15C,SAAJ,CAAc,0BAA0B7V,MAAM,CAACqV,EAAjC,GAAsC,yCAApD,CAAN;AACH;;AACD,YAAI27C,KAAK,GAAG,IAAIiD,KAAJ,CAAUtoE,CAAV,EAAaqU,MAAb,CAAZ;AACArU,SAAC,CAACunE,OAAF,CAAUlC,KAAK,CAAC37C,EAAhB,IAAsB27C,KAAtB;;AACA,YAAIhxD,MAAM,CAAC+xD,SAAX,EAAsB;AAClB,eAAKwB,aAAL,CAAmBvC,KAAnB;AACH;;AACD,eAAOA,KAAP;AACH,OAfD;AAiBA;;;;;;;;AAMAjC,UAAI,CAAC56D,SAAL,CAAem9D,UAAf,GAA4B,UAASN,KAAT,EAAgBt5D,EAAhB,EAAoB65D,cAApB,EAAoC;AAE5D,YAAIx4D,IAAI,GAAG,UAASuG,GAAT,EAAc;AACrB,cAAI+V,EAAE,GAAG,KAAK4J,KAAL,CAAW3f,GAAX,CAAT;AACA,eAAK05B,MAAL,CAAY3jB,EAAZ,EAAgB/V,GAAhB;AACA,eAAKq1D,eAAL,GAAuBrD,UAAvB,CAAkCN,KAAlC,EAAyC1xD,GAAzC,EAA8CiyD,cAA9C;AACH,SAJU,CAIT/lD,IAJS,CAIJ,IAJI,CAAX;;AAMA,YAAIpU,KAAK,CAAC8e,OAAN,CAAcxe,EAAd,CAAJ,EAAuB;AACnB,eAAK,IAAIpN,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGoN,EAAE,CAAC1N,MAAvB,EAA+BM,CAAC,EAAhC,EAAoC;AAChCyO,gBAAI,CAACrB,EAAE,CAACpN,CAAD,CAAH,CAAJ;AACH;AACJ,SAJD,MAIO;AACHyO,cAAI,CAACrB,EAAD,CAAJ;AACH;AACJ,OAfD;AAiBA;;;;;;;;AAMAq3D,UAAI,CAAC56D,SAAL,CAAeo+D,eAAf,GAAiC,UAASvB,KAAT,EAAgBt5D,EAAhB,EAAoB65D,cAApB,EAAoC;AACjE,aAAKoD,eAAL,GAAuBpC,eAAvB,CAAuCvB,KAAvC,EAA8Ct5D,EAA9C,EAAkD65D,cAAlD;AACA,aAAKhzC,YAAL,GAAoB/Q,WAApB,CAAgC9V,EAAhC;AACH,OAHD;AAKA;;;;;;;;;;AAQAq3D,UAAI,CAAC56D,SAAL,CAAe0+D,WAAf,GAA6B,UAAS7B,KAAT,EAAgB8B,aAAhB,EAA+BC,aAA/B,EAA8CxB,cAA9C,EAA8D;AACvF,eAAO,KAAKoD,eAAL,GAAuB9B,WAAvB,CAAmC7B,KAAnC,EAA0C8B,aAA1C,EAAyDC,aAAzD,EAAwExB,cAAxE,CAAP;AACH,OAFD;AAIA;;;;;;;;AAMAxC,UAAI,CAAC56D,SAAL,CAAewsC,eAAf,GAAiC,UAASmyB,aAAT,EAAwBC,aAAxB,EAAuCxB,cAAvC,EAAuD;AACpF,aAAKoD,eAAL,GAAuBh0B,eAAvB,CAAuCmyB,aAAvC,EAAsDC,aAAtD,EAAqExB,cAArE;AACH,OAFD;AAIA;;;;;;;;AAMAxC,UAAI,CAAC56D,SAAL,CAAeq9D,QAAf,GAA0B,UAASmB,OAAT,EAAkB;AACxC,eAAO,KAAKgC,eAAL,GAAuBnD,QAAvB,CAAgCmB,OAAhC,CAAP;AACH,OAFD;AAIA;;;;;;AAIA5D,UAAI,CAAC56D,SAAL,CAAey+D,SAAf,GAA2B,YAAW;AAClC,eAAO,KAAK+B,eAAL,GAAuB/B,SAAvB,EAAP;AACH,OAFD;AAIA;;;;;;;;;;;;;;;;AAcA7D,UAAI,CAAC56D,SAAL,CAAe6+D,WAAf,GAA6B,UAAShC,KAAT,EAAgB;AACzC,aAAK2D,eAAL,GAAuB3B,WAAvB,CAAmChC,KAAnC;AACH,OAFD;AAIA;;;;;;;;;;;;;;;;AAcAjC,UAAI,CAAC56D,SAAL,CAAeo/D,aAAf,GAA+B,UAASZ,OAAT,EAAkB;AAC7C,aAAKgC,eAAL,GAAuBpB,aAAvB,CAAqCZ,OAArC;AACH,OAFD;;AAKA5D,UAAI,CAAC56D,SAAL,CAAes/D,YAAf,GAA8B,UAASzC,KAAT,EAAgB;AAC1C,aAAK2D,eAAL,GAAuBlB,YAAvB,CAAoCzC,KAApC;AACH,OAFD;AAIA;;;;;;;;AAMAjC,UAAI,CAAC56D,SAAL,CAAe+hE,WAAf,GAA6B,UAASlF,KAAT,EAAgB;AACzCA,aAAK,GAAG,KAAK2D,eAAL,GAAuBnD,QAAvB,CAAgCR,KAAhC,CAAR;;AACA,YAAIA,KAAK,IAAI,IAAb,EAAmB;AACf,eAAK2D,eAAL,GAAuB3D,KAAK,CAACe,SAAN,GAAkB,aAAlB,GAAkC,eAAzD,EAA0Ef,KAA1E;AACH;AACJ,OALD,CA12BS,CAi3BT;AACA;AACA;;;AACAjC,UAAI,CAAC56D,SAAL,CAAewgE,eAAf,GAAiC,YAAW;AACxC,YAAIwB,GAAG,GAAG,KAAK7G,aAAL,CAAV;;AACA,YAAI6G,GAAG,IAAI,IAAX,EAAiB;AACbA,aAAG,GAAG,KAAK7G,aAAL,IAAsB,IAAIgB,YAAJ,CAAiB,IAAjB,CAA5B;AACH;;AACD,eAAO6F,GAAP;AACH,OAND;;AAQApH,UAAI,CAAC56D,SAAL,CAAeysC,kBAAf,GAAoC,YAAW;AAC3C,eAAO,KAAK0uB,aAAL,CAAP;AACH,OAFD;AAIA;;;;;;;;AAMAP,UAAI,CAAC56D,SAAL,CAAe08D,WAAf,GAA6B,UAASn5D,EAAT,EAAa;AACtCA,UAAE,GAAG,KAAKgwB,UAAL,CAAgBhwB,EAAhB,CAAL;;AACA,YAAIA,EAAJ,EAAQ;AACJ,cAAI7M,CAAC,GAAG,KAAK0zB,YAAL,EAAR;AACA,cAAItQ,KAAK,GAAG,KAAZ;AAAA,cAAmB3U,CAAC,GAAG,IAAvB;AAAA,cAA6Byf,KAAK,GAAG,IAArC;;AACA,iBAAO,CAAC9K,KAAR,EAAe;AACX,gBAAIvW,EAAE,IAAI,IAAN,IAAcA,EAAE,KAAK7M,CAAzB,EAA4B;AACxBojB,mBAAK,GAAG,IAAR;AACH,aAFD,MAEO;AACH,kBAAIvW,EAAE,CAAC63D,KAAD,CAAN,EAAe;AACXj2D,iBAAC,GAAG5B,EAAE,CAAC63D,KAAD,CAAN;AACAx2C,qBAAK,GAAGrhB,EAAR;AACAuW,qBAAK,GAAG,IAAR;AACH,eAJD,MAIO;AACHvW,kBAAE,GAAGA,EAAE,CAACG,UAAR;AACH;AACJ;AACJ;;AACD,iBAAOyB,CAAP;AACH;AACJ,OApBD;AAsBH,KA55BA,EA45BExF,IA55BF,CA45BO,OAAOC,MAAP,KAAkB,WAAlB,GAAgCA,MAAhC,GAAyC,IA55BhD;AA+5BD;;;;;;;;;;;AAUA;AACA,KAAC,YAAY;AAET;;AACA,UAAIxL,IAAI,GAAG,IAAX;AAAA,UAAiBo8C,GAAG,GAAGp8C,IAAI,CAACy3B,OAA5B;AAAA,UAAqCR,GAAG,GAAGj3B,IAAI,CAAC0tB,WAAhD;AACA,UAAImgD,QAAQ,GAAG,UAAf;AACA,UAAIC,GAAG,GAAG,KAAV;;AAEA,UAAIC,SAAS,GAAG,SAAZA,SAAY,CAAUt2D,MAAV,EAAkB;AAC9B,aAAKpD,IAAL,GAAY,WAAZ;AACAoD,cAAM,GAAGA,MAAM,IAAI,EAAnB;AACAA,cAAM,CAACwmD,IAAP,GAAcxmD,MAAM,CAACwmD,IAAP,IAAe,IAAf,GAAsB,EAAtB,GAA2BxmD,MAAM,CAACwmD,IAAhD;;AACA,YAAIrF,QAAJ;AAAA,YACImB,MAAM,GAAG3d,GAAG,CAAChU,UAAJ,CAAey1B,iBAAf,CAAiCz0D,KAAjC,CAAuC,IAAvC,EAA6C0F,SAA7C,CADb;AAAA,YAEIk/D,QAAQ,GAAGv2D,MAAM,CAACu2D,QAAP,IAAmB,IAAnB,GAA0B,GAA1B,GAAgCv2D,MAAM,CAACu2D,QAFtD;AAAA,YAGIC,kBAAkB,GAAGx2D,MAAM,CAACw2D,kBAAP,KAA8B,IAHvD;AAAA,YAIIC,KAAK,GAAG,IAJZ;AAAA,YAIkBC,KAAK,GAAG,IAJ1B;AAAA,YAIgCC,eAJhC;AAAA,YAKIC,YAAY,GAAG52D,MAAM,CAAC42D,YAAP,IAAuB,IAAvB,GAA8B52D,MAAM,CAAC42D,YAArC,GAAoD,CALvE;AAAA,YAOI;AACAC,sBAAc,GAAG72D,MAAM,CAAC62D,cAAP,IAAyB,EAR9C;AAAA,YASIC,mBAAmB,GAAG,KAT1B;AAAA,YAWIruE,GAAG,GAAG,SAANA,GAAM,CAAU2C,CAAV,EAAa;AACf,iBAAOA,CAAC,GAAG,CAAJ,GAAQ,CAAC,CAAT,GAAaA,CAAC,KAAK,CAAN,GAAU,CAAV,GAAc,CAAlC;AACH,SAbL;AAAA,YAcI2rE,iBAAiB,GAAG,SAApBA,iBAAoB,CAAShT,OAAT,EAAkB;AACtC,iBAAO,CACCt7D,GAAG,CAAEs7D,OAAO,CAAC,CAAD,CAAP,GAAaA,OAAO,CAAC,CAAD,CAAtB,CADJ,EAECt7D,GAAG,CAAEs7D,OAAO,CAAC,CAAD,CAAP,GAAaA,OAAO,CAAC,CAAD,CAAtB,CAFJ,CAAP;AAIC,SAnBL;;AAoBI;;;AAGAwF,kBAAU,GAAG,SAAbA,UAAa,CAAUpI,QAAV,EAAoBz4D,CAApB,EAAuBK,CAAvB,EAA0Bg+D,SAA1B,EAAqC;AAC9C,cAAI0P,KAAK,KAAK/tE,CAAV,IAAeguE,KAAK,KAAK3tE,CAA7B,EAAgC;AAC5B;AACH;;AACD,cAAIiuE,EAAE,GAAGP,KAAK,IAAI,IAAT,GAAgB1P,SAAS,CAACmB,EAA1B,GAA+BuO,KAAxC;AAAA,cACIQ,EAAE,GAAGP,KAAK,IAAI,IAAT,GAAgB3P,SAAS,CAACoB,EAA1B,GAA+BuO,KADxC;AAAA,cAEIljD,CAAC,GAAGwjD,EAAE,KAAKtuE,CAAP,GAAW,GAAX,GAAiB,GAFzB;AAIA+tE,eAAK,GAAG/tE,CAAR;AACAguE,eAAK,GAAG3tE,CAAR;AACAo4D,kBAAQ,CAACnyD,IAAT,CAAc,CAAEgoE,EAAF,EAAMC,EAAN,EAAUvuE,CAAV,EAAaK,CAAb,EAAgByqB,CAAhB,CAAd;AACH,SAlCL;AAAA,YAmCI0jD,SAAS,GAAG,SAAZA,SAAY,CAAU7tE,CAAV,EAAa;AACrB,iBAAOb,IAAI,CAACW,IAAL,CAAUX,IAAI,CAACgB,GAAL,CAASH,CAAC,CAAC,CAAD,CAAD,GAAOA,CAAC,CAAC,CAAD,CAAjB,EAAsB,CAAtB,IAA2Bb,IAAI,CAACgB,GAAL,CAASH,CAAC,CAAC,CAAD,CAAD,GAAOA,CAAC,CAAC,CAAD,CAAjB,EAAsB,CAAtB,CAArC,CAAP;AACH,SArCL;AAAA,YAsCI8tE,WAAW,GAAG,SAAdA,WAAc,CAAUrqE,CAAV,EAAa;AACvB,cAAI8sC,EAAE,GAAG,EAAT;;AACAA,YAAE,CAAC5qC,IAAH,CAAQ2C,KAAR,CAAcioC,EAAd,EAAkB9sC,CAAlB;;AACA,iBAAO8sC,EAAP;AACH,SA1CL;AAAA,YA2CIw9B,aAAa,GAAG,SAAhBA,aAAgB,CAAUn6C,IAAV,EAAgBkkC,QAAhB,EAA0B4F,SAA1B,EAAqC;AACjD,cAAIlR,OAAO,GAAG,IAAd;AAAA,cAAoBwhB,IAApB;AAAA,cAA0BC,gBAA1B;AAAA,cAA4CC,aAA5C;;AACA,eAAK,IAAIjtE,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG62D,QAAQ,CAACn3D,MAAT,GAAkB,CAAtC,EAAyCM,CAAC,EAA1C,EAA8C;AAE1CurD,mBAAO,GAAGA,OAAO,IAAIshB,WAAW,CAAChW,QAAQ,CAAC72D,CAAD,CAAT,CAAhC;AACA+sE,gBAAI,GAAGF,WAAW,CAAChW,QAAQ,CAAC72D,CAAC,GAAG,CAAL,CAAT,CAAlB;AAEAgtE,4BAAgB,GAAGP,iBAAiB,CAAClhB,OAAD,CAApC;AACA0hB,yBAAa,GAAGR,iBAAiB,CAACM,IAAD,CAAjC;;AAEA,gBAAIT,YAAY,GAAG,CAAf,IAAoB/gB,OAAO,CAAC,CAAD,CAAP,KAAewhB,IAAI,CAAC,CAAD,CAA3C,EAAgD;AAE5C,kBAAIG,YAAY,GAAGhvE,IAAI,CAACkD,GAAL,CAASwrE,SAAS,CAACrhB,OAAD,CAAlB,EAA6BqhB,SAAS,CAACG,IAAD,CAAtC,CAAnB;AACA,kBAAII,WAAW,GAAGjvE,IAAI,CAACkD,GAAL,CAASkrE,YAAT,EAAuBY,YAAY,GAAG,CAAtC,CAAlB;AAEA3hB,qBAAO,CAAC,CAAD,CAAP,IAAcyhB,gBAAgB,CAAC,CAAD,CAAhB,GAAsBG,WAApC;AACA5hB,qBAAO,CAAC,CAAD,CAAP,IAAcyhB,gBAAgB,CAAC,CAAD,CAAhB,GAAsBG,WAApC;AACAJ,kBAAI,CAAC,CAAD,CAAJ,IAAWE,aAAa,CAAC,CAAD,CAAb,GAAmBE,WAA9B;AACAJ,kBAAI,CAAC,CAAD,CAAJ,IAAWE,aAAa,CAAC,CAAD,CAAb,GAAmBE,WAA9B;AAEA,kBAAIlT,EAAE,GAAI+S,gBAAgB,CAAC,CAAD,CAAhB,KAAwBC,aAAa,CAAC,CAAD,CAArC,IAA4CA,aAAa,CAAC,CAAD,CAAb,KAAqB,CAAlE,IACCD,gBAAgB,CAAC,CAAD,CAAhB,KAAwBC,aAAa,CAAC,CAAD,CAArC,IAA4CA,aAAa,CAAC,CAAD,CAAb,KAAqB,CAAlE,IAAwED,gBAAgB,CAAC,CAAD,CAAhB,KAAwBC,aAAa,CAAC,CAAD,CAD7G,IAEAD,gBAAgB,CAAC,CAAD,CAAhB,KAAwBC,aAAa,CAAC,CAAD,CAArC,IAA4CA,aAAa,CAAC,CAAD,CAAb,KAAqB,CAAC,CAF3E;AAAA,kBAGQG,IAAI,GAAGL,IAAI,CAAC,CAAD,CAAJ,GAAUxhB,OAAO,CAAC,CAAD,CAAjB,GAAuB,CAAvB,GAA2B,CAAC,CAH3C;AAAA,kBAIQ8hB,IAAI,GAAGN,IAAI,CAAC,CAAD,CAAJ,GAAUxhB,OAAO,CAAC,CAAD,CAAjB,GAAuB,CAAvB,GAA2B,CAAC,CAJ3C;AAAA,kBAKQ+hB,QAAQ,GAAGF,IAAI,KAAKC,IAL5B;AAAA,kBAMQtY,EAAE,GAAIuY,QAAQ,IAAIrT,EAAZ,IAAmB,CAACqT,QAAD,IAAa,CAACrT,EAAlC,GAAyC8S,IAAI,CAAC,CAAD,CAA7C,GAAmDxhB,OAAO,CAAC,CAAD,CANvE;AAAA,kBAOQyJ,EAAE,GAAIsY,QAAQ,IAAIrT,EAAZ,IAAmB,CAACqT,QAAD,IAAa,CAACrT,EAAlC,GAAyC1O,OAAO,CAAC,CAAD,CAAhD,GAAsDwhB,IAAI,CAAC,CAAD,CAPvE;;AASA/U,oBAAM,CAACiH,UAAP,CAAkBtsC,IAAlB,EAAwBm5C,QAAxB,EAAkC;AAC9BjlE,kBAAE,EAAE0kD,OAAO,CAAC,CAAD,CADmB;AACdzkD,kBAAE,EAAEykD,OAAO,CAAC,CAAD,CADG;AACExkD,kBAAE,EAAEwkD,OAAO,CAAC,CAAD,CADb;AACkBvkD,kBAAE,EAAEukD,OAAO,CAAC,CAAD;AAD7B,eAAlC;;AAIAyM,oBAAM,CAACiH,UAAP,CAAkBtsC,IAAlB,EAAwBo5C,GAAxB,EAA6B;AACzB5kE,iBAAC,EAAEgmE,WADsB;AAEzBtmE,kBAAE,EAAE0kD,OAAO,CAAC,CAAD,CAFc;AAGzBzkD,kBAAE,EAAEykD,OAAO,CAAC,CAAD,CAHc;AAIzBxkD,kBAAE,EAAEgmE,IAAI,CAAC,CAAD,CAJiB;AAKzB/lE,kBAAE,EAAE+lE,IAAI,CAAC,CAAD,CALiB;AAMzBhY,kBAAE,EAAEA,EANqB;AAOzBC,kBAAE,EAAEA,EAPqB;AAQzBiF,kBAAE,EAAEA;AARqB,eAA7B;AAUH,aAjCD,MAkCK;AACD;AACA,kBAAI7zD,EAAE,GAAImlD,OAAO,CAAC,CAAD,CAAP,KAAeA,OAAO,CAAC,CAAD,CAAvB,GAA8B,CAA9B,GAAmCA,OAAO,CAAC,CAAD,CAAP,GAAaA,OAAO,CAAC,CAAD,CAArB,GAA6BkR,SAAS,CAACgB,EAAV,GAAe,CAA5C,GAAiD,EAAEhB,SAAS,CAACgB,EAAV,GAAe,CAAjB,CAA5F;AAAA,kBACIt3D,EAAE,GAAIolD,OAAO,CAAC,CAAD,CAAP,KAAeA,OAAO,CAAC,CAAD,CAAvB,GAA8B,CAA9B,GAAmCA,OAAO,CAAC,CAAD,CAAP,GAAaA,OAAO,CAAC,CAAD,CAArB,GAA6BkR,SAAS,CAACgB,EAAV,GAAe,CAA5C,GAAiD,EAAEhB,SAAS,CAACgB,EAAV,GAAe,CAAjB,CAD5F;;AAGAzF,oBAAM,CAACiH,UAAP,CAAkBtsC,IAAlB,EAAwBm5C,QAAxB,EAAkC;AAC9BjlE,kBAAE,EAAE0kD,OAAO,CAAC,CAAD,CAAP,GAAanlD,EADa;AACTU,kBAAE,EAAEykD,OAAO,CAAC,CAAD,CAAP,GAAaplD,EADR;AACYY,kBAAE,EAAEwkD,OAAO,CAAC,CAAD,CAAP,GAAanlD,EAD7B;AACiCY,kBAAE,EAAEukD,OAAO,CAAC,CAAD,CAAP,GAAaplD;AADlD,eAAlC;AAGH;;AACDolD,mBAAO,GAAGwhB,IAAV;AACH;;AACD,cAAIA,IAAI,IAAI,IAAZ,EAAkB;AACd;AACA/U,kBAAM,CAACiH,UAAP,CAAkBtsC,IAAlB,EAAwBm5C,QAAxB,EAAkC;AAC9BjlE,gBAAE,EAAEkmE,IAAI,CAAC,CAAD,CADsB;AACjBjmE,gBAAE,EAAEimE,IAAI,CAAC,CAAD,CADS;AACJhmE,gBAAE,EAAEgmE,IAAI,CAAC,CAAD,CADJ;AACS/lE,gBAAE,EAAE+lE,IAAI,CAAC,CAAD;AADjB,aAAlC;AAGH;AACJ,SAxGL;;AA0GA,aAAK7R,QAAL,GAAgB,UAAUuB,SAAV,EAAqB/mD,MAArB,EAA6B;AAEzCmhD,kBAAQ,GAAG,EAAX;AACAsV,eAAK,GAAG,IAAR;AACAC,eAAK,GAAG,IAAR;AACAC,yBAAe,GAAG,IAAlB;;AAEA,cAAIkB,oBAAoB,GAAG,SAAvBA,oBAAuB,GAAY;AAC/B,mBAAO,CAAC9Q,SAAS,CAACwB,UAAX,EAAuBxB,SAAS,CAACyB,UAAjC,EAA6CzB,SAAS,CAAC0B,QAAvD,EAAiE1B,SAAS,CAAC2B,QAA3E,CAAP;AACH,WAFL;AAAA,cAGIoP,eAAe,GAAG;AACdhP,yBAAa,EAAE+O,oBADD;AAEd9O,sBAAU,EAAE8O,oBAFE;AAGdhP,oBAAQ,EAAE,kBAAUz2D,IAAV,EAAgB;AACtB,kBAAI2lE,EAAE,GAAGhR,SAAT;AAAA,kBACIjoD,GAAG,GAAG1M,IAAI,KAAK,GAAT,GAAe,CAAf,GAAmB,CAD7B;AAAA,kBAEI4lE,cAAc,GAAG;AACb,qBAAK,aAAY;AACb,yBAAUD,EAAE,CAAC/P,EAAH,CAAMlpD,GAAN,MAAe,CAAf,KACHi5D,EAAE,CAACxP,UAAH,GAAgBwP,EAAE,CAACtP,QAApB,IAAkCsP,EAAE,CAACptD,EAAH,GAAQotD,EAAE,CAACxP,UAA/C,IACGwP,EAAE,CAAC7P,EAAH,GAAQ6P,EAAE,CAACtP,QAAZ,IAA0BsP,EAAE,CAACptD,EAAH,GAAQotD,EAAE,CAAC7P,EAFjC,CAAH,IAIA6P,EAAE,CAAC/P,EAAH,CAAMlpD,GAAN,MAAe,CAAC,CAAhB,KACAi5D,EAAE,CAACxP,UAAH,GAAgBwP,EAAE,CAACtP,QAApB,IAAkCsP,EAAE,CAACptD,EAAH,GAAQotD,EAAE,CAACxP,UAA/C,IACGwP,EAAE,CAAC7P,EAAH,GAAQ6P,EAAE,CAACtP,QAAZ,IAA0BsP,EAAE,CAACptD,EAAH,GAAQotD,EAAE,CAAC7P,EAFpC,CAJP;AAOH,iBATY;AAUb,qBAAK,aAAY;AACb,yBAAU6P,EAAE,CAAC/P,EAAH,CAAMlpD,GAAN,MAAe,CAAf,KACHi5D,EAAE,CAACvP,UAAH,GAAgBuP,EAAE,CAACrP,QAApB,IAAkCqP,EAAE,CAACntD,EAAH,GAAQmtD,EAAE,CAACvP,UAA/C,IACGuP,EAAE,CAAC5P,EAAH,GAAQ4P,EAAE,CAACrP,QAAZ,IAA0BqP,EAAE,CAACntD,EAAH,GAAQmtD,EAAE,CAAC5P,EAFjC,CAAH,IAIA4P,EAAE,CAAC/P,EAAH,CAAMlpD,GAAN,MAAe,CAAC,CAAhB,KACAi5D,EAAE,CAACvP,UAAH,GAAgBuP,EAAE,CAACrP,QAApB,IAAkCqP,EAAE,CAACntD,EAAH,GAAQmtD,EAAE,CAACvP,UAA/C,IACGuP,EAAE,CAAC5P,EAAH,GAAQ4P,EAAE,CAACrP,QAAZ,IAA0BqP,EAAE,CAACntD,EAAH,GAAQmtD,EAAE,CAAC5P,EAFpC,CAJP;AAOH;AAlBY,eAFrB;;AAuBA,kBAAI,CAACqO,kBAAD,IAAuBwB,cAAc,CAAC5lE,IAAD,CAAd,EAA3B,EAAmD;AAC/C,uBAAO;AACH,uBAAK,CAAC,CAAC20D,SAAS,CAACmB,EAAV,GAAenB,SAAS,CAACp8C,EAA1B,IAAgC,CAAjC,EAAoCo8C,SAAS,CAACyB,UAA9C,EAA0D,CAACzB,SAAS,CAACmB,EAAV,GAAenB,SAAS,CAACp8C,EAA1B,IAAgC,CAA1F,EAA6Fo8C,SAAS,CAAC2B,QAAvG,CADF;AAEH,uBAAK,CAAC3B,SAAS,CAACwB,UAAX,EAAuB,CAACxB,SAAS,CAACoB,EAAV,GAAepB,SAAS,CAACn8C,EAA1B,IAAgC,CAAvD,EAA0Dm8C,SAAS,CAAC0B,QAApE,EAA8E,CAAC1B,SAAS,CAACoB,EAAV,GAAepB,SAAS,CAACn8C,EAA1B,IAAgC,CAA9G;AAFF,kBAGLxY,IAHK,CAAP;AAIH,eALD,MAMK;AACD,uBAAO,CAAC20D,SAAS,CAACwB,UAAX,EAAuBxB,SAAS,CAACyB,UAAjC,EAA6CzB,SAAS,CAAC0B,QAAvD,EAAiE1B,SAAS,CAAC2B,QAA3E,CAAP;AACH;AACJ;AApCa,WAHtB,CAPyC,CAiDzC;;;AACA,cAAIO,KAAK,GAAG6O,eAAe,CAAC/Q,SAAS,CAACmC,iBAAX,CAAf,CAA6CnC,SAAS,CAACiC,UAAvD,CAAZ;AAAA,cACIlqD,GAAG,GAAGioD,SAAS,CAACiC,UAAV,KAAyB,GAAzB,GAA+B,CAA/B,GAAmC,CAD7C;AAAA,cAEIh6B,IAAI,GAAG+3B,SAAS,CAACiC,UAAV,KAAyB,GAAzB,GAA+B,CAA/B,GAAmC,CAF9C;AAAA,cAGI5yB,EAAE,GAAG6yB,KAAK,CAACnqD,GAAD,CAHd;AAAA,cAIIm5D,GAAG,GAAGhP,KAAK,CAACj6B,IAAD,CAJf;AAAA,cAKIqmB,EAAE,GAAG4T,KAAK,CAACnqD,GAAG,GAAG,CAAP,CALd;AAAA,cAMIo5D,GAAG,GAAGjP,KAAK,CAACj6B,IAAI,GAAG,CAAR,CANf,CAlDyC,CA0DzC;AACA;;AACAu6B,oBAAU,CAACpI,QAAD,EAAW8H,KAAK,CAAC,CAAD,CAAhB,EAAqBA,KAAK,CAAC,CAAD,CAA1B,EAA+BlC,SAA/B,CAAV,CA5DyC,CA8DzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGI,cAAIoR,IAAI,GAAGpR,SAAS,CAACwB,UAAV,GAAwB,CAACxB,SAAS,CAAC0B,QAAV,GAAqB1B,SAAS,CAACwB,UAAhC,IAA8CgO,QAAjF;AAAA,cACI6B,IAAI,GAAGrR,SAAS,CAACyB,UAAV,GAAwB,CAACzB,SAAS,CAAC2B,QAAV,GAAqB3B,SAAS,CAACyB,UAAhC,IAA8C+N,QADjF;AAGA,cAAI8B,YAAY,GAAG;AAAC3vE,aAAC,EAAE,CAAC,CAAD,EAAI,CAAJ,CAAJ;AAAYK,aAAC,EAAE,CAAC,CAAD,EAAI,CAAJ;AAAf,WAAnB;AAAA,cACIuvE,eAAe,GAAG;AACdxP,yBAAa,EAAE,uBAAU12D,IAAV,EAAgB;AAC3B,kBAAI2lE,EAAE,GAAGhR,SAAT;AAAA,kBACIwR,GAAG,GAAG;AACF7vE,iBAAC,EAAE,CACC,CAAC,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,CAAD,EAAe,IAAf,EAAqB,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,CAArB,CADD,EAEC,IAFD,EAGC,CAAC,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,CAAD,EAAe,IAAf,EAAqB,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,CAArB,CAHD,CADD;AAMFK,iBAAC,EAAE,CACC,CAAC,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,CAAD,EAAe,IAAf,EAAqB,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,CAArB,CADD,EAEC,IAFD,EAGC,CAAC,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,CAAD,EAAe,IAAf,EAAqB,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,CAArB,CAHD;AAND,eADV;AAAA,kBAaIkgE,KAAK,GAAG;AACJvgE,iBAAC,EAAE,CAAC,CAACqvE,EAAE,CAACxP,UAAJ,EAAgBwP,EAAE,CAACtP,QAAnB,CAAD,EAA+B,IAA/B,EAAqC,CAACsP,EAAE,CAACtP,QAAJ,EAAcsP,EAAE,CAACxP,UAAjB,CAArC,CADC;AAEJx/D,iBAAC,EAAE,CAAC,CAACgvE,EAAE,CAACvP,UAAJ,EAAgBuP,EAAE,CAACrP,QAAnB,CAAD,EAA+B,IAA/B,EAAqC,CAACqP,EAAE,CAACrP,QAAJ,EAAcqP,EAAE,CAACvP,UAAjB,CAArC;AAFC,eAbZ;AAAA,kBAiBIgQ,QAAQ,GAAG;AACP9vE,iBAAC,EAAE,CAAC,CAACyvE,IAAD,EAAOJ,EAAE,CAACvP,UAAV,CAAD,EAAwB,CAAC2P,IAAD,EAAOJ,EAAE,CAACrP,QAAV,CAAxB,CADI;AAEP3/D,iBAAC,EAAE,CAAC,CAACgvE,EAAE,CAACxP,UAAJ,EAAgB6P,IAAhB,CAAD,EAAwB,CAACL,EAAE,CAACtP,QAAJ,EAAc2P,IAAd,CAAxB;AAFI,eAjBf;AAAA,kBAqBIK,UAAU,GAAG;AACT/vE,iBAAC,EAAE,CAAC,CAACqvE,EAAE,CAACtP,QAAJ,EAAcsP,EAAE,CAACvP,UAAjB,CAAD,CADM;AAETz/D,iBAAC,EAAE,CAAC,CAACgvE,EAAE,CAACxP,UAAJ,EAAgBwP,EAAE,CAACrP,QAAnB,CAAD;AAFM,eArBjB;AAAA,kBAyBIgQ,UAAU,GAAG;AACThwE,iBAAC,EAAE,CAAC,CAACqvE,EAAE,CAACxP,UAAJ,EAAgBwP,EAAE,CAACrP,QAAnB,CAAD,EAA+B,CAACqP,EAAE,CAACtP,QAAJ,EAAcsP,EAAE,CAACrP,QAAjB,CAA/B,CADM;AAET3/D,iBAAC,EAAE,CAAC,CAACgvE,EAAE,CAACtP,QAAJ,EAAcsP,EAAE,CAACvP,UAAjB,CAAD,EAA+B,CAACuP,EAAE,CAACtP,QAAJ,EAAcsP,EAAE,CAACrP,QAAjB,CAA/B;AAFM,eAzBjB;AAAA,kBA6BIiQ,eAAe,GAAG;AACdjwE,iBAAC,EAAE,CAAC,CAACqvE,EAAE,CAACxP,UAAJ,EAAgB6P,IAAhB,CAAD,EAAwB,CAACL,EAAE,CAACtP,QAAJ,EAAc2P,IAAd,CAAxB,EAA6C,CAACL,EAAE,CAACtP,QAAJ,EAAcsP,EAAE,CAACrP,QAAjB,CAA7C,CADW;AAEd3/D,iBAAC,EAAE,CAAC,CAACovE,IAAD,EAAOJ,EAAE,CAACvP,UAAV,CAAD,EAAwB,CAAC2P,IAAD,EAAOJ,EAAE,CAACrP,QAAV,CAAxB,EAA6C,CAACqP,EAAE,CAACtP,QAAJ,EAAcsP,EAAE,CAACrP,QAAjB,CAA7C;AAFW,eA7BtB;AAAA,kBAiCIkQ,UAAU,GAAG;AACTlwE,iBAAC,EAAE,CAACqvE,EAAE,CAACvP,UAAJ,EAAgBuP,EAAE,CAACrP,QAAnB,CADM;AAET3/D,iBAAC,EAAE,CAACgvE,EAAE,CAACxP,UAAJ,EAAgBwP,EAAE,CAACtP,QAAnB;AAFM,eAjCjB;AAAA,kBAqCIoQ,KAAK,GAAGR,YAAY,CAACjmE,IAAD,CAAZ,CAAmB,CAAnB,CArCZ;AAAA,kBAqCmC0mE,KAAK,GAAGT,YAAY,CAACjmE,IAAD,CAAZ,CAAmB,CAAnB,CArC3C;AAAA,kBAsCI2mE,GAAG,GAAGhB,EAAE,CAAC/P,EAAH,CAAM6Q,KAAN,IAAe,CAtCzB;AAAA,kBAuCIG,GAAG,GAAGjB,EAAE,CAACl1B,EAAH,CAAMi2B,KAAN,IAAe,CAvCzB;AAAA,kBAwCIG,YAAY,GAAIlB,EAAE,CAACl1B,EAAH,CAAMi2B,KAAN,MAAiB,CAAC,CAAlB,IAAwBF,UAAU,CAACxmE,IAAD,CAAV,CAAiB,CAAjB,IAAsBwmE,UAAU,CAACxmE,IAAD,CAAV,CAAiB,CAAjB,CAA/C,IAAyE2lE,EAAE,CAACl1B,EAAH,CAAMi2B,KAAN,MAAiB,CAAjB,IAAuBF,UAAU,CAACxmE,IAAD,CAAV,CAAiB,CAAjB,IAAsBwmE,UAAU,CAACxmE,IAAD,CAAV,CAAiB,CAAjB,CAxCzI;AAAA,kBAyCI8mE,KAAK,GAAGjQ,KAAK,CAAC72D,IAAD,CAAL,CAAY2mE,GAAZ,EAAiB,CAAjB,CAzCZ;AAAA,kBA0CII,KAAK,GAAGlQ,KAAK,CAAC72D,IAAD,CAAL,CAAY2mE,GAAZ,EAAiB,CAAjB,CA1CZ;AAAA,kBA2CIK,cAAc,GAAGb,GAAG,CAACnmE,IAAD,CAAH,CAAU2mE,GAAV,EAAeC,GAAf,CA3CrB;;AA6CA,kBAAIjB,EAAE,CAAChU,OAAH,KAAeqV,cAAc,CAAC,CAAD,CAA7B,IAAqCrB,EAAE,CAAChU,OAAH,KAAeqV,cAAc,CAAC,CAAD,CAA7B,IAAoCH,YAA7E,EAA4F;AACxF,uBAAOT,QAAQ,CAACpmE,IAAD,CAAf;AACH,eAFD,MAGK,IAAI2lE,EAAE,CAAChU,OAAH,KAAeqV,cAAc,CAAC,CAAD,CAA7B,IAAoCD,KAAK,GAAGD,KAAhD,EAAuD;AACxD,uBAAOT,UAAU,CAACrmE,IAAD,CAAjB;AACH,eAFI,MAGA,IAAK2lE,EAAE,CAAChU,OAAH,KAAeqV,cAAc,CAAC,CAAD,CAA7B,IAAoCD,KAAK,IAAID,KAA9C,IAAyDnB,EAAE,CAAChU,OAAH,KAAeqV,cAAc,CAAC,CAAD,CAA7B,IAAoC,CAACH,YAAlG,EAAiH;AAClH,uBAAON,eAAe,CAACvmE,IAAD,CAAtB;AACH,eAFI,MAGA,IAAI2lE,EAAE,CAAChU,OAAH,KAAeqV,cAAc,CAAC,CAAD,CAA7B,IAAqCrB,EAAE,CAAChU,OAAH,KAAeqV,cAAc,CAAC,CAAD,CAA7B,IAAoCH,YAA7E,EAA4F;AAC7F,uBAAOP,UAAU,CAACtmE,IAAD,CAAjB;AACH;AACJ,aA3Da;AA4Dd22D,sBAAU,EAAE,oBAAU32D,IAAV,EAAgBinE,SAAhB,EAA2BC,cAA3B,EAA2CC,OAA3C,EAAoDC,YAApD,EAAkE;AAC1E,kBAAIzB,EAAE,GAAGhR,SAAT;AAAA,kBACI0S,MAAM,GAAG;AACL,qBAAK1B,EAAE,CAAC/P,EAAH,CAAM,CAAN,MAAa,CAAC,CAAd,GAAkBx/D,IAAI,CAACkD,GAAL,CAAS2tE,SAAT,EAAoBE,OAApB,CAAlB,GAAiD/wE,IAAI,CAACgD,GAAL,CAAS6tE,SAAT,EAAoBE,OAApB,CADjD;AAEL,qBAAKxB,EAAE,CAAC/P,EAAH,CAAM,CAAN,MAAa,CAAC,CAAd,GAAkBx/D,IAAI,CAACkD,GAAL,CAAS2tE,SAAT,EAAoBE,OAApB,CAAlB,GAAiD/wE,IAAI,CAACgD,GAAL,CAAS6tE,SAAT,EAAoBE,OAApB;AAFjD,gBAGPnnE,IAHO,CADb;AAMA,qBAAO;AACH,qBAAK,CACD,CAACqnE,MAAD,EAASH,cAAT,CADC,EAED,CAACG,MAAD,EAASD,YAAT,CAFC,EAGD,CAACD,OAAD,EAAUC,YAAV,CAHC,CADF;AAMH,qBAAK,CACD,CAACF,cAAD,EAAiBG,MAAjB,CADC,EAED,CAACD,YAAD,EAAeC,MAAf,CAFC,EAGD,CAACD,YAAD,EAAeD,OAAf,CAHC;AANF,gBAWLnnE,IAXK,CAAP;AAYH,aA/Ea;AAgFdy2D,oBAAQ,EAAE,kBAAUz2D,IAAV,EAAgBgkC,EAAhB,EAAoB6hC,GAApB,EAAyB5iB,EAAzB,EAA6B;AACnC,kBAAI0iB,EAAE,GAAGhR,SAAT;AAAA,kBACI2S,SAAS,GAAG;AAAC,qBAAK,GAAN;AAAW,qBAAK;AAAhB,gBAAqBtnE,IAArB,CADhB;AAAA,kBAEIorD,GAAG,GAAG;AAAC,qBAAK,QAAN;AAAgB,qBAAK;AAArB,gBAA8BprD,IAA9B,CAFV;AAAA,kBAGIunE,UAAU,GAAG5B,EAAE,CAAC,OAAO3lE,IAAI,CAACwnE,WAAL,EAAP,GAA4B,uBAA7B,CAHnB;;AAKA,kBAAI55D,MAAM,CAACgrB,cAAP,CAAsBgD,SAAtB,KAAoChuB,MAAM,CAACirB,cAAP,CAAsB+C,SAA9D,EAAyE;AACrE,oBAAI6rC,IAAI,GAAG5B,GAAG,GAAI,CAAC,IAAIj4D,MAAM,CAACgrB,cAAP,CAAsBvM,MAAtB,CAA6Bi7C,SAA7B,CAAL,IAAgD15D,MAAM,CAAC8zC,UAAP,CAAkB0J,GAAlB,CAAvD,GAAiF8E,MAAM,CAACmH,OAAnG;;AACA,uBAAO;AACH,uBAAK,CACD,CAACrzB,EAAD,EAAKyjC,IAAL,CADC,EAED,CAACxkB,EAAD,EAAKwkB,IAAL,CAFC,CADF;AAKH,uBAAK,CACD,CAACA,IAAD,EAAOzjC,EAAP,CADC,EAED,CAACyjC,IAAD,EAAOxkB,EAAP,CAFC;AALF,kBASLjjD,IATK,CAAP;AAWH,eAbD,MAcK,IAAI,CAACunE,UAAD,IAAgB5B,EAAE,CAAC/P,EAAH,CAAMlpD,GAAN,MAAe,CAAf,IAAoBs3B,EAAE,GAAGif,EAAzC,IAAiD0iB,EAAE,CAAC/P,EAAH,CAAMlpD,GAAN,MAAe,CAAC,CAAhB,IAAqBs3B,EAAE,GAAGif,EAA/E,EAAoF;AACrF,uBAAO;AACH,uBAAK,CACD,CAACjf,EAAD,EAAKgiC,IAAL,CADC,EAED,CAAC/iB,EAAD,EAAK+iB,IAAL,CAFC,CADF;AAKH,uBAAK,CACD,CAACD,IAAD,EAAO/hC,EAAP,CADC,EAED,CAAC+hC,IAAD,EAAO9iB,EAAP,CAFC;AALF,kBASLjjD,IATK,CAAP;AAUH,eAXI,MAYA,IAAK2lE,EAAE,CAAC/P,EAAH,CAAMlpD,GAAN,MAAe,CAAf,IAAoBs3B,EAAE,GAAGif,EAA1B,IAAkC0iB,EAAE,CAAC/P,EAAH,CAAMlpD,GAAN,MAAe,CAAC,CAAhB,IAAqBs3B,EAAE,GAAGif,EAAhE,EAAqE;AACtE,uBAAO;AACH,uBAAK,CACD,CAAC8iB,IAAD,EAAOJ,EAAE,CAAC5P,EAAV,CADC,EAED,CAACgQ,IAAD,EAAOJ,EAAE,CAACntD,EAAV,CAFC,CADF;AAKH,uBAAK,CACD,CAACmtD,EAAE,CAAC7P,EAAJ,EAAQkQ,IAAR,CADC,EAED,CAACL,EAAE,CAACptD,EAAJ,EAAQytD,IAAR,CAFC;AALF,kBASLhmE,IATK,CAAP;AAUH;AACJ;AA5Ha,WADtB,CAjFqC,CAiNrC;;AACA,cAAIrD,CAAC,GAAGupE,eAAe,CAACvR,SAAS,CAACmC,iBAAX,CAAf,CAA6CnC,SAAS,CAACiC,UAAvD,EAAmE5yB,EAAnE,EAAuE6hC,GAAvE,EAA4E5iB,EAA5E,EAAgF6iB,GAAhF,CAAR;;AACA,cAAInpE,CAAJ,EAAO;AACH,iBAAK,IAAIzE,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGyE,CAAC,CAAC/E,MAAtB,EAA8BM,CAAC,EAA/B,EAAmC;AAC/Bi/D,wBAAU,CAACpI,QAAD,EAAWpyD,CAAC,CAACzE,CAAD,CAAD,CAAK,CAAL,CAAX,EAAoByE,CAAC,CAACzE,CAAD,CAAD,CAAK,CAAL,CAApB,EAA6By8D,SAA7B,CAAV;AACH;AACJ,WAvNoC,CAyNrC;;;AACAwC,oBAAU,CAACpI,QAAD,EAAW8H,KAAK,CAAC,CAAD,CAAhB,EAAqBA,KAAK,CAAC,CAAD,CAA1B,EAA+BlC,SAA/B,CAAV,CA1NqC,CA4NzC;AAEA;;AACAwC,oBAAU,CAACpI,QAAD,EAAW4F,SAAS,CAACp8C,EAArB,EAAyBo8C,SAAS,CAACn8C,EAAnC,EAAuCm8C,SAAvC,CAAV,CA/NyC,CAmOzC;;AACAqQ,uBAAa,CAAC,IAAD,EAAOjW,QAAP,EAAiB4F,SAAjB,CAAb;AAEH,SAtOD;AAuOH,OArVD;;AAuVApiB,SAAG,CAAChU,UAAJ,CAAe2lC,SAAf,GAA2BA,SAA3B;;AACA92C,SAAG,CAAC1G,MAAJ,CAAW6rB,GAAG,CAAChU,UAAJ,CAAe2lC,SAA1B,EAAqC3xB,GAAG,CAAChU,UAAJ,CAAey1B,iBAApD;AAEH,KAjWD,EAiWGtyD,IAjWH,CAiWQ,OAAOC,MAAP,KAAkB,WAAlB,GAAgCA,MAAhC,GAAyC,IAjWjD;AAmWA;;;;;;;;;;;AAUA;AACA,KAAC,YAAY;AAET;;AACA,UAAIxL,IAAI,GAAG,IAAX;AAAA,UAAiBo8C,GAAG,GAAGp8C,IAAI,CAACy3B,OAA5B;AAAA,UAAqCR,GAAG,GAAGj3B,IAAI,CAAC0tB,WAAhD;;AAEA0uB,SAAG,CAAChU,UAAJ,CAAempC,uBAAf,GAAyC,UAAS95D,MAAT,EAAiB;AACtDA,cAAM,GAAGA,MAAM,IAAI,EAAnB;;AACA,YAAI+5D,YAAY,GAAG/5D,MAAM,CAAC+5D,YAAP,KAAwB,KAA3C;AAAA,YACIC,SAAS,GAAGh6D,MAAM,CAACg6D,SAAP,IAAoB,EADpC;AAAA,YAEIjP,MAAM,GAAG/qD,MAAM,CAAC+qD,MAAP,IAAiB,CAF9B;AAAA,YAGIkP,cAAc,GAAGj6D,MAAM,CAACi6D,cAAP,IAAyB,EAH9C;AAAA,YAII7e,SAAS,GAAGp7C,MAAM,CAACk6B,WAAP,IAAsBl6B,MAAM,CAACk6B,WAAP,KAAuB,WAJ7D;AAAA,YAKI28B,cAAc,GAAG72D,MAAM,CAAC62D,cAAP,IAAyB,EAL9C;AAAA,YAMIC,mBAAmB,GAAG,KAN1B;AAAA,YAOIxU,MAPJ;;AASA,aAAKkD,QAAL,GAAgB,UAAUuB,SAAV,EAAqBh4D,CAArB,EAAwB;AAEpC,cAAImrE,EAAE,GAAGnrE,CAAC,CAACslD,SAAX;AAAA,cACI8lB,EAAE,GAAGprE,CAAC,CAACulD,SADX;AAAA,cAEI8lB,EAAE,GAAG5xE,IAAI,CAACuH,GAAL,CAASmqE,EAAE,CAAC,CAAD,CAAF,GAAQC,EAAE,CAAC,CAAD,CAAnB,CAFT;AAAA,cAGIE,EAAE,GAAG7xE,IAAI,CAACuH,GAAL,CAASmqE,EAAE,CAAC,CAAD,CAAF,GAAQC,EAAE,CAAC,CAAD,CAAnB,CAHT;;AAKA,cAAI,CAACJ,YAAD,IAAkBhrE,CAAC,CAACi8B,cAAF,CAAiBgD,SAAjB,KAA+Bj/B,CAAC,CAACk8B,cAAF,CAAiB+C,SAAtE,EAAkF;AAC9E8oC,+BAAmB,GAAG,KAAtB;;AACA,iBAAKwD,cAAL,CAAoBvT,SAApB,EAA+Bh4D,CAA/B,EAAkCmrE,EAAlC,EAAsCC,EAAtC,EAA0CC,EAA1C,EAA8CC,EAA9C;AACH,WAHD,MAGO;AACHvD,+BAAmB,GAAG,IAAtB,CADG,CAEH;;AACA,gBAAI3lE,EAAE,GAAGpC,CAAC,CAACslD,SAAF,CAAY,CAAZ,CAAT;AAAA,gBAAyBjjD,EAAE,GAAGrC,CAAC,CAACslD,SAAF,CAAY,CAAZ,IAAiB0W,MAA/C;AAAA,gBACI1L,EAAE,GAAGluD,EADT;AAAA,gBACamuD,EAAE,GAAGluD,EAAE,GAAGylE,cADvB;AAAA,gBAEA;AACI1nE,cAAE,GAAGkwD,EAAE,GAAGwX,cAHd;AAAA,gBAIIznE,EAAE,GAAGkwD,EAAE,GAAGuX,cAJd;;AAMAuD,cAAE,GAAG,IAAIvD,cAAT;AACAwD,cAAE,GAAG,IAAIxD,cAAT;AAEA9P,qBAAS,CAACrF,MAAV,CAAiB,CAAjB,IAAsBvyD,EAAtB;AACA43D,qBAAS,CAACrF,MAAV,CAAiB,CAAjB,IAAsBtyD,EAAtB;AACA23D,qBAAS,CAACrF,MAAV,CAAiB,CAAjB,IAAsB0Y,EAAtB;AACArT,qBAAS,CAACrF,MAAV,CAAiB,CAAjB,IAAsB2Y,EAAtB,CAfG,CAiBH;;AACA/X,kBAAM,CAACiH,UAAP,CAAkB,IAAlB,EAAwB,KAAxB,EAA+B;AAC3BgR,sBAAQ,EAAE,IADiB;AAE3BppE,gBAAE,EAAGA,EAAE,GAAGhC,EAAN,GAAY,CAFW;AAG3BiC,gBAAE,EAAEA,EAAE,GAAGhC,EAHkB;AAI3B80D,wBAAU,EAAE,CAJe;AAK3BC,sBAAQ,EAAE,IAAI37D,IAAI,CAACsK,EALQ;AAM3BrB,eAAC,EAAEolE,cANwB;AAO3BtS,gBAAE,EAAE,CAACnJ,SAPsB;AAQ3B/pD,gBAAE,EAAGF,EAAE,GAAGhC,EAAN,GAAY,CARW;AAS3BmC,gBAAE,EAAEF,EAAE,GAAGhC,EATkB;AAU3BiwD,gBAAE,EAAEA,EAAE,GAAGlwD,EAVkB;AAW3BmwD,gBAAE,EAAEA,EAAE,GAAGlwD;AAXkB,aAA/B;AAaH;AACJ,SA1CD;;AA4CAkzD,cAAM,GAAG3d,GAAG,CAAChU,UAAJ,CAAey1B,iBAAf,CAAiCz0D,KAAjC,CAAuC,IAAvC,EAA6C0F,SAA7C,CAAT;AACA,eAAOirD,MAAP;AACH,OAzDD;;AA0DA9iC,SAAG,CAAC1G,MAAJ,CAAW6rB,GAAG,CAAChU,UAAJ,CAAempC,uBAA1B,EAAmDn1B,GAAG,CAAChU,UAAJ,CAAey1B,iBAAlE;;AAEA,UAAIjB,MAAM,GAAG,SAATA,MAAS,CAAUnlD,MAAV,EAAkB;AAC3BA,cAAM,GAAGA,MAAM,IAAI,EAAnB;AACA,aAAKpD,IAAL,GAAY,QAAZ;;AAEA,YAAI0lD,MAAM,GAAG3d,GAAG,CAAChU,UAAJ,CAAempC,uBAAf,CAAuCnoE,KAAvC,CAA6C,IAA7C,EAAmD0F,SAAnD,CAAb;AAAA,YACImjE,WAAW,GAAGx6D,MAAM,CAACg6D,SAAP,IAAoB,GADtC;AAAA,YAEIS,WAAW,GAAG,EAFlB;;AAIA,aAAKC,YAAL,GAAoB,YAAY;AAC5B,iBAAOF,WAAP;AACH,SAFD;;AAIA,aAAKG,iBAAL,GAAyB,UAAUjxE,KAAV,EAAiBkxE,oBAAjB,EAAuCC,oBAAvC,EAA6D7vC,cAA7D,EAA6EC,cAA7E,EAA6F6vC,GAA7F,EAAkGC,GAAlG,EAAuG;AAC5H;AACA;AACA,cAAIjS,aAAa,GAAGgS,GAAG,CAAC,CAAD,CAAH,KAAWC,GAAG,CAAC,CAAD,CAAd,IAAqBD,GAAG,CAAC,CAAD,CAAH,KAAWC,GAAG,CAAC,CAAD,CAAvD;AAAA,cACIhsE,CAAC,GAAG,EADR;;AAGA,cAAI,CAAC+5D,aAAL,EAAoB;AAChB,gBAAIgS,GAAG,CAAC,CAAD,CAAH,KAAW,CAAf,EAAkB;AACd/rE,eAAC,CAACC,IAAF,CAAO4rE,oBAAoB,CAAC,CAAD,CAApB,GAA0BC,oBAAoB,CAAC,CAAD,CAA9C,GAAoDnxE,KAAK,CAAC,CAAD,CAAL,GAAW+wE,WAA/D,GAA6E/wE,KAAK,CAAC,CAAD,CAAL,GAAW+wE,WAA/F;AACH,aAFD,MAGK;AACD1rE,eAAC,CAACC,IAAF,CAAOtF,KAAK,CAAC,CAAD,CAAL,GAAY8wE,WAAW,GAAGM,GAAG,CAAC,CAAD,CAApC;AACH;;AAED,gBAAIA,GAAG,CAAC,CAAD,CAAH,KAAW,CAAf,EAAkB;AACd/rE,eAAC,CAACC,IAAF,CAAO4rE,oBAAoB,CAAC,CAAD,CAApB,GAA0BC,oBAAoB,CAAC,CAAD,CAA9C,GAAoDnxE,KAAK,CAAC,CAAD,CAAL,GAAW+wE,WAA/D,GAA6E/wE,KAAK,CAAC,CAAD,CAAL,GAAW+wE,WAA/F;AACH,aAFD,MAGK;AACD1rE,eAAC,CAACC,IAAF,CAAOtF,KAAK,CAAC,CAAD,CAAL,GAAY8wE,WAAW,GAAGO,GAAG,CAAC,CAAD,CAApC;AACH;AACJ,WAdD,MAeK;AACD,gBAAIA,GAAG,CAAC,CAAD,CAAH,KAAW,CAAf,EAAkB;AACdhsE,eAAC,CAACC,IAAF,CAAO6rE,oBAAoB,CAAC,CAAD,CAApB,GAA0BD,oBAAoB,CAAC,CAAD,CAA9C,GAAoDlxE,KAAK,CAAC,CAAD,CAAL,GAAW+wE,WAA/D,GAA6E/wE,KAAK,CAAC,CAAD,CAAL,GAAW+wE,WAA/F;AACH,aAFD,MAGK;AACD1rE,eAAC,CAACC,IAAF,CAAOtF,KAAK,CAAC,CAAD,CAAL,GAAY8wE,WAAW,GAAGO,GAAG,CAAC,CAAD,CAApC;AACH;;AAED,gBAAIA,GAAG,CAAC,CAAD,CAAH,KAAW,CAAf,EAAkB;AACdhsE,eAAC,CAACC,IAAF,CAAO6rE,oBAAoB,CAAC,CAAD,CAApB,GAA0BD,oBAAoB,CAAC,CAAD,CAA9C,GAAoDlxE,KAAK,CAAC,CAAD,CAAL,GAAW+wE,WAA/D,GAA6E/wE,KAAK,CAAC,CAAD,CAAL,GAAW+wE,WAA/F;AACH,aAFD,MAGK;AACD1rE,eAAC,CAACC,IAAF,CAAOtF,KAAK,CAAC,CAAD,CAAL,GAAY8wE,WAAW,GAAGM,GAAG,CAAC,CAAD,CAApC;AACH;AACJ;;AAED,iBAAO/rE,CAAP;AACH,SAtCD;;AAwCA,aAAKurE,cAAL,GAAsB,UAAUvT,SAAV,EAAqBh4D,CAArB,EAAwBmrE,EAAxB,EAA4BC,EAA5B,EAAgCC,EAAhC,EAAoCC,EAApC,EAAwC;AAE1D,cAAIW,GAAJ;AAAA,cAASC,IAAT;AAAA,cACIC,GAAG,GAAGhB,EAAE,CAAC,CAAD,CAAF,GAAQC,EAAE,CAAC,CAAD,CAAV,GAAgBC,EAAhB,GAAqB,CAD/B;AAAA,cAEIe,GAAG,GAAGjB,EAAE,CAAC,CAAD,CAAF,GAAQC,EAAE,CAAC,CAAD,CAAV,GAAgBE,EAAhB,GAAqB,CAF/B;AAAA,cAGIe,GAAG,GAAGlB,EAAE,CAAC,CAAD,CAAF,GAAQC,EAAE,CAAC,CAAD,CAAV,GAAgB,CAAhB,GAAoBC,EAH9B;AAAA,cAIIiB,GAAG,GAAGnB,EAAE,CAAC,CAAD,CAAF,GAAQC,EAAE,CAAC,CAAD,CAAV,GAAgB,CAAhB,GAAoBE,EAJ9B;;AAMAW,aAAG,GAAG,KAAKL,iBAAL,CAAuB,CAACO,GAAD,EAAMC,GAAN,CAAvB,EAAmCjB,EAAnC,EAAuCC,EAAvC,EAA2CprE,CAAC,CAACi8B,cAA7C,EAA6Dj8B,CAAC,CAACk8B,cAA/D,EAA+E87B,SAAS,CAACiB,EAAzF,EAA6FjB,SAAS,CAAClkB,EAAvG,CAAN;AACAo4B,cAAI,GAAG,KAAKN,iBAAL,CAAuB,CAACS,GAAD,EAAMC,GAAN,CAAvB,EAAmClB,EAAnC,EAAuCD,EAAvC,EAA2CnrE,CAAC,CAACk8B,cAA7C,EAA6Dl8B,CAAC,CAACi8B,cAA/D,EAA+E+7B,SAAS,CAAClkB,EAAzF,EAA6FkkB,SAAS,CAACiB,EAAvG,CAAP;;AAGA1F,gBAAM,CAACiH,UAAP,CAAkB,IAAlB,EAAwB,QAAxB,EAAkC;AAC9Bp4D,cAAE,EAAE+pE,GAD0B;AACrB9pE,cAAE,EAAE+pE,GADiB;AACZ9pE,cAAE,EAAE+pE,GADQ;AACH9pE,cAAE,EAAE+pE,GADD;AAE9BjW,gBAAI,EAAE4V,GAAG,CAAC,CAAD,CAFqB;AAEhB3V,gBAAI,EAAE2V,GAAG,CAAC,CAAD,CAFO;AAEF1V,gBAAI,EAAE2V,IAAI,CAAC,CAAD,CAFR;AAEa1V,gBAAI,EAAE0V,IAAI,CAAC,CAAD;AAFvB,WAAlC;AAIH,SAhBD;AAmBH,OAvED;;AAyEAt2B,SAAG,CAAChU,UAAJ,CAAew0B,MAAf,GAAwBA,MAAxB;;AACA3lC,SAAG,CAAC1G,MAAJ,CAAWqsC,MAAX,EAAmBxgB,GAAG,CAAChU,UAAJ,CAAempC,uBAAlC;AAEH,KA7ID,EA6IGhmE,IA7IH,CA6IQ,OAAOC,MAAP,KAAkB,WAAlB,GAAgCA,MAAhC,GAAyC,IA7IjD;AA+IA;;;;;;;;;;;AAUA;AACA,KAAC,YAAY;AAET;;AACA,UAAIxL,IAAI,GAAG,IAAX;AAAA,UAAiBo8C,GAAG,GAAGp8C,IAAI,CAACy3B,OAA5B;AAAA,UAAqCR,GAAG,GAAGj3B,IAAI,CAAC0tB,WAAhD;;AAEA,UAAIqlD,QAAQ,GAAG,SAAXA,QAAW,CAAUnqE,EAAV,EAAcC,EAAd,EAAkBC,EAAlB,EAAsBC,EAAtB,EAA0B;AACjC,YAAIH,EAAE,IAAIE,EAAN,IAAYC,EAAE,IAAIF,EAAtB,EAA0B;AACtB,iBAAO,CAAP;AACH,SAFD,MAGK,IAAID,EAAE,IAAIE,EAAN,IAAYD,EAAE,IAAIE,EAAtB,EAA0B;AAC3B,iBAAO,CAAP;AACH,SAFI,MAGA,IAAID,EAAE,IAAIF,EAAN,IAAYG,EAAE,IAAIF,EAAtB,EAA0B;AAC3B,iBAAO,CAAP;AACH;;AACD,eAAO,CAAP;AACH,OAXL;AAAA,UAaA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACIupE,uBAAiB,GAAG,SAApBA,iBAAoB,CAAUxC,IAAV,EAAgBC,IAAhB,EAAsBrU,OAAtB,EAA+BpG,UAA/B,EAA2CC,UAA3C,EAAuDltD,EAAvD,EAA2DD,EAA3D,EAA+D/F,QAA/D,EAAyEuvE,cAAzE,EAAyF;AACzG;AACA;AACA,YAAIvvE,QAAQ,IAAIuvE,cAAhB,EAAgC;AAC5B,iBAAO,CAAC9B,IAAD,EAAOC,IAAP,CAAP;AACH;;AAED,YAAIrU,OAAO,KAAK,CAAhB,EAAmB;AACf,cAAIpG,UAAU,CAAC,CAAD,CAAV,IAAiB,CAAjB,IAAsBC,UAAU,CAAC,CAAD,CAAV,IAAiB,CAA3C,EAA8C;AAC1C,mBAAO,CAAEua,IAAI,IAAIxa,UAAU,CAAC,CAAD,CAAV,GAAgB,GAAhB,GAAsB,CAAC,CAAD,GAAKjtD,EAA3B,GAAgCA,EAApC,CAAN,EAA+C0nE,IAA/C,CAAP;AACH,WAFD,MAGK,IAAIza,UAAU,CAAC,CAAD,CAAV,IAAiB,CAAjB,IAAsBC,UAAU,CAAC,CAAD,CAAV,IAAiB,CAA3C,EAA8C;AAC/C,mBAAO,CAAEua,IAAF,EAAQC,IAAI,IAAIza,UAAU,CAAC,CAAD,CAAV,GAAgB,GAAhB,GAAsB,CAAC,CAAD,GAAKltD,EAA3B,GAAgCA,EAApC,CAAZ,CAAP;AACH,WAFI,MAGA;AACD,mBAAO,CAAE0nE,IAAI,GAAI,CAAC,CAAD,GAAKznE,EAAf,EAAqB0nE,IAAI,GAAI,CAAC,CAAD,GAAK3nE,EAAlC,CAAP;AACH;AACJ,SAVD,MAWK,IAAIszD,OAAO,KAAK,CAAhB,EAAmB;AACpB,cAAIpG,UAAU,CAAC,CAAD,CAAV,IAAiB,CAAjB,IAAsBC,UAAU,CAAC,CAAD,CAAV,IAAiB,CAA3C,EAA8C;AAC1C,mBAAO,CAAEua,IAAI,IAAIxa,UAAU,CAAC,CAAD,CAAV,GAAgB,GAAhB,GAAsB,CAAC,CAAD,GAAKjtD,EAA3B,GAAgCA,EAApC,CAAN,EAA+C0nE,IAA/C,CAAP;AACH,WAFD,MAGK,IAAIza,UAAU,CAAC,CAAD,CAAV,IAAiB,CAAjB,IAAsBC,UAAU,CAAC,CAAD,CAAV,IAAiB,CAA3C,EAA8C;AAC/C,mBAAO,CAAEua,IAAF,EAAQC,IAAI,IAAIza,UAAU,CAAC,CAAD,CAAV,GAAgB,GAAhB,GAAsB,CAAC,CAAD,GAAKltD,EAA3B,GAAgCA,EAApC,CAAZ,CAAP;AACH,WAFI,MAGA;AACD,mBAAO,CAAE0nE,IAAI,GAAGznE,EAAT,EAAa0nE,IAAI,GAAI,CAAC,CAAD,GAAK3nE,EAA1B,CAAP;AACH;AACJ,SAVI,MAWA,IAAIszD,OAAO,KAAK,CAAhB,EAAmB;AACpB,cAAIpG,UAAU,CAAC,CAAD,CAAV,IAAiB,CAAjB,IAAsBC,UAAU,CAAC,CAAD,CAAV,IAAiB,CAA3C,EAA8C;AAC1C,mBAAO,CAAEua,IAAI,IAAIxa,UAAU,CAAC,CAAD,CAAV,GAAgB,GAAhB,GAAsB,CAAC,CAAD,GAAKjtD,EAA3B,GAAgCA,EAApC,CAAN,EAA+C0nE,IAA/C,CAAP;AACH,WAFD,MAGK,IAAIza,UAAU,CAAC,CAAD,CAAV,IAAiB,CAAjB,IAAsBC,UAAU,CAAC,CAAD,CAAV,IAAiB,CAA3C,EAA8C;AAC/C,mBAAO,CAAEua,IAAF,EAAQC,IAAI,IAAIza,UAAU,CAAC,CAAD,CAAV,GAAgB,GAAhB,GAAsB,CAAC,CAAD,GAAKltD,EAA3B,GAAgCA,EAApC,CAAZ,CAAP;AACH,WAFI,MAGA;AACD,mBAAO,CAAE0nE,IAAI,GAAI,CAAC,CAAD,GAAKznE,EAAf,EAAqB0nE,IAAI,GAAI,CAAC,CAAD,GAAK3nE,EAAlC,CAAP;AACH;AACJ,SAVI,MAWA,IAAIszD,OAAO,KAAK,CAAhB,EAAmB;AACpB,cAAIpG,UAAU,CAAC,CAAD,CAAV,IAAiB,CAAjB,IAAsBC,UAAU,CAAC,CAAD,CAAV,IAAiB,CAA3C,EAA8C;AAC1C,mBAAO,CAAEua,IAAI,IAAIxa,UAAU,CAAC,CAAD,CAAV,GAAgB,GAAhB,GAAsB,CAAC,CAAD,GAAKjtD,EAA3B,GAAgCA,EAApC,CAAN,EAA+C0nE,IAA/C,CAAP;AACH,WAFD,MAGK,IAAIza,UAAU,CAAC,CAAD,CAAV,IAAiB,CAAjB,IAAsBC,UAAU,CAAC,CAAD,CAAV,IAAiB,CAA3C,EAA8C;AAC/C,mBAAO,CAAEua,IAAF,EAAQC,IAAI,IAAIza,UAAU,CAAC,CAAD,CAAV,GAAgB,GAAhB,GAAsB,CAAC,CAAD,GAAKltD,EAA3B,GAAgCA,EAApC,CAAZ,CAAP;AACH,WAFI,MAGA;AACD,mBAAO,CAAE0nE,IAAI,GAAGznE,EAAT,EAAc0nE,IAAI,GAAI,CAAC,CAAD,GAAK3nE,EAA3B,CAAP;AACH;AACJ;AAEJ,OA/EL;;AAiFA,UAAI8qE,YAAY,GAAG,SAAfA,YAAe,CAAUv7D,MAAV,EAAkB;AACjCA,cAAM,GAAGA,MAAM,IAAI,EAAnB;AACA,aAAKpD,IAAL,GAAY,cAAZ;;AAEA,YAAI0lD,MAAM,GAAG3d,GAAG,CAAChU,UAAJ,CAAempC,uBAAf,CAAuCnoE,KAAvC,CAA6C,IAA7C,EAAmD0F,SAAnD,CAAb;AAAA,YACI2iE,SAAS,GAAGh6D,MAAM,CAACg6D,SAAP,IAAoB,EADpC;AAAA,YAEIjP,MAAM,GAAG/qD,MAAM,CAAC+qD,MAAP,IAAiB,CAF9B;AAAA,YAGIkP,cAAc,GAAGj6D,MAAM,CAACi6D,cAAP,IAAyB,EAH9C;AAAA,YAII7e,SAAS,GAAGp7C,MAAM,CAACk6B,WAAP,IAAsBl6B,MAAM,CAACk6B,WAAP,KAAuB,WAJ7D;AAAA,YAKIshC,aALJ;;AAOA,aAAKlB,cAAL,GAAsB,UAASvT,SAAT,EAAoB/mD,MAApB,EAA4Bk6D,EAA5B,EAAgCC,EAAhC,EAAoCtwE,CAApC,EAAuCmI,CAAvC,EAA0C;AAC5D,cAAIkpE,GAAG,GAAGl7D,MAAM,CAACq0C,SAAP,CAAiB,CAAjB,IAAsBr0C,MAAM,CAACs0C,SAAP,CAAiB,CAAjB,CAAtB,GAA4C,CAA5C,GAAgDzqD,CAA1D;AAAA,cACIsxE,GAAG,GAAGn7D,MAAM,CAACq0C,SAAP,CAAiB,CAAjB,IAAsBr0C,MAAM,CAACs0C,SAAP,CAAiB,CAAjB,CAAtB,GAA4C,CAA5C,GAAgDtiD,CAD1D;AAAA,cAEIopE,GAAG,GAAGp7D,MAAM,CAACq0C,SAAP,CAAiB,CAAjB,IAAsBr0C,MAAM,CAACs0C,SAAP,CAAiB,CAAjB,CAAtB,GAA4CzqD,CAA5C,GAAgD,CAF1D;AAAA,cAGIwxE,GAAG,GAAGr7D,MAAM,CAACq0C,SAAP,CAAiB,CAAjB,IAAsBr0C,MAAM,CAACs0C,SAAP,CAAiB,CAAjB,CAAtB,GAA4CtiD,CAA5C,GAAgD,CAH1D,CAD4D,CAM5D;;;AACA,cAAIgO,MAAM,CAACq0C,SAAP,CAAiB,CAAjB,MAAwB,CAA5B,EAA+B;AAC3B6mB,eAAG,IAAInQ,MAAP;AACH;;AACD,cAAI/qD,MAAM,CAACq0C,SAAP,CAAiB,CAAjB,MAAwB,CAA5B,EAA+B;AAC3B6mB,eAAG,IAAInQ,MAAP;AACH;;AACD,cAAI/qD,MAAM,CAACq0C,SAAP,CAAiB,CAAjB,MAAwB,CAA5B,EAA+B;AAC3B8mB,eAAG,IAAIpQ,MAAP;AACH;;AACD,cAAI/qD,MAAM,CAACq0C,SAAP,CAAiB,CAAjB,MAAwB,CAA5B,EAA+B;AAC3B8mB,eAAG,IAAIpQ,MAAP;AACH;;AACD,cAAI/qD,MAAM,CAACs0C,SAAP,CAAiB,CAAjB,MAAwB,CAA5B,EAA+B;AAC3B8mB,eAAG,IAAIrQ,MAAP;AACH;;AACD,cAAI/qD,MAAM,CAACs0C,SAAP,CAAiB,CAAjB,MAAwB,CAA5B,EAA+B;AAC3B8mB,eAAG,IAAIrQ,MAAP;AACH;;AACD,cAAI/qD,MAAM,CAACs0C,SAAP,CAAiB,CAAjB,MAAwB,CAA5B,EAA+B;AAC3B+mB,eAAG,IAAItQ,MAAP;AACH;;AACD,cAAI/qD,MAAM,CAACs0C,SAAP,CAAiB,CAAjB,MAAwB,CAA5B,EAA+B;AAC3B+mB,eAAG,IAAItQ,MAAP;AACH,WA9B2D,CAgC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAEA,cAAI0Q,KAAK,GAAG,CAACP,GAAG,GAAGE,GAAP,IAAc,CAA1B;AAAA,cACIM,KAAK,GAAG,CAACP,GAAG,GAAGE,GAAP,IAAc,CAD1B;AAAA,cAEItX,OAAO,GAAGuX,QAAQ,CAACJ,GAAD,EAAMC,GAAN,EAAWC,GAAX,EAAgBC,GAAhB,CAFtB;AAAA,cAGI3wE,QAAQ,GAAGlC,IAAI,CAACW,IAAL,CAAUX,IAAI,CAACgB,GAAL,CAAS4xE,GAAG,GAAGF,GAAf,EAAoB,CAApB,IAAyB1yE,IAAI,CAACgB,GAAL,CAAS6xE,GAAG,GAAGF,GAAf,EAAoB,CAApB,CAAnC,CAHf;AAAA,cAII/V,IAJJ;AAAA,cAIUE,IAJV;AAAA,cAIgBD,IAJhB;AAAA,cAIsBE,IAJtB,CApD4D,CA2D5D;AACA;;;AACAiW,uBAAa,GAAGb,iBAAiB,CAACc,KAAD,EAC7BC,KAD6B,EAE7B3X,OAF6B,EAG7B/jD,MAAM,CAACq0C,SAHsB,EAI7Br0C,MAAM,CAACs0C,SAJsB,EAK7B0lB,SAL6B,EAKlBA,SALkB,EAM7BtvE,QAN6B,EAO7BuvE,cAP6B,CAAjC;AASA7U,cAAI,GAAGoW,aAAa,CAAC,CAAD,CAApB;AACAlW,cAAI,GAAGkW,aAAa,CAAC,CAAD,CAApB;AACAnW,cAAI,GAAGmW,aAAa,CAAC,CAAD,CAApB;AACAjW,cAAI,GAAGiW,aAAa,CAAC,CAAD,CAApB;;AAEAlZ,gBAAM,CAACiH,UAAP,CAAkB,IAAlB,EAAwB,QAAxB,EAAkC;AAC9Bp4D,cAAE,EAAEiqE,GAD0B;AACrBhqE,cAAE,EAAEiqE,GADiB;AACZhqE,cAAE,EAAE6pE,GADQ;AACH5pE,cAAE,EAAE6pE,GADD;AAE9B/V,gBAAI,EAAEA,IAFwB;AAElBC,gBAAI,EAAEA,IAFY;AAG9BC,gBAAI,EAAEA,IAHwB;AAGlBC,gBAAI,EAAEA;AAHY,WAAlC;AAKH,SAhFD;AAiFH,OA5FD;;AA8FA5gB,SAAG,CAAChU,UAAJ,CAAe4qC,YAAf,GAA8BA,YAA9B;;AACA/7C,SAAG,CAAC1G,MAAJ,CAAWyiD,YAAX,EAAyB52B,GAAG,CAAChU,UAAJ,CAAempC,uBAAxC;AAEH,KAvLD,EAuLGhmE,IAvLH,CAuLQ,OAAOC,MAAP,KAAkB,WAAlB,GAAgCA,MAAhC,GAAyC,IAvLjD;AAyLA;;;;;;;;;;;AAUA;AACA,KAAC,YAAY;AAET;;AACA,UAAIxL,IAAI,GAAG,IAAX;AAAA,UAAiBo8C,GAAG,GAAGp8C,IAAI,CAACy3B,OAA5B;AAAA,UAAqCR,GAAG,GAAGj3B,IAAI,CAAC0tB,WAAhD;AACA,UAAImgD,QAAQ,GAAG,UAAf;;AAEA,UAAI/T,QAAQ,GAAG,SAAXA,QAAW,CAAUriD,MAAV,EAAkB;AAC7B,aAAKpD,IAAL,GAAYw5D,QAAZ;;AACA,YAAI9T,MAAM,GAAG3d,GAAG,CAAChU,UAAJ,CAAey1B,iBAAf,CAAiCz0D,KAAjC,CAAuC,IAAvC,EAA6C0F,SAA7C,CAAb;;AAEA,aAAKmuD,QAAL,GAAgB,UAAUuB,SAAV,EAAqBlE,CAArB,EAAwB;AACpCP,gBAAM,CAACiH,UAAP,CAAkB,IAAlB,EAAwB6M,QAAxB,EAAkC;AAACjlE,cAAE,EAAE41D,SAAS,CAACmB,EAAf;AAAmB92D,cAAE,EAAE21D,SAAS,CAACoB,EAAjC;AAAqC92D,cAAE,EAAE01D,SAAS,CAACwB,UAAnD;AAA+Dj3D,cAAE,EAAEy1D,SAAS,CAACyB;AAA7E,WAAlC;;AACAlG,gBAAM,CAACiH,UAAP,CAAkB,IAAlB,EAAwB6M,QAAxB,EAAkC;AAACjlE,cAAE,EAAE41D,SAAS,CAACwB,UAAf;AAA2Bn3D,cAAE,EAAE21D,SAAS,CAACyB,UAAzC;AAAqDn3D,cAAE,EAAE01D,SAAS,CAAC0B,QAAnE;AAA6En3D,cAAE,EAAEy1D,SAAS,CAAC2B;AAA3F,WAAlC;;AACApG,gBAAM,CAACiH,UAAP,CAAkB,IAAlB,EAAwB6M,QAAxB,EAAkC;AAACjlE,cAAE,EAAE41D,SAAS,CAAC0B,QAAf;AAAyBr3D,cAAE,EAAE21D,SAAS,CAAC2B,QAAvC;AAAiDr3D,cAAE,EAAE01D,SAAS,CAACp8C,EAA/D;AAAmErZ,cAAE,EAAEy1D,SAAS,CAACn8C;AAAjF,WAAlC;AACH,SAJD;AAKH,OATD;;AAWA+5B,SAAG,CAAChU,UAAJ,CAAe0xB,QAAf,GAA0BA,QAA1B;;AACA7iC,SAAG,CAAC1G,MAAJ,CAAWupC,QAAX,EAAqB1d,GAAG,CAAChU,UAAJ,CAAey1B,iBAApC;AAEH,KApBD,EAoBGtyD,IApBH,CAoBQ,OAAOC,MAAP,KAAkB,WAAlB,GAAgCA,MAAhC,GAAyC,IApBjD;AAsBA;;;;;;;;;;;AAUA;AACA,KAAC,YAAY;AAEb;AAEI;;AACA,UAAIxL,IAAI,GAAG,IAAX;AAAA,UAAiBo8C,GAAG,GAAGp8C,IAAI,CAACy3B,OAA5B;AAAA,UAAqCR,GAAG,GAAGj3B,IAAI,CAAC0tB,WAAhD;;AAEA,UAAI0lD,eAAe,GAAG;AACd,2BAAmB,iBADL;AAEd,6BAAqB,mBAFP;AAGd,0BAAkB;AAHJ,OAAtB;AAAA,UAKIC,gBAAgB,GAAG,kBALvB;AAAA,UAMIC,SAAS,GAAG,WANhB;AAAA,UAOIC,eAAe,GAAG,gBAPtB;AAAA,UAQIC,eAAe,GAAG,gBARtB;AAAA,UASIC,IAAI,GAAG,MATX;AAAA,UAUIC,IAAI,GAAG,MAVX;AAAA,UAWI7M,IAAI,GAAG,MAXX;AAAA,UAYI8M,MAAM,GAAG,QAZb;AAAA,UAaIC,YAAY,GAAG,cAbnB;AAAA,UAcIC,KAAK,GAAG,OAdZ;AAAA,UAeIC,IAAI,GAAG,MAfX;AAAA,UAgBIC,gBAAgB,GAAG,mBAhBvB;AAAA,UAiBIC,UAAU,GAAG,aAjBjB;AAAA,UAkBIC,EAAE,GAAG;AACDC,WAAG,EAAE;AADJ,OAlBT;AAAA,UAqBIC,KAAK,GAAG,SAARA,KAAQ,CAAUC,IAAV,EAAgBC,UAAhB,EAA4B;AAChC,aAAK,IAAItyE,CAAT,IAAcsyE,UAAd,EAA0B;AACtBD,cAAI,CAAChiE,YAAL,CAAkBrQ,CAAlB,EAAqB,KAAKsyE,UAAU,CAACtyE,CAAD,CAApC;AACH;AACJ,OAzBL;AAAA,UA0BIuyE,KAAK,GAAG,SAARA,KAAQ,CAAUtnD,IAAV,EAAgBqnD,UAAhB,EAA4B;AAChCA,kBAAU,GAAGA,UAAU,IAAI,EAA3B;AACAA,kBAAU,CAAChpE,OAAX,GAAqB,KAArB;AACAgpE,kBAAU,CAACE,KAAX,GAAmBN,EAAE,CAACC,GAAtB;AACA,eAAO93B,GAAG,CAACo4B,eAAJ,CAAoBP,EAAE,CAACC,GAAvB,EAA4BlnD,IAA5B,EAAkC,IAAlC,EAAwC,IAAxC,EAA8CqnD,UAA9C,CAAP;AACH,OA/BL;AAAA,UAgCII,IAAI,GAAG,SAAPA,IAAO,CAAUlyE,CAAV,EAAa;AAChB,eAAO,4BAA4BA,CAAC,CAAC,CAAD,CAA7B,GAAmC,SAAnC,GAA+CA,CAAC,CAAC,CAAD,CAAhD,GAAsD,IAA7D;AACH,OAlCL;AAAA,UAmCImyE,cAAc,GAAG,SAAjBA,cAAiB,CAAU1vD,MAAV,EAAkB;AAC/B,YAAIqnD,GAAG,GAAGrnD,MAAM,CAACxV,gBAAP,CAAwB,qCAAxB,CAAV;;AACA,aAAK,IAAIzN,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGsqE,GAAG,CAAC5qE,MAAxB,EAAgCM,CAAC,EAAjC,EAAqC;AACjCsqE,aAAG,CAACtqE,CAAD,CAAH,CAAOuN,UAAP,CAAkB0I,WAAlB,CAA8Bq0D,GAAG,CAACtqE,CAAD,CAAjC;AACH;AACJ,OAxCL;AAAA,UAyCI4yE,eAAe,GAAG,SAAlBA,eAAkB,CAAU3vD,MAAV,EAAkBovD,IAAlB,EAAwBtvD,KAAxB,EAA+Bw+B,UAA/B,EAA2CsxB,WAA3C,EAAwD;AACtE,YAAI9nD,EAAE,GAAGinD,gBAAgB,GAAGa,WAAW,CAACv9C,QAAZ,CAAqBtC,QAArB,CAA8Bqb,OAA9B,EAA5B,CADsE,CAEtE;;;AACAskC,sBAAc,CAAC1vD,MAAD,CAAd,CAHsE,CAItE;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA,YAAIjU,CAAJ;;AACA,YAAI,CAAC+T,KAAK,CAAC7Y,QAAN,CAAe41B,MAApB,EAA4B;AACxB9wB,WAAC,GAAGujE,KAAK,CAACf,eAAD,EAAkB;AAACzmD,cAAE,EAAEA,EAAL;AAAS+nD,yBAAa,EAAE;AAAxB,WAAlB,CAAT;AACH,SAFD,MAGK;AACD9jE,WAAC,GAAGujE,KAAK,CAACd,eAAD,EAAkB;AAAE1mD,cAAE,EAAEA;AAAN,WAAlB,CAAT;AACH;;AAED,YAAI0W,IAAI,GAAG8wC,KAAK,CAACb,IAAD,CAAhB;;AACAzuD,cAAM,CAACC,WAAP,CAAmBue,IAAnB;AACAA,YAAI,CAACve,WAAL,CAAiBlU,CAAjB,EArBsE,CAuBtE;AACA;AACA;;AACA,aAAK,IAAIhP,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG+iB,KAAK,CAAC7Y,QAAN,CAAe6oE,KAAf,CAAqBrzE,MAAzC,EAAiDM,CAAC,EAAlD,EAAsD;AAClD,cAAIgzE,UAAU,GAAGH,WAAW,CAACpZ,OAAZ,KAAwB,CAAxB,IAA6BoZ,WAAW,CAACpZ,OAAZ,KAAwB,CAArD,GAAyDz5D,CAAzD,GAA6D+iB,KAAK,CAAC7Y,QAAN,CAAe6oE,KAAf,CAAqBrzE,MAArB,GAA8B,CAA9B,GAAkCM,CAAhH;AAAA,cACIizE,SAAS,GAAGlwD,KAAK,CAAC7Y,QAAN,CAAe6oE,KAAf,CAAqBC,UAArB,EAAiC,CAAjC,CADhB;AAAA,cAEIj0E,CAAC,GAAGwzE,KAAK,CAACzN,IAAD,EAAO;AAAC,sBAAU5mE,IAAI,CAACyhB,KAAL,CAAWoD,KAAK,CAAC7Y,QAAN,CAAe6oE,KAAf,CAAqB/yE,CAArB,EAAwB,CAAxB,IAA6B,GAAxC,IAA+C,GAA1D;AAA+D,0BAAcizE;AAA7E,WAAP,CAFb;;AAIAjkE,WAAC,CAACkU,WAAF,CAAcnkB,CAAd;AACH;;AACD,YAAIm0E,eAAe,GAAGnwD,KAAK,CAACwZ,MAAN,GAAeq1C,MAAf,GAAwBD,IAA9C;AACAU,YAAI,CAAChiE,YAAL,CAAkB6iE,eAAlB,EAAmC,UAAUnoD,EAAV,GAAe,GAAlD;AACH,OA5EL;AAAA,UA6EIooD,YAAY,GAAG,SAAfA,YAAe,CAAUlwD,MAAV,EAAkBovD,IAAlB,EAAwBtvD,KAAxB,EAA+Bw+B,UAA/B,EAA2CsxB,WAA3C,EAAwD;AAEnER,YAAI,CAAChiE,YAAL,CAAkBshE,IAAlB,EAAwB5uD,KAAK,CAAC4S,IAAN,GAAa5S,KAAK,CAAC4S,IAAnB,GAA0Bo8C,IAAlD;AACAM,YAAI,CAAChiE,YAAL,CAAkBuhE,MAAlB,EAA0B7uD,KAAK,CAACwZ,MAAN,GAAexZ,KAAK,CAACwZ,MAArB,GAA8Bw1C,IAAxD;;AAEA,YAAIhvD,KAAK,CAAC7Y,QAAV,EAAoB;AAChB0oE,yBAAe,CAAC3vD,MAAD,EAASovD,IAAT,EAAetvD,KAAf,EAAsBw+B,UAAtB,EAAkCsxB,WAAlC,CAAf;AACH,SAFD,MAGK;AACD;AACAF,wBAAc,CAAC1vD,MAAD,CAAd;;AACAovD,cAAI,CAAChiE,YAAL,CAAkByhE,KAAlB,EAAyB,EAAzB;AACH;;AAED,YAAI/uD,KAAK,CAAConC,WAAV,EAAuB;AACnBkoB,cAAI,CAAChiE,YAAL,CAAkBwhE,YAAlB,EAAgC9uD,KAAK,CAAConC,WAAtC;AACH,SAhBkE,CAkBnE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA,YAAIpnC,KAAK,CAACwuD,SAAD,CAAL,IAAoBxuD,KAAK,CAACkvD,UAAD,CAAzB,IAAyC,CAAClvD,KAAK,CAACuuD,gBAAD,CAAnD,EAAuE;AACnE,cAAIjpC,GAAG,GAAGtlB,KAAK,CAACwuD,SAAD,CAAL,CAAiBhjE,OAAjB,CAAyB,GAAzB,MAAkC,CAAC,CAAnC,GAAuC,GAAvC,GAA6C,GAAvD;AAAA,cACI6kE,KAAK,GAAGrwD,KAAK,CAACwuD,SAAD,CAAL,CAAiB7hE,KAAjB,CAAuB24B,GAAvB,CADZ;AAAA,cAEI2qC,UAAU,GAAG,EAFjB;AAGAI,eAAK,CAACC,OAAN,CAAc,UAAU5uE,CAAV,EAAa;AACvBuuE,sBAAU,IAAK90E,IAAI,CAACyhB,KAAL,CAAWlb,CAAC,GAAGse,KAAK,CAAConC,WAArB,IAAoC9hB,GAAnD;AACH,WAFD;AAGAgqC,cAAI,CAAChiE,YAAL,CAAkBihE,gBAAlB,EAAoC0B,UAApC;AACH,SARD,MASK,IAAIjwD,KAAK,CAACuuD,gBAAD,CAAT,EAA6B;AAC9Be,cAAI,CAAChiE,YAAL,CAAkBihE,gBAAlB,EAAoCvuD,KAAK,CAACuuD,gBAAD,CAAzC;AACH,SArCkE,CAuCnE;;;AACA,aAAK,IAAItxE,CAAT,IAAcqxE,eAAd,EAA+B;AAC3B,cAAItuD,KAAK,CAAC/iB,CAAD,CAAT,EAAc;AACVqyE,gBAAI,CAAChiE,YAAL,CAAkBghE,eAAe,CAACrxE,CAAD,CAAjC,EAAsC+iB,KAAK,CAAC/iB,CAAD,CAA3C;AACH;AACJ;AACJ,OA1HL;AAAA,UA2HIszE,cAAc,GAAG,SAAjBA,cAAiB,CAAUnB,GAAV,EAAe9jE,IAAf,EAAqBmG,GAArB,EAA0B;AACvC,YAAI29D,GAAG,CAACt8B,UAAJ,CAAen2C,MAAf,GAAwB8U,GAA5B,EAAiC;AAC7B29D,aAAG,CAACoB,YAAJ,CAAiBllE,IAAjB,EAAuB8jE,GAAG,CAACt8B,UAAJ,CAAerhC,GAAf,CAAvB;AACH,SAFD,MAGK;AACD29D,aAAG,CAACjvD,WAAJ,CAAgB7U,IAAhB;AACH;AACJ,OAlIL;AAoIA;;;;;AAGA6mB,SAAG,CAACi9C,GAAJ,GAAU;AACNE,YAAI,EAAEE,KADA;AAENiB,YAAI,EAAEpB,KAFA;AAGN/yD,WAAG,EAAEqzD;AAHC,OAAV,CA9IS,CAoJT;;AAEA;;;;AAGA,UAAIe,YAAY,GAAG,SAAfA,YAAe,CAAU/9D,MAAV,EAAkB;AACjC,YAAIg+D,iBAAiB,GAAGh+D,MAAM,CAACg+D,iBAAP,IAA4B,KAApD;AAAA,YAA2DC,QAAQ,GAAG,EAAtE;;AAEAt5B,WAAG,CAACtjB,kBAAJ,CAAuB1vB,KAAvB,CAA6B,IAA7B,EAAmCqO,MAAM,CAACk+D,YAA1C;;AACA,aAAK36C,MAAL,GAAc,IAAd;AACA,aAAK5qB,IAAL,GAAY,IAAZ;AACA,aAAK8jE,GAAL,GAAW,IAAX;AACA,aAAK31B,QAAL,GAAgB,IAAhB;AAEA,YAAIjjB,KAAK,GAAG7jB,MAAM,CAACsjB,QAAP,GAAkB,GAAlB,IAAyBtjB,MAAM,CAACk+D,YAAP,CAAoB,CAApB,EAAuB56C,QAAvB,IAAmC,EAA5D,CAAZ;AAAA,YACI66C,SAAS,GAAG;AACR,mBAAS,EADD;AAER,mBAAS,CAFD;AAGR,oBAAU,CAHF;AAIR,4BAAkBH,iBAJV;AAKR,sBAAY;AALJ,SADhB;AASA,aAAKvB,GAAL,GAAWI,KAAK,CAAC,KAAD,EAAQsB,SAAR,CAAhB;;AAEA,YAAIn+D,MAAM,CAACo+D,aAAX,EAA0B;AACtB,eAAK76C,MAAL,GAAcohB,GAAG,CAAC0D,aAAJ,CAAkB,KAAlB,EAAyB;AAAE/6B,oBAAQ,EAAG;AAAb,WAAzB,CAAd;;AACAkS,aAAG,CAAC9C,WAAJ,CAAgB,KAAK6G,MAArB,EAA6B,CAA7B,EAAgC,CAAhC,EAAmC,CAAnC,EAAsC,CAAtC;;AACA,eAAKA,MAAL,CAAY86C,SAAZ,GAAwBx6C,KAAxB;AACH,SAJD,MAKK;AACD64C,eAAK,CAAC,KAAKD,GAAN,EAAW;AAAE,qBAAS54C;AAAX,WAAX,CAAL;;AACA,eAAKN,MAAL,GAAc,KAAKk5C,GAAnB;AACH;;AAEDz8D,cAAM,CAAC4f,QAAP,CAAgB2Y,aAAhB,CAA8B,KAAKhV,MAAnC,EAA2CvjB,MAAM,CAACk+D,YAAP,CAAoB,CAApB,EAAuB3wD,MAAlE;;AACA,YAAIvN,MAAM,CAACo+D,aAAX,EAA0B;AACtB,eAAK76C,MAAL,CAAY/V,WAAZ,CAAwB,KAAKivD,GAA7B;AACH;;AAED,YAAIxS,eAAe,GAAG,CAAE,KAAK1mC,MAAP,CAAtB;;AACA,aAAK2mC,kBAAL,GAA0B,YAAY;AAClC,iBAAOD,eAAP;AACH,SAFD;;AAIA,aAAKE,oBAAL,GAA4B,UAAUzyD,EAAV,EAAc;AACtCuyD,yBAAe,CAACj7D,IAAhB,CAAqB0I,EAArB;AACH,SAFD;;AAIA,aAAKw5B,KAAL,GAAa,UAAU7jB,KAAV,EAAiBoR,MAAjB,EAAyBi2B,OAAzB,EAAkC;AAC3C,cAAIrnC,KAAK,IAAI,IAAb,EAAmB;AAEf,gBAAIgkB,EAAE,GAAG,CAAE,KAAK3oC,CAAP,EAAU,KAAKK,CAAf,CAAT;AAAA,gBAA6BuoC,EAAE,GAAG,CAAE,KAAKznC,CAAP,EAAU,KAAKmI,CAAf,CAAlC;AAAA,gBAAsDjD,CAAtD;;AACA,gBAAI2lD,OAAO,IAAI,IAAf,EAAqB;AACjB,kBAAIA,OAAO,CAACC,IAAR,GAAe,CAAnB,EAAsB;AAClBtjB,kBAAE,CAAC,CAAD,CAAF,IAASqjB,OAAO,CAACC,IAAjB;AACH;;AACD,kBAAID,OAAO,CAACI,IAAR,GAAe,CAAnB,EAAsB;AAClBzjB,kBAAE,CAAC,CAAD,CAAF,IAASqjB,OAAO,CAACI,IAAjB;AACH;;AACDxjB,gBAAE,CAAC,CAAD,CAAF,GAAQojB,OAAO,CAACM,IAAR,IAAiBN,OAAO,CAACC,IAAR,GAAe,CAAhB,GAAqB,CAACD,OAAO,CAACC,IAA9B,GAAqC,CAArD,CAAR;AACArjB,gBAAE,CAAC,CAAD,CAAF,GAAQojB,OAAO,CAACQ,IAAR,IAAiBR,OAAO,CAACI,IAAR,GAAe,CAAhB,GAAqB,CAACJ,OAAO,CAACI,IAA9B,GAAqC,CAArD,CAAR;AACH;;AAED,gBAAI90C,MAAM,CAACo+D,aAAX,EAA0B;AACtB5+C,iBAAG,CAAC9C,WAAJ,CAAgB,KAAK6G,MAArB,EAA6B8N,EAAE,CAAC,CAAD,CAA/B,EAAoCA,EAAE,CAAC,CAAD,CAAtC,EAA2CC,EAAE,CAAC,CAAD,CAAF,GAAQ,CAAR,GAAYA,EAAE,CAAC,CAAD,CAAd,GAAoB,CAA/D,EAAkEA,EAAE,CAAC,CAAD,CAAF,GAAQ,CAAR,GAAYA,EAAE,CAAC,CAAD,CAAd,GAAoB,CAAtF;;AACAD,gBAAE,CAAC,CAAD,CAAF,GAAQ,CAAR;AACAA,gBAAE,CAAC,CAAD,CAAF,GAAQ,CAAR;AACAtiC,eAAC,GAAGiuE,IAAI,CAAC,CAAE,CAAF,EAAK,CAAL,CAAD,CAAR;AACH,aALD,MAMK;AACDjuE,eAAC,GAAGiuE,IAAI,CAAC,CAAE3rC,EAAE,CAAC,CAAD,CAAJ,EAASA,EAAE,CAAC,CAAD,CAAX,CAAD,CAAR;AACH;;AAED4sC,oBAAQ,CAAC/sC,KAAT,CAAev/B,KAAf,CAAqB,IAArB,EAA2B0F,SAA3B;;AAEAqlE,iBAAK,CAAC,KAAKD,GAAN,EAAW;AACZ,uBAAS1tE,CADG;AAEZ,uBAASuiC,EAAE,CAAC,CAAD,CAAF,IAAS,CAFN;AAGZ,wBAAUA,EAAE,CAAC,CAAD,CAAF,IAAS;AAHP,aAAX,CAAL;AAKH;AACJ,SAjCD;;AAmCA,eAAO;AACH2sC,kBAAQ,EAAEA;AADP,SAAP;AAGH,OAlFD;;AAoFAz+C,SAAG,CAAC1G,MAAJ,CAAWilD,YAAX,EAAyBp5B,GAAG,CAACtjB,kBAA7B,EAAiD;AAC7CuT,eAAO,EAAE,iBAAUrlB,KAAV,EAAiB;AACtB,cAAIA,KAAK,IAAI,KAAKmR,MAAL,IAAe,IAA5B,EAAkC;AAC9B,gBAAI,KAAK6C,MAAT,EAAiB;AACb,mBAAKA,MAAL,CAAY3D,QAAZ,GAAuB,IAAvB;AACH;;AACD,gBAAI,KAAK68C,GAAT,EAAc;AACV,mBAAKA,GAAL,CAAS78C,QAAT,GAAoB,IAApB;AACH;;AACD,gBAAI,KAAKknB,QAAT,EAAmB;AACf,mBAAKA,QAAL,CAAclnB,QAAd,GAAyB,IAAzB;AACH;;AAED,gBAAI,KAAK2D,MAAL,IAAe,KAAKA,MAAL,CAAY1rB,UAA/B,EAA2C;AACvC,mBAAK0rB,MAAL,CAAY1rB,UAAZ,CAAuB0I,WAAvB,CAAmC,KAAKgjB,MAAxC;AACH;;AACD,gBAAI,KAAKujB,QAAL,IAAiB,KAAKA,QAAL,CAAcjvC,UAAnC,EAA+C;AAC3C,mBAAK0rB,MAAL,CAAY1rB,UAAZ,CAAuB0I,WAAvB,CAAmC,KAAKgjB,MAAxC;AACH;;AAED,iBAAKk5C,GAAL,GAAW,IAAX;AACA,iBAAKl5C,MAAL,GAAc,IAAd;AACA,iBAAK5qB,IAAL,GAAY,IAAZ;AACA,iBAAKq4D,KAAL,GAAa,IAAb;AACH,WAtBD,MAuBK;AACD;AACA,gBAAI,KAAKztC,MAAL,IAAe,KAAKA,MAAL,CAAY1rB,UAA/B,EAA2C;AACvC,mBAAK0rB,MAAL,CAAY1rB,UAAZ,CAAuB0I,WAAvB,CAAmC,KAAKgjB,MAAxC;AACH;;AACD,gBAAI,KAAKujB,QAAL,IAAiB,KAAKA,QAAL,CAAcjvC,UAAnC,EAA+C;AAC3C,mBAAKivC,QAAL,CAAcjvC,UAAd,CAAyB0I,WAAzB,CAAqC,KAAKumC,QAA1C;AACH;AACJ;AACJ,SAlC4C;AAmC7ClB,gBAAQ,EAAC,kBAAStoB,QAAT,EAAmB;AACxB,cAAIzyB,CAAC,GAAGyyB,QAAQ,CAACiB,YAAT,EAAR;;AACA,cAAI,KAAKgF,MAAL,IAAe,KAAKA,MAAL,CAAY1rB,UAAZ,IAA0B,IAA7C,EAAmD;AAC/ChN,aAAC,CAAC2iB,WAAF,CAAc,KAAK+V,MAAnB;AACH;;AACD,cAAI,KAAKujB,QAAL,IAAiB,KAAKA,QAAL,CAAcjvC,UAAd,IAA4B,IAAjD,EAAuD;AACnDhN,aAAC,CAAC2iB,WAAF,CAAc,KAAKs5B,QAAnB;AACH;AACJ,SA3C4C;AA4C7ChY,kBAAU,EAAE,oBAAU5lC,CAAV,EAAa;AACrB,cAAI,KAAKq6B,MAAT,EAAiB;AACb,iBAAKA,MAAL,CAAYlW,KAAZ,CAAkB+hC,OAAlB,GAA4BlmD,CAAC,GAAG,OAAH,GAAa,MAA1C;AACH;AACJ;AAhD4C,OAAjD;AAmDA;;;;;AAGAy7C,SAAG,CAAC/T,kBAAJ,CAAuB6rC,GAAvB,GAA6B,UAAUz8D,MAAV,EAAkB;AAC3C,YAAIshB,IAAI,GAAG,IAAX;AAAA,YACIghC,MAAM,GAAGyb,YAAY,CAACpsE,KAAb,CAAmB,IAAnB,EAAyB,CAC9B;AACI2xB,kBAAQ,EAAEtjB,MAAM,CAAC4f,QAAP,CAAgB8P,cAD9B;AAEIwuC,sBAAY,EAAE7mE,SAFlB;AAGI2mE,2BAAiB,EAAE,MAHvB;AAIIp+C,kBAAQ,EAAE5f,MAAM,CAAC4f;AAJrB,SAD8B,CAAzB,CADb;;AAUA0iC,cAAM,CAAC2b,QAAP,CAAgB/sC,KAAhB,GAAwB,UAAU7jB,KAAV,EAAiBoR,MAAjB,EAAyBi2B,OAAzB,EAAkC;AAEtD,cAAIyM,QAAQ,GAAG7/B,IAAI,CAAC6nC,WAAL,EAAf;AAAA,cAAmCp6D,CAAC,GAAG,EAAvC;AAAA,cAA2Cq7B,MAAM,GAAG,CAAC,CAAD,EAAI,CAAJ,CAApD;;AACA,cAAIsqB,OAAO,CAACC,IAAR,GAAe,CAAnB,EAAsB;AAClBvqB,kBAAM,CAAC,CAAD,CAAN,GAAY,CAACsqB,OAAO,CAACC,IAArB;AACH;;AACD,cAAID,OAAO,CAACI,IAAR,GAAe,CAAnB,EAAsB;AAClB1qB,kBAAM,CAAC,CAAD,CAAN,GAAY,CAACsqB,OAAO,CAACI,IAArB;AACH;;AAED,cAAIqM,QAAQ,CAACn3D,MAAT,GAAkB,CAAtB,EAAyB;AAErB+E,aAAC,GAAGuyB,IAAI,CAAC0lC,WAAL,EAAJ;AAEA,gBAAIl6D,CAAC,GAAG;AACAhC,eAAC,EAAEiE,CADH;AAEAy+D,uBAAS,EAAE,eAAepjC,MAAM,CAAC,CAAD,CAArB,GAA2B,GAA3B,GAAiCA,MAAM,CAAC,CAAD,CAAvC,GAA6C,GAFxD;AAGA,gCAAkBpqB,MAAM,CAAC,gBAAD,CAAN,IAA4B;AAH9C,aAAR;AAAA,gBAKIs+D,YAAY,GAAG,IALnB;AAAA,gBAMIxzE,CAAC,GAAG,CAACw2B,IAAI,CAAC54B,CAAN,EAAS44B,IAAI,CAACv4B,CAAd,EAAiBu4B,IAAI,CAACz3B,CAAtB,EAAyBy3B,IAAI,CAACtvB,CAA9B,CANR,CAJqB,CAYrB;;AACA,gBAAIqb,KAAK,CAACioC,aAAV,EAAyB;AACrB,kBAAIC,YAAY,GAAGloC,KAAK,CAACkoC,YAAN,IAAsB,CAAzC;AAAA,kBACIgpB,kBAAkB,GAAGlxD,KAAK,CAAConC,WAAN,GAAqB,IAAIc,YADlD;AAEA+oB,0BAAY,GAAG35B,GAAG,CAAC7rB,MAAJ,CAAW,EAAX,EAAezL,KAAf,CAAf;AACA,qBAAOixD,YAAY,CAAC9pE,QAApB;AACA8pE,0BAAY,CAACz3C,MAAb,GAAsBxZ,KAAK,CAACioC,aAA5B;AACAgpB,0BAAY,CAAC7pB,WAAb,GAA2B8pB,kBAA3B;;AAEA,kBAAIj9C,IAAI,CAACk9C,MAAL,IAAe,IAAnB,EAAyB;AACrBl9C,oBAAI,CAACk9C,MAAL,GAAc3B,KAAK,CAAC,MAAD,EAAS/vE,CAAT,CAAnB;;AACA63C,mBAAG,CAACz9B,QAAJ,CAAaoa,IAAI,CAACk9C,MAAlB,EAA0B75B,GAAG,CAAChV,qBAA9B;;AACAiuC,8BAAc,CAACt8C,IAAI,CAACm7C,GAAN,EAAWn7C,IAAI,CAACk9C,MAAhB,EAAwB,CAAxB,CAAd;AACH,eAJD,MAKK;AACD9B,qBAAK,CAACp7C,IAAI,CAACk9C,MAAN,EAAc1xE,CAAd,CAAL;AACH;;AAED2wE,0BAAY,CAACn8C,IAAI,CAACm7C,GAAN,EAAWn7C,IAAI,CAACk9C,MAAhB,EAAwBF,YAAxB,EAAsCxzE,CAAtC,EAAyCw2B,IAAzC,CAAZ;AACH;;AAED,gBAAIA,IAAI,CAAC3oB,IAAL,IAAa,IAAjB,EAAuB;AACnB2oB,kBAAI,CAAC3oB,IAAL,GAAYkkE,KAAK,CAAC,MAAD,EAAS/vE,CAAT,CAAjB;;AACA8wE,4BAAc,CAACt8C,IAAI,CAACm7C,GAAN,EAAWn7C,IAAI,CAAC3oB,IAAhB,EAAsB0U,KAAK,CAACioC,aAAN,GAAsB,CAAtB,GAA0B,CAAhD,CAAd;AACH,aAHD,MAIK;AACDonB,mBAAK,CAACp7C,IAAI,CAAC3oB,IAAN,EAAY7L,CAAZ,CAAL;AACH;;AAED2wE,wBAAY,CAACn8C,IAAI,CAACm7C,GAAN,EAAWn7C,IAAI,CAAC3oB,IAAhB,EAAsB0U,KAAtB,EAA6BviB,CAA7B,EAAgCw2B,IAAhC,CAAZ;AACH;AACJ,SArDD;AAsDH,OAjED;;AAkEA9B,SAAG,CAAC1G,MAAJ,CAAW6rB,GAAG,CAAC/T,kBAAJ,CAAuB6rC,GAAlC,EAAuCsB,YAAvC,EArWS,CAuWb;AAGA;;AAEI;;;;;AAGA,UAAIU,WAAW,GAAG95B,GAAG,CAAC85B,WAAJ,GAAkB,UAAUz+D,MAAV,EAAkB;AAClD,YAAIsiD,MAAM,GAAGyb,YAAY,CAACpsE,KAAb,CAAmB,IAAnB,EAAyB,CAClC;AACI2xB,kBAAQ,EAAEtjB,MAAM,CAAC4f,QAAP,CAAgBiQ,aAD9B;AAEIquC,sBAAY,EAAE7mE,SAFlB;AAGI2mE,2BAAiB,EAAE,KAHvB;AAIII,uBAAa,EAAE,IAJnB;AAKIx+C,kBAAQ,EAAE5f,MAAM,CAAC4f;AALrB,SADkC,CAAzB,CAAb;;AAUA0iC,cAAM,CAAC2b,QAAP,CAAgB/sC,KAAhB,GAAwB,UAAU7jB,KAAV,EAAiB;AACrC,cAAIhkB,CAAC,GAAGs7C,GAAG,CAAC7rB,MAAJ,CAAW,EAAX,EAAezL,KAAf,CAAR;;AACA,cAAIhkB,CAAC,CAACisD,aAAN,EAAqB;AACjBjsD,aAAC,CAACw9B,MAAF,GAAWx9B,CAAC,CAACisD,aAAb;AACH;;AAED,cAAI,KAAKqnB,IAAL,IAAa,IAAjB,EAAuB;AACnB,iBAAKA,IAAL,GAAY,KAAK+B,QAAL,CAAcr1E,CAAd,CAAZ;AACA,iBAAKozE,GAAL,CAASjvD,WAAT,CAAqB,KAAKmvD,IAA1B;AACH,WAHD,MAIK,IAAI,KAAKgC,UAAL,IAAmB,IAAvB,EAA6B;AAC9B,iBAAKA,UAAL,CAAgB,KAAKhC,IAArB;AACH;;AACDc,sBAAY,CAAC,KAAKhB,GAAN,EAAW,KAAKE,IAAhB,EAAsBtzE,CAAtB,EAAyB,CAAE,KAAKX,CAAP,EAAU,KAAKK,CAAf,EAAkB,KAAKc,CAAvB,EAA0B,KAAKmI,CAA/B,CAAzB,EAA6D,IAA7D,CAAZ;;AACAgrE,cAAI,CAAC,KAAKL,IAAN,EAAY,CAAE,KAAKj0E,CAAP,EAAU,KAAKK,CAAf,CAAZ,CAAJ;AACH,SAfuB,CAetByiB,IAfsB,CAejB,IAfiB,CAAxB;AAiBH,OA5BD;;AA6BAgU,SAAG,CAAC1G,MAAJ,CAAW2lD,WAAX,EAAwBV,YAAxB;AAEA;;;;;AAGAp5B,SAAG,CAAC3e,SAAJ,CAAcy2C,GAAd,CAAkB7S,GAAlB,GAAwB,YAAY;AAChCjlB,WAAG,CAAC3e,SAAJ,CAAc4jC,GAAd,CAAkBj4D,KAAlB,CAAwB,IAAxB,EAA8B0F,SAA9B;;AACAonE,mBAAW,CAAC9sE,KAAZ,CAAkB,IAAlB,EAAwB0F,SAAxB;;AACA,aAAKqnE,QAAL,GAAgB,UAAUrxD,KAAV,EAAiB;AAC7B,iBAAOwvD,KAAK,CAAC,QAAD,EAAW;AACnB,kBAAM,KAAKhzE,CAAL,GAAS,CADI;AAEnB,kBAAM,KAAKmI,CAAL,GAAS,CAFI;AAGnB,iBAAK,KAAKsyD;AAHS,WAAX,CAAZ;AAKH,SAND;;AAOA,aAAKqa,UAAL,GAAkB,UAAUhC,IAAV,EAAgB;AAC9BD,eAAK,CAACC,IAAD,EAAO;AACR,kBAAM,KAAK9yE,CAAL,GAAS,CADP;AAER,kBAAM,KAAKmI,CAAL,GAAS,CAFP;AAGR,iBAAK,KAAKsyD;AAHF,WAAP,CAAL;AAKH,SAND;AAOH,OAjBD;;AAkBA9kC,SAAG,CAAC1G,MAAJ,CAAW6rB,GAAG,CAAC3e,SAAJ,CAAcy2C,GAAd,CAAkB7S,GAA7B,EAAkC,CAACjlB,GAAG,CAAC3e,SAAJ,CAAc4jC,GAAf,EAAoB6U,WAApB,CAAlC;AAEA;;;;;AAGA95B,SAAG,CAAC3e,SAAJ,CAAcy2C,GAAd,CAAkB1S,SAAlB,GAA8B,YAAY;AACtCplB,WAAG,CAAC3e,SAAJ,CAAc+jC,SAAd,CAAwBp4D,KAAxB,CAA8B,IAA9B,EAAoC0F,SAApC;;AACAonE,mBAAW,CAAC9sE,KAAZ,CAAkB,IAAlB,EAAwB0F,SAAxB;;AACA,aAAKqnE,QAAL,GAAgB,UAAUrxD,KAAV,EAAiB;AAC7B,iBAAOwvD,KAAK,CAAC,MAAD,EAAS;AACjB,qBAAS,KAAKhzE,CADG;AAEjB,sBAAU,KAAKmI;AAFE,WAAT,CAAZ;AAIH,SALD;;AAMA,aAAK2sE,UAAL,GAAkB,UAAUhC,IAAV,EAAgB;AAC9BD,eAAK,CAACC,IAAD,EAAO;AACR,qBAAS,KAAK9yE,CADN;AAER,sBAAU,KAAKmI;AAFP,WAAP,CAAL;AAIH,SALD;AAMH,OAfD;;AAgBAwtB,SAAG,CAAC1G,MAAJ,CAAW6rB,GAAG,CAAC3e,SAAJ,CAAcy2C,GAAd,CAAkB1S,SAA7B,EAAwC,CAACplB,GAAG,CAAC3e,SAAJ,CAAc+jC,SAAf,EAA0B0U,WAA1B,CAAxC;AAEA;;;;;AAGA95B,SAAG,CAAC3e,SAAJ,CAAcy2C,GAAd,CAAkBrS,KAAlB,GAA0BzlB,GAAG,CAAC3e,SAAJ,CAAcokC,KAAxC;AACA;;;;AAGAzlB,SAAG,CAAC3e,SAAJ,CAAcy2C,GAAd,CAAkBtR,KAAlB,GAA0BxmB,GAAG,CAAC3e,SAAJ,CAAcmlC,KAAxC;AACA;;;;AAGAxmB,SAAG,CAACje,QAAJ,CAAa+1C,GAAb,CAAiBv3B,KAAjB,GAAyBP,GAAG,CAACje,QAAJ,CAAawe,KAAtC;AACA;;;;AAGAP,SAAG,CAACje,QAAJ,CAAa+1C,GAAb,CAAiB1O,MAAjB,GAA0BppB,GAAG,CAACje,QAAJ,CAAaqnC,MAAvC;;AAEA,UAAI6Q,uBAAuB,GAAG,SAA1BA,uBAA0B,CAAUC,UAAV,EAAsBX,YAAtB,EAAoC;AAC9DW,kBAAU,CAACltE,KAAX,CAAiB,IAAjB,EAAuBusE,YAAvB;;AACAv5B,WAAG,CAACtjB,kBAAJ,CAAuB1vB,KAAvB,CAA6B,IAA7B,EAAmCusE,YAAnC;;AACA,aAAKn3B,oBAAL,GAA4B,KAA5B;AACA,YAAIzlB,IAAI,GAAG,IAAX;AACA,aAAK3oB,IAAL,GAAY,IAAZ;;AACA,aAAKu4B,KAAL,GAAa,UAAUlxB,MAAV,EAAkB8tD,gBAAlB,EAAoC;AAC7C;AACA,cAAI9tD,MAAM,CAAC2f,SAAP,CAAiB88C,GAAjB,IAAwB3O,gBAA5B,EAA8C;AAC1C,gBAAI,KAAKn1D,IAAL,IAAa,IAAjB,EAAuB;AACnB,mBAAKA,IAAL,GAAYkkE,KAAK,CAAC,MAAD,EAAS;AACtB,kCAAkB;AADI,eAAT,CAAjB;AAGA78D,oBAAM,CAAC2f,SAAP,CAAiB88C,GAAjB,CAAqBjvD,WAArB,CAAiC,KAAK7U,IAAtC;;AACA,kBAAI,KAAKozD,cAAT,EAAyB;AACrB,qBAAKA,cAAL,CAAoB,KAAKpzD,IAAzB,EAA+BqH,MAAM,CAAC2f,SAAtC;AACH;;AAED,mBAAK4D,MAAL,GAAcvjB,MAAM,CAAC2f,SAAP,CAAiB88C,GAA/B,CATmB,CASiB;AACvC;;AACD,gBAAI54C,KAAK,GAAGq6C,YAAY,IAAKA,YAAY,CAACl0E,MAAb,KAAwB,CAAzC,GAA+Ck0E,YAAY,CAAC,CAAD,CAAZ,CAAgB56C,QAAhB,IAA4B,EAA3E,GAAiF,EAA7F;AAAA,gBACI8G,MAAM,GAAG,CAAC,CAAD,EAAI,CAAJ,CADb;;AAGA,gBAAI0jC,gBAAgB,CAACnZ,IAAjB,GAAwB,CAA5B,EAA+B;AAC3BvqB,oBAAM,CAAC,CAAD,CAAN,GAAY,CAAC0jC,gBAAgB,CAACnZ,IAA9B;AACH;;AACD,gBAAImZ,gBAAgB,CAAChZ,IAAjB,GAAwB,CAA5B,EAA+B;AAC3B1qB,oBAAM,CAAC,CAAD,CAAN,GAAY,CAAC0jC,gBAAgB,CAAChZ,IAA9B;AACH;;AAED4nB,iBAAK,CAAC,KAAK/jE,IAAN,EAAY;AACb,mBAAKmmE,QAAQ,CAAC9+D,MAAM,CAAClV,CAAR,CADA;AAEb,uBAAS+4B,KAFI;AAGbgD,oBAAM,EAAE7mB,MAAM,CAAC6mB,MAAP,GAAgB7mB,MAAM,CAAC6mB,MAAvB,GAAgC,IAH3B;AAIb5G,kBAAI,EAAEjgB,MAAM,CAACigB,IAAP,GAAcjgB,MAAM,CAACigB,IAArB,GAA4B,IAJrB;AAKbutC,uBAAS,EAAE,eAAepjC,MAAM,CAAC,CAAD,CAArB,GAA2B,GAA3B,GAAiCA,MAAM,CAAC,CAAD,CAAvC,GAA6C;AAL3C,aAAZ,CAAL;AAOH;AACJ,SAhCD;;AAiCA,YAAI00C,QAAQ,GAAG,SAAXA,QAAW,CAAUh0E,CAAV,EAAa;AACxB,iBAAQi0E,KAAK,CAACj0E,CAAC,CAACshE,GAAF,CAAM1jE,CAAP,CAAL,IAAkBq2E,KAAK,CAACj0E,CAAC,CAACshE,GAAF,CAAMrjE,CAAP,CAAxB,GAAqC,EAArC,GAA0C,MAAM+B,CAAC,CAACmhE,GAAF,CAAMvjE,CAAZ,GAAgB,GAAhB,GAAsBoC,CAAC,CAACmhE,GAAF,CAAMljE,CAA5B,GAC7C,IAD6C,GACtC+B,CAAC,CAACqhE,IAAF,CAAO,CAAP,EAAUzjE,CAD4B,GACxB,GADwB,GAClBoC,CAAC,CAACqhE,IAAF,CAAO,CAAP,EAAUpjE,CADQ,GAE7C,IAF6C,GAEtC+B,CAAC,CAACshE,GAAF,CAAM1jE,CAFgC,GAE5B,GAF4B,GAEtBoC,CAAC,CAACshE,GAAF,CAAMrjE,CAFgB,GAG7C,IAH6C,GAGtC+B,CAAC,CAACqhE,IAAF,CAAO,CAAP,EAAUzjE,CAH4B,GAGxB,GAHwB,GAGlBoC,CAAC,CAACqhE,IAAF,CAAO,CAAP,EAAUpjE,CAHQ,GAI7C,IAJ6C,GAItC+B,CAAC,CAACmhE,GAAF,CAAMvjE,CAJgC,GAI5B,GAJ4B,GAItBoC,CAAC,CAACmhE,GAAF,CAAMljE,CAJjC;AAKH,SAND;;AAOA,aAAKyqD,QAAL,GAAgB,UAASh9C,MAAT,EAAiB;AAC7B,cAAIA,MAAM,CAAC+sB,MAAP,IAAiB,KAAK5qB,IAAtB,IAA8B,KAAKA,IAAL,CAAUd,UAA5C,EAAwD;AACpD,iBAAKc,IAAL,CAAUd,UAAV,CAAqB0I,WAArB,CAAiC,KAAK5H,IAAtC;AACAnC,kBAAM,CAAC+sB,MAAP,CAAc/V,WAAd,CAA0B,KAAK7U,IAA/B;AACH;AACJ,SALD;AAMH,OApDD;;AAsDA,UAAIqmE,iBAAiB,GAAG;AACpBpqC,eAAO,EAAG,iBAAUrlB,KAAV,EAAiB;AACvB,cAAI,KAAK5W,IAAL,IAAa,IAAjB,EAAuB;AACnB,gBAAI4W,KAAJ,EAAW;AACP,mBAAKqQ,QAAL,CAActC,QAAd,CAAuBgjB,aAAvB,CAAqC,KAAK3nC,IAA1C;AACH,aAFD,MAGK;AACD,kBAAI,KAAKA,IAAL,CAAUd,UAAd,EAA0B;AACtB,qBAAKc,IAAL,CAAUd,UAAV,CAAqB0I,WAArB,CAAiC,KAAK5H,IAAtC;AACH;AACJ;AACJ;AACJ,SAZmB;AAYjBitC,gBAAQ,EAAE,kBAAStoB,QAAT,EAAmBqC,SAAnB,EAA8B;AACvC,cAAI,KAAKhnB,IAAL,IAAagnB,SAAS,CAAC4D,MAA3B,EAAmC;AAC/B5D,qBAAS,CAAC4D,MAAV,CAAiB/V,WAAjB,CAA6B,KAAK7U,IAAlC;AACH;AACJ,SAhBmB;AAiBpBm2B,kBAAU,EAAG,oBAAU5lC,CAAV,EAAa;AACtB,cAAI,KAAKyP,IAAL,IAAa,IAAjB,EAAuB;AAClB,iBAAKA,IAAL,CAAU0U,KAAV,CAAgB+hC,OAAhB,GAA2BlmD,CAAC,GAAG,OAAH,GAAa,MAA1C;AACH;AACJ;AArBmB,OAAxB;;AAwBAs2B,SAAG,CAAC1G,MAAJ,CAAW8lD,uBAAX,EAAoC,CAACj6B,GAAG,CAACtjB,kBAAL,EAAyBsjB,GAAG,CAACje,QAAJ,CAAa4kC,eAAtC,CAApC;;AAEA3mB,SAAG,CAACje,QAAJ,CAAa+1C,GAAb,CAAiB7Q,KAAjB,GAAyB,YAAY;AACjCgT,+BAAuB,CAACjtE,KAAxB,CAA8B,IAA9B,EAAoC,CAACgzC,GAAG,CAACje,QAAJ,CAAaklC,KAAd,EAAqBv0D,SAArB,CAApC;AACH,OAFD;;AAGAmoB,SAAG,CAAC1G,MAAJ,CAAW6rB,GAAG,CAACje,QAAJ,CAAa+1C,GAAb,CAAiB7Q,KAA5B,EAAmC,CAAEjnB,GAAG,CAACje,QAAJ,CAAaklC,KAAf,EAAsBgT,uBAAtB,CAAnC,EAAoFI,iBAApF;;AAEAr6B,SAAG,CAACje,QAAJ,CAAa+1C,GAAb,CAAiBhQ,UAAjB,GAA8B,YAAY;AACtCmS,+BAAuB,CAACjtE,KAAxB,CAA8B,IAA9B,EAAoC,CAACgzC,GAAG,CAACje,QAAJ,CAAa+lC,UAAd,EAA0Bp1D,SAA1B,CAApC;AACH,OAFD;;AAGAmoB,SAAG,CAAC1G,MAAJ,CAAW6rB,GAAG,CAACje,QAAJ,CAAa+1C,GAAb,CAAiBhQ,UAA5B,EAAwC,CAAE9nB,GAAG,CAACje,QAAJ,CAAa+lC,UAAf,EAA2BmS,uBAA3B,CAAxC,EAA8FI,iBAA9F;;AAEAr6B,SAAG,CAACje,QAAJ,CAAa+1C,GAAb,CAAiB/P,OAAjB,GAA2B,YAAY;AACnCkS,+BAAuB,CAACjtE,KAAxB,CAA8B,IAA9B,EAAoC,CAACgzC,GAAG,CAACje,QAAJ,CAAagmC,OAAd,EAAuBr1D,SAAvB,CAApC;AACH,OAFD;;AAGAmoB,SAAG,CAAC1G,MAAJ,CAAW6rB,GAAG,CAACje,QAAJ,CAAa+1C,GAAb,CAAiB/P,OAA5B,EAAqC,CAAE/nB,GAAG,CAACje,QAAJ,CAAagmC,OAAf,EAAwBkS,uBAAxB,CAArC,EAAwFI,iBAAxF,EAxiBS,CA0iBT;;;AACAr6B,SAAG,CAACje,QAAJ,CAAa+1C,GAAb,CAAiBzO,UAAjB,GAA8B,YAAY;AACtC,YAAIr1D,IAAI,GAAG,IAAX;AAAA,YAAiB2oB,IAAI,GAAG,IAAxB;AAAA,YAA8B29C,IAA9B;AAAA,YAAoCC,IAApC;;AACAv6B,WAAG,CAACje,QAAJ,CAAasnC,UAAb,CAAwBr8D,KAAxB,CAA8B,IAA9B,EAAoC0F,SAApC;;AACA,aAAK65B,KAAL,GAAa,UAAUlxB,MAAV,EAAkB8tD,gBAAlB,EAAoC;AAC7C,cAAIn1D,IAAI,IAAI,IAAZ,EAAkB;AACdA,gBAAI,GAAGkkE,KAAK,CAAC,MAAD,CAAZ;AACA78D,kBAAM,CAACkpC,SAAP,CAAiBuzB,GAAjB,CAAqBjvD,WAArB,CAAiC7U,IAAjC;AACA2oB,gBAAI,CAAC69C,eAAL,CAAqBxmE,IAArB,EAA2BqH,MAAM,CAACkpC,SAAlC;AACA5nB,gBAAI,CAAC69C,eAAL,CAAqBxmE,IAArB,EAA2B2oB,IAA3B;AAEA29C,gBAAI,GAAGpC,KAAK,CAAC,MAAD,CAAZ;AACA78D,kBAAM,CAACkpC,SAAP,CAAiBuzB,GAAjB,CAAqBjvD,WAArB,CAAiCyxD,IAAjC;AACA39C,gBAAI,CAAC69C,eAAL,CAAqBF,IAArB,EAA2Bj/D,MAAM,CAACkpC,SAAlC;AACA5nB,gBAAI,CAAC69C,eAAL,CAAqBF,IAArB,EAA2B39C,IAA3B;AAEA49C,gBAAI,GAAGrC,KAAK,CAAC,MAAD,CAAZ;AACA78D,kBAAM,CAACkpC,SAAP,CAAiBuzB,GAAjB,CAAqBjvD,WAArB,CAAiC0xD,IAAjC;AACA59C,gBAAI,CAAC69C,eAAL,CAAqBD,IAArB,EAA2Bl/D,MAAM,CAACkpC,SAAlC;AACA5nB,gBAAI,CAAC69C,eAAL,CAAqBD,IAArB,EAA2B59C,IAA3B;AACH;;AAED,cAAI8I,MAAM,GAAG,CAAC,CAAD,EAAI,CAAJ,CAAb;;AACA,cAAI0jC,gBAAgB,CAACnZ,IAAjB,GAAwB,CAA5B,EAA+B;AAC3BvqB,kBAAM,CAAC,CAAD,CAAN,GAAY,CAAC0jC,gBAAgB,CAACnZ,IAA9B;AACH;;AACD,cAAImZ,gBAAgB,CAAChZ,IAAjB,GAAwB,CAA5B,EAA+B;AAC3B1qB,kBAAM,CAAC,CAAD,CAAN,GAAY,CAAC0jC,gBAAgB,CAAChZ,IAA9B;AACH;;AAED4nB,eAAK,CAAC/jE,IAAD,EAAO;AACR,iBAAKmmE,QAAQ,CAAC9+D,MAAM,CAACgD,IAAR,EAAchD,MAAM,CAACmsD,IAArB,CADL;AAERtlC,kBAAM,EAAE,KAFA;AAGR5G,gBAAI,EAAE,IAHE;AAIRutC,qBAAS,EAAE,eAAepjC,MAAM,CAAC,CAAD,CAArB,GAA2B,GAA3B,GAAiCA,MAAM,CAAC,CAAD,CAAvC,GAA6C;AAJhD,WAAP,CAAL;;AAOAsyC,eAAK,CAACuC,IAAD,EAAO;AACR,iBAAKH,QAAQ,CAAC9+D,MAAM,CAACiuD,QAAP,CAAgB,CAAhB,CAAD,EAAqBjuD,MAAM,CAACiuD,QAAP,CAAgB,CAAhB,CAArB,CADL;AAERpnC,kBAAM,EAAE,MAFA;AAGR5G,gBAAI,EAAE,IAHE;AAIRutC,qBAAS,EAAE,eAAepjC,MAAM,CAAC,CAAD,CAArB,GAA2B,GAA3B,GAAiCA,MAAM,CAAC,CAAD,CAAvC,GAA6C;AAJhD,WAAP,CAAL;;AAOAsyC,eAAK,CAACwC,IAAD,EAAO;AACR,iBAAKJ,QAAQ,CAAC9+D,MAAM,CAACkuD,QAAP,CAAgB,CAAhB,CAAD,EAAqBluD,MAAM,CAACkuD,QAAP,CAAgB,CAAhB,CAArB,CADL;AAERrnC,kBAAM,EAAE,OAFA;AAGR5G,gBAAI,EAAE,IAHE;AAIRutC,qBAAS,EAAE,eAAepjC,MAAM,CAAC,CAAD,CAArB,GAA2B,GAA3B,GAAiCA,MAAM,CAAC,CAAD,CAAvC,GAA6C;AAJhD,WAAP,CAAL;AAMH,SA9CD;;AAgDA,YAAI00C,QAAQ,GAAG,SAAXA,QAAW,CAAUplD,EAAV,EAAcC,EAAd,EAAkB;AAC7B,iBAAO,OAAOD,EAAE,CAAChxB,CAAV,GAAc,GAAd,GAAoBgxB,EAAE,CAAC3wB,CAAvB,GACH,IADG,GACI4wB,EAAE,CAACjxB,CADP,GACW,GADX,GACiBixB,EAAE,CAAC5wB,CAD3B;AAEH,SAHD;AAIH,OAvDD;;AAwDAy2B,SAAG,CAAC1G,MAAJ,CAAW6rB,GAAG,CAACje,QAAJ,CAAa+1C,GAAb,CAAiBzO,UAA5B,EAAwCrpB,GAAG,CAACje,QAAJ,CAAasnC,UAArD;AACH,KApmBD,EAomBGl6D,IApmBH,CAomBQ,OAAOC,MAAP,KAAkB,WAAlB,GAAgCA,MAAhC,GAAyC,IApmBjD;AAsmBA;;;;;;;;;;;AAUA;AACA,KAAC,YAAY;AAET;;AAEA,UAAIxL,IAAI,GAAG,IAAX;AAAA,UAAiBo8C,GAAG,GAAGp8C,IAAI,CAACy3B,OAA5B;AAAA,UAAqCR,GAAG,GAAGj3B,IAAI,CAAC0tB,WAAhD;AAAA,UACImpD,GAAG,GAAG72E,IAAI,CAAC0pB,SADf;AAAA,UAC0B+vC,GAAG,GAAGz5D,IAAI,CAACyL,OADrC;;AAGA,UAAIqrE,gBAAgB,GAAG,SAAnBA,gBAAmB,CAAS/hD,QAAT,EAAmB;AACtC,YAAIhlB,CAAC,GAAGglB,QAAQ,CAACgiD,OAAjB;;AACA,YAAI,CAAChnE,CAAL,EAAQ;AACJA,WAAC,GAAGglB,QAAQ,CAACgiD,OAAT,GAAmB,IAAI/2E,IAAI,CAACwX,MAAT,EAAvB;AACH;;AACD,eAAOzH,CAAP;AACH,OAND;;AAQA,UAAIinE,eAAe,GAAG,SAAlBA,eAAkB,CAAUjiD,QAAV,EAAoBkiD,QAApB,EAA8B;AAEhDA,gBAAQ,GAAGA,QAAQ,IAAI,MAAvB;AACA,YAAIpgE,GAAG,GAAG,gBAAgBogE,QAA1B;AACA,YAAIl0E,CAAC,GAAGgyB,QAAQ,CAACle,GAAD,CAAhB;AAAA,YACI9G,CAAC,GAAGglB,QAAQ,CAACmiD,eAAT,EADR;;AAGA,YAAI,CAACn0E,CAAL,EAAQ;AACJA,WAAC,GAAG,IAAI8zE,GAAJ,CAAQ;AACR5zD,gBAAI,EAAElT,CAAC,CAACkI,EADA;AAER+N,kBAAM,EAAEjW,CAAC,CAACsI,GAFF;AAGRqP,mBAAO,EAAE00B,GAAG,CAAC10B,OAHL;AAIRI,oCAAwB,EAAC,kCAAS3Y,EAAT,EAAa;AAClC,qBAAO,CAAEA,EAAE,CAACG,UAAH,CAAc6nE,WAAhB,EAA6BhoE,EAAE,CAACG,UAAH,CAAc8nE,YAA3C,CAAP;AACH,aANO;AAOR70D,uBAAW,EAAE,qBAAUpT,EAAV,EAAckoE,cAAd,EAA8B;AACvC;AACA;AACA,kBAAIpsD,CAAC,GAAG8J,QAAQ,CAAC+b,SAAT,CAAmB3hC,EAAnB,EAAuBkoE,cAAvB,EAAuCloE,EAAE,CAAC+b,cAAH,GAAoB/b,EAAE,CAACohC,YAAvB,GAAsC,IAA7E,CAAR;AACA,qBAAO,CAACtlB,CAAC,CAAC3nB,IAAH,EAAS2nB,CAAC,CAAC7T,GAAX,CAAP;AACH,aAZO;AAaRqL,uBAAW,EAAE,qBAAUtT,EAAV,EAAc25B,EAAd,EAAkB;AAC3B35B,gBAAE,CAAC2V,KAAH,CAASxhB,IAAT,GAAgBwlC,EAAE,CAAC,CAAD,CAAF,GAAQ,IAAxB;AACA35B,gBAAE,CAAC2V,KAAH,CAAS1N,GAAT,GAAe0xB,EAAE,CAAC,CAAD,CAAF,GAAQ,IAAvB;AACH,aAhBO;AAiBRnqB,oBAAQ,EAAEy9B,GAAG,CAACz9B,QAjBN;AAkBRsH,uBAAW,EAAEm2B,GAAG,CAACn2B,WAlBT;AAmBRpZ,sBAAU,EAAE4sD,GAAG,CAAC5sD,UAnBR;AAoBRyD,mBAAO,EAAE,iBAASI,CAAT,EAAY3O,CAAZ,EAAe;AAAE,qBAAO2O,CAAC,CAACJ,OAAF,CAAUvO,CAAV,CAAP;AAAsB,aApBxC;AAqBR2c,iBAAK,EAACqW,QAAQ,CAACkF,eAAT,EArBE;AAsBRxb,eAAG,EAAE;AACDtB,sBAAQ,EAAE4X,QAAQ,CAACoT,eADlB;AAEDrrB,uBAAS,EAAE,eAFV;AAGDD,uBAAS,EAAE,eAHV;AAIDE,kBAAI,EAAE,UAJL;AAKDC,sBAAQ,EAAE,mBALT;AAMDC,oBAAM,EAAE,iBANP;AAODC,mBAAK,EAAE,gBAPN;AAQDE,wBAAU,EAAC;AARV;AAtBG,WAAR,CAAJ;AAiCAra,WAAC,CAAC6oB,OAAF,CAAUmJ,QAAQ,CAACnP,OAAT,EAAV;AACAmP,kBAAQ,CAACle,GAAD,CAAR,GAAgB9T,CAAhB;AACAgyB,kBAAQ,CAAC9R,IAAT,CAAc,MAAd,EAAsBlgB,CAAC,CAAC6oB,OAAxB;AACH;;AACD,eAAO7oB,CAAP;AACH,OA9CD;;AAgDA,UAAIu0E,UAAU,GAAC,SAAXA,UAAW,CAAS7/D,MAAT,EAAiB;AAC5B,YAAIwd,OAAO,GAAGxd,MAAM,CAACtI,EAAP,CAAUooE,mBAAxB;AACA,YAAIC,IAAI,GAAG,IAAX;;AACA,YAAIviD,OAAO,CAAC9Q,OAAZ,EAAqB;AACjBqzD,cAAI,GAAGviD,OAAO,CAAC9Q,OAAR,EAAP;AACH;;AACD,YAAIqzD,IAAJ,EAAU;AACN,eAAKtnC,iBAAL,CAAuB,IAAvB;AACA,eAAK9kB,MAAL,CAAY;AAACoK,kBAAM,EAAE/d,MAAM,CAACtI;AAAhB,WAAZ,EAAiCwP,QAAjC,CAA0C,KAAKkpB,oBAAL,GAA4B,GAA5B,GAAkC,KAAKC,0BAAjF,EAA6G,IAA7G;AACA,eAAK1c,MAAL,CAAY;AAACnd,kBAAM,EAAEwJ,MAAM,CAACtI;AAAhB,WAAZ,EAAiCwP,QAAjC,CAA0C,KAAKkpB,oBAAL,GAA4B,GAA5B,GAAkC,KAAKE,0BAAjF,EAA6G,IAA7G;AACA,eAAKf,yBAAL,CAA+B,IAA/B;AACH;;AACD,eAAOwwC,IAAP;AACH,OAbD;;AAcA,UAAIC,SAAS,GAAC,SAAVA,SAAU,CAAShgE,MAAT,EAAiB;AAC3B,YAAIgqB,EAAE,GAAG,KAAK2R,aAAL,CAAmBtkC,SAAnB,EAA8B,KAAK8W,OAAL,EAA9B,CAAT;;AACA,YAAI6b,EAAE,IAAI,IAAV,EAAgB;AACZ,cAAIxW,CAAC,GAAGxT,MAAM,CAACtI,EAAP,CAAUooE,mBAAlB;AACA,eAAKxnC,IAAL,CAAUt4B,MAAM,CAACtI,EAAjB,EAAqBsyB,EAArB,EAAyB,IAAzB,EAA+B,IAA/B;;AACA,cAAIxW,CAAC,CAACysD,SAAN,EAAiB;AACb,iBAAK/4D,QAAL,CAAclH,MAAM,CAACtI,EAArB,EAAyB,aAAzB;AACH;;AACD8b,WAAC,CAACysD,SAAF,GAAc,IAAd;AACH;AACJ,OAVD;;AAWA,UAAIC,SAAS,GAAC,SAAVA,SAAU,CAASlgE,MAAT,EAAiB;AAC3B,YAAIu3B,QAAQ,GAAGv3B,MAAM,CAAC8P,SAAtB;AAAA,YAAiCqwD,GAAjC;;AAEA,YAAIpnE,IAAI,GAAG,UAAU2H,EAAV,EAAc;AACrB,cAAIA,EAAE,CAAC,CAAD,CAAF,IAAS,IAAb,EAAmB;AACf;AACA;AACAy/D,eAAG,GAAG,KAAKxkC,aAAL,CAAmB,CAAC;AACtBjkC,gBAAE,EAACgJ,EAAE,CAAC,CAAD,CAAF,CAAMhJ,EADa;AAEtBiS,iBAAG,EAAC,CAACjJ,EAAE,CAAC,CAAD,CAAF,CAAM7U,IAAP,EAAa6U,EAAE,CAAC,CAAD,CAAF,CAAMf,GAAnB;AAFkB,aAAD,CAAnB,CAAN;AAIA,iBAAK24B,IAAL,CAAU53B,EAAE,CAAC,CAAD,CAAF,CAAMhJ,EAAhB,EAAoByoE,GAApB;AACH;;AAED,cAAIz/D,EAAE,CAAC,CAAD,CAAF,CAAMo/D,mBAAN,IAA6B,IAAjC,EAAuC;AACnC,mBAAOp/D,EAAE,CAAC,CAAD,CAAF,CAAMo/D,mBAAN,CAA0BG,SAAjC;AACH;;AAED,eAAKzxD,WAAL,CAAiB9N,EAAE,CAAC,CAAD,CAAnB,EAAwB,aAAxB;AACA,eAAKiT,MAAL,CAAY;AAACoK,kBAAM,EAAErd,EAAE,CAAC,CAAD,CAAF,CAAMhJ;AAAf,WAAZ,EAAgC8W,WAAhC,CAA4C,KAAK4hB,oBAAL,GAA4B,GAA5B,GAAkC,KAAKC,0BAAnF,EAA+G,IAA/G;AACA,eAAK1c,MAAL,CAAY;AAACnd,kBAAM,EAAEkK,EAAE,CAAC,CAAD,CAAF,CAAMhJ;AAAf,WAAZ,EAAgC8W,WAAhC,CAA4C,KAAK4hB,oBAAL,GAA4B,GAA5B,GAAkC,KAAKE,0BAAnF,EAA+G,IAA/G;AACA,eAAKnC,cAAL,GAAsBiyC,SAAtB,CAAgC1/D,EAAE,CAAC,CAAD,CAAF,CAAMhJ,EAAtC;AACH,SAnBU,CAmBT8T,IAnBS,CAmBJ,IAnBI,CAAX;;AAqBA,aAAK,IAAIlhB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGitC,QAAQ,CAACvtC,MAA7B,EAAqCM,CAAC,EAAtC,EAA0C;AACtCyO,cAAI,CAACw+B,QAAQ,CAACjtC,CAAD,CAAT,CAAJ;AACH;;AAED,aAAKmuC,iBAAL,CAAuB,KAAvB;AACA,aAAKlJ,yBAAL,CAA+B,KAA/B;AACH,OA9BD;;AAgCA,UAAI8wC,UAAU,GAAG,SAAbA,UAAa,CAAU7sD,CAAV,EAAazkB,CAAb,EAAgB;AAC7B,YAAIgK,IAAI,GAAG,SAAPA,IAAO,CAAUunE,KAAV,EAAiB;AACxB,cAAIvxE,CAAC,CAACuxE,KAAD,CAAD,IAAY,IAAhB,EAAsB;AAClB,gBAAI9gD,GAAG,CAACpJ,QAAJ,CAAarnB,CAAC,CAACuxE,KAAD,CAAd,CAAJ,EAA4B;AACxB,kBAAIj1E,CAAC,GAAG0D,CAAC,CAACuxE,KAAD,CAAD,CAASlzD,KAAT,CAAe,IAAf,IAAuB,CAAC,CAAxB,GAA4B,CAApC;AAAA,kBACIlkB,CAAC,GAAG6F,CAAC,CAACuxE,KAAD,CAAD,CAASjoD,SAAT,CAAmB,CAAnB,CADR;AAEA,qBAAO7E,CAAC,CAAC8sD,KAAD,CAAD,GAAYj1E,CAAC,GAAGnC,CAAvB;AACH,aAJD,MAKK;AACD,qBAAO6F,CAAC,CAACuxE,KAAD,CAAR;AACH;AACJ,WATD,MAUK;AACD,mBAAO9sD,CAAC,CAAC8sD,KAAD,CAAR;AACH;AACJ,SAdD;;AAeA,eAAO,CAAEvnE,IAAI,CAAC,MAAD,CAAN,EAAgBA,IAAI,CAAC,KAAD,CAApB,CAAP;AACH,OAjBD;;AAmBA,UAAIsF,OAAO,GAAG,SAAVA,OAAU,CAAUC,MAAV,EAAkBhG,CAAlB,EAAqB;AAC3B,YAAIA,CAAC,IAAI,IAAT,EAAe;AACX,iBAAO,CAAE,CAAF,EAAK,CAAL,CAAP;AACH;;AACD,YAAIiG,EAAE,GAAGC,QAAQ,CAAClG,CAAD,CAAjB;AAAA,YAAsBjO,CAAC,GAAGoU,SAAS,CAACF,EAAD,EAAK,CAAL,CAAnC;;AACA,eAAO,CAAClU,CAAC,CAACiU,MAAM,GAAG,GAAV,CAAF,EAAkBjU,CAAC,CAACiU,MAAM,GAAG,GAAV,CAAnB,CAAP;AACH,OANL;AAAA,UAOItD,aAAa,GAAGqD,OAAO,CAACmN,IAAR,CAAa,IAAb,EAAmB,MAAnB,CAPpB;AAAA,UAQI5M,eAAe,GAAGP,OAAO,CAACmN,IAAR,CAAa,IAAb,EAAmB,QAAnB,CARtB;AAAA,UASI3M,eAAe,GAAGR,OAAO,CAACmN,IAAR,CAAa,IAAb,EAAmB,QAAnB,CATtB;AAAA,UAUI/M,SAAS,GAAG,SAAZA,SAAY,CAAUpD,OAAV,EAAmByD,GAAnB,EAAwB;AAChC,eAAOzD,OAAO,CAAC/D,IAAR,GAAe+D,OAAO,CAAC/D,IAAR,CAAawH,GAAb,CAAf,GAAmCzD,OAAO,CAACyD,GAAD,CAAjD;AACH,OAZL;AAAA,UAaIN,QAAQ,GAAG,SAAXA,QAAW,CAAUlG,CAAV,EAAa;AACpB,eAAOA,CAAC,CAAC+C,OAAF,IAAa/C,CAAC,CAAC+C,OAAF,CAAUrR,MAAV,GAAmB,CAAhC,GAAoCsO,CAAC,CAAC+C,OAAtC,GACH/C,CAAC,CAACyG,cAAF,IAAoBzG,CAAC,CAACyG,cAAF,CAAiB/U,MAAjB,GAA0B,CAA9C,GAAkDsO,CAAC,CAACyG,cAApD,GACIzG,CAAC,CAAC0G,aAAF,IAAmB1G,CAAC,CAAC0G,aAAF,CAAgBhV,MAAhB,GAAyB,CAA5C,GAAgDsO,CAAC,CAAC0G,aAAlD,GACI,CAAE1G,CAAF,CAHZ;AAIH,OAlBL;AAoBA;;;;;;;;;;AAWA,UAAIioE,WAAW,GAAG,SAAdA,WAAc,CAAUp5C,gBAAV,EAA4B;AAC1C,YAAIq5C,WAAW,GAAG,EAAlB;AAAA,YAAsBC,MAAM,GAAG,EAA/B;AAAA,YAAmCC,UAAU,GAAG,EAAhD;AAAA,YAAoDC,sBAAsB,GAAG,EAA7E;AAAA,YACI;AACAC,8BAAsB,GAAG,EAF7B;AAIA;;;;;AAIA,aAAKC,QAAL,GAAgB,UAAUnpE,EAAV,EAAc;AAC1B,cAAI2d,EAAE,GAAG8R,gBAAgB,CAAClI,KAAjB,CAAuBvnB,EAAvB,CAAT;AAAA,cACIopE,YADJ;;AAGA,cAAI,CAACN,WAAW,CAACnrD,EAAD,CAAhB,EAAsB;AAClBmrD,uBAAW,CAACnrD,EAAD,CAAX,GAAkB3d,EAAlB;;AACA+oE,kBAAM,CAACzxE,IAAP,CAAY0I,EAAZ;;AACAgpE,sBAAU,CAACrrD,EAAD,CAAV,GAAiB,EAAjB;AACH,WARyB,CAU1B;;;AACA,cAAI0rD,SAAS,GAAG,SAAZA,SAAY,CAAUhyE,CAAV,EAAa;AACzB,gBAAIA,CAAJ,EAAO;AACH,mBAAK,IAAIzE,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGyE,CAAC,CAACoxC,UAAF,CAAan2C,MAAjC,EAAyCM,CAAC,EAA1C,EAA8C;AAC1C,oBAAIyE,CAAC,CAACoxC,UAAF,CAAa71C,CAAb,EAAgBk9B,QAAhB,KAA6B,CAA7B,IAAkCz4B,CAAC,CAACoxC,UAAF,CAAa71C,CAAb,EAAgBk9B,QAAhB,KAA6B,CAAnE,EAAsE;AAClE,sBAAIiL,GAAG,GAAGzS,OAAO,CAAC0H,UAAR,CAAmB34B,CAAC,CAACoxC,UAAF,CAAa71C,CAAb,CAAnB,CAAV;AAAA,sBACI02E,GAAG,GAAG75C,gBAAgB,CAAClI,KAAjB,CAAuBlwB,CAAC,CAACoxC,UAAF,CAAa71C,CAAb,CAAvB,EAAwC,IAAxC,EAA8C,IAA9C,CADV;;AAEA,sBAAI02E,GAAG,IAAIL,sBAAsB,CAACK,GAAD,CAA7B,IAAsCL,sBAAsB,CAACK,GAAD,CAAtB,GAA8B,CAAxE,EAA2E;AACvE,wBAAI,CAACF,YAAL,EAAmB;AACfA,kCAAY,GAAG35C,gBAAgB,CAACkS,SAAjB,CAA2B3hC,EAA3B,CAAf;AACH;;AACD,wBAAIupE,IAAI,GAAG95C,gBAAgB,CAACkS,SAAjB,CAA2B5G,GAA3B,CAAX;;AACAiuC,8BAAU,CAACrrD,EAAD,CAAV,CAAe2rD,GAAf,IAAsB;AAClB3rD,wBAAE,EAAE2rD,GADc;AAElB52C,4BAAM,EAAE;AACJv+B,4BAAI,EAAEo1E,IAAI,CAACp1E,IAAL,GAAYi1E,YAAY,CAACj1E,IAD3B;AAEJ8T,2BAAG,EAAEshE,IAAI,CAACthE,GAAL,GAAWmhE,YAAY,CAACnhE;AAFzB;AAFU,qBAAtB;AAOAihE,0CAAsB,CAACI,GAAD,CAAtB,GAA8B3rD,EAA9B;AACH;;AACD0rD,2BAAS,CAAChyE,CAAC,CAACoxC,UAAF,CAAa71C,CAAb,CAAD,CAAT;AACH;AACJ;AACJ;AACJ,WAxBD;;AA0BAy2E,mBAAS,CAACrpE,EAAD,CAAT;AACH,SAtCD,CAT0C,CAiD1C;;;AACA,aAAKqoC,aAAL,GAAqB,UAAU/gB,IAAV,EAAgBkiD,oBAAhB,EAAsC;AACvD,cAAIliD,IAAI,IAAI,IAAZ,EAAkB;AACdkiD,gCAAoB,GAAGA,oBAAoB,IAAI,EAA/C;;AACA,gBAAIC,KAAK,GAAGnhD,OAAO,CAAC0H,UAAR,CAAmB1I,IAAnB,CAAZ;AAAA,gBACI3J,EAAE,GAAG8R,gBAAgB,CAAClI,KAAjB,CAAuBkiD,KAAvB,CADT;AAAA,gBAEIrnE,QAAQ,GAAG4mE,UAAU,CAACrrD,EAAD,CAFzB;AAAA,gBAGIyrD,YAHJ;;AAKA,gBAAIhnE,QAAJ,EAAc;AACV,mBAAK,IAAIxP,CAAT,IAAcwP,QAAd,EAAwB;AACpB,oBAAIA,QAAQ,CAAC2C,cAAT,CAAwBnS,CAAxB,CAAJ,EAAgC;AAC5B,sBAAI82E,GAAG,GAAGphD,OAAO,CAAC0H,UAAR,CAAmBp9B,CAAnB,CAAV;AAAA,sBACI22E,IAAI,GAAGC,oBAAoB,CAAC52E,CAAD,CAApB,IAA2B68B,gBAAgB,CAACkS,SAAjB,CAA2B+nC,GAA3B,CADtC,CAD4B,CAI5B;;;AACA,sBAAIA,GAAG,CAACtoC,YAAJ,IAAoB,IAApB,IAA4B4nC,UAAU,CAACrrD,EAAD,CAAV,CAAe/qB,CAAf,KAAqB,IAArD,EAA2D;AACvD;AACH;;AAED,sBAAI,CAACw2E,YAAL,EAAmB;AACfA,gCAAY,GAAG35C,gBAAgB,CAACkS,SAAjB,CAA2B8nC,KAA3B,CAAf;AACH;;AAEDT,4BAAU,CAACrrD,EAAD,CAAV,CAAe/qB,CAAf,IAAoB;AAChB+qB,sBAAE,EAAE/qB,CADY;AAEhB8/B,0BAAM,EAAE;AACJv+B,0BAAI,EAAEo1E,IAAI,CAACp1E,IAAL,GAAYi1E,YAAY,CAACj1E,IAD3B;AAEJ8T,yBAAG,EAAEshE,IAAI,CAACthE,GAAL,GAAWmhE,YAAY,CAACnhE;AAFzB;AAFQ,mBAApB;AAOAihE,wCAAsB,CAACt2E,CAAD,CAAtB,GAA4B+qB,EAA5B;AACH;AACJ;AACJ;AACJ;AACJ,SAnCD;AAqCA;;;;;;;AAKA,aAAK+Y,aAAL,GAAqB,UAAU12B,EAAV,EAAc2d,EAAd,EAAkB;AAEnCA,YAAE,GAAGA,EAAE,IAAI8R,gBAAgB,CAAClI,KAAjB,CAAuBvnB,EAAvB,CAAX;AAEA,cAAI3K,CAAC,GAAGoL,QAAQ,CAACyL,IAAjB;AAAA,cACI7U,CAAC,GAAG2I,EAAE,CAACG,UADX;AAGA8oE,gCAAsB,CAACtrD,EAAD,CAAtB,GAA6BsrD,sBAAsB,CAACtrD,EAAD,CAAtB,GAA6BsrD,sBAAsB,CAACtrD,EAAD,CAAtB,GAA6B,CAA1D,GAA8D,CAA3F;;AAEA,iBAAOtmB,CAAC,IAAI,IAAL,IAAaA,CAAC,KAAKhC,CAA1B,EAA6B;AACzB,gBAAIs0E,GAAG,GAAGl6C,gBAAgB,CAAClI,KAAjB,CAAuBlwB,CAAvB,EAA0B,IAA1B,EAAgC,IAAhC,CAAV;;AACA,gBAAIsyE,GAAG,IAAIb,WAAW,CAACa,GAAD,CAAtB,EAA6B;AACzB,kBAAIC,IAAI,GAAGn6C,gBAAgB,CAACkS,SAAjB,CAA2BtqC,CAA3B,CAAX;;AAEA,kBAAI2xE,UAAU,CAACW,GAAD,CAAV,CAAgBhsD,EAAhB,KAAuB,IAA3B,EAAiC;AAC7B,oBAAIksD,IAAI,GAAGp6C,gBAAgB,CAACkS,SAAjB,CAA2B3hC,EAA3B,CAAX;;AACAgpE,0BAAU,CAACW,GAAD,CAAV,CAAgBhsD,EAAhB,IAAsB;AAClBA,oBAAE,EAAEA,EADc;AAElB+U,wBAAM,EAAE;AACJv+B,wBAAI,EAAE01E,IAAI,CAAC11E,IAAL,GAAYy1E,IAAI,CAACz1E,IADnB;AAEJ8T,uBAAG,EAAE4hE,IAAI,CAAC5hE,GAAL,GAAW2hE,IAAI,CAAC3hE;AAFjB;AAFU,iBAAtB;AAOAihE,sCAAsB,CAACvrD,EAAD,CAAtB,GAA6BgsD,GAA7B;AACH;;AACD;AACH;;AACDtyE,aAAC,GAAGA,CAAC,CAAC8I,UAAN;AACH;AACJ,SA7BD;;AA+BA,aAAK2pE,eAAL,GAAuB,UAAU7iD,QAAV,EAAoB;AACvC,cAAIgiD,sBAAsB,CAAChiD,QAAQ,CAACqP,SAAV,CAA1B,EAAgD;AAC5C2yC,kCAAsB,CAAChiD,QAAQ,CAACqP,SAAV,CAAtB;;AACA,gBAAI2yC,sBAAsB,CAAChiD,QAAQ,CAACqP,SAAV,CAAtB,IAA8C,CAAlD,EAAqD;AACjD,mBAAK,IAAI1jC,CAAT,IAAco2E,UAAd,EAA0B;AACtB,oBAAIA,UAAU,CAACjkE,cAAX,CAA0BnS,CAA1B,KAAgCo2E,UAAU,CAACp2E,CAAD,CAA9C,EAAmD;AAC/C,yBAAOo2E,UAAU,CAACp2E,CAAD,CAAV,CAAcq0B,QAAQ,CAACqP,SAAvB,CAAP;AACA,yBAAO4yC,sBAAsB,CAACjiD,QAAQ,CAACqP,SAAV,CAA7B;AACH;AACJ;AACJ;AACJ;AACJ,SAZD;;AAcA,aAAK2T,QAAL,GAAgB,UAAUwB,KAAV,EAAiB9B,KAAjB,EAAwB;AACpCq/B,oBAAU,CAACr/B,KAAD,CAAV,GAAoBq/B,UAAU,CAACv9B,KAAD,CAA9B;AACAu9B,oBAAU,CAACv9B,KAAD,CAAV,GAAoB,EAApB;AACAy9B,gCAAsB,CAACv/B,KAAD,CAAtB,GAAgCu/B,sBAAsB,CAACz9B,KAAD,CAAtD;AACAy9B,gCAAsB,CAACz9B,KAAD,CAAtB,GAAgC,IAAhC;AACH,SALD;;AAOA,aAAKs+B,uBAAL,GAA+B,UAAUpsD,EAAV,EAAc;AACzC,iBAAOqrD,UAAU,CAACrrD,EAAD,CAAjB;AACH,SAFD;;AAIA,aAAKR,cAAL,GAAsB,UAAUmZ,SAAV,EAAqB;AACvC,cAAIhP,IAAI,GAAG4hD,sBAAsB,CAAC5yC,SAAD,CAAjC;;AACA,cAAIhP,IAAJ,EAAU;AACN,mBAAO0hD,UAAU,CAAC1hD,IAAD,CAAV,CAAiBgP,SAAjB,CAAP;AACA,mBAAO4yC,sBAAsB,CAAC5yC,SAAD,CAA7B;AACH;AACJ,SAND;;AAQA,aAAKhZ,KAAL,GAAa,YAAY;AACrBwrD,qBAAW,GAAG,EAAd;AACAC,gBAAM,GAAG,EAAT;AACAC,oBAAU,GAAG,EAAb;AACAC,gCAAsB,GAAG,EAAzB;AACH,SALD,CA5J0C,CAmK1C;AACA;AACA;AACA;;;AACA,aAAKP,SAAL,GAAiB,UAAU1oE,EAAV,EAAc;AAC3B,cAAIA,EAAE,CAACohC,YAAH,IAAmB,IAAvB,EAA6B;AACzB,gBAAIzjB,EAAE,GAAG8R,gBAAgB,CAAClI,KAAjB,CAAuBvnB,EAAvB,CAAT;AAAA,gBACIgqE,QAAQ,GAAGd,sBAAsB,CAACvrD,EAAD,CADrC;;AAGA,gBAAIqsD,QAAJ,EAAc;AACV,mBAAK3hC,aAAL,CAAmB2hC,QAAnB;AACH;AACJ;AACJ,SATD;;AAWA,aAAKt+B,SAAL,GAAiB,UAAU1rC,EAAV,EAAcsnB,IAAd,EAAoBjwB,CAApB,EAAuB4yE,GAAvB,EAA4BC,oBAA5B,EAAkD;AAC/D,cAAI/rB,OAAO,GAAG+qB,sBAAsB,CAAC5hD,IAAD,CAApC;;AACA,cAAI,CAAC0hD,UAAU,CAACiB,GAAD,CAAf,EAAsB;AAClBjB,sBAAU,CAACiB,GAAD,CAAV,GAAkB,EAAlB;AACH;;AACD,cAAIL,IAAI,GAAGn6C,gBAAgB,CAACkS,SAAjB,CAA2BtqC,CAA3B,CAAX;AAAA,cACIwyE,IAAI,GAAGK,oBAAoB,IAAIz6C,gBAAgB,CAACkS,SAAjB,CAA2B3hC,EAA3B,CADnC;;AAGA,cAAIm+C,OAAO,IAAI6qB,UAAU,CAAC7qB,OAAD,CAAzB,EAAoC;AAChC,mBAAO6qB,UAAU,CAAC7qB,OAAD,CAAV,CAAoB72B,IAApB,CAAP;AACH;;AAED0hD,oBAAU,CAACiB,GAAD,CAAV,CAAgB3iD,IAAhB,IAAwB;AACpB3J,cAAE,EAAC2J,IADiB;AAEpBoL,kBAAM,EAAG;AACLv+B,kBAAI,EAAE01E,IAAI,CAAC11E,IAAL,GAAYy1E,IAAI,CAACz1E,IADlB;AAEL8T,iBAAG,EAAE4hE,IAAI,CAAC5hE,GAAL,GAAW2hE,IAAI,CAAC3hE;AAFhB;AAFW,WAAxB;AAOAihE,gCAAsB,CAAC5hD,IAAD,CAAtB,GAA+B2iD,GAA/B;AACH,SApBD;;AAsBA,aAAK7L,WAAL,GAAmB,UAASp+D,EAAT,EAAasnB,IAAb,EAAmB;AAClC,cAAI62B,OAAO,GAAG+qB,sBAAsB,CAAC5hD,IAAD,CAApC;;AACA,cAAI62B,OAAJ,EAAa;AACT,mBAAO6qB,UAAU,CAAC7qB,OAAD,CAAV,CAAoB72B,IAApB,CAAP;AACA,mBAAO4hD,sBAAsB,CAAC5hD,IAAD,CAA7B;AACH;AACJ,SAND;;AAQA,aAAKszC,gBAAL,GAAwB,UAAS56D,EAAT,EAAasnB,IAAb,EAAmB6iD,WAAnB,EAAgC;AACpD,cAAIhsB,OAAO,GAAG+qB,sBAAsB,CAAC5hD,IAAD,CAApC;;AACA,cAAI62B,OAAJ,EAAa;AACT,gBAAIisB,EAAE,GAAG,EAAT;AACAA,cAAE,CAAC9iD,IAAD,CAAF,GAAW6iD,WAAX;AACA,iBAAK9hC,aAAL,CAAmB8V,OAAnB,EAA4BisB,EAA5B;;AACA36C,4BAAgB,CAAC5H,UAAjB,CAA4Bs2B,OAA5B;AACH;AACJ,SARD;;AAUA,aAAKksB,eAAL,GAAuB,UAAUrqE,EAAV,EAAc;AACjC,cAAI0kC,EAAE,GAAGpc,OAAO,CAAC0H,UAAR,CAAmBhwB,EAAnB,CAAT;AAAA,cACI2d,EAAE,GAAG8R,gBAAgB,CAAClI,KAAjB,CAAuBmd,EAAvB,CADT;AAAA,cAEI4lC,GAAG,GAAGpB,sBAAsB,CAACvrD,EAAD,CAFhC;;AAIA,cAAI2sD,GAAJ,EAAS;AACL,mBAAOhiD,OAAO,CAAC0H,UAAR,CAAmBs6C,GAAnB,CAAP;AACH,WAFD,MAGK;AACD,mBAAO,IAAP;AACH;AACJ,SAXD;AAaH,OAvOD;;AAyOA,UAAIC,aAAa,GAAG,SAAhBA,aAAgB,CAAUvqE,EAAV,EAAcwqE,EAAd,EAAkBC,SAAlB,EAA6B;AACzCD,UAAE,GAAG1iD,GAAG,CAAC3F,QAAJ,CAAaqoD,EAAb,CAAL;;AACA,YAAI,OAAOxqE,EAAE,CAAC2mE,SAAH,CAAa+D,OAApB,KAAgC,WAApC,EAAiD;AAC7C1qE,YAAE,CAAC2mE,SAAH,CAAa+D,OAAb,GAAuBF,EAAvB;AACH,SAFD,MAGK;AACDxqE,YAAE,CAAC2mE,SAAH,GAAe6D,EAAf;AACH,SAPwC,CASzC;AACA;;;AACA,YAAI;AACA,cAAI5gE,EAAE,GAAG5J,EAAE,CAACyqE,SAAZ;;AACA,cAAI7gE,EAAE,IAAI,IAAV,EAAgB;AACZ,mBAAOA,EAAE,CAACtX,MAAH,GAAY,CAAnB,EAAsB;AAClBsX,gBAAE,CAAChB,MAAH,CAAUgB,EAAE,CAAChK,IAAH,CAAQ,CAAR,CAAV;AACH;;AACD,iBAAK,IAAIhN,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG63E,SAAS,CAACn4E,MAA9B,EAAsCM,CAAC,EAAvC,EAA2C;AACvC,kBAAI63E,SAAS,CAAC73E,CAAD,CAAb,EAAkB;AACdgX,kBAAE,CAAC+oC,GAAH,CAAO83B,SAAS,CAAC73E,CAAD,CAAhB;AACH;AACJ;AACJ;AACJ,SAZD,CAaA,OAAMgO,CAAN,EAAS;AACL;AACAknB,aAAG,CAACpvB,GAAJ,CAAQ,gCAAR,EAA0CkI,CAA1C;AACH;AACJ,OA5BL;AAAA,UA6BI+pE,aAAa,GAAG,SAAhBA,aAAgB,CAAU3qE,EAAV,EAAc;AAC1B,eAAQ,OAAOA,EAAE,CAAC2mE,SAAH,CAAa+D,OAApB,KAAgC,WAAjC,GAAgD1qE,EAAE,CAAC2mE,SAAnD,GAA+D3mE,EAAE,CAAC2mE,SAAH,CAAa+D,OAAnF;AACH,OA/BL;AAAA,UAgCIE,WAAW,GAAG,SAAdA,WAAc,CAAU5qE,EAAV,EAAcqsB,YAAd,EAA4BC,eAA5B,EAA6C;AACvDD,oBAAY,GAAGA,YAAY,IAAI,IAAhB,GAAuB,EAAvB,GAA4BvE,GAAG,CAACtJ,OAAJ,CAAY6N,YAAZ,IAA4BA,YAA5B,GAA2CA,YAAY,CAAC/pB,KAAb,CAAmB,KAAnB,CAAtF;AACAgqB,uBAAe,GAAGA,eAAe,IAAI,IAAnB,GAA0B,EAA1B,GAA+BxE,GAAG,CAACtJ,OAAJ,CAAY8N,eAAZ,IAA+BA,eAA/B,GAAiDA,eAAe,CAAChqB,KAAhB,CAAsB,KAAtB,CAAlG;;AAEA,YAAIqkE,SAAS,GAAGgE,aAAa,CAAC3qE,EAAD,CAA7B;AAAA,YACI6qE,UAAU,GAAGlE,SAAS,CAACrkE,KAAV,CAAgB,KAAhB,CADjB;;AAGA,YAAIuf,OAAO,GAAG,SAAVA,OAAU,CAAU8wB,GAAV,EAAem4B,OAAf,EAAwB;AAClC,eAAK,IAAIl4E,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGk4E,OAAO,CAACx4E,MAA5B,EAAoCM,CAAC,EAArC,EAAyC;AACrC,gBAAI+/C,GAAJ,EAAS;AACL,kBAAIk4B,UAAU,CAAC1pE,OAAX,CAAmB2pE,OAAO,CAACl4E,CAAD,CAA1B,MAAmC,CAAC,CAAxC,EAA2C;AACvCi4E,0BAAU,CAACvzE,IAAX,CAAgBwzE,OAAO,CAACl4E,CAAD,CAAvB;AACH;AACJ,aAJD,MAKK;AACD,kBAAIwU,GAAG,GAAGyjE,UAAU,CAAC1pE,OAAX,CAAmB2pE,OAAO,CAACl4E,CAAD,CAA1B,CAAV;;AACA,kBAAIwU,GAAG,KAAK,CAAC,CAAb,EAAgB;AACZyjE,0BAAU,CAACrpE,MAAX,CAAkB4F,GAAlB,EAAuB,CAAvB;AACH;AACJ;AACJ;AACJ,SAdD;;AAgBAya,eAAO,CAAC,IAAD,EAAOwK,YAAP,CAAP;;AACAxK,eAAO,CAAC,KAAD,EAAQyK,eAAR,CAAP;;AAEAi+C,qBAAa,CAACvqE,EAAD,EAAK6qE,UAAU,CAACpkD,IAAX,CAAgB,GAAhB,CAAL,EAA2BokD,UAA3B,CAAb;AACH,OA3DL;;AA6DAh6E,UAAI,CAACy3B,OAAL,CAAalH,MAAb,CAAoBvwB,IAAI,CAAC60B,eAAL,CAAqBjpB,SAAzC,EAAoD;AAEhD+5B,gBAAQ,EAAE,KAFsC;AAIhDtrB,oBAAY,EAAE5H,aAJkC;AAKhDynE,sBAAc,EAAE7jE,eALgC;AAMhD8jE,sBAAc,EAAE7jE,eANgC;AAQhDsvB,sBAAc,EAAC,0BAAW;AACtB,cAAI,KAAKkd,WAAL,IAAoB,IAAxB,EAA8B;AAC1B,iBAAKA,WAAL,GAAmB,IAAIk1B,WAAJ,CAAgB,IAAhB,CAAnB;AACH;;AAED,iBAAO,KAAKl1B,WAAZ;AACH,SAd+C;AAgBhDvsB,0BAAkB,EAAC,4BAASE,IAAT,EAAe;AAC9B,eAAKmP,cAAL,GAAsB4R,aAAtB,CAAoC/gB,IAApC;AACH,SAlB+C;AAoBhDqpB,qBAAa,EAAC,uBAASs6B,GAAT,EAAct1D,KAAd,EAAqBwW,KAArB,EAA4B++C,IAA5B,EAAkC;AAC5C,iBAAO,KAAK7F,eAAL,CAAqB,IAArB,EAA2B4F,GAA3B,EAAgCt1D,KAAhC,EAAuCwW,KAAvC,EAA8C++C,IAA9C,CAAP;AACH,SAtB+C;AAwBhD7F,uBAAe,EAAC,yBAASP,EAAT,EAAamG,GAAb,EAAkBt1D,KAAlB,EAAyBwW,KAAzB,EAAgC++C,IAAhC,EAAsC;AAClD,cAAItqE,CAAC,GAAGkkE,EAAE,IAAI,IAAN,GAAarkE,QAAQ,CAACkwC,aAAT,CAAuBs6B,GAAvB,CAAb,GAA2CxqE,QAAQ,CAAC4kE,eAAT,CAAyBP,EAAzB,EAA6BmG,GAA7B,CAAnD;AACA,cAAIr4E,CAAJ;AACA+iB,eAAK,GAAGA,KAAK,IAAI,EAAjB;;AACA,eAAK/iB,CAAL,IAAU+iB,KAAV,EAAiB;AACb/U,aAAC,CAAC+U,KAAF,CAAQ/iB,CAAR,IAAa+iB,KAAK,CAAC/iB,CAAD,CAAlB;AACH;;AAED,cAAIu5B,KAAJ,EAAW;AACPvrB,aAAC,CAAC+lE,SAAF,GAAcx6C,KAAd;AACH;;AAED++C,cAAI,GAAGA,IAAI,IAAI,EAAf;;AACA,eAAKt4E,CAAL,IAAUs4E,IAAV,EAAgB;AACZtqE,aAAC,CAACqC,YAAF,CAAerQ,CAAf,EAAkB,KAAKs4E,IAAI,CAACt4E,CAAD,CAA3B;AACH;;AAED,iBAAOgO,CAAP;AACH,SA1C+C;AA4ChDoC,oBAAY,EAAE,sBAAUhD,EAAV,EAAcmrE,OAAd,EAAuB;AACjC,iBAAOnrE,EAAE,CAACgD,YAAH,IAAmB,IAAnB,GAA0BhD,EAAE,CAACgD,YAAH,CAAgBmoE,OAAhB,CAA1B,GAAqD,IAA5D;AACH,SA9C+C;AAgDhDloE,oBAAY,EAAE,sBAAUjD,EAAV,EAAc5K,CAAd,EAAiB5D,CAAjB,EAAoB;AAC9B,cAAIwO,EAAE,CAACiD,YAAH,IAAmB,IAAvB,EAA6B;AACzBjD,cAAE,CAACiD,YAAH,CAAgB7N,CAAhB,EAAmB5D,CAAnB;AACH;AACJ,SApD+C;AAsDhDikD,qBAAa,EAAE,uBAAUz1C,EAAV,EAAckrE,IAAd,EAAoB;AAC/B,eAAK,IAAIt4E,CAAT,IAAcs4E,IAAd,EAAoB;AAChB,gBAAIA,IAAI,CAACnmE,cAAL,CAAoBnS,CAApB,CAAJ,EAA4B;AACxBoN,gBAAE,CAACiD,YAAH,CAAgBrQ,CAAhB,EAAmBs4E,IAAI,CAACt4E,CAAD,CAAvB;AACH;AACJ;AACJ,SA5D+C;AA6DhDu/B,oBAAY,EAAE,sBAAU8yC,IAAV,EAAgB;AAC1BxkE,kBAAQ,CAACyL,IAAT,CAAc4J,WAAd,CAA0BmvD,IAA1B;AACH,SA/D+C;AAgEhDmG,sBAAc,EAAE,0BAAY;AACxB,iBAAO,CAAE,KAAF,CAAP;AACH,SAlE+C;AAmEhDl/C,gBAAQ,EAACy+C,aAnEuC;AAoEhDn7D,gBAAQ,EAAE,kBAAUxP,EAAV,EAAcmsB,KAAd,EAAqB;AAC3B7D,iBAAO,CAAC/F,IAAR,CAAaviB,EAAb,EAAiB,UAAUY,CAAV,EAAa;AAC1BgqE,uBAAW,CAAChqE,CAAD,EAAIurB,KAAJ,CAAX;AACH,WAFD;AAGH,SAxE+C;AAyEhDhF,gBAAQ,EAAE,kBAAUnnB,EAAV,EAAcmsB,KAAd,EAAqB;AAC3BnsB,YAAE,GAAGsoB,OAAO,CAAC0H,UAAR,CAAmBhwB,EAAnB,CAAL;;AACA,cAAIA,EAAE,CAACyqE,SAAP,EAAkB;AACd,mBAAOzqE,EAAE,CAACyqE,SAAH,CAAaY,QAAb,CAAsBl/C,KAAtB,CAAP;AACH,WAFD,MAGK;AACD,mBAAOw+C,aAAa,CAAC3qE,EAAD,CAAb,CAAkBmB,OAAlB,CAA0BgrB,KAA1B,MAAqC,CAAC,CAA7C;AACH;AACJ,SAjF+C;AAkFhDrV,mBAAW,EAAE,qBAAU9W,EAAV,EAAcmsB,KAAd,EAAqB;AAC9B7D,iBAAO,CAAC/F,IAAR,CAAaviB,EAAb,EAAiB,UAAUY,CAAV,EAAa;AAC1BgqE,uBAAW,CAAChqE,CAAD,EAAI,IAAJ,EAAUurB,KAAV,CAAX;AACH,WAFD;AAGH,SAtF+C;AAuFhDm/C,mBAAW,EAAC,qBAAStrE,EAAT,EAAamsB,KAAb,EAAoB;AAC5B,cAAI7D,OAAO,CAACnB,QAAR,CAAiBnnB,EAAjB,EAAqBmsB,KAArB,CAAJ,EAAiC;AAC7B7D,mBAAO,CAACxR,WAAR,CAAoB9W,EAApB,EAAwBmsB,KAAxB;AACH,WAFD,MAEO;AACH7D,mBAAO,CAAC9Y,QAAR,CAAiBxP,EAAjB,EAAqBmsB,KAArB;AACH;AACJ,SA7F+C;AA8FhDC,qBAAa,EAAE,uBAAUpsB,EAAV,EAAcurE,KAAd,EAAqBC,QAArB,EAA+B;AAC1CljD,iBAAO,CAAC/F,IAAR,CAAaviB,EAAb,EAAiB,UAAUY,CAAV,EAAa;AAC1BgqE,uBAAW,CAAChqE,CAAD,EAAI2qE,KAAJ,EAAWC,QAAX,CAAX;AACH,WAFD;AAGH,SAlG+C;AAmGhDC,gBAAQ,EAAE,kBAAUzrE,EAAV,EAAcmsB,KAAd,EAAqB;AAC3B,cAAIA,KAAK,IAAI,IAAb,EAAmB;AACf7D,mBAAO,CAAC/F,IAAR,CAAaviB,EAAb,EAAiB,UAAUY,CAAV,EAAa;AAC1B2pE,2BAAa,CAAC3pE,CAAD,EAAIurB,KAAJ,EAAWA,KAAK,CAAC7pB,KAAN,CAAY,KAAZ,CAAX,CAAb;AACH,aAFD;AAGH;AACJ,SAzG+C;AA0GhDgR,mBAAW,EAAE,qBAAUtT,EAAV,EAAc3I,CAAd,EAAiB;AAC1B2I,YAAE,CAAC2V,KAAH,CAASxhB,IAAT,GAAgBkD,CAAC,CAAClD,IAAF,GAAS,IAAzB;AACA6L,YAAE,CAAC2V,KAAH,CAAS1N,GAAT,GAAe5Q,CAAC,CAAC4Q,GAAF,GAAQ,IAAvB;AACH,SA7G+C;AA8GhDmL,mBAAW,EAAE,qBAAUpT,EAAV,EAAc;AACvB,cAAIqB,IAAI,GAAG,SAAPA,IAAO,CAAUqqE,IAAV,EAAgB;AACvB,gBAAIl6E,CAAC,GAAGwO,EAAE,CAAC2V,KAAH,CAAS+1D,IAAT,CAAR;AACA,mBAAOl6E,CAAC,GAAGA,CAAC,CAACmvB,SAAF,CAAY,CAAZ,EAAenvB,CAAC,CAACc,MAAF,GAAW,CAA1B,CAAH,GAAkC,CAA1C;AACH,WAHD;;AAIA,iBAAO;AACH6B,gBAAI,EAAEkN,IAAI,CAAC,MAAD,CADP;AAEH4G,eAAG,EAAE5G,IAAI,CAAC,KAAD;AAFN,WAAP;AAIH,SAvH+C;AAwHhDsqE,gBAAQ,EAAC,kBAAS3rE,EAAT,EAAa0rE,IAAb,EAAmB;AACxB,cAAI,OAAOrvE,MAAM,CAACuvE,gBAAd,KAAmC,WAAvC,EAAoD;AAChD,mBAAOA,gBAAgB,CAAC5rE,EAAD,EAAK,IAAL,CAAhB,CAA2B6rE,gBAA3B,CAA4CH,IAA5C,CAAP;AACH,WAFD,MAEO;AACH,mBAAO1rE,EAAE,CAAC8rE,YAAH,CAAgBJ,IAAhB,CAAP;AACH;AACJ,SA9H+C;AA+HhDvlD,mBAAW,EAAE,qBAAUjmB,GAAV,EAAe6d,IAAf,EAAqB;AAC9B,cAAIhG,GAAG,GAAG,IAAV;;AACA,cAAIpY,SAAS,CAACrN,MAAV,KAAqB,CAAzB,EAA4B;AACxBylB,eAAG,GAAG7X,GAAG,CAAC4vB,QAAJ,IAAgB,IAAhB,GAAuB5vB,GAAvB,GAA6BO,QAAQ,CAACJ,gBAAT,CAA0BH,GAA1B,CAAnC;AACH,WAFD,MAGK;AACD6X,eAAG,GAAG7X,GAAG,CAACG,gBAAJ,CAAqB0d,IAArB,CAAN;AACH;;AAED,iBAAOhG,GAAP;AACH,SAzI+C;AA0IhD4pB,iBAAS,EAAC,mBAAS3hC,EAAT,EAAakoE,cAAb,EAA6BthD,SAA7B,EAAwC;AAC9C5mB,YAAE,GAAGsoB,OAAO,CAAC0H,UAAR,CAAmBhwB,EAAnB,CAAL;AACA4mB,mBAAS,GAAGA,SAAS,IAAI,KAAKC,YAAL,EAAzB;;AACA,cAAIzlB,GAAG,GAAG;AACFjN,gBAAI,EAAE6L,EAAE,CAAC8Y,UADP;AAEF7Q,eAAG,EAAEjI,EAAE,CAAC+Y;AAFN,WAAV;AAAA,cAIIgzD,EAAE,GAAI7D,cAAc,IAAMthD,SAAS,IAAI,IAAb,IAAsB5mB,EAAE,KAAK4mB,SAAP,IAAoB5mB,EAAE,CAACohC,YAAH,KAAoBxa,SAAnF,GAAmG5mB,EAAE,CAACohC,YAAtG,GAAqH,IAJ9H;AAAA,cAKI4qC,kBAAkB,GAAG,UAAS5qC,YAAT,EAAuB;AACxC,gBAAIA,YAAY,IAAI,IAAhB,IAAwBA,YAAY,KAAK3gC,QAAQ,CAACyL,IAAlD,KAA2Dk1B,YAAY,CAACn6B,SAAb,GAAyB,CAAzB,IAA8Bm6B,YAAY,CAACp6B,UAAb,GAA0B,CAAnH,CAAJ,EAA2H;AACvH5F,iBAAG,CAACjN,IAAJ,IAAYitC,YAAY,CAACp6B,UAAzB;AACA5F,iBAAG,CAAC6G,GAAJ,IAAWm5B,YAAY,CAACn6B,SAAxB;AACH;AACJ,WALoB,CAKnB6M,IALmB,CAKd,IALc,CALzB;;AAYA,iBAAOi4D,EAAE,IAAI,IAAb,EAAmB;AACf3qE,eAAG,CAACjN,IAAJ,IAAY43E,EAAE,CAACjzD,UAAf;AACA1X,eAAG,CAAC6G,GAAJ,IAAW8jE,EAAE,CAAChzD,SAAd;;AACAizD,8BAAkB,CAACD,EAAD,CAAlB;;AACAA,cAAE,GAAG7D,cAAc,GAAG6D,EAAE,CAAC3qC,YAAN,GACf2qC,EAAE,CAAC3qC,YAAH,KAAoBxa,SAApB,GAAgC,IAAhC,GAAuCmlD,EAAE,CAAC3qC,YAD9C;AAEH,WArB6C,CAuB9C;;;AACA,cAAIxa,SAAS,IAAI,IAAb,IAAqB,CAACshD,cAAtB,KAAyCthD,SAAS,CAAC3f,SAAV,GAAsB,CAAtB,IAA2B2f,SAAS,CAAC5f,UAAV,GAAuB,CAA3F,CAAJ,EAAmG;AAC/F,gBAAIi7B,EAAE,GAAGjiC,EAAE,CAACohC,YAAH,IAAmB,IAAnB,GAA0B,KAAKuqC,QAAL,CAAc3rE,EAAE,CAACohC,YAAjB,EAA+B,UAA/B,CAA1B,GAAuE,QAAhF;AAAA,gBACI/pC,CAAC,GAAG,KAAKs0E,QAAL,CAAc3rE,EAAd,EAAkB,UAAlB,CADR;;AAEA,gBAAI3I,CAAC,KAAK,UAAN,IAAoBA,CAAC,KAAK,OAA1B,IAAqC4qC,EAAE,KAAK,UAA5C,IAA0DA,EAAE,KAAK,OAArE,EAA8E;AAC1E7gC,iBAAG,CAACjN,IAAJ,IAAYyyB,SAAS,CAAC5f,UAAtB;AACA5F,iBAAG,CAAC6G,GAAJ,IAAW2e,SAAS,CAAC3f,SAArB;AACH;AACJ;;AACD,iBAAO7F,GAAP;AACH,SA3K+C;AA4KhD;AACA;AACA;AACAglC,4BAAoB,EAAE,8BAAU/jC,GAAV,EAAerC,EAAf,EAAmBisE,IAAnB,EAAyB;AAC3C,cAAIjgE,GAAG,GAAG,OAAOhM,EAAE,CAACiM,qBAAV,KAAoC,WAApC,GAAkDjM,EAAE,CAACiM,qBAAH,EAAlD,GAA+E;AAAE9X,gBAAI,EAAE,CAAR;AAAW8T,eAAG,EAAE,CAAhB;AAAmBid,iBAAK,EAAE,CAA1B;AAA6BD,kBAAM,EAAE;AAArC,WAAzF;AAAA,cACI/Y,IAAI,GAAGzL,QAAQ,CAACyL,IADpB;AAAA,cAEIC,OAAO,GAAG1L,QAAQ,CAACkF,eAFvB;AAAA,cAGIsB,SAAS,GAAG5K,MAAM,CAAC+P,WAAP,IAAsBD,OAAO,CAAClF,SAA9B,IAA2CiF,IAAI,CAACjF,SAHhE;AAAA,cAIID,UAAU,GAAG3K,MAAM,CAACgQ,WAAP,IAAsBF,OAAO,CAACnF,UAA9B,IAA4CkF,IAAI,CAAClF,UAJlE;AAAA,cAKIsF,SAAS,GAAGH,OAAO,CAACG,SAAR,IAAqBJ,IAAI,CAACI,SAA1B,IAAuC,CALvD;AAAA,cAMIC,UAAU,GAAGJ,OAAO,CAACI,UAAR,IAAsBL,IAAI,CAACK,UAA3B,IAAyC,CAN1D;AAAA,cAOI2/D,GAAG,GAAG,CAPV;AAAA,cAQIC,GAAG,GAAG,CARV;AAAA,cASIlkE,GAAG,GAAG+D,GAAG,CAAC/D,GAAJ,GAAUhB,SAAV,GAAsBqF,SAAtB,GAAmC4/D,GAAG,GAAGD,IATnD;AAAA,cAUI93E,IAAI,GAAG6X,GAAG,CAAC7X,IAAJ,GAAW6S,UAAX,GAAwBuF,UAAxB,GAAsC4/D,GAAG,GAAGF,IAVvD;AAAA,cAWIriE,EAAE,GAAG0e,OAAO,CAACpd,YAAR,CAAqB7I,GAArB,CAXT;AAAA,cAYIlQ,CAAC,GAAG6Z,GAAG,CAACkZ,KAAJ,IAAcllB,EAAE,CAACosE,WAAH,GAAiBH,IAZvC;AAAA,cAaI3xE,CAAC,GAAG0R,GAAG,CAACiZ,MAAJ,IAAejlB,EAAE,CAAC2nB,YAAH,GAAkBskD,IAbzC;AAAA,cAcIj7E,CAAC,GAAG,CAAC4Y,EAAE,CAAC,CAAD,CAAF,GAAQzV,IAAT,IAAiBhC,CAdzB;AAAA,cAeId,CAAC,GAAG,CAACuY,EAAE,CAAC,CAAD,CAAF,GAAQ3B,GAAT,IAAgB3N,CAfxB;AAiBA,iBAAO,CAAEtJ,CAAF,EAAKK,CAAL,CAAP;AACH,SAlM+C;;AAoMhD;;;;;;AAMAg7E,2BAAmB,EAAE,6BAAUrsE,EAAV,EAAc;AAC/B,cAAIqB,IAAI,GAAG,SAAPA,IAAO,CAAU1P,CAAV,EAAa;AACpB,gBAAI+sC,EAAE,GAAG1+B,EAAE,CAAC2V,KAAH,CAAShkB,CAAT,CAAT;;AACA,gBAAI+sC,EAAJ,EAAQ;AACJ,qBAAOjrC,UAAU,CAACirC,EAAE,CAAC/d,SAAH,CAAa,CAAb,EAAgB+d,EAAE,CAACpsC,MAAH,GAAY,CAA5B,CAAD,CAAjB;AACH;AACJ,WALD;;AAMA,iBAAO,CAAE+O,IAAI,CAAC,MAAD,CAAN,EAAgBA,IAAI,CAAC,KAAD,CAApB,CAAP;AACH,SAlN+C;;AAoNhD;;;;;;;;AAQAirE,2BAAmB,EAAE,6BAAUtsE,EAAV,EAAc25B,EAAd,EAAkB4yC,WAAlB,EAA+BC,cAA/B,EAA+C;AAChE,cAAID,WAAJ,EAAiB;AACb,iBAAKzyC,OAAL,CAAa95B,EAAb,EAAiB;AACb7L,kBAAI,EAAE,QAAQwlC,EAAE,CAAC,CAAD,CAAF,GAAQ4yC,WAAW,CAAC,CAAD,CAA3B,CADO;AAEbtkE,iBAAG,EAAE,QAAQ0xB,EAAE,CAAC,CAAD,CAAF,GAAQ4yC,WAAW,CAAC,CAAD,CAA3B;AAFQ,aAAjB,EAGGC,cAHH;AAIH,WALD,MAMK;AACDxsE,cAAE,CAAC2V,KAAH,CAASxhB,IAAT,GAAgBwlC,EAAE,CAAC,CAAD,CAAF,GAAQ,IAAxB;AACA35B,cAAE,CAAC2V,KAAH,CAAS1N,GAAT,GAAe0xB,EAAE,CAAC,CAAD,CAAF,GAAQ,IAAvB;AACH;AACJ,SAvO+C;;AAwOhD;;;AAGAphB,eAAO,EAAE,iBAAUvY,EAAV,EAAc;AACnB,iBAAO,CAAEA,EAAE,CAACosE,WAAL,EAAkBpsE,EAAE,CAAC2nB,YAArB,CAAP;AACH,SA7O+C;AA8OhD8kD,gBAAQ,EAAE,kBAAUzsE,EAAV,EAAc;AACpB,iBAAOA,EAAE,CAACosE,WAAV;AACH,SAhP+C;AAiPhDM,iBAAS,EAAE,mBAAU1sE,EAAV,EAAc;AACrB,iBAAOA,EAAE,CAAC2nB,YAAV;AACH,SAnP+C;AAoPhD4lB,qBAAa,EAAG,yBAAW;AAAE,iBAAO,KAAP;AAAe,SApPI;AAqPhD7/B,iBAAS,EAAG,mBAAU1N,EAAV,EAAc8lB,OAAd,EAAuB;AAC/B,cAAIuR,IAAJ;AACAr3B,YAAE,GAAG8nB,GAAG,CAACtJ,OAAJ,CAAYxe,EAAZ,KAAoBA,EAAE,CAAC1N,MAAH,IAAa,IAAb,IAAqB,CAACw1B,GAAG,CAACpJ,QAAJ,CAAa1e,EAAb,CAA1C,GAA8DA,EAA9D,GAAkE,CAAEA,EAAF,CAAvE;AACAN,eAAK,CAACjD,SAAN,CAAgB3D,KAAhB,CAAsBsD,IAAtB,CAA2B4D,EAA3B,EAA+BimE,OAA/B,CAAuC,UAASr+D,GAAT,EAAc;AACjDyvB,gBAAI,GAAG,KAAKA,IAAL,CAAUzvB,GAAV,CAAP;;AACA,gBAAIyvB,IAAI,CAACr3B,EAAT,EAAa;AACT,mBAAK2sE,yBAAL,CAA+Bt1C,IAAI,CAACr3B,EAApC,EAAwC,IAAxC,EAA8C8lB,OAA9C,EAAuDuR,IAAI,CAAC1Z,EAA5D,EAAgE,IAAhE;AACH;AACJ,WALsC,CAKrC7J,IALqC,CAKhC,IALgC,CAAvC;AAMA,iBAAO,IAAP;AACH,SA/P+C;AAgQhD+I,kBAAU,EAAG,oBAAS7c,EAAT,EAAahP,CAAb,EAAgBK,CAAhB,EAAmB;AAC5B,cAAI+P,GAAG,GAAG,EAAV;;AACA,cAAIwrE,MAAM,GAAG,UAAShlE,GAAT,EAAc;AACvB,gBAAIyvB,IAAI,GAAG,KAAKA,IAAL,CAAUzvB,GAAV,CAAX;;AACA,gBAAIyvB,IAAI,CAACr3B,EAAL,IAAW,IAAX,IAAmBq3B,IAAI,CAACr3B,EAAL,CAAQ+b,cAA/B,EAA+C;AAC3C,kBAAI1I,OAAO,GAAGgkB,IAAI,CAACr3B,EAAL,CAAQ+b,cAAR,CAAuB5I,IAAvB,CAA4BniB,CAA5B,EAA+BK,CAA/B,CAAd;;AACA,mBAAKw2B,UAAL,CAAgBwP,IAAI,CAACr3B,EAArB;AACAoB,iBAAG,CAAC9J,IAAJ,CAAS,CAAC+/B,IAAI,CAACr3B,EAAN,EAAUqT,OAAV,CAAT;AACH;AACJ,WAPY,CAOXS,IAPW,CAON,IAPM,CAAb,CAF4B,CAW5B;AACA;;;AACA,cAAGnU,SAAS,CAACrN,MAAV,KAAqB,CAArB,IAA0BqN,SAAS,CAACrN,MAAV,KAAqB,CAAlD,EAAqD;AACjDs6E,kBAAM,CAAC5sE,EAAD,EAAKhP,CAAL,EAAQK,CAAR,CAAN;AACH,WAFD,MAEO;AACH,gBAAIw7E,GAAG,GAAG,KAAK90C,kBAAL,EAAV;;AACA,iBAAK,IAAI+0C,GAAT,IAAgBD,GAAhB,EAAqB;AACjBD,oBAAM,CAACE,GAAD,EAAMntE,SAAS,CAAC,CAAD,CAAf,EAAoBA,SAAS,CAAC,CAAD,CAA7B,CAAN;AACH;AACJ;;AAED,iBAAOyB,GAAP;AACH,SAvR+C;AAwRhDs0B,qBAAa,EAAE,uBAAU11B,EAAV,EAAc8lB,OAAd,EAAuBgiD,QAAvB,EAAiC;AAC5CD,yBAAe,CAAC,IAAD,EAAOC,QAAP,CAAf,CAAgCp6D,SAAhC,CAA0C1N,EAA1C,EAA8C8lB,OAA9C;;AACA9lB,YAAE,CAACooE,mBAAH,GAAyBtiD,OAAzB;AACH,SA3R+C;AA4RhD1I,wBAAgB,EAAE,0BAAUpd,EAAV,EAAc8nE,QAAd,EAAwB;AACtCD,yBAAe,CAAC,IAAD,EAAOC,QAAP,CAAf,CAAgC1qD,gBAAhC,CAAiDpd,EAAjD;;AACA,iBAAOA,EAAE,CAACooE,mBAAV;AACH,SA/R+C;AAgShD2E,uBAAe,EAAE,yBAAU/sE,EAAV,EAAcqC,GAAd,EAAmBzF,EAAnB,EAAuBkrE,QAAvB,EAAiC;AAC9CD,yBAAe,CAAC,IAAD,EAAOC,QAAP,CAAf,CAAgC1qD,gBAAhC,CAAiDpd,EAAjD,EAAqDqC,GAArD,EAA0DzF,EAA1D;AACH,SAlS+C;AAmShDowE,oBAAY,EAAG,sBAAU36C,OAAV,EAAmB3kB,SAAnB,EAA8B;AACzC,iBAAO4a,OAAO,CAAC/F,IAAR,CAAa8P,OAAb,EAAsB,UAAUryB,EAAV,EAAc;AACvC,gBAAI,KAAKg3B,eAAL,CAAqBh3B,EAArB,CAAJ,EAA8B;AAC1B,mBAAKitE,gBAAL,CAAsB,KAAKjqE,YAAL,CAAkBhD,EAAlB,EAAsB,IAAtB,CAAtB,IAAqD0N,SAArD;AACA,mBAAKupB,mBAAL,CAAyBj3B,EAAzB,EAA6B0N,SAA7B;AACH;AACJ,WAL4B,CAK3BoG,IAL2B,CAKtB,IALsB,CAAtB,CAAP;AAMH,SA1S+C;AA2ShDm5D,wBAAgB,EAAG,EA3S6B;;AA4ShD;;;;AAIAC,uBAAe,EAAG,yBAAUltE,EAAV,EAAc;AAC5B,cAAIse,KAAJ;AACAgK,iBAAO,CAAC/F,IAAR,CAAaviB,EAAb,EAAiB,UAAUA,EAAV,EAAc;AAC3B,gBAAIsnB,IAAI,GAAG,KAAKtkB,YAAL,CAAkBhD,EAAlB,EAAsB,IAAtB,CAAX;AACAse,iBAAK,GAAG,KAAK2uD,gBAAL,CAAsB3lD,IAAtB,KAA+B,IAA/B,GAAsC,KAAtC,GAA8C,KAAK2lD,gBAAL,CAAsB3lD,IAAtB,CAAtD;AACAhJ,iBAAK,GAAG,CAACA,KAAT;AACA,iBAAK2uD,gBAAL,CAAsB3lD,IAAtB,IAA8BhJ,KAA9B;AACA,iBAAK0uD,YAAL,CAAkBhtE,EAAlB,EAAsBse,KAAtB;AACA,mBAAOA,KAAP;AACH,WAPgB,CAOfxK,IAPe,CAOV,IAPU,CAAjB;AAQA,iBAAOwK,KAAP;AACH,SA3T+C;AA4ThDquD,iCAAyB,EAAG,mCAAUt6C,OAAV,EAAmB86C,WAAnB,EAAgCxnC,WAAhC,EAA6ChoB,EAA7C,EAAiD/S,SAAjD,EAA4D;AACpF;AACA,cAAI,CAAC0d,OAAO,CAACkO,QAAb,EAAuB;AACnB,gBAAI42C,UAAU,GAAGD,WAAW,IAAI,IAAf,GAAsB,KAAtB,GAA8BA,WAA/C;;AACA,gBAAIC,UAAJ,EAAgB;AACZ,kBAAI9kD,OAAO,CAAC0O,eAAR,CAAwB3E,OAAxB,EAAiC,IAAjC,CAAJ,EAA4C;AACxC,oBAAIvM,OAAO,GAAG6f,WAAW,IAAI,KAAKxb,QAAL,CAAc+D,WAA3C;AACApI,uBAAO,GAAGwC,OAAO,CAAClH,MAAR,CAAe,EAAf,EAAmB0E,OAAnB,CAAV,CAFwC,CAED;;AACvC,oBAAI,CAACwC,OAAO,CAAC+0C,kBAAR,CAA2BhrC,OAA3B,EAAoC,IAApC,CAAL,EAAgD;AAC5C,sBAAIqT,SAAS,GAAGpd,OAAO,CAACkc,UAAR,CAAmB52B,IAAnC;AAAA,sBACI63B,SAAS,GAAGnd,OAAO,CAACkc,UAAR,CAAmBttB,IADnC;AAAA,sBAEIi+B,UAAU,GAAG7sB,OAAO,CAACkc,UAAR,CAAmB/sB,KAFpC;AAIA,uBAAK6pB,MAAL,CAAY3jB,EAAZ,EAAgB0U,OAAhB;AAEAvM,yBAAO,CAACqvB,UAAD,CAAP,GAAsBrtB,GAAG,CAACxE,IAAJ,CAASwC,OAAO,CAACqvB,UAAD,CAAhB,EAA8BgzB,UAAU,CAACr0D,IAAX,CAAgB,IAAhB,CAA9B,CAAtB;AAEAgS,yBAAO,CAAC4f,SAAD,CAAP,GAAqB5d,GAAG,CAACxE,IAAJ,CAASwC,OAAO,CAAC4f,SAAD,CAAhB,EAA6B4iC,SAAS,CAACx0D,IAAV,CAAe,IAAf,CAA7B,CAArB;AAEAgS,yBAAO,CAAC2f,SAAD,CAAP,GAAqB3d,GAAG,CAACxE,IAAJ,CAASwC,OAAO,CAAC2f,SAAD,CAAhB,EAA6B+iC,SAAS,CAAC10D,IAAV,CAAe,IAAf,CAA7B,CAArB;AAEA,sBAAIwT,IAAI,GAAG,KAAKC,KAAL,CAAW8K,OAAX,CAAX,CAb4C,CAaZ;;AAEhC,uBAAK46C,gBAAL,CAAsB3lD,IAAtB,IAA8B,IAA9B;AACA,sBAAI5Z,SAAS,GAAG,KAAKu/D,gBAAL,CAAsB3lD,IAAtB,CAAhB;AAEAxB,yBAAO,CAACunD,QAAR,GAAmB3/D,SAAS,IAAI,IAAb,GAAoB,KAApB,GAA4B,CAACA,SAAhD;AACA,uBAAKgoB,aAAL,CAAmBrD,OAAnB,EAA4BvM,OAA5B;AACA,uBAAK2Q,cAAL,GAAsB0yC,QAAtB,CAA+B92C,OAA/B;;AACA,sBAAIznB,SAAJ,EAAe;AACX,yBAAKuZ,IAAL,CAAU,kBAAV,EAA8B;AAACnkB,wBAAE,EAACqyB,OAAJ;AAAavM,6BAAO,EAACA;AAArB,qBAA9B;AACH;AACJ,iBAxBD,MAyBK;AACD;AACA,sBAAI6f,WAAW,CAAC9tB,KAAhB,EAAuB;AACnB,yBAAK6d,aAAL,CAAmBrD,OAAnB,EAA4BvM,OAA5B;AACH;AACJ;AACJ;AACJ;AACJ;AACJ,SAtW+C;AAuWhDkU,0BAAkB,EAAC,IAvW6B;AAwWhDhK,kBAAU,EAAE,oBAAUhwB,EAAV,EAAc;AACtB,cAAIA,EAAE,IAAI,IAAV,EAAgB;AACZ,mBAAO,IAAP;AACH,WAHqB,CAItB;AACA;AACA;AACA;;;AACAA,YAAE,GAAG,OAAOA,EAAP,KAAc,QAAd,GAAyBA,EAAzB,GAA8BA,EAAE,CAAC1N,MAAH,IAAa,IAAb,IAAqB0N,EAAE,CAACstE,OAAH,IAAc,IAAnC,GAA0CttE,EAAE,CAAC,CAAD,CAA5C,GAAkDA,EAArF;AACA,iBAAO,OAAOA,EAAP,KAAc,QAAd,GAAyBS,QAAQ,CAACC,cAAT,CAAwBV,EAAxB,CAAzB,GAAuDA,EAA9D;AACH,SAlX+C;AAmXhD4oC,qBAAa,EAAE,uBAAUvW,OAAV,EAAmB;AAC9Bw1C,yBAAe,CAAC,IAAD,CAAf,CAAsB1qD,cAAtB,CAAqCkV,OAArC;;AACA,eAAK01C,eAAL,GAAuBn/D,MAAvB,CAA8BypB,OAA9B;AACH,SAtX+C;AAuXhD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAkI,iBAAS,EAAE,mBAAUv6B,EAAV,EAAc+5B,UAAd,EAA0BjU,OAA1B,EAAmC;AAC1CA,iBAAO,GAAGA,OAAO,IAAI,EAArB;;AACA,cAAIhK,CAAC,GAAG,KAAK6lB,SAAL,CAAe3hC,EAAf,CAAR;AAAA,cACIokC,EAAE,GAAGukC,UAAU,CAAC7sD,CAAD,EAAIie,UAAJ,CADnB;AAAA,cAEIwzC,KAAK,GAAGnpC,EAAE,CAAC,CAAD,CAAF,GAAQtoB,CAAC,CAAC3nB,IAFtB;AAAA,cAGIq5E,KAAK,GAAGppC,EAAE,CAAC,CAAD,CAAF,GAAQtoB,CAAC,CAAC7T,GAHtB;AAAA,cAII7U,CAAC,GAAG0yB,OAAO,CAAC2nD,QAAR,IAAoB,GAJ5B;AAAA,cAKIrzC,IAAI,GAAG,EALX;AAAA,cAKe6zB,KAAK,GAAG76D,CAAC,GAAGgnC,IAL3B;AAAA,cAMIszC,IAAI,GAAItzC,IAAI,GAAGhnC,CAAR,GAAam6E,KANxB;AAAA,cAOII,IAAI,GAAIvzC,IAAI,GAAGhnC,CAAR,GAAao6E,KAPxB;AAAA,cAQIpmE,GAAG,GAAG,CARV;AAAA,cASIwmE,IAAI,GAAGC,WAAW,CAAC,YAAY;AAC3B5gC,eAAG,CAAC35B,WAAJ,CAAgBtT,EAAhB,EAAoB;AAChB7L,kBAAI,EAAE2nB,CAAC,CAAC3nB,IAAF,GAAUu5E,IAAI,IAAItmE,GAAG,GAAG,CAAV,CADJ;AAEhBa,iBAAG,EAAE6T,CAAC,CAAC7T,GAAF,GAAS0lE,IAAI,IAAIvmE,GAAG,GAAG,CAAV;AAFF,aAApB;;AAIA,gBAAI0e,OAAO,CAACsU,IAAR,IAAgB,IAApB,EAA0B;AACtBtU,qBAAO,CAACsU,IAAR,CAAahzB,GAAb,EAAkBtW,IAAI,CAACq8D,IAAL,CAAUc,KAAV,CAAlB;AACH;;AACD7mD,eAAG;;AACH,gBAAIA,GAAG,IAAI6mD,KAAX,EAAkB;AACd5xD,oBAAM,CAACyxE,aAAP,CAAqBF,IAArB;;AACA,kBAAI9nD,OAAO,CAACwU,QAAR,IAAoB,IAAxB,EAA8B;AAC1BxU,uBAAO,CAACwU,QAAR;AACH;AACJ;AACJ,WAfiB,EAefF,IAfe,CATtB;AAyBH,SA5Z+C;AA6ZhD;AAGA/c,wBAAgB,EAAE,0BAAUrd,EAAV,EAAc8nE,QAAd,EAAwB;AACtCD,yBAAe,CAAC,IAAD,EAAOC,QAAP,CAAf,CAAgCzqD,gBAAhC,CAAiDrd,EAAjD;AACH,SAla+C;AAmahD+tE,uBAAe,EAAE,yBAAU/tE,EAAV,EAAcqC,GAAd,EAAmBzF,EAAnB,EAAuBkrE,QAAvB,EAAiC;AAC9CD,yBAAe,CAAC,IAAD,EAAOC,QAAP,CAAf,CAAgCzqD,gBAAhC,CAAiDrd,EAAjD,EAAqDqC,GAArD,EAA0DzF,EAA1D;AACH,SAra+C;AAuahD+Q,iBAAS,EAAE,mBAAS3N,EAAT,EAAa8lB,OAAb,EAAsB;AAC7B9lB,YAAE,GAAG8nB,GAAG,CAACtJ,OAAJ,CAAYxe,EAAZ,KAAoBA,EAAE,CAAC1N,MAAH,IAAa,IAAb,IAAqB,CAACw1B,GAAG,CAACpJ,QAAJ,CAAa1e,EAAb,CAA1C,GAA8DA,EAA9D,GAAkE,CAAEA,EAAF,CAAvE;AACA,cAAIq3B,IAAJ;AACAvR,iBAAO,GAAGA,OAAO,IAAI,EAArB;AACAA,iBAAO,CAACzL,aAAR,GAAwB,KAAxB;AACA3a,eAAK,CAACjD,SAAN,CAAgB3D,KAAhB,CAAsBsD,IAAtB,CAA2B4D,EAA3B,EAA+BimE,OAA/B,CAAuC,UAASr+D,GAAT,EAAc;AACjDyvB,gBAAI,GAAG,KAAKA,IAAL,CAAUzvB,GAAV,CAAP;;AACA,gBAAIyvB,IAAI,CAACr3B,EAAT,EAAa;AACT,mBAAK4kC,aAAL,CAAmBvN,IAAI,CAACr3B,EAAxB,EAA4B8lB,OAA5B;AACH;AACJ,WALsC,CAKrChS,IALqC,CAKhC,IALgC,CAAvC;AAMA,iBAAO,IAAP;AACH,SAnb+C;AAqbhD8wB,qBAAa,EAAE,uBAAU5kC,EAAV,EAAc8lB,OAAd,EAAuBgiD,QAAvB,EAAiC;AAC5CD,yBAAe,CAAC,IAAD,EAAOC,QAAP,CAAf,CAAgCn6D,SAAhC,CAA0C3N,EAA1C,EAA8C8lB,OAA9C;AACH,SAvb+C;AAwbhDu3C,0BAAkB,EAAE,4BAAUr9D,EAAV,EAAc;AAC9B,iBAAOA,EAAE,CAAC+b,cAAH,IAAqB,IAA5B;AACH,SA1b+C;AA2bhDib,uBAAe,EAAE,yBAAUh3B,EAAV,EAAc8lB,OAAd,EAAuB;AACpC,iBAAO,IAAP;AACH,SA7b+C;AA8bhDmxB,uBAAe,EAAE,yBAAUj3C,EAAV,EAAc8lB,OAAd,EAAuB;AACpC,iBAAO,IAAP;AACH,SAhc+C;AAichDkoD,0BAAkB,EAAE,4BAAUhuE,EAAV,EAAc;AAC9BA,YAAE,GAAGitC,GAAG,CAACjd,UAAJ,CAAehwB,EAAf,CAAL;AACA,iBAAOA,EAAE,CAAC+b,cAAH,IAAqB/b,EAAE,CAAC+b,cAAH,CAAkBlM,SAAlB,EAA5B;AACH,SApc+C;AAqchDwnC,qBAAa,EAAE,uBAAUnhB,SAAV,EAAqB;AAChC,iBAAOA,SAAS,CAAC,CAAD,CAAT,CAAatoB,IAAb,CAAkByJ,cAAlB,EAAP;AACH,SAvc+C;AAwchD2+B,oBAAY,EAAE,sBAAUh2C,EAAV,EAAc;AACxB,iBAAOA,EAAE,CAAC+b,cAAH,IAAqB/b,EAAE,CAAC+b,cAAH,CAAkB/L,MAAlB,CAAyByW,IAAzB,CAA8B,GAA9B,CAArB,IAA2D,EAAlE;AACH,SA1c+C;AA2chD2vB,oBAAY,EAAE,sBAAUjzB,IAAV,EAAgB;AAC1B,iBAAOA,IAAI,CAAC,CAAD,CAAJ,CAAQviB,CAAf;AACH,SA7c+C;AA8chDqjC,qBAAa,EAAE,uBAAU/N,SAAV,EAAqB+1C,IAArB,EAA2B;AACtC;AACA;AACA;AACA;AACA;AACA,cAAIjsE,EAAE,GAAGk2B,SAAS,CAAC,CAAD,CAAT,CAAal2B,EAAtB;;AACA,cAAIA,EAAE,CAACohC,YAAH,IAAmB,IAAvB,EAA6B;AACzB,mBAAO,IAAP;AACH;;AACD,cAAIjpB,QAAQ,GAAG+d,SAAS,CAAC,CAAD,CAAT,CAAa/d,QAAb,IAAyB+d,SAAS,CAAC,CAAD,CAAT,CAAajkB,GAArD;AACA,cAAI5a,CAAC,GAAG;AAAElD,gBAAI,EAACgkB,QAAQ,CAAC,CAAD,CAAf;AAAoBlQ,eAAG,EAACkQ,QAAQ,CAAC,CAAD;AAAhC,WAAR;;AACA,cAAInY,EAAE,CAAC+b,cAAH,IAAqB/b,EAAE,CAACohC,YAAH,KAAoB,KAAKva,YAAL,EAA7C,EAAkE;AAC9D,gBAAIonD,EAAE,GAAG,KAAKtsC,SAAL,CAAe3hC,EAAE,CAACohC,YAAlB,CAAT;AACA/pC,aAAC,CAAClD,IAAF,IAAU85E,EAAE,CAAC95E,IAAb;AACAkD,aAAC,CAAC4Q,GAAF,IAASgmE,EAAE,CAAChmE,GAAZ;AACH;;AACD,iBAAO5Q,CAAP;AACH,SAhe+C;AAiehDovC,qBAAa,EAAE,uBAAUzmC,EAAV,EAAcgN,MAAd,EAAsB0H,QAAtB,EAAgC;AAC3C,cAAI1U,EAAE,CAAC+b,cAAP,EAAuB;AACnB/b,cAAE,CAAC+b,cAAH,CAAkBtH,SAAlB,CAA4BzH,MAA5B,EAAoC0H,QAApC;AACH;AACJ,SAre+C;AAsehDuiB,2BAAmB,EAAE,6BAAUj3B,EAAV,EAAc0N,SAAd,EAAyB;AAC1C1N,YAAE,GAAGitC,GAAG,CAACjd,UAAJ,CAAehwB,EAAf,CAAL;;AACA,cAAIA,EAAE,CAAC+b,cAAP,EAAuB;AACnB/b,cAAE,CAAC+b,cAAH,CAAkBnM,UAAlB,CAA6BlC,SAA7B;AACH;AACJ,SA3e+C;AA4ehD05B,oBAAY,EAAE,sBAAUpnC,EAAV,EAAcuP,KAAd,EAAqB;AAC/B,cAAIvP,EAAE,CAAC+b,cAAP,EAAuB;AACnB/b,cAAE,CAAC+b,cAAH,CAAkBnoB,CAAlB,CAAoBwzC,YAApB,CAAiCpnC,EAAjC,EAAqCuP,KAArC;AACH;AACJ,SAhf+C;AAifhD83B,oBAAY,EAAC,sBAASrnC,EAAT,EAAauP,KAAb,EAAoB;AAC7B,cAAIvP,EAAE,CAACgc,cAAH,IAAqBhc,EAAE,CAACgc,cAAH,CAAkB1pB,MAAlB,GAA2B,CAApD,EAAuD;AACnD0N,cAAE,CAACgc,cAAH,CAAkB,CAAlB,EAAqBpoB,CAArB,CAAuByzC,YAAvB,CAAoCrnC,EAApC,EAAwCuP,KAAxC;AACH;AACJ,SArf+C;AAsfhDuO,kBAAU,EAAC,oBAAS9d,EAAT,EAAa+d,IAAb,EAAmB;AAC1B,cAAImwD,KAAK,GAAGxuE,KAAK,CAACjD,SAAN,CAAgB3D,KAAhB,CAAsBsD,IAAtB,CAA2BuD,SAA3B,EAAsC,CAAtC,CAAZ;;AACA,cAAI48B,EAAE,GAAGsrC,eAAe,CAAC,IAAD,CAAxB;;AACA56B,aAAG,CAAC1qB,IAAJ,CAASviB,EAAT,EAAa,UAAS4H,GAAT,EAAc;AACvBA,eAAG,GAAG,CAAEqlC,GAAG,CAACjd,UAAJ,CAAepoB,GAAf,CAAF,CAAN;;AACAA,eAAG,CAACtQ,IAAJ,CAAS2C,KAAT,CAAe2N,GAAf,EAAoBsmE,KAApB;;AACA3xC,cAAE,CAACze,UAAH,CAAc7jB,KAAd,CAAoBsiC,EAApB,EAAwB30B,GAAxB;AACH,WAJD;AAKH,SA9f+C;AA+fhDoW,gBAAQ,EAAC,kBAAShe,EAAT,EAAa+d,IAAb,EAAmB;AACxB,cAAImwD,KAAK,GAAGxuE,KAAK,CAACjD,SAAN,CAAgB3D,KAAhB,CAAsBsD,IAAtB,CAA2BuD,SAA3B,EAAsC,CAAtC,CAAZ;;AACA,cAAI48B,EAAE,GAAGsrC,eAAe,CAAC,IAAD,CAAxB;;AACA56B,aAAG,CAAC1qB,IAAJ,CAASviB,EAAT,EAAa,UAAS4H,GAAT,EAAc;AACvBA,eAAG,GAAG,CAAEqlC,GAAG,CAACjd,UAAJ,CAAepoB,GAAf,CAAF,CAAN;;AACAA,eAAG,CAACtQ,IAAJ,CAAS2C,KAAT,CAAe2N,GAAf,EAAoBsmE,KAApB;;AACA3xC,cAAE,CAACve,QAAH,CAAY/jB,KAAZ,CAAkBsiC,EAAlB,EAAsB30B,GAAtB;AACH,WAJD;AAKH,SAvgB+C;AAwgBhDsW,uBAAe,EAAC,yBAASle,EAAT,EAAa0d,OAAb,EAAsB;AAClC,cAAIwwD,KAAK,GAAGxuE,KAAK,CAACjD,SAAN,CAAgB3D,KAAhB,CAAsBsD,IAAtB,CAA2BuD,SAA3B,EAAsC,CAAtC,CAAZ;;AACA,cAAI48B,EAAE,GAAGsrC,eAAe,CAAC,IAAD,CAAxB;;AACA56B,aAAG,CAAC1qB,IAAJ,CAASviB,EAAT,EAAa,UAAS4H,GAAT,EAAc;AACvBA,eAAG,GAAG,CAAEqlC,GAAG,CAACjd,UAAJ,CAAepoB,GAAf,CAAF,CAAN;;AACAA,eAAG,CAACtQ,IAAJ,CAAS2C,KAAT,CAAe2N,GAAf,EAAoBsmE,KAApB;;AACA3xC,cAAE,CAACre,eAAH,CAAmBjkB,KAAnB,CAAyBsiC,EAAzB,EAA6B30B,GAA7B;AACH,WAJD;AAKH,SAhhB+C;AAihBhDwW,2BAAmB,EAAC,6BAASpe,EAAT,EAAa;AAC7B,cAAIu8B,EAAE,GAAGsrC,eAAe,CAAC,IAAD,CAAxB;;AACA56B,aAAG,CAAC1qB,IAAJ,CAASviB,EAAT,EAAa,UAAS4H,GAAT,EAAc;AAAE20B,cAAE,CAACne,mBAAH,CAAuB6uB,GAAG,CAACjd,UAAJ,CAAepoB,GAAf,CAAvB;AAA8C,WAA3E;AACH,SAphB+C;AAqhBhDyW,qBAAa,EAAC,uBAASre,EAAT,EAAa0d,OAAb,EAAsBY,KAAtB,EAA6B;AACvC,cAAIie,EAAE,GAAGsrC,eAAe,CAAC,IAAD,CAAxB;;AACA56B,aAAG,CAAC1qB,IAAJ,CAASviB,EAAT,EAAa,UAAS4H,GAAT,EAAc;AAAE20B,cAAE,CAACle,aAAH,CAAiB4uB,GAAG,CAACjd,UAAJ,CAAepoB,GAAf,CAAjB,EAAsC8V,OAAtC,EAA+CY,KAA/C;AAAwD,WAArF;AACH,SAxhB+C;AAyhBhDkmB,kBAAU,EAAE;AACR,mBAAS,OADD;AACU,kBAAQ,MADlB;AAC0B,kBAAQ,MADlC;AAC0C,kBAAQ,MADlD;AAER,kBAAQ,MAFA;AAEQ,iBAAO,KAFf;AAEsB,kBAAQ,MAF9B;AAEsC,sBAAY,UAFlD;AAGR,yBAAc;AAHN,SAzhBoC;AA8hBhDrK,kBAAU,EAAE;AACR,kBAAQ,MADA;AACQ,sBAAY;AADpB,SA9hBoC;AAiiBhDoW,gBAAQ,EAAE,kBAAUvwC,EAAV,EAAc;AACpB,cAAIA,EAAE,CAAC+b,cAAP,EAAuB;AACnB/b,cAAE,CAAC+b,cAAH,CAAkBxF,KAAlB;AACH;AACJ,SAriB+C;AAsiBhD43D,0BAAkB,EAAE,4BAAUpwD,IAAV,EAAgB;AAChC,cAAI/d,EAAE,GAAG,KAAKgwB,UAAL,CAAgBjS,IAAhB,CAAT;;AACA,cAAI/d,EAAE,IAAI,IAAN,KAAeA,EAAE,CAACglC,eAAH,IAAsBhlC,EAAE,CAACi6D,aAAH,IAAoB,IAAzD,CAAJ,EAAoE;AAChE4N,2BAAe,CAAC,IAAD,CAAf,CAAsB5rD,MAAtB,CAA6B8B,IAA7B;AACH;AACJ,SA3iB+C;AA4iBhDm8C,+BAAuB,EAAE,iCAAUn8C,IAAV,EAAgB;AACrC8pD,yBAAe,CAAC,IAAD,CAAf,CAAsB3rD,QAAtB,CAA+B6B,IAA/B;AACH,SA9iB+C;AA+iBhDqwD,wBAAgB,EAAC,4BAAW;AACxB,iBAAOvG,eAAe,CAAC,IAAD,CAAf,CAAsB7vD,YAAtB,EAAP;AACH,SAjjB+C;AAkjBhDq2D,0BAAkB,EAAE,8BAAY;AAC5BxG,yBAAe,CAAC,IAAD,CAAf,CAAsBzrD,WAAtB;AACH,SApjB+C;AAqjBhDjT,eAAO,EAAE,iBAAUnJ,EAAV,EAAc2B,KAAd,EAAqByH,aAArB,EAAoCC,OAApC,EAA6C;AAClD,eAAK0+D,eAAL,GAAuB5+D,OAAvB,CAA+BnJ,EAA/B,EAAmC2B,KAAnC,EAA0CyH,aAA1C,EAAyDC,OAAzD;AACH,SAvjB+C;AAwjBhD8/B,eAAO,EAAC,mBAAW;AACf;AACA,eAAK,IAAIzhC,GAAT,IAAgB,IAAhB,EAAsB;AAClB,gBAAIA,GAAG,CAACvG,OAAJ,CAAY,aAAZ,MAA+B,CAAnC,EAAsC;AAClC,mBAAKuG,GAAL,EAAU4V,KAAV;AACH;AACJ;AACJ,SA/jB+C;AAgkBhDyqD,uBAAe,EAAC,2BAAW;AACvB,iBAAOJ,gBAAgB,CAAC,IAAD,CAAvB;AACH,SAlkB+C;AAmkBhD7+D,UAAE,EAAG,YAAS9I,EAAT,EAAa2B,KAAb,EAAoB2sE,QAApB,EAA8B;AAC/B;AACA;AACA;AACA;AACA;AACA,eAAKvG,eAAL,GAAuBj/D,EAAvB,CAA0B7O,KAA1B,CAAgC,IAAhC,EAAsC0F,SAAtC;AACA,iBAAO,IAAP;AACH,SA3kB+C;AA4kBhDuJ,WAAG,EAAG,aAASlJ,EAAT,EAAa2B,KAAb,EAAoB2sE,QAApB,EAA8B;AAChC,eAAKvG,eAAL,GAAuB7+D,GAAvB,CAA2BjP,KAA3B,CAAiC,IAAjC,EAAuC0F,SAAvC;AACA,iBAAO,IAAP;AACH;AA/kB+C,OAApD;;AAmlBA,UAAIuoC,KAAK,GAAG,SAARA,KAAQ,CAAUr8B,CAAV,EAAa;AACrB,YAAI0iE,GAAG,GAAG,SAANA,GAAM,GAAY;AAClB,cAAI,8BAA8BlsD,IAA9B,CAAmC5hB,QAAQ,CAAC+tE,UAA5C,KAA2D,OAAO/tE,QAAQ,CAACyL,IAAhB,KAA0B,WAArF,IAAoGzL,QAAQ,CAACyL,IAAT,IAAiB,IAAzH,EAA+H;AAC3HL,aAAC;AACJ,WAFD,MAGK;AACDrH,sBAAU,CAAC+pE,GAAD,EAAM,CAAN,CAAV;AACH;AACJ,SAPD;;AASAA,WAAG;AACN,OAXD;;AAYArmC,WAAK,CAAC+E,GAAG,CAAChjC,IAAL,CAAL;AAEH,KAjjCD,EAijCG7N,IAjjCH,CAijCQ,OAAOC,MAAP,KAAkB,WAAlB,GAAgCA,MAAhC,GAAyC,IAjjCjD;;;;;;;;;;;;;;;;ACrkdA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;AAQA,QAAMoyE,GAAG,GAAG,CAAC,iBAAD,CAAZ;AACA,QAAIC,YAAY,GAAG,KAAnB;AACA,QAAIC,WAAJ;;QACMC,U;AACF,0BAAYC,MAAZ,EAAoB;AAAA;;AAChB,aAAKA,MAAL,GAAcA,MAAd;AACA,aAAKC,MAAL,GAAc,IAAI,0DAAJ,EAAd;AACH;;;;0CACiB;AAAA;;AACd,cAAIJ,YAAJ,EAAkB;AACd;AACAC,uBAAW,CAACI,IAAZ,CAAiB,YAAM;AACnB,oBAAI,CAACC,UAAL,CAAgB,MAAI,CAACC,QAArB;AACH,aAFD;AAGH,WALD,MAMK;AACDP,wBAAY,GAAG,IAAf;AACAC,uBAAW,GAAG,IAAIO,OAAJ,CAAY,UAACC,OAAD,EAAa;AACnC,kBAAMC,OAAO,GAAG,MAAI,CAACP,MAAL,CAAYO,OAAZ,IAAuB,UAAvC;;AACA,kBAAI,OAAQ/yE,MAAM,CAACgzE,MAAf,KAA2B,QAA/B,EAAyC;AACrCF,uBAAO;AACP;AACH;;AACD,kBAAMG,cAAc,GAAG,SAAjBA,cAAiB,GAAM;AACzB;AACAjzE,sBAAM,CAACkzE,OAAP,CAAeV,MAAf,CAAsB;AAAEW,uBAAK,EAAE;AAAE,oCAASJ,OAAT;AAAF;AAAT,iBAAtB;;AACA/yE,sBAAM,CAACkzE,OAAP,CAAe,CAAC,uBAAD,CAAf,EAA0C,YAAM;AAC5C,sBAAI,OAAO,MAAI,CAACV,MAAL,CAAYY,YAAnB,KAAoC,UAAxC,EAAoD;AAChD,0BAAI,CAACZ,MAAL,CAAYY,YAAZ;AACH;;AACD,wBAAI,CAACT,UAAL,CAAgB,MAAI,CAACC,QAArB;;AACAE,yBAAO;AACV,iBAND;AAOH,eAVD,CANmC,CAiBnC;;;AACA,kBAAI,CAAC9yE,MAAM,CAACkzE,OAAZ,EAAqB;AACjB,oBAAMG,YAAY,GAAGjvE,QAAQ,CAACkwC,aAAT,CAAuB,QAAvB,CAArB;AACA++B,4BAAY,CAACxqE,IAAb,GAAoB,iBAApB;AACAwqE,4BAAY,CAAC7c,GAAb,aAAsBuc,OAAtB;AACAM,4BAAY,CAACloE,gBAAb,CAA8B,MAA9B,EAAsC8nE,cAAtC;AACA7uE,wBAAQ,CAACyL,IAAT,CAAc4J,WAAd,CAA0B45D,YAA1B;AACH,eAND,MAOK;AACDJ,8BAAc;AACjB;AACJ,aA5Ba,CAAd;AA6BH;AACJ;;;sCACa;AACV,cAAI,KAAKK,yBAAT,EAAoC;AAChC,iBAAKA,yBAAL,CAA+BC,WAA/B;AACH;;AACD,cAAI,KAAKC,OAAT,EAAkB;AACd,iBAAKA,OAAL,CAAaC,OAAb;;AACA,iBAAKD,OAAL,GAAej4C,SAAf;AACH;AACJ;;;;;;AAELg3C,cAAU,CAACmB,IAAX,GAAkB,SAASC,kBAAT,CAA4Br9E,CAA5B,EAA+B;AAAE;AAA4B,KAA/E;;AACAi8E,cAAU,CAACqB,IAAX,GAAkB,gEAAyB;AAAE/qE,UAAI,EAAE0pE,UAAR;AAAoBsB,eAAS,EAAE,SAASC,gBAAT,CAA0BC,EAA1B,EAA8BlwE,GAA9B,EAAmC;AAAE,YAAIkwE,EAAE,GAAG,CAAT,EAAY;AACnH,0EAAyB3B,GAAzB,EAA8B,IAA9B;AACH;;AAAC,YAAI2B,EAAE,GAAG,CAAT,EAAY;AACV,cAAIzvE,EAAJ;;AACA,uEAAsBA,EAAE,GAAG,2DAA3B,MAAqDT,GAAG,CAACmwE,gBAAJ,GAAuB1vE,EAAE,CAAC2vE,KAA/E;AACH;AAAE,OALoC;AAKlCC,aAAO,EAAE;AAAEzB,cAAM,EAAE;AAAV;AALyB,KAAzB,CAAlB;AAMA,6DAAW,CACP,gEAAU,iBAAV,EAA6B;AAAE,gBAAQ;AAAV,KAA7B,CADO,EAEP,yDAAW,aAAX,EAA0B,wDAA1B,CAFO,CAAX,EAGGF,UAAU,CAACnyE,SAHd,EAGyB,kBAHzB,EAG6C,KAAK,CAHlD;AAIA,6DAAW,CACP,8DADO,EAEP,yDAAW,aAAX,EAA0BD,MAA1B,CAFO,CAAX,EAGGoyE,UAAU,CAACnyE,SAHd,EAGyB,QAHzB,EAGmC,KAAK,CAHxC;AAKA,QAAM+zE,wBAAwB,GAAG,IAAI,4DAAJ,CAAmB,0BAAnB,CAAjC;AAEA,QAAIC,iBAAJ;;AACA,QAAIC,eAAe,GAAGD,iBAAiB;AAAA;;AAAA;;AACnC,+BAAYE,IAAZ,EAAkBC,YAAlB,EAAgC;AAAA;;AAAA;;AAC5B,oCAAMA,YAAN;AACA,eAAKD,IAAL,GAAYA,IAAZ;AACA,eAAKC,YAAL,GAAoBA,YAApB;AACA,eAAKC,MAAL,GAAc,EAAd;;AACA,eAAKC,eAAL,GAAuB,UAAC3lB,CAAD,EAAO,CAAG,CAAjC;;AACA,eAAK4lB,SAAL,GAAiB,YAAM,CAAG,CAA1B;;AAN4B;AAO/B;;AARkC;AAAA;AAAA,mCA0BxB/6E,KA1BwB,EA0BjB;AAAA;;AACd,eAAK66E,MAAL,GAAc76E,KAAK,IAAI,EAAvB,CADc,CAEd;;AACAwO,oBAAU,CAAC,YAAM;AACb,gBAAI,MAAI,CAACqrE,OAAL,IAAgB,CAAC,MAAI,CAAC/pD,OAAL,CAAazF,KAAlC,EAAyC;AACrC,oBAAI,CAACwvD,OAAL,CAAamB,QAAb,CAAsB,MAAI,CAACH,MAA3B;AACH;AACJ,WAJS,CAAV;AAKH;AAlCkC;AAAA;AAAA,yCAmClBj0E,EAnCkB,EAmCd;AACjB,eAAKk0E,eAAL,GAAuBl0E,EAAvB;AACH;AArCkC;AAAA;AAAA,0CAsCjBA,EAtCiB,EAsCb;AAClB,eAAKm0E,SAAL,GAAiBn0E,EAAjB;AACH;AAxCkC;AAAA;AAAA,mCAyCxBkpB,OAzCwB,EAyCf;AAAA;;AAChB,cAAMmrD,QAAQ,GAAG,CAAC,CAACnrD,OAAO,CAACzF,KAA3B;;AACA,cAAI4wD,QAAJ,EAAc;AACV,gBAAM5wD,KAAK,GAAGgvD,MAAM,CAAC6B,MAAP,CAAcC,QAAd,CAAuBrrD,OAAO,CAACzF,KAAR,CAAc+wD,GAAd,IAAqB,EAA5C,CAAd;;AACA,gBAAI/wD,KAAJ,EAAW;AACPyF,qBAAO,CAACzF,KAAR,GAAgBA,KAAhB;AACAyF,qBAAO,CAACzF,KAAR,CAAc2wD,QAAd,CAAuB,KAAKH,MAA5B;AACH,aAHD,MAIK;AACD/qD,qBAAO,CAACzF,KAAR,GAAgBgvD,MAAM,CAAC6B,MAAP,CAAcG,WAAd,CAA0BvrD,OAAO,CAACzF,KAAR,CAAcrqB,KAAxC,EAA+C8vB,OAAO,CAACzF,KAAR,CAAcixD,QAA7D,EAAuExrD,OAAO,CAACzF,KAAR,CAAc+wD,GAArF,CAAhB;AACH;AACJ;;AACD,eAAKvB,OAAL,GAAeR,MAAM,CAAC6B,MAAP,CAAclmD,MAAd,CAAqB,KAAKqlD,gBAAL,CAAsBkB,aAA3C,EAA0DzrD,OAA1D,CAAf;;AACA,cAAI,CAACmrD,QAAL,EAAe;AACX,iBAAKpB,OAAL,CAAamB,QAAb,CAAsB,KAAKH,MAA3B;AACH;;AACD,eAAKhB,OAAL,CAAa2B,uBAAb,CAAqC,UAAC5wE,CAAD,EAAO;AACxC,gBAAM5K,KAAK,GAAG,MAAI,CAAC65E,OAAL,CAAapvD,QAAb,EAAd,CADwC,CAExC;;;AACA,kBAAI,CAACkwD,IAAL,CAAUc,GAAV,CAAc,YAAM;AAChB,oBAAI,CAACX,eAAL,CAAqB96E,KAArB;;AACA,oBAAI,CAAC66E,MAAL,GAAc76E,KAAd;AACH,aAHD;AAIH,WAPD;;AAQA,eAAK65E,OAAL,CAAa6B,qBAAb,CAAmC,YAAM;AACrC,kBAAI,CAACX,SAAL;AACH,WAFD,EAxBgB,CA2BhB;;;AACA,cAAI,KAAKpB,yBAAT,EAAoC;AAChC,iBAAKA,yBAAL,CAA+BC,WAA/B;AACH;;AACD,eAAKD,yBAAL,GAAiC,uDAAUtzE,MAAV,EAAkB,QAAlB,EAA4Bs1E,SAA5B,CAAsC;AAAA,mBAAM,MAAI,CAAC9B,OAAL,CAAa+B,MAAb,EAAN;AAAA,WAAtC,CAAjC;AACA,eAAK9C,MAAL,CAAY+C,IAAZ,CAAiB,KAAKhC,OAAtB;AACH;AA1EkC;AAAA;AAAA,0BASvB/pD,OATuB,EASd;AACjB,eAAKmpD,QAAL,GAAgBzyE,MAAM,CAACs1E,MAAP,CAAc,EAAd,EAAkB,KAAKjD,MAAL,CAAYkD,cAA9B,EAA8CjsD,OAA9C,CAAhB;;AACA,cAAI,KAAK+pD,OAAT,EAAkB;AACd,iBAAKA,OAAL,CAAaC,OAAb;;AACA,iBAAKd,UAAL,CAAgBlpD,OAAhB;AACH;AACJ,SAfkC;AAAA,4BAgBrB;AACV,iBAAO,KAAKmpD,QAAZ;AACH;AAlBkC;AAAA;AAAA,0BAmBzB5uD,KAnByB,EAmBlB;AACb,eAAKyF,OAAL,CAAazF,KAAb,GAAqBA,KAArB;;AACA,cAAI,KAAKwvD,OAAT,EAAkB;AACd,iBAAKA,OAAL,CAAaC,OAAb;;AACA,iBAAKd,UAAL,CAAgB,KAAKlpD,OAArB;AACH;AACJ;AAzBkC;;AAAA;AAAA,MAAiC8oD,UAAjC,CAAvC;;AA4EA8B,mBAAe,CAACX,IAAhB,GAAuB,SAASiC,uBAAT,CAAiCr/E,CAAjC,EAAoC;AAAE,aAAO,KAAKA,CAAC,IAAI+9E,eAAV,EAA2B,gEAAyB,oDAAzB,CAA3B,EAAoE,gEAAyBF,wBAAzB,CAApE,CAAP;AAAiI,KAA9L;;AACAE,mBAAe,CAACuB,IAAhB,GAAuB,gEAAyB;AAAE/sE,UAAI,EAAEwrE,eAAR;AAAyBwB,eAAS,EAAE,CAAC,CAAC,mBAAD,CAAD,CAApC;AAA6D74C,YAAM,EAAE;AAAEvT,eAAO,EAAE,SAAX;AAAsBzF,aAAK,EAAE;AAA7B,OAArE;AAA6G8xD,cAAQ,EAAE,CAAC,iEAA0B,CAAC;AACnLC,eAAO,EAAE,gEAD0K;AAEnLC,mBAAW,EAAE,iEAAW;AAAA,iBAAM5B,iBAAN;AAAA,SAAX,CAFsK;AAGnL6B,aAAK,EAAE;AAH4K,OAAD,CAA1B,CAAD,EAItJ,wEAJsJ,CAAvH;AAIKC,WAAK,EAAE,CAJZ;AAIeC,UAAI,EAAE,CAJrB;AAIwBC,YAAM,EAAE,CAAC,CAAC,CAAD,EAAI,kBAAJ,CAAD,EAA0B,CAAC,iBAAD,EAAoB,EAApB,CAA1B,CAJhC;AAIoFC,cAAQ,EAAE,SAASC,wBAAT,CAAkCvC,EAAlC,EAAsClwE,GAAtC,EAA2C;AAAE,YAAIkwE,EAAE,GAAG,CAAT,EAAY;AAC/L,kEAAiB,CAAjB,EAAoB,KAApB,EAA2B,CAA3B,EAA8B,CAA9B;AACH;AAAE,OANyC;AAMvCwC,YAAM,EAAE,CAAC,qKAAD;AAN+B,KAAzB,CAAvB;;AAOAlC,mBAAe,CAACmC,cAAhB,GAAiC;AAAA,aAAM,CACnC;AAAE3tE,YAAI,EAAE;AAAR,OADmC,EAEnC;AAAEA,YAAI,EAAE0yB,SAAR;AAAmBk7C,kBAAU,EAAE,CAAC;AAAE5tE,cAAI,EAAE,oDAAR;AAAgBie,cAAI,EAAE,CAACqtD,wBAAD;AAAtB,SAAD;AAA/B,OAFmC,CAAN;AAAA,KAAjC;;AAIA,6DAAW,CACP,4DAAM,SAAN,CADO,EAEP,yDAAW,aAAX,EAA0Bh0E,MAA1B,CAFO,EAGP,yDAAW,mBAAX,EAAgC,CAACA,MAAD,CAAhC,CAHO,CAAX,EAIGk0E,eAAe,CAACj0E,SAJnB,EAI8B,SAJ9B,EAIyC,IAJzC;AAKA,6DAAW,CACP,4DAAM,OAAN,CADO,EAEP,yDAAW,aAAX,EAA0BD,MAA1B,CAFO,EAGP,yDAAW,mBAAX,EAAgC,CAACA,MAAD,CAAhC,CAHO,CAAX,EAIGk0E,eAAe,CAACj0E,SAJnB,EAI8B,OAJ9B,EAIuC,IAJvC;AAKAi0E,mBAAe,GAAGD,iBAAiB,GAAG,yDAAW,CAAE,sDAAQ,CAAR,EAAW,6DAAOD,wBAAP,CAAX,CAAF,EAC7C,yDAAW,mBAAX,EAAgC,CAAC,oDAAD,EAASh0E,MAAT,CAAhC,CAD6C,CAAX,EAEnCk0E,eAFmC,CAAtC;;AAIA,QAAIqC,mBAAmB;AAAA;;AAAA;;AACnB,mCAAYnC,YAAZ,EAA0B;AAAA;;AAAA;;AACtB,oCAAMA,YAAN;AACA,eAAKA,YAAL,GAAoBA,YAApB;AAFsB;AAGzB;;AAJkB;AAAA;AAAA,mCA6BR9qD,OA7BQ,EA6BC;AAAA;;AAChB,cAAI,CAAC,KAAKktD,cAAN,IAAwB,CAAC,KAAKC,cAAlC,EAAkD;AAC9C,kBAAM,IAAI3pB,KAAJ,CAAU,qEAAV,CAAN;AACH;;AACD,eAAK0pB,cAAL,CAAoB1B,QAApB,GAA+B,KAAK0B,cAAL,CAAoB1B,QAApB,IAAgCxrD,OAAO,CAACwrD,QAAvE;AACA,eAAK2B,cAAL,CAAoB3B,QAApB,GAA+B,KAAK2B,cAAL,CAAoB3B,QAApB,IAAgCxrD,OAAO,CAACwrD,QAAvE;AACA,cAAI4B,aAAa,GAAG7D,MAAM,CAAC6B,MAAP,CAAcG,WAAd,CAA0B,KAAK2B,cAAL,CAAoBG,IAA9C,EAAoD,KAAKH,cAAL,CAAoB1B,QAAxE,CAApB;AACA,cAAI8B,aAAa,GAAG/D,MAAM,CAAC6B,MAAP,CAAcG,WAAd,CAA0B,KAAK4B,cAAL,CAAoBE,IAA9C,EAAoD,KAAKF,cAAL,CAAoB3B,QAAxE,CAApB;AACA,eAAKjB,gBAAL,CAAsBkB,aAAtB,CAAoCna,SAApC,GAAgD,EAAhD;AACA,cAAMic,KAAK,GAAGvtD,OAAO,CAACutD,KAAtB;AACA,eAAKxD,OAAL,GAAeR,MAAM,CAAC6B,MAAP,CAAcoC,gBAAd,CAA+B,KAAKjD,gBAAL,CAAsBkB,aAArD,EAAoEzrD,OAApE,CAAf;AACAA,iBAAO,CAACutD,KAAR,GAAgBA,KAAhB;;AACA,eAAKxD,OAAL,CAAa0D,QAAb,CAAsB;AAClBC,oBAAQ,EAAEN,aADQ;AAElBO,oBAAQ,EAAEL;AAFQ,WAAtB,EAZgB,CAgBhB;;;AACA,cAAI,KAAKzD,yBAAT,EAAoC;AAChC,iBAAKA,yBAAL,CAA+BC,WAA/B;AACH;;AACD,eAAKD,yBAAL,GAAiC,uDAAUtzE,MAAV,EAAkB,QAAlB,EAA4Bs1E,SAA5B,CAAsC;AAAA,mBAAM,MAAI,CAAC9B,OAAL,CAAa+B,MAAb,EAAN;AAAA,WAAtC,CAAjC;AACA,eAAK9C,MAAL,CAAY+C,IAAZ,CAAiB,KAAKhC,OAAtB;AACH;AAnDkB;AAAA;AAAA,0BAKP/pD,OALO,EAKE;AACjB,eAAKmpD,QAAL,GAAgBzyE,MAAM,CAACs1E,MAAP,CAAc,EAAd,EAAkB,KAAKjD,MAAL,CAAYkD,cAA9B,EAA8CjsD,OAA9C,CAAhB;;AACA,cAAI,KAAK+pD,OAAT,EAAkB;AACd,iBAAKA,OAAL,CAAaC,OAAb;;AACA,iBAAKd,UAAL,CAAgBlpD,OAAhB;AACH;AACJ,SAXkB;AAAA,4BAYL;AACV,iBAAO,KAAKmpD,QAAZ;AACH;AAdkB;AAAA;AAAA,0BAeD5uD,KAfC,EAeM;AACrB,eAAK2yD,cAAL,GAAsB3yD,KAAtB;;AACA,cAAI,KAAKwvD,OAAT,EAAkB;AACd,iBAAKA,OAAL,CAAaC,OAAb;;AACA,iBAAKd,UAAL,CAAgB,KAAKlpD,OAArB;AACH;AACJ;AArBkB;AAAA;AAAA,0BAsBDzF,KAtBC,EAsBM;AACrB,eAAK4yD,cAAL,GAAsB5yD,KAAtB;;AACA,cAAI,KAAKwvD,OAAT,EAAkB;AACd,iBAAKA,OAAL,CAAaC,OAAb;;AACA,iBAAKd,UAAL,CAAgB,KAAKlpD,OAArB;AACH;AACJ;AA5BkB;;AAAA;AAAA,MAAqC8oD,UAArC,CAAvB;;AAqDAmE,uBAAmB,CAAChD,IAApB,GAA2B,SAAS2D,2BAAT,CAAqC/gF,CAArC,EAAwC;AAAE,aAAO,KAAKA,CAAC,IAAIogF,mBAAV,EAA+B,gEAAyBvC,wBAAzB,CAA/B,CAAP;AAA4F,KAAjK;;AACAuC,uBAAmB,CAACd,IAApB,GAA2B,gEAAyB;AAAE/sE,UAAI,EAAE6tE,mBAAR;AAA6Bb,eAAS,EAAE,CAAC,CAAC,wBAAD,CAAD,CAAxC;AAAsE74C,YAAM,EAAE;AAAEvT,eAAO,EAAE,SAAX;AAAsBotD,qBAAa,EAAE,eAArC;AAAsDE,qBAAa,EAAE;AAArE,OAA9E;AAAsKjB,cAAQ,EAAE,CAAC,wEAAD,CAAhL;AAAqNI,WAAK,EAAE,CAA5N;AAA+NC,UAAI,EAAE,CAArO;AAAwOC,YAAM,EAAE,CAAC,CAAC,CAAD,EAAI,kBAAJ,CAAD,EAA0B,CAAC,iBAAD,EAAoB,EAApB,CAA1B,CAAhP;AAAoSC,cAAQ,EAAE,SAASiB,4BAAT,CAAsCvD,EAAtC,EAA0ClwE,GAA1C,EAA+C;AAAE,YAAIkwE,EAAE,GAAG,CAAT,EAAY;AACvZ,kEAAiB,CAAjB,EAAoB,KAApB,EAA2B,CAA3B,EAA8B,CAA9B;AACH;AAAE,OAF6C;AAE3CwC,YAAM,EAAE,CAAC,qKAAD;AAFmC,KAAzB,CAA3B;;AAGAG,uBAAmB,CAACF,cAApB,GAAqC;AAAA,aAAM,CACvC;AAAE3tE,YAAI,EAAE0yB,SAAR;AAAmBk7C,kBAAU,EAAE,CAAC;AAAE5tE,cAAI,EAAE,oDAAR;AAAgBie,cAAI,EAAE,CAACqtD,wBAAD;AAAtB,SAAD;AAA/B,OADuC,CAAN;AAAA,KAArC;;AAGA,6DAAW,CACP,4DAAM,SAAN,CADO,EAEP,yDAAW,aAAX,EAA0Bh0E,MAA1B,CAFO,EAGP,yDAAW,mBAAX,EAAgC,CAACA,MAAD,CAAhC,CAHO,CAAX,EAIGu2E,mBAAmB,CAACt2E,SAJvB,EAIkC,SAJlC,EAI6C,IAJ7C;AAKA,6DAAW,CACP,4DAAM,eAAN,CADO,EAEP,yDAAW,aAAX,EAA0BD,MAA1B,CAFO,EAGP,yDAAW,mBAAX,EAAgC,CAACA,MAAD,CAAhC,CAHO,CAAX,EAIGu2E,mBAAmB,CAACt2E,SAJvB,EAIkC,eAJlC,EAImD,IAJnD;AAKA,6DAAW,CACP,4DAAM,eAAN,CADO,EAEP,yDAAW,aAAX,EAA0BD,MAA1B,CAFO,EAGP,yDAAW,mBAAX,EAAgC,CAACA,MAAD,CAAhC,CAHO,CAAX,EAIGu2E,mBAAmB,CAACt2E,SAJvB,EAIkC,eAJlC,EAImD,IAJnD;AAKAs2E,uBAAmB,GAAG,yDAAW,CAAE,sDAAQ,CAAR,EAAW,6DAAOvC,wBAAP,CAAX,CAAF,EAC7B,yDAAW,mBAAX,EAAgC,CAACh0E,MAAD,CAAhC,CAD6B,CAAX,EAEnBu2E,mBAFmB,CAAtB;AAIA,QAAIa,oBAAJ;;AACA,QAAIC,kBAAkB,GAAGD,oBAAoB;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA,kCACb;AAAA,cAAb/E,MAAa,uEAAJ,EAAI;AACxB,iBAAO;AACHiF,oBAAQ,EAAEF,oBADP;AAEHG,qBAAS,EAAE,CACP;AAAE3B,qBAAO,EAAE5B,wBAAX;AAAqCwD,sBAAQ,EAAEnF;AAA/C,aADO;AAFR,WAAP;AAMH;AARwC;;AAAA;AAAA,OAA7C;;AAUAgF,sBAAkB,CAACI,IAAnB,GAA0B,+DAAwB;AAAE/uE,UAAI,EAAE2uE;AAAR,KAAxB,CAA1B;AACAA,sBAAkB,CAACK,IAAnB,GAA0B,+DAAwB;AAAEC,aAAO,EAAE,SAASC,0BAAT,CAAoCzhF,CAApC,EAAuC;AAAE,eAAO,KAAKA,CAAC,IAAIkhF,kBAAV,GAAP;AAAyC,OAA7F;AAA+FQ,aAAO,EAAE,CAAC,CAC/I,4DAD+I,CAAD;AAAxG,KAAxB,CAA1B;AAIA;;AAAc,KAAC,YAAY;AAAE,sEAAyB3D,eAAzB,EAA0C,CAAC;AAChExrE,YAAI,EAAE,uDAD0D;AAEhEie,YAAI,EAAE,CAAC;AACCljB,kBAAQ,EAAE,mBADX;AAECyyE,kBAAQ,EAAE,uDAFX;AAGCqB,mBAAS,EAAE,CAAC;AACJ3B,mBAAO,EAAE,gEADL;AAEJC,uBAAW,EAAE,iEAAW;AAAA,qBAAM5B,iBAAN;AAAA,aAAX,CAFT;AAGJ6B,iBAAK,EAAE;AAHH,WAAD,CAHZ;AAQCM,gBAAM,EAAE;AART,SAAD;AAF0D,OAAD,CAA1C,EAsBrB,YAAY;AAAE,eAAO,CAAC;AAAE1tE,cAAI,EAAE;AAAR,SAAD,EAA0B;AAAEA,cAAI,EAAE0yB,SAAR;AAAmBk7C,oBAAU,EAAE,CAAC;AACvE5tE,gBAAI,EAAE,oDADiE;AAEvEie,gBAAI,EAAE,CAACqtD,wBAAD;AAFiE,WAAD;AAA/B,SAA1B,CAAP;AAGF,OAzBS,EAyBP;AAAE1qD,eAAO,EAAE,CAAC;AACtB5gB,cAAI,EAAE,mDADgB;AAEtBie,cAAI,EAAE,CAAC,SAAD;AAFgB,SAAD,CAAX;AAGV9C,aAAK,EAAE,CAAC;AACRnb,cAAI,EAAE,mDADE;AAERie,cAAI,EAAE,CAAC,OAAD;AAFE,SAAD;AAHG,OAzBO;AA+Bb,KA/BF;AAgCd;;;AAAc,KAAC,YAAY;AAAE,sEAAyB4vD,mBAAzB,EAA8C,CAAC;AACpE7tE,YAAI,EAAE,uDAD8D;AAEpEie,YAAI,EAAE,CAAC;AACCljB,kBAAQ,EAAE,wBADX;AAECyyE,kBAAQ,EAAE,uDAFX;AAGCE,gBAAM,EAAE;AAHT,SAAD;AAF8D,OAAD,CAA9C,EAiBrB,YAAY;AAAE,eAAO,CAAC;AAAE1tE,cAAI,EAAE0yB,SAAR;AAAmBk7C,oBAAU,EAAE,CAAC;AAC9C5tE,gBAAI,EAAE,oDADwC;AAE9Cie,gBAAI,EAAE,CAACqtD,wBAAD;AAFwC,WAAD;AAA/B,SAAD,CAAP;AAGF,OApBS,EAoBP;AAAE1qD,eAAO,EAAE,CAAC;AACtB5gB,cAAI,EAAE,mDADgB;AAEtBie,cAAI,EAAE,CAAC,SAAD;AAFgB,SAAD,CAAX;AAGV+vD,qBAAa,EAAE,CAAC;AAChBhuE,cAAI,EAAE,mDADU;AAEhBie,cAAI,EAAE,CAAC,eAAD;AAFU,SAAD,CAHL;AAMViwD,qBAAa,EAAE,CAAC;AAChBluE,cAAI,EAAE,mDADU;AAEhBie,cAAI,EAAE,CAAC,eAAD;AAFU,SAAD;AANL,OApBO;AA6Bb,KA7BF;;AA8Bd,KAAC,YAAY;AAAE,OAAC,OAAOmxD,SAAP,KAAqB,WAArB,IAAoCA,SAArC,KAAmD,iEAA0BT,kBAA1B,EAA8C;AAAEU,oBAAY,EAAE,wBAAY;AAAE,iBAAO,CAAC7D,eAAD,EAC7IqC,mBAD6I,CAAP;AAC/G,SADiF;AAC/EsB,eAAO,EAAE,mBAAY;AAAE,iBAAO,CAAC,4DAAD,CAAP;AAAwB,SADgC;AAC9Bl4E,eAAO,EAAE,mBAAY;AAAE,iBAAO,CAACu0E,eAAD,EACxGqC,mBADwG,CAAP;AAC1E;AAFiF,OAA9C,CAAnD;AAEsB,KAFrC;AAGA;;;AAAc,KAAC,YAAY;AAAE,sEAAyBc,kBAAzB,EAA6C,CAAC;AACnE3uE,YAAI,EAAE,sDAD6D;AAEnEie,YAAI,EAAE,CAAC;AACCkxD,iBAAO,EAAE,CACL,4DADK,CADV;AAICE,sBAAY,EAAE,CACV7D,eADU,EAEVqC,mBAFU,CAJf;AAQC52E,iBAAO,EAAE,CACLu0E,eADK,EAELqC,mBAFK;AARV,SAAD;AAF6D,OAAD,CAA7C,EAerB,IAfqB,EAef,IAfe;AAeP,KAfR;AAiBd;;;;AAIA;;;AAMA;;;;;;;;;;;;;;;;;;ACtXA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;QAOayB,yB;AAEX,2CAAc;AAAA;AAAG;;;;mCAET,CACP;;;;;;;uBALUA,yB;AAAyB,K;;;YAAzBA,yB;AAAyB,6C;AAAA,c;AAAA,a;AAAA,+I;AAAA;AAAA;ACPtC;;AACE;;AACE;;AACE;;AACF;;AACF;;AACF;;;;AAH6B;;AAAA;;;;;;;;;sEDIhBA,yB,EAAyB;cALrC,uDAKqC;eAL3B;AACTv0E,kBAAQ,EAAE,wBADD;AAETw0E,qBAAW,EAAE,qCAFJ;AAGTC,mBAAS,EAAE,CAAC,qCAAD;AAHF,S;AAK2B,Q;;;;;;;;;;;;;;;;;;;;AEPtC;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;QAOaC,qB;AAEX,uCAAc;AAAA;AAAG;;;;mCAET,CACP;;;;;;;uBALUA,qB;AAAqB,K;;;YAArBA,qB;AAAqB,wC;AAAA,c;AAAA,a;AAAA,+I;AAAA;AAAA;ACPlC;;AACE;;AACE;;AACE;;AACF;;AACF;;AACF;;;;AAH6B;;AAAA;;;;;;;;;sEDIhBA,qB,EAAqB;cALjC,uDAKiC;eALvB;AACT10E,kBAAQ,EAAE,mBADD;AAETw0E,qBAAW,EAAE,gCAFJ;AAGTC,mBAAS,EAAE,CAAC,gCAAD;AAHF,S;AAKuB,Q;;;;;;;;;;;;;;;;;;;;AEPlC;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;QAOaE,0B;AAEX,4CAAc;AAAA;AAAG;;;;mCAET,CACP;;;;;;;uBALUA,0B;AAA0B,K;;;YAA1BA,0B;AAA0B,8C;AAAA,c;AAAA,a;AAAA,+I;AAAA;AAAA;ACPvC;;AACE;;AACE;;AACE;;AACF;;AACF;;AACF;;;;AAH6B;;AAAA;;;;;;;;;sEDIhBA,0B,EAA0B;cALtC,uDAKsC;eAL5B;AACT30E,kBAAQ,EAAE,yBADD;AAETw0E,qBAAW,EAAE,sCAFJ;AAGTC,mBAAS,EAAE,CAAC,sCAAD;AAHF,S;AAK4B,Q;;;;;;;;;;;;;;;;;;;;AEPvC;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;QAOaG,mB;AAEX,qCAAc;AAAA;AAAG;;;;mCAET,CACP;;;;;;;uBALUA,mB;AAAmB,K;;;YAAnBA,mB;AAAmB,sC;AAAA,c;AAAA,a;AAAA,4J;AAAA;AAAA;ACPhC;;AACE;;AAAwD;;AAAmB;;AAC3E;;AAAwD;;AAAM;;AAC9D;;AACE;;AAA8D;;AAAoC;;AAAW;;AAC/G;;AACF;;;;;;;;;sEDCaA,mB,EAAmB;cAL/B,uDAK+B;eALrB;AACT50E,kBAAQ,EAAE,iBADD;AAETw0E,qBAAW,EAAE,8BAFJ;AAGTC,mBAAS,EAAE,CAAC,8BAAD;AAHF,S;AAKqB,Q;;;;;;;;;;;;;;;;;;;;AEPhC;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;QAOaI,wB;AAEX,0CAAc;AAAA;AAAG;;;;mCAET,CACP;;;;;;;uBALUA,wB;AAAwB,K;;;YAAxBA,wB;AAAwB,2C;AAAA,c;AAAA,a;AAAA;AAAA;ACPrC;;AAAG;;AAAuB;;;;;;;;sEDObA,wB,EAAwB;cALpC,uDAKoC;eAL1B;AACT70E,kBAAQ,EAAE,sBADD;AAETw0E,qBAAW,EAAE,mCAFJ;AAGTC,mBAAS,EAAE,CAAC,mCAAD;AAHF,S;AAK0B,Q;;;;;;;;;;;;;;;;;;;;AEPrC;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;AAaA,QAAMK,MAAM,GAAW,CACrB;AACE9zE,UAAI,EAAE,EADR;AAEEgnB,eAAS,EAAE,iEAFb;AAGE7lB,cAAQ,EAAE,CACR;AACEnB,YAAI,EAAE,EADR;AAEE+zE,iBAAS,EAAE,MAFb;AAGEC,kBAAU,EAAE;AAHd,OADQ,EAMR;AACEh0E,YAAI,EAAE,MADR;AAEEgnB,iBAAS,EAAE;AAFb,OANQ,EAUR;AACEhnB,YAAI,EAAE,QADR;AAEEgnB,iBAAS,EAAE;AAFb,OAVQ,EAcR;AACEhnB,YAAI,EAAE,WADR;AAEEgnB,iBAAS,EAAE;AAFb,OAdQ,EAkBR;AACEhnB,YAAI,EAAE,aADR;AAEEgnB,iBAAS,EAAE;AAFb,OAlBQ,EAsBR;AACEhnB,YAAI,EAAE,cADR;AAEEgnB,iBAAS,EAAE;AAFb,OAtBQ,EA0BR;AACEhnB,YAAI,EAAE,sBADR;AAEEgnB,iBAAS,EAAE;AAFb,OA1BQ;AAHZ,KADqB,EAoCrB;AACEhnB,UAAI,EAAE,MADR;AAEEgnB,eAAS,EAAE;AAFb,KApCqB,CAAvB;;QA+CaitD,mB;;;;;YAAAA;;;;yBAAAA,mB;AAAmB,O;AAAA,gBAHrB,CAAC,6DAAaC,QAAb,CAAsBJ,MAAtB,CAAD,CAGqB,EAFpB,4DAEoB;;;;0HAAnBG,mB,EAAmB;AAAA;AAAA,kBAFpB,4DAEoB;AAAA,O;AAFR,K;;;;;sEAEXA,mB,EAAmB;cAJ/B,sDAI+B;eAJtB;AACRb,iBAAO,EAAE,CAAC,6DAAac,QAAb,CAAsBJ,MAAtB,CAAD,CADD;AAER54E,iBAAO,EAAE,CAAC,4DAAD;AAFD,S;AAIsB,Q;;;;;;;;;;;;;;;;;;AC5DhC;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;;;;;AC6BI;;AACE;;AACF;;;;;;AAMM;;AAOE;;AACE;;AACE;;AACF;;AACA;;AACE;;AACF;;AACF;;AACF;;;;;;AAbE;;AAOc;;AAAA;;AAGV;;AAAA;;;;;;AAbR;;AACE;;AAiBF;;;;;;AAhBI;;AAAA;;;;;;AAmBF;;AAOE;;AACE;;AACE;;AACF;;AACA;;AACE;;AACF;;AACF;;AACF;;;;;;AAbE;;AAOc;;AAAA;;AAGV;;AAAA;;;;;;AAbR;;AACE;;AAiBF;;;;;;AAhBI;;AAAA;;;;;;AA6BJ;;AACE;;AACF;;;;;;AADyB;;AAAA;;;;QDrEpBi5E,6B;AAkCX,6CACUC,WADV,EAEUC,WAFV,EAGUC,cAHV,EAIUC,WAJV,EAKUC,WALV,EAKsC;AAAA;;AAJ5B,aAAAJ,WAAA,GAAAA,WAAA;AACA,aAAAC,WAAA,GAAAA,WAAA;AACA,aAAAC,cAAA,GAAAA,cAAA;AACA,aAAAC,WAAA,GAAAA,WAAA;AACA,aAAAC,WAAA,GAAAA,WAAA;AArCV,aAAAC,aAAA,GAAgB;AAACrC,eAAK,EAAE,SAAR;AAAmB/B,kBAAQ,EAAE;AAA7B,SAAhB;AACA,aAAA6B,IAAA,GAAc,iDAAd;AAEA,aAAAwC,SAAA,GAAY,EAAZ;AASA,aAAAC,KAAA,GAAQ,EAAR;AAIA,aAAA7lD,IAAA,GAAO,IAAP;AAEA,aAAA8lD,OAAA,GAAmB,IAAnB;AAOA,aAAAxkD,WAAA,GAAc,EAAd;AAEA,aAAAykD,cAAA,GAA0B,KAA1B;AACA,aAAAC,WAAA,GAAmB,IAAnB;AAYC;;;;mCAEO;AAAA;;AAEN,eAAKN,WAAL,CAAiBO,eAAjB,CAAiCrE,SAAjC,CAA4C,UAAAh/E,CAAC,EAAI;AAC/C8F,mBAAO,CAACC,GAAR,CAAY/F,CAAZ;AACA,kBAAI,CAACmjF,cAAL,GAAsBnjF,CAAtB;AACD,WAHD;AAKA,eAAK8iF,WAAL,CAAiBQ,kBAAjB,CAAoCtE,SAApC,CAA+C,UAAAv+E,CAAC,EAAI;AAClD,kBAAI,CAAC2iF,WAAL,GAAmB3iF,CAAnB;AACD,WAFD;AAIF,eAAK8iF,OAAL,GAAe,KAAKb,WAAL,CAAiBc,QAAjB,CAA0B,QAA1B,EAAoC,EAApC,EACbC,IADa,CAEb,2DAAI,UAAEr8E,CAAF;AAAA,mBAAwBA,CAAC,CAAC87C,IAA1B;AAAA,WAAJ,CAFa,CAAf;AAKE,eAAK0/B,cAAL,CAAoBjtE,MAApB,CAA2BqpE,SAA3B,CAAsC,UAAAt6E,CAAC,EAAI;AACzCoB,mBAAO,CAACC,GAAR,CAAYrB,CAAZ;AACA,kBAAI,CAACg/E,QAAL,GAAgBh/E,CAAC,CAACsmB,EAAlB;AACD,WAHD,EAhBM,CAqBN;AAIA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;;AAEAllB,iBAAO,CAACC,GAAR,CAAY,KAAK29E,QAAjB;AACA,eAAKhB,WAAL,CAAiBiB,WAAjB,CAA6B,iBAA7B,EAAgD;AAC9CC,2BAAe,YAAK,KAAKF,QAAV,CAD+B;AAE9C5+D,iBAAK,EAAE;AAFuC,WAAhD,EAICs3D,IAJD,CAIO,UAAAyH,GAAG,EAAI;AAGZ/9E,mBAAO,CAACC,GAAR,CAAY,4BAAZ;AACAD,mBAAO,CAACC,GAAR,CAAY89E,GAAZ;AAEA,gBAAIC,SAAS,GAAG,EAAhB;AACAD,eAAG,CAAC3gC,IAAJ,CAASowB,OAAT,CAAkB,UAAAvyE,CAAC,EAAI;AACrB;AACA+E,qBAAO,CAACC,GAAR,CAAYhF,CAAZ;AACAA,eAAC,CAACiqB,EAAF,GAAOjqB,CAAC,CAACm4C,GAAT;;AAEA,oBAAI,CAAC+pC,KAAL,CAAWt+E,IAAX,CAAgB5D,CAAhB;;AAEA+E,qBAAO,CAACC,GAAR,CAAYhF,CAAZ;AAKD,aAZD;AAcD,WAzBD,EA0BCq7E,IA1BD,CA0BO,YAAM;AACX;AACA,kBAAI,CAAC0G,WAAL,CAAiBiB,YAAjB,CAA8B/E,SAA9B,CAAwC,UAACgF,MAAD,EAAY;AAClD,oBAAI,CAACC,qBAAL,GAA6B,MAAI,CAACnB,WAAL,CAAiBmB,qBAA9C;AACA,oBAAI,CAACC,uBAAL,GAA+B,MAAI,CAACpB,WAAL,CAAiBoB,uBAAhD;;AACA,oBAAI,CAACpB,WAAL,CAAiBqB,mBAAjB;AACD,aAJD,EAFW,CAQX;AACA;AACA;AACA;AACA;AAEA;AACA;;;AAEA,kBAAI,CAACjB,OAAL,GAAe,KAAf;AAEAp9E,mBAAO,CAACC,GAAR,CAAY,eAAZ;AACAD,mBAAO,CAACC,GAAR,CAAY,MAAI,CAACk9E,KAAjB;;AACA,kBAAI,CAACD,SAAL,CAAer+E,IAAf,CAAoB,CAAC,MAAI,CAACs+E,KAAN,CAApB;;AACA,kBAAI,CAACH,WAAL,CAAiBsB,wBAAjB,CAA0C,MAAI,CAACpB,SAAL,CAAe,CAAf,CAA1C;;AACA,kBAAI,CAACiB,qBAAL,GAA6B,MAAI,CAACA,qBAAlC;AACA,kBAAI,CAACC,uBAAL,GAA+B,MAAI,CAACD,qBAAL,CAA2B,CAA3B,EAA8B,CAA9B,EAAiCj5D,EAAhE;AACD,WAnDD;AAyDD;;;0CAEiB,CAEhB;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AAKA;AACA;AACA;AACA;AACA;AACA;AAED;;;0CAMiB;AAAA;;AAChB,eAAK03D,WAAL,CAAiB2B,SAAjB,CAA2B,WAA3B,EAAwC,KAAKX,QAA7C,EACGtH,IADH,CACS,UAAAkI,EAAE,EAAI;AACX,gBAAGA,EAAE,CAACC,gBAAN,EAAwB;AACtBD,gBAAE,CAACC,gBAAH,CAAoBjR,OAApB,CAA6B,UAAA9yE,CAAC,EAAI;AAChC,sBAAI,CAACmiF,WAAL,CAAiB95C,aAAjB,CAA+BroC,CAA/B;AACD,eAFD;AAGD;AAEF,WARH;AASD;;;uCAEc,CAEd;;;uCAEcwO,K,EAAY;AACzBlJ,iBAAO,CAACC,GAAR,CAAYiJ,KAAZ;AACD;;;;;;;uBA1LUyzE,6B,EAA6B,wI,EAAA,0H,EAAA,+H,EAAA,wI,EAAA,kI;AAAA,K;;;YAA7BA,6B;AAA6B,iD;AAAA;AAAA;+EAgCZ,8D;;;;;;;;;;;;;;ACnD9B;;AACE;;AACE;;AAEE;;AACE;;AACE;;AACA;;AACE;;AACF;;AAIF;;AACF;;AAGA;;AACE;;AAAuC;AAAA,mBAAS,IAAA+B,YAAA,EAAT;AAAuB,WAAvB;;AAA0B;;AAAI;;AACvE;;AAEF;;AAEF;;AAGA;;AAGE;;AAKA;;AACE;;AACE;;;;AAoBA;;;;AAmBF;;AAEA;;AAGE;;AAGF;;AAEA;;AAEE;;AAGF;;AACF;;AAGF;;AAEF;;;;AAnES;;AAAA;;AAO2D;;AAAA;;AAoBA;;AAAA;;AAwBlC;;AAAA;;AAOS;;AAAA;;;;;;;;;;sEDpE9B/B,6B,EAA6B;cALzC,uDAKyC;eAL/B;AACTn1E,kBAAQ,EAAE,4BADD;AAETw0E,qBAAW,EAAE,yCAFJ;AAGTC,mBAAS,EAAE,CAAC,yCAAD;AAHF,S;AAK+B,Q;;;;;;;;;;;;;;gBAgCvC,uD;iBAAU,O,EAAS;AAAE0C,gBAAI,EAAE;AAAR,W;;;;;;;;;;;;;;;;;;;;AEnDtB;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;;;;;ACCC;;AACG;;AAAM;AAAA;;AAAA;;AAAA;AAAA,WAA6C,WAA7C,EAA6C;AAAA;;AAAA;;AAAA;AAAA,SAA7C,EAA6C,SAA7C,EAA6C;AAAA;;AAAA;;AAAA;AAAA,SAA7C;;AAKF;;AAA8D;AAAA;;AAAA;;AAAA;AAAA;;AAAgC;;AAC9F;;AAAyC;AAAA;;AAAA;;AAAA;AAAA,WAA6C,OAA7C,EAA6C;AAAA;;AAAA;;AAAA;AAAA,SAA7C;;AACvC;;AACE;;AACA;;AACE;;AACF;;AACF;;AACF;;AACJ;;AAEF;;;;;;AAhBmJ;;AAAA;;AAQ/H;;AAAA;;AAER;;AAAA;;;;;;;;AAOZ;;AACI;;AAAK;AAAA;;AAAA;;AAAA;AAAA,WAA6C,WAA7C,EAA6C;AAAA;;AAAA;;AAAA;AAAA,SAA7C,EAA6C,SAA7C,EAA6C;AAAA;;AAAA;;AAAA;AAAA,SAA7C;;AACD;;AAAwB;AAAA;;AAAA;;AAAA;AAAA,WAA2C,YAA3C,EAA2C;AAAA;;AAAA;;AAAA;AAAA,SAA3C;;AAExB;;AACA;;AAAiD;AAAA;;AAAA;;AAAA;AAAA;;AAAgC;;AACjF;;AAAyC;AAAA;;AAAA;;AAAA;AAAA,WAA6C,OAA7C,EAA6C;AAAA;;AAAA;;AAAA;AAAA,SAA7C;;AACvC;;AACE;;AACA;;AACE;;AACF;;AACF;;AACF;;AACJ;;AACJ;;;;;;AAdoJ;;AAAA;;AAO9H;;AAAA;;AAER;;AAAA;;;;;;AAQR;;;;;;AAA4D;;;;;;;;AAC5D;;AACI;;AAAK;AAAA;;AAAA;;AAAA;;AAAA;AAAA,WAA4C,YAA5C,EAA4C;AAAA;;AAAA;;AAAA;;AAAA;AAAA,SAA5C,EAA4C,OAA5C,EAA4C;AAAA;;AAAA;;AAAA;;AAAA;AAAA,SAA5C,EAA4C,WAA5C,EAA4C;AAAA;;AAAA;;AAAA;;AAAA;AAAA,SAA5C,EAA4C,SAA5C,EAA4C;AAAA;;AAAA;;AAAA;;AAAA;AAAA,SAA5C;;AACD;;AAAwB;AAAA;;AAAA;;AAAA;;AAAA;AAAA,WAA4C,YAA5C,EAA4C;AAAA;;AAAA;;AAAA;;AAAA;AAAA,SAA5C;;AAExB;;AAEF;;AAAyC;AAAA;;AAAA;;AAAA;;AAAA;AAAA,WAA8C,OAA9C,EAA8C;AAAA;;AAAA;;AAAA;;AAAA;AAAA,SAA9C;;AACvC;;AACE;;AACA;;AACE;;AACF;;AACF;;AACF;;AACF;;AACJ;;;;;;;;AAdoP;;AAAA;;AAOhO;;AAAA;;AAER;;AAAA;;;;;;AAZhB;;AACI;;AACA;;AAgBF;;;;;;AAjB4B;;AAAA;;AACL;;AAAA;;;;;;AAH5B;;AACG;;AAmBF;;;;;;AAnBuC;;AAAA;;;;QD1B5BC,2B;AAgBX,2CACU5B,WADV,EAEUJ,WAFV,EAGUE,cAHV,EAGwC;AAAA;;AAAA;;AAF9B,aAAAE,WAAA,GAAAA,WAAA;AACA,aAAAJ,WAAA,GAAAA,WAAA;AACA,aAAAE,cAAA,GAAAA,cAAA;AAVV,aAAA+B,KAAA,GAAQ,CAAR;AAaE,aAAK/B,cAAL,CAAoBjtE,MAApB,CAA2BqpE,SAA3B,CAAqC,UAAAt6E,CAAC,EAAI;AACxC,iBAAI,CAACg/E,QAAL,GAAgBh/E,CAAC,CAACsmB,EAAlB;AACD,SAFD;AAIA,aAAK83D,WAAL,CAAiB8B,mBAAjB,CAAqC5F,SAArC,CAA+C,UAACgF,MAAD,EAAY;AACzD,iBAAI,CAACa,gBAAL,GAAwB/B,WAAW,CAACgC,iBAApC;AACD,SAFD;AAGA,aAAKhC,WAAL,CAAiBiC,iBAAjB,CAAmC/F,SAAnC,CAA6C,UAACgF,MAAD,EAAY;AACvD,iBAAI,CAACgB,mBAAL,GAA2BlC,WAAW,CAACkC,mBAAvC;AACD,SAFD;AAGA,aAAKH,gBAAL,GAAwB,EAAxB;AACD;;;;mCAEO,CACP;;;2CAGkBvS,I,EAAM;AACvB,eAAKwQ,WAAL,CAAiBmC,WAAjB,CAA6B3S,IAA7B;AACD;;;wCAGetnD,E,EAAI;AAClB,iBAAO,KAAKg6D,mBAAL,KAA6Bh6D,EAApC;AACD;;;oCAEWA,E,EAAI;AACd,eAAK83D,WAAL,CAAiBoC,eAAjB,CAAiCl6D,EAAjC;AACD;;;kCAESm6D,M,EAAgBC,Y,EAAcp2E,K,EAAO;AAC7C;AACA,cAAIA,KAAK,CAAC7C,MAAN,CAAa6e,EAAb,KAAoB,cAAxB,EAAwC;AACtC,iBAAKq6D,UAAL,GAAkBr2E,KAAK,CAACxC,OAAxB;AACA,iBAAK84E,UAAL,GAAkBt2E,KAAK,CAACvC,OAAxB;AACD;AACF;;;gCAEO04E,M,EAAgBC,Y,EAAcp2E,K,EAAO;AAC3C,cAAIA,KAAK,CAAC7C,MAAN,CAAa6e,EAAb,KAAoB,cAApB,IAAsChc,KAAK,CAAC7C,MAAN,CAAa6e,EAAb,KAAoB,WAA9D,EAA2E;AACzE,gBAAI,KAAKq6D,UAAL,KAAoBr2E,KAAK,CAACxC,OAA1B,IAAqC,KAAK84E,UAAL,KAAoBt2E,KAAK,CAACvC,OAAnE,EAA4E,CAC1E;AACD,aAHwE,CAIzE;AACA;AACA;;AACD;AACF;;;4CAEmB,CAClB;AACD;;;mCAEUue,E,EAAIhc,K,EAAO;AACpB;AACA;AACA,eAAK8zE,WAAL,CAAiByC,sBAAjB,CAAwCv6D,EAAxC;AACD;;;mCAEUA,E,EAAIhc,K,EAAO;AACpB;AACA,eAAK8zE,WAAL,CAAiByC,sBAAjB,CAAwC,EAAxC;AACD;;;oCAEWJ,M,EAAgBC,Y,EAAcp2E,K,EAAO,CAC/C;AACA;AACD;;;2CAEkBgc,E,EAAI;AACrB,iBAAO,KAAK83D,WAAL,CAAiBgC,iBAAjB,CAAmCU,QAAnC,CAA4Cx6D,EAA5C,CAAP;AACD;;;iCAEQA,E,EAAI;AAAA;;AACX,eAAK03D,WAAL,CAAiB+C,YAAjB,CAA8B,iBAA9B,EAAiD;AAC/CC,2BAAe,EAAE16D,EAD8B;AAE/C44D,2BAAe,EAAE,KAAKF,QAFyB;AAG/C5+D,iBAAK,EAAE,KAHwC;AAI/CoG,gBAAI,EAAE,aAJyC;AAK/Czb,oBAAQ,EAAE;AALqC,WAAjD,EAOC2sE,IAPD,CAOO,UAAAyH,GAAG,EAAI;AACZ/9E,mBAAO,CAACC,GAAR,CAAY89E,GAAZ;;AACA,mBAAI,CAACf,WAAL,CAAiB6C,QAAjB,CAA0B36D,EAA1B,EAA8B64D,GAA9B;AACD,WAVD,EADW,CAYX;AAED;;;uCAEc70E,K,EAAOkU,M,EAAQ;AAAA;;AAC5B,cAAI0iE,SAAS,GAAG52E,KAAK,CAAC62E,gBAAtB;AAEA//E,iBAAO,CAACC,GAAR,CAAY6/E,SAAZ;AACA,eAAKlD,WAAL,CAAiB+C,YAAjB,CAA8B,iBAA9B,EAAiD;AAC/ClzE,gBAAI,EAAEqzE,SAAS,CAACE,KAD+B;AAE/CC,wBAAY,YAAKH,SAAS,CAAC1sC,GAAf,CAFmC;AAG/Ch2B,kBAAM,YAAKA,MAAL,CAHyC;AAI/C4B,iBAAK,EAAE,KAJwC;AAK/CoG,gBAAI,EAAE06D,SAAS,CAAC16D,IAL+B;AAM/C86D,gBAAI,EAAEJ,SAAS,CAACI,IAN+B;AAO/CN,2BAAe,YAAKxiE,MAAL,CAPgC;AAQ/C0gE,2BAAe,YAAK,KAAKF,QAAV,CARgC;AAS/Cj0E,oBAAQ,EAAE;AATqC,WAAjD,EAWC2sE,IAXD,CAWO,UAAAyH,GAAG,EAAI;AACZ/9E,mBAAO,CAACC,GAAR,CAAY89E,GAAZ;;AACA,mBAAI,CAACf,WAAL,CAAiB6C,QAAjB,CAA0BziE,MAA1B,EAAkC2gE,GAAlC;AACD,WAdD;AAeA/9E,iBAAO,CAACC,GAAR,CAAYiJ,KAAZ;AACAlJ,iBAAO,CAACC,GAAR,CAAY,YAAYmd,MAAxB;AACD;;;;;;;uBApIUwhE,2B,EAA2B,kI,EAAA,wI,EAAA,+H;AAAA,K;;;YAA3BA,2B;AAA2B,+C;AAAA;AAAA;AAAA,O;AAAA,c;AAAA,a;AAAA,svB;AAAA;AAAA;ACVxC;;AACC;;AAkBC;;AAgBD;;AAqBD;;;;AAvD6B;;AAAA;;AAkBG;;AAAA;;AAgBD;;AAAA;;;qTDzBlBA,2B;AAA2B;;;;;sEAA3BA,2B,EAA2B;cALvC,uDAKuC;eAL7B;AACTp3E,kBAAQ,EAAE,0BADD;AAETw0E,qBAAW,EAAE,uCAFJ;AAGTC,mBAAS,EAAE,CAAC,uCAAD;AAHF,S;AAK6B,Q;;;;;;;;;;gBAErC,mD;iBAAM,M;;;;;;;;;;;;;;;;;;;;AEZT;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;QAOakE,8B;AAEX,gDAAc;AAAA;AAAG;;;;mCAET,CACP;;;;;;;uBALUA,8B;AAA8B,K;;;YAA9BA,8B;AAA8B,uC;AAAA,c;AAAA,a;AAAA;AAAA;ACP3C;;AAAG;;AAA8B;;;;;;;;sEDOpBA,8B,EAA8B;cAL1C,uDAK0C;eALhC;AACT34E,kBAAQ,EAAE,kBADD;AAETw0E,qBAAW,EAAE,0CAFJ;AAGTC,mBAAS,EAAE,CAAC,0CAAD;AAHF,S;AAKgC,Q;;;;;;;;;;;;;;;;;;;;AEP3C;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;;;ACGU;;;;;;AAAoD;;;;;;AAF5D;;AACM;;AACE;;AACF;;AACN;;;;;;AAFkC;;AAAA;;;;QDKvBmE,2B;AAIX,2CAAoBC,SAApB,EAA6C;AAAA;;AAAzB,aAAAA,SAAA,GAAAA,SAAA;AAEnB;;;;mCAEO,CACP;;;;;;;uBATUD,2B,EAA2B,uI;AAAA,K;;;YAA3BA,2B;AAA2B,+C;AAAA;AAAA;AAAA,O;AAAA,c;AAAA,a;AAAA,2H;AAAA;AAAA;ACRxC;;AACE;;AAKF;;;;AALO;;AAAA;;;;;;;;;sEDOMA,2B,EAA2B;cALvC,uDAKuC;eAL7B;AACT54E,kBAAQ,EAAE,0BADD;AAETw0E,qBAAW,EAAE,uCAFJ;AAGTC,mBAAS,EAAE,CAAC,uCAAD;AAHF,S;AAK6B,Q;;;;;;gBAErC;;;;;;;;;;;;;;;;;;;;AEVH;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;QAOaqE,wB;AAEX,0CAAc;AAAA;AAAG;;;;mCAET,CACP;;;;;;;uBALUA,wB;AAAwB,K;;;YAAxBA,wB;AAAwB,2C;AAAA,c;AAAA,a;AAAA,+I;AAAA;AAAA;ACPrC;;AACE;;AACE;;AACE;;AACF;;AACF;;AACF;;;;AAH6B;;AAAA;;;;;;;;;sEDIhBA,wB,EAAwB;cALpC,uDAKoC;eAL1B;AACT94E,kBAAQ,EAAE,sBADD;AAETw0E,qBAAW,EAAE,mCAFJ;AAGTC,mBAAS,EAAE,CAAC,mCAAD;AAHF,S;AAK0B,Q;;;;;;;;;;;;;;;;;;;;AEPrC;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;QAeasE,e;AAsBX,+BACY3D,WADZ,EAEYC,WAFZ,EAGYC,cAHZ,EAG0C;AAAA;;AAF9B,aAAAF,WAAA,GAAAA,WAAA;AACA,aAAAC,WAAA,GAAAA,WAAA;AACA,aAAAC,cAAA,GAAAA,cAAA;AAlBZ,aAAAK,KAAA,GAAQ,EAAR;AAEA,aAAAC,OAAA,GAAmB,IAAnB;AAOA,aAAAxkD,WAAA,GAAc,EAAd;AAEA,aAAAykD,cAAA,GAA0B,KAA1B;AACA,aAAAC,WAAA,GAAmB,IAAnB;AAkHA,aAAAkD,KAAA,GAAe,CAAC;AAAEp7D,cAAI,EAAE;AAAR,SAAD,EAA0B;AAAEA,cAAI,EAAE;AAAR,SAA1B,EAAmD;AAAEA,cAAI,EAAE;AAAR,SAAnD,CAAf;AACA,aAAAq7D,iBAAA,GAAoB,iBAApB;AACA,aAAAC,YAAA,GAAsB,EAAtB;AA7GK;;;;mCAEG,CAER;AACA;AACA;AACA;AAEA;AAEE;AACA;AACA;AACF;AACA;AAEA;AACA;AACA;AACA;AAEE;AACF;AACA;AACA;AACA;AACE;AACA;AACA;AACF;AACE;AAEI;AAEJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACD,S,CAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;;;;0CAEkB,CAEhB;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AAGA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACD;;;iCAGQC,a,EAAuBC,Q,EAAkB,CACjD;;;iCAMgBz5E,I,EAAW4O,I,EAAa28B,E,EAAW;AAClD,cAAMmuC,YAAY,GAAG9qE,IAAI,CAACrN,OAAL,CAAavB,IAAb,CAArB;;AACA,cAAI05E,YAAY,GAAG,CAAC,CAApB,EAAuB;AACrB9qE,gBAAI,CAAChN,MAAL,CAAY83E,YAAZ,EAA0B,CAA1B;AACD;;AACD,cAAInuC,EAAE,CAAChqC,OAAH,CAAWvB,IAAX,MAAqB,CAAC,CAA1B,EAA6B;AAC3BurC,cAAE,CAAC7zC,IAAH,CAAQsI,IAAR;AACD;AACF,S,CAEH;;;;uCACiB2kC,S,EAAW;AAAA;;AACtB9rC,iBAAO,CAACC,GAAR,CAAY6rC,SAAZ;AAEA,cAAIg1C,OAAO,GAAG;AACZr0E,gBAAI,EAAEq/B,SAAS,CAACi0C,gBAAV,CAA2BgB,SADrB;AAEZ3jE,kBAAM,EAAE0uB,SAAS,CAACi0C,gBAAV,CAA2B3sC,GAFvB;AAGZ0qC,2BAAe,EAAE,KAAKF,QAHV;AAIZsC,gBAAI,EAAEp0C,SAAS,CAACi0C,gBAAV,CAA2BG,IAJrB;AAKZ96D,gBAAI,EAAE0mB,SAAS,CAACi0C,gBAAV,CAA2B36D,IALrB;AAMZ47D,uBAAW,EAAEl1C,SAAS,CAACi0C,gBAAV,CAA2BiB,WAN5B;AAOZtlF,gBAAI,EAAEowC,SAAS,CAACm1C,iBAAV,CAA4B36E,KAA5B,GAAoC,GAP9B;AAQZkJ,eAAG,EAAEs8B,SAAS,CAACm1C,iBAAV,CAA4B16E,KAA5B,GAAoC,EAR7B;AASZpI,iBAAK,EAAE2tC,SAAS,CAACm1C,iBAAV,CAA4B16E,KAA5B,GAAoC;AAT/B,WAAd;AAcA,eAAKq2E,WAAL,CAAiB+C,YAAjB,CAA8B,oBAA9B,EAAoDmB,OAApD,EACGxK,IADH,CACS,UAAAr7E,CAAC,EAAI;AACV,mBAAI,CAAC4hF,WAAL,CAAiBqE,cAAjB,CAAgCjmF,CAAhC;AACD,WAHH,EAjBsB,CAqBtB;AACA;AACA;AACA;AACA;AACH;;;sCAEaA,C,EAAG;AACf,eAAKoiF,cAAL,GAAsB,IAAtB;AACA,eAAKC,WAAL,GAAmBriF,CAAnB;AACD;;;mCACUA,C,EAAG;AACZ,cAAI,KAAKqiF,WAAL,CAAiBlqC,GAAjB,IAAwBn4C,CAAC,CAACm4C,GAA9B,EAAoC;AAClC,iBAAKiqC,cAAL,GAAsB,KAAtB;AACD;;AAAA;AAED,eAAKT,WAAL,CAAiBuE,YAAjB,CAA8B,oBAA9B,EAAoDlmF,CAAC,CAACm4C,GAAtD,EAA2D;AAAEmnB,mBAAO,EAAE;AAAX,WAA3D;AACD;;;;;;;uBA1LUgmB,e,EAAe,wI,EAAA,0H,EAAA,+H;AAAA,K;;;YAAfA,e;AAAe,iC;AAAA,e;AAAA,a;AAAA,8f;AAAA;AAAA;ACf5B;;AAIE;;AACE;;AAKE;;AACE;;AAA6E;;AAAS;;AACxF;;AAEA;;AACE;;AAA0E;;AAAM;;AAClF;;AAGA;;AACE;;AAA+E;;AAAW;;AAC5F;;AACA;;AACE;;AAAgF;;AAAY;;AAC9F;;AAIF;;AACF;;AACA;;AACE;;AACE;;AACF;;AAIF;;AACF;;;;;;;;;sEDvBaA,e,EAAe;cAN3B,uDAM2B;eANjB;AACT/4E,kBAAQ,EAAE,YADD;AAETw0E,qBAAW,EAAE,yBAFJ;AAGTC,mBAAS,EAAE,CAAC,yBAAD;AAHF,S;AAMiB,Q;;;;;;;;;;;;;;;;;;;;;;;;;;AEf5B;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;QAiDamF,Y;;;;;YAAAA;;;;yBAAAA,Y;AAAY,O;AAAA,iBAJZ,CACT,0DADS,C;AAEV,gBAhBQ,CACP,4DADO,EAEP,0DAFO,EAGP,kEAHO,EAIP,gEAJO,EAKP,qEAAmBC,OAAnB,EALO,EAMP,0EANO,CAgBR;;;;0HAEUD,Y,EAAY;AAAA,uBAnBR,iEAmBQ,EAnBS,gHAmBT,EAnBsC,kGAmBtC,EAnB+D,8DAmB/D,EAnB8E,oHAmB9E,EAnB4G,uFAmB5G,EAnBiI,6FAmBjI,EAnBwJ,sGAmBxJ,EAnBkL,sGAmBlL,EAnB4M,2GAmB5M,EAnBuO,uHAmBvO,EAnBsQ,0HAmBtQ,EAnBsS,iHAmBtS,EAnBmU,iHAmBnU,EAnBgW,8GAmBhW;AAnB0X,kBAE/Y,4DAF+Y,EAG/Y,0DAH+Y,EAI/Y,kEAJ+Y,EAK/Y,gEAL+Y,EAK7X,oEAL6X,EAO/Y,0EAP+Y;AAmB1X,O;AAZF,K;;;;;sEAYVA,Y,EAAY;cApBxB,sDAoBwB;eApBf;AACRtF,sBAAY,EAAE,CAAC,iEAAD,EAAkB,gHAAlB,EAA+C,kGAA/C,EAAwE,8DAAxE,EAAuF,oHAAvF,EAAqH,uFAArH,EAA0I,6FAA1I,EAAiK,sGAAjK,EAA2L,sGAA3L,EAAqN,2GAArN,EAAgP,uHAAhP,EAA+Q,0HAA/Q,EAA+S,iHAA/S,EAA4U,iHAA5U,EAAyW,8GAAzW,CADN;AAERF,iBAAO,EAAE,CACP,4DADO,EAEP,0DAFO,EAGP,kEAHO,EAIP,gEAJO,EAKP,qEAAmByF,OAAnB,EALO,EAMP,0EANO,CAFD;AAUR39E,iBAAO,EAAE,EAVD;AAaR49E,yBAAe,EAAE,CACf,8DADe,CAbT;AAgBRhG,mBAAS,EAAE,CACT,0DADS;AAhBH,S;AAoBe,Q;;;;;;;;;;;;;;;;;;ACjDzB;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;QAqBaiG,a;AAwEX,6BACU1E,WADV,EACkC;AAAA;;AAAxB,aAAAA,WAAA,GAAAA,WAAA;AAjEV,aAAAphC,mBAAA,GAAsB;AACpB6I,qBAAW,EAAE,CADO;AAEpB5tB,gBAAM,EAAE,SAFY;AAGpB8qD,mBAAS,EAAE,MAHS;AAIpBr8B,uBAAa,EAAE,OAJK;AAKpBC,sBAAY,EAAE;AALM,SAAtB,CAiEkC,CA1DlC;;AACA,aAAAvM,mBAAA,GAAsB;AACpByL,qBAAW,EAAE,CADO;AAEpB5tB,gBAAM,EAAE,SAFY;AAGpB0uB,sBAAY,EAAE,CAHM;AAIpBD,uBAAa,EAAE;AAJK,SAAtB;AAMA,aAAA1pB,kBAAA,GAAqB;AACnB3L,cAAI,EAAE,SADa;AAEnB4G,gBAAM,EAAE;AAFW,SAArB,CAmDkC,CA/ClC;;AACA,aAAAmE,cAAA,GAAiB;AACfrM,kBAAQ,EAAE,KADK;AAEfkB,oBAAU,EAAE;AACRgH,kBAAM,EAAE,SADA;AAER5G,gBAAI,EAAE,aAFE;AAGRqkC,kBAAM,EAAE,EAHA;AAIR7P,uBAAW,EAAE;AAJL,WAFG;AAQf3c,kBAAQ,EAAE,IARK;AASfoR,mBAAS,EAAE,CAAE,WAAF,EAAe;AAAEsd,gBAAI,EAAE,CAAC,EAAD,EAAK,EAAL,CAAR;AAAkBG,eAAG,EAAE,EAAvB;AAA2BiQ,wBAAY,EAAE,CAAzC;AAA4CJ,8BAAkB,EAAE;AAAhE,WAAf,CATI;AAUfztB,wBAAc,EAAE,KAAK6C,mBAVN;AAWf9rB,yBAAe,EAAE,KAAK8L,kBAXP;AAYfod,6BAAmB,EAAE,KAAKA,mBAZX;AAaf3L,qBAAW,EAAE,EAbE;AAcfnb,kBAAQ,EAAE,CACN,CAAE,OAAF,EAAW;AACPz3B,oBAAQ,EAAE,CAAC,GAAD,EAAM,GAAN,CADH;AAEP2hC,iBAAK,EAAE,KAFA;AAGP9I,oBAAQ,EAAE,qBAHH;AAIP8lB,mBAAO,EAAC;AAJD,WAAX,CADM;AAdK,SAAjB,CA8CkC,CAvBlC;;AACA,aAAAne,cAAA,GAAiB;AACftM,kBAAQ,EAAE,KADK;AAEfkB,oBAAU,EAAE;AAAEI,gBAAI,EAAE,SAAR;AAAmBqkC,kBAAM,EAAE;AAA3B,WAFG;AAGfxkC,yBAAe,EAAE,KAAK8L,kBAHP;AAIfqP,wBAAc,EAAE,EAJD;AAKfL,qBAAW,EAAE;AAAE9oB,sBAAU,EAAE,OAAd;AAAuBF,uBAAW,EAAE;AAApC,WALE;AAMfomB,kBAAQ,EAAE,IANK;AAOf9V,kBAAQ,EAAE,CACN,CAAE,OAAF,EAAW;AAAEz3B,oBAAQ,EAAE,CAAC,GAAD,EAAM,GAAN,CAAZ;AAAwB2hC,iBAAK,EAAE,IAA/B;AAAqC9I,oBAAQ,EAAE,qBAA/C;AAAsE8lB,mBAAO,EAAC;AAA9E,WAAX,CADM;AAPK,SAAjB;AAaA,aAAAwoC,aAAA,GAAgB,CACd,CAAE,CAAF,EAAK,CAAL,EAAQ,CAAR,EAAW,CAAX,CADc,EAEd,CAAE,IAAF,EAAQ,CAAR,EAAW,CAAX,EAAc,CAAd,CAFc,EAGd,CAAE,GAAF,EAAO,CAAP,EAAU,CAAV,EAAa,CAAb,CAHc,EAId,CAAE,IAAF,EAAQ,CAAR,EAAW,CAAX,EAAc,CAAd,CAJc,EAKd,CAAE,CAAF,EAAK,CAAL,EAAQ,CAAR,EAAW,CAAX,CALc,CAAhB;AAYC;;;;oCAGWv4E,K,EAAOsjE,I,EAAM;AACvB,cAAGtjE,KAAK,CAACw4E,OAAT,EAAkB;AAChB,gBAAIzyD,SAAS,GAAG,KAAKhC,eAAL,CAAqB+a,YAArB,CAAkCwkC,IAAI,CAACp5B,GAAvC,CAAhB;AACApzC,mBAAO,CAACC,GAAR,CAAYgvB,SAAZ;;AACA,gBAAGA,SAAS,CAACp1B,MAAV,IAAoB,CAAvB,EAA0B;AACxB,mBAAKozB,eAAL,CAAqByO,WAArB,CAAiC8wC,IAAI,CAACp5B,GAAtC,EAA2C;AAAE9kB,sBAAM,EAAE,UAAV;AAAsBrX,oBAAI,EAAEu1D,IAAI,CAACp5B,GAAL,GAAW,IAAItzC,IAAJ;AAAvC,eAA3C,EAAgG,KAAK+6B,cAArG;AACD,aAFD,MAGK;AAED8mD,mBAAK,CAAC,UAAD,CAAL;AAEH;AAEF;AACF;;;0CAEiB;AAAA;;AAIhB;AAEA,cAAMz8D,EAAE,GAAG,KAAKsnD,IAAL,CAAUp5B,GAArB;AAEA,eAAKnmB,eAAL,CAAqB2X,KAArB,CAA4B,YAAM;AAChC,mBAAI,CAACg9C,aAAL,CAAmB18D,EAAnB,EAAuB,CAAC,aAAD,CAAvB,EAAwC,CAAC,SAAD,CAAxC;AACD,WAFD,EARgB,CAYhB;AACA;;AACA,eAAK+H,eAAL,CAAqBhY,SAArB,CAA+BiQ,EAA/B;AAKAllB,iBAAO,CAACC,GAAR,CAAY,KAAKgtB,eAAjB;AACD;;;sCACc40D,I,EAAMJ,a,EAAeK,a,EAAe;AACjD,eAAK,IAAI3nF,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGsnF,aAAa,CAAC5nF,MAAlC,EAA0CM,CAAC,EAA3C,EAA+C;AAC3C,gBAAI4nF,UAAU,GAAGF,IAAI,GAAGJ,aAAa,CAACtnF,CAAD,CAArC;AACA,iBAAK8yB,eAAL,CAAqByO,WAArB,CAAiCmmD,IAAjC,EAAuC,KAAKhnD,cAA5C,EAA4D;AACxDvM,oBAAM,EAAEmzD,aAAa,CAACtnF,CAAD,CADmC;AAC9B8c,kBAAI,EAAE8qE;AADwB,aAA5D;AAGH;;AACD,eAAK,IAAIvmF,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGsmF,aAAa,CAACjoF,MAAlC,EAA0C2B,CAAC,EAA3C,EAA+C;AAC3C,gBAAIwmF,UAAU,GAAGH,IAAI,GAAGC,aAAa,CAACtmF,CAAD,CAArC;AACA,iBAAKyxB,eAAL,CAAqByO,WAArB,CAAiCmmD,IAAjC,EAAuC,KAAK/mD,cAA5C,EAA4D;AAAExM,oBAAM,EAAEwzD,aAAa,CAACtmF,CAAD,CAAvB;AAA4Byb,kBAAI,EAAE+qE;AAAlC,aAA5D;AACH;AACF;;;wCAEe/mF,C,EAAG;AACjB+E,iBAAO,CAACC,GAAR,CAAY,oBAAZ;AACAD,iBAAO,CAACC,GAAR,CAAYhF,CAAZ;AACA,eAAK4hF,WAAL,CAAiBsC,WAAjB,CAA6BlkF,CAA7B;AACD;;;;;;;uBArIUsmF,a,EAAa,0H;AAAA,K;;;YAAbA,a;AAAa,2B;AAAA;AAAA;AAAA;AAAA;AAAA,O;AAAA,e;AAAA,a;AAAA,+W;AAAA;AAAA;ACrBzB;;AAEI;;AAEC;;AAAG;AAAA,mBAAS,IAAAU,WAAA,kBAAT;AAAkC,WAAlC,EAAoC,UAApC,EAAoC;AAAA,mBAAgD,IAAAC,eAAA,UAAhD;AAAqE,WAAzG;;AACD;;AACE;;AACE;;AACF;;AACA;;AACE;;AACE;;AACF;;AACA;;AACE;;AACF;;AACF;;AACF;;AACF;;AAED;;AAEF;;;;AAtBwD,oGAA8B,MAA9B,EAA8B,mBAA9B,EAA8B,IAA9B;;AAAlB;;AAWjB;;AAAA;;AAGV;;AAAA;;;;;;;;;;sEDODX,a,EAAa;cALzB,uDAKyB;eALf;AACT/5E,kBAAQ,EAAE,MADD;AAETw0E,qBAAW,EAAE,uBAFJ;AAGTmG,uBAAa,EAAE,gEAAkBC;AAHxB,S;AAKe,Q;;;;;;gBACvB;;;gBAEA,mD;iBAAM,gB;;;gBAEN;;;;;;;;;;;;;;;;;;;;AE1BH;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;QAaaC,W;AA0BX,2BAAoBC,eAApB,EAA+D;AAAA;;AAA3C,aAAAA,eAAA,GAAAA,eAAA;AAtBpB,aAAA/E,eAAA,GAAkB,IAAI,4CAAJ,EAAlB;AACA,aAAAgF,gBAAA,GAAmB,KAAKhF,eAAL,CAAqBiF,YAArB,EAAnB;AAEA,aAAAhF,kBAAA,GAAqB,IAAI,4CAAJ,EAArB;AACA,aAAAiF,mBAAA,GAAsB,KAAKjF,kBAAL,CAAwBgF,YAAxB,EAAtB;AAEA,aAAAv1D,eAAA,GAAkB,gDAAQonB,WAAR,CAAoB;AACpC;AACA5e,qBAAW,EAAE;AAAEitD,kBAAM,EAAE,SAAV;AAAqBC,kBAAM,EAAE;AAA7B,WAFuB;AAGpC;AACAlsD,oBAAU,EAAE;AACV;AACEpyB,oBAAQ,EAAE;AAAE6oE,mBAAK,EAAE,CACf,CAAE,CAAF,EAAK,SAAL,CADe,EAEf,CAAE,CAAF,EAAK,SAAL,CAFe;AAAT,aAFF;AAMRx2C,kBAAM,EAAE,SANA;AAOR4tB,uBAAW,EAAE;AAPL,WAJwB;AAapC/uB,mBAAS,EAAE;AAbyB,SAApB,CAAlB;AAgBkE;;;;gDAEnCqtD,gB,EAAkB;AAC/C5iF,iBAAO,CAACC,GAAR,CAAY,yBAAZ;AACAD,iBAAO,CAACC,GAAR,CAAY2iF,gBAAZ;AACA,eAAKC,iBAAL,GAAyBD,gBAAzB;AACD;;;uCAEqBpW,I,EAAW;AAC/B,cAAMkP,OAAO,GAAG,KAAK4G,eAAL,CAAqBQ,uBAArB,CAA6C,6DAA7C,CAAhB;AACA,cAAMtzD,SAAS,GAAGksD,OAAO,CAACnpD,MAAR,CAAe,KAAKswD,iBAAL,CAAuBE,cAAtC,CAAlB;AACMvzD,mBAAS,CAACrC,QAAV,CAAoBq/C,IAApB,GAA2BA,IAA3B;AACAh9C,mBAAS,CAACrC,QAAV,CAAoBF,eAApB,GAAsC,KAAKA,eAA3C;AACN,eAAK41D,iBAAL,CAAuBG,MAAvB,CAA8BxzD,SAAS,CAACyzD,QAAxC,EAL+B,CAM/B;AACD;;;sCAEaxwD,U,EAAY;AACxB;AACA,eAAKxF,eAAL,CAAqB+U,OAArB,CAA6B;AAAEjH,iBAAK,EAAEtI,UAAU,CAACsI;AAApB,WAA7B;AACD;;;oCAEWyxC,I,EAAM;AAChB,eAAKgR,kBAAL,CAAwBtW,IAAxB,CAA6BsF,IAA7B;AACA,eAAK+Q,eAAL,CAAqBrW,IAArB,CAA0B,IAA1B;AACD;;;sCAEa;AACZ,eAAKqW,eAAL,CAAqBrW,IAArB,CAA0B,KAA1B;AACD;;;yCAEgB,CAEhB;;;gCAEc;AACb,eAAK2b,iBAAL,CAAuBjyC,KAAvB;AACD;;;;;;;uBA/DUyxC,W,EAAW,8H;AAAA,K;;;aAAXA,W;AAAW,eAAXA,WAAW;;;;;sEAAXA,W,EAAW;cADvB;AACuB,Q;;;;;;;;;;;;;;;;;;;;;;ACbxB;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;;;;;QAcaa,uB;AAeX,uCACU5hF,CADV,EAEUu7E,WAFV,EAGUD,WAHV,EAGkC;AAAA;;AAFxB,aAAAt7E,CAAA,GAAAA,CAAA;AACA,aAAAu7E,WAAA,GAAAA,WAAA;AACA,aAAAD,WAAA,GAAAA,WAAA;AAjBD,aAAAO,KAAA,GAAQ,EAAR;AAEA,aAAAvkD,WAAA,GAAc,EAAd;AAgBL;;;;mCAEO,CAIV;;;0CAKiB;AAChB,eAAM,IAAIl+B,CAAV,IAAe,KAAKk+B,WAApB,EAAkC;AAChC,iBAAKikD,WAAL,CAAiB95C,aAAjB,CAA+B,KAAKnK,WAAL,CAAiBl+B,CAAjB,CAA/B;AACD;;AAED,iBAAO,IAAP;AACD;;;0CAEiB;AAAA;;AAChB;AACA,eAAKmiF,WAAL,CAAiBsG,uBAAjB,CAAyC,KAAKP,gBAA9C,EAFgB,CAIhB;;AAGA,cAAIQ,UAAU,GAAG,CAAjB;AACA,eAAKjG,KAAL,CAAW3P,OAAX,CAAmB,UAAAvyE,CAAC,EAAI;AACtB,mBAAI,CAAC4hF,WAAL,CAAiBqE,cAAjB,CAAgCjmF,CAAhC;;AAEAmoF,sBAAU;;AAEV,gBAAGA,UAAU,IAAI,OAAI,CAACjG,KAAL,CAAWtjF,MAA5B,EAAoC;AAClC;AAEAmG,qBAAO,CAACC,GAAR,CAAYmjF,UAAZ;AACApjF,qBAAO,CAACC,GAAR,CAAY,OAAI,CAACk9E,KAAL,CAAWtjF,MAAvB;AACD;AACF,WAXD,EARgB,CAqBhB;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACD;;;kCAES,CAET;;;uCAEW;AAAA;;AACV;AAEA,cAAMs0B,SAAS,GAAG,KAAKy0D,gBAAL,CAAsBhpD,OAAtB,CAA8Bk/C,aAA9B,CAA4CpxE,UAA9D;AACA,cAAMy1E,KAAK,GAAGl2E,KAAK,CAAC8O,IAAN,CAAWoY,SAAS,CAACvmB,gBAAV,CAA2B,OAA3B,CAAX,EAAgD0a,GAAhD,CAAoD,UAACkqD,IAAD,EAA0B;AAC1F,mBAAO;AACLtnD,gBAAE,EAAEsnD,IAAI,CAACtnD,EADJ;AAEL1V,iBAAG,EAAEg9D,IAAI,CAAClsD,SAFL;AAGL5kB,kBAAI,EAAE8wE,IAAI,CAACnsD;AAHN,aAAP;AAKD,WANa,CAAd;AAQA88D,eAAK,CAAC3P,OAAN,CAAe,UAAAvyE,CAAC,EAAI;AAClB,mBAAI,CAAC2hF,WAAL,CAAiBuE,YAAjB,CAA8B,oBAA9B,EAAoDlmF,CAAC,CAACiqB,EAAtD,EAA0DjqB,CAA1D;AACD,WAFD;AAIA,cAAM29B,WAAW,GAAI,KAAKikD,WAAL,CAAiB5vD,eAAjB,CAAiC6a,iBAAjC,GAChBxlB,GADgB,CACZ,UAACwK,IAAD;AAAA,mBAAW;AAAEiO,mBAAK,EAAEjO,IAAI,CAAC81B,QAAL;AAAT,aAAX;AAAA,WADY,CAArB;AAGAhqB,qBAAW,CAAC40C,OAAZ,CAAqB,UAAC9yE,CAAD,EAAU;AAC7BA,aAAC,CAACojF,eAAF,GAAoB,OAAI,CAACF,QAAzB;;AACA,mBAAI,CAAChB,WAAL,CAAiBiB,WAAjB,CAA6B,0BAA7B,EAAyD;AACvDC,6BAAe,EAAE,OAAI,CAACF;AADiC,aAAzD,EAGCtH,IAHD,CAGO,UAAAyH,GAAG,EAAI,CAEb,CALD,EAMCzH,IAND,CAMO,YAAM;AACX;AACA;AACA;AACA,qBAAI,CAACsG,WAAL,CAAiB+C,YAAjB,CAA8B,0BAA9B,EAA0DjlF,CAA1D;AACD,aAXD;AAcD,WAhBD;AAkBA,cAAM2oF,IAAI,GAAGC,IAAI,CAACC,SAAL,CAAe;AAAEpG,iBAAK,EAALA,KAAF;AAASvkD,uBAAW,EAAXA;AAAT,WAAf,CAAb;AAEA54B,iBAAO,CAACC,GAAR,CAAYojF,IAAZ;AACD;;;;;;;uBAnHUH,uB,EAAuB,uI,EAAA,0H,EAAA,wI;AAAA,K;;;YAAvBA,uB;AAAuB,sC;AAAA;AAAA;+EAaN,8D;;;;;;;;;;;;;;;;;;;;ACnB9B;;AACE;;AAAQ;AAAA,mBAAS,IAAAM,YAAA,EAAT;AAAuB,WAAvB;;AAA0B;;AAAI;;AACtC;;AACE;;AACF;;AACF;;;;AAFwC;;AAAA;;;;;;;;;sEDG3BN,uB,EAAuB;cAPnC,uDAOmC;eAPzB;AACT17E,kBAAQ,EAAE,iBADD;AAETw0E,qBAAW,EAAE,kCAFJ;AAGTC,mBAAS,EAAE,CAAC,kCAAD,CAHF;AAITkG,uBAAa,EAAE,gEAAkBC,IAJxB,CAKV;;AALU,S;AAOyB,Q;;;;;;;;;;gBACjC;;;gBAEA;;;gBAEA;;;gBAEA,mD;iBAAM,gB;;;gBAMN,uD;iBAAU,O,EAAS;AAAEzD,gBAAI,EAAE;AAAR,W;;;;;;;;;;;;;;;;;;;;AE3BtB;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;QAKa8E,e;AAoBX,iCAAc;AAAA;;AAnBP,aAAAvyC,KAAA,GAAQ,EAAR;AACC,aAAAwyC,WAAA,GAAc,IAAI,4CAAJ,EAAd;AACR,aAAAzF,YAAA,GAAe,KAAKyF,WAAL,CAAiBlB,YAAjB,EAAf;AACQ,aAAAmB,kBAAA,GAAqB,IAAI,4CAAJ,EAArB;AACR,aAAA7E,mBAAA,GAAsB,KAAK6E,kBAAL,CAAwBnB,YAAxB,EAAtB;AACQ,aAAAoB,gBAAA,GAAmB,IAAI,4CAAJ,EAAnB;AACR,aAAA3E,iBAAA,GAAoB,KAAK2E,gBAAL,CAAsBpB,YAAtB,EAApB;AAEA,aAAAjF,eAAA,GAAkB,IAAI,4CAAJ,EAAlB;AACA,aAAAgF,gBAAA,GAAmB,KAAKhF,eAAL,CAAqBiF,YAArB,EAAnB;AAEA,aAAAhF,kBAAA,GAAqB,IAAI,4CAAJ,EAArB;AACA,aAAAiF,mBAAA,GAAsB,KAAKjF,kBAAL,CAAwBgF,YAAxB,EAAtB;AAEA,aAAAxD,iBAAA,GAAoB,EAApB;AAKiB;;;;+CAEM95D,E,EAAI;AACzB,eAAKg6D,mBAAL,GAA2Bh6D,EAA3B;AACA,eAAK0+D,gBAAL,CAAsB1c,IAAtB,CAA2B,IAA3B;AACD;;;iDAEwB;AACvB,iBAAO,KAAKgY,mBAAZ;AACD;;;iDAEwBhlF,C,EAAG;AAC1B8F,iBAAO,CAACC,GAAR,CAAY,eAAZ;AACAD,iBAAO,CAACC,GAAR,CAAY/F,CAAZ;AACA,eAAKikF,qBAAL,GAA6BjkF,CAA7B;AACA,eAAKkkF,uBAAL,GAA+BlkF,CAAC,CAAC,CAAD,CAAD,CAAK,CAAL,EAAQk5C,GAAvC;AACA,eAAKswC,WAAL,CAAiBxc,IAAjB,CAAsB,IAAtB;AACD;;;oCAIW1V,E,EAAI;AACd,eAAKqyB,QAAL,GAAgBryB,EAAhB;AACD;;;8CAEqB;AACpB,eAAKwtB,iBAAL,GAAyB,EAAzB;AACD;;;wCACe95D,E,EAAI;AAClB,cAAI,KAAK85D,iBAAL,CAAuBU,QAAvB,CAAgCx6D,EAAhC,CAAJ,EAAyC;AACvC,gBAAM9d,KAAK,GAAG,KAAK43E,iBAAL,CAAuBt2E,OAAvB,CAA+BX,MAAM,CAACmd,EAAD,CAArC,CAAd;AACA,iBAAK85D,iBAAL,CAAuBj2E,MAAvB,CAA8B3B,KAA9B,EAAqC,CAArC;AACD,WAHD,MAGO;AACL,iBAAK43E,iBAAL,CAAuBngF,IAAvB,CAA4BqmB,EAA5B;AACA,iBAAKy+D,kBAAL,CAAwBzc,IAAxB,CAA6B,IAA7B;AACAlnE,mBAAO,CAACC,GAAR,CAAY,KAAK++E,iBAAjB;AACD;AACF;;;iCAEQ95D,E,EAAIk4B,I,EAAM;AACjBp9C,iBAAO,CAACC,GAAR,CAAY,kBAAkBilB,EAA9B;AACAllB,iBAAO,CAACC,GAAR,CAAY,KAAKk+E,qBAAL,CAA2B,CAA3B,EAA8B,CAA9B,CAAZ;AAEA,cAAM2F,UAAU,GAAG,KAAKC,eAAL,CAAqB,KAAK5F,qBAAL,CAA2B,CAA3B,EAA8B,CAA9B,CAArB,EAAuDj5D,EAAvD,CAAnB;AACAllB,iBAAO,CAACC,GAAR,CAAY,uBAAZ;AAEAD,iBAAO,CAACC,GAAR,CAAY6jF,UAAZ;AACAA,oBAAU,CAACjlF,IAAX,CAAgBu+C,IAAhB;AACA,eAAKlM,KAAL,GAAa,KAAKA,KAAL,GAAa,CAA1B;AACD;;;wCAIe8yC,I,EAAM9+D,E,EAAI;AACxB,cAAM++D,KAAK,GAAG,CAACD,IAAD,CAAd;AACAhkF,iBAAO,CAACC,GAAR,CAAY,iBAAZ;AACAD,iBAAO,CAACC,GAAR,CAAYgkF,KAAZ;;AACA,iBAAOA,KAAK,CAACpqF,MAAb,EAAqB;AACjB,gBAAM6rD,OAAO,GAAGu+B,KAAK,CAACl4D,GAAN,EAAhB;AACA/rB,mBAAO,CAACC,GAAR,CAAY,mBAAZ;AACAD,mBAAO,CAACC,GAAR,CAAYylD,OAAZ;;AACA,gBAAIA,OAAO,CAACtS,GAAR,KAAgBluB,EAApB,EAAwB;AACtB,qBAAOwgC,OAAO,CAAC/7C,QAAf;AACD;;AACDs6E,iBAAK,CAACplF,IAAN,OAAAolF,KAAK,qBAASv+B,OAAO,CAAC/7C,QAAjB,EAAL;AACH;AACF;;;kCAESub,E,EAAI,CAEb;;;oCAEWsnD,I,EAAM;AAChBxsE,iBAAO,CAACC,GAAR,CAAY,wBAAZ;AACA,eAAKu9E,kBAAL,CAAwBtW,IAAxB,CAA6BsF,IAA7B;AACA,eAAK+Q,eAAL,CAAqBrW,IAArB,CAA0B,IAA1B;AACD;;;sCAEa;AACZ,eAAKqW,eAAL,CAAqBrW,IAArB,CAA0B,KAA1B;AACD;;;;;;;uBApGUuc,e;AAAe,K;;;aAAfA,e;AAAe,eAAfA,eAAe,K;AAAA,kBAFd;;;;;sEAEDA,e,EAAe;cAH3B,wDAG2B;eAHhB;AACVS,oBAAU,EAAE;AADF,S;AAGgB,Q;;;;;;;;;;;;;;;;;;;;ACL5B;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;;;;;ACqCU;;AACE;;AACE;;AACE;;AAAO;;AAAI;;AACX;;AAA8D;AAAA;;AAAA;;AAAA;AAAA;;AAA9D;;AACA;;AAAoB;;AAAiG;;AACvH;;AAEA;;AACE;;AAAO;;AAAI;;AACX;;AAA8D;AAAA;;AAAA;;AAAA;AAAA;;AAA9D;;AACA;;AAAoB;;AAAsD;;AAC5E;;AAIA;;AACE;;AAAO;;AAAW;;AAClB;;AAA2E;AAAA;;AAAA;;AAAA;AAAA;;AAA+B;;AAC1G;;AAAoB;;AAA6E;;AACnG;;AACF;;AAGA;;AAAQ;AAAA;;AAAA;;AAAA;AAAA;;AAAqD;;AAAI;;AACjE;;AAAQ;AAAA;;AAAA;;AAAA;AAAA;;AAAsD;;AAAM;;AACtE;;;;;;AAtBoE;;AAAA;;AAMA;;AAAA;;AAQa;;AAAA;;;;;;;;AAanF;;AAGE;;AACE;;AACF;;AAEA;;AAAQ;AAAA;;AAAA;;AAAA;AAAA;;AAA8D;;AAA0B;;AAGlG;;;;;;AAN2B;;AAAA,mGAAiC,gBAAjC,EAAiC,IAAjC,EAAiC,UAAjC,EAAiC,eAAjC,EAAiC,aAAjC,EAAiC,IAAjC;;;;;;AAUzB;;AACE;;AACE;;AACF;;AAEF;;;;;;AAH2B;;AAAA,4FAA0B,gBAA1B,EAA0B,IAA1B,EAA0B,UAA1B,EAA0B,wBAA1B;;;;QDrExBC,4B;AAeX,4CACUvH,WADV,EAEUC,WAFV,EAEkC;AAAA;;AADxB,aAAAD,WAAA,GAAAA,WAAA;AACA,aAAAC,WAAA,GAAAA,WAAA;AAPV,aAAAuH,SAAA,GAAY,EAAZ;AAQK;;;;sCAES;AACZ,eAAK5X,IAAL,GAAY,IAAZ;AACD;;;mCAIO;AAAA;;AAENxsE,iBAAO,CAACC,GAAR,CAAY,KAAKusE,IAAjB;;AAEA,cAAG,KAAKA,IAAL,CAAU//D,IAAV,IAAkB,kBAArB,EAAyC;AACvC,iBAAK43E,gBAAL,GAAwB,KAAKzH,WAAL,CAAiBc,QAAjB,CAA0B,gCAA1B,EAA4D;AAClFtgE,oBAAM,EAAE,KAAKovD,IAAL,CAAUpvD;AADgE,aAA5D,EAGvBugE,IAHuB,CAItB,2DAAI,UAAEr8E,CAAF;AAAA,qBAAwBA,CAAC,CAAC87C,IAA1B;AAAA,aAAJ,CAJsB,CAAxB;AAOA,iBAAKinC,gBAAL,CAAsBnL,SAAtB,CAAiC,UAAAa,IAAI,EAAI;AAEvCA,kBAAI,CAACvM,OAAL,CAAa,UAAAz0E,CAAC,EAAI;AAChB,uBAAI,CAACqrF,SAAL,CAAevlF,IAAf,CAAoB9F,CAApB;AACD,eAFD,EAFuC,CAOvC;AACD,aARD;AAUA,iBAAKurF,OAAL,GAAe,KAAK1H,WAAL,CAAiB2H,OAAjB,CAAyB,sBAAzB,EAAiD,KAAK/X,IAAL,CAAUpvD,MAA3D,CAAf;AAED;AAEF;;;2CAEkB,CAElB;;;mCAEO;AACN,eAAKw/D,WAAL,CAAiBuE,YAAjB,CAA8B,iBAA9B,EAAiD,KAAK3U,IAAL,CAAUp5B,GAA3D,EAAgE,KAAKo5B,IAArE;AACD;;;qCAEY;AAAA;;AACX,eAAKoQ,WAAL,CAAiBiB,WAAjB,CAA6B,0BAA7B,EAAyD;AACvDzgE,kBAAM,EAAE,KAAKovD,IAAL,CAAUp5B;AADqC,WAAzD,EAGCkjC,IAHD,CAGO,UAAAyH,GAAG,EAAI;AACZA,eAAG,CAAC3gC,IAAJ,CAASowB,OAAT,CAAkB,UAAAlsE,CAAC,EAAI;AACrB,qBAAI,CAACs7E,WAAL,CAAiB4H,YAAjB,CAA8B,0BAA9B,EAA0DljF,CAAC,CAAC8xC,GAA5D,EAAiE9xC,CAAjE;AACD,aAFD;;AAIA,mBAAI,CAACs7E,WAAL,CAAiB4H,YAAjB,CAA8B,iBAA9B,EAAiD,OAAI,CAAChY,IAAL,CAAUp5B,GAA3D,EAAgE,OAAI,CAACo5B,IAArE;AACD,WATD,EADW,CAaX;AACD;;;wDAE+B;AAAA;;AAE9BxsE,iBAAO,CAACC,GAAR,CAAY,MAAZ;AACAD,iBAAO,CAACC,GAAR,CAAY,KAAKusE,IAAjB;AAEA,eAAKoQ,WAAL,CAAiBiB,WAAjB,CAA6B,iBAA7B,EAAgD;AAC9CzgE,kBAAM,YAAK,KAAKovD,IAAL,CAAUyT,YAAf;AADwC,WAAhD,EAGC3J,IAHD,CAGO,UAAAyH,GAAG,EAAI;AACZA,eAAG,CAAC3gC,IAAJ,CAASowB,OAAT,CAAkB,UAAAz0E,CAAC,EAAI;AACrBA,eAAC,CAACqkB,MAAF,aAAc,OAAI,CAACovD,IAAL,CAAUp5B,GAAxB,EADqB,CAErB;;AAEAr6C,eAAC,CAACq6C,GAAF,GAAQ,OAAI,CAACo5B,IAAL,CAAUp5B,GAAV,GAAgBr6C,CAAC,CAACq6C,GAA1B;AAEApzC,qBAAO,CAACC,GAAR,CAAYlH,CAAZ;;AAGA,qBAAI,CAAC6jF,WAAL,CAAiB2B,SAAjB,CAA2B,0BAA3B,EAAuDxlF,CAAC,CAACq6C,GAAzD,EACGkjC,IADH,CACS,UAAAyH,GAAG,EAAI;AACZ/9E,uBAAO,CAACC,GAAR,CAAY89E,GAAZ;;AACA,uBAAI,CAACnB,WAAL,CAAiBuE,YAAjB,CAA8B,0BAA9B,EAA0DpoF,CAAC,CAACq6C,GAA5D,EAAiEr6C,CAAjE;AACD,eAJH,WAKU,UAAA0rF,GAAG,EAAI;AACbzkF,uBAAO,CAACC,GAAR,CAAYwkF,GAAZ;;AACA,uBAAI,CAAC7H,WAAL,CAAiB+C,YAAjB,CAA8B,0BAA9B,EAA0D5mF,CAA1D;AACD,eARH;AAUD,aAnBD;AAoBD,WAxBD;AAyBD;;;;;;;uBA5GUorF,4B,EAA4B,wI,EAAA,0H;AAAA,K;;;YAA5BA,4B;AAA4B,4C;AAAA;AAAA;AAAA;AAAA,O;AAAA,e;AAAA,a;AAAA,+tC;AAAA;AAAA;ACfzC;;AACE;;AACE;;AAEE;;AACE;;AACE;;AACA;;AACE;;AACF;;AAEF;;AACF;;AAEA;;AAMF;;AAEF;;AAGA;;AASE;;AACE;;AACI;;AAA8B;;AAAO;;AACrC;;AA2BJ;;AAEA;;AACE;;AAAmB;;AAAS;;AAC5B;;AAWJ;;AACE;;AACI;;AAAmB;;AAAsB;;AACzC;;AAMJ;;AACF;;AAGF;;AAEF;;;;AAxFiE;;AAAA;;AAErD;;AAAA;;;;;;;;;sEDOCA,4B,EAA4B;cALxC,uDAKwC;eAL9B;AACT38E,kBAAQ,EAAE,uBADD;AAETw0E,qBAAW,EAAE,wCAFJ;AAGTC,mBAAS,EAAE,CAAC,wCAAD;AAHF,S;AAK8B,Q;;;;;;;;gBAEtC,mD;iBAAM,M;;;gBACN,mD;iBAAM,a;;;;;;;;;;;;;;;;;;;;AElBT;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;QAOayI,2B;AAEX,6CAAc;AAAA;AAAG;;;;mCAET,CACP;;;;;;;uBALUA,2B;AAA2B,K;;;YAA3BA,2B;AAA2B,+C;AAAA,c;AAAA,a;AAAA;AAAA;ACPxC;;AAAG;;AAA2B;;;;;;;;sEDOjBA,2B,EAA2B;cALvC,uDAKuC;eAL7B;AACTl9E,kBAAQ,EAAE,0BADD;AAETw0E,qBAAW,EAAE,uCAFJ;AAGTC,mBAAS,EAAE,CAAC,uCAAD;AAHF,S;AAK6B,Q","file":"modules-design-design-module-es5.js","sourcesContent":["/**\n * jsBezier\n *\n * Copyright (c) 2010 - 2017 jsPlumb (hello@jsplumbtoolkit.com)\n *\n * licensed under the MIT license.\n *\n * a set of Bezier curve functions that deal with Beziers, used by jsPlumb, and perhaps useful for other people.  These functions work with Bezier\n * curves of arbitrary degree.\n *\n * - functions are all in the 'jsBezier' namespace.\n *\n * - all input points should be in the format {x:.., y:..}. all output points are in this format too.\n *\n * - all input curves should be in the format [ {x:.., y:..}, {x:.., y:..}, {x:.., y:..}, {x:.., y:..} ]\n *\n * - 'location' as used as an input here refers to a decimal in the range 0-1 inclusive, which indicates a point some proportion along the length\n * of the curve.  location as output has the same format and meaning.\n *\n *\n * Function List:\n * --------------\n *\n * distanceFromCurve(point, curve)\n *\n * \tCalculates the distance that the given point lies from the given Bezier.  Note that it is computed relative to the center of the Bezier,\n * so if you have stroked the curve with a wide pen you may wish to take that into account!  The distance returned is relative to the values\n * of the curve and the point - it will most likely be pixels.\n *\n * gradientAtPoint(curve, location)\n *\n * \tCalculates the gradient to the curve at the given location, as a decimal between 0 and 1 inclusive.\n *\n * gradientAtPointAlongCurveFrom (curve, location)\n *\n *\tCalculates the gradient at the point on the given curve that is 'distance' units from location.\n *\n * nearestPointOnCurve(point, curve)\n *\n *\tCalculates the nearest point to the given point on the given curve.  The return value of this is a JS object literal, containing both the\n *point's coordinates and also the 'location' of the point (see above), for example:  { point:{x:551,y:150}, location:0.263365 }.\n *\n * pointOnCurve(curve, location)\n *\n * \tCalculates the coordinates of the point on the given Bezier curve at the given location.\n *\n * pointAlongCurveFrom(curve, location, distance)\n *\n * \tCalculates the coordinates of the point on the given curve that is 'distance' units from location.  'distance' should be in the same coordinate\n * space as that used to construct the Bezier curve.  For an HTML Canvas usage, for example, distance would be a measure of pixels.\n *\n * locationAlongCurveFrom(curve, location, distance)\n *\n * \tCalculates the location on the given curve that is 'distance' units from location.  'distance' should be in the same coordinate\n * space as that used to construct the Bezier curve.  For an HTML Canvas usage, for example, distance would be a measure of pixels.\n *\n * perpendicularToCurveAt(curve, location, length, distance)\n *\n * \tCalculates the perpendicular to the given curve at the given location.  length is the length of the line you wish for (it will be centered\n * on the point at 'location'). distance is optional, and allows you to specify a point along the path from the given location as the center of\n * the perpendicular returned.  The return value of this is an array of two points: [ {x:...,y:...}, {x:...,y:...} ].\n *\n *\n */\n\n(function() {\n\n    var root = this;\n\n    if(typeof Math.sgn == \"undefined\") {\n        Math.sgn = function(x) { return x == 0 ? 0 : x > 0 ? 1 :-1; };\n    }\n\n    var Vectors = {\n            subtract \t: \tfunction(v1, v2) { return {x:v1.x - v2.x, y:v1.y - v2.y }; },\n            dotProduct\t: \tfunction(v1, v2) { return (v1.x * v2.x)  + (v1.y * v2.y); },\n            square\t\t:\tfunction(v) { return Math.sqrt((v.x * v.x) + (v.y * v.y)); },\n            scale\t\t:\tfunction(v, s) { return {x:v.x * s, y:v.y * s }; }\n        },\n\n        maxRecursion = 64,\n        flatnessTolerance = Math.pow(2.0,-maxRecursion-1);\n\n    /**\n     * Calculates the distance that the point lies from the curve.\n     *\n     * @param point a point in the form {x:567, y:3342}\n     * @param curve a Bezier curve in the form [{x:..., y:...}, {x:..., y:...}, {x:..., y:...}, {x:..., y:...}].  note that this is currently\n     * hardcoded to assume cubiz beziers, but would be better off supporting any degree.\n     * @return a JS object literal containing location and distance, for example: {location:0.35, distance:10}.  Location is analogous to the location\n     * argument you pass to the pointOnPath function: it is a ratio of distance travelled along the curve.  Distance is the distance in pixels from\n     * the point to the curve.\n     */\n    var _distanceFromCurve = function(point, curve) {\n        var candidates = [],\n            w = _convertToBezier(point, curve),\n            degree = curve.length - 1, higherDegree = (2 * degree) - 1,\n            numSolutions = _findRoots(w, higherDegree, candidates, 0),\n            v = Vectors.subtract(point, curve[0]), dist = Vectors.square(v), t = 0.0;\n\n        for (var i = 0; i < numSolutions; i++) {\n            v = Vectors.subtract(point, _bezier(curve, degree, candidates[i], null, null));\n            var newDist = Vectors.square(v);\n            if (newDist < dist) {\n                dist = newDist;\n                t = candidates[i];\n            }\n        }\n        v = Vectors.subtract(point, curve[degree]);\n        newDist = Vectors.square(v);\n        if (newDist < dist) {\n            dist = newDist;\n            t = 1.0;\n        }\n        return {location:t, distance:dist};\n    };\n    /**\n     * finds the nearest point on the curve to the given point.\n     */\n    var _nearestPointOnCurve = function(point, curve) {\n        var td = _distanceFromCurve(point, curve);\n        return {point:_bezier(curve, curve.length - 1, td.location, null, null), location:td.location};\n    };\n    var _convertToBezier = function(point, curve) {\n        var degree = curve.length - 1, higherDegree = (2 * degree) - 1,\n            c = [], d = [], cdTable = [], w = [],\n            z = [ [1.0, 0.6, 0.3, 0.1], [0.4, 0.6, 0.6, 0.4], [0.1, 0.3, 0.6, 1.0] ];\n\n        for (var i = 0; i <= degree; i++) c[i] = Vectors.subtract(curve[i], point);\n        for (var i = 0; i <= degree - 1; i++) {\n            d[i] = Vectors.subtract(curve[i+1], curve[i]);\n            d[i] = Vectors.scale(d[i], 3.0);\n        }\n        for (var row = 0; row <= degree - 1; row++) {\n            for (var column = 0; column <= degree; column++) {\n                if (!cdTable[row]) cdTable[row] = [];\n                cdTable[row][column] = Vectors.dotProduct(d[row], c[column]);\n            }\n        }\n        for (i = 0; i <= higherDegree; i++) {\n            if (!w[i]) w[i] = [];\n            w[i].y = 0.0;\n            w[i].x = parseFloat(i) / higherDegree;\n        }\n        var n = degree, m = degree-1;\n        for (var k = 0; k <= n + m; k++) {\n            var lb = Math.max(0, k - m),\n                ub = Math.min(k, n);\n            for (i = lb; i <= ub; i++) {\n                var j = k - i;\n                w[i+j].y += cdTable[j][i] * z[j][i];\n            }\n        }\n        return w;\n    };\n    /**\n     * counts how many roots there are.\n     */\n    var _findRoots = function(w, degree, t, depth) {\n        var left = [], right = [],\n            left_count, right_count,\n            left_t = [], right_t = [];\n\n        switch (_getCrossingCount(w, degree)) {\n            case 0 : {\n                return 0;\n            }\n            case 1 : {\n                if (depth >= maxRecursion) {\n                    t[0] = (w[0].x + w[degree].x) / 2.0;\n                    return 1;\n                }\n                if (_isFlatEnough(w, degree)) {\n                    t[0] = _computeXIntercept(w, degree);\n                    return 1;\n                }\n                break;\n            }\n        }\n        _bezier(w, degree, 0.5, left, right);\n        left_count  = _findRoots(left,  degree, left_t, depth+1);\n        right_count = _findRoots(right, degree, right_t, depth+1);\n        for (var i = 0; i < left_count; i++) t[i] = left_t[i];\n        for (var i = 0; i < right_count; i++) t[i+left_count] = right_t[i];\n        return (left_count+right_count);\n    };\n    var _getCrossingCount = function(curve, degree) {\n        var n_crossings = 0, sign, old_sign;\n        sign = old_sign = Math.sgn(curve[0].y);\n        for (var i = 1; i <= degree; i++) {\n            sign = Math.sgn(curve[i].y);\n            if (sign != old_sign) n_crossings++;\n            old_sign = sign;\n        }\n        return n_crossings;\n    };\n    var _isFlatEnough = function(curve, degree) {\n        var  error,\n            intercept_1, intercept_2, left_intercept, right_intercept,\n            a, b, c, det, dInv, a1, b1, c1, a2, b2, c2;\n        a = curve[0].y - curve[degree].y;\n        b = curve[degree].x - curve[0].x;\n        c = curve[0].x * curve[degree].y - curve[degree].x * curve[0].y;\n\n        var max_distance_above, max_distance_below;\n        max_distance_above = max_distance_below = 0.0;\n\n        for (var i = 1; i < degree; i++) {\n            var value = a * curve[i].x + b * curve[i].y + c;\n            if (value > max_distance_above)\n                max_distance_above = value;\n            else if (value < max_distance_below)\n                max_distance_below = value;\n        }\n\n        a1 = 0.0; b1 = 1.0; c1 = 0.0; a2 = a; b2 = b;\n        c2 = c - max_distance_above;\n        det = a1 * b2 - a2 * b1;\n        dInv = 1.0/det;\n        intercept_1 = (b1 * c2 - b2 * c1) * dInv;\n        a2 = a; b2 = b; c2 = c - max_distance_below;\n        det = a1 * b2 - a2 * b1;\n        dInv = 1.0/det;\n        intercept_2 = (b1 * c2 - b2 * c1) * dInv;\n        left_intercept = Math.min(intercept_1, intercept_2);\n        right_intercept = Math.max(intercept_1, intercept_2);\n        error = right_intercept - left_intercept;\n        return (error < flatnessTolerance)? 1 : 0;\n    };\n    var _computeXIntercept = function(curve, degree) {\n        var XLK = 1.0, YLK = 0.0,\n            XNM = curve[degree].x - curve[0].x, YNM = curve[degree].y - curve[0].y,\n            XMK = curve[0].x - 0.0, YMK = curve[0].y - 0.0,\n            det = XNM*YLK - YNM*XLK, detInv = 1.0/det,\n            S = (XNM*YMK - YNM*XMK) * detInv;\n        return 0.0 + XLK * S;\n    };\n    var _bezier = function(curve, degree, t, left, right) {\n        var temp = [[]];\n        for (var j =0; j <= degree; j++) temp[0][j] = curve[j];\n        for (var i = 1; i <= degree; i++) {\n            for (var j =0 ; j <= degree - i; j++) {\n                if (!temp[i]) temp[i] = [];\n                if (!temp[i][j]) temp[i][j] = {};\n                temp[i][j].x = (1.0 - t) * temp[i-1][j].x + t * temp[i-1][j+1].x;\n                temp[i][j].y = (1.0 - t) * temp[i-1][j].y + t * temp[i-1][j+1].y;\n            }\n        }\n        if (left != null)\n            for (j = 0; j <= degree; j++) left[j]  = temp[j][0];\n        if (right != null)\n            for (j = 0; j <= degree; j++) right[j] = temp[degree-j][j];\n\n        return (temp[degree][0]);\n    };\n\n    var _curveFunctionCache = {};\n    var _getCurveFunctions = function(order) {\n        var fns = _curveFunctionCache[order];\n        if (!fns) {\n            fns = [];\n            var f_term = function() { return function(t) { return Math.pow(t, order); }; },\n                l_term = function() { return function(t) { return Math.pow((1-t), order); }; },\n                c_term = function(c) { return function(t) { return c; }; },\n                t_term = function() { return function(t) { return t; }; },\n                one_minus_t_term = function() { return function(t) { return 1-t; }; },\n                _termFunc = function(terms) {\n                    return function(t) {\n                        var p = 1;\n                        for (var i = 0; i < terms.length; i++) p = p * terms[i](t);\n                        return p;\n                    };\n                };\n\n            fns.push(new f_term());  // first is t to the power of the curve order\n            for (var i = 1; i < order; i++) {\n                var terms = [new c_term(order)];\n                for (var j = 0 ; j < (order - i); j++) terms.push(new t_term());\n                for (var j = 0 ; j < i; j++) terms.push(new one_minus_t_term());\n                fns.push(new _termFunc(terms));\n            }\n            fns.push(new l_term());  // last is (1-t) to the power of the curve order\n\n            _curveFunctionCache[order] = fns;\n        }\n\n        return fns;\n    };\n\n\n    /**\n     * calculates a point on the curve, for a Bezier of arbitrary order.\n     * @param curve an array of control points, eg [{x:10,y:20}, {x:50,y:50}, {x:100,y:100}, {x:120,y:100}].  For a cubic bezier this should have four points.\n     * @param location a decimal indicating the distance along the curve the point should be located at.  this is the distance along the curve as it travels, taking the way it bends into account.  should be a number from 0 to 1, inclusive.\n     */\n    var _pointOnPath = function(curve, location) {\n        var cc = _getCurveFunctions(curve.length - 1),\n            _x = 0, _y = 0;\n        for (var i = 0; i < curve.length ; i++) {\n            _x = _x + (curve[i].x * cc[i](location));\n            _y = _y + (curve[i].y * cc[i](location));\n        }\n\n        return {x:_x, y:_y};\n    };\n\n    var _dist = function(p1,p2) {\n        return Math.sqrt(Math.pow(p1.x - p2.x, 2) + Math.pow(p1.y - p2.y, 2));\n    };\n\n    var _isPoint = function(curve) {\n        return curve[0].x === curve[1].x && curve[0].y === curve[1].y;\n    };\n\n    /**\n     * finds the point that is 'distance' along the path from 'location'.  this method returns both the x,y location of the point and also\n     * its 'location' (proportion of travel along the path); the method below - _pointAlongPathFrom - calls this method and just returns the\n     * point.\n     */\n    var _pointAlongPath = function(curve, location, distance) {\n        \n        if (_isPoint(curve)) {\n            return {\n                point:curve[0],\n                location:location\n            };\n        }\n\n        var prev = _pointOnPath(curve, location),\n            tally = 0,\n            curLoc = location,\n            direction = distance > 0 ? 1 : -1,\n            cur = null;\n\n        while (tally < Math.abs(distance)) {\n            curLoc += (0.005 * direction);\n            cur = _pointOnPath(curve, curLoc);\n            tally += _dist(cur, prev);\n            prev = cur;\n        }\n\n        return {point:cur, location:curLoc};\n    };\n\n    var _length = function(curve) {\n\n        var d = new Date().getTime();\n\n        if (_isPoint(curve)) return 0;\n\n        var prev = _pointOnPath(curve, 0),\n            tally = 0,\n            curLoc = 0,\n            direction = 1,\n            cur = null;\n\n        while (curLoc < 1) {\n            curLoc += (0.005 * direction);\n            cur = _pointOnPath(curve, curLoc);\n            tally += _dist(cur, prev);\n            prev = cur;\n        }\n        console.log(\"length\", new Date().getTime() - d);\n\n        return tally;\n    };\n\n    /**\n     * finds the point that is 'distance' along the path from 'location'.\n     */\n    var _pointAlongPathFrom = function(curve, location, distance) {\n        return _pointAlongPath(curve, location, distance).point;\n    };\n\n    /**\n     * finds the location that is 'distance' along the path from 'location'.\n     */\n    var _locationAlongPathFrom = function(curve, location, distance) {\n        return _pointAlongPath(curve, location, distance).location;\n    };\n\n    /**\n     * returns the gradient of the curve at the given location, which is a decimal between 0 and 1 inclusive.\n     *\n     * thanks // http://bimixual.org/AnimationLibrary/beziertangents.html\n     */\n    var _gradientAtPoint = function(curve, location) {\n\n        var p1 = _pointOnPath(curve, location),\n            p2 = _pointOnPath(curve.slice(0, curve.length - 1), location),\n            dy = p2.y - p1.y, dx = p2.x - p1.x;\n\n        return dy === 0 ? Infinity : Math.atan(dy / dx);\n    };\n\n    /**\n     returns the gradient of the curve at the point which is 'distance' from the given location.\n     if this point is greater than location 1, the gradient at location 1 is returned.\n     if this point is less than location 0, the gradient at location 0 is returned.\n     */\n    var _gradientAtPointAlongPathFrom = function(curve, location, distance) {\n        var p = _pointAlongPath(curve, location, distance);\n        if (p.location > 1) p.location = 1;\n        if (p.location < 0) p.location = 0;\n        return _gradientAtPoint(curve, p.location);\n    };\n\n    /**\n     * calculates a line that is 'length' pixels long, perpendicular to, and centered on, the path at 'distance' pixels from the given location.\n     * if distance is not supplied, the perpendicular for the given location is computed (ie. we set distance to zero).\n     */\n    var _perpendicularToPathAt = function(curve, location, length, distance) {\n        distance = distance == null ? 0 : distance;\n        var p = _pointAlongPath(curve, location, distance),\n            m = _gradientAtPoint(curve, p.location),\n            _theta2 = Math.atan(-1 / m),\n            y =  length / 2 * Math.sin(_theta2),\n            x =  length / 2 * Math.cos(_theta2);\n        return [{x:p.point.x + x, y:p.point.y + y}, {x:p.point.x - x, y:p.point.y - y}];\n    };\n\n    /**\n     * Calculates all intersections of the given line with the given curve.\n     * @param x1\n     * @param y1\n     * @param x2\n     * @param y2\n     * @param curve\n     * @returns {Array}\n     */\n    var _lineIntersection = function(x1, y1, x2, y2, curve) {\n        var a = y2 - y1,\n            b = x1 - x2,\n            c = (x1 * (y1 - y2)) + (y1 * (x2-x1)),\n            coeffs = _computeCoefficients(curve),\n            p = [\n                (a*coeffs[0][0]) + (b * coeffs[1][0]),\n                (a*coeffs[0][1])+(b*coeffs[1][1]),\n                (a*coeffs[0][2])+(b*coeffs[1][2]),\n                (a*coeffs[0][3])+(b*coeffs[1][3]) + c\n            ],\n            r = _cubicRoots.apply(null, p),\n            intersections = [];\n\n        if (r != null) {\n\n            for (var i = 0; i < 3; i++) {\n                var t = r[i],\n                    t2 = Math.pow(t, 2),\n                    t3 = Math.pow(t, 3),\n                    x = [\n                        (coeffs[0][0] * t3) + (coeffs[0][1] * t2) + (coeffs[0][2] * t) + coeffs[0][3],\n                        (coeffs[1][0] * t3) + (coeffs[1][1] * t2) + (coeffs[1][2] * t) + coeffs[1][3]\n                    ];\n\n                // check bounds of the line\n                var s;\n                if ((x2 - x1) !== 0) {\n                    s = (x[0] - x1) / (x2 - x1);\n                }\n                else {\n                    s = (x[1] - y1) / (y2 - y1);\n                }\n\n                if (t >= 0 && t <= 1.0 && s >= 0 && s <= 1.0) {\n                    intersections.push(x);\n                }\n            }\n        }\n\n        return intersections;\n    };\n\n    /**\n     * Calculates all intersections of the given box with the given curve.\n     * @param x X position of top left corner of box\n     * @param y Y position of top left corner of box\n     * @param w width of box\n     * @param h height of box\n     * @param curve\n     * @returns {Array}\n     */\n    var _boxIntersection = function(x, y, w, h, curve) {\n        var i = [];\n        i.push.apply(i, _lineIntersection(x, y, x + w, y, curve));\n        i.push.apply(i, _lineIntersection(x + w, y, x + w, y + h, curve));\n        i.push.apply(i, _lineIntersection(x + w, y + h, x, y + h, curve));\n        i.push.apply(i, _lineIntersection(x, y + h, x, y, curve));\n        return i;\n    };\n\n    /**\n     * Calculates all intersections of the given bounding box with the given curve.\n     * @param boundingBox Bounding box, in { x:.., y:..., w:..., h:... } format.\n     * @param curve\n     * @returns {Array}\n     */\n    var _boundingBoxIntersection = function(boundingBox, curve) {\n        var i = [];\n        i.push.apply(i, _lineIntersection(boundingBox.x, boundingBox.y, boundingBox.x + boundingBox.w, boundingBox.y, curve));\n        i.push.apply(i, _lineIntersection(boundingBox.x + boundingBox.w, boundingBox.y, boundingBox.x + boundingBox.w, boundingBox.y + boundingBox.h, curve));\n        i.push.apply(i, _lineIntersection(boundingBox.x + boundingBox.w, boundingBox.y + boundingBox.h, boundingBox.x, boundingBox.y + boundingBox.h, curve));\n        i.push.apply(i, _lineIntersection(boundingBox.x, boundingBox.y + boundingBox.h, boundingBox.x, boundingBox.y, curve));\n        return i;\n    };\n\n\n    function _computeCoefficientsForAxis(curve, axis) {\n        return [\n            -(curve[0][axis]) + (3*curve[1][axis]) + (-3 * curve[2][axis]) + curve[3][axis],\n            (3*(curve[0][axis])) - (6*(curve[1][axis])) + (3*(curve[2][axis])),\n            -3*curve[0][axis] + 3*curve[1][axis],\n            curve[0][axis]\n        ];\n    }\n\n    function _computeCoefficients(curve)\n    {\n        return [\n            _computeCoefficientsForAxis(curve, \"x\"),\n            _computeCoefficientsForAxis(curve, \"y\")\n        ];\n    }\n\n    function sgn(x) {\n        return x < 0 ? -1 : x > 0 ? 1 : 0;\n    }\n\n    function _cubicRoots(a, b, c, d) {\n        var A = b / a,\n            B = c / a,\n            C = d / a,\n            Q = (3*B - Math.pow(A, 2))/9,\n            R = (9*A*B - 27*C - 2*Math.pow(A, 3))/54,\n            D = Math.pow(Q, 3) + Math.pow(R, 2),\n            S,\n            T,\n            t = [];\n\n        if (D >= 0)                                 // complex or duplicate roots\n        {\n            S = sgn(R + Math.sqrt(D))*Math.pow(Math.abs(R + Math.sqrt(D)),(1/3));\n            T = sgn(R - Math.sqrt(D))*Math.pow(Math.abs(R - Math.sqrt(D)),(1/3));\n\n            t[0] = -A/3 + (S + T);\n            t[1] = -A/3 - (S + T)/2;\n            t[2] = -A/3 - (S + T)/2;\n\n            /*discard complex roots*/\n            if (Math.abs(Math.sqrt(3)*(S - T)/2) !== 0) {\n                t[1] = -1;\n                t[2] = -1;\n            }\n        }\n        else                                          // distinct real roots\n        {\n            var th = Math.acos(R/Math.sqrt(-Math.pow(Q, 3)));\n            t[0] = 2*Math.sqrt(-Q)*Math.cos(th/3) - A/3;\n            t[1] = 2*Math.sqrt(-Q)*Math.cos((th + 2*Math.PI)/3) - A/3;\n            t[2] = 2*Math.sqrt(-Q)*Math.cos((th + 4*Math.PI)/3) - A/3;\n        }\n\n        // discard out of spec roots\n        for (var i = 0; i < 3; i++) {\n            if (t[i] < 0 || t[i] > 1.0) {\n                t[i] = -1;\n            }\n        }\n\n        return t;\n    }\n\n    var jsBezier = this.jsBezier = {\n        distanceFromCurve : _distanceFromCurve,\n        gradientAtPoint : _gradientAtPoint,\n        gradientAtPointAlongCurveFrom : _gradientAtPointAlongPathFrom,\n        nearestPointOnCurve : _nearestPointOnCurve,\n        pointOnCurve : _pointOnPath,\n        pointAlongCurveFrom : _pointAlongPathFrom,\n        perpendicularToCurveAt : _perpendicularToPathAt,\n        locationAlongCurveFrom:_locationAlongPathFrom,\n        getLength:_length,\n        lineIntersection:_lineIntersection,\n        boxIntersection:_boxIntersection,\n        boundingBoxIntersection:_boundingBoxIntersection,\n        version:\"0.9.0\"\n    };\n\n    if (typeof exports !== \"undefined\") {\n        exports.jsBezier = jsBezier;\n    }\n\n}).call(typeof window !== 'undefined' ? window : this);\n\n/**\n * Biltong v0.4.0\n *\n * Various geometry functions written as part of jsPlumb and perhaps useful for others.\n *\n * Copyright (c) 2017 jsPlumb\n * https://jsplumbtoolkit.com\n *\n * Permission is hereby granted, free of charge, to any person\n * obtaining a copy of this software and associated documentation\n * files (the \"Software\"), to deal in the Software without\n * restriction, including without limitation the rights to use,\n * copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following\n * conditions:\n *\n * The above copyright notice and this permission notice shall be\n * included in all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\n * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES\n * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\n * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,\n * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR\n * OTHER DEALINGS IN THE SOFTWARE.\n */\n;(function() {\n\n    \"use strict\";\n    var root = this;\n\n    var Biltong = root.Biltong = {\n        version:\"0.4.0\"\n    };\n\n    if (typeof exports !== \"undefined\") {\n        exports.Biltong = Biltong;\n    }\n\n    var _isa = function(a) { return Object.prototype.toString.call(a) === \"[object Array]\"; },\n        _pointHelper = function(p1, p2, fn) {\n            p1 = _isa(p1) ? p1 : [p1.x, p1.y];\n            p2 = _isa(p2) ? p2 : [p2.x, p2.y];\n            return fn(p1, p2);\n        },\n        /**\n         * @name Biltong.gradient\n         * @function\n         * @desc Calculates the gradient of a line between the two points.\n         * @param {Point} p1 First point, either as a 2 entry array or object with `left` and `top` properties.\n         * @param {Point} p2 Second point, either as a 2 entry array or object with `left` and `top` properties.\n         * @return {Float} The gradient of a line between the two points.\n         */\n        _gradient = Biltong.gradient = function(p1, p2) {\n            return _pointHelper(p1, p2, function(_p1, _p2) {\n                if (_p2[0] == _p1[0])\n                    return _p2[1] > _p1[1] ? Infinity : -Infinity;\n                else if (_p2[1] == _p1[1])\n                    return _p2[0] > _p1[0] ? 0 : -0;\n                else\n                    return (_p2[1] - _p1[1]) / (_p2[0] - _p1[0]);\n            });\n        },\n        /**\n         * @name Biltong.normal\n         * @function\n         * @desc Calculates the gradient of a normal to a line between the two points.\n         * @param {Point} p1 First point, either as a 2 entry array or object with `left` and `top` properties.\n         * @param {Point} p2 Second point, either as a 2 entry array or object with `left` and `top` properties.\n         * @return {Float} The gradient of a normal to a line between the two points.\n         */\n        _normal = Biltong.normal = function(p1, p2) {\n            return -1 / _gradient(p1, p2);\n        },\n        /**\n         * @name Biltong.lineLength\n         * @function\n         * @desc Calculates the length of a line between the two points.\n         * @param {Point} p1 First point, either as a 2 entry array or object with `left` and `top` properties.\n         * @param {Point} p2 Second point, either as a 2 entry array or object with `left` and `top` properties.\n         * @return {Float} The length of a line between the two points.\n         */\n        _lineLength = Biltong.lineLength = function(p1, p2) {\n            return _pointHelper(p1, p2, function(_p1, _p2) {\n                return Math.sqrt(Math.pow(_p2[1] - _p1[1], 2) + Math.pow(_p2[0] - _p1[0], 2));\n            });\n        },\n        /**\n         * @name Biltong.quadrant\n         * @function\n         * @desc Calculates the quadrant in which the angle between the two points lies.\n         * @param {Point} p1 First point, either as a 2 entry array or object with `left` and `top` properties.\n         * @param {Point} p2 Second point, either as a 2 entry array or object with `left` and `top` properties.\n         * @return {Integer} The quadrant - 1 for upper right, 2 for lower right, 3 for lower left, 4 for upper left.\n         */\n        _quadrant = Biltong.quadrant = function(p1, p2) {\n            return _pointHelper(p1, p2, function(_p1, _p2) {\n                if (_p2[0] > _p1[0]) {\n                    return (_p2[1] > _p1[1]) ? 2 : 1;\n                }\n                else if (_p2[0] == _p1[0]) {\n                    return _p2[1] > _p1[1] ? 2 : 1;\n                }\n                else {\n                    return (_p2[1] > _p1[1]) ? 3 : 4;\n                }\n            });\n        },\n        /**\n         * @name Biltong.theta\n         * @function\n         * @desc Calculates the angle between the two points.\n         * @param {Point} p1 First point, either as a 2 entry array or object with `left` and `top` properties.\n         * @param {Point} p2 Second point, either as a 2 entry array or object with `left` and `top` properties.\n         * @return {Float} The angle between the two points.\n         */\n        _theta = Biltong.theta = function(p1, p2) {\n            return _pointHelper(p1, p2, function(_p1, _p2) {\n                var m = _gradient(_p1, _p2),\n                    t = Math.atan(m),\n                    s = _quadrant(_p1, _p2);\n                if ((s == 4 || s== 3)) t += Math.PI;\n                if (t < 0) t += (2 * Math.PI);\n\n                return t;\n            });\n        },\n        /**\n         * @name Biltong.intersects\n         * @function\n         * @desc Calculates whether or not the two rectangles intersect.\n         * @param {Rectangle} r1 First rectangle, as a js object in the form `{x:.., y:.., w:.., h:..}`\n         * @param {Rectangle} r2 Second rectangle, as a js object in the form `{x:.., y:.., w:.., h:..}`\n         * @return {Boolean} True if the rectangles intersect, false otherwise.\n         */\n        _intersects = Biltong.intersects = function(r1, r2) {\n            var x1 = r1.x, x2 = r1.x + r1.w, y1 = r1.y, y2 = r1.y + r1.h,\n                a1 = r2.x, a2 = r2.x + r2.w, b1 = r2.y, b2 = r2.y + r2.h;\n\n            return  ( (x1 <= a1 && a1 <= x2) && (y1 <= b1 && b1 <= y2) ) ||\n                ( (x1 <= a2 && a2 <= x2) && (y1 <= b1 && b1 <= y2) ) ||\n                ( (x1 <= a1 && a1 <= x2) && (y1 <= b2 && b2 <= y2) ) ||\n                ( (x1 <= a2 && a1 <= x2) && (y1 <= b2 && b2 <= y2) ) ||\n                ( (a1 <= x1 && x1 <= a2) && (b1 <= y1 && y1 <= b2) ) ||\n                ( (a1 <= x2 && x2 <= a2) && (b1 <= y1 && y1 <= b2) ) ||\n                ( (a1 <= x1 && x1 <= a2) && (b1 <= y2 && y2 <= b2) ) ||\n                ( (a1 <= x2 && x1 <= a2) && (b1 <= y2 && y2 <= b2) );\n        },\n        /**\n         * @name Biltong.encloses\n         * @function\n         * @desc Calculates whether or not r2 is completely enclosed by r1.\n         * @param {Rectangle} r1 First rectangle, as a js object in the form `{x:.., y:.., w:.., h:..}`\n         * @param {Rectangle} r2 Second rectangle, as a js object in the form `{x:.., y:.., w:.., h:..}`\n         * @param {Boolean} [allowSharedEdges=false] If true, the concept of enclosure allows for one or more edges to be shared by the two rectangles.\n         * @return {Boolean} True if r1 encloses r2, false otherwise.\n         */\n        _encloses = Biltong.encloses = function(r1, r2, allowSharedEdges) {\n            var x1 = r1.x, x2 = r1.x + r1.w, y1 = r1.y, y2 = r1.y + r1.h,\n                a1 = r2.x, a2 = r2.x + r2.w, b1 = r2.y, b2 = r2.y + r2.h,\n                c = function(v1, v2, v3, v4) { return allowSharedEdges ? v1 <= v2 && v3>= v4 : v1 < v2 && v3 > v4; };\n\n            return c(x1,a1,x2,a2) && c(y1,b1,y2,b2);\n        },\n        _segmentMultipliers = [null, [1, -1], [1, 1], [-1, 1], [-1, -1] ],\n        _inverseSegmentMultipliers = [null, [-1, -1], [-1, 1], [1, 1], [1, -1] ],\n        /**\n         * @name Biltong.pointOnLine\n         * @function\n         * @desc Calculates a point on the line from `fromPoint` to `toPoint` that is `distance` units along the length of the line.\n         * @param {Point} p1 First point, either as a 2 entry array or object with `left` and `top` properties.\n         * @param {Point} p2 Second point, either as a 2 entry array or object with `left` and `top` properties.\n         * @return {Point} Point on the line, in the form `{ x:..., y:... }`.\n         */\n        _pointOnLine = Biltong.pointOnLine = function(fromPoint, toPoint, distance) {\n            var m = _gradient(fromPoint, toPoint),\n                s = _quadrant(fromPoint, toPoint),\n                segmentMultiplier = distance > 0 ? _segmentMultipliers[s] : _inverseSegmentMultipliers[s],\n                theta = Math.atan(m),\n                y = Math.abs(distance * Math.sin(theta)) * segmentMultiplier[1],\n                x =  Math.abs(distance * Math.cos(theta)) * segmentMultiplier[0];\n            return { x:fromPoint.x + x, y:fromPoint.y + y };\n        },\n        /**\n         * @name Biltong.perpendicularLineTo\n         * @function\n         * @desc Calculates a line of length `length` that is perpendicular to the line from `fromPoint` to `toPoint` and passes through `toPoint`.\n         * @param {Point} p1 First point, either as a 2 entry array or object with `left` and `top` properties.\n         * @param {Point} p2 Second point, either as a 2 entry array or object with `left` and `top` properties.\n         * @return {Line} Perpendicular line, in the form `[ { x:..., y:... }, { x:..., y:... } ]`.\n         */\n        _perpendicularLineTo = Biltong.perpendicularLineTo = function(fromPoint, toPoint, length) {\n            var m = _gradient(fromPoint, toPoint),\n                theta2 = Math.atan(-1 / m),\n                y =  length / 2 * Math.sin(theta2),\n                x =  length / 2 * Math.cos(theta2);\n            return [{x:toPoint.x + x, y:toPoint.y + y}, {x:toPoint.x - x, y:toPoint.y - y}];\n        };\n}).call(typeof window !== 'undefined' ? window : this);\n;\n(function () {\n\n    \"use strict\";\n\n    /**\n     * Creates a Touch object.\n     * @param view\n     * @param target\n     * @param pageX\n     * @param pageY\n     * @param screenX\n     * @param screenY\n     * @param clientX\n     * @param clientY\n     * @returns {Touch}\n     * @private\n     */\n    function _touch(view, target, pageX, pageY, screenX, screenY, clientX, clientY) {\n\n            return new Touch({\n                target:target,\n                identifier:_uuid(),\n                pageX: pageX,\n                pageY: pageY,\n                screenX: screenX,\n                screenY: screenY,\n                clientX: clientX || screenX,\n                clientY: clientY || screenY\n            });\n    }\n\n    /**\n     * Create a synthetic touch list from the given list of Touch objects.\n     * @returns {Array}\n     * @private\n     */\n    function _touchList() {\n        var list = [];\n        Array.prototype.push.apply(list, arguments);\n        list.item =  function(index) { return this[index]; };\n        return list;\n    }\n\n    /**\n     * Create a Touch object and then insert it into a synthetic touch list, returning the list.s\n     * @param view\n     * @param target\n     * @param pageX\n     * @param pageY\n     * @param screenX\n     * @param screenY\n     * @param clientX\n     * @param clientY\n     * @returns {Array}\n     * @private\n     */\n    function _touchAndList(view, target, pageX, pageY, screenX, screenY, clientX, clientY) {\n        return _touchList(_touch.apply(null, arguments));\n    }\n\n    var root = this,\n        matchesSelector = function (el, selector, ctx) {\n            ctx = ctx || el.parentNode;\n            var possibles = ctx.querySelectorAll(selector);\n            for (var i = 0; i < possibles.length; i++) {\n                if (possibles[i] === el) {\n                    return true;\n                }\n            }\n            return false;\n        },\n        _gel = function (el) {\n            return (typeof el == \"string\" || el.constructor === String) ? document.getElementById(el) : el;\n        },\n        _t = function (e) {\n            return e.srcElement || e.target;\n        },\n    //\n    // gets path info for the given event - the path from target to obj, in the event's bubble chain. if doCompute\n    // is false we just return target for the path.\n    //\n        _pi = function(e, target, obj, doCompute) {\n            if (!doCompute) return { path:[target], end:1 };\n            else if (typeof e.path !== \"undefined\" && e.path.indexOf) {\n                return { path: e.path, end: e.path.indexOf(obj) };\n            } else {\n                var out = { path:[], end:-1 }, _one = function(el) {\n                    out.path.push(el);\n                    if (el === obj) {\n                        out.end = out.path.length - 1;\n                    }\n                    else if (el.parentNode != null) {\n                        _one(el.parentNode)\n                    }\n                };\n                _one(target);\n                return out;\n            }\n        },\n        _d = function (l, fn) {\n            for (var i = 0, j = l.length; i < j; i++) {\n                if (l[i] == fn) break;\n            }\n            if (i < l.length) l.splice(i, 1);\n        },\n        guid = 1,\n    //\n    // this function generates a guid for every handler, sets it on the handler, then adds\n    // it to the associated object's map of handlers for the given event. this is what enables us\n    // to unbind all events of some type, or all events (the second of which can be requested by the user,\n    // but it also used by Mottle when an element is removed.)\n        _store = function (obj, event, fn) {\n            var g = guid++;\n            obj.__ta = obj.__ta || {};\n            obj.__ta[event] = obj.__ta[event] || {};\n            // store each handler with a unique guid.\n            obj.__ta[event][g] = fn;\n            // set the guid on the handler.\n            fn.__tauid = g;\n            return g;\n        },\n        _unstore = function (obj, event, fn) {\n            obj.__ta && obj.__ta[event] && delete obj.__ta[event][fn.__tauid];\n            // a handler might have attached extra functions, so we unbind those too.\n            if (fn.__taExtra) {\n                for (var i = 0; i < fn.__taExtra.length; i++) {\n                    _unbind(obj, fn.__taExtra[i][0], fn.__taExtra[i][1]);\n                }\n                fn.__taExtra.length = 0;\n            }\n            // a handler might have attached an unstore callback\n            fn.__taUnstore && fn.__taUnstore();\n        },\n        _curryChildFilter = function (children, obj, fn, evt) {\n            if (children == null) return fn;\n            else {\n                var c = children.split(\",\"),\n                    _fn = function (e) {\n                        _fn.__tauid = fn.__tauid;\n                        var t = _t(e), target = t;  // t is the target element on which the event occurred. it is the\n                        // element we will wish to pass to any callbacks.\n                        var pathInfo = _pi(e, t, obj, children != null)\n                        if (pathInfo.end != -1) {\n                            for (var p = 0; p < pathInfo.end; p++) {\n                                target = pathInfo.path[p];\n                                for (var i = 0; i < c.length; i++) {\n                                    if (matchesSelector(target, c[i], obj)) {\n                                        fn.apply(target, arguments);\n                                    }\n                                }\n                            }\n                        }\n                    };\n                registerExtraFunction(fn, evt, _fn);\n                return _fn;\n            }\n        },\n    //\n    // registers an 'extra' function on some event listener function we were given - a function that we\n    // created and bound to the element as part of our housekeeping, and which we want to unbind and remove\n    // whenever the given function is unbound.\n        registerExtraFunction = function (fn, evt, newFn) {\n            fn.__taExtra = fn.__taExtra || [];\n            fn.__taExtra.push([evt, newFn]);\n        },\n        DefaultHandler = function (obj, evt, fn, children) {\n            if (isTouchDevice && touchMap[evt]) {\n                var tfn = _curryChildFilter(children, obj, fn, touchMap[evt]);\n                _bind(obj, touchMap[evt], tfn , fn);\n            }\n            if (evt === \"focus\" && obj.getAttribute(\"tabindex\") == null) {\n                obj.setAttribute(\"tabindex\", \"1\");\n            }\n            _bind(obj, evt, _curryChildFilter(children, obj, fn, evt), fn);\n        },\n        SmartClickHandler = function (obj, evt, fn, children) {\n            if (obj.__taSmartClicks == null) {\n                var down = function (e) {\n                        obj.__tad = _pageLocation(e);\n                    },\n                    up = function (e) {\n                        obj.__tau = _pageLocation(e);\n                    },\n                    click = function (e) {\n                        if (obj.__tad && obj.__tau && obj.__tad[0] === obj.__tau[0] && obj.__tad[1] === obj.__tau[1]) {\n                            for (var i = 0; i < obj.__taSmartClicks.length; i++)\n                                obj.__taSmartClicks[i].apply(_t(e), [ e ]);\n                        }\n                    };\n                DefaultHandler(obj, \"mousedown\", down, children);\n                DefaultHandler(obj, \"mouseup\", up, children);\n                DefaultHandler(obj, \"click\", click, children);\n                obj.__taSmartClicks = [];\n            }\n\n            // store in the list of callbacks\n            obj.__taSmartClicks.push(fn);\n            // the unstore function removes this function from the object's listener list for this type.\n            fn.__taUnstore = function () {\n                _d(obj.__taSmartClicks, fn);\n            };\n        },\n        _tapProfiles = {\n            \"tap\": {touches: 1, taps: 1},\n            \"dbltap\": {touches: 1, taps: 2},\n            \"contextmenu\": {touches: 2, taps: 1}\n        },\n        TapHandler = function (clickThreshold, dblClickThreshold) {\n            return function (obj, evt, fn, children) {\n                // if event is contextmenu, for devices which are mouse only, we want to\n                // use the default bind.\n                if (evt == \"contextmenu\" && isMouseDevice)\n                    DefaultHandler(obj, evt, fn, children);\n                else {\n                    // the issue here is that this down handler gets registered only for the\n                    // child nodes in the first registration. in fact it should be registered with\n                    // no child selector and then on down we should cycle through the registered\n                    // functions to see if one of them matches. on mouseup we should execute ALL of\n                    // the functions whose children are either null or match the element.\n                    if (obj.__taTapHandler == null) {\n                        var tt = obj.__taTapHandler = {\n                            tap: [],\n                            dbltap: [],\n                            contextmenu: [],\n                            down: false,\n                            taps: 0,\n                            downSelectors: []\n                        };\n                        var down = function (e) {\n                                var target = _t(e), pathInfo = _pi(e, target, obj, children != null), finished = false;\n                                for (var p = 0; p < pathInfo.end; p++) {\n                                    if (finished) return;\n                                    target = pathInfo.path[p];\n                                    for (var i = 0; i < tt.downSelectors.length; i++) {\n                                        if (tt.downSelectors[i] == null || matchesSelector(target, tt.downSelectors[i], obj)) {\n                                            tt.down = true;\n                                            setTimeout(clearSingle, clickThreshold);\n                                            setTimeout(clearDouble, dblClickThreshold);\n                                            finished = true;\n                                            break; // we only need one match on mousedown\n                                        }\n                                    }\n                                }\n                            },\n                            up = function (e) {\n                                if (tt.down) {\n                                    var target = _t(e), currentTarget, pathInfo;\n                                    tt.taps++;\n                                    var tc = _touchCount(e);\n                                    for (var eventId in _tapProfiles) {\n                                        if (_tapProfiles.hasOwnProperty(eventId)) {\n                                            var p = _tapProfiles[eventId];\n                                            if (p.touches === tc && (p.taps === 1 || p.taps === tt.taps)) {\n                                                for (var i = 0; i < tt[eventId].length; i++) {\n                                                    pathInfo = _pi(e, target, obj, tt[eventId][i][1] != null);\n                                                    for (var pLoop = 0; pLoop < pathInfo.end; pLoop++) {\n                                                        currentTarget = pathInfo.path[pLoop];\n                                                        // this is a single event registration handler.\n                                                        if (tt[eventId][i][1] == null || matchesSelector(currentTarget, tt[eventId][i][1], obj)) {\n                                                            tt[eventId][i][0].apply(currentTarget, [ e ]);\n                                                            break;\n                                                        }\n                                                    }\n                                                }\n                                            }\n                                        }\n                                    }\n                                }\n                            },\n                            clearSingle = function () {\n                                tt.down = false;\n                            },\n                            clearDouble = function () {\n                                tt.taps = 0;\n                            };\n\n                        DefaultHandler(obj, \"mousedown\", down);\n                        DefaultHandler(obj, \"mouseup\", up);\n                    }\n                    // add this child selector (it can be null, that's fine).\n                    obj.__taTapHandler.downSelectors.push(children);\n\n                    obj.__taTapHandler[evt].push([fn, children]);\n                    // the unstore function removes this function from the object's listener list for this type.\n                    fn.__taUnstore = function () {\n                        _d(obj.__taTapHandler[evt], fn);\n                    };\n                }\n            };\n        },\n        meeHelper = function (type, evt, obj, target) {\n            for (var i in obj.__tamee[type]) {\n                if (obj.__tamee[type].hasOwnProperty(i)) {\n                    obj.__tamee[type][i].apply(target, [ evt ]);\n                }\n            }\n        },\n        MouseEnterExitHandler = function () {\n            var activeElements = [];\n            return function (obj, evt, fn, children) {\n                if (!obj.__tamee) {\n                    // __tamee holds a flag saying whether the mouse is currently \"in\" the element, and a list of\n                    // both mouseenter and mouseexit functions.\n                    obj.__tamee = { over: false, mouseenter: [], mouseexit: [] };\n                    // register over and out functions\n                    var over = function (e) {\n                            var t = _t(e);\n                            if ((children == null && (t == obj && !obj.__tamee.over)) || (matchesSelector(t, children, obj) && (t.__tamee == null || !t.__tamee.over))) {\n                                meeHelper(\"mouseenter\", e, obj, t);\n                                t.__tamee = t.__tamee || {};\n                                t.__tamee.over = true;\n                                activeElements.push(t);\n                            }\n                        },\n                        out = function (e) {\n                            var t = _t(e);\n                            // is the current target one of the activeElements? and is the\n                            // related target NOT a descendant of it?\n                            for (var i = 0; i < activeElements.length; i++) {\n                                if (t == activeElements[i] && !matchesSelector((e.relatedTarget || e.toElement), \"*\", t)) {\n                                    t.__tamee.over = false;\n                                    activeElements.splice(i, 1);\n                                    meeHelper(\"mouseexit\", e, obj, t);\n                                }\n                            }\n                        };\n\n                    _bind(obj, \"mouseover\", _curryChildFilter(children, obj, over, \"mouseover\"), over);\n                    _bind(obj, \"mouseout\", _curryChildFilter(children, obj, out, \"mouseout\"), out);\n                }\n\n                fn.__taUnstore = function () {\n                    delete obj.__tamee[evt][fn.__tauid];\n                };\n\n                _store(obj, evt, fn);\n                obj.__tamee[evt][fn.__tauid] = fn;\n            };\n        },\n        isTouchDevice = \"ontouchstart\" in document.documentElement || navigator.maxTouchPoints,\n        isMouseDevice = \"onmousedown\" in document.documentElement,\n        touchMap = { \"mousedown\": \"touchstart\", \"mouseup\": \"touchend\", \"mousemove\": \"touchmove\" },\n        touchstart = \"touchstart\", touchend = \"touchend\", touchmove = \"touchmove\",\n        iev = (function () {\n            var rv = -1;\n            if (navigator.appName == 'Microsoft Internet Explorer') {\n                var ua = navigator.userAgent,\n                    re = new RegExp(\"MSIE ([0-9]{1,}[\\.0-9]{0,})\");\n                if (re.exec(ua) != null)\n                    rv = parseFloat(RegExp.$1);\n            }\n            return rv;\n        })(),\n        isIELT9 = iev > -1 && iev < 9,\n        _genLoc = function (e, prefix) {\n            if (e == null) return [ 0, 0 ];\n            var ts = _touches(e), t = _getTouch(ts, 0);\n            return [t[prefix + \"X\"], t[prefix + \"Y\"]];\n        },\n        _pageLocation = function (e) {\n            if (e == null) return [ 0, 0 ];\n            if (isIELT9) {\n                return [ e.clientX + document.documentElement.scrollLeft, e.clientY + document.documentElement.scrollTop ];\n            }\n            else {\n                return _genLoc(e, \"page\");\n            }\n        },\n        _screenLocation = function (e) {\n            return _genLoc(e, \"screen\");\n        },\n        _clientLocation = function (e) {\n            return _genLoc(e, \"client\");\n        },\n        _getTouch = function (touches, idx) {\n            return touches.item ? touches.item(idx) : touches[idx];\n        },\n        _touches = function (e) {\n            return e.touches && e.touches.length > 0 ? e.touches :\n                    e.changedTouches && e.changedTouches.length > 0 ? e.changedTouches :\n                    e.targetTouches && e.targetTouches.length > 0 ? e.targetTouches :\n                [ e ];\n        },\n        _touchCount = function (e) {\n            return _touches(e).length;\n        },\n    //http://www.quirksmode.org/blog/archives/2005/10/_and_the_winner_1.html\n        _bind = function (obj, type, fn, originalFn) {\n            _store(obj, type, fn);\n            originalFn.__tauid = fn.__tauid;\n            if (obj.addEventListener)\n                obj.addEventListener(type, fn, false);\n            else if (obj.attachEvent) {\n                var key = type + fn.__tauid;\n                obj[\"e\" + key] = fn;\n                // TODO look at replacing with .call(..)\n                obj[key] = function () {\n                    obj[\"e\" + key] && obj[\"e\" + key](window.event);\n                };\n                obj.attachEvent(\"on\" + type, obj[key]);\n            }\n        },\n        _unbind = function (obj, type, fn) {\n            if (fn == null) return;\n            _each(obj, function () {\n                var _el = _gel(this);\n                _unstore(_el, type, fn);\n                // it has been bound if there is a tauid. otherwise it was not bound and we can ignore it.\n                if (fn.__tauid != null) {\n                    if (_el.removeEventListener) {\n                        _el.removeEventListener(type, fn, false);\n                        if (isTouchDevice && touchMap[type]) _el.removeEventListener(touchMap[type], fn, false);\n                    }\n                    else if (this.detachEvent) {\n                        var key = type + fn.__tauid;\n                        _el[key] && _el.detachEvent(\"on\" + type, _el[key]);\n                        _el[key] = null;\n                        _el[\"e\" + key] = null;\n                    }\n                }\n\n                // if a touch event was also registered, deregister now.\n                if (fn.__taTouchProxy) {\n                    _unbind(obj, fn.__taTouchProxy[1], fn.__taTouchProxy[0]);\n                }\n            });\n        },\n        _each = function (obj, fn) {\n            if (obj == null) return;\n            // if a list (or list-like), use it. if a string, get a list\n            // by running the string through querySelectorAll. else, assume\n            // it's an Element.\n            // obj.top is \"unknown\" in IE8.\n            obj = (typeof Window !== \"undefined\" && (typeof obj.top !== \"unknown\" && obj == obj.top)) ? [ obj ] :\n                    (typeof obj !== \"string\") && (obj.tagName == null && obj.length != null) ? obj :\n                    typeof obj === \"string\" ? document.querySelectorAll(obj)\n                : [ obj ];\n\n            for (var i = 0; i < obj.length; i++)\n                fn.apply(obj[i]);\n        },\n        _uuid = function () {\n            return ('xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n                var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);\n                return v.toString(16);\n            }));\n        };\n\n    /**\n     * Mottle offers support for abstracting out the differences\n     * between touch and mouse devices, plus \"smart click\" functionality\n     * (don't fire click if the mouse has moved between mousedown and mouseup),\n     * and synthesized click/tap events.\n     * @class Mottle\n     * @constructor\n     * @param {Object} params Constructor params\n     * @param {Number} [params.clickThreshold=250] Threshold, in milliseconds beyond which a touchstart followed by a touchend is not considered to be a click.\n     * @param {Number} [params.dblClickThreshold=450] Threshold, in milliseconds beyond which two successive tap events are not considered to be a click.\n     * @param {Boolean} [params.smartClicks=false] If true, won't fire click events if the mouse has moved between mousedown and mouseup. Note that this functionality\n     * requires that Mottle consume the mousedown event, and so may not be viable in all use cases.\n     */\n    root.Mottle = function (params) {\n        params = params || {};\n        var clickThreshold = params.clickThreshold || 250,\n            dblClickThreshold = params.dblClickThreshold || 450,\n            mouseEnterExitHandler = new MouseEnterExitHandler(),\n            tapHandler = new TapHandler(clickThreshold, dblClickThreshold),\n            _smartClicks = params.smartClicks,\n            _doBind = function (obj, evt, fn, children) {\n                if (fn == null) return;\n                _each(obj, function () {\n                    var _el = _gel(this);\n                    if (_smartClicks && evt === \"click\")\n                        SmartClickHandler(_el, evt, fn, children);\n                    else if (evt === \"tap\" || evt === \"dbltap\" || evt === \"contextmenu\") {\n                        tapHandler(_el, evt, fn, children);\n                    }\n                    else if (evt === \"mouseenter\" || evt == \"mouseexit\")\n                        mouseEnterExitHandler(_el, evt, fn, children);\n                    else\n                        DefaultHandler(_el, evt, fn, children);\n                });\n            };\n\n        /**\n         * Removes an element from the DOM, and deregisters all event handlers for it. You should use this\n         * to ensure you don't leak memory.\n         * @method remove\n         * @param {String|Element} el Element, or id of the element, to remove.\n         * @return {Mottle} The current Mottle instance; you can chain this method.\n         */\n        this.remove = function (el) {\n            _each(el, function () {\n                var _el = _gel(this);\n                if (_el.__ta) {\n                    for (var evt in _el.__ta) {\n                        if (_el.__ta.hasOwnProperty(evt)) {\n                            for (var h in _el.__ta[evt]) {\n                                if (_el.__ta[evt].hasOwnProperty(h))\n                                    _unbind(_el, evt, _el.__ta[evt][h]);\n                            }\n                        }\n                    }\n                }\n                _el.parentNode && _el.parentNode.removeChild(_el);\n            });\n            return this;\n        };\n\n        /**\n         * Register an event handler, optionally as a delegate for some set of descendant elements. Note\n         * that this method takes either 3 or 4 arguments - if you supply 3 arguments it is assumed you have\n         * omitted the `children` parameter, and that the event handler should be bound directly to the given element.\n         * @method on\n         * @param {Element[]|Element|String} el Either an Element, or a CSS spec for a list of elements, or an array of Elements.\n         * @param {String} [children] Comma-delimited list of selectors identifying allowed children.\n         * @param {String} event Event ID.\n         * @param {Function} fn Event handler function.\n         * @return {Mottle} The current Mottle instance; you can chain this method.\n         */\n        this.on = function (el, event, children, fn) {\n            var _el = arguments[0],\n                _c = arguments.length == 4 ? arguments[2] : null,\n                _e = arguments[1],\n                _f = arguments[arguments.length - 1];\n\n            _doBind(_el, _e, _f, _c);\n            return this;\n        };\n\n        /**\n         * Cancel delegate event handling for the given function. Note that unlike with 'on' you do not supply\n         * a list of child selectors here: it removes event delegation from all of the child selectors for which the\n         * given function was registered (if any).\n         * @method off\n         * @param {Element[]|Element|String} el Element - or ID of element - from which to remove event listener.\n         * @param {String} event Event ID.\n         * @param {Function} fn Event handler function.\n         * @return {Mottle} The current Mottle instance; you can chain this method.\n         */\n        this.off = function (el, event, fn) {\n            _unbind(el, event, fn);\n            return this;\n        };\n\n        /**\n         * Triggers some event for a given element.\n         * @method trigger\n         * @param {Element} el Element for which to trigger the event.\n         * @param {String} event Event ID.\n         * @param {Event} originalEvent The original event. Should be optional of course, but currently is not, due\n         * to the jsPlumb use case that caused this method to be added.\n         * @param {Object} [payload] Optional object to set as `payload` on the generated event; useful for message passing.\n         * @return {Mottle} The current Mottle instance; you can chain this method.\n         */\n        this.trigger = function (el, event, originalEvent, payload) {\n            // MouseEvent undefined in old IE; that's how we know it's a mouse event.  A fine Microsoft paradox.\n            var originalIsMouse = isMouseDevice && (typeof MouseEvent === \"undefined\" || originalEvent == null || originalEvent.constructor === MouseEvent);\n\n            var eventToBind = (isTouchDevice && !isMouseDevice && touchMap[event]) ? touchMap[event] : event,\n                bindingAMouseEvent = !(isTouchDevice && !isMouseDevice && touchMap[event]);\n\n            var pl = _pageLocation(originalEvent), sl = _screenLocation(originalEvent), cl = _clientLocation(originalEvent);\n            _each(el, function () {\n                var _el = _gel(this), evt;\n                originalEvent = originalEvent || {\n                    screenX: sl[0],\n                    screenY: sl[1],\n                    clientX: cl[0],\n                    clientY: cl[1]\n                };\n\n                var _decorate = function (_evt) {\n                    if (payload) _evt.payload = payload;\n                };\n\n                var eventGenerators = {\n                    \"TouchEvent\": function (evt) {\n\n                        var touchList = _touchAndList(window, _el, 0, pl[0], pl[1], sl[0], sl[1], cl[0], cl[1]),\n                            init = evt.initTouchEvent || evt.initEvent;\n\n                        init(eventToBind, true, true, window, null, sl[0], sl[1],\n                            cl[0], cl[1], false, false, false, false,\n                            touchList, touchList, touchList, 1, 0);\n                    },\n                    \"MouseEvents\": function (evt) {\n                        evt.initMouseEvent(eventToBind, true, true, window, 0,\n                            sl[0], sl[1],\n                            cl[0], cl[1],\n                            false, false, false, false, 1, _el);\n                    }\n                };\n\n                if (document.createEvent) {\n\n                    var ite = !bindingAMouseEvent && !originalIsMouse && (isTouchDevice && touchMap[event]),\n                        evtName = ite ? \"TouchEvent\" : \"MouseEvents\";\n\n                    evt = document.createEvent(evtName);\n                    eventGenerators[evtName](evt);\n                    _decorate(evt);\n                    _el.dispatchEvent(evt);\n                }\n                else if (document.createEventObject) {\n                    evt = document.createEventObject();\n                    evt.eventType = evt.eventName = eventToBind;\n                    evt.screenX = sl[0];\n                    evt.screenY = sl[1];\n                    evt.clientX = cl[0];\n                    evt.clientY = cl[1];\n                    _decorate(evt);\n                    _el.fireEvent('on' + eventToBind, evt);\n                }\n            });\n            return this;\n        }\n    };\n\n    /**\n     * Static method to assist in 'consuming' an element: uses `stopPropagation` where available, or sets\n     * `e.returnValue=false` where it is not.\n     * @method Mottle.consume\n     * @param {Event} e Event to consume\n     * @param {Boolean} [doNotPreventDefault=false] If true, does not call `preventDefault()` on the event.\n     */\n    root.Mottle.consume = function (e, doNotPreventDefault) {\n        if (e.stopPropagation)\n            e.stopPropagation();\n        else\n            e.returnValue = false;\n\n        if (!doNotPreventDefault && e.preventDefault)\n            e.preventDefault();\n    };\n\n    /**\n     * Gets the page location corresponding to the given event. For touch events this means get the page location of the first touch.\n     * @method Mottle.pageLocation\n     * @param {Event} e Event to get page location for.\n     * @return {Number[]} [left, top] for the given event.\n     */\n    root.Mottle.pageLocation = _pageLocation;\n\n    /**\n     * Forces touch events to be turned \"on\". Useful for testing: even if you don't have a touch device, you can still\n     * trigger a touch event when this is switched on and it will be captured and acted on.\n     * @method setForceTouchEvents\n     * @param {Boolean} value If true, force touch events to be on.\n     */\n    root.Mottle.setForceTouchEvents = function (value) {\n        isTouchDevice = value;\n    };\n\n    /**\n     * Forces mouse events to be turned \"on\". Useful for testing: even if you don't have a mouse, you can still\n     * trigger a mouse event when this is switched on and it will be captured and acted on.\n     * @method setForceMouseEvents\n     * @param {Boolean} value If true, force mouse events to be on.\n     */\n    root.Mottle.setForceMouseEvents = function (value) {\n        isMouseDevice = value;\n    };\n\n    root.Mottle.version = \"0.8.0\";\n\n    if (typeof exports !== \"undefined\") {\n        exports.Mottle = root.Mottle;\n    }\n\n}).call(typeof window === \"undefined\" ? this : window);\n\n/**\n drag/drop functionality for use with jsPlumb but with\n no knowledge of jsPlumb. supports multiple scopes (separated by whitespace), dragging\n multiple elements, constrain to parent, drop filters, drag start filters, custom\n css classes.\n\n a lot of the functionality of this script is expected to be plugged in:\n\n addClass\n removeClass\n\n addEvent\n removeEvent\n\n getPosition\n setPosition\n getSize\n\n indexOf\n intersects\n\n the name came from here:\n\n http://mrsharpoblunto.github.io/foswig.js/\n\n copyright 2016 jsPlumb\n */\n\n;(function() {\n\n    \"use strict\";\n    var root = this;\n\n    var _suggest = function(list, item, head) {\n        if (list.indexOf(item) === -1) {\n            head ? list.unshift(item) : list.push(item);\n            return true;\n        }\n        return false;\n    };\n\n    var _vanquish = function(list, item) {\n        var idx = list.indexOf(item);\n        if (idx !== -1) list.splice(idx, 1);\n    };\n\n    var _difference = function(l1, l2) {\n        var d = [];\n        for (var i = 0; i < l1.length; i++) {\n            if (l2.indexOf(l1[i]) === -1)\n                d.push(l1[i]);\n        }\n        return d;\n    };\n\n    var _isString = function(f) {\n        return f == null ? false : (typeof f === \"string\" || f.constructor === String);\n    };\n\n    var getOffsetRect = function (elem) {\n        // (1)\n        var box = elem.getBoundingClientRect(),\n            body = document.body,\n            docElem = document.documentElement,\n        // (2)\n            scrollTop = window.pageYOffset || docElem.scrollTop || body.scrollTop,\n            scrollLeft = window.pageXOffset || docElem.scrollLeft || body.scrollLeft,\n        // (3)\n            clientTop = docElem.clientTop || body.clientTop || 0,\n            clientLeft = docElem.clientLeft || body.clientLeft || 0,\n        // (4)\n            top  = box.top +  scrollTop - clientTop,\n            left = box.left + scrollLeft - clientLeft;\n\n        return { top: Math.round(top), left: Math.round(left) };\n    };\n\n    var matchesSelector = function(el, selector, ctx) {\n        ctx = ctx || el.parentNode;\n        var possibles = ctx.querySelectorAll(selector);\n        for (var i = 0; i < possibles.length; i++) {\n            if (possibles[i] === el)\n                return true;\n        }\n        return false;\n    };\n\n    var findDelegateElement = function(parentElement, childElement, selector) {\n        if (matchesSelector(childElement, selector, parentElement)) {\n            return childElement;\n        } else {\n            var currentParent = childElement.parentNode;\n            while (currentParent != null && currentParent !== parentElement) {\n                if (matchesSelector(currentParent, selector, parentElement)) {\n                    return currentParent;\n                } else {\n                    currentParent = currentParent.parentNode;\n                }\n            }\n        }\n    };\n\n    /**\n     * Finds all elements matching the given selector, for the given parent. In order to support \"scoped root\" selectors,\n     * ie. things like \"> .someClass\", that is .someClass elements that are direct children of `parentElement`, we have to\n     * jump through a small hoop here: when a delegate draggable is registered, we write a `katavorio-draggable` attribute\n     * on the element on which the draggable is registered. Then when this method runs, we grab the value of that attribute and\n     * prepend it as part of the selector we're looking for.  So \"> .someClass\" ends up being written as\n     * \"[katavorio-draggable='...' > .someClass]\", which works with querySelectorAll.\n     *\n     * @param availableSelectors\n     * @param parentElement\n     * @param childElement\n     * @returns {*}\n     */\n    var findMatchingSelector = function(availableSelectors, parentElement, childElement) {\n        var el = null;\n        var draggableId = parentElement.getAttribute(\"katavorio-draggable\"),\n            prefix = draggableId != null ? \"[katavorio-draggable='\" + draggableId + \"'] \" : \"\";\n\n        for (var i = 0; i < availableSelectors.length; i++) {\n            el = findDelegateElement(parentElement, childElement, prefix + availableSelectors[i].selector);\n            if (el != null) {\n                if (availableSelectors[i].filter) {\n                    var matches = matchesSelector(childElement, availableSelectors[i].filter, el),\n                        exclude = availableSelectors[i].filterExclude === true;\n\n                    if ( (exclude && !matches) || matches) {\n                        return null;\n                    }\n\n                }\n                return [ availableSelectors[i], el ];\n            }\n        }\n        return null;\n    };\n\n    var iev = (function() {\n            var rv = -1;\n            if (navigator.appName === 'Microsoft Internet Explorer') {\n                var ua = navigator.userAgent,\n                    re = new RegExp(\"MSIE ([0-9]{1,}[\\.0-9]{0,})\");\n                if (re.exec(ua) != null)\n                    rv = parseFloat(RegExp.$1);\n            }\n            return rv;\n        })(),\n        DEFAULT_GRID_X = 10,\n        DEFAULT_GRID_Y = 10,\n        isIELT9 = iev > -1 && iev < 9,\n        isIE9 = iev === 9,\n        _pl = function(e) {\n            if (isIELT9) {\n                return [ e.clientX + document.documentElement.scrollLeft, e.clientY + document.documentElement.scrollTop ];\n            }\n            else {\n                var ts = _touches(e), t = _getTouch(ts, 0);\n                // for IE9 pageX might be null if the event was synthesized. We try for pageX/pageY first,\n                // falling back to clientX/clientY if necessary. In every other browser we want to use pageX/pageY.\n                return isIE9 ? [t.pageX || t.clientX, t.pageY || t.clientY] : [t.pageX, t.pageY];\n            }\n        },\n        _getTouch = function(touches, idx) { return touches.item ? touches.item(idx) : touches[idx]; },\n        _touches = function(e) {\n            return e.touches && e.touches.length > 0 ? e.touches :\n                    e.changedTouches && e.changedTouches.length > 0 ? e.changedTouches :\n                    e.targetTouches && e.targetTouches.length > 0 ? e.targetTouches :\n                [ e ];\n        },\n        _classes = {\n            delegatedDraggable:\"katavorio-delegated-draggable\",  // elements that are the delegated drag handler for a bunch of other elements\n            draggable:\"katavorio-draggable\",    // draggable elements\n            droppable:\"katavorio-droppable\",    // droppable elements\n            drag : \"katavorio-drag\",            // elements currently being dragged\n            selected:\"katavorio-drag-selected\", // elements in current drag selection\n            active : \"katavorio-drag-active\",   // droppables that are targets of a currently dragged element\n            hover : \"katavorio-drag-hover\",     // droppables over which a matching drag element is hovering\n            noSelect : \"katavorio-drag-no-select\", // added to the body to provide a hook to suppress text selection\n            ghostProxy:\"katavorio-ghost-proxy\",  // added to a ghost proxy element in use when a drag has exited the bounds of its parent.\n            clonedDrag:\"katavorio-clone-drag\"     // added to a node that is a clone of an element created at the start of a drag\n        },\n        _defaultScope = \"katavorio-drag-scope\",\n        _events = [ \"stop\", \"start\", \"drag\", \"drop\", \"over\", \"out\", \"beforeStart\" ],\n        _devNull = function() {},\n        _true = function() { return true; },\n        _foreach = function(l, fn, from) {\n            for (var i = 0; i < l.length; i++) {\n                if (l[i] != from)\n                    fn(l[i]);\n            }\n        },\n        _setDroppablesActive = function(dd, val, andHover, drag) {\n            _foreach(dd, function(e) {\n                e.setActive(val);\n                if (val) e.updatePosition();\n                if (andHover) e.setHover(drag, val);\n            });\n        },\n        _each = function(obj, fn) {\n            if (obj == null) return;\n            obj = !_isString(obj) && (obj.tagName == null && obj.length != null) ? obj : [ obj ];\n            for (var i = 0; i < obj.length; i++)\n                fn.apply(obj[i], [ obj[i] ]);\n        },\n        _consume = function(e) {\n            if (e.stopPropagation) {\n                e.stopPropagation();\n                e.preventDefault();\n            }\n            else {\n                e.returnValue = false;\n            }\n        },\n        _defaultInputFilterSelector = \"input,textarea,select,button,option\",\n    //\n    // filters out events on all input elements, like textarea, checkbox, input, select.\n        _inputFilter = function(e, el, _katavorio) {\n            var t = e.srcElement || e.target;\n            return !matchesSelector(t, _katavorio.getInputFilterSelector(), el);\n        };\n\n    var Super = function(el, params, css, scope) {\n        this.params = params || {};\n        this.el = el;\n        this.params.addClass(this.el, this._class);\n        this.uuid = _uuid();\n        var enabled = true;\n        this.setEnabled = function(e) { enabled = e; };\n        this.isEnabled = function() { return enabled; };\n        this.toggleEnabled = function() { enabled = !enabled; };\n        this.setScope = function(scopes) {\n            this.scopes = scopes ? scopes.split(/\\s+/) : [ scope ];\n        };\n        this.addScope = function(scopes) {\n            var m = {};\n            _each(this.scopes, function(s) { m[s] = true;});\n            _each(scopes ? scopes.split(/\\s+/) : [], function(s) { m[s] = true;});\n            this.scopes = [];\n            for (var i in m) this.scopes.push(i);\n        };\n        this.removeScope = function(scopes) {\n            var m = {};\n            _each(this.scopes, function(s) { m[s] = true;});\n            _each(scopes ? scopes.split(/\\s+/) : [], function(s) { delete m[s];});\n            this.scopes = [];\n            for (var i in m) this.scopes.push(i);\n        };\n        this.toggleScope = function(scopes) {\n            var m = {};\n            _each(this.scopes, function(s) { m[s] = true;});\n            _each(scopes ? scopes.split(/\\s+/) : [], function(s) {\n                if (m[s]) delete m[s];\n                else m[s] = true;\n            });\n            this.scopes = [];\n            for (var i in m) this.scopes.push(i);\n        };\n        this.setScope(params.scope);\n        this.k = params.katavorio;\n        return params.katavorio;\n    };\n\n    var TRUE = function() { return true; };\n    var FALSE = function() { return false; };\n\n    var Drag = function(el, params, css, scope) {\n        this._class = css.draggable;\n        var k = Super.apply(this, arguments);\n        this.rightButtonCanDrag = this.params.rightButtonCanDrag;\n        var downAt = [0,0], posAtDown = null, pagePosAtDown = null, pageDelta = [0,0], moving = false, initialScroll = [0,0],\n            consumeStartEvent = this.params.consumeStartEvent !== false,\n            dragEl = this.el,\n            clone = this.params.clone,\n            scroll = this.params.scroll,\n            _multipleDrop = params.multipleDrop !== false,\n            isConstrained = false,\n            useGhostProxy = params.ghostProxy === true ? TRUE : params.ghostProxy && typeof params.ghostProxy === \"function\" ? params.ghostProxy : FALSE,\n            ghostProxy = function(el) { return el.cloneNode(true); },\n            elementToDrag = null,\n            availableSelectors = [],\n            activeSelectorParams = null, // which, if any, selector config is currently active.\n            ghostProxyParent = params.ghostProxyParent,\n            currentParentPosition,\n            ghostParentPosition,\n            ghostDx,\n            ghostDy;\n\n        // if an initial selector was provided, push the entire set of params as a selector config.\n        if (params.selector) {\n            var draggableId = el.getAttribute(\"katavorio-draggable\");\n            if (draggableId == null) {\n                draggableId = \"\" + new Date().getTime();\n                el.setAttribute(\"katavorio-draggable\", draggableId);\n            }\n\n            availableSelectors.push(params);\n        }\n\n        var snapThreshold = params.snapThreshold,\n            _snap = function(pos, gridX, gridY, thresholdX, thresholdY) {\n                var _dx = Math.floor(pos[0] / gridX),\n                    _dxl = gridX * _dx,\n                    _dxt = _dxl + gridX,\n                    _x = Math.abs(pos[0] - _dxl) <= thresholdX ? _dxl : Math.abs(_dxt - pos[0]) <= thresholdX ? _dxt : pos[0];\n\n                var _dy = Math.floor(pos[1] / gridY),\n                    _dyl = gridY * _dy,\n                    _dyt = _dyl + gridY,\n                    _y = Math.abs(pos[1] - _dyl) <= thresholdY ? _dyl : Math.abs(_dyt - pos[1]) <= thresholdY ? _dyt : pos[1];\n\n                return [ _x, _y];\n            };\n\n        this.posses = [];\n        this.posseRoles = {};\n\n        this.toGrid = function(pos) {\n            if (this.params.grid == null) {\n                return pos;\n            }\n            else {\n                var tx = this.params.grid ? this.params.grid[0] / 2 : snapThreshold ? snapThreshold : DEFAULT_GRID_X / 2,\n                    ty = this.params.grid ? this.params.grid[1] / 2 : snapThreshold ? snapThreshold : DEFAULT_GRID_Y / 2;\n\n                return _snap(pos, this.params.grid[0], this.params.grid[1], tx, ty);\n            }\n        };\n\n        this.snap = function(x, y) {\n            if (dragEl == null) return;\n            x = x || (this.params.grid ? this.params.grid[0] : DEFAULT_GRID_X);\n            y = y || (this.params.grid ? this.params.grid[1] : DEFAULT_GRID_Y);\n            var p = this.params.getPosition(dragEl),\n                tx = this.params.grid ? this.params.grid[0] / 2 : snapThreshold,\n                ty = this.params.grid ? this.params.grid[1] / 2 : snapThreshold,\n                snapped = _snap(p, x, y, tx, ty);\n\n            this.params.setPosition(dragEl, snapped);\n            return snapped;\n        };\n\n        this.setUseGhostProxy = function(val) {\n            useGhostProxy = val ? TRUE : FALSE;\n        };\n\n        var constrain;\n        var negativeFilter = function(pos) {\n            return (params.allowNegative === false) ? [ Math.max (0, pos[0]), Math.max(0, pos[1]) ] : pos;\n        };\n\n        var _setConstrain = function(value) {\n            constrain = typeof value === \"function\" ? value : value ? function(pos, dragEl, _constrainRect, _size) {\n                return negativeFilter([\n                    Math.max(0, Math.min(_constrainRect.w - _size[0], pos[0])),\n                    Math.max(0, Math.min(_constrainRect.h - _size[1], pos[1]))\n                ]);\n            }.bind(this) : function(pos) { return negativeFilter(pos); };\n        }.bind(this);\n\n        _setConstrain(typeof this.params.constrain === \"function\" ? this.params.constrain  : (this.params.constrain || this.params.containment));\n\n\n        /**\n         * Sets whether or not the Drag is constrained. A value of 'true' means constrain to parent bounds; a function\n         * will be executed and returns true if the position is allowed.\n         * @param value\n         */\n        this.setConstrain = function(value) {\n            _setConstrain(value);\n        };\n\n        var revertFunction;\n        /**\n         * Sets a function to call on drag stop, which, if it returns true, indicates that the given element should\n         * revert to its position before the previous drag.\n         * @param fn\n         */\n        this.setRevert = function(fn) {\n            revertFunction = fn;\n        };\n\n        if (this.params.revert) {\n            revertFunction = this.params.revert;\n        }\n\n        var _assignId = function(obj) {\n                if (typeof obj === \"function\") {\n                    obj._katavorioId = _uuid();\n                    return obj._katavorioId;\n                } else {\n                    return obj;\n                }\n            },\n        // a map of { spec -> [ fn, exclusion ] } entries.\n            _filters = {},\n            _testFilter = function(e) {\n                for (var key in _filters) {\n                    var f = _filters[key];\n                    var rv = f[0](e);\n                    if (f[1]) rv = !rv;\n                    if (!rv) return false;\n                }\n                return true;\n            },\n            _setFilter = this.setFilter = function(f, _exclude) {\n                if (f) {\n                    var key = _assignId(f);\n                    _filters[key] = [\n                        function(e) {\n                            var t = e.srcElement || e.target, m;\n                            if (_isString(f)) {\n                                m = matchesSelector(t, f, el);\n                            }\n                            else if (typeof f === \"function\") {\n                                m = f(e, el);\n                            }\n                            return m;\n                        },\n                            _exclude !== false\n                    ];\n\n                }\n            },\n            _addFilter = this.addFilter = _setFilter,\n            _removeFilter = this.removeFilter = function(f) {\n                var key = typeof f === \"function\" ? f._katavorioId : f;\n                delete _filters[key];\n            };\n\n        this.clearAllFilters = function() {\n            _filters = {};\n        };\n\n        this.canDrag = this.params.canDrag || _true;\n\n        var constrainRect,\n            matchingDroppables = [],\n            intersectingDroppables = [];\n\n        this.addSelector = function(params) {\n            if (params.selector) {\n                availableSelectors.push(params);\n            }\n        };\n\n        this.downListener = function(e) {\n            if (e.defaultPrevented) { return; }\n            var isNotRightClick = this.rightButtonCanDrag || (e.which !== 3 && e.button !== 2);\n            if (isNotRightClick && this.isEnabled() && this.canDrag()) {\n\n                var _f =  _testFilter(e) && _inputFilter(e, this.el, this.k);\n                if (_f) {\n\n                    activeSelectorParams = null;\n                    elementToDrag = null;\n\n                    // if (selector) {\n                    //     elementToDrag = findDelegateElement(this.el, e.target || e.srcElement, selector);\n                    //     if(elementToDrag == null) {\n                    //         return;\n                    //     }\n                    // }\n                    if (availableSelectors.length > 0) {\n                        var match = findMatchingSelector(availableSelectors, this.el, e.target || e.srcElement);\n                        if (match != null) {\n                            activeSelectorParams = match[0];\n                            elementToDrag = match[1];\n                        }\n                        // elementToDrag = findDelegateElement(this.el, e.target || e.srcElement, selector);\n                        if(elementToDrag == null) {\n                            return;\n                        }\n                    }\n                    else {\n                        elementToDrag = this.el;\n                    }\n\n                    if (clone) {\n                        dragEl = elementToDrag.cloneNode(true);\n                        this.params.addClass(dragEl, _classes.clonedDrag);\n\n                        dragEl.setAttribute(\"id\", null);\n                        dragEl.style.position = \"absolute\";\n\n                        if (this.params.parent != null) {\n                            var p = this.params.getPosition(this.el);\n                            dragEl.style.left = p[0] + \"px\";\n                            dragEl.style.top = p[1] + \"px\";\n                            this.params.parent.appendChild(dragEl);\n                        } else {\n                            // the clone node is added to the body; getOffsetRect gives us a value\n                            // relative to the body.\n                            var b = getOffsetRect(elementToDrag);\n                            dragEl.style.left = b.left + \"px\";\n                            dragEl.style.top = b.top + \"px\";\n\n                            document.body.appendChild(dragEl);\n                        }\n\n                    } else {\n                        dragEl = elementToDrag;\n                    }\n\n                    consumeStartEvent && _consume(e);\n                    downAt = _pl(e);\n                    if (dragEl && dragEl.parentNode)\n                    {\n                        initialScroll = [dragEl.parentNode.scrollLeft, dragEl.parentNode.scrollTop];\n                    }\n                    //\n                    this.params.bind(document, \"mousemove\", this.moveListener);\n                    this.params.bind(document, \"mouseup\", this.upListener);\n                    k.markSelection(this);\n                    k.markPosses(this);\n                    this.params.addClass(document.body, css.noSelect);\n                    _dispatch(\"beforeStart\", {el:this.el, pos:posAtDown, e:e, drag:this});\n                }\n                else if (this.params.consumeFilteredEvents) {\n                    _consume(e);\n                }\n            }\n        }.bind(this);\n\n        this.moveListener = function(e) {\n            if (downAt) {\n                if (!moving) {\n                    var _continue = _dispatch(\"start\", {el:this.el, pos:posAtDown, e:e, drag:this});\n                    if (_continue !== false) {\n                        if (!downAt) {\n                            return;\n                        }\n                        this.mark(true);\n                        moving = true;\n                    } else {\n                        this.abort();\n                    }\n                }\n\n                // it is possible that the start event caused the drag to be aborted. So we check\n                // again that we are currently dragging.\n                if (downAt) {\n                    intersectingDroppables.length = 0;\n                    var pos = _pl(e), dx = pos[0] - downAt[0], dy = pos[1] - downAt[1],\n                        z = this.params.ignoreZoom ? 1 : k.getZoom();\n                    if (dragEl && dragEl.parentNode)\n                    {\n                        dx += dragEl.parentNode.scrollLeft - initialScroll[0];\n                        dy += dragEl.parentNode.scrollTop - initialScroll[1];\n                    }\n                    dx /= z;\n                    dy /= z;\n                    this.moveBy(dx, dy, e);\n                    k.updateSelection(dx, dy, this);\n                    k.updatePosses(dx, dy, this);\n                }\n            }\n        }.bind(this);\n\n        this.upListener = function(e) {\n            if (downAt) {\n                downAt = null;\n                this.params.unbind(document, \"mousemove\", this.moveListener);\n                this.params.unbind(document, \"mouseup\", this.upListener);\n                this.params.removeClass(document.body, css.noSelect);\n                this.unmark(e);\n                k.unmarkSelection(this, e);\n                k.unmarkPosses(this, e);\n                this.stop(e);\n\n                k.notifyPosseDragStop(this, e);\n                moving = false;\n                intersectingDroppables.length = 0;\n\n                if (clone) {\n                    dragEl && dragEl.parentNode && dragEl.parentNode.removeChild(dragEl);\n                    dragEl = null;\n                } else {\n                    if (revertFunction && revertFunction(dragEl, this.params.getPosition(dragEl)) === true) {\n                        this.params.setPosition(dragEl, posAtDown);\n                        _dispatch(\"revert\", dragEl);\n                    }\n                }\n\n            }\n        }.bind(this);\n\n        this.getFilters = function() { return _filters; };\n\n        this.abort = function() {\n            if (downAt != null) {\n                this.upListener();\n            }\n        };\n\n        /**\n         * Returns the element that was last dragged. This may be some original element from the DOM, or if `clone` is\n         * set, then its actually a copy of some original DOM element. In some client calls to this method, it is the\n         * actual element that was dragged that is desired. In others, it is the original DOM element that the user\n         * wishes to get - in which case, pass true for `retrieveOriginalElement`.\n         *\n         * @returns {*}\n         */\n        this.getDragElement = function(retrieveOriginalElement) {\n            return retrieveOriginalElement ? elementToDrag || this.el : dragEl || this.el;\n        };\n\n        var listeners = {\"start\":[], \"drag\":[], \"stop\":[], \"over\":[], \"out\":[], \"beforeStart\":[], \"revert\":[] };\n        if (params.events.start) listeners.start.push(params.events.start);\n        if (params.events.beforeStart) listeners.beforeStart.push(params.events.beforeStart);\n        if (params.events.stop) listeners.stop.push(params.events.stop);\n        if (params.events.drag) listeners.drag.push(params.events.drag);\n        if (params.events.revert) listeners.revert.push(params.events.revert);\n\n        this.on = function(evt, fn) {\n            if (listeners[evt]) listeners[evt].push(fn);\n        };\n\n        this.off = function(evt, fn) {\n            if (listeners[evt]) {\n                var l = [];\n                for (var i = 0; i < listeners[evt].length; i++) {\n                    if (listeners[evt][i] !== fn) l.push(listeners[evt][i]);\n                }\n                listeners[evt] = l;\n            }\n        };\n\n        var _dispatch = function(evt, value) {\n            var result = null;\n            if (activeSelectorParams && activeSelectorParams[evt]) {\n                result = activeSelectorParams[evt](value);\n            } else if (listeners[evt]) {\n                for (var i = 0; i < listeners[evt].length; i++) {\n                    try {\n                        var v = listeners[evt][i](value);\n                        if (v != null) {\n                            result = v;\n                        }\n                    }\n                    catch (e) { }\n                }\n            }\n            return result;\n        };\n\n        this.notifyStart = function(e) {\n            _dispatch(\"start\", {el:this.el, pos:this.params.getPosition(dragEl), e:e, drag:this});\n        };\n\n        this.stop = function(e, force) {\n            if (force || moving) {\n                var positions = [],\n                    sel = k.getSelection(),\n                    dPos = this.params.getPosition(dragEl);\n\n                if (sel.length > 0) {\n                    for (var i = 0; i < sel.length; i++) {\n                        var p = this.params.getPosition(sel[i].el);\n                        positions.push([ sel[i].el, { left: p[0], top: p[1] }, sel[i] ]);\n                    }\n                }\n                else {\n                    positions.push([ dragEl, {left:dPos[0], top:dPos[1]}, this ]);\n                }\n\n                _dispatch(\"stop\", {\n                    el: dragEl,\n                    pos: ghostProxyOffsets || dPos,\n                    finalPos:dPos,\n                    e: e,\n                    drag: this,\n                    selection:positions\n                });\n            }\n        };\n\n        this.mark = function(andNotify) {\n            posAtDown = this.params.getPosition(dragEl);\n            pagePosAtDown = this.params.getPosition(dragEl, true);\n            pageDelta = [pagePosAtDown[0] - posAtDown[0], pagePosAtDown[1] - posAtDown[1]];\n            this.size = this.params.getSize(dragEl);\n            matchingDroppables = k.getMatchingDroppables(this);\n            _setDroppablesActive(matchingDroppables, true, false, this);\n            this.params.addClass(dragEl, this.params.dragClass || css.drag);\n\n            var cs;\n            if (this.params.getConstrainingRectangle) {\n                cs = this.params.getConstrainingRectangle(dragEl)\n            } else {\n                cs = this.params.getSize(dragEl.parentNode);\n            }\n            constrainRect = {w: cs[0], h: cs[1]};\n\n            ghostDx = 0;\n            ghostDy = 0;\n\n            if (andNotify) {\n                k.notifySelectionDragStart(this);\n            }\n        };\n        var ghostProxyOffsets;\n        this.unmark = function(e, doNotCheckDroppables) {\n            _setDroppablesActive(matchingDroppables, false, true, this);\n\n            if (isConstrained && useGhostProxy(elementToDrag, dragEl)) {\n                ghostProxyOffsets = [dragEl.offsetLeft - ghostDx, dragEl.offsetTop - ghostDy];\n                dragEl.parentNode.removeChild(dragEl);\n                dragEl = elementToDrag;\n            }\n            else {\n                ghostProxyOffsets = null;\n            }\n\n            this.params.removeClass(dragEl, this.params.dragClass || css.drag);\n            matchingDroppables.length = 0;\n            isConstrained = false;\n            if (!doNotCheckDroppables) {\n                if (intersectingDroppables.length > 0 && ghostProxyOffsets) {\n                    params.setPosition(elementToDrag, ghostProxyOffsets);\n                }\n                intersectingDroppables.sort(_rankSort);\n                for (var i = 0; i < intersectingDroppables.length; i++) {\n                    var retVal = intersectingDroppables[i].drop(this, e);\n                    if (retVal === true) break;\n                }\n            }\n        };\n        this.moveBy = function(dx, dy, e) {\n            intersectingDroppables.length = 0;\n\n            var desiredLoc = this.toGrid([posAtDown[0] + dx, posAtDown[1] + dy]),\n                cPos = constrain(desiredLoc, dragEl, constrainRect, this.size);\n\n            // if we should use a ghost proxy...\n            if (useGhostProxy(this.el, dragEl)) {\n                // and the element has been dragged outside of its parent bounds\n                if (desiredLoc[0] !== cPos[0] || desiredLoc[1] !== cPos[1]) {\n\n                    // ...if ghost proxy not yet created\n                    if (!isConstrained) {\n                        // create it\n                        var gp = ghostProxy(elementToDrag);\n                        params.addClass(gp, _classes.ghostProxy);\n\n                        if (ghostProxyParent) {\n                            ghostProxyParent.appendChild(gp);\n                            // find offset between drag el's parent the ghost parent\n                           currentParentPosition = params.getPosition(elementToDrag.parentNode, true);\n                           ghostParentPosition = params.getPosition(params.ghostProxyParent, true);\n                           ghostDx = currentParentPosition[0] - ghostParentPosition[0];\n                           ghostDy = currentParentPosition[1] - ghostParentPosition[1];\n\n                        } else {\n                            elementToDrag.parentNode.appendChild(gp);\n                        }\n\n                        // the ghost proxy is the drag element\n                        dragEl = gp;\n                        // set this flag so we dont recreate the ghost proxy\n                        isConstrained = true;\n                    }\n                    // now the drag position can be the desired position, as the ghost proxy can support it.\n                    cPos = desiredLoc;\n                }\n                else {\n                    // if the element is not outside of its parent bounds, and ghost proxy is in place,\n                    if (isConstrained) {\n                        // remove the ghost proxy from the dom\n                        dragEl.parentNode.removeChild(dragEl);\n                        // reset the drag element to the original element\n                        dragEl = elementToDrag;\n                        // clear this flag.\n                        isConstrained = false;\n                        currentParentPosition = null;\n                        ghostParentPosition = null;\n                        ghostDx = 0;\n                        ghostDy = 0;\n                    }\n                }\n            }\n\n            var rect = { x:cPos[0], y:cPos[1], w:this.size[0], h:this.size[1]},\n                pageRect = { x:rect.x + pageDelta[0], y:rect.y + pageDelta[1], w:rect.w, h:rect.h},\n                focusDropElement = null;\n\n            this.params.setPosition(dragEl, [cPos[0] + ghostDx, cPos[1] + ghostDy]);\n\n            for (var i = 0; i < matchingDroppables.length; i++) {\n                var r2 = { x:matchingDroppables[i].pagePosition[0], y:matchingDroppables[i].pagePosition[1], w:matchingDroppables[i].size[0], h:matchingDroppables[i].size[1]};\n                if (this.params.intersects(pageRect, r2) && (_multipleDrop || focusDropElement == null || focusDropElement === matchingDroppables[i].el) && matchingDroppables[i].canDrop(this)) {\n                    if (!focusDropElement) focusDropElement = matchingDroppables[i].el;\n                    intersectingDroppables.push(matchingDroppables[i]);\n                    matchingDroppables[i].setHover(this, true, e);\n                }\n                else if (matchingDroppables[i].isHover()) {\n                    matchingDroppables[i].setHover(this, false, e);\n                }\n            }\n\n            _dispatch(\"drag\", {el:this.el, pos:cPos, e:e, drag:this});\n\n            /* test to see if the parent needs to be scrolled (future)\n             if (scroll) {\n             var pnsl = dragEl.parentNode.scrollLeft, pnst = dragEl.parentNode.scrollTop;\n             console.log(\"scroll!\", pnsl, pnst);\n             }*/\n        };\n        this.destroy = function() {\n            this.params.unbind(this.el, \"mousedown\", this.downListener);\n            this.params.unbind(document, \"mousemove\", this.moveListener);\n            this.params.unbind(document, \"mouseup\", this.upListener);\n            this.downListener = null;\n            this.upListener = null;\n            this.moveListener = null;\n        };\n\n        // init:register mousedown, and perhaps set a filter\n        this.params.bind(this.el, \"mousedown\", this.downListener);\n\n        // if handle provided, use that.  otherwise, try to set a filter.\n        // note that a `handle` selector always results in filterExclude being set to false, ie.\n        // the selector defines the handle element(s).\n        if (this.params.handle)\n            _setFilter(this.params.handle, false);\n        else\n            _setFilter(this.params.filter, this.params.filterExclude);\n    };\n\n    var Drop = function(el, params, css, scope) {\n        this._class = css.droppable;\n        this.params = params || {};\n        this.rank = params.rank || 0;\n        this._activeClass = this.params.activeClass || css.active;\n        this._hoverClass = this.params.hoverClass || css.hover;\n        Super.apply(this, arguments);\n        var hover = false;\n        this.allowLoopback = this.params.allowLoopback !== false;\n\n        this.setActive = function(val) {\n            this.params[val ? \"addClass\" : \"removeClass\"](this.el, this._activeClass);\n        };\n\n        this.updatePosition = function() {\n            this.position = this.params.getPosition(this.el);\n            this.pagePosition = this.params.getPosition(this.el, true);\n            this.size = this.params.getSize(this.el);\n        };\n\n        this.canDrop = this.params.canDrop || function(drag) {\n            return true;\n        };\n\n        this.isHover = function() { return hover; };\n\n        this.setHover = function(drag, val, e) {\n            // if turning off hover but this was not the drag that caused the hover, ignore.\n            if (val || this.el._katavorioDragHover == null || this.el._katavorioDragHover === drag.el._katavorio) {\n                this.params[val ? \"addClass\" : \"removeClass\"](this.el, this._hoverClass);\n                this.el._katavorioDragHover = val ? drag.el._katavorio : null;\n                if (hover !== val) {\n                    this.params.events[val ? \"over\" : \"out\"]({el: this.el, e: e, drag: drag, drop: this});\n                }\n                hover = val;\n            }\n        };\n\n        /**\n         * A drop event. `drag` is the corresponding Drag object, which may be a Drag for some specific element, or it\n         * may be a Drag on some element acting as a delegate for elements contained within it.\n         * @param drag\n         * @param event\n         * @returns {*}\n         */\n        this.drop = function(drag, event) {\n            return this.params.events[\"drop\"]({ drag:drag, e:event, drop:this });\n        };\n\n        this.destroy = function() {\n            this._class = null;\n            this._activeClass = null;\n            this._hoverClass = null;\n            hover = null;\n        };\n    };\n\n    var _uuid = function() {\n        return ('xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n            var r = Math.random()*16|0, v = c === 'x' ? r : (r&0x3|0x8);\n            return v.toString(16);\n        }));\n    };\n\n    var _rankSort = function(a,b) {\n        return a.rank < b.rank ? 1 : a.rank > b.rank ? -1 : 0;\n    };\n\n    var _gel = function(el) {\n        if (el == null) return null;\n        el = (typeof el === \"string\" || el.constructor === String)  ? document.getElementById(el) : el;\n        if (el == null) return null;\n        el._katavorio = el._katavorio || _uuid();\n        return el;\n    };\n\n    root.Katavorio = function(katavorioParams) {\n\n        var _selection = [],\n            _selectionMap = {};\n\n        this._dragsByScope = {};\n        this._dropsByScope = {};\n        var _zoom = 1,\n            _reg = function(obj, map) {\n                _each(obj, function(_obj) {\n                    for(var i = 0; i < _obj.scopes.length; i++) {\n                        map[_obj.scopes[i]] = map[_obj.scopes[i]] || [];\n                        map[_obj.scopes[i]].push(_obj);\n                    }\n                });\n            },\n            _unreg = function(obj, map) {\n                var c = 0;\n                _each(obj, function(_obj) {\n                    for(var i = 0; i < _obj.scopes.length; i++) {\n                        if (map[_obj.scopes[i]]) {\n                            var idx = katavorioParams.indexOf(map[_obj.scopes[i]], _obj);\n                            if (idx !== -1) {\n                                map[_obj.scopes[i]].splice(idx, 1);\n                                c++;\n                            }\n                        }\n                    }\n                });\n\n                return c > 0 ;\n            },\n            _getMatchingDroppables = this.getMatchingDroppables = function(drag) {\n                var dd = [], _m = {};\n                for (var i = 0; i < drag.scopes.length; i++) {\n                    var _dd = this._dropsByScope[drag.scopes[i]];\n                    if (_dd) {\n                        for (var j = 0; j < _dd.length; j++) {\n                            if (_dd[j].canDrop(drag) &&  !_m[_dd[j].uuid] && (_dd[j].allowLoopback || _dd[j].el !== drag.el)) {\n                                _m[_dd[j].uuid] = true;\n                                dd.push(_dd[j]);\n                            }\n                        }\n                    }\n                }\n                dd.sort(_rankSort);\n                return dd;\n            },\n            _prepareParams = function(p) {\n                p = p || {};\n                var _p = {\n                    events:{}\n                }, i;\n                for (i in katavorioParams) _p[i] = katavorioParams[i];\n                for (i in p) _p[i] = p[i];\n                // events\n\n                for (i = 0; i < _events.length; i++) {\n                    _p.events[_events[i]] = p[_events[i]] || _devNull;\n                }\n                _p.katavorio = this;\n                return _p;\n            }.bind(this),\n            _mistletoe = function(existingDrag, params) {\n                for (var i = 0; i < _events.length; i++) {\n                    if (params[_events[i]]) {\n                        existingDrag.on(_events[i], params[_events[i]]);\n                    }\n                }\n            }.bind(this),\n            _css = {},\n            overrideCss = katavorioParams.css || {},\n            _scope = katavorioParams.scope || _defaultScope;\n\n        // prepare map of css classes based on defaults frst, then optional overrides\n        for (var i in _classes) _css[i] = _classes[i];\n        for (var i in overrideCss) _css[i] = overrideCss[i];\n\n        var inputFilterSelector = katavorioParams.inputFilterSelector || _defaultInputFilterSelector;\n        /**\n         * Gets the selector identifying which input elements to filter from drag events.\n         * @method getInputFilterSelector\n         * @return {String} Current input filter selector.\n         */\n        this.getInputFilterSelector = function() { return inputFilterSelector; };\n\n        /**\n         * Sets the selector identifying which input elements to filter from drag events.\n         * @method setInputFilterSelector\n         * @param {String} selector Input filter selector to set.\n         * @return {Katavorio} Current instance; method may be chained.\n         */\n        this.setInputFilterSelector = function(selector) {\n            inputFilterSelector = selector;\n            return this;\n        };\n\n        /**\n         * Either makes the given element draggable, or identifies it as an element inside which some identified list\n         * of elements may be draggable.\n         * @param el\n         * @param params\n         * @returns {Array}\n         */\n        this.draggable = function(el, params) {\n            var o = [];\n            _each(el, function (_el) {\n                _el = _gel(_el);\n                if (_el != null) {\n                    if (_el._katavorioDrag == null) {\n                        var p = _prepareParams(params);\n                        _el._katavorioDrag = new Drag(_el, p, _css, _scope);\n                        _reg(_el._katavorioDrag, this._dragsByScope);\n                        o.push(_el._katavorioDrag);\n                        katavorioParams.addClass(_el, p.selector ? _css.delegatedDraggable : _css.draggable);\n                    }\n                    else {\n                        _mistletoe(_el._katavorioDrag, params);\n                    }\n                }\n            }.bind(this));\n            return o;\n        };\n\n        this.droppable = function(el, params) {\n            var o = [];\n            _each(el, function(_el) {\n                _el = _gel(_el);\n                if (_el != null) {\n                    var drop = new Drop(_el, _prepareParams(params), _css, _scope);\n                    _el._katavorioDrop = _el._katavorioDrop || [];\n                    _el._katavorioDrop.push(drop);\n                    _reg(drop, this._dropsByScope);\n                    o.push(drop);\n                    katavorioParams.addClass(_el, _css.droppable);\n                }\n            }.bind(this));\n            return o;\n        };\n\n        /**\n         * @name Katavorio#select\n         * @function\n         * @desc Adds an element to the current selection (for multiple node drag)\n         * @param {Element|String} DOM element - or id of the element - to add.\n         */\n        this.select = function(el) {\n            _each(el, function() {\n                var _el = _gel(this);\n                if (_el && _el._katavorioDrag) {\n                    if (!_selectionMap[_el._katavorio]) {\n                        _selection.push(_el._katavorioDrag);\n                        _selectionMap[_el._katavorio] = [ _el, _selection.length - 1 ];\n                        katavorioParams.addClass(_el, _css.selected);\n                    }\n                }\n            });\n            return this;\n        };\n\n        /**\n         * @name Katavorio#deselect\n         * @function\n         * @desc Removes an element from the current selection (for multiple node drag)\n         * @param {Element|String} DOM element - or id of the element - to remove.\n         */\n        this.deselect = function(el) {\n            _each(el, function() {\n                var _el = _gel(this);\n                if (_el && _el._katavorio) {\n                    var e = _selectionMap[_el._katavorio];\n                    if (e) {\n                        var _s = [];\n                        for (var i = 0; i < _selection.length; i++)\n                            if (_selection[i].el !== _el) _s.push(_selection[i]);\n                        _selection = _s;\n                        delete _selectionMap[_el._katavorio];\n                        katavorioParams.removeClass(_el, _css.selected);\n                    }\n                }\n            });\n            return this;\n        };\n\n        this.deselectAll = function() {\n            for (var i in _selectionMap) {\n                var d = _selectionMap[i];\n                katavorioParams.removeClass(d[0], _css.selected);\n            }\n\n            _selection.length = 0;\n            _selectionMap = {};\n        };\n\n        this.markSelection = function(drag) {\n            _foreach(_selection, function(e) { e.mark(); }, drag);\n        };\n\n        this.markPosses = function(drag) {\n            if (drag.posses) {\n                _each(drag.posses, function(p) {\n                    if (drag.posseRoles[p] && _posses[p]) {\n                        _foreach(_posses[p].members, function (d) {\n                            d.mark();\n                        }, drag);\n                    }\n                })\n            }\n        };\n\n        this.unmarkSelection = function(drag, event) {\n            _foreach(_selection, function(e) { e.unmark(event); }, drag);\n        };\n\n        this.unmarkPosses = function(drag, event) {\n            if (drag.posses) {\n                _each(drag.posses, function(p) {\n                    if (drag.posseRoles[p] && _posses[p]) {\n                        _foreach(_posses[p].members, function (d) {\n                            d.unmark(event, true);\n                        }, drag);\n                    }\n                });\n            }\n        };\n\n        this.getSelection = function() { return _selection.slice(0); };\n\n        this.updateSelection = function(dx, dy, drag) {\n            _foreach(_selection, function(e) { e.moveBy(dx, dy); }, drag);\n        };\n\n        var _posseAction = function(fn, drag) {\n            if (drag.posses) {\n                _each(drag.posses, function(p) {\n                    if (drag.posseRoles[p] && _posses[p]) {\n                        _foreach(_posses[p].members, function (e) {\n                            fn(e);\n                        }, drag);\n                    }\n                });\n            }\n        };\n\n        this.updatePosses = function(dx, dy, drag) {\n            _posseAction(function(e) { e.moveBy(dx, dy); }, drag);\n        };\n\n        this.notifyPosseDragStop = function(drag, evt) {\n            _posseAction(function(e) { e.stop(evt, true); }, drag);\n        };\n\n        this.notifySelectionDragStop = function(drag, evt) {\n            _foreach(_selection, function(e) { e.stop(evt, true); }, drag);\n        };\n\n        this.notifySelectionDragStart = function(drag, evt) {\n            _foreach(_selection, function(e) { e.notifyStart(evt);}, drag);\n        };\n\n        this.setZoom = function(z) { _zoom = z; };\n        this.getZoom = function() { return _zoom; };\n\n        // does the work of changing scopes\n        var _scopeManip = function(kObj, scopes, map, fn) {\n            _each(kObj, function(_kObj) {\n                _unreg(_kObj, map);  // deregister existing scopes\n                _kObj[fn](scopes); // set scopes\n                _reg(_kObj, map); // register new ones\n            });\n        };\n\n        _each([ \"set\", \"add\", \"remove\", \"toggle\"], function(v) {\n            this[v + \"Scope\"] = function(el, scopes) {\n                _scopeManip(el._katavorioDrag, scopes, this._dragsByScope, v + \"Scope\");\n                _scopeManip(el._katavorioDrop, scopes, this._dropsByScope, v + \"Scope\");\n            }.bind(this);\n            this[v + \"DragScope\"] = function(el, scopes) {\n                _scopeManip(el.constructor === Drag ? el : el._katavorioDrag, scopes, this._dragsByScope, v + \"Scope\");\n            }.bind(this);\n            this[v + \"DropScope\"] = function(el, scopes) {\n                _scopeManip(el.constructor === Drop ? el : el._katavorioDrop, scopes, this._dropsByScope, v + \"Scope\");\n            }.bind(this);\n        }.bind(this));\n\n        this.snapToGrid = function(x, y) {\n            for (var s in this._dragsByScope) {\n                _foreach(this._dragsByScope[s], function(d) { d.snap(x, y); });\n            }\n        };\n\n        this.getDragsForScope = function(s) { return this._dragsByScope[s]; };\n        this.getDropsForScope = function(s) { return this._dropsByScope[s]; };\n\n        var _destroy = function(el, type, map) {\n            el = _gel(el);\n            if (el[type]) {\n\n                // remove from selection, if present.\n                var selIdx = _selection.indexOf(el[type]);\n                if (selIdx >= 0) {\n                    _selection.splice(selIdx, 1);\n                }\n\n                if (_unreg(el[type], map)) {\n                    _each(el[type], function(kObj) { kObj.destroy() });\n                }\n\n                delete el[type];\n            }\n        };\n\n        var _removeListener = function(el, type, evt, fn) {\n            el = _gel(el);\n            if (el[type]) {\n                el[type].off(evt, fn);\n            }\n        };\n\n        this.elementRemoved = function(el) {\n            this.destroyDraggable(el);\n            this.destroyDroppable(el);\n        };\n\n        /**\n         * Either completely remove drag functionality from the given element, or remove a specific event handler. If you\n         * call this method with a single argument - the element - all drag functionality is removed from it. Otherwise, if\n         * you provide an event name and listener function, this function is de-registered (if found).\n         * @param el Element to update\n         * @param {string} [evt] Optional event name to unsubscribe\n         * @param {Function} [fn] Optional function to unsubscribe\n         */\n        this.destroyDraggable = function(el, evt, fn) {\n            if (arguments.length === 1) {\n                _destroy(el, \"_katavorioDrag\", this._dragsByScope);\n            } else {\n                _removeListener(el, \"_katavorioDrag\", evt, fn);\n            }\n        };\n\n        /**\n         * Either completely remove drop functionality from the given element, or remove a specific event handler. If you\n         * call this method with a single argument - the element - all drop functionality is removed from it. Otherwise, if\n         * you provide an event name and listener function, this function is de-registered (if found).\n         * @param el Element to update\n         * @param {string} [evt] Optional event name to unsubscribe\n         * @param {Function} [fn] Optional function to unsubscribe\n         */\n        this.destroyDroppable = function(el, evt, fn) {\n            if (arguments.length === 1) {\n                _destroy(el, \"_katavorioDrop\", this._dropsByScope);\n            } else {\n                _removeListener(el, \"_katavorioDrop\", evt, fn);\n            }\n        };\n\n        this.reset = function() {\n            this._dragsByScope = {};\n            this._dropsByScope = {};\n            _selection = [];\n            _selectionMap = {};\n            _posses = {};\n        };\n\n        // ----- groups\n        var _posses = {};\n\n        var _processOneSpec = function(el, _spec, dontAddExisting) {\n            var posseId = _isString(_spec) ? _spec : _spec.id;\n            var active = _isString(_spec) ? true : _spec.active !== false;\n            var posse = _posses[posseId] || (function() {\n                var g = {name:posseId, members:[]};\n                _posses[posseId] = g;\n                return g;\n            })();\n            _each(el, function(_el) {\n                if (_el._katavorioDrag) {\n\n                    if (dontAddExisting && _el._katavorioDrag.posseRoles[posse.name] != null) return;\n\n                    _suggest(posse.members, _el._katavorioDrag);\n                    _suggest(_el._katavorioDrag.posses, posse.name);\n                    _el._katavorioDrag.posseRoles[posse.name] = active;\n                }\n            });\n            return posse;\n        };\n\n        /**\n         * Add the given element to the posse with the given id, creating the group if it at first does not exist.\n         * @method addToPosse\n         * @param {Element} el Element to add.\n         * @param {String...|Object...} spec Variable args parameters. Each argument can be a either a String, indicating\n         * the ID of a Posse to which the element should be added as an active participant, or an Object containing\n         * `{ id:\"posseId\", active:false/true}`. In the latter case, if `active` is not provided it is assumed to be\n         * true.\n         * @returns {Posse|Posse[]} The Posse(s) to which the element(s) was/were added.\n         */\n        this.addToPosse = function(el, spec) {\n\n            var posses = [];\n\n            for (var i = 1; i < arguments.length; i++) {\n                posses.push(_processOneSpec(el, arguments[i]));\n            }\n\n            return posses.length === 1 ? posses[0] : posses;\n        };\n\n        /**\n         * Sets the posse(s) for the element with the given id, creating those that do not yet exist, and removing from\n         * the element any current Posses that are not specified by this method call. This method will not change the\n         * active/passive state if it is given a posse in which the element is already a member.\n         * @method setPosse\n         * @param {Element} el Element to set posse(s) on.\n         * @param {String...|Object...} spec Variable args parameters. Each argument can be a either a String, indicating\n         * the ID of a Posse to which the element should be added as an active participant, or an Object containing\n         * `{ id:\"posseId\", active:false/true}`. In the latter case, if `active` is not provided it is assumed to be\n         * true.\n         * @returns {Posse|Posse[]} The Posse(s) to which the element(s) now belongs.\n         */\n        this.setPosse = function(el, spec) {\n\n            var posses = [];\n\n            for (var i = 1; i < arguments.length; i++) {\n                posses.push(_processOneSpec(el, arguments[i], true).name);\n            }\n\n            _each(el, function(_el) {\n                if (_el._katavorioDrag) {\n                    var diff = _difference(_el._katavorioDrag.posses, posses);\n                    var p = [];\n                    Array.prototype.push.apply(p, _el._katavorioDrag.posses);\n                    for (var i = 0; i < diff.length; i++) {\n                        this.removeFromPosse(_el, diff[i]);\n                    }\n                }\n            }.bind(this));\n\n            return posses.length === 1 ? posses[0] : posses;\n        };\n\n        /**\n         * Remove the given element from the given posse(s).\n         * @method removeFromPosse\n         * @param {Element} el Element to remove.\n         * @param {String...} posseId Varargs parameter: one value for each posse to remove the element from.\n         */\n        this.removeFromPosse = function(el, posseId) {\n            if (arguments.length < 2) throw new TypeError(\"No posse id provided for remove operation\");\n            for(var i = 1; i < arguments.length; i++) {\n                posseId = arguments[i];\n                _each(el, function (_el) {\n                    if (_el._katavorioDrag && _el._katavorioDrag.posses) {\n                        var d = _el._katavorioDrag;\n                        _each(posseId, function (p) {\n                            _vanquish(_posses[p].members, d);\n                            _vanquish(d.posses, p);\n                            delete d.posseRoles[p];\n                        });\n                    }\n                });\n            }\n        };\n\n        /**\n         * Remove the given element from all Posses to which it belongs.\n         * @method removeFromAllPosses\n         * @param {Element|Element[]} el Element to remove from Posses.\n         */\n        this.removeFromAllPosses = function(el) {\n            _each(el, function(_el) {\n                if (_el._katavorioDrag && _el._katavorioDrag.posses) {\n                    var d = _el._katavorioDrag;\n                    _each(d.posses, function(p) {\n                        _vanquish(_posses[p].members, d);\n                    });\n                    d.posses.length = 0;\n                    d.posseRoles = {};\n                }\n            });\n        };\n\n        /**\n         * Changes the participation state for the element in the Posse with the given ID.\n         * @param {Element|Element[]} el Element(s) to change state for.\n         * @param {String} posseId ID of the Posse to change element state for.\n         * @param {Boolean} state True to make active, false to make passive.\n         */\n        this.setPosseState = function(el, posseId, state) {\n            var posse = _posses[posseId];\n            if (posse) {\n                _each(el, function(_el) {\n                    if (_el._katavorioDrag && _el._katavorioDrag.posses) {\n                        _el._katavorioDrag.posseRoles[posse.name] = state;\n                    }\n                });\n            }\n        };\n\n    };\n\n    root.Katavorio.version = \"1.0.0\";\n\n    if (typeof exports !== \"undefined\") {\n        exports.Katavorio = root.Katavorio;\n    }\n\n}).call(typeof window !== 'undefined' ? window : this);\n\n/*\n * Utility functions.\n *\n * Copyright (c) 2010 - 2020 jsPlumb (hello@jsplumbtoolkit.com)\n *\n * https://jsplumbtoolkit.com\n * https://github.com/jsplumb/jsplumb\n *\n * Dual licensed under the MIT and GPL2 licenses.\n */\n(function() {\n\n    var root = this;\n    root.jsPlumbUtil = root.jsPlumbUtil || {};\n    var jsPlumbUtil = root.jsPlumbUtil;\n\n    if (typeof exports !=='undefined') { exports.jsPlumbUtil = jsPlumbUtil;}\n\n\n    /**\n     * Tests if the given object is an Array.\n     * @param a\n     */\n    function isArray(a) {\n        return Object.prototype.toString.call(a) === \"[object Array]\";\n    }\n    jsPlumbUtil.isArray = isArray;\n    /**\n     * Tests if the given object is a Number.\n     * @param n\n     */\n    function isNumber(n) {\n        return Object.prototype.toString.call(n) === \"[object Number]\";\n    }\n    jsPlumbUtil.isNumber = isNumber;\n    function isString(s) {\n        return typeof s === \"string\";\n    }\n    jsPlumbUtil.isString = isString;\n    function isBoolean(s) {\n        return typeof s === \"boolean\";\n    }\n    jsPlumbUtil.isBoolean = isBoolean;\n    function isNull(s) {\n        return s == null;\n    }\n    jsPlumbUtil.isNull = isNull;\n    function isObject(o) {\n        return o == null ? false : Object.prototype.toString.call(o) === \"[object Object]\";\n    }\n    jsPlumbUtil.isObject = isObject;\n    function isDate(o) {\n        return Object.prototype.toString.call(o) === \"[object Date]\";\n    }\n    jsPlumbUtil.isDate = isDate;\n    function isFunction(o) {\n        return Object.prototype.toString.call(o) === \"[object Function]\";\n    }\n    jsPlumbUtil.isFunction = isFunction;\n    function isNamedFunction(o) {\n        return isFunction(o) && o.name != null && o.name.length > 0;\n    }\n    jsPlumbUtil.isNamedFunction = isNamedFunction;\n    function isEmpty(o) {\n        for (var i in o) {\n            if (o.hasOwnProperty(i)) {\n                return false;\n            }\n        }\n        return true;\n    }\n    jsPlumbUtil.isEmpty = isEmpty;\n    function clone(a) {\n        if (isString(a)) {\n            return \"\" + a;\n        }\n        else if (isBoolean(a)) {\n            return !!a;\n        }\n        else if (isDate(a)) {\n            return new Date(a.getTime());\n        }\n        else if (isFunction(a)) {\n            return a;\n        }\n        else if (isArray(a)) {\n            var b = [];\n            for (var i = 0; i < a.length; i++) {\n                b.push(clone(a[i]));\n            }\n            return b;\n        }\n        else if (isObject(a)) {\n            var c = {};\n            for (var j in a) {\n                c[j] = clone(a[j]);\n            }\n            return c;\n        }\n        else {\n            return a;\n        }\n    }\n    jsPlumbUtil.clone = clone;\n    function merge(a, b, collations, overwrites) {\n        // first change the collations array - if present - into a lookup table, because its faster.\n        var cMap = {}, ar, i, oMap = {};\n        collations = collations || [];\n        overwrites = overwrites || [];\n        for (i = 0; i < collations.length; i++) {\n            cMap[collations[i]] = true;\n        }\n        for (i = 0; i < overwrites.length; i++) {\n            oMap[overwrites[i]] = true;\n        }\n        var c = clone(a);\n        for (i in b) {\n            if (c[i] == null || oMap[i]) {\n                c[i] = b[i];\n            }\n            else if (isString(b[i]) || isBoolean(b[i])) {\n                if (!cMap[i]) {\n                    c[i] = b[i]; // if we dont want to collate, just copy it in.\n                }\n                else {\n                    ar = [];\n                    // if c's object is also an array we can keep its values.\n                    ar.push.apply(ar, isArray(c[i]) ? c[i] : [c[i]]);\n                    ar.push.apply(ar, isBoolean(b[i]) ? b[i] : [b[i]]);\n                    c[i] = ar;\n                }\n            }\n            else {\n                if (isArray(b[i])) {\n                    ar = [];\n                    // if c's object is also an array we can keep its values.\n                    if (isArray(c[i])) {\n                        ar.push.apply(ar, c[i]);\n                    }\n                    ar.push.apply(ar, b[i]);\n                    c[i] = ar;\n                }\n                else if (isObject(b[i])) {\n                    // overwrite c's value with an object if it is not already one.\n                    if (!isObject(c[i])) {\n                        c[i] = {};\n                    }\n                    for (var j in b[i]) {\n                        c[i][j] = b[i][j];\n                    }\n                }\n            }\n        }\n        return c;\n    }\n    jsPlumbUtil.merge = merge;\n    function replace(inObj, path, value) {\n        if (inObj == null) {\n            return;\n        }\n        var q = inObj, t = q;\n        path.replace(/([^\\.])+/g, function (term, lc, pos, str) {\n            var array = term.match(/([^\\[0-9]+){1}(\\[)([0-9+])/), last = pos + term.length >= str.length, _getArray = function () {\n                return t[array[1]] || (function () {\n                    t[array[1]] = [];\n                    return t[array[1]];\n                })();\n            };\n            if (last) {\n                // set term = value on current t, creating term as array if necessary.\n                if (array) {\n                    _getArray()[array[3]] = value;\n                }\n                else {\n                    t[term] = value;\n                }\n            }\n            else {\n                // set to current t[term], creating t[term] if necessary.\n                if (array) {\n                    var a_1 = _getArray();\n                    t = a_1[array[3]] || (function () {\n                        a_1[array[3]] = {};\n                        return a_1[array[3]];\n                    })();\n                }\n                else {\n                    t = t[term] || (function () {\n                        t[term] = {};\n                        return t[term];\n                    })();\n                }\n            }\n            return \"\";\n        });\n        return inObj;\n    }\n    jsPlumbUtil.replace = replace;\n    //\n    // chain a list of functions, supplied by [ object, method name, args ], and return on the first\n    // one that returns the failValue. if none return the failValue, return the successValue.\n    //\n    function functionChain(successValue, failValue, fns) {\n        for (var i = 0; i < fns.length; i++) {\n            var o = fns[i][0][fns[i][1]].apply(fns[i][0], fns[i][2]);\n            if (o === failValue) {\n                return o;\n            }\n        }\n        return successValue;\n    }\n    jsPlumbUtil.functionChain = functionChain;\n    /**\n     *\n     * Take the given model and expand out any parameters. 'functionPrefix' is optional, and if present, helps jsplumb figure out what to do if a value is a Function.\n     * if you do not provide it (and doNotExpandFunctions is null, or false), jsplumb will run the given values through any functions it finds, and use the function's\n     * output as the value in the result. if you do provide the prefix, only functions that are named and have this prefix\n     * will be executed; other functions will be passed as values to the output.\n     *\n     * @param model\n     * @param values\n     * @param functionPrefix\n     * @param doNotExpandFunctions\n     * @returns {any}\n     */\n    function populate(model, values, functionPrefix, doNotExpandFunctions) {\n        // for a string, see if it has parameter matches, and if so, try to make the substitutions.\n        var getValue = function (fromString) {\n            var matches = fromString.match(/(\\${.*?})/g);\n            if (matches != null) {\n                for (var i = 0; i < matches.length; i++) {\n                    var val = values[matches[i].substring(2, matches[i].length - 1)] || \"\";\n                    if (val != null) {\n                        fromString = fromString.replace(matches[i], val);\n                    }\n                }\n            }\n            return fromString;\n        };\n        // process one entry.\n        var _one = function (d) {\n            if (d != null) {\n                if (isString(d)) {\n                    return getValue(d);\n                }\n                else if (isFunction(d) && !doNotExpandFunctions && (functionPrefix == null || (d.name || \"\").indexOf(functionPrefix) === 0)) {\n                    return d(values);\n                }\n                else if (isArray(d)) {\n                    var r = [];\n                    for (var i = 0; i < d.length; i++) {\n                        r.push(_one(d[i]));\n                    }\n                    return r;\n                }\n                else if (isObject(d)) {\n                    var s = {};\n                    for (var j in d) {\n                        s[j] = _one(d[j]);\n                    }\n                    return s;\n                }\n                else {\n                    return d;\n                }\n            }\n        };\n        return _one(model);\n    }\n    jsPlumbUtil.populate = populate;\n    /**\n     * Find the index of a given object in an array.\n     * @param a The array to search\n     * @param f The function to run on each element. Return true if the element matches.\n     * @returns {number} -1 if not found, otherwise the index in the array.\n     */\n    function findWithFunction(a, f) {\n        if (a) {\n            for (var i = 0; i < a.length; i++) {\n                if (f(a[i])) {\n                    return i;\n                }\n            }\n        }\n        return -1;\n    }\n    jsPlumbUtil.findWithFunction = findWithFunction;\n    /**\n     * Remove some element from an array by matching each element in the array against some predicate function. Note that this\n     * is an in-place removal; the array is altered.\n     * @param a The array to search\n     * @param f The function to run on each element. Return true if the element matches.\n     * @returns {boolean} true if removed, false otherwise.\n     */\n    function removeWithFunction(a, f) {\n        var idx = findWithFunction(a, f);\n        if (idx > -1) {\n            a.splice(idx, 1);\n        }\n        return idx !== -1;\n    }\n    jsPlumbUtil.removeWithFunction = removeWithFunction;\n    /**\n     * Remove some element from an array by simple lookup in the array for the given element. Note that this\n     * is an in-place removal; the array is altered.\n     * @param l The array to search\n     * @param v The value to remove.\n     * @returns {boolean} true if removed, false otherwise.\n     */\n    function remove(l, v) {\n        var idx = l.indexOf(v);\n        if (idx > -1) {\n            l.splice(idx, 1);\n        }\n        return idx !== -1;\n    }\n    jsPlumbUtil.remove = remove;\n    /**\n     * Add some element to the given array, unless it is determined that it is already in the array.\n     * @param list The array to add the element to.\n     * @param item The item to add.\n     * @param hashFunction A function to use to determine if the given item already exists in the array.\n     */\n    function addWithFunction(list, item, hashFunction) {\n        if (findWithFunction(list, hashFunction) === -1) {\n            list.push(item);\n        }\n    }\n    jsPlumbUtil.addWithFunction = addWithFunction;\n    /**\n     * Add some element to a list that is contained in a map of lists.\n     * @param map The map of [ key -> list ] entries\n     * @param key The name of the list to insert into\n     * @param value The value to insert\n     * @param insertAtStart Whether or not to insert at the start; defaults to false.\n     */\n    function addToList(map, key, value, insertAtStart) {\n        var l = map[key];\n        if (l == null) {\n            l = [];\n            map[key] = l;\n        }\n        l[insertAtStart ? \"unshift\" : \"push\"](value);\n        return l;\n    }\n    jsPlumbUtil.addToList = addToList;\n    /**\n     * Add an item to a list, unless it is already in the list. The test for pre-existence is a simple list lookup.\n     * If you want to do something more complex, perhaps #addWithFunction might help.\n     * @param list List to add the item to\n     * @param item Item to add\n     * @param insertAtHead Whether or not to insert at the start; defaults to false.\n     */\n    function suggest(list, item, insertAtHead) {\n        if (list.indexOf(item) === -1) {\n            if (insertAtHead) {\n                list.unshift(item);\n            }\n            else {\n                list.push(item);\n            }\n            return true;\n        }\n        return false;\n    }\n    jsPlumbUtil.suggest = suggest;\n    /**\n     * Extends the given obj (which can be an array) with the given constructor function, prototype functions, and class members, any of which may be null.\n     * @param child\n     * @param parent\n     * @param _protoFn\n     */\n    function extend(child, parent, _protoFn) {\n        var i;\n        parent = isArray(parent) ? parent : [parent];\n        var _copyProtoChain = function (focus) {\n            var proto = focus.__proto__;\n            while (proto != null) {\n                if (proto.prototype != null) {\n                    for (var j in proto.prototype) {\n                        if (proto.prototype.hasOwnProperty(j) && !child.prototype.hasOwnProperty(j)) {\n                            child.prototype[j] = proto.prototype[j];\n                        }\n                    }\n                    proto = proto.prototype.__proto__;\n                }\n                else {\n                    proto = null;\n                }\n            }\n        };\n        for (i = 0; i < parent.length; i++) {\n            for (var j in parent[i].prototype) {\n                if (parent[i].prototype.hasOwnProperty(j) && !child.prototype.hasOwnProperty(j)) {\n                    child.prototype[j] = parent[i].prototype[j];\n                }\n            }\n            _copyProtoChain(parent[i]);\n        }\n        var _makeFn = function (name, protoFn) {\n            return function () {\n                for (i = 0; i < parent.length; i++) {\n                    if (parent[i].prototype[name]) {\n                        parent[i].prototype[name].apply(this, arguments);\n                    }\n                }\n                return protoFn.apply(this, arguments);\n            };\n        };\n        var _oneSet = function (fns) {\n            for (var k in fns) {\n                child.prototype[k] = _makeFn(k, fns[k]);\n            }\n        };\n        if (arguments.length > 2) {\n            for (i = 2; i < arguments.length; i++) {\n                _oneSet(arguments[i]);\n            }\n        }\n        return child;\n    }\n    jsPlumbUtil.extend = extend;\n    /**\n     * Generate a UUID.\n     */\n        // export function uuid(): string {\n        //     return ('xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n        //         let r = Math.random() * 16 | 0, v = c === 'x' ? r : (r & 0x3 | 0x8);\n        //         return v.toString(16);\n        //     }));\n        // }\n    var lut = [];\n    for (var i = 0; i < 256; i++) {\n        lut[i] = (i < 16 ? '0' : '') + (i).toString(16);\n    }\n    function uuid() {\n        var d0 = Math.random() * 0xffffffff | 0;\n        var d1 = Math.random() * 0xffffffff | 0;\n        var d2 = Math.random() * 0xffffffff | 0;\n        var d3 = Math.random() * 0xffffffff | 0;\n        return lut[d0 & 0xff] + lut[d0 >> 8 & 0xff] + lut[d0 >> 16 & 0xff] + lut[d0 >> 24 & 0xff] + '-' +\n            lut[d1 & 0xff] + lut[d1 >> 8 & 0xff] + '-' + lut[d1 >> 16 & 0x0f | 0x40] + lut[d1 >> 24 & 0xff] + '-' +\n            lut[d2 & 0x3f | 0x80] + lut[d2 >> 8 & 0xff] + '-' + lut[d2 >> 16 & 0xff] + lut[d2 >> 24 & 0xff] +\n            lut[d3 & 0xff] + lut[d3 >> 8 & 0xff] + lut[d3 >> 16 & 0xff] + lut[d3 >> 24 & 0xff];\n    }\n    jsPlumbUtil.uuid = uuid;\n    /**\n     * Trim a string.\n     * @param s String to trim\n     * @returns the String with leading and trailing whitespace removed.\n     */\n    function fastTrim(s) {\n        if (s == null) {\n            return null;\n        }\n        var str = s.replace(/^\\s\\s*/, ''), ws = /\\s/, i = str.length;\n        while (ws.test(str.charAt(--i))) {\n        }\n        return str.slice(0, i + 1);\n    }\n    jsPlumbUtil.fastTrim = fastTrim;\n    function each(obj, fn) {\n        obj = obj.length == null || typeof obj === \"string\" ? [obj] : obj;\n        for (var i = 0; i < obj.length; i++) {\n            fn(obj[i]);\n        }\n    }\n    jsPlumbUtil.each = each;\n    function map(obj, fn) {\n        var o = [];\n        for (var i = 0; i < obj.length; i++) {\n            o.push(fn(obj[i]));\n        }\n        return o;\n    }\n    jsPlumbUtil.map = map;\n    function mergeWithParents(type, map, parentAttribute) {\n        parentAttribute = parentAttribute || \"parent\";\n        var _def = function (id) {\n            return id ? map[id] : null;\n        };\n        var _parent = function (def) {\n            return def ? _def(def[parentAttribute]) : null;\n        };\n        var _one = function (parent, def) {\n            if (parent == null) {\n                return def;\n            }\n            else {\n                var overrides = [\"anchor\", \"anchors\", \"cssClass\", \"connector\", \"paintStyle\", \"hoverPaintStyle\", \"endpoint\", \"endpoints\"];\n                if (def.mergeStrategy === \"override\") {\n                    Array.prototype.push.apply(overrides, [\"events\", \"overlays\"]);\n                }\n                var d_1 = merge(parent, def, [], overrides);\n                return _one(_parent(parent), d_1);\n            }\n        };\n        var _getDef = function (t) {\n            if (t == null) {\n                return {};\n            }\n            if (typeof t === \"string\") {\n                return _def(t);\n            }\n            else if (t.length) {\n                var done = false, i = 0, _dd = void 0;\n                while (!done && i < t.length) {\n                    _dd = _getDef(t[i]);\n                    if (_dd) {\n                        done = true;\n                    }\n                    else {\n                        i++;\n                    }\n                }\n                return _dd;\n            }\n        };\n        var d = _getDef(type);\n        if (d) {\n            return _one(_parent(d), d);\n        }\n        else {\n            return {};\n        }\n    }\n    jsPlumbUtil.mergeWithParents = mergeWithParents;\n    jsPlumbUtil.logEnabled = true;\n    function log() {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (jsPlumbUtil.logEnabled && typeof console !== \"undefined\") {\n            try {\n                var msg = arguments[arguments.length - 1];\n                console.log(msg);\n            }\n            catch (e) {\n            }\n        }\n    }\n    jsPlumbUtil.log = log;\n    /**\n     * Wraps one function with another, creating a placeholder for the\n     * wrapped function if it was null. this is used to wrap the various\n     * drag/drop event functions - to allow jsPlumb to be notified of\n     * important lifecycle events without imposing itself on the user's\n     * drag/drop functionality.\n     * @method jsPlumbUtil.wrap\n     * @param {Function} wrappedFunction original function to wrap; may be null.\n     * @param {Function} newFunction function to wrap the original with.\n     * @param {Object} [returnOnThisValue] Optional. Indicates that the wrappedFunction should\n     * not be executed if the newFunction returns a value matching 'returnOnThisValue'.\n     * note that this is a simple comparison and only works for primitives right now.\n     */\n    function wrap(wrappedFunction, newFunction, returnOnThisValue) {\n        return function () {\n            var r = null;\n            try {\n                if (newFunction != null) {\n                    r = newFunction.apply(this, arguments);\n                }\n            }\n            catch (e) {\n                log(\"jsPlumb function failed : \" + e);\n            }\n            if ((wrappedFunction != null) && (returnOnThisValue == null || (r !== returnOnThisValue))) {\n                try {\n                    r = wrappedFunction.apply(this, arguments);\n                }\n                catch (e) {\n                    log(\"wrapped function failed : \" + e);\n                }\n            }\n            return r;\n        };\n    }\n    jsPlumbUtil.wrap = wrap;\n    var EventGenerator = /** @class */ (function () {\n        function EventGenerator() {\n            var _this = this;\n            this._listeners = {};\n            this.eventsSuspended = false;\n            this.tick = false;\n            // this is a list of events that should re-throw any errors that occur during their dispatch.\n            this.eventsToDieOn = { \"ready\": true };\n            this.queue = [];\n            this.bind = function (event, listener, insertAtStart) {\n                var _one = function (evt) {\n                    addToList(_this._listeners, evt, listener, insertAtStart);\n                    listener.__jsPlumb = listener.__jsPlumb || {};\n                    listener.__jsPlumb[uuid()] = evt;\n                };\n                if (typeof event === \"string\") {\n                    _one(event);\n                }\n                else if (event.length != null) {\n                    for (var i = 0; i < event.length; i++) {\n                        _one(event[i]);\n                    }\n                }\n                return _this;\n            };\n            this.fire = function (event, value, originalEvent) {\n                if (!this.tick) {\n                    this.tick = true;\n                    if (!this.eventsSuspended && this._listeners[event]) {\n                        var l = this._listeners[event].length, i = 0, _gone = false, ret = null;\n                        if (!this.shouldFireEvent || this.shouldFireEvent(event, value, originalEvent)) {\n                            while (!_gone && i < l && ret !== false) {\n                                // doing it this way rather than catching and then possibly re-throwing means that an error propagated by this\n                                // method will have the whole call stack available in the debugger.\n                                if (this.eventsToDieOn[event]) {\n                                    this._listeners[event][i].apply(this, [value, originalEvent]);\n                                }\n                                else {\n                                    try {\n                                        ret = this._listeners[event][i].apply(this, [value, originalEvent]);\n                                    }\n                                    catch (e) {\n                                        log(\"jsPlumb: fire failed for event \" + event + \" : \" + e);\n                                    }\n                                }\n                                i++;\n                                if (this._listeners == null || this._listeners[event] == null) {\n                                    _gone = true;\n                                }\n                            }\n                        }\n                    }\n                    this.tick = false;\n                    this._drain();\n                }\n                else {\n                    this.queue.unshift(arguments);\n                }\n                return this;\n            };\n            this._drain = function () {\n                var n = _this.queue.pop();\n                if (n) {\n                    _this.fire.apply(_this, n);\n                }\n            };\n            this.unbind = function (eventOrListener, listener) {\n                if (arguments.length === 0) {\n                    this._listeners = {};\n                }\n                else if (arguments.length === 1) {\n                    if (typeof eventOrListener === \"string\") {\n                        delete this._listeners[eventOrListener];\n                    }\n                    else if (eventOrListener.__jsPlumb) {\n                        var evt = void 0;\n                        for (var i in eventOrListener.__jsPlumb) {\n                            evt = eventOrListener.__jsPlumb[i];\n                            remove(this._listeners[evt] || [], eventOrListener);\n                        }\n                    }\n                }\n                else if (arguments.length === 2) {\n                    remove(this._listeners[eventOrListener] || [], listener);\n                }\n                return this;\n            };\n            this.getListener = function (forEvent) {\n                return _this._listeners[forEvent];\n            };\n            this.setSuspendEvents = function (val) {\n                _this.eventsSuspended = val;\n            };\n            this.isSuspendEvents = function () {\n                return _this.eventsSuspended;\n            };\n            this.silently = function (fn) {\n                _this.setSuspendEvents(true);\n                try {\n                    fn();\n                }\n                catch (e) {\n                    log(\"Cannot execute silent function \" + e);\n                }\n                _this.setSuspendEvents(false);\n            };\n            this.cleanupListeners = function () {\n                for (var i in _this._listeners) {\n                    _this._listeners[i] = null;\n                }\n            };\n        }\n        return EventGenerator;\n    }());\n    jsPlumbUtil.EventGenerator = EventGenerator;\n\n}).call(typeof window !== 'undefined' ? window : this);\n\n/*\n * This file contains utility functions that run in browsers only.\n *\n * Copyright (c) 2010 - 2020 jsPlumb (hello@jsplumbtoolkit.com)\n *\n * https://jsplumbtoolkit.com\n * https://github.com/jsplumb/jsplumb\n *\n * Dual licensed under the MIT and GPL2 licenses.\n */\n ;(function() {\n\n  \"use strict\";\n\n   var root = this;\n\n    root.jsPlumbUtil.matchesSelector = function(el, selector, ctx) {\n       ctx = ctx || el.parentNode;\n       var possibles = ctx.querySelectorAll(selector);\n       for (var i = 0; i < possibles.length; i++) {\n           if (possibles[i] === el) {\n               return true;\n           }\n       }\n       return false;\n   };\n\n    root.jsPlumbUtil.consume = function(e, doNotPreventDefault) {\n       if (e.stopPropagation) {\n           e.stopPropagation();\n       }\n       else {\n           e.returnValue = false;\n       }\n\n       if (!doNotPreventDefault && e.preventDefault){\n           e.preventDefault();\n       }\n   };\n\n   /*\n    * Function: sizeElement\n    * Helper to size and position an element. You would typically use\n    * this when writing your own Connector or Endpoint implementation.\n    *\n    * Parameters:\n    *  x - [int] x position for the element origin\n    *  y - [int] y position for the element origin\n    *  w - [int] width of the element\n    *  h - [int] height of the element\n    *\n    */\n    root.jsPlumbUtil.sizeElement = function(el, x, y, w, h) {\n       if (el) {\n           el.style.height = h + \"px\";\n           el.height = h;\n           el.style.width = w + \"px\";\n           el.width = w;\n           el.style.left = x + \"px\";\n           el.style.top = y + \"px\";\n       }\n   };\n\n }).call(typeof window !== 'undefined' ? window : this);\n\n/*\n * This file contains the code for working with scrollable lists.\n *\n * Copyright (c) 2010 - 2020 jsPlumb (hello@jsplumbtoolkit.com)\n *\n * https://jsplumbtoolkit.com\n * https://github.com/jsplumb/jsplumb\n *\n * Dual licensed under the MIT and GPL2 licenses.\n */\n;(function() {\n\n    var DEFAULT_OPTIONS = {\n        deriveAnchor:function(edge, index, ep, conn) {\n            return {\n                top:[\"TopRight\", \"TopLeft\"],\n                bottom:[\"BottomRight\", \"BottomLeft\"]\n            }[edge][index];\n        }\n    };\n\n    var root = this;\n\n    var ListManager = function(jsPlumbInstance, params) {\n\n        this.count = 0;\n        this.instance = jsPlumbInstance;\n        this.lists = {};\n        this.options = params || {};\n\n        this.instance.addList = function(el, options) {\n            return this.listManager.addList(el, options);\n        };\n\n        this.instance.removeList = function(el) {\n            this.listManager.removeList(el);\n        };\n\n        this.instance.bind(\"manageElement\", function(p) {\n\n            //look for [jtk-scrollable-list] elements and attach scroll listeners if necessary\n            var scrollableLists = this.instance.getSelector(p.el, \"[jtk-scrollable-list]\");\n            for (var i = 0; i < scrollableLists.length; i++) {\n                this.addList(scrollableLists[i]);\n            }\n\n        }.bind(this));\n\n        this.instance.bind(\"unmanageElement\", function(p) {\n            this.removeList(p.el);\n        });\n\n\n        this.instance.bind(\"connection\", function(c, evt) {\n            if (evt == null) {\n                // not added by mouse. look for an ancestor of the source and/or target element that is a scrollable list, and run\n                // its scroll method.\n                this._maybeUpdateParentList(c.source);\n                this._maybeUpdateParentList(c.target);\n            }\n        }.bind(this));\n    };\n\n    root.jsPlumbListManager = ListManager;\n\n    ListManager.prototype = {\n\n        addList : function(el, options) {\n            var dp = this.instance.extend({}, DEFAULT_OPTIONS);\n            this.instance.extend(dp, this.options);\n            options = this.instance.extend(dp,  options || {});\n            var id = [this.instance.getInstanceIndex(), this.count++].join(\"_\");\n            this.lists[id] = new List(this.instance, el, options, id);\n        },\n\n        removeList:function(el) {\n            var list = this.lists[el._jsPlumbList];\n            if (list) {\n                list.destroy();\n                delete this.lists[el._jsPlumbList];\n            }\n        },\n\n        _maybeUpdateParentList:function (el) {\n            var parent = el.parentNode, container = this.instance.getContainer();\n            while(parent != null && parent !== container) {\n                if (parent._jsPlumbList != null && this.lists[parent._jsPlumbList] != null) {\n                    parent._jsPlumbScrollHandler();\n                    return\n                }\n                parent = parent.parentNode;\n            }\n        }\n\n\n    };\n\n    var List = function(instance, el, options, id) {\n\n        el[\"_jsPlumbList\"] = id;\n\n        //\n        // Derive an anchor to use for the current situation. In contrast to the way we derive an endpoint, here we use `anchor` from the options, if present, as\n        // our first choice, and then `deriveAnchor` as our next choice. There is a default `deriveAnchor` implementation that uses TopRight/TopLeft for top and\n        // BottomRight/BottomLeft for bottom.\n        //\n        // edge - \"top\" or \"bottom\"\n        // index - 0 when endpoint is connection source, 1 when endpoint is connection target\n        // ep - the endpoint that is being proxied\n        // conn - the connection that is being proxied\n        //\n        function deriveAnchor(edge, index, ep, conn) {\n            return options.anchor ? options.anchor : options.deriveAnchor(edge, index, ep, conn);\n        }\n\n        //\n        // Derive an endpoint to use for the current situation. We'll use a `deriveEndpoint` function passed in to the options as our first choice,\n        // followed by `endpoint` (an endpoint spec) from the options, and failing either of those we just use the `type` of the endpoint that is being proxied.\n        //\n        // edge - \"top\" or \"bottom\"\n        // index - 0 when endpoint is connection source, 1 when endpoint is connection target\n        // endpoint - the endpoint that is being proxied\n        // connection - the connection that is being proxied\n        //\n        function deriveEndpoint(edge, index, ep, conn) {\n            return options.deriveEndpoint ? options.deriveEndpoint(edge, index, ep, conn) : options.endpoint ? options.endpoint : ep.type;\n        }\n\n        //\n        // look for a parent of the given scrollable list that is draggable, and then update the child offsets for it. this should not\n        // be necessary in the delegated drag stuff from the upcoming 3.0.0 release.\n        //\n        function _maybeUpdateDraggable(el) {\n            var parent = el.parentNode, container = instance.getContainer();\n            while(parent != null && parent !== container) {\n                if (instance.hasClass(parent, \"jtk-managed\")) {\n                    instance.recalculateOffsets(parent);\n                    return\n                }\n                parent = parent.parentNode;\n            }\n        }\n\n        var scrollHandler = function(e) {\n\n            var children = instance.getSelector(el, \".jtk-managed\");\n            var elId = instance.getId(el);\n\n            for (var i = 0; i < children.length; i++) {\n\n                if (children[i].offsetTop < el.scrollTop) {\n                    if (!children[i]._jsPlumbProxies) {\n                        children[i]._jsPlumbProxies = children[i]._jsPlumbProxies || [];\n                        instance.select({source: children[i]}).each(function (c) {\n\n\n                            instance.proxyConnection(c, 0, el, elId, function () {\n                                return deriveEndpoint(\"top\", 0, c.endpoints[0], c);\n                            }, function () {\n                                return deriveAnchor(\"top\", 0, c.endpoints[0], c);\n                            });\n                            children[i]._jsPlumbProxies.push([c, 0]);\n                        });\n\n                        instance.select({target: children[i]}).each(function (c) {\n                            instance.proxyConnection(c, 1, el, elId, function () {\n                                return deriveEndpoint(\"top\", 1, c.endpoints[1], c);\n                            }, function () {\n                                return deriveAnchor(\"top\", 1, c.endpoints[1], c);\n                            });\n                            children[i]._jsPlumbProxies.push([c, 1]);\n                        });\n                    }\n                }\n                //\n                else if (children[i].offsetTop + children[i].offsetHeight > el.scrollTop + el.offsetHeight) {\n                    if (!children[i]._jsPlumbProxies) {\n                        children[i]._jsPlumbProxies = children[i]._jsPlumbProxies || [];\n\n                        instance.select({source: children[i]}).each(function (c) {\n                            instance.proxyConnection(c, 0, el, elId, function () {\n                                return deriveEndpoint(\"bottom\", 0, c.endpoints[0], c);\n                            }, function () {\n                                return deriveAnchor(\"bottom\", 0, c.endpoints[0], c);\n                            });\n                            children[i]._jsPlumbProxies.push([c, 0]);\n                        });\n\n                        instance.select({target: children[i]}).each(function (c) {\n                            instance.proxyConnection(c, 1, el, elId, function () {\n                                return deriveEndpoint(\"bottom\", 1, c.endpoints[1], c);\n                            }, function () {\n                                return deriveAnchor(\"bottom\", 1, c.endpoints[1], c);\n                            });\n                            children[i]._jsPlumbProxies.push([c, 1]);\n                        });\n                    }\n                } else if (children[i]._jsPlumbProxies) {\n                    for (var j = 0; j < children[i]._jsPlumbProxies.length; j++) {\n                        instance.unproxyConnection(children[i]._jsPlumbProxies[j][0], children[i]._jsPlumbProxies[j][1], elId);\n                    }\n\n                    delete children[i]._jsPlumbProxies;\n                }\n\n                instance.revalidate(children[i]);\n            }\n\n            _maybeUpdateDraggable(el);\n        };\n\n        instance.setAttribute(el, \"jtk-scrollable-list\", \"true\");\n        el._jsPlumbScrollHandler = scrollHandler;\n        instance.on(el, \"scroll\", scrollHandler);\n        scrollHandler(); // run it once; there may be connections already.\n\n        this.destroy = function() {\n            instance.off(el, \"scroll\", scrollHandler);\n            delete el._jsPlumbScrollHandler;\n\n            var children = instance.getSelector(el, \".jtk-managed\");\n            var elId = instance.getId(el);\n\n            for (var i = 0; i < children.length; i++) {\n                if (children[i]._jsPlumbProxies) {\n                    for (var j = 0; j < children[i]._jsPlumbProxies.length; j++) {\n                        instance.unproxyConnection(children[i]._jsPlumbProxies[j][0], children[i]._jsPlumbProxies[j][1], elId);\n                    }\n\n                    delete children[i]._jsPlumbProxies;\n                }\n            }\n        };\n    };\n\n\n}).call(typeof window !== 'undefined' ? window : this);\n\n/*\n * This file contains the core code.\n *\n * Copyright (c) 2010 - 2020 jsPlumb (hello@jsplumbtoolkit.com)\n *\n * https://jsplumbtoolkit.com\n * https://github.com/jsplumb/jsplumb\n *\n * Dual licensed under the MIT and GPL2 licenses.\n */\n;(function () {\n\n    \"use strict\";\n\n    var root = this;\n\n    var _ju = root.jsPlumbUtil,\n\n        /**\n         * creates a timestamp, using milliseconds since 1970, but as a string.\n         */\n        _timestamp = function () {\n            return \"\" + (new Date()).getTime();\n        },\n\n        // helper method to update the hover style whenever it, or paintStyle, changes.\n        // we use paintStyle as the foundation and merge hoverPaintStyle over the\n        // top.\n        _updateHoverStyle = function (component) {\n            if (component._jsPlumb.paintStyle && component._jsPlumb.hoverPaintStyle) {\n                var mergedHoverStyle = {};\n                jsPlumb.extend(mergedHoverStyle, component._jsPlumb.paintStyle);\n                jsPlumb.extend(mergedHoverStyle, component._jsPlumb.hoverPaintStyle);\n                delete component._jsPlumb.hoverPaintStyle;\n                // we want the fill of paintStyle to override a gradient, if possible.\n                if (mergedHoverStyle.gradient && component._jsPlumb.paintStyle.fill) {\n                    delete mergedHoverStyle.gradient;\n                }\n                component._jsPlumb.hoverPaintStyle = mergedHoverStyle;\n            }\n        },\n        events = [\"tap\", \"dbltap\", \"click\", \"dblclick\", \"mouseover\", \"mouseout\", \"mousemove\", \"mousedown\", \"mouseup\", \"contextmenu\" ],\n        eventFilters = { \"mouseout\": \"mouseleave\", \"mouseexit\": \"mouseleave\" },\n        _updateAttachedElements = function (component, state, timestamp, sourceElement) {\n            var affectedElements = component.getAttachedElements();\n            if (affectedElements) {\n                for (var i = 0, j = affectedElements.length; i < j; i++) {\n                    if (!sourceElement || sourceElement !== affectedElements[i]) {\n                        affectedElements[i].setHover(state, true, timestamp);\t\t\t// tell the attached elements not to inform their own attached elements.\n                    }\n                }\n            }\n        },\n        _splitType = function (t) {\n            return t == null ? null : t.split(\" \");\n        },\n        _mapType = function(map, obj, typeId) {\n            for (var i in obj) {\n                map[i] = typeId;\n            }\n        },\n        _each = function(fn, obj) {\n            obj = _ju.isArray(obj) || (obj.length != null && !_ju.isString(obj)) ? obj : [ obj ];\n            for (var i = 0; i < obj.length; i++) {\n                try {\n                    fn.apply(obj[i], [ obj[i] ]);\n                }\n                catch (e) {\n                    _ju.log(\".each iteration failed : \" + e);\n                }\n            }\n        },\n        _applyTypes = function (component, params, doNotRepaint) {\n            if (component.getDefaultType) {\n                var td = component.getTypeDescriptor(), map = {};\n                var defType = component.getDefaultType();\n                var o = _ju.merge({}, defType);\n                _mapType(map, defType, \"__default\");\n                for (var i = 0, j = component._jsPlumb.types.length; i < j; i++) {\n                    var tid = component._jsPlumb.types[i];\n                    if (tid !== \"__default\") {\n                        var _t = component._jsPlumb.instance.getType(tid, td);\n                        if (_t != null) {\n\n                            var overrides = [\"anchor\", \"anchors\", \"connector\", \"paintStyle\", \"hoverPaintStyle\", \"endpoint\", \"endpoints\", \"connectorOverlays\", \"connectorStyle\", \"connectorHoverStyle\", \"endpointStyle\", \"endpointHoverStyle\"];\n                            var collations = [ ];\n\n                            if (_t.mergeStrategy === \"override\") {\n                                Array.prototype.push.apply(overrides, [\"events\", \"overlays\", \"cssClass\"]);\n                            } else {\n                                collations.push(\"cssClass\");\n                            }\n\n                            o = _ju.merge(o, _t, collations, overrides);\n                            _mapType(map, _t, tid);\n                        }\n                    }\n                }\n\n                if (params) {\n                    o = _ju.populate(o, params, \"_\");\n                }\n\n                component.applyType(o, doNotRepaint, map);\n                if (!doNotRepaint) {\n                    component.repaint();\n                }\n            }\n        },\n\n// ------------------------------ BEGIN jsPlumbUIComponent --------------------------------------------\n\n        jsPlumbUIComponent = root.jsPlumbUIComponent = function (params) {\n\n            _ju.EventGenerator.apply(this, arguments);\n\n            var self = this,\n                a = arguments,\n                idPrefix = self.idPrefix,\n                id = idPrefix + (new Date()).getTime();\n\n            this._jsPlumb = {\n                instance: params._jsPlumb,\n                parameters: params.parameters || {},\n                paintStyle: null,\n                hoverPaintStyle: null,\n                paintStyleInUse: null,\n                hover: false,\n                beforeDetach: params.beforeDetach,\n                beforeDrop: params.beforeDrop,\n                overlayPlacements: [],\n                hoverClass: params.hoverClass || params._jsPlumb.Defaults.HoverClass,\n                types: [],\n                typeCache:{}\n            };\n\n            this.cacheTypeItem = function(key, item, typeId) {\n                this._jsPlumb.typeCache[typeId] = this._jsPlumb.typeCache[typeId] || {};\n                this._jsPlumb.typeCache[typeId][key] = item;\n            };\n            this.getCachedTypeItem = function(key, typeId) {\n                return this._jsPlumb.typeCache[typeId] ? this._jsPlumb.typeCache[typeId][key] : null;\n            };\n\n            this.getId = function () {\n                return id;\n            };\n\n// ----------------------------- default type --------------------------------------------\n\n\n            var o = params.overlays || [], oo = {};\n            if (this.defaultOverlayKeys) {\n                for (var i = 0; i < this.defaultOverlayKeys.length; i++) {\n                    Array.prototype.push.apply(o, this._jsPlumb.instance.Defaults[this.defaultOverlayKeys[i]] || []);\n                }\n\n                for (i = 0; i < o.length; i++) {\n                    // if a string, convert to object representation so that we can store the typeid on it.\n                    // also assign an id.\n                    var fo = jsPlumb.convertToFullOverlaySpec(o[i]);\n                    oo[fo[1].id] = fo;\n                }\n            }\n\n            var _defaultType = {\n                overlays:oo,\n                parameters: params.parameters || {},\n                scope: params.scope || this._jsPlumb.instance.getDefaultScope()\n            };\n            this.getDefaultType = function() {\n                return _defaultType;\n            };\n            this.appendToDefaultType = function(obj) {\n                for (var i in obj) {\n                    _defaultType[i] = obj[i];\n                }\n            };\n\n// ----------------------------- end default type --------------------------------------------\n\n            // all components can generate events\n\n            if (params.events) {\n                for (var evtName in params.events) {\n                    self.bind(evtName, params.events[evtName]);\n                }\n            }\n\n            // all components get this clone function.\n            // TODO issue 116 showed a problem with this - it seems 'a' that is in\n            // the clone function's scope is shared by all invocations of it, the classic\n            // JS closure problem.  for now, jsPlumb does a version of this inline where\n            // it used to call clone.  but it would be nice to find some time to look\n            // further at this.\n            this.clone = function () {\n                var o = Object.create(this.constructor.prototype);\n                this.constructor.apply(o, a);\n                return o;\n            }.bind(this);\n\n            // user can supply a beforeDetach callback, which will be executed before a detach\n            // is performed; returning false prevents the detach.\n            this.isDetachAllowed = function (connection) {\n                var r = true;\n                if (this._jsPlumb.beforeDetach) {\n                    try {\n                        r = this._jsPlumb.beforeDetach(connection);\n                    }\n                    catch (e) {\n                        _ju.log(\"jsPlumb: beforeDetach callback failed\", e);\n                    }\n                }\n                return r;\n            };\n\n            // user can supply a beforeDrop callback, which will be executed before a dropped\n            // connection is confirmed. user can return false to reject connection.\n            this.isDropAllowed = function (sourceId, targetId, scope, connection, dropEndpoint, source, target) {\n                var r = this._jsPlumb.instance.checkCondition(\"beforeDrop\", {\n                    sourceId: sourceId,\n                    targetId: targetId,\n                    scope: scope,\n                    connection: connection,\n                    dropEndpoint: dropEndpoint,\n                    source: source, target: target\n                });\n                if (this._jsPlumb.beforeDrop) {\n                    try {\n                        r = this._jsPlumb.beforeDrop({\n                            sourceId: sourceId,\n                            targetId: targetId,\n                            scope: scope,\n                            connection: connection,\n                            dropEndpoint: dropEndpoint,\n                            source: source, target: target\n                        });\n                    }\n                    catch (e) {\n                        _ju.log(\"jsPlumb: beforeDrop callback failed\", e);\n                    }\n                }\n                return r;\n            };\n\n            var domListeners = [];\n\n            // sets the component associated with listener events. for instance, an overlay delegates\n            // its events back to a connector. but if the connector is swapped on the underlying connection,\n            // then this component must be changed. This is called by setConnector in the Connection class.\n            this.setListenerComponent = function (c) {\n                for (var i = 0; i < domListeners.length; i++) {\n                    domListeners[i][3] = c;\n                }\n            };\n\n\n        };\n\n    var _removeTypeCssHelper = function (component, typeIndex) {\n        var typeId = component._jsPlumb.types[typeIndex],\n            type = component._jsPlumb.instance.getType(typeId, component.getTypeDescriptor());\n\n        if (type != null && type.cssClass && component.canvas) {\n            component._jsPlumb.instance.removeClass(component.canvas, type.cssClass);\n        }\n    };\n\n    _ju.extend(root.jsPlumbUIComponent, _ju.EventGenerator, {\n\n        getParameter: function (name) {\n            return this._jsPlumb.parameters[name];\n        },\n\n        setParameter: function (name, value) {\n            this._jsPlumb.parameters[name] = value;\n        },\n\n        getParameters: function () {\n            return this._jsPlumb.parameters;\n        },\n\n        setParameters: function (p) {\n            this._jsPlumb.parameters = p;\n        },\n\n        getClass:function() {\n            return jsPlumb.getClass(this.canvas);\n        },\n\n        hasClass:function(clazz) {\n            return jsPlumb.hasClass(this.canvas, clazz);\n        },\n\n        addClass: function (clazz) {\n            jsPlumb.addClass(this.canvas, clazz);\n        },\n\n        removeClass: function (clazz) {\n            jsPlumb.removeClass(this.canvas, clazz);\n        },\n\n        updateClasses: function (classesToAdd, classesToRemove) {\n            jsPlumb.updateClasses(this.canvas, classesToAdd, classesToRemove);\n        },\n\n        setType: function (typeId, params, doNotRepaint) {\n            this.clearTypes();\n            this._jsPlumb.types = _splitType(typeId) || [];\n            _applyTypes(this, params, doNotRepaint);\n        },\n\n        getType: function () {\n            return this._jsPlumb.types;\n        },\n\n        reapplyTypes: function (params, doNotRepaint) {\n            _applyTypes(this, params, doNotRepaint);\n        },\n\n        hasType: function (typeId) {\n            return this._jsPlumb.types.indexOf(typeId) !== -1;\n        },\n\n        addType: function (typeId, params, doNotRepaint) {\n            var t = _splitType(typeId), _cont = false;\n            if (t != null) {\n                for (var i = 0, j = t.length; i < j; i++) {\n                    if (!this.hasType(t[i])) {\n                        this._jsPlumb.types.push(t[i]);\n                        _cont = true;\n                    }\n                }\n                if (_cont) {\n                    _applyTypes(this, params, doNotRepaint);\n                }\n            }\n        },\n\n        removeType: function (typeId, params, doNotRepaint) {\n            var t = _splitType(typeId), _cont = false, _one = function (tt) {\n                var idx = this._jsPlumb.types.indexOf(tt);\n                if (idx !== -1) {\n                    // remove css class if necessary\n                    _removeTypeCssHelper(this, idx);\n                    this._jsPlumb.types.splice(idx, 1);\n                    return true;\n                }\n                return false;\n            }.bind(this);\n\n            if (t != null) {\n                for (var i = 0, j = t.length; i < j; i++) {\n                    _cont = _one(t[i]) || _cont;\n                }\n                if (_cont) {\n                    _applyTypes(this, params, doNotRepaint);\n                }\n            }\n        },\n        clearTypes: function (params, doNotRepaint) {\n            var i = this._jsPlumb.types.length;\n            for (var j = 0; j < i; j++) {\n                _removeTypeCssHelper(this, 0);\n                this._jsPlumb.types.splice(0, 1);\n            }\n            _applyTypes(this, params, doNotRepaint);\n        },\n\n        toggleType: function (typeId, params, doNotRepaint) {\n            var t = _splitType(typeId);\n            if (t != null) {\n                for (var i = 0, j = t.length; i < j; i++) {\n                    var idx = this._jsPlumb.types.indexOf(t[i]);\n                    if (idx !== -1) {\n                        _removeTypeCssHelper(this, idx);\n                        this._jsPlumb.types.splice(idx, 1);\n                    }\n                    else {\n                        this._jsPlumb.types.push(t[i]);\n                    }\n                }\n\n                _applyTypes(this, params, doNotRepaint);\n            }\n        },\n        applyType: function (t, doNotRepaint) {\n            this.setPaintStyle(t.paintStyle, doNotRepaint);\n            this.setHoverPaintStyle(t.hoverPaintStyle, doNotRepaint);\n            if (t.parameters) {\n                for (var i in t.parameters) {\n                    this.setParameter(i, t.parameters[i]);\n                }\n            }\n            this._jsPlumb.paintStyleInUse = this.getPaintStyle();\n        },\n        setPaintStyle: function (style, doNotRepaint) {\n            // this._jsPlumb.paintStyle = jsPlumb.extend({}, style);\n            // TODO figure out if we want components to clone paintStyle so as not to share it.\n            this._jsPlumb.paintStyle = style;\n            this._jsPlumb.paintStyleInUse = this._jsPlumb.paintStyle;\n            _updateHoverStyle(this);\n            if (!doNotRepaint) {\n                this.repaint();\n            }\n        },\n        getPaintStyle: function () {\n            return this._jsPlumb.paintStyle;\n        },\n        setHoverPaintStyle: function (style, doNotRepaint) {\n            //this._jsPlumb.hoverPaintStyle = jsPlumb.extend({}, style);\n            // TODO figure out if we want components to clone paintStyle so as not to share it.\n            this._jsPlumb.hoverPaintStyle = style;\n            _updateHoverStyle(this);\n            if (!doNotRepaint) {\n                this.repaint();\n            }\n        },\n        getHoverPaintStyle: function () {\n            return this._jsPlumb.hoverPaintStyle;\n        },\n        destroy: function (force) {\n            if (force || this.typeId == null) {\n                this.cleanupListeners(); // this is on EventGenerator\n                this.clone = null;\n                this._jsPlumb = null;\n            }\n        },\n\n        isHover: function () {\n            return this._jsPlumb.hover;\n        },\n\n        setHover: function (hover, ignoreAttachedElements, timestamp) {\n            // while dragging, we ignore these events.  this keeps the UI from flashing and\n            // swishing and whatevering.\n            if (this._jsPlumb && !this._jsPlumb.instance.currentlyDragging && !this._jsPlumb.instance.isHoverSuspended()) {\n\n                this._jsPlumb.hover = hover;\n                var method = hover ? \"addClass\" : \"removeClass\";\n\n                if (this.canvas != null) {\n                    if (this._jsPlumb.instance.hoverClass != null) {\n                        this._jsPlumb.instance[method](this.canvas, this._jsPlumb.instance.hoverClass);\n                    }\n                    if (this._jsPlumb.hoverClass != null) {\n                        this._jsPlumb.instance[method](this.canvas, this._jsPlumb.hoverClass);\n                    }\n                }\n                if (this._jsPlumb.hoverPaintStyle != null) {\n                    this._jsPlumb.paintStyleInUse = hover ? this._jsPlumb.hoverPaintStyle : this._jsPlumb.paintStyle;\n                    if (!this._jsPlumb.instance.isSuspendDrawing()) {\n                        timestamp = timestamp || _timestamp();\n                        this.repaint({timestamp: timestamp, recalc: false});\n                    }\n                }\n                // get the list of other affected elements, if supported by this component.\n                // for a connection, its the endpoints.  for an endpoint, its the connections! surprise.\n                if (this.getAttachedElements && !ignoreAttachedElements) {\n                    _updateAttachedElements(this, hover, _timestamp(), this);\n                }\n            }\n        }\n    });\n\n// ------------------------------ END jsPlumbUIComponent --------------------------------------------\n\n    var _jsPlumbInstanceIndex = 0,\n        getInstanceIndex = function () {\n            var i = _jsPlumbInstanceIndex + 1;\n            _jsPlumbInstanceIndex++;\n            return i;\n        };\n\n    var jsPlumbInstance = root.jsPlumbInstance = function (_defaults) {\n\n        this.version = \"2.14.2\";\n\n        this.Defaults = {\n            Anchor: \"Bottom\",\n            Anchors: [ null, null ],\n            ConnectionsDetachable: true,\n            ConnectionOverlays: [ ],\n            Connector: \"Bezier\",\n            Container: null,\n            DoNotThrowErrors: false,\n            DragOptions: { },\n            DropOptions: { },\n            Endpoint: \"Dot\",\n            EndpointOverlays: [ ],\n            Endpoints: [ null, null ],\n            EndpointStyle: { fill: \"#456\" },\n            EndpointStyles: [ null, null ],\n            EndpointHoverStyle: null,\n            EndpointHoverStyles: [ null, null ],\n            HoverPaintStyle: null,\n            LabelStyle: { color: \"black\" },\n            ListStyle: { },\n            LogEnabled: false,\n            Overlays: [ ],\n            MaxConnections: 1,\n            PaintStyle: { \"stroke-width\": 4, stroke: \"#456\" },\n            ReattachConnections: false,\n            RenderMode: \"svg\",\n            Scope: \"jsPlumb_DefaultScope\"\n        };\n\n        if (_defaults) {\n            jsPlumb.extend(this.Defaults, _defaults);\n        }\n\n        this.logEnabled = this.Defaults.LogEnabled;\n        this._connectionTypes = {};\n        this._endpointTypes = {};\n\n        _ju.EventGenerator.apply(this);\n\n        var _currentInstance = this,\n            _instanceIndex = getInstanceIndex(),\n            _bb = _currentInstance.bind,\n            _initialDefaults = {},\n            _zoom = 1,\n            _info = function (el) {\n                if (el == null) {\n                    return null;\n                }\n                else if (el.nodeType === 3 || el.nodeType === 8) {\n                    return { el:el, text:true };\n                }\n                else {\n                    var _el = _currentInstance.getElement(el);\n                    return { el: _el, id: (_ju.isString(el) && _el == null) ? el : _getId(_el) };\n                }\n            };\n\n        this.getInstanceIndex = function () {\n            return _instanceIndex;\n        };\n\n        // CONVERTED\n        this.setZoom = function (z, repaintEverything) {\n            _zoom = z;\n            _currentInstance.fire(\"zoom\", _zoom);\n            if (repaintEverything) {\n                _currentInstance.repaintEverything();\n            }\n            return true;\n        };\n        // CONVERTED\n        this.getZoom = function () {\n            return _zoom;\n        };\n\n        for (var i in this.Defaults) {\n            _initialDefaults[i] = this.Defaults[i];\n        }\n\n        var _container, _containerDelegations = [];\n        this.unbindContainer = function() {\n            if (_container != null && _containerDelegations.length > 0) {\n                for (var i = 0; i < _containerDelegations.length; i++) {\n                    _currentInstance.off(_container, _containerDelegations[i][0], _containerDelegations[i][1]);\n                }\n            }\n        };\n        this.setContainer = function (c) {\n\n            this.unbindContainer();\n\n            // get container as dom element.\n            c = this.getElement(c);\n            // move existing connections and endpoints, if any.\n            this.select().each(function (conn) {\n                conn.moveParent(c);\n            });\n            this.selectEndpoints().each(function (ep) {\n                ep.moveParent(c);\n            });\n\n            // set container.\n            var previousContainer = _container;\n            _container = c;\n            _containerDelegations.length = 0;\n            var eventAliases = {\n                \"endpointclick\":\"endpointClick\",\n                \"endpointdblclick\":\"endpointDblClick\"\n            };\n\n            var _oneDelegateHandler = function (id, e, componentType) {\n                var t = e.srcElement || e.target,\n                    jp = (t && t.parentNode ? t.parentNode._jsPlumb : null) || (t ? t._jsPlumb : null) || (t && t.parentNode && t.parentNode.parentNode ? t.parentNode.parentNode._jsPlumb : null);\n                if (jp) {\n                    jp.fire(id, jp, e);\n                    var alias = componentType ? eventAliases[componentType + id] || id : id;\n                    // jsplumb also fires every event coming from components/overlays. That's what the test for `jp.component` is for.\n                    _currentInstance.fire(alias, jp.component || jp, e);\n                }\n            };\n\n            var _addOneDelegate = function(eventId, selector, fn) {\n                _containerDelegations.push([eventId, fn]);\n                _currentInstance.on(_container, eventId, selector, fn);\n            };\n\n            // delegate one event on the container to jsplumb elements. it might be possible to\n            // abstract this out: each of endpoint, connection and overlay could register themselves with\n            // jsplumb as \"component types\" or whatever, and provide a suitable selector. this would be\n            // done by the renderer (although admittedly from 2.0 onwards we're not supporting vml anymore)\n            var _oneDelegate = function (id) {\n                // connections.\n                _addOneDelegate(id, \".jtk-connector\", function (e) {\n                    _oneDelegateHandler(id, e);\n                });\n                // endpoints. note they can have an enclosing div, or not.\n                _addOneDelegate(id, \".jtk-endpoint\", function (e) {\n                    _oneDelegateHandler(id, e, \"endpoint\");\n                });\n                // overlays\n                _addOneDelegate(id, \".jtk-overlay\", function (e) {\n                    _oneDelegateHandler(id, e);\n                });\n            };\n\n            for (var i = 0; i < events.length; i++) {\n                _oneDelegate(events[i]);\n            }\n\n            // managed elements\n            for (var elId in managedElements) {\n                var el = managedElements[elId].el;\n                if (el.parentNode === previousContainer) {\n                    previousContainer.removeChild(el);\n                    _container.appendChild(el);\n                }\n            }\n\n        };\n        this.getContainer = function () {\n            return _container;\n        };\n\n        this.bind = function (event, fn) {\n            if (\"ready\" === event && initialized) {\n                fn();\n            }\n            else {\n                _bb.apply(_currentInstance, [event, fn]);\n            }\n        };\n\n        _currentInstance.importDefaults = function (d) {\n            for (var i in d) {\n                _currentInstance.Defaults[i] = d[i];\n            }\n            if (d.Container) {\n                _currentInstance.setContainer(d.Container);\n            }\n\n            return _currentInstance;\n        };\n\n        _currentInstance.restoreDefaults = function () {\n            _currentInstance.Defaults = jsPlumb.extend({}, _initialDefaults);\n            return _currentInstance;\n        };\n\n        var log = null,\n            initialized = false,\n            // TODO remove from window scope\n            connections = [],\n            // map of element id -> endpoint lists. an element can have an arbitrary\n            // number of endpoints on it, and not all of them have to be connected\n            // to anything.\n            endpointsByElement = {},\n            endpointsByUUID = {},\n            managedElements = {},\n            offsets = {},\n            offsetTimestamps = {},\n            draggableStates = {},\n            connectionBeingDragged = false,\n            sizes = [],\n            _suspendDrawing = false,\n            _suspendedAt = null,\n            DEFAULT_SCOPE = this.Defaults.Scope,\n            _curIdStamp = 1,\n            _idstamp = function () {\n                return \"\" + _curIdStamp++;\n            },\n\n            //\n            // appends an element to some other element, which is calculated as follows:\n            //\n            // 1. if Container exists, use that element.\n            // 2. if the 'parent' parameter exists, use that.\n            // 3. otherwise just use the root element.\n            //\n            //\n            _appendElement = function (el, parent) {\n                if (_container) {\n                    _container.appendChild(el);\n                }\n                else if (!parent) {\n                    this.appendToRoot(el);\n                }\n                else {\n                    this.getElement(parent).appendChild(el);\n                }\n            }.bind(this),\n\n            //\n            // Draws an endpoint and its connections. this is the main entry point into drawing connections as well\n            // as endpoints, since jsPlumb is endpoint-centric under the hood.\n            //\n            // @param element element to draw (of type library specific element object)\n            // @param ui UI object from current library's event system. optional.\n            // @param timestamp timestamp for this paint cycle. used to speed things up a little by cutting down the amount of offset calculations we do.\n            // @param clearEdits defaults to false; indicates that mouse edits for connectors should be cleared\n            ///\n            _draw = function (element, ui, timestamp, clearEdits) {\n\n                if (!_suspendDrawing) {\n\n                    element = _currentInstance.getElement(element);\n\n                    if (element != null) {\n\n                        var id = _getId(element),\n                            repaintEls = element.querySelectorAll(\".jtk-managed\");\n\n                        if (timestamp == null) {\n                            timestamp = _timestamp();\n                        }\n\n                        // update the offset of everything _before_ we try to draw anything.\n                        var o = _updateOffset({elId: id, offset: ui, recalc: false, timestamp: timestamp});\n\n                        for (var i = 0; i < repaintEls.length; i++) {\n                            _updateOffset({\n                                elId: repaintEls[i].getAttribute(\"id\"),\n                                // offset: {\n                                //     left: o.o.left + repaintEls[i].offset.left,\n                                //     top: o.o.top + repaintEls[i].offset.top\n                                // },\n                                recalc: true,\n                                timestamp: timestamp\n                            });\n                        }\n\n                        _currentInstance.anchorManager.redraw(id, ui, timestamp, null, clearEdits);\n\n                        if (repaintEls) {\n                            for (var j = 0; j < repaintEls.length; j++) {\n                                _currentInstance.anchorManager.redraw(repaintEls[j].getAttribute(\"id\"), null, timestamp, null, clearEdits, true);\n                            }\n                        }\n                    }\n                }\n            },\n\n            //\n            // gets an Endpoint by uuid.\n            //\n            _getEndpoint = function (uuid) {\n                return endpointsByUUID[uuid];\n            },\n\n            /**\n             * inits a draggable if it's not already initialised.\n             * TODO: somehow abstract this to the adapter, because the concept of \"draggable\" has no\n             * place on the server.\n             */\n\n\n            _scopeMatch = function (e1, e2) {\n                var s1 = e1.scope.split(/\\s/), s2 = e2.scope.split(/\\s/);\n                for (var i = 0; i < s1.length; i++) {\n                    for (var j = 0; j < s2.length; j++) {\n                        if (s2[j] === s1[i]) {\n                            return true;\n                        }\n                    }\n                }\n\n                return false;\n            },\n\n            _mergeOverrides = function (def, values) {\n                var m = jsPlumb.extend({}, def);\n                for (var i in values) {\n                    if (values[i]) {\n                        m[i] = values[i];\n                    }\n                }\n                return m;\n            },\n\n            /*\n             * prepares a final params object that can be passed to _newConnection, taking into account defaults, events, etc.\n             */\n            _prepareConnectionParams = function (params, referenceParams) {\n                var _p = jsPlumb.extend({ }, params);\n                if (referenceParams) {\n                    jsPlumb.extend(_p, referenceParams);\n                }\n\n                // hotwire endpoints passed as source or target to sourceEndpoint/targetEndpoint, respectively.\n                if (_p.source) {\n                    if (_p.source.endpoint) {\n                        _p.sourceEndpoint = _p.source;\n                    }\n                    else {\n                        _p.source = _currentInstance.getElement(_p.source);\n                    }\n                }\n                if (_p.target) {\n                    if (_p.target.endpoint) {\n                        _p.targetEndpoint = _p.target;\n                    }\n                    else {\n                        _p.target = _currentInstance.getElement(_p.target);\n                    }\n                }\n\n                // test for endpoint uuids to connect\n                if (params.uuids) {\n                    _p.sourceEndpoint = _getEndpoint(params.uuids[0]);\n                    _p.targetEndpoint = _getEndpoint(params.uuids[1]);\n                }\n\n                // now ensure that if we do have Endpoints already, they're not full.\n                // source:\n                if (_p.sourceEndpoint && _p.sourceEndpoint.isFull()) {\n                    _ju.log(_currentInstance, \"could not add connection; source endpoint is full\");\n                    return;\n                }\n\n                // target:\n                if (_p.targetEndpoint && _p.targetEndpoint.isFull()) {\n                    _ju.log(_currentInstance, \"could not add connection; target endpoint is full\");\n                    return;\n                }\n\n                // if source endpoint mandates connection type and nothing specified in our params, use it.\n                if (!_p.type && _p.sourceEndpoint) {\n                    _p.type = _p.sourceEndpoint.connectionType;\n                }\n\n                // copy in any connectorOverlays that were specified on the source endpoint.\n                // it doesnt copy target endpoint overlays.  i'm not sure if we want it to or not.\n                if (_p.sourceEndpoint && _p.sourceEndpoint.connectorOverlays) {\n                    _p.overlays = _p.overlays || [];\n                    for (var i = 0, j = _p.sourceEndpoint.connectorOverlays.length; i < j; i++) {\n                        _p.overlays.push(_p.sourceEndpoint.connectorOverlays[i]);\n                    }\n                }\n\n                // scope\n                if (_p.sourceEndpoint && _p.sourceEndpoint.scope) {\n                    _p.scope = _p.sourceEndpoint.scope;\n                }\n\n                // pointer events\n                if (!_p[\"pointer-events\"] && _p.sourceEndpoint && _p.sourceEndpoint.connectorPointerEvents) {\n                    _p[\"pointer-events\"] = _p.sourceEndpoint.connectorPointerEvents;\n                }\n\n\n                var _addEndpoint = function (el, def, idx) {\n                    var params = _mergeOverrides(def, {\n                        anchor: _p.anchors ? _p.anchors[idx] : _p.anchor,\n                        endpoint: _p.endpoints ? _p.endpoints[idx] : _p.endpoint,\n                        paintStyle: _p.endpointStyles ? _p.endpointStyles[idx] : _p.endpointStyle,\n                        hoverPaintStyle: _p.endpointHoverStyles ? _p.endpointHoverStyles[idx] : _p.endpointHoverStyle\n                    });\n                    return _currentInstance.addEndpoint(el, params);\n                };\n\n                // check for makeSource/makeTarget specs.\n\n                var _oneElementDef = function (type, idx, defs, matchType) {\n                    if (_p[type] && !_p[type].endpoint && !_p[type + \"Endpoint\"] && !_p.newConnection) {\n                        var tid = _getId(_p[type]), tep = defs[tid];\n\n                        tep = tep ? tep[matchType] : null;\n\n                        if (tep) {\n                            // if not enabled, return.\n                            if (!tep.enabled) {\n                                return false;\n                            }\n\n                            var epDef = jsPlumb.extend({}, tep.def);\n                            delete epDef.label;\n\n                            var newEndpoint = tep.endpoint != null && tep.endpoint._jsPlumb ? tep.endpoint : _addEndpoint(_p[type], epDef, idx);\n                            if (newEndpoint.isFull()) {\n                                return false;\n                            }\n                            _p[type + \"Endpoint\"] = newEndpoint;\n                            if (!_p.scope && epDef.scope) {\n                                _p.scope = epDef.scope;\n                            } // provide scope if not already provided and endpoint def has one.\n                            if (tep.uniqueEndpoint) {\n                                if (!tep.endpoint) {\n                                    tep.endpoint = newEndpoint;\n                                    newEndpoint.setDeleteOnEmpty(false);\n                                }\n                                else {\n                                    newEndpoint.finalEndpoint = tep.endpoint;\n                                }\n                            } else {\n                                newEndpoint.setDeleteOnEmpty(true);\n                            }\n\n                            //\n                            // copy in connector overlays if present on the source definition.\n                            //\n                            if (idx === 0 && tep.def.connectorOverlays) {\n                                _p.overlays = _p.overlays || [];\n                                Array.prototype.push.apply(_p.overlays, tep.def.connectorOverlays);\n                            }\n                        }\n                    }\n                };\n\n                if (_oneElementDef(\"source\", 0, this.sourceEndpointDefinitions, _p.type || \"default\") === false) {\n                    return;\n                }\n                if (_oneElementDef(\"target\", 1, this.targetEndpointDefinitions, _p.type || \"default\") === false) {\n                    return;\n                }\n\n                // last, ensure scopes match\n                if (_p.sourceEndpoint && _p.targetEndpoint) {\n                    if (!_scopeMatch(_p.sourceEndpoint, _p.targetEndpoint)) {\n                        _p = null;\n                    }\n                }\n\n                return _p;\n            }.bind(_currentInstance),\n\n            _newConnection = function (params) {\n                var connectionFunc = _currentInstance.Defaults.ConnectionType || _currentInstance.getDefaultConnectionType();\n\n                params._jsPlumb = _currentInstance;\n                params.newConnection = _newConnection;\n                params.newEndpoint = _newEndpoint;\n                params.endpointsByUUID = endpointsByUUID;\n                params.endpointsByElement = endpointsByElement;\n                params.finaliseConnection = _finaliseConnection;\n                params.id = \"con_\" + _idstamp();\n                var con = new connectionFunc(params);\n\n                // if the connection is draggable, then maybe we need to tell the target endpoint to init the\n                // dragging code. it won't run again if it already configured to be draggable.\n                if (con.isDetachable()) {\n                    con.endpoints[0].initDraggable(\"_jsPlumbSource\");\n                    con.endpoints[1].initDraggable(\"_jsPlumbTarget\");\n                }\n\n                return con;\n            },\n\n            //\n            // adds the connection to the backing model, fires an event if necessary and then redraws\n            //\n            _finaliseConnection = _currentInstance.finaliseConnection = function (jpc, params, originalEvent, doInformAnchorManager) {\n                params = params || {};\n                // add to list of connections (by scope).\n                if (!jpc.suspendedEndpoint) {\n                    connections.push(jpc);\n                }\n\n                jpc.pending = null;\n\n                // turn off isTemporarySource on the source endpoint (only viable on first draw)\n                jpc.endpoints[0].isTemporarySource = false;\n\n                // always inform the anchor manager\n                // except that if jpc has a suspended endpoint it's not true to say the\n                // connection is new; it has just (possibly) moved. the question is whether\n                // to make that call here or in the anchor manager.  i think perhaps here.\n                if (doInformAnchorManager !== false) {\n                    _currentInstance.router.newConnection(jpc);\n                }\n\n                // force a paint\n                _draw(jpc.source);\n\n                // fire an event\n                if (!params.doNotFireConnectionEvent && params.fireEvent !== false) {\n\n                    var eventArgs = {\n                        connection: jpc,\n                        source: jpc.source, target: jpc.target,\n                        sourceId: jpc.sourceId, targetId: jpc.targetId,\n                        sourceEndpoint: jpc.endpoints[0], targetEndpoint: jpc.endpoints[1]\n                    };\n\n                    _currentInstance.fire(\"connection\", eventArgs, originalEvent);\n                }\n            },\n\n            /*\n             factory method to prepare a new endpoint.  this should always be used instead of creating Endpoints\n             manually, since this method attaches event listeners and an id.\n             */\n            _newEndpoint = function (params, id) {\n                var endpointFunc = _currentInstance.Defaults.EndpointType || jsPlumb.Endpoint;\n                var _p = jsPlumb.extend({}, params);\n                //delete _p.label; // not supported by endpoint.\n                _p._jsPlumb = _currentInstance;\n                _p.newConnection = _newConnection;\n                _p.newEndpoint = _newEndpoint;\n                _p.endpointsByUUID = endpointsByUUID;\n                _p.endpointsByElement = endpointsByElement;\n                _p.fireDetachEvent = fireDetachEvent;\n                _p.elementId = id || _getId(_p.source);\n                var ep = new endpointFunc(_p);\n                ep.id = \"ep_\" + _idstamp();\n                _manage(_p.elementId, _p.source);\n\n                if (!jsPlumb.headless) {\n                    _currentInstance.getDragManager().endpointAdded(_p.source, id);\n                }\n\n                return ep;\n            },\n\n            /*\n             * performs the given function operation on all the connections found\n             * for the given element id; this means we find all the endpoints for\n             * the given element, and then for each endpoint find the connectors\n             * connected to it. then we pass each connection in to the given\n             * function.\n             */\n            _operation = function (elId, func, endpointFunc) {\n                var endpoints = endpointsByElement[elId];\n                if (endpoints && endpoints.length) {\n                    for (var i = 0, ii = endpoints.length; i < ii; i++) {\n                        for (var j = 0, jj = endpoints[i].connections.length; j < jj; j++) {\n                            var retVal = func(endpoints[i].connections[j]);\n                            // if the function passed in returns true, we exit.\n                            // most functions return false.\n                            if (retVal) {\n                                return;\n                            }\n                        }\n                        if (endpointFunc) {\n                            endpointFunc(endpoints[i]);\n                        }\n                    }\n                }\n            },\n\n            _setDraggable = function (element, draggable) {\n                return jsPlumb.each(element, function (el) {\n                    if (_currentInstance.isDragSupported(el)) {\n                        draggableStates[_currentInstance.getAttribute(el, \"id\")] = draggable;\n                        _currentInstance.setElementDraggable(el, draggable);\n                    }\n                });\n            },\n            /*\n             * private method to do the business of hiding/showing.\n             *\n             * @param el\n             *            either Id of the element in question or a library specific\n             *            object for the element.\n             * @param state\n             *            String specifying a value for the css 'display' property\n             *            ('block' or 'none').\n             */\n            _setVisible = function (el, state, alsoChangeEndpoints) {\n                state = state === \"block\";\n                var endpointFunc = null;\n                if (alsoChangeEndpoints) {\n                    endpointFunc = function (ep) {\n                        ep.setVisible(state, true, true);\n                    };\n                }\n                var info = _info(el);\n                _operation(info.id, function (jpc) {\n                    if (state && alsoChangeEndpoints) {\n                        // this test is necessary because this functionality is new, and i wanted to maintain backwards compatibility.\n                        // this block will only set a connection to be visible if the other endpoint in the connection is also visible.\n                        var oidx = jpc.sourceId === info.id ? 1 : 0;\n                        if (jpc.endpoints[oidx].isVisible()) {\n                            jpc.setVisible(true);\n                        }\n                    }\n                    else { // the default behaviour for show, and what always happens for hide, is to just set the visibility without getting clever.\n                        jpc.setVisible(state);\n                    }\n                }, endpointFunc);\n            },\n            /**\n             * private method to do the business of toggling hiding/showing.\n             */\n            _toggleVisible = function (elId, changeEndpoints) {\n                var endpointFunc = null;\n                if (changeEndpoints) {\n                    endpointFunc = function (ep) {\n                        var state = ep.isVisible();\n                        ep.setVisible(!state);\n                    };\n                }\n                _operation(elId, function (jpc) {\n                    var state = jpc.isVisible();\n                    jpc.setVisible(!state);\n                }, endpointFunc);\n            },\n\n            // TODO comparison performance\n            _getCachedData = function (elId) {\n                var o = offsets[elId];\n                if (!o) {\n                    return _updateOffset({elId: elId});\n                }\n                else {\n                    return {o: o, s: sizes[elId]};\n                }\n            },\n\n            /**\n             * gets an id for the given element, creating and setting one if\n             * necessary.  the id is of the form\n             *\n             *    jsPlumb_<instance index>_<index in instance>\n             *\n             * where \"index in instance\" is a monotonically increasing integer that starts at 0,\n             * for each instance.  this method is used not only to assign ids to elements that do not\n             * have them but also to connections and endpoints.\n             */\n            _getId = function (element, uuid, doNotCreateIfNotFound) {\n                if (_ju.isString(element)) {\n                    return element;\n                }\n                if (element == null) {\n                    return null;\n                }\n                var id = _currentInstance.getAttribute(element, \"id\");\n                if (!id || id === \"undefined\") {\n                    // check if fixed uuid parameter is given\n                    if (arguments.length === 2 && arguments[1] !== undefined) {\n                        id = uuid;\n                    }\n                    else if (arguments.length === 1 || (arguments.length === 3 && !arguments[2])) {\n                        id = \"jsPlumb_\" + _instanceIndex + \"_\" + _idstamp();\n                    }\n\n                    if (!doNotCreateIfNotFound) {\n                        _currentInstance.setAttribute(element, \"id\", id);\n                    }\n                }\n                return id;\n            };\n\n        this.setConnectionBeingDragged = function (v) {\n            connectionBeingDragged = v;\n        };\n        this.isConnectionBeingDragged = function () {\n            return connectionBeingDragged;\n        };\n\n        /**\n         * Returns a map of all the elements this jsPlumbInstance is currently managing.\n         * @returns {Object} Map of [id-> {el, endpoint[], connection, position}] information.\n         */\n        this.getManagedElements = function() {\n            return managedElements;\n        };\n\n        this.connectorClass = \"jtk-connector\";\n        this.connectorOutlineClass = \"jtk-connector-outline\";\n        this.connectedClass = \"jtk-connected\";\n        this.hoverClass = \"jtk-hover\";\n        this.endpointClass = \"jtk-endpoint\";\n        this.endpointConnectedClass = \"jtk-endpoint-connected\";\n        this.endpointFullClass = \"jtk-endpoint-full\";\n        this.endpointDropAllowedClass = \"jtk-endpoint-drop-allowed\";\n        this.endpointDropForbiddenClass = \"jtk-endpoint-drop-forbidden\";\n        this.overlayClass = \"jtk-overlay\";\n        this.draggingClass = \"jtk-dragging\";// CONVERTED\n        this.elementDraggingClass = \"jtk-element-dragging\";// CONVERTED\n        this.sourceElementDraggingClass = \"jtk-source-element-dragging\"; // CONVERTED\n        this.targetElementDraggingClass = \"jtk-target-element-dragging\";// CONVERTED\n        this.endpointAnchorClassPrefix = \"jtk-endpoint-anchor\";\n        this.hoverSourceClass = \"jtk-source-hover\";\n        this.hoverTargetClass = \"jtk-target-hover\";\n        this.dragSelectClass = \"jtk-drag-select\";\n\n        this.Anchors = {};\n        this.Connectors = {  \"svg\": {} };\n        this.Endpoints = { \"svg\": {} };\n        this.Overlays = { \"svg\": {} } ;\n        this.ConnectorRenderers = {};\n        this.SVG = \"svg\";\n\n// --------------------------- jsPlumbInstance public API ---------------------------------------------------------\n\n\n        this.addEndpoint = function (el, params, referenceParams) {\n            referenceParams = referenceParams || {};\n            var p = jsPlumb.extend({}, referenceParams);\n            jsPlumb.extend(p, params);\n            p.endpoint = p.endpoint || _currentInstance.Defaults.Endpoint;\n            p.paintStyle = p.paintStyle || _currentInstance.Defaults.EndpointStyle;\n\n            var results = [],\n                inputs = (_ju.isArray(el) || (el.length != null && !_ju.isString(el))) ? el : [ el ];\n\n            for (var i = 0, j = inputs.length; i < j; i++) {\n                p.source = _currentInstance.getElement(inputs[i]);\n                _ensureContainer(p.source);\n\n                var id = _getId(p.source), e = _newEndpoint(p, id);\n\n                // ensure element is managed. force a recalc if drawing not suspended, to ensure the cached value is fresh\n                var myOffset = _manage(id, p.source, null, !_suspendDrawing).info.o;\n                _ju.addToList(endpointsByElement, id, e);\n\n                if (!_suspendDrawing) {\n                    e.paint({\n                        anchorLoc: e.anchor.compute({ xy: [ myOffset.left, myOffset.top ], wh: sizes[id], element: e, timestamp: _suspendedAt }),\n                        timestamp: _suspendedAt\n                    });\n                }\n\n                results.push(e);\n            }\n\n            return results.length === 1 ? results[0] : results;\n        };\n\n        this.addEndpoints = function (el, endpoints, referenceParams) {\n            var results = [];\n            for (var i = 0, j = endpoints.length; i < j; i++) {\n                var e = _currentInstance.addEndpoint(el, endpoints[i], referenceParams);\n                if (_ju.isArray(e)) {\n                    Array.prototype.push.apply(results, e);\n                }\n                else {\n                    results.push(e);\n                }\n            }\n            return results;\n        };\n\n        this.animate = function (el, properties, options) {\n            if (!this.animationSupported) {\n                return false;\n            }\n\n            options = options || {};\n            var del = _currentInstance.getElement(el),\n                id = _getId(del),\n                stepFunction = jsPlumb.animEvents.step,\n                completeFunction = jsPlumb.animEvents.complete;\n\n            options[stepFunction] = _ju.wrap(options[stepFunction], function () {\n                _currentInstance.revalidate(id);\n            });\n\n            // onComplete repaints, just to make sure everything looks good at the end of the animation.\n            options[completeFunction] = _ju.wrap(options[completeFunction], function () {\n                _currentInstance.revalidate(id);\n            });\n\n            _currentInstance.doAnimate(del, properties, options);\n        };\n\n        /**\n         * checks for a listener for the given condition, executing it if found, passing in the given value.\n         * condition listeners would have been attached using \"bind\" (which is, you could argue, now overloaded, since\n         * firing click events etc is a bit different to what this does).  i thought about adding a \"bindCondition\"\n         * or something, but decided against it, for the sake of simplicity. jsPlumb will never fire one of these\n         * condition events anyway.\n         */\n        this.checkCondition = function (conditionName, args) {\n            var l = _currentInstance.getListener(conditionName),\n                r = true;\n\n            if (l && l.length > 0) {\n                var values = Array.prototype.slice.call(arguments, 1);\n                try {\n                    for (var i = 0, j = l.length; i < j; i++) {\n                        r = r && l[i].apply(l[i], values);\n                    }\n                }\n                catch (e) {\n                    _ju.log(_currentInstance, \"cannot check condition [\" + conditionName + \"]\" + e);\n                }\n            }\n            return r;\n        };\n\n        this.connect = function (params, referenceParams) {\n            // prepare a final set of parameters to create connection with\n            var _p = _prepareConnectionParams(params, referenceParams), jpc;\n            // TODO probably a nicer return value if the connection was not made.  _prepareConnectionParams\n            // will return null (and log something) if either endpoint was full.  what would be nicer is to\n            // create a dedicated 'error' object.\n            if (_p) {\n                if (_p.source == null && _p.sourceEndpoint == null) {\n                    _ju.log(\"Cannot establish connection - source does not exist\");\n                    return;\n                }\n                if (_p.target == null && _p.targetEndpoint == null) {\n                    _ju.log(\"Cannot establish connection - target does not exist\");\n                    return;\n                }\n                _ensureContainer(_p.source);\n                // create the connection.  it is not yet registered\n                jpc = _newConnection(_p);\n                // now add it the model, fire an event, and redraw\n                _finaliseConnection(jpc, _p);\n            }\n            return jpc;\n        };\n\n        var stTypes = [\n            { el: \"source\", elId: \"sourceId\", epDefs: \"sourceEndpointDefinitions\" },\n            { el: \"target\", elId: \"targetId\", epDefs: \"targetEndpointDefinitions\" }\n        ];\n\n        var _set = function (c, el, idx, doNotRepaint) {\n            var ep, _st = stTypes[idx], cId = c[_st.elId], cEl = c[_st.el], sid, sep,\n                oldEndpoint = c.endpoints[idx];\n\n            var evtParams = {\n                index: idx,\n                originalSourceId: idx === 0 ? cId : c.sourceId,\n                newSourceId: c.sourceId,\n                originalTargetId: idx === 1 ? cId : c.targetId,\n                newTargetId: c.targetId,\n                connection: c\n            };\n\n            if (el.constructor === jsPlumb.Endpoint) {\n                ep = el;\n                ep.addConnection(c);\n                el = ep.element;\n            }\n            else {\n                sid = _getId(el);\n                sep = this[_st.epDefs][sid];\n\n                if (sid === c[_st.elId]) {\n                    ep = null; // dont change source/target if the element is already the one given.\n                }\n                else if (sep) {\n                    for (var t in sep) {\n                        if (!sep[t].enabled) {\n                            return;\n                        }\n                        ep = sep[t].endpoint != null && sep[t].endpoint._jsPlumb ? sep[t].endpoint : this.addEndpoint(el, sep[t].def);\n                        if (sep[t].uniqueEndpoint) {\n                            sep[t].endpoint = ep;\n                        }\n                        ep.addConnection(c);\n                    }\n                }\n                else {\n                    ep = c.makeEndpoint(idx === 0, el, sid);\n                }\n            }\n\n            if (ep != null) {\n                oldEndpoint.detachFromConnection(c);\n                c.endpoints[idx] = ep;\n                c[_st.el] = ep.element;\n                c[_st.elId] = ep.elementId;\n                evtParams[idx === 0 ? \"newSourceId\" : \"newTargetId\"] = ep.elementId;\n\n                fireMoveEvent(evtParams);\n\n                if (!doNotRepaint) {\n                    c.repaint();\n                }\n            }\n\n            evtParams.element = el;\n            return evtParams;\n\n        }.bind(this);\n\n        this.setSource = function (connection, el, doNotRepaint) {\n            var p = _set(connection, el, 0, doNotRepaint);\n            this.router.sourceOrTargetChanged(p.originalSourceId, p.newSourceId, connection, p.el, 0);\n        };\n        this.setTarget = function (connection, el, doNotRepaint) {\n            var p = _set(connection, el, 1, doNotRepaint);\n            this.router.sourceOrTargetChanged(p.originalTargetId, p.newTargetId, connection, p.el, 1);\n        };\n\n        this.deleteEndpoint = function (object, dontUpdateHover, deleteAttachedObjects) {\n            var endpoint = (typeof object === \"string\") ? endpointsByUUID[object] : object;\n            if (endpoint) {\n                _currentInstance.deleteObject({ endpoint: endpoint, dontUpdateHover: dontUpdateHover, deleteAttachedObjects:deleteAttachedObjects });\n            }\n            return _currentInstance;\n        };\n\n        this.deleteEveryEndpoint = function () {\n            var _is = _currentInstance.setSuspendDrawing(true);\n            for (var id in endpointsByElement) {\n                var endpoints = endpointsByElement[id];\n                if (endpoints && endpoints.length) {\n                    for (var i = 0, j = endpoints.length; i < j; i++) {\n                        _currentInstance.deleteEndpoint(endpoints[i], true);\n                    }\n                }\n            }\n            endpointsByElement = {};\n            managedElements = {};\n            endpointsByUUID = {};\n            offsets = {};\n            offsetTimestamps = {};\n            _currentInstance.router.reset();\n            var dm = _currentInstance.getDragManager();\n            if (dm) {\n                dm.reset();\n            }\n            if (!_is) {\n                _currentInstance.setSuspendDrawing(false);\n            }\n            return _currentInstance;\n        };\n\n        var fireDetachEvent = function (jpc, doFireEvent, originalEvent) {\n            // may have been given a connection, or in special cases, an object\n            var connType = _currentInstance.Defaults.ConnectionType || _currentInstance.getDefaultConnectionType(),\n                argIsConnection = jpc.constructor === connType,\n                params = argIsConnection ? {\n                    connection: jpc,\n                    source: jpc.source, target: jpc.target,\n                    sourceId: jpc.sourceId, targetId: jpc.targetId,\n                    sourceEndpoint: jpc.endpoints[0], targetEndpoint: jpc.endpoints[1]\n                } : jpc;\n\n            if (doFireEvent) {\n                _currentInstance.fire(\"connectionDetached\", params, originalEvent);\n            }\n\n            // always fire this. used by internal jsplumb stuff.\n            _currentInstance.fire(\"internal.connectionDetached\", params, originalEvent);\n\n            _currentInstance.router.connectionDetached(params);\n        };\n\n        var fireMoveEvent = _currentInstance.fireMoveEvent = function (params, evt) {\n            _currentInstance.fire(\"connectionMoved\", params, evt);\n        };\n\n        this.unregisterEndpoint = function (endpoint) {\n            if (endpoint._jsPlumb.uuid) {\n                endpointsByUUID[endpoint._jsPlumb.uuid] = null;\n            }\n            _currentInstance.anchorManager.deleteEndpoint(endpoint);\n            // TODO at least replace this with a removeWithFunction call.\n            for (var e in endpointsByElement) {\n                var endpoints = endpointsByElement[e];\n                if (endpoints) {\n                    var newEndpoints = [];\n                    for (var i = 0, j = endpoints.length; i < j; i++) {\n                        if (endpoints[i] !== endpoint) {\n                            newEndpoints.push(endpoints[i]);\n                        }\n                    }\n\n                    endpointsByElement[e] = newEndpoints;\n                }\n                if (endpointsByElement[e].length < 1) {\n                    delete endpointsByElement[e];\n                }\n            }\n        };\n\n        var IS_DETACH_ALLOWED = \"isDetachAllowed\";\n        var BEFORE_DETACH = \"beforeDetach\";\n        var CHECK_CONDITION = \"checkCondition\";\n\n        /**\n         * Deletes a Connection.\n         * @method deleteConnection\n         * @param connection Connection to delete\n         * @param {Object} [params] Optional delete parameters\n         * @param {Boolean} [params.fireEvent=true] If false, a connection detached event will not be fired. Otherwise one will.\n         * @param {Boolean} [params.force=false] If true, the connection will be deleted even if a beforeDetach interceptor tries to stop the deletion.\n         * @returns {Boolean} True if the connection was deleted, false otherwise.\n         */\n        this.deleteConnection = function(connection, params) {\n\n            if (connection != null) {\n                params = params || {};\n\n                if (params.force || _ju.functionChain(true, false, [\n                        [ connection.endpoints[0], IS_DETACH_ALLOWED, [ connection ] ],\n                        [ connection.endpoints[1], IS_DETACH_ALLOWED, [ connection ] ],\n                        [ connection, IS_DETACH_ALLOWED, [ connection ] ],\n                        [ _currentInstance, CHECK_CONDITION, [ BEFORE_DETACH, connection ] ]\n                    ])) {\n\n                    connection.setHover(false);\n                    fireDetachEvent(connection, !connection.pending && params.fireEvent !== false, params.originalEvent);\n\n                    connection.endpoints[0].detachFromConnection(connection);\n                    connection.endpoints[1].detachFromConnection(connection);\n                    _ju.removeWithFunction(connections, function (_c) {\n                        return connection.id === _c.id;\n                    });\n\n                    connection.cleanup();\n                    connection.destroy();\n                    return true;\n                }\n            }\n            return false;\n        };\n\n        /**\n         * Remove all Connections from all elements, but leaves Endpoints in place ((unless a connection is set to auto delete its Endpoints).\n         * @method deleteEveryConnection\n         * @param {Object} [params] optional params object for the call\n         * @param {Boolean} [params.fireEvent=true] Whether or not to fire detach events\n         * @param {Boolean} [params.forceDetach=false] If true, this call will ignore any `beforeDetach` interceptors.\n         * @returns {Number} The number of connections that were deleted.\n         */\n        this.deleteEveryConnection = function (params) {\n            params = params || {};\n            var count = connections.length, deletedCount = 0;\n            _currentInstance.batch(function () {\n                for (var i = 0; i < count; i++) {\n                    deletedCount += _currentInstance.deleteConnection(connections[0], params) ? 1 : 0;\n                }\n            });\n            return deletedCount;\n        };\n\n        /**\n         * Removes all an element's Connections.\n         * @method deleteConnectionsForElement\n         * @param {Object} el Either the id of the element, or a selector for the element.\n         * @param {Object} [params] Optional parameters.\n         * @param {Boolean} [params.fireEvent=true] Whether or not to fire the detach event.\n         * @param {Boolean} [params.forceDetach=false] If true, this call will ignore any `beforeDetach` interceptors.\n         * @return {jsPlumbInstance} The current jsPlumb instance.\n         */\n        this.deleteConnectionsForElement = function (el, params) {\n            params = params || {};\n            el = _currentInstance.getElement(el);\n            var id = _getId(el), endpoints = endpointsByElement[id];\n            if (endpoints && endpoints.length) {\n                for (var i = 0, j = endpoints.length; i < j; i++) {\n                    endpoints[i].deleteEveryConnection(params);\n                }\n            }\n            return _currentInstance;\n        };\n\n        /// not public.  but of course its exposed. how to change this.\n        this.deleteObject = function (params) {\n            var result = {\n                    endpoints: {},\n                    connections: {},\n                    endpointCount: 0,\n                    connectionCount: 0\n                },\n                deleteAttachedObjects = params.deleteAttachedObjects !== false;\n\n            var unravelConnection = function (connection) {\n                if (connection != null && result.connections[connection.id] == null) {\n                    if (!params.dontUpdateHover && connection._jsPlumb != null) {\n                        connection.setHover(false);\n                    }\n                    result.connections[connection.id] = connection;\n                    result.connectionCount++;\n                }\n            };\n            var unravelEndpoint = function (endpoint) {\n                if (endpoint != null && result.endpoints[endpoint.id] == null) {\n                    if (!params.dontUpdateHover && endpoint._jsPlumb != null) {\n                        endpoint.setHover(false);\n                    }\n                    result.endpoints[endpoint.id] = endpoint;\n                    result.endpointCount++;\n\n                    if (deleteAttachedObjects) {\n                        for (var i = 0; i < endpoint.connections.length; i++) {\n                            var c = endpoint.connections[i];\n                            unravelConnection(c);\n                        }\n                    }\n                }\n            };\n\n            if (params.connection) {\n                unravelConnection(params.connection);\n            }\n            else {\n                unravelEndpoint(params.endpoint);\n            }\n\n            // loop through connections\n            for (var i in result.connections) {\n                var c = result.connections[i];\n                if (c._jsPlumb) {\n                    _ju.removeWithFunction(connections, function (_c) {\n                        return c.id === _c.id;\n                    });\n\n                    fireDetachEvent(c, params.fireEvent === false ? false : !c.pending, params.originalEvent);\n                    var doNotCleanup = params.deleteAttachedObjects == null ? null : !params.deleteAttachedObjects;\n\n                    c.endpoints[0].detachFromConnection(c, null, doNotCleanup);\n                    c.endpoints[1].detachFromConnection(c, null, doNotCleanup);\n\n                    c.cleanup(true);\n                    c.destroy(true);\n                }\n            }\n\n            // loop through endpoints\n            for (var j in result.endpoints) {\n                var e = result.endpoints[j];\n                if (e._jsPlumb) {\n                    _currentInstance.unregisterEndpoint(e);\n                    // FIRE some endpoint deleted event?\n                    e.cleanup(true);\n                    e.destroy(true);\n                }\n            }\n\n            return result;\n        };\n\n\n        // helpers for select/selectEndpoints\n        var _setOperation = function (list, func, args, selector) {\n                for (var i = 0, j = list.length; i < j; i++) {\n                    list[i][func].apply(list[i], args);\n                }\n                return selector(list);\n            },\n            _getOperation = function (list, func, args) {\n                var out = [];\n                for (var i = 0, j = list.length; i < j; i++) {\n                    out.push([ list[i][func].apply(list[i], args), list[i] ]);\n                }\n                return out;\n            },\n            setter = function (list, func, selector) {\n                return function () {\n                    return _setOperation(list, func, arguments, selector);\n                };\n            },\n            getter = function (list, func) {\n                return function () {\n                    return _getOperation(list, func, arguments);\n                };\n            },\n            prepareList = function (input, doNotGetIds) {\n                var r = [];\n                if (input) {\n                    if (typeof input === 'string') {\n                        if (input === \"*\") {\n                            return input;\n                        }\n                        r.push(input);\n                    }\n                    else {\n                        if (doNotGetIds) {\n                            r = input;\n                        }\n                        else {\n                            if (input.length) {\n                                for (var i = 0, j = input.length; i < j; i++) {\n                                    r.push(_info(input[i]).id);\n                                }\n                            }\n                            else {\n                                r.push(_info(input).id);\n                            }\n                        }\n                    }\n                }\n                return r;\n            },\n            filterList = function (list, value, missingIsFalse) {\n                if (list === \"*\") {\n                    return true;\n                }\n                return list.length > 0 ? list.indexOf(value) !== -1 : !missingIsFalse;\n            };\n\n        // get some connections, specifying source/target/scope\n        this.getConnections = function (options, flat) {\n            if (!options) {\n                options = {};\n            } else if (options.constructor === String) {\n                options = { \"scope\": options };\n            }\n            var scope = options.scope || _currentInstance.getDefaultScope(),\n                scopes = prepareList(scope, true),\n                sources = prepareList(options.source),\n                targets = prepareList(options.target),\n                results = (!flat && scopes.length > 1) ? {} : [],\n                _addOne = function (scope, obj) {\n                    if (!flat && scopes.length > 1) {\n                        var ss = results[scope];\n                        if (ss == null) {\n                            ss = results[scope] = [];\n                        }\n                        ss.push(obj);\n                    } else {\n                        results.push(obj);\n                    }\n                };\n\n            for (var j = 0, jj = connections.length; j < jj; j++) {\n                var c = connections[j],\n                    sourceId = c.proxies && c.proxies[0] ? c.proxies[0].originalEp.elementId : c.sourceId,\n                    targetId = c.proxies && c.proxies[1] ? c.proxies[1].originalEp.elementId : c.targetId;\n\n                if (filterList(scopes, c.scope) && filterList(sources, sourceId) && filterList(targets, targetId)) {\n                    _addOne(c.scope, c);\n                }\n            }\n\n            return results;\n        };\n\n        var _curryEach = function (list, executor) {\n                return function (f) {\n                    for (var i = 0, ii = list.length; i < ii; i++) {\n                        f(list[i]);\n                    }\n                    return executor(list);\n                };\n            },\n            _curryGet = function (list) {\n                return function (idx) {\n                    return list[idx];\n                };\n            };\n\n        var _makeCommonSelectHandler = function (list, executor) {\n            var out = {\n                    length: list.length,\n                    each: _curryEach(list, executor),\n                    get: _curryGet(list)\n                },\n                setters = [\"setHover\", \"removeAllOverlays\", \"setLabel\", \"addClass\", \"addOverlay\", \"removeOverlay\",\n                    \"removeOverlays\", \"showOverlay\", \"hideOverlay\", \"showOverlays\", \"hideOverlays\", \"setPaintStyle\",\n                    \"setHoverPaintStyle\", \"setSuspendEvents\", \"setParameter\", \"setParameters\", \"setVisible\",\n                    \"repaint\", \"addType\", \"toggleType\", \"removeType\", \"removeClass\", \"setType\", \"bind\", \"unbind\" ],\n\n                getters = [\"getLabel\", \"getOverlay\", \"isHover\", \"getParameter\", \"getParameters\", \"getPaintStyle\",\n                    \"getHoverPaintStyle\", \"isVisible\", \"hasType\", \"getType\", \"isSuspendEvents\" ],\n                i, ii;\n\n            for (i = 0, ii = setters.length; i < ii; i++) {\n                out[setters[i]] = setter(list, setters[i], executor);\n            }\n\n            for (i = 0, ii = getters.length; i < ii; i++) {\n                out[getters[i]] = getter(list, getters[i]);\n            }\n\n            return out;\n        };\n\n        var _makeConnectionSelectHandler = function (list) {\n            var common = _makeCommonSelectHandler(list, _makeConnectionSelectHandler);\n            return jsPlumb.extend(common, {\n                // setters\n                setDetachable: setter(list, \"setDetachable\", _makeConnectionSelectHandler),\n                setReattach: setter(list, \"setReattach\", _makeConnectionSelectHandler),\n                setConnector: setter(list, \"setConnector\", _makeConnectionSelectHandler),\n                delete: function () {\n                    for (var i = 0, ii = list.length; i < ii; i++) {\n                        _currentInstance.deleteConnection(list[i]);\n                    }\n                },\n                // getters\n                isDetachable: getter(list, \"isDetachable\"),\n                isReattach: getter(list, \"isReattach\")\n            });\n        };\n\n        var _makeEndpointSelectHandler = function (list) {\n            var common = _makeCommonSelectHandler(list, _makeEndpointSelectHandler);\n            return jsPlumb.extend(common, {\n                setEnabled: setter(list, \"setEnabled\", _makeEndpointSelectHandler),\n                setAnchor: setter(list, \"setAnchor\", _makeEndpointSelectHandler),\n                isEnabled: getter(list, \"isEnabled\"),\n                deleteEveryConnection: function () {\n                    for (var i = 0, ii = list.length; i < ii; i++) {\n                        list[i].deleteEveryConnection();\n                    }\n                },\n                \"delete\": function () {\n                    for (var i = 0, ii = list.length; i < ii; i++) {\n                        _currentInstance.deleteEndpoint(list[i]);\n                    }\n                }\n            });\n        };\n\n        this.select = function (params) {\n            params = params || {};\n            params.scope = params.scope || \"*\";\n            return _makeConnectionSelectHandler(params.connections || _currentInstance.getConnections(params, true));\n        };\n\n        this.selectEndpoints = function (params) {\n            params = params || {};\n            params.scope = params.scope || \"*\";\n            var noElementFilters = !params.element && !params.source && !params.target,\n                elements = noElementFilters ? \"*\" : prepareList(params.element),\n                sources = noElementFilters ? \"*\" : prepareList(params.source),\n                targets = noElementFilters ? \"*\" : prepareList(params.target),\n                scopes = prepareList(params.scope, true);\n\n            var ep = [];\n\n            for (var el in endpointsByElement) {\n                var either = filterList(elements, el, true),\n                    source = filterList(sources, el, true),\n                    sourceMatchExact = sources !== \"*\",\n                    target = filterList(targets, el, true),\n                    targetMatchExact = targets !== \"*\";\n\n                // if they requested 'either' then just match scope. otherwise if they requested 'source' (not as a wildcard) then we have to match only endpoints that have isSource set to to true, and the same thing with isTarget.\n                if (either || source || target) {\n                    inner:\n                        for (var i = 0, ii = endpointsByElement[el].length; i < ii; i++) {\n                            var _ep = endpointsByElement[el][i];\n                            if (filterList(scopes, _ep.scope, true)) {\n\n                                var noMatchSource = (sourceMatchExact && sources.length > 0 && !_ep.isSource),\n                                    noMatchTarget = (targetMatchExact && targets.length > 0 && !_ep.isTarget);\n\n                                if (noMatchSource || noMatchTarget) {\n                                    continue inner;\n                                }\n\n                                ep.push(_ep);\n                            }\n                        }\n                }\n            }\n\n            return _makeEndpointSelectHandler(ep);\n        };\n\n        // get all connections managed by the instance of jsplumb.\n        this.getAllConnections = function () {\n            return connections;\n        };\n        this.getDefaultScope = function () {\n            return DEFAULT_SCOPE;\n        };\n        // get an endpoint by uuid.\n        this.getEndpoint = _getEndpoint;\n        /**\n         * Gets the list of Endpoints for a given element.\n         * @method getEndpoints\n         * @param {String|Element|Selector} el The element to get endpoints for.\n         * @return {Endpoint[]} An array of Endpoints for the specified element.\n         */\n        this.getEndpoints = function (el) {\n            return endpointsByElement[_info(el).id] || [];\n        };\n        // gets the default endpoint type. used when subclassing. see wiki.\n        this.getDefaultEndpointType = function () {\n            return jsPlumb.Endpoint;\n        };\n        // gets the default connection type. used when subclassing.  see wiki.\n        this.getDefaultConnectionType = function () {\n            return jsPlumb.Connection;\n        };\n        /*\n         * Gets an element's id, creating one if necessary. really only exposed\n         * for the lib-specific functionality to access; would be better to pass\n         * the current instance into the lib-specific code (even though this is\n         * a static call. i just don't want to expose it to the public API).\n         */\n        this.getId = _getId;\n        this.draw = _draw;\n        this.info = _info;\n\n        this.appendElement = _appendElement;\n\n        var _hoverSuspended = false;\n        this.isHoverSuspended = function () {\n            return _hoverSuspended;\n        };\n        this.setHoverSuspended = function (s) {\n            _hoverSuspended = s;\n        };\n\n        // set an element's connections to be hidden\n        this.hide = function (el, changeEndpoints) {\n            _setVisible(el, \"none\", changeEndpoints);\n            return _currentInstance;\n        };\n\n        // exposed for other objects to use to get a unique id.\n        this.idstamp = _idstamp;\n\n        // ensure that, if the current container exists, it is a DOM element and not a selector.\n        // if it does not exist and `candidate` is supplied, the offset parent of that element will be set as the Container.\n        // this is used to do a better default behaviour for the case that the user has not set a container:\n        // addEndpoint, makeSource, makeTarget and connect all call this method with the offsetParent of the\n        // element in question (for connect it is the source element). So if no container is set, it is inferred\n        // to be the offsetParent of the first element the user tries to connect.\n        var _ensureContainer = function (candidate) {\n            if (!_container && candidate) {\n                var can = _currentInstance.getElement(candidate);\n                if (can.offsetParent) {\n                    _currentInstance.setContainer(can.offsetParent);\n                }\n            }\n        };\n\n        var _getContainerFromDefaults = function () {\n            if (_currentInstance.Defaults.Container) {\n                _currentInstance.setContainer(_currentInstance.Defaults.Container);\n            }\n        };\n\n        // check if a given element is managed or not. if not, add to our map. if drawing is not suspended then\n        // we'll also stash its dimensions; otherwise we'll do this in a lazy way through updateOffset.\n        var _manage = _currentInstance.manage = function (id, element, _transient, _recalc) {\n            if (!managedElements[id]) {\n                managedElements[id] = {\n                    el: element,\n                    endpoints: [],\n                    connections: []\n                };\n\n                managedElements[id].info = _updateOffset({ elId: id, timestamp: _suspendedAt });\n                _currentInstance.addClass(element, \"jtk-managed\");\n\n                if (!_transient) {\n                    _currentInstance.fire(\"manageElement\", { id:id, info:managedElements[id].info, el:element });\n                }\n            } else {\n                if (_recalc) {\n                    managedElements[id].info = _updateOffset({ elId: id, timestamp: _suspendedAt, recalc:true });\n                }\n            }\n\n            return managedElements[id];\n        };\n\n        var _unmanage = _currentInstance.unmanage = function(id) {\n            if (managedElements[id]) {\n                var el = managedElements[id].el;\n               _currentInstance.removeClass(el, \"jtk-managed\");\n                delete managedElements[id];\n                _currentInstance.fire(\"unmanageElement\", {id:id, el:el});\n            }\n        };\n\n        /**\n         * updates the offset and size for a given element, and stores the\n         * values. if 'offset' is not null we use that (it would have been\n         * passed in from a drag call) because it's faster; but if it is null,\n         * or if 'recalc' is true in order to force a recalculation, we get the current values.\n         * @method updateOffset\n         */\n        var _updateOffset = function (params) {\n\n            var timestamp = params.timestamp, recalc = params.recalc, offset = params.offset, elId = params.elId, s;\n            if (_suspendDrawing && !timestamp) {\n                timestamp = _suspendedAt;\n            }\n            if (!recalc) {\n                if (timestamp && timestamp === offsetTimestamps[elId]) {\n                    return {o: params.offset || offsets[elId], s: sizes[elId]};\n                }\n            }\n            if (recalc || (!offset && offsets[elId] == null)) { // if forced repaint or no offset available, we recalculate.\n\n                // get the current size and offset, and store them\n                s = managedElements[elId] ? managedElements[elId].el : null;\n                if (s != null) {\n                    sizes[elId] = _currentInstance.getSize(s);\n                    offsets[elId] = _currentInstance.getOffset(s);\n                    offsetTimestamps[elId] = timestamp;\n                }\n            } else {\n                offsets[elId] = offset || offsets[elId];\n                if (sizes[elId] == null) {\n                    s = managedElements[elId].el;\n                    if (s != null) {\n                        sizes[elId] = _currentInstance.getSize(s);\n                    }\n                }\n                offsetTimestamps[elId] = timestamp;\n            }\n\n            if (offsets[elId] && !offsets[elId].right) {\n                offsets[elId].right = offsets[elId].left + sizes[elId][0];\n                offsets[elId].bottom = offsets[elId].top + sizes[elId][1];\n                offsets[elId].width = sizes[elId][0];\n                offsets[elId].height = sizes[elId][1];\n                offsets[elId].centerx = offsets[elId].left + (offsets[elId].width / 2);\n                offsets[elId].centery = offsets[elId].top + (offsets[elId].height / 2);\n            }\n\n            return {o: offsets[elId], s: sizes[elId]};\n        };\n\n        this.updateOffset = _updateOffset;\n\n        /**\n         * callback from the current library to tell us to prepare ourselves (attach\n         * mouse listeners etc; can't do that until the library has provided a bind method)\n         */\n        this.init = function () {\n            if (!initialized) {\n                _getContainerFromDefaults();\n                _currentInstance.router = new root.jsPlumb.DefaultRouter(_currentInstance);\n                _currentInstance.anchorManager = _currentInstance.router.anchorManager;\n                initialized = true;\n                _currentInstance.fire(\"ready\", _currentInstance);\n            }\n        }.bind(this);\n\n        this.log = log;\n        this.jsPlumbUIComponent = jsPlumbUIComponent;\n\n        /*\n         * Creates an anchor with the given params.\n         *\n         *\n         * Returns: The newly created Anchor.\n         * Throws: an error if a named anchor was not found.\n         */\n        this.makeAnchor = function () {\n            var pp, _a = function (t, p) {\n                if (root.jsPlumb.Anchors[t]) {\n                    return new root.jsPlumb.Anchors[t](p);\n                }\n                if (!_currentInstance.Defaults.DoNotThrowErrors) {\n                    throw { msg: \"jsPlumb: unknown anchor type '\" + t + \"'\" };\n                }\n            };\n            if (arguments.length === 0) {\n                return null;\n            }\n            var specimen = arguments[0], elementId = arguments[1], jsPlumbInstance = arguments[2], newAnchor = null;\n            // if it appears to be an anchor already...\n            if (specimen.compute && specimen.getOrientation) {\n                return specimen;\n            }  //TODO hazy here about whether it should be added or is already added somehow.\n            // is it the name of an anchor type?\n            else if (typeof specimen === \"string\") {\n                newAnchor = _a(arguments[0], {elementId: elementId, jsPlumbInstance: _currentInstance});\n            }\n            // is it an array? it will be one of:\n            // an array of [spec, params] - this defines a single anchor, which may be dynamic, but has parameters.\n            // an array of arrays - this defines some dynamic anchors\n            // an array of numbers - this defines a single anchor.\n            else if (_ju.isArray(specimen)) {\n                if (_ju.isArray(specimen[0]) || _ju.isString(specimen[0])) {\n                    // if [spec, params] format\n                    if (specimen.length === 2 && _ju.isObject(specimen[1])) {\n                        // if first arg is a string, its a named anchor with params\n                        if (_ju.isString(specimen[0])) {\n                            pp = root.jsPlumb.extend({elementId: elementId, jsPlumbInstance: _currentInstance}, specimen[1]);\n                            newAnchor = _a(specimen[0], pp);\n                        }\n                        // otherwise first arg is array, second is params. we treat as a dynamic anchor, which is fine\n                        // even if the first arg has only one entry. you could argue all anchors should be implicitly dynamic in fact.\n                        else {\n                            pp = root.jsPlumb.extend({elementId: elementId, jsPlumbInstance: _currentInstance, anchors: specimen[0]}, specimen[1]);\n                            newAnchor = new root.jsPlumb.DynamicAnchor(pp);\n                        }\n                    }\n                    else {\n                        newAnchor = new jsPlumb.DynamicAnchor({anchors: specimen, selector: null, elementId: elementId, jsPlumbInstance: _currentInstance});\n                    }\n\n                }\n                else {\n                    var anchorParams = {\n                        x: specimen[0], y: specimen[1],\n                        orientation: (specimen.length >= 4) ? [ specimen[2], specimen[3] ] : [0, 0],\n                        offsets: (specimen.length >= 6) ? [ specimen[4], specimen[5] ] : [ 0, 0 ],\n                        elementId: elementId,\n                        jsPlumbInstance: _currentInstance,\n                        cssClass: specimen.length === 7 ? specimen[6] : null\n                    };\n                    newAnchor = new root.jsPlumb.Anchor(anchorParams);\n                    newAnchor.clone = function () {\n                        return new root.jsPlumb.Anchor(anchorParams);\n                    };\n                }\n            }\n\n            if (!newAnchor.id) {\n                newAnchor.id = \"anchor_\" + _idstamp();\n            }\n            return newAnchor;\n        };\n\n        /**\n         * makes a list of anchors from the given list of types or coords, eg\n         * [\"TopCenter\", \"RightMiddle\", \"BottomCenter\", [0, 1, -1, -1] ]\n         */\n        this.makeAnchors = function (types, elementId, jsPlumbInstance) {\n            var r = [];\n            for (var i = 0, ii = types.length; i < ii; i++) {\n                if (typeof types[i] === \"string\") {\n                    r.push(root.jsPlumb.Anchors[types[i]]({elementId: elementId, jsPlumbInstance: jsPlumbInstance}));\n                }\n                else if (_ju.isArray(types[i])) {\n                    r.push(_currentInstance.makeAnchor(types[i], elementId, jsPlumbInstance));\n                }\n            }\n            return r;\n        };\n\n        /**\n         * Makes a dynamic anchor from the given list of anchors (which may be in shorthand notation as strings or dimension arrays, or Anchor\n         * objects themselves) and the given, optional, anchorSelector function (jsPlumb uses a default if this is not provided; most people will\n         * not need to provide this - i think).\n         */\n        this.makeDynamicAnchor = function (anchors, anchorSelector) {\n            return new root.jsPlumb.DynamicAnchor({anchors: anchors, selector: anchorSelector, elementId: null, jsPlumbInstance: _currentInstance});\n        };\n\n// --------------------- makeSource/makeTarget ----------------------------------------------\n\n        this.targetEndpointDefinitions = {};\n        this.sourceEndpointDefinitions = {};\n\n        var selectorFilter = function (evt, _el, selector, _instance, negate) {\n            var t = evt.target || evt.srcElement, ok = false,\n                sel = _instance.getSelector(_el, selector);\n            for (var j = 0; j < sel.length; j++) {\n                if (sel[j] === t) {\n                    ok = true;\n                    break;\n                }\n            }\n            return negate ? !ok : ok;\n        };\n\n        var _makeElementDropHandler = function (elInfo, p, dropOptions, isSource, isTarget) {\n            var proxyComponent = new jsPlumbUIComponent(p);\n            var _drop = p._jsPlumb.EndpointDropHandler({\n                jsPlumb: _currentInstance,\n                enabled: function () {\n                    return elInfo.def.enabled;\n                },\n                isFull: function () {\n                    var targetCount = _currentInstance.select({target: elInfo.id}).length;\n                    return elInfo.def.maxConnections > 0 && targetCount >= elInfo.def.maxConnections;\n                },\n                element: elInfo.el,\n                elementId: elInfo.id,\n                isSource: isSource,\n                isTarget: isTarget,\n                addClass: function (clazz) {\n                    _currentInstance.addClass(elInfo.el, clazz);\n                },\n                removeClass: function (clazz) {\n                    _currentInstance.removeClass(elInfo.el, clazz);\n                },\n                onDrop: function (jpc) {\n                    var source = jpc.endpoints[0];\n                    source.anchor.unlock();\n                },\n                isDropAllowed: function () {\n                    return proxyComponent.isDropAllowed.apply(proxyComponent, arguments);\n                },\n                isRedrop:function(jpc) {\n                    return (jpc.suspendedElement != null && jpc.suspendedEndpoint != null && jpc.suspendedEndpoint.element === elInfo.el);\n                },\n                getEndpoint: function (jpc) {\n\n                    // make a new Endpoint for the target, or get it from the cache if uniqueEndpoint\n                    // is set. if its a redrop the new endpoint will be immediately cleaned up.\n\n                    var newEndpoint = elInfo.def.endpoint;\n\n                    // if no cached endpoint, or there was one but it has been cleaned up\n                    // (ie. detached), create a new one\n                    if (newEndpoint == null || newEndpoint._jsPlumb == null) {\n                        var eps = _currentInstance.deriveEndpointAndAnchorSpec(jpc.getType().join(\" \"), true);\n                        var pp = eps.endpoints ? root.jsPlumb.extend(p, {\n                            endpoint:elInfo.def.def.endpoint || eps.endpoints[1]\n                        }) :p;\n                        if (eps.anchors) {\n                            pp = root.jsPlumb.extend(pp, {\n                                anchor:elInfo.def.def.anchor || eps.anchors[1]\n                            });\n                        }\n                        newEndpoint = _currentInstance.addEndpoint(elInfo.el, pp);\n                        newEndpoint._mtNew = true;\n                    }\n\n                    if (p.uniqueEndpoint) {\n                        elInfo.def.endpoint = newEndpoint;\n                    }\n\n                    newEndpoint.setDeleteOnEmpty(true);\n\n                    // if connection is detachable, init the new endpoint to be draggable, to support that happening.\n                    if (jpc.isDetachable()) {\n                        newEndpoint.initDraggable();\n                    }\n\n                    // if the anchor has a 'positionFinder' set, then delegate to that function to find\n                    // out where to locate the anchor.\n                    if (newEndpoint.anchor.positionFinder != null) {\n                        var dropPosition = _currentInstance.getUIPosition(arguments, _currentInstance.getZoom()),\n                            elPosition = _currentInstance.getOffset(elInfo.el),\n                            elSize = _currentInstance.getSize(elInfo.el),\n                            ap = dropPosition == null ? [0,0] : newEndpoint.anchor.positionFinder(dropPosition, elPosition, elSize, newEndpoint.anchor.constructorParams);\n\n                        newEndpoint.anchor.x = ap[0];\n                        newEndpoint.anchor.y = ap[1];\n                        // now figure an orientation for it..kind of hard to know what to do actually. probably the best thing i can do is to\n                        // support specifying an orientation in the anchor's spec. if one is not supplied then i will make the orientation\n                        // be what will cause the most natural link to the source: it will be pointing at the source, but it needs to be\n                        // specified in one axis only, and so how to make that choice? i think i will use whichever axis is the one in which\n                        // the target is furthest away from the source.\n                    }\n\n                    return newEndpoint;\n                },\n                maybeCleanup: function (ep) {\n                    if (ep._mtNew && ep.connections.length === 0) {\n                        _currentInstance.deleteObject({endpoint: ep});\n                    }\n                    else {\n                        delete ep._mtNew;\n                    }\n                }\n            });\n\n            // wrap drop events as needed and initialise droppable\n            var dropEvent = root.jsPlumb.dragEvents.drop;\n            dropOptions.scope = dropOptions.scope || (p.scope || _currentInstance.Defaults.Scope);\n            dropOptions[dropEvent] = _ju.wrap(dropOptions[dropEvent], _drop, true);\n            dropOptions.rank = p.rank || 0;\n\n            // if target, return true from the over event. this will cause katavorio to stop setting drops to hover\n            // if multipleDrop is set to false.\n            if (isTarget) {\n                dropOptions[root.jsPlumb.dragEvents.over] = function () { return true; };\n            }\n\n            // vanilla jsplumb only\n            if (p.allowLoopback === false) {\n                dropOptions.canDrop = function (_drag) {\n                    var de = _drag.getDragElement()._jsPlumbRelatedElement;\n                    return de !== elInfo.el;\n                };\n            }\n            _currentInstance.initDroppable(elInfo.el, dropOptions, \"internal\");\n\n            return _drop;\n\n        };\n\n        // see API docs\n        this.makeTarget = function (el, params, referenceParams) {\n\n            // put jsplumb ref into params without altering the params passed in\n            var p = root.jsPlumb.extend({_jsPlumb: this}, referenceParams);\n            root.jsPlumb.extend(p, params);\n\n            var maxConnections = p.maxConnections || -1,\n\n                _doOne = function (el) {\n\n                    // get the element's id and store the endpoint definition for it.  jsPlumb.connect calls will look for one of these,\n                    // and use the endpoint definition if found.\n                    // decode the info for this element (id and element)\n                    var elInfo = _info(el),\n                        elid = elInfo.id,\n                        dropOptions = root.jsPlumb.extend({}, p.dropOptions || {}),\n                        type = p.connectionType || \"default\";\n\n                    this.targetEndpointDefinitions[elid] = this.targetEndpointDefinitions[elid] || {};\n\n                    _ensureContainer(elid);\n\n                    // if this is a group and the user has not mandated a rank, set to -1 so that Nodes takes\n                    // precedence.\n                    if (elInfo.el._isJsPlumbGroup && dropOptions.rank == null) {\n                        dropOptions.rank = -1;\n                    }\n\n                    // store the definition\n                    var _def = {\n                        def: root.jsPlumb.extend({}, p),\n                        uniqueEndpoint: p.uniqueEndpoint,\n                        maxConnections: maxConnections,\n                        enabled: true\n                    };\n\n                    if (p.createEndpoint) {\n                        _def.uniqueEndpoint = true;\n                        _def.endpoint = _currentInstance.addEndpoint(el, _def.def);\n                        _def.endpoint.setDeleteOnEmpty(false);\n                    }\n\n                    elInfo.def = _def;\n                    this.targetEndpointDefinitions[elid][type] = _def;\n                    _makeElementDropHandler(elInfo, p, dropOptions, p.isSource === true, true);\n                    // stash the definition on the drop\n                    elInfo.el._katavorioDrop[elInfo.el._katavorioDrop.length - 1].targetDef = _def;\n\n                }.bind(this);\n\n            // make an array if only given one element\n            var inputs = el.length && el.constructor !== String ? el : [ el ];\n\n            // register each one in the list.\n            for (var i = 0, ii = inputs.length; i < ii; i++) {\n                _doOne(inputs[i]);\n            }\n\n            return this;\n        };\n\n        // see api docs\n        this.unmakeTarget = function (el, doNotClearArrays) {\n            var info = _info(el);\n            _currentInstance.destroyDroppable(info.el, \"internal\");\n            if (!doNotClearArrays) {\n                delete this.targetEndpointDefinitions[info.id];\n            }\n\n            return this;\n        };\n\n        // see api docs\n        this.makeSource = function (el, params, referenceParams) {\n            var p = root.jsPlumb.extend({_jsPlumb: this}, referenceParams);\n            root.jsPlumb.extend(p, params);\n            var type = p.connectionType || \"default\";\n            var aae = _currentInstance.deriveEndpointAndAnchorSpec(type);\n            p.endpoint = p.endpoint || aae.endpoints[0];\n            p.anchor = p.anchor || aae.anchors[0];\n            var maxConnections = p.maxConnections || -1,\n                onMaxConnections = p.onMaxConnections,\n                _doOne = function (elInfo) {\n                    // get the element's id and store the endpoint definition for it.  jsPlumb.connect calls will look for one of these,\n                    // and use the endpoint definition if found.\n                    var elid = elInfo.id,\n                        _del = this.getElement(elInfo.el);\n\n                    this.sourceEndpointDefinitions[elid] = this.sourceEndpointDefinitions[elid] || {};\n                    _ensureContainer(elid);\n\n                    var _def = {\n                        def:root.jsPlumb.extend({}, p),\n                        uniqueEndpoint: p.uniqueEndpoint,\n                        maxConnections: maxConnections,\n                        enabled: true\n                    };\n\n                    if (p.createEndpoint) {\n                        _def.uniqueEndpoint = true;\n                        _def.endpoint = _currentInstance.addEndpoint(el, _def.def);\n                        _def.endpoint.setDeleteOnEmpty(false);\n                    }\n\n                    this.sourceEndpointDefinitions[elid][type] = _def;\n                    elInfo.def = _def;\n\n                    var stopEvent = root.jsPlumb.dragEvents.stop,\n                        dragEvent = root.jsPlumb.dragEvents.drag,\n                        dragOptions = root.jsPlumb.extend({ }, p.dragOptions || {}),\n                        existingDrag = dragOptions.drag,\n                        existingStop = dragOptions.stop,\n                        ep = null,\n                        endpointAddedButNoDragYet = false;\n\n                    // set scope if its not set in dragOptions but was passed in in params\n                    dragOptions.scope = dragOptions.scope || p.scope;\n\n                    dragOptions[dragEvent] = _ju.wrap(dragOptions[dragEvent], function () {\n                        if (existingDrag) {\n                            existingDrag.apply(this, arguments);\n                        }\n                        endpointAddedButNoDragYet = false;\n                    });\n\n                    dragOptions[stopEvent] = _ju.wrap(dragOptions[stopEvent], function () {\n\n                        if (existingStop) {\n                            existingStop.apply(this, arguments);\n                        }\n                        this.currentlyDragging = false;\n                        if (ep._jsPlumb != null) { // if not cleaned up...\n\n                            // reset the anchor to the anchor that was initially provided. the one we were using to drag\n                            // the connection was just a placeholder that was located at the place the user pressed the\n                            // mouse button to initiate the drag.\n                            var anchorDef = p.anchor || this.Defaults.Anchor,\n                                oldAnchor = ep.anchor,\n                                oldConnection = ep.connections[0];\n\n                            var    newAnchor = this.makeAnchor(anchorDef, elid, this),\n                                _el = ep.element;\n\n                            // if the anchor has a 'positionFinder' set, then delegate to that function to find\n                            // out where to locate the anchor. issue 117.\n                            if (newAnchor.positionFinder != null) {\n                                var elPosition = _currentInstance.getOffset(_el),\n                                    elSize = this.getSize(_el),\n                                    dropPosition = { left: elPosition.left + (oldAnchor.x * elSize[0]), top: elPosition.top + (oldAnchor.y * elSize[1]) },\n                                    ap = newAnchor.positionFinder(dropPosition, elPosition, elSize, newAnchor.constructorParams);\n\n                                newAnchor.x = ap[0];\n                                newAnchor.y = ap[1];\n                            }\n\n                            ep.setAnchor(newAnchor, true);\n                            ep.repaint();\n                            this.repaint(ep.elementId);\n                            if (oldConnection != null) {\n                                this.repaint(oldConnection.targetId);\n                            }\n                        }\n                    }.bind(this));\n\n                    // when the user presses the mouse, add an Endpoint, if we are enabled.\n                    var mouseDownListener = function (e) {\n                        // on right mouse button, abort.\n                        if (e.which === 3 || e.button === 2) {\n                            return;\n                        }\n\n                        elid = this.getId(this.getElement(elInfo.el)); // elid might have changed since this method was called to configure the element.\n\n                        // TODO store def on element.\n                        var def = this.sourceEndpointDefinitions[elid][type];\n\n                        // if disabled, return.\n                        if (!def.enabled) {\n                            return;\n                        }\n\n                        // if a filter was given, run it, and return if it says no.\n                        if (p.filter) {\n                            var r = _ju.isString(p.filter) ? selectorFilter(e, elInfo.el, p.filter, this, p.filterExclude) : p.filter(e, elInfo.el);\n                            if (r === false) {\n                                return;\n                            }\n                        }\n\n                        // if maxConnections reached\n                        var sourceCount = this.select({source: elid}).length;\n                        if (def.maxConnections >= 0 && (sourceCount >= def.maxConnections)) {\n                            if (onMaxConnections) {\n                                onMaxConnections({\n                                    element: elInfo.el,\n                                    maxConnections: maxConnections\n                                }, e);\n                            }\n                            return false;\n                        }\n\n                        // find the position on the element at which the mouse was pressed; this is where the endpoint\n                        // will be located.\n                        var elxy = root.jsPlumb.getPositionOnElement(e, _del, _zoom);\n\n                        // we need to override the anchor in here, and force 'isSource', but we don't want to mess with\n                        // the params passed in, because after a connection is established we're going to reset the endpoint\n                        // to have the anchor we were given.\n                        var tempEndpointParams = {};\n                        root.jsPlumb.extend(tempEndpointParams, def.def);\n                        tempEndpointParams.isTemporarySource = true;\n                        tempEndpointParams.anchor = [ elxy[0], elxy[1] , 0, 0];\n                        tempEndpointParams.dragOptions = dragOptions;\n\n                        if (def.def.scope) {\n                            tempEndpointParams.scope = def.def.scope;\n                        }\n\n                        ep = this.addEndpoint(elid, tempEndpointParams);\n                        endpointAddedButNoDragYet = true;\n                        ep.setDeleteOnEmpty(true);\n\n                        // if unique endpoint and it's already been created, push it onto the endpoint we create. at the end\n                        // of a successful connection we'll switch to that endpoint.\n                        // TODO this is the same code as the programmatic endpoints create on line 1050 ish\n                        if (def.uniqueEndpoint) {\n                            if (!def.endpoint) {\n                                def.endpoint = ep;\n                                ep.setDeleteOnEmpty(false);\n                            }\n                            else {\n                                ep.finalEndpoint = def.endpoint;\n                            }\n                        }\n\n                        var _delTempEndpoint = function () {\n                            // this mouseup event is fired only if no dragging occurred, by jquery and yui, but for mootools\n                            // it is fired even if dragging has occurred, in which case we would blow away a perfectly\n                            // legitimate endpoint, were it not for this check.  the flag is set after adding an\n                            // endpoint and cleared in a drag listener we set in the dragOptions above.\n                            _currentInstance.off(ep.canvas, \"mouseup\", _delTempEndpoint);\n                            _currentInstance.off(elInfo.el, \"mouseup\", _delTempEndpoint);\n                            if (endpointAddedButNoDragYet) {\n                                endpointAddedButNoDragYet = false;\n                                _currentInstance.deleteEndpoint(ep);\n                            }\n                        };\n\n                        _currentInstance.on(ep.canvas, \"mouseup\", _delTempEndpoint);\n                        _currentInstance.on(elInfo.el, \"mouseup\", _delTempEndpoint);\n\n                        // optionally check for attributes to extract from the source element\n                        var payload = {};\n                        if (def.def.extract) {\n                            for (var att in def.def.extract) {\n                                var v = (e.srcElement || e.target).getAttribute(att);\n                                if (v) {\n                                    payload[def.def.extract[att]] = v;\n                                }\n                            }\n                        }\n\n                        // and then trigger its mousedown event, which will kick off a drag, which will start dragging\n                        // a new connection from this endpoint.\n                        _currentInstance.trigger(ep.canvas, \"mousedown\", e, payload);\n\n                        _ju.consume(e);\n\n                    }.bind(this);\n\n                    this.on(elInfo.el, \"mousedown\", mouseDownListener);\n                    _def.trigger = mouseDownListener;\n\n                    // if a filter was provided, set it as a dragFilter on the element,\n                    // to prevent the element drag function from kicking in when we want to\n                    // drag a new connection\n                    if (p.filter && (_ju.isString(p.filter) || _ju.isFunction(p.filter))) {\n                        _currentInstance.setDragFilter(elInfo.el, p.filter);\n                    }\n\n                    var dropOptions = root.jsPlumb.extend({}, p.dropOptions || {});\n\n                    _makeElementDropHandler(elInfo, p, dropOptions, true, p.isTarget === true);\n\n                }.bind(this);\n\n            var inputs = el.length && el.constructor !== String ? el : [ el ];\n            for (var i = 0, ii = inputs.length; i < ii; i++) {\n                _doOne(_info(inputs[i]));\n            }\n\n            return this;\n        };\n\n        // see api docs\n        this.unmakeSource = function (el, connectionType, doNotClearArrays) {\n            var info = _info(el);\n            _currentInstance.destroyDroppable(info.el, \"internal\");\n            var eldefs = this.sourceEndpointDefinitions[info.id];\n            if (eldefs) {\n                for (var def in eldefs) {\n                    if (connectionType == null || connectionType === def) {\n                        var mouseDownListener = eldefs[def].trigger;\n                        if (mouseDownListener) {\n                            _currentInstance.off(info.el, \"mousedown\", mouseDownListener);\n                        }\n                        if (!doNotClearArrays) {\n                            delete this.sourceEndpointDefinitions[info.id][def];\n                        }\n                    }\n                }\n            }\n\n            return this;\n        };\n\n        // see api docs\n        this.unmakeEverySource = function () {\n            for (var i in this.sourceEndpointDefinitions) {\n                _currentInstance.unmakeSource(i, null, true);\n            }\n\n            this.sourceEndpointDefinitions = {};\n            return this;\n        };\n\n        var _getScope = function (el, types, connectionType) {\n            types = _ju.isArray(types) ? types : [ types ];\n            var id = _getId(el);\n            connectionType = connectionType || \"default\";\n            for (var i = 0; i < types.length; i++) {\n                var eldefs = this[types[i]][id];\n                if (eldefs && eldefs[connectionType]) {\n                    return eldefs[connectionType].def.scope || this.Defaults.Scope;\n                }\n            }\n        }.bind(this);\n\n        var _setScope = function (el, scope, types, connectionType) {\n            types = _ju.isArray(types) ? types : [ types ];\n            var id = _getId(el);\n            connectionType = connectionType || \"default\";\n            for (var i = 0; i < types.length; i++) {\n                var eldefs = this[types[i]][id];\n                if (eldefs && eldefs[connectionType]) {\n                    eldefs[connectionType].def.scope = scope;\n                }\n            }\n\n        }.bind(this);\n\n        this.getScope = function (el, scope) {\n            return _getScope(el, [ \"sourceEndpointDefinitions\", \"targetEndpointDefinitions\" ]);\n        };\n        this.getSourceScope = function (el) {\n            return _getScope(el, \"sourceEndpointDefinitions\");\n        };\n        this.getTargetScope = function (el) {\n            return _getScope(el, \"targetEndpointDefinitions\");\n        };\n        this.setScope = function (el, scope, connectionType) {\n            this.setSourceScope(el, scope, connectionType);\n            this.setTargetScope(el, scope, connectionType);\n        };\n        this.setSourceScope = function (el, scope, connectionType) {\n            _setScope(el, scope, \"sourceEndpointDefinitions\", connectionType);\n            // we get the source scope during the mousedown event, but we also want to set this.\n            this.setDragScope(el, scope);\n        };\n        this.setTargetScope = function (el, scope, connectionType) {\n            _setScope(el, scope, \"targetEndpointDefinitions\", connectionType);\n            this.setDropScope(el, scope);\n        };\n\n        // see api docs\n        this.unmakeEveryTarget = function () {\n            for (var i in this.targetEndpointDefinitions) {\n                _currentInstance.unmakeTarget(i, true);\n            }\n\n            this.targetEndpointDefinitions = {};\n            return this;\n        };\n\n        // does the work of setting a source enabled or disabled.\n        var _setEnabled = function (type, el, state, toggle, connectionType) {\n            var a = type === \"source\" ? this.sourceEndpointDefinitions : this.targetEndpointDefinitions,\n                originalState, info, newState;\n\n            connectionType = connectionType || \"default\";\n\n            // a selector or an array\n            if (el.length && !_ju.isString(el)) {\n                originalState = [];\n                for (var i = 0, ii = el.length; i < ii; i++) {\n                    info = _info(el[i]);\n                    if (a[info.id] && a[info.id][connectionType]) {\n                        originalState[i] = a[info.id][connectionType].enabled;\n                        newState = toggle ? !originalState[i] : state;\n                        a[info.id][connectionType].enabled = newState;\n                        _currentInstance[newState ? \"removeClass\" : \"addClass\"](info.el, \"jtk-\" + type + \"-disabled\");\n                    }\n                }\n            }\n            // otherwise a DOM element or a String ID.\n            else {\n                info = _info(el);\n                var id = info.id;\n                if (a[id] && a[id][connectionType]) {\n                    originalState = a[id][connectionType].enabled;\n                    newState = toggle ? !originalState : state;\n                    a[id][connectionType].enabled = newState;\n                    _currentInstance[newState ? \"removeClass\" : \"addClass\"](info.el, \"jtk-\" + type + \"-disabled\");\n                }\n            }\n            return originalState;\n        }.bind(this);\n\n        var _first = function (el, fn) {\n            if (_ju.isString(el) || !el.length) {\n                return fn.apply(this, [ el ]);\n            }\n            else if (el.length) {\n                return fn.apply(this, [ el[0] ]);\n            }\n\n        }.bind(this);\n\n        this.toggleSourceEnabled = function (el, connectionType) {\n            _setEnabled(\"source\", el, null, true, connectionType);\n            return this.isSourceEnabled(el, connectionType);\n        };\n\n        this.setSourceEnabled = function (el, state, connectionType) {\n            return _setEnabled(\"source\", el, state, null, connectionType);\n        };\n        this.isSource = function (el, connectionType) {\n            connectionType = connectionType || \"default\";\n            return _first(el, function (_el) {\n                var eldefs = this.sourceEndpointDefinitions[_info(_el).id];\n                return eldefs != null && eldefs[connectionType] != null;\n            }.bind(this));\n        };\n        this.isSourceEnabled = function (el, connectionType) {\n            connectionType = connectionType || \"default\";\n            return _first(el, function (_el) {\n                var sep = this.sourceEndpointDefinitions[_info(_el).id];\n                return sep && sep[connectionType] && sep[connectionType].enabled === true;\n            }.bind(this));\n        };\n\n        this.toggleTargetEnabled = function (el, connectionType) {\n            _setEnabled(\"target\", el, null, true, connectionType);\n            return this.isTargetEnabled(el, connectionType);\n        };\n\n        this.isTarget = function (el, connectionType) {\n            connectionType = connectionType || \"default\";\n            return _first(el, function (_el) {\n                var eldefs = this.targetEndpointDefinitions[_info(_el).id];\n                return eldefs != null && eldefs[connectionType] != null;\n            }.bind(this));\n        };\n        this.isTargetEnabled = function (el, connectionType) {\n            connectionType = connectionType || \"default\";\n            return _first(el, function (_el) {\n                var tep = this.targetEndpointDefinitions[_info(_el).id];\n                return tep && tep[connectionType] && tep[connectionType].enabled === true;\n            }.bind(this));\n        };\n        this.setTargetEnabled = function (el, state, connectionType) {\n            return _setEnabled(\"target\", el, state, null, connectionType);\n        };\n\n// --------------------- end makeSource/makeTarget ----------------------------------------------\n\n        this.ready = function (fn) {\n            _currentInstance.bind(\"ready\", fn);\n        };\n\n        var _elEach = function(el, fn) {\n            // support both lists...\n            if (typeof el === 'object' && el.length) {\n                for (var i = 0, ii = el.length; i < ii; i++) {\n                    fn(el[i]);\n                }\n            }\n            else {// ...and single strings or elements.\n                fn(el);\n            }\n\n            return _currentInstance;\n        };\n\n        // repaint some element's endpoints and connections\n        this.repaint = function (el, ui, timestamp) {\n            return _elEach(el, function(_el) {\n                _draw(_el, ui, timestamp);\n            });\n        };\n\n        this.revalidate = function (el, timestamp, isIdAlready) {\n            return _elEach(el, function(_el) {\n                var elId = isIdAlready ? _el : _currentInstance.getId(_el);\n                _currentInstance.updateOffset({ elId: elId, recalc: true, timestamp:timestamp });\n                var dm = _currentInstance.getDragManager();\n                if (dm) {\n                    dm.updateOffsets(elId);\n                }\n                _currentInstance.repaint(_el);\n            });\n        };\n\n        // repaint every endpoint and connection.\n        this.repaintEverything = function () {\n            // TODO this timestamp causes continuous anchors to not repaint properly.\n            // fix this. do not just take out the timestamp. it runs a lot faster with\n            // the timestamp included.\n            var timestamp = _timestamp(), elId;\n\n            for (elId in endpointsByElement) {\n                _currentInstance.updateOffset({ elId: elId, recalc: true, timestamp: timestamp });\n            }\n\n            for (elId in endpointsByElement) {\n                _draw(elId, null, timestamp);\n            }\n\n            return this;\n        };\n\n        this.removeAllEndpoints = function (el, recurse, affectedElements) {\n            affectedElements = affectedElements || [];\n            var _one = function (_el) {\n                var info = _info(_el),\n                    ebe = endpointsByElement[info.id],\n                    i, ii;\n\n                if (ebe) {\n                    affectedElements.push(info);\n                    for (i = 0, ii = ebe.length; i < ii; i++) {\n                        _currentInstance.deleteEndpoint(ebe[i], false);\n                    }\n                }\n                delete endpointsByElement[info.id];\n\n                if (recurse) {\n                    if (info.el && info.el.nodeType !== 3 && info.el.nodeType !== 8) {\n                        for (i = 0, ii = info.el.childNodes.length; i < ii; i++) {\n                            _one(info.el.childNodes[i]);\n                        }\n                    }\n                }\n\n            };\n            _one(el);\n            return this;\n        };\n\n        var _doRemove = function(info, affectedElements) {\n            _currentInstance.removeAllEndpoints(info.id, true, affectedElements);\n            var dm = _currentInstance.getDragManager();\n            var _one = function(_info) {\n\n                if (dm) {\n                    dm.elementRemoved(_info.id);\n                }\n                _currentInstance.router.elementRemoved(_info.id);\n\n                if (_currentInstance.isSource(_info.el)) {\n                    _currentInstance.unmakeSource(_info.el);\n                }\n                if (_currentInstance.isTarget(_info.el)) {\n                    _currentInstance.unmakeTarget(_info.el);\n                }\n                _currentInstance.destroyDraggable(_info.el);\n                _currentInstance.destroyDroppable(_info.el);\n\n\n                delete _currentInstance.floatingConnections[_info.id];\n                delete managedElements[_info.id];\n                delete offsets[_info.id];\n                if (_info.el) {\n                    _currentInstance.removeElement(_info.el);\n                    _info.el._jsPlumb = null;\n                }\n            };\n\n            // remove all affected child elements\n            for (var ae = 1; ae < affectedElements.length; ae++) {\n                _one(affectedElements[ae]);\n            }\n            // and always remove the requested one from the dom.\n            _one(info);\n        };\n\n        /**\n         * Remove the given element, including cleaning up all endpoints registered for it.\n         * This is exposed in the public API but also used internally by jsPlumb when removing the\n         * element associated with a connection drag.\n         */\n        this.remove = function (el, doNotRepaint) {\n            var info = _info(el), affectedElements = [];\n            if (info.text && info.el.parentNode) {\n                info.el.parentNode.removeChild(info.el);\n            }\n            else if (info.id) {\n                _currentInstance.batch(function () {\n                    _doRemove(info, affectedElements);\n                }, doNotRepaint === true);\n            }\n            return _currentInstance;\n        };\n\n        this.empty = function (el, doNotRepaint) {\n            var affectedElements = [];\n            var _one = function(el, dontRemoveFocus) {\n                var info = _info(el);\n                if (info.text) {\n                    info.el.parentNode.removeChild(info.el);\n                }\n                else if (info.el) {\n                    while(info.el.childNodes.length > 0) {\n                        _one(info.el.childNodes[0]);\n                    }\n                    if (!dontRemoveFocus) {\n                        _doRemove(info, affectedElements);\n                    }\n                }\n            };\n\n            _currentInstance.batch(function() {\n                _one(el, true);\n            }, doNotRepaint === false);\n\n            return _currentInstance;\n        };\n\n        this.reset = function (doNotUnbindInstanceEventListeners) {\n            _currentInstance.silently(function() {\n                _hoverSuspended = false;\n                _currentInstance.removeAllGroups();\n                _currentInstance.removeGroupManager();\n                _currentInstance.deleteEveryEndpoint();\n                if (!doNotUnbindInstanceEventListeners) {\n                    _currentInstance.unbind();\n                }\n                this.targetEndpointDefinitions = {};\n                this.sourceEndpointDefinitions = {};\n                connections.length = 0;\n                if (this.doReset) {\n                    this.doReset();\n                }\n            }.bind(this));\n        };\n\n        var _clearObject = function (obj) {\n            if (obj.canvas && obj.canvas.parentNode) {\n                obj.canvas.parentNode.removeChild(obj.canvas);\n            }\n            obj.cleanup();\n            obj.destroy();\n        };\n\n        this.clear = function () {\n            _currentInstance.select().each(_clearObject);\n            _currentInstance.selectEndpoints().each(_clearObject);\n\n            endpointsByElement = {};\n            endpointsByUUID = {};\n        };\n\n        this.setDefaultScope = function (scope) {\n            DEFAULT_SCOPE = scope;\n            return _currentInstance;\n        };\n\n        this.deriveEndpointAndAnchorSpec = function(type, dontPrependDefault) {\n            var bits = ((dontPrependDefault ? \"\" : \"default \") + type).split(/[\\s]/), eps = null, ep = null, a = null, as = null;\n            for (var i = 0; i < bits.length; i++) {\n                var _t = _currentInstance.getType(bits[i], \"connection\");\n                if (_t) {\n                    if (_t.endpoints) {\n                        eps = _t.endpoints;\n                    }\n                    if (_t.endpoint) {\n                        ep = _t.endpoint;\n                    }\n                    if (_t.anchors) {\n                        as = _t.anchors;\n                    }\n                    if (_t.anchor) {\n                        a = _t.anchor;\n                    }\n                }\n            }\n            return { endpoints: eps ? eps : [ ep, ep ], anchors: as ? as : [a, a ]};\n        };\n\n        // sets the id of some element, changing whatever we need to to keep track.\n        this.setId = function (el, newId, doNotSetAttribute) {\n            //\n            var id;\n\n            if (_ju.isString(el)) {\n                id = el;\n            }\n            else {\n                el = this.getElement(el);\n                id = this.getId(el);\n            }\n\n            var sConns = this.getConnections({source: id, scope: '*'}, true),\n                tConns = this.getConnections({target: id, scope: '*'}, true);\n\n            newId = \"\" + newId;\n\n            if (!doNotSetAttribute) {\n                el = this.getElement(id);\n                this.setAttribute(el, \"id\", newId);\n            }\n            else {\n                el = this.getElement(newId);\n            }\n\n            endpointsByElement[newId] = endpointsByElement[id] || [];\n            for (var i = 0, ii = endpointsByElement[newId].length; i < ii; i++) {\n                endpointsByElement[newId][i].setElementId(newId);\n                endpointsByElement[newId][i].setReferenceElement(el);\n            }\n            delete endpointsByElement[id];\n\n            this.sourceEndpointDefinitions[newId] = this.sourceEndpointDefinitions[id];\n            delete this.sourceEndpointDefinitions[id];\n            this.targetEndpointDefinitions[newId] = this.targetEndpointDefinitions[id];\n            delete this.targetEndpointDefinitions[id];\n\n            this.router.changeId(id, newId);\n            var dm = this.getDragManager();\n            if (dm) {\n                dm.changeId(id, newId);\n            }\n            managedElements[newId] = managedElements[id];\n            delete managedElements[id];\n\n            var _conns = function (list, epIdx, type) {\n                for (var i = 0, ii = list.length; i < ii; i++) {\n                    list[i].endpoints[epIdx].setElementId(newId);\n                    list[i].endpoints[epIdx].setReferenceElement(el);\n                    list[i][type + \"Id\"] = newId;\n                    list[i][type] = el;\n                }\n            };\n            _conns(sConns, 0, \"source\");\n            _conns(tConns, 1, \"target\");\n\n            this.repaint(newId);\n        };\n\n        this.setDebugLog = function (debugLog) {\n            log = debugLog;\n        };\n\n        this.setSuspendDrawing = function (val, repaintAfterwards) {\n            var curVal = _suspendDrawing;\n            _suspendDrawing = val;\n            if (val) {\n                _suspendedAt = new Date().getTime();\n            } else {\n                _suspendedAt = null;\n            }\n            if (repaintAfterwards) {\n                this.repaintEverything();\n            }\n            return curVal;\n        };\n\n        // returns whether or not drawing is currently suspended.\n        this.isSuspendDrawing = function () {\n            return _suspendDrawing;\n        };\n\n        // return timestamp for when drawing was suspended.\n        this.getSuspendedAt = function () {\n            return _suspendedAt;\n        };\n\n        this.batch = function (fn, doNotRepaintAfterwards) {\n            var _wasSuspended = this.isSuspendDrawing();\n            if (!_wasSuspended) {\n                this.setSuspendDrawing(true);\n            }\n            try {\n                fn();\n            }\n            catch (e) {\n                _ju.log(\"Function run while suspended failed\", e);\n            }\n            if (!_wasSuspended) {\n                this.setSuspendDrawing(false, !doNotRepaintAfterwards);\n            }\n        };\n\n        this.doWhileSuspended = this.batch;\n\n        this.getCachedData = _getCachedData;\n        this.timestamp = _timestamp;\n        this.show = function (el, changeEndpoints) {\n            _setVisible(el, \"block\", changeEndpoints);\n            return _currentInstance;\n        };\n\n        // TODO: update this method to return the current state.\n        this.toggleVisible = _toggleVisible;\n        this.addListener = this.bind;\n\n        var floatingConnections = [];\n        this.registerFloatingConnection = function(info, conn, ep) {\n            floatingConnections[info.id] = conn;\n            // only register for the target endpoint; we will not be dragging the source at any time\n            // before this connection is either discarded or made into a permanent connection.\n            _ju.addToList(endpointsByElement, info.id, ep);\n        };\n        this.getFloatingConnectionFor = function(id) {\n            return floatingConnections[id];\n        };\n\n        this.listManager = new root.jsPlumbListManager(this, this.Defaults.ListStyle);\n    };\n\n    _ju.extend(root.jsPlumbInstance, _ju.EventGenerator, {\n        setAttribute: function (el, a, v) {\n            this.setAttribute(el, a, v);\n        },\n        getAttribute: function (el, a) {\n            return this.getAttribute(root.jsPlumb.getElement(el), a);\n        },\n        convertToFullOverlaySpec: function(spec) {\n            if (_ju.isString(spec)) {\n                spec = [ spec, { } ];\n            }\n            spec[1].id = spec[1].id || _ju.uuid();\n            return spec;\n        },\n        registerConnectionType: function (id, type) {\n            this._connectionTypes[id] = root.jsPlumb.extend({}, type);\n            if (type.overlays) {\n                var to = {};\n                for (var i = 0; i < type.overlays.length; i++) {\n                    // if a string, convert to object representation so that we can store the typeid on it.\n                    // also assign an id.\n                    var fo = this.convertToFullOverlaySpec(type.overlays[i]);\n                    to[fo[1].id] = fo;\n                }\n                this._connectionTypes[id].overlays = to;\n            }\n        },\n        registerConnectionTypes: function (types) {\n            for (var i in types) {\n                this.registerConnectionType(i, types[i]);\n            }\n        },\n        registerEndpointType: function (id, type) {\n            this._endpointTypes[id] = root.jsPlumb.extend({}, type);\n            if (type.overlays) {\n                var to = {};\n                for (var i = 0; i < type.overlays.length; i++) {\n                    // if a string, convert to object representation so that we can store the typeid on it.\n                    // also assign an id.\n                    var fo = this.convertToFullOverlaySpec(type.overlays[i]);\n                    to[fo[1].id] = fo;\n                }\n                this._endpointTypes[id].overlays = to;\n            }\n        },\n        registerEndpointTypes: function (types) {\n            for (var i in types) {\n                this.registerEndpointType(i, types[i]);\n            }\n        },\n        getType: function (id, typeDescriptor) {\n            return typeDescriptor === \"connection\" ? this._connectionTypes[id] : this._endpointTypes[id];\n        },\n        setIdChanged: function (oldId, newId) {\n            this.setId(oldId, newId, true);\n        },\n        // set parent: change the parent for some node and update all the registrations we need to.\n        setParent: function (el, newParent) {\n            var _dom = this.getElement(el),\n                _id = this.getId(_dom),\n                _pdom = this.getElement(newParent),\n                _pid = this.getId(_pdom),\n                dm = this.getDragManager();\n\n            _dom.parentNode.removeChild(_dom);\n            _pdom.appendChild(_dom);\n            if (dm) {\n                dm.setParent(_dom, _id, _pdom, _pid);\n            }\n        },\n        extend: function (o1, o2, names) {\n            var i;\n            if (names) {\n                for (i = 0; i < names.length; i++) {\n                    o1[names[i]] = o2[names[i]];\n                }\n            }\n            else {\n                for (i in o2) {\n                    o1[i] = o2[i];\n                }\n            }\n\n            return o1;\n        },\n        floatingConnections: {},\n        getFloatingAnchorIndex: function (jpc) {\n            return jpc.endpoints[0].isFloating() ? 0 : jpc.endpoints[1].isFloating() ? 1 : -1;\n        },\n        proxyConnection :function(connection, index, proxyEl, proxyElId, endpointGenerator, anchorGenerator) {\n            var proxyEp,\n                originalElementId = connection.endpoints[index].elementId,\n                originalEndpoint = connection.endpoints[index];\n\n            connection.proxies = connection.proxies || [];\n            if(connection.proxies[index]) {\n                proxyEp = connection.proxies[index].ep;\n            }else {\n                proxyEp = this.addEndpoint(proxyEl, {\n                    endpoint:endpointGenerator(connection, index),\n                    anchor:anchorGenerator(connection, index),\n                    parameters:{\n                        isProxyEndpoint:true\n                    }\n                });\n            }\n            proxyEp.setDeleteOnEmpty(true);\n\n            // for this index, stash proxy info: the new EP, the original EP.\n            connection.proxies[index] = { ep:proxyEp, originalEp: originalEndpoint };\n\n            // and advise the anchor manager\n            if (index === 0) {\n                this.router.sourceOrTargetChanged(originalElementId, proxyElId, connection, proxyEl, 0);\n            }\n            else {\n                this.router.sourceOrTargetChanged(originalElementId, proxyElId, connection, proxyEl, 1);\n            }\n\n            // detach the original EP from the connection.\n            originalEndpoint.detachFromConnection(connection, null, true);\n\n            // set the proxy as the new ep\n            proxyEp.connections = [ connection ];\n            connection.endpoints[index] = proxyEp;\n\n            originalEndpoint.setVisible(false);\n\n            connection.setVisible(true);\n\n            this.revalidate(proxyEl);\n        },\n        unproxyConnection : function(connection, index, proxyElId) {\n            // if connection cleaned up, no proxies, or none for this end of the connection, abort.\n            if (connection._jsPlumb == null || connection.proxies == null || connection.proxies[index] == null) {\n                return;\n            }\n\n            var originalElement = connection.proxies[index].originalEp.element,\n                originalElementId = connection.proxies[index].originalEp.elementId;\n\n            connection.endpoints[index] = connection.proxies[index].originalEp;\n            // and advise the anchor manager\n            if (index === 0) {\n                // TODO why are there two differently named methods? Why is there not one method that says \"some end of this\n                // connection changed (you give the index), and here's the new element and element id.\"\n                this.router.sourceOrTargetChanged(proxyElId, originalElementId, connection, originalElement, 0);\n            }\n            else {\n                this.router.sourceOrTargetChanged(proxyElId, originalElementId, connection, originalElement, 1);\n            }\n\n            // detach the proxy EP from the connection (which will cause it to be removed as we no longer need it)\n            connection.proxies[index].ep.detachFromConnection(connection, null);\n\n            connection.proxies[index].originalEp.addConnection(connection);\n            if(connection.isVisible()) {\n                connection.proxies[index].originalEp.setVisible(true);\n            }\n\n            // cleanup\n            delete connection.proxies[index];\n        }\n    });\n\n// --------------------- static instance + module registration -------------------------------------------\n\n// create static instance and assign to window if window exists.\n    var jsPlumb = new jsPlumbInstance();\n    // register on 'root' (lets us run on server or browser)\n    root.jsPlumb = jsPlumb;\n    // add 'getInstance' method to static instance\n    jsPlumb.getInstance = function (_defaults, overrideFns) {\n        var j = new jsPlumbInstance(_defaults);\n        if (overrideFns) {\n            for (var ovf in overrideFns) {\n                j[ovf] = overrideFns[ovf];\n            }\n        }\n        j.init();\n        return j;\n    };\n    jsPlumb.each = function (spec, fn) {\n        if (spec == null) {\n            return;\n        }\n        if (typeof spec === \"string\") {\n            fn(jsPlumb.getElement(spec));\n        }\n        else if (spec.length != null) {\n            for (var i = 0; i < spec.length; i++) {\n                fn(jsPlumb.getElement(spec[i]));\n            }\n        }\n        else {\n            fn(spec);\n        } // assume it's an element.\n    };\n\n    // CommonJS\n    if (typeof exports !== 'undefined') {\n        exports.jsPlumb = jsPlumb;\n    }\n\n// --------------------- end static instance + AMD registration -------------------------------------------\n\n}).call(typeof window !== 'undefined' ? window : this);\n\n/*\n * Copyright (c) 2010 - 2020 jsPlumb (hello@jsplumbtoolkit.com)\n *\n * https://jsplumbtoolkit.com\n * https://github.com/jsplumb/jsplumb\n *\n * Dual licensed under the MIT and GPL2 licenses.\n */\n;(function() {\n\n    \"use strict\";\n    var root = this, _jp = root.jsPlumb, _ju = root.jsPlumbUtil;\n\n    // ------------------------------ BEGIN OverlayCapablejsPlumbUIComponent --------------------------------------------\n\n    var _internalLabelOverlayId = \"__label\",\n    // this is a shortcut helper method to let people add a label as\n    // overlay.\n        _makeLabelOverlay = function (component, params) {\n\n            var _params = {\n                    cssClass: params.cssClass,\n                    labelStyle: component.labelStyle,\n                    id: _internalLabelOverlayId,\n                    component: component,\n                    _jsPlumb: component._jsPlumb.instance  // TODO not necessary, since the instance can be accessed through the component.\n                },\n                mergedParams = _jp.extend(_params, params);\n\n            return new _jp.Overlays[component._jsPlumb.instance.getRenderMode()].Label(mergedParams);\n        },\n        _processOverlay = function (component, o) {\n            var _newOverlay = null;\n            if (_ju.isArray(o)) {\t// this is for the shorthand [\"Arrow\", { width:50 }] syntax\n                // there's also a three arg version:\n                // [\"Arrow\", { width:50 }, {location:0.7}]\n                // which merges the 3rd arg into the 2nd.\n                var type = o[0],\n                // make a copy of the object so as not to mess up anyone else's reference...\n                    p = _jp.extend({component: component, _jsPlumb: component._jsPlumb.instance}, o[1]);\n                if (o.length === 3) {\n                    _jp.extend(p, o[2]);\n                }\n                _newOverlay = new _jp.Overlays[component._jsPlumb.instance.getRenderMode()][type](p);\n            } else if (o.constructor === String) {\n                _newOverlay = new _jp.Overlays[component._jsPlumb.instance.getRenderMode()][o]({component: component, _jsPlumb: component._jsPlumb.instance});\n            } else {\n                _newOverlay = o;\n            }\n\n            _newOverlay.id = _newOverlay.id || _ju.uuid();\n            component.cacheTypeItem(\"overlay\", _newOverlay, _newOverlay.id);\n            component._jsPlumb.overlays[_newOverlay.id] = _newOverlay;\n\n            return _newOverlay;\n        };\n\n    _jp.OverlayCapableJsPlumbUIComponent = function (params) {\n\n        root.jsPlumbUIComponent.apply(this, arguments);\n        this._jsPlumb.overlays = {};\n        this._jsPlumb.overlayPositions = {};\n\n        if (params.label) {\n            this.getDefaultType().overlays[_internalLabelOverlayId] = [\"Label\", {\n                label: params.label,\n                location: params.labelLocation || this.defaultLabelLocation || 0.5,\n                labelStyle: params.labelStyle || this._jsPlumb.instance.Defaults.LabelStyle,\n                id:_internalLabelOverlayId\n            }];\n        }\n\n        this.setListenerComponent = function (c) {\n            if (this._jsPlumb) {\n                for (var i in this._jsPlumb.overlays) {\n                    this._jsPlumb.overlays[i].setListenerComponent(c);\n                }\n            }\n        };\n    };\n\n    _jp.OverlayCapableJsPlumbUIComponent.applyType = function (component, t) {\n        if (t.overlays) {\n            // loop through the ones in the type. if already present on the component,\n            // dont remove or re-add.\n            var keep = {}, i;\n\n            for (i in t.overlays) {\n\n                var existing = component._jsPlumb.overlays[t.overlays[i][1].id];\n                if (existing) {\n                    // maybe update from data, if there were parameterised values for instance.\n                    existing.updateFrom(t.overlays[i][1]);\n                    keep[t.overlays[i][1].id] = true;\n\n                    existing.reattach(component._jsPlumb.instance, component);\n                }\n                else {\n                    var c = component.getCachedTypeItem(\"overlay\", t.overlays[i][1].id);\n                    if (c != null) {\n                        c.reattach(component._jsPlumb.instance, component);\n                        c.setVisible(true);\n                        // maybe update from data, if there were parameterised values for instance.\n                        c.updateFrom(t.overlays[i][1]);\n                        component._jsPlumb.overlays[c.id] = c;\n                    }\n                    else {\n                        c = component.addOverlay(t.overlays[i], true);\n                    }\n                    keep[c.id] = true;\n                }\n            }\n\n            // now loop through the full overlays and remove those that we dont want to keep\n            for (i in component._jsPlumb.overlays) {\n                if (keep[component._jsPlumb.overlays[i].id] == null) {\n                    component.removeOverlay(component._jsPlumb.overlays[i].id, true); // remove overlay but dont clean it up.\n                    // that would remove event listeners etc; overlays are never discarded by the types stuff, they are\n                    // just detached/reattached.\n                }\n            }\n        }\n    };\n\n    _ju.extend(_jp.OverlayCapableJsPlumbUIComponent, root.jsPlumbUIComponent, {\n\n        setHover: function (hover, ignoreAttachedElements) {\n            if (this._jsPlumb && !this._jsPlumb.instance.isConnectionBeingDragged()) {\n                for (var i in this._jsPlumb.overlays) {\n                    this._jsPlumb.overlays[i][hover ? \"addClass\" : \"removeClass\"](this._jsPlumb.instance.hoverClass);\n                }\n            }\n        },\n        addOverlay: function (overlay, doNotRepaint) {\n            var o = _processOverlay(this, overlay);\n\n            if (this.getData && o.type === \"Label\" && _ju.isArray(overlay)) {\n                //\n                // component data might contain label location - look for it here.\n                var d = this.getData(), p = overlay[1];\n                if (d) {\n                    var locationAttribute = p.labelLocationAttribute || \"labelLocation\";\n                    var loc = d ? d[locationAttribute] : null;\n\n                    if (loc) {\n                        o.loc = loc;\n                    }\n                }\n            }\n\n            if (!doNotRepaint) {\n                this.repaint();\n            }\n            return o;\n        },\n        getOverlay: function (id) {\n            return this._jsPlumb.overlays[id];\n        },\n        getOverlays: function () {\n            return this._jsPlumb.overlays;\n        },\n        hideOverlay: function (id) {\n            var o = this.getOverlay(id);\n            if (o) {\n                o.hide();\n            }\n        },\n        hideOverlays: function () {\n            for (var i in this._jsPlumb.overlays) {\n                this._jsPlumb.overlays[i].hide();\n            }\n        },\n        showOverlay: function (id) {\n            var o = this.getOverlay(id);\n            if (o) {\n                o.show();\n            }\n        },\n        showOverlays: function () {\n            for (var i in this._jsPlumb.overlays) {\n                this._jsPlumb.overlays[i].show();\n            }\n        },\n        removeAllOverlays: function (doNotRepaint) {\n            for (var i in this._jsPlumb.overlays) {\n                if (this._jsPlumb.overlays[i].cleanup) {\n                    this._jsPlumb.overlays[i].cleanup();\n                }\n            }\n\n            this._jsPlumb.overlays = {};\n            this._jsPlumb.overlayPositions = null;\n            this._jsPlumb.overlayPlacements= {};\n            if (!doNotRepaint) {\n                this.repaint();\n            }\n        },\n        removeOverlay: function (overlayId, dontCleanup) {\n            var o = this._jsPlumb.overlays[overlayId];\n            if (o) {\n                o.setVisible(false);\n                if (!dontCleanup && o.cleanup) {\n                    o.cleanup();\n                }\n                delete this._jsPlumb.overlays[overlayId];\n                if (this._jsPlumb.overlayPositions) {\n                    delete this._jsPlumb.overlayPositions[overlayId];\n                }\n\n                if (this._jsPlumb.overlayPlacements) {\n                    delete this._jsPlumb.overlayPlacements[overlayId];\n                }\n            }\n        },\n        removeOverlays: function () {\n            for (var i = 0, j = arguments.length; i < j; i++) {\n                this.removeOverlay(arguments[i]);\n            }\n        },\n        moveParent: function (newParent) {\n            if (this.bgCanvas) {\n                this.bgCanvas.parentNode.removeChild(this.bgCanvas);\n                newParent.appendChild(this.bgCanvas);\n            }\n\n            if (this.canvas && this.canvas.parentNode) {\n                this.canvas.parentNode.removeChild(this.canvas);\n                newParent.appendChild(this.canvas);\n\n                for (var i in this._jsPlumb.overlays) {\n                    if (this._jsPlumb.overlays[i].isAppendedAtTopLevel) {\n                        var el = this._jsPlumb.overlays[i].getElement();\n                        el.parentNode.removeChild(el);\n                        newParent.appendChild(el);\n                    }\n                }\n            }\n        },\n        getLabel: function () {\n            var lo = this.getOverlay(_internalLabelOverlayId);\n            return lo != null ? lo.getLabel() : null;\n        },\n        getLabelOverlay: function () {\n            return this.getOverlay(_internalLabelOverlayId);\n        },\n        setLabel: function (l) {\n            var lo = this.getOverlay(_internalLabelOverlayId);\n            if (!lo) {\n                var params = l.constructor === String || l.constructor === Function ? { label: l } : l;\n                lo = _makeLabelOverlay(this, params);\n                this._jsPlumb.overlays[_internalLabelOverlayId] = lo;\n            }\n            else {\n                if (l.constructor === String || l.constructor === Function) {\n                    lo.setLabel(l);\n                }\n                else {\n                    if (l.label) {\n                        lo.setLabel(l.label);\n                    }\n                    if (l.location) {\n                        lo.setLocation(l.location);\n                    }\n                }\n            }\n\n            if (!this._jsPlumb.instance.isSuspendDrawing()) {\n                this.repaint();\n            }\n        },\n        cleanup: function (force) {\n            for (var i in this._jsPlumb.overlays) {\n                this._jsPlumb.overlays[i].cleanup(force);\n                this._jsPlumb.overlays[i].destroy(force);\n            }\n            if (force) {\n                this._jsPlumb.overlays = {};\n                this._jsPlumb.overlayPositions = null;\n            }\n        },\n        setVisible: function (v) {\n            this[v ? \"showOverlays\" : \"hideOverlays\"]();\n        },\n        setAbsoluteOverlayPosition: function (overlay, xy) {\n            this._jsPlumb.overlayPositions[overlay.id] = xy;\n        },\n        getAbsoluteOverlayPosition: function (overlay) {\n            return this._jsPlumb.overlayPositions ? this._jsPlumb.overlayPositions[overlay.id] : null;\n        },\n        _clazzManip:function(action, clazz, dontUpdateOverlays) {\n            if (!dontUpdateOverlays) {\n                for (var i in this._jsPlumb.overlays) {\n                    this._jsPlumb.overlays[i][action + \"Class\"](clazz);\n                }\n            }\n        },\n        addClass:function(clazz, dontUpdateOverlays) {\n            this._clazzManip(\"add\", clazz, dontUpdateOverlays);\n        },\n        removeClass:function(clazz, dontUpdateOverlays) {\n            this._clazzManip(\"remove\", clazz, dontUpdateOverlays);\n        }\n    });\n\n// ------------------------------ END OverlayCapablejsPlumbUIComponent --------------------------------------------\n\n}).call(typeof window !== 'undefined' ? window : this);\n\n/*\n * This file contains the code for Endpoints.\n *\n * Copyright (c) 2010 - 2020 jsPlumb (hello@jsplumbtoolkit.com)\n * \n * https://jsplumbtoolkit.com\n * https://github.com/jsplumb/jsplumb\n * \n * Dual licensed under the MIT and GPL2 licenses.\n */\n;(function () {\n\n    \"use strict\";\n    var root = this, _jp = root.jsPlumb, _ju = root.jsPlumbUtil;\n\n    // create the drag handler for a connection\n    var _makeConnectionDragHandler = function (endpoint, placeholder, _jsPlumb) {\n        var stopped = false;\n        return {\n            drag: function () {\n                if (stopped) {\n                    stopped = false;\n                    return true;\n                }\n\n                if (placeholder.element) {\n                    var _ui = _jsPlumb.getUIPosition(arguments, _jsPlumb.getZoom());\n                    if (_ui != null) {\n                        _jsPlumb.setPosition(placeholder.element, _ui);\n                    }\n                    _jsPlumb.repaint(placeholder.element, _ui);\n                    // always repaint the source endpoint, because only continuous/dynamic anchors cause the endpoint\n                    // to be repainted, so static anchors need to be told (or the endpoint gets dragged around)\n                    endpoint.paint({anchorPoint:endpoint.anchor.getCurrentLocation({element:endpoint})});\n                }\n            },\n            stopDrag: function () {\n                stopped = true;\n            }\n        };\n    };\n\n    // creates a placeholder div for dragging purposes, adds it, and pre-computes its offset.\n    var _makeDraggablePlaceholder = function (placeholder, _jsPlumb, ipco, ips) {\n        var n = _jsPlumb.createElement(\"div\", { position : \"absolute\" });\n        _jsPlumb.appendElement(n);\n        var id = _jsPlumb.getId(n);\n        _jsPlumb.setPosition(n, ipco);\n        n.style.width = ips[0] + \"px\";\n        n.style.height = ips[1] + \"px\";\n        _jsPlumb.manage(id, n, true); // TRANSIENT MANAGE\n        // create and assign an id, and initialize the offset.\n        placeholder.id = id;\n        placeholder.element = n;\n    };\n\n    // create a floating endpoint (for drag connections)\n    var _makeFloatingEndpoint = function (paintStyle, referenceAnchor, endpoint, referenceCanvas, sourceElement, _jsPlumb, _newEndpoint, scope) {\n        var floatingAnchor = new _jp.FloatingAnchor({ reference: referenceAnchor, referenceCanvas: referenceCanvas, jsPlumbInstance: _jsPlumb });\n        return _newEndpoint({\n            paintStyle: paintStyle,\n            endpoint: endpoint,\n            anchor: floatingAnchor,\n            source: sourceElement,\n            scope: scope\n        });\n    };\n\n    var typeParameters = [ \"connectorStyle\", \"connectorHoverStyle\", \"connectorOverlays\",\n        \"connector\", \"connectionType\", \"connectorClass\", \"connectorHoverClass\" ];\n\n    // a helper function that tries to find a connection to the given element, and returns it if so. if elementWithPrecedence is null,\n    // or no connection to it is found, we return the first connection in our list.\n    var findConnectionToUseForDynamicAnchor = function (ep, elementWithPrecedence) {\n        var idx = 0;\n        if (elementWithPrecedence != null) {\n            for (var i = 0; i < ep.connections.length; i++) {\n                if (ep.connections[i].sourceId === elementWithPrecedence || ep.connections[i].targetId === elementWithPrecedence) {\n                    idx = i;\n                    break;\n                }\n            }\n        }\n\n        return ep.connections[idx];\n    };\n\n    _jp.Endpoint = function (params) {\n        var _jsPlumb = params._jsPlumb,\n            _newConnection = params.newConnection,\n            _newEndpoint = params.newEndpoint;\n\n        this.idPrefix = \"_jsplumb_e_\";\n        this.defaultLabelLocation = [ 0.5, 0.5 ];\n        this.defaultOverlayKeys = [\"Overlays\", \"EndpointOverlays\"];\n        _jp.OverlayCapableJsPlumbUIComponent.apply(this, arguments);\n\n// TYPE\n\n        this.appendToDefaultType({\n            connectionType:params.connectionType,\n            maxConnections: params.maxConnections == null ? this._jsPlumb.instance.Defaults.MaxConnections : params.maxConnections, // maximum number of connections this endpoint can be the source of.,\n            paintStyle: params.endpointStyle || params.paintStyle || params.style || this._jsPlumb.instance.Defaults.EndpointStyle || _jp.Defaults.EndpointStyle,\n            hoverPaintStyle: params.endpointHoverStyle || params.hoverPaintStyle || this._jsPlumb.instance.Defaults.EndpointHoverStyle || _jp.Defaults.EndpointHoverStyle,\n            connectorStyle: params.connectorStyle,\n            connectorHoverStyle: params.connectorHoverStyle,\n            connectorClass: params.connectorClass,\n            connectorHoverClass: params.connectorHoverClass,\n            connectorOverlays: params.connectorOverlays,\n            connector: params.connector,\n            connectorTooltip: params.connectorTooltip\n        });\n\n// END TYPE\n\n        this._jsPlumb.enabled = !(params.enabled === false);\n        this._jsPlumb.visible = true;\n        this.element = _jp.getElement(params.source);\n        this._jsPlumb.uuid = params.uuid;\n        this._jsPlumb.floatingEndpoint = null;\n        var inPlaceCopy = null;\n        if (this._jsPlumb.uuid) {\n            params.endpointsByUUID[this._jsPlumb.uuid] = this;\n        }\n        this.elementId = params.elementId;\n        this.dragProxy = params.dragProxy;\n\n        this._jsPlumb.connectionCost = params.connectionCost;\n        this._jsPlumb.connectionsDirected = params.connectionsDirected;\n        this._jsPlumb.currentAnchorClass = \"\";\n        this._jsPlumb.events = {};\n\n        var deleteOnEmpty = params.deleteOnEmpty === true;\n        this.setDeleteOnEmpty = function(d) {\n            deleteOnEmpty = d;\n        };\n\n        var _updateAnchorClass = function () {\n            // stash old, get new\n            var oldAnchorClass = _jsPlumb.endpointAnchorClassPrefix + \"-\" + this._jsPlumb.currentAnchorClass;\n            this._jsPlumb.currentAnchorClass = this.anchor.getCssClass();\n            var anchorClass = _jsPlumb.endpointAnchorClassPrefix + (this._jsPlumb.currentAnchorClass ? \"-\" + this._jsPlumb.currentAnchorClass : \"\");\n\n            this.removeClass(oldAnchorClass);\n            this.addClass(anchorClass);\n            // add and remove at the same time to reduce the number of reflows.\n            _jp.updateClasses(this.element, anchorClass, oldAnchorClass);\n        }.bind(this);\n\n        this.prepareAnchor = function(anchorParams) {\n            var a = this._jsPlumb.instance.makeAnchor(anchorParams, this.elementId, _jsPlumb);\n            a.bind(\"anchorChanged\", function (currentAnchor) {\n                this.fire(\"anchorChanged\", {endpoint: this, anchor: currentAnchor});\n                _updateAnchorClass();\n            }.bind(this));\n            return a;\n        };\n\n        this.setPreparedAnchor = function(anchor, doNotRepaint) {\n            this._jsPlumb.instance.continuousAnchorFactory.clear(this.elementId);\n            this.anchor = anchor;\n            _updateAnchorClass();\n\n            if (!doNotRepaint) {\n                this._jsPlumb.instance.repaint(this.elementId);\n            }\n\n            return this;\n        };\n\n        this.setAnchor = function (anchorParams, doNotRepaint) {\n            var a = this.prepareAnchor(anchorParams);\n            this.setPreparedAnchor(a, doNotRepaint);\n            return this;\n        };\n\n        var internalHover = function (state) {\n            if (this.connections.length > 0) {\n                for (var i = 0; i < this.connections.length; i++) {\n                    this.connections[i].setHover(state, false);\n                }\n            }\n            else {\n                this.setHover(state);\n            }\n        }.bind(this);\n\n        this.bind(\"mouseover\", function () {\n            internalHover(true);\n        });\n        this.bind(\"mouseout\", function () {\n            internalHover(false);\n        });\n\n        // ANCHOR MANAGER\n        if (!params._transient) { // in place copies, for example, are transient.  they will never need to be retrieved during a paint cycle, because they dont move, and then they are deleted.\n            this._jsPlumb.instance.anchorManager.add(this, this.elementId);\n        }\n\n        this.prepareEndpoint = function(ep, typeId) {\n            var _e = function (t, p) {\n                var rm = _jsPlumb.getRenderMode();\n                if (_jp.Endpoints[rm][t]) {\n                    return new _jp.Endpoints[rm][t](p);\n                }\n                if (!_jsPlumb.Defaults.DoNotThrowErrors) {\n                    throw { msg: \"jsPlumb: unknown endpoint type '\" + t + \"'\" };\n                }\n            };\n\n            var endpointArgs = {\n                _jsPlumb: this._jsPlumb.instance,\n                cssClass: params.cssClass,\n                container: params.container,\n                tooltip: params.tooltip,\n                connectorTooltip: params.connectorTooltip,\n                endpoint: this\n            };\n\n            var endpoint;\n\n            if (_ju.isString(ep)) {\n                endpoint = _e(ep, endpointArgs);\n            }\n            else if (_ju.isArray(ep)) {\n                endpointArgs = _ju.merge(ep[1], endpointArgs);\n                endpoint = _e(ep[0], endpointArgs);\n            }\n            else {\n                endpoint = ep.clone();\n            }\n\n            // assign a clone function using a copy of endpointArgs. this is used when a drag starts: the endpoint that was dragged is cloned,\n            // and the clone is left in its place while the original one goes off on a magical journey.\n            // the copy is to get around a closure problem, in which endpointArgs ends up getting shared by\n            // the whole world.\n            //var argsForClone = jsPlumb.extend({}, endpointArgs);\n            endpoint.clone = function () {\n                // TODO this, and the code above, can be refactored to be more dry.\n                if (_ju.isString(ep)) {\n                    return _e(ep, endpointArgs);\n                }\n                else if (_ju.isArray(ep)) {\n                    endpointArgs = _ju.merge(ep[1], endpointArgs);\n                    return _e(ep[0], endpointArgs);\n                }\n            }.bind(this);\n\n            endpoint.typeId = typeId;\n            return endpoint;\n        };\n\n        this.setEndpoint = function(ep, doNotRepaint) {\n            var _ep = this.prepareEndpoint(ep);\n            this.setPreparedEndpoint(_ep, true);\n        };\n\n        this.setPreparedEndpoint = function (ep, doNotRepaint) {\n            if (this.endpoint != null) {\n                this.endpoint.cleanup();\n                this.endpoint.destroy();\n            }\n            this.endpoint = ep;\n            this.type = this.endpoint.type;\n            this.canvas = this.endpoint.canvas;\n        };\n\n        _jp.extend(this, params, typeParameters);\n\n        this.isSource = params.isSource || false;\n        this.isTemporarySource = params.isTemporarySource || false;\n        this.isTarget = params.isTarget || false;\n\n        this.connections = params.connections || [];\n        this.connectorPointerEvents = params[\"connector-pointer-events\"];\n\n        this.scope = params.scope || _jsPlumb.getDefaultScope();\n        this.timestamp = null;\n        this.reattachConnections = params.reattach || _jsPlumb.Defaults.ReattachConnections;\n        this.connectionsDetachable = _jsPlumb.Defaults.ConnectionsDetachable;\n        if (params.connectionsDetachable === false || params.detachable === false) {\n            this.connectionsDetachable = false;\n        }\n        this.dragAllowedWhenFull = params.dragAllowedWhenFull !== false;\n\n        if (params.onMaxConnections) {\n            this.bind(\"maxConnections\", params.onMaxConnections);\n        }\n\n        //\n        // add a connection. not part of public API.\n        //\n        this.addConnection = function (connection) {\n            this.connections.push(connection);\n            this[(this.connections.length > 0 ? \"add\" : \"remove\") + \"Class\"](_jsPlumb.endpointConnectedClass);\n            this[(this.isFull() ? \"add\" : \"remove\") + \"Class\"](_jsPlumb.endpointFullClass);\n        };\n\n        this.detachFromConnection = function (connection, idx, doNotCleanup) {\n            idx = idx == null ? this.connections.indexOf(connection) : idx;\n            if (idx >= 0) {\n                this.connections.splice(idx, 1);\n                this[(this.connections.length > 0 ? \"add\" : \"remove\") + \"Class\"](_jsPlumb.endpointConnectedClass);\n                this[(this.isFull() ? \"add\" : \"remove\") + \"Class\"](_jsPlumb.endpointFullClass);\n            }\n\n            if (!doNotCleanup && deleteOnEmpty && this.connections.length === 0) {\n                _jsPlumb.deleteObject({\n                    endpoint: this,\n                    fireEvent: false,\n                    deleteAttachedObjects: doNotCleanup !== true\n                });\n            }\n        };\n\n        this.deleteEveryConnection = function(params) {\n            var c = this.connections.length;\n            for (var i = 0; i < c; i++) {\n                _jsPlumb.deleteConnection(this.connections[0], params);\n            }\n        };\n\n        this.detachFrom = function (targetEndpoint, fireEvent, originalEvent) {\n            var c = [];\n            for (var i = 0; i < this.connections.length; i++) {\n                if (this.connections[i].endpoints[1] === targetEndpoint || this.connections[i].endpoints[0] === targetEndpoint) {\n                    c.push(this.connections[i]);\n                }\n            }\n            for (var j = 0, count = c.length; j < count; j++) {\n                _jsPlumb.deleteConnection(c[0]);\n            }\n            return this;\n        };\n\n        this.getElement = function () {\n            return this.element;\n        };\n\n        this.setElement = function (el) {\n            var parentId = this._jsPlumb.instance.getId(el),\n                curId = this.elementId;\n            // remove the endpoint from the list for the current endpoint's element\n            _ju.removeWithFunction(params.endpointsByElement[this.elementId], function (e) {\n                return e.id === this.id;\n            }.bind(this));\n            this.element = _jp.getElement(el);\n            this.elementId = _jsPlumb.getId(this.element);\n            _jsPlumb.anchorManager.rehomeEndpoint(this, curId, this.element);\n            _jsPlumb.dragManager.endpointAdded(this.element);\n            _ju.addToList(params.endpointsByElement, parentId, this);\n            return this;\n        };\n\n        /**\n         * private but must be exposed.\n         */\n        this.makeInPlaceCopy = function () {\n            var loc = this.anchor.getCurrentLocation({element: this}),\n                o = this.anchor.getOrientation(this),\n                acc = this.anchor.getCssClass(),\n                inPlaceAnchor = {\n                    bind: function () {\n                    },\n                    compute: function () {\n                        return [ loc[0], loc[1] ];\n                    },\n                    getCurrentLocation: function () {\n                        return [ loc[0], loc[1] ];\n                    },\n                    getOrientation: function () {\n                        return o;\n                    },\n                    getCssClass: function () {\n                        return acc;\n                    }\n                };\n\n            return _newEndpoint({\n                dropOptions: params.dropOptions,\n                anchor: inPlaceAnchor,\n                source: this.element,\n                paintStyle: this.getPaintStyle(),\n                endpoint: params.hideOnDrag ? \"Blank\" : this.endpoint,\n                _transient: true,\n                scope: this.scope,\n                reference:this\n            });\n        };\n\n        /**\n         * returns a connection from the pool; used when dragging starts.  just gets the head of the array if it can.\n         */\n        this.connectorSelector = function () {\n            return this.connections[0];\n        };\n\n        this.setStyle = this.setPaintStyle;\n\n        this.paint = function (params) {\n            params = params || {};\n            var timestamp = params.timestamp, recalc = !(params.recalc === false);\n            if (!timestamp || this.timestamp !== timestamp) {\n\n                var info = _jsPlumb.updateOffset({ elId: this.elementId, timestamp: timestamp });\n\n                var xy = params.offset ? params.offset.o : info.o;\n                if (xy != null) {\n                    var ap = params.anchorPoint, connectorPaintStyle = params.connectorPaintStyle;\n                    if (ap == null) {\n                        var wh = params.dimensions || info.s,\n                            anchorParams = { xy: [ xy.left, xy.top ], wh: wh, element: this, timestamp: timestamp };\n                        if (recalc && this.anchor.isDynamic && this.connections.length > 0) {\n                            var c = findConnectionToUseForDynamicAnchor(this, params.elementWithPrecedence),\n                                oIdx = c.endpoints[0] === this ? 1 : 0,\n                                oId = oIdx === 0 ? c.sourceId : c.targetId,\n                                oInfo = _jsPlumb.getCachedData(oId),\n                                oOffset = oInfo.o, oWH = oInfo.s;\n\n                            anchorParams.index = oIdx === 0 ? 1 : 0;\n                            anchorParams.connection = c;\n                            anchorParams.txy = [ oOffset.left, oOffset.top ];\n                            anchorParams.twh = oWH;\n                            anchorParams.tElement = c.endpoints[oIdx];\n                        } else if (this.connections.length > 0) {\n                            anchorParams.connection = this.connections[0];\n                        }\n                        ap = this.anchor.compute(anchorParams);\n                    }\n\n                    this.endpoint.compute(ap, this.anchor.getOrientation(this), this._jsPlumb.paintStyleInUse, connectorPaintStyle || this.paintStyleInUse);\n                    this.endpoint.paint(this._jsPlumb.paintStyleInUse, this.anchor);\n                    this.timestamp = timestamp;\n\n                    // paint overlays\n                    for (var i in this._jsPlumb.overlays) {\n                        if (this._jsPlumb.overlays.hasOwnProperty(i)) {\n                            var o = this._jsPlumb.overlays[i];\n                            if (o.isVisible()) {\n                                this._jsPlumb.overlayPlacements[i] = o.draw(this.endpoint, this._jsPlumb.paintStyleInUse);\n                                o.paint(this._jsPlumb.overlayPlacements[i]);\n                            }\n                        }\n                    }\n                }\n            }\n        };\n\n        this.getTypeDescriptor = function () {\n            return \"endpoint\";\n        };\n        this.isVisible = function () {\n            return this._jsPlumb.visible;\n        };\n\n        this.repaint = this.paint;\n\n        var draggingInitialised = false;\n        this.initDraggable = function () {\n\n            // is this a connection source? we make it draggable and have the\n            // drag listener maintain a connection with a floating endpoint.\n            if (!draggingInitialised && _jp.isDragSupported(this.element)) {\n                var placeholderInfo = { id: null, element: null },\n                    jpc = null,\n                    existingJpc = false,\n                    existingJpcParams = null,\n                    _dragHandler = _makeConnectionDragHandler(this, placeholderInfo, _jsPlumb),\n                    dragOptions = params.dragOptions || {},\n                    defaultOpts = {},\n                    startEvent = _jp.dragEvents.start,\n                    stopEvent = _jp.dragEvents.stop,\n                    dragEvent = _jp.dragEvents.drag,\n                    beforeStartEvent = _jp.dragEvents.beforeStart,\n                    payload;\n\n                // respond to beforeStart from katavorio; this will have, optionally, a payload of attribute values\n                // that were placed there by the makeSource mousedown listener.\n                var beforeStart = function(beforeStartParams) {\n                    payload = beforeStartParams.e.payload || {};\n                };\n\n                var start = function (startParams) {\n\n// -------------   first, get a connection to drag. this may be null, in which case we are dragging a new one.\n\n                    jpc = this.connectorSelector();\n\n// -------------------------------- now a bunch of tests about whether or not to proceed -------------------------\n\n                    var _continue = true;\n                    // if not enabled, return\n                    if (!this.isEnabled()) {\n                        _continue = false;\n                    }\n                    // if no connection and we're not a source - or temporarily a source, as is the case with makeSource - return.\n                    if (jpc == null && !this.isSource && !this.isTemporarySource) {\n                        _continue = false;\n                    }\n                    // otherwise if we're full and not allowed to drag, also return false.\n                    if (this.isSource && this.isFull() && !(jpc != null && this.dragAllowedWhenFull)) {\n                        _continue = false;\n                    }\n                    // if the connection was setup as not detachable or one of its endpoints\n                    // was setup as connectionsDetachable = false, or Defaults.ConnectionsDetachable\n                    // is set to false...\n                    if (jpc != null && !jpc.isDetachable(this)) {\n                        // .. and the endpoint is full\n                        if (this.isFull()) {\n                            _continue = false;\n                        } else {\n                            // otherwise, if not full, set the connection to null, and we will now proceed\n                            // to drag a new connection.\n                            jpc = null;\n                        }\n                    }\n\n                    var beforeDrag = _jsPlumb.checkCondition(jpc == null ? \"beforeDrag\" : \"beforeStartDetach\", {\n                        endpoint:this,\n                        source:this.element,\n                        sourceId:this.elementId,\n                        connection:jpc\n                    });\n                    if (beforeDrag === false) {\n                        _continue = false;\n                    }\n                    // else we might have been given some data. we'll pass it in to a new connection as 'data'.\n                    // here we also merge in the optional payload we were given on mousedown.\n                    else if (typeof beforeDrag === \"object\") {\n                        _jp.extend(beforeDrag, payload || {});\n                    }\n                    else {\n                        // or if no beforeDrag data, maybe use the payload on its own.\n                        beforeDrag = payload || {};\n                    }\n\n                    if (_continue === false) {\n                        // this is for mootools and yui. returning false from this causes jquery to stop drag.\n                        // the events are wrapped in both mootools and yui anyway, but i don't think returning\n                        // false from the start callback would stop a drag.\n                        if (_jsPlumb.stopDrag) {\n                            _jsPlumb.stopDrag(this.canvas);\n                        }\n                        _dragHandler.stopDrag();\n                        return false;\n                    }\n\n// ---------------------------------------------------------------------------------------------------------------------\n\n                    // ok to proceed.\n\n                    // clear hover for all connections for this endpoint before continuing.\n                    for (var i = 0; i < this.connections.length; i++) {\n                        this.connections[i].setHover(false);\n                    }\n\n                    this.addClass(\"endpointDrag\");\n                    _jsPlumb.setConnectionBeingDragged(true);\n\n                    // if we're not full but there was a connection, make it null. we'll create a new one.\n                    if (jpc && !this.isFull() && this.isSource) {\n                        jpc = null;\n                    }\n\n                    _jsPlumb.updateOffset({ elId: this.elementId });\n\n// ----------------    make the element we will drag around, and position it -----------------------------\n\n                    var ipco = this._jsPlumb.instance.getOffset(this.canvas),\n                        canvasElement = this.canvas,\n                        ips = this._jsPlumb.instance.getSize(this.canvas);\n\n                    _makeDraggablePlaceholder(placeholderInfo, _jsPlumb, ipco, ips);\n\n                    // store the id of the dragging div and the source element. the drop function will pick these up.                   \n                    _jsPlumb.setAttributes(this.canvas, {\n                        \"dragId\": placeholderInfo.id,\n                        \"elId\": this.elementId\n                    });\n\n// ------------------- create an endpoint that will be our floating endpoint ------------------------------------\n\n                    var endpointToFloat = this.dragProxy || this.endpoint;\n                    if (this.dragProxy == null && this.connectionType != null) {\n                        var aae = this._jsPlumb.instance.deriveEndpointAndAnchorSpec(this.connectionType);\n                        if (aae.endpoints[1]) {\n                            endpointToFloat = aae.endpoints[1];\n                        }\n                    }\n                    var centerAnchor = this._jsPlumb.instance.makeAnchor(\"Center\");\n                    centerAnchor.isFloating = true;\n                    this._jsPlumb.floatingEndpoint = _makeFloatingEndpoint(this.getPaintStyle(), centerAnchor, endpointToFloat, this.canvas, placeholderInfo.element, _jsPlumb, _newEndpoint, this.scope);\n                    var _savedAnchor = this._jsPlumb.floatingEndpoint.anchor;\n\n\n                    if (jpc == null) {\n\n                        this.setHover(false, false);\n                        // create a connection. one end is this endpoint, the other is a floating endpoint.                    \n                        jpc = _newConnection({\n                            sourceEndpoint: this,\n                            targetEndpoint: this._jsPlumb.floatingEndpoint,\n                            source: this.element,  // for makeSource with parent option.  ensure source element is represented correctly.\n                            target: placeholderInfo.element,\n                            anchors: [ this.anchor, this._jsPlumb.floatingEndpoint.anchor ],\n                            paintStyle: params.connectorStyle, // this can be null. Connection will use the default.\n                            hoverPaintStyle: params.connectorHoverStyle,\n                            connector: params.connector, // this can also be null. Connection will use the default.\n                            overlays: params.connectorOverlays,\n                            type: this.connectionType,\n                            cssClass: this.connectorClass,\n                            hoverClass: this.connectorHoverClass,\n                            scope:params.scope,\n                            data:beforeDrag\n                        });\n                        jpc.pending = true;\n                        jpc.addClass(_jsPlumb.draggingClass);\n                        this._jsPlumb.floatingEndpoint.addClass(_jsPlumb.draggingClass);\n                        this._jsPlumb.floatingEndpoint.anchor = _savedAnchor;\n                        // fire an event that informs that a connection is being dragged\n                        _jsPlumb.fire(\"connectionDrag\", jpc);\n\n                        // register the new connection on the drag manager. This connection, at this point, is 'pending',\n                        // and has as its target a temporary element (the 'placeholder'). If the connection subsequently\n                        // becomes established, the anchor manager is informed that the target of the connection has\n                        // changed.\n\n                        _jsPlumb.router.newConnection(jpc);\n\n                    } else {\n                        existingJpc = true;\n                        jpc.setHover(false);\n                        // new anchor idx\n                        var anchorIdx = jpc.endpoints[0].id === this.id ? 0 : 1;\n                        this.detachFromConnection(jpc, null, true);                         // detach from the connection while dragging is occurring. but dont cleanup automatically.\n\n                        // store the original scope (issue 57)\n                        var dragScope = _jsPlumb.getDragScope(canvasElement);\n                        _jsPlumb.setAttribute(this.canvas, \"originalScope\", dragScope);\n\n                        // fire an event that informs that a connection is being dragged. we do this before\n                        // replacing the original target with the floating element info.\n                        _jsPlumb.fire(\"connectionDrag\", jpc);\n\n                        // now we replace ourselves with the temporary div we created above:\n                        if (anchorIdx === 0) {\n                            existingJpcParams = [ jpc.source, jpc.sourceId, canvasElement, dragScope ];\n                            _jsPlumb.router.sourceOrTargetChanged(jpc.endpoints[anchorIdx].elementId, placeholderInfo.id, jpc, placeholderInfo.element, 0);\n\n                        } else {\n                            existingJpcParams = [ jpc.target, jpc.targetId, canvasElement, dragScope ];\n                            _jsPlumb.router.sourceOrTargetChanged(jpc.endpoints[anchorIdx].elementId, placeholderInfo.id, jpc, placeholderInfo.element, 1);\n                        }\n\n                        // store the original endpoint and assign the new floating endpoint for the drag.\n                        jpc.suspendedEndpoint = jpc.endpoints[anchorIdx];\n\n                        // PROVIDE THE SUSPENDED ELEMENT, BE IT A SOURCE OR TARGET (ISSUE 39)\n                        jpc.suspendedElement = jpc.endpoints[anchorIdx].getElement();\n                        jpc.suspendedElementId = jpc.endpoints[anchorIdx].elementId;\n                        jpc.suspendedElementType = anchorIdx === 0 ? \"source\" : \"target\";\n\n                        jpc.suspendedEndpoint.setHover(false);\n                        this._jsPlumb.floatingEndpoint.referenceEndpoint = jpc.suspendedEndpoint;\n                        jpc.endpoints[anchorIdx] = this._jsPlumb.floatingEndpoint;\n\n                        jpc.addClass(_jsPlumb.draggingClass);\n                        this._jsPlumb.floatingEndpoint.addClass(_jsPlumb.draggingClass);\n                    }\n\n                    _jsPlumb.registerFloatingConnection(placeholderInfo, jpc, this._jsPlumb.floatingEndpoint);\n\n                    // tell jsplumb about it\n                    _jsPlumb.currentlyDragging = true;\n                }.bind(this);\n\n                var stop = function () {\n                    _jsPlumb.setConnectionBeingDragged(false);\n\n                    if (jpc && jpc.endpoints != null) {\n                        // get the actual drop event (decode from library args to stop function)\n                        var originalEvent = _jsPlumb.getDropEvent(arguments);\n                        // unlock the other endpoint (if it is dynamic, it would have been locked at drag start)\n                        var idx = _jsPlumb.getFloatingAnchorIndex(jpc);\n                        jpc.endpoints[idx === 0 ? 1 : 0].anchor.unlock();\n                        jpc.removeClass(_jsPlumb.draggingClass);\n                        // if we have the floating endpoint then the connection has not been dropped\n                        // on another endpoint.  If it is a new connection we throw it away. If it is an\n                        // existing connection we check to see if we should reattach it, throwing it away\n                        // if not.\n                        if (this._jsPlumb && (jpc.deleteConnectionNow || jpc.endpoints[idx] === this._jsPlumb.floatingEndpoint)) {\n                            // 6a. if the connection was an existing one...\n                            if (existingJpc && jpc.suspendedEndpoint) {\n                                // fix for issue35, thanks Sylvain Gizard: when firing the detach event make sure the\n                                // floating endpoint has been replaced.\n                                if (idx === 0) {\n                                    jpc.floatingElement = jpc.source;\n                                    jpc.floatingId = jpc.sourceId;\n                                    jpc.floatingEndpoint = jpc.endpoints[0];\n                                    jpc.floatingIndex = 0;\n                                    jpc.source = existingJpcParams[0];\n                                    jpc.sourceId = existingJpcParams[1];\n                                } else {\n                                    // keep a copy of the floating element; the anchor manager will want to clean up.\n                                    jpc.floatingElement = jpc.target;\n                                    jpc.floatingId = jpc.targetId;\n                                    jpc.floatingEndpoint = jpc.endpoints[1];\n                                    jpc.floatingIndex = 1;\n                                    jpc.target = existingJpcParams[0];\n                                    jpc.targetId = existingJpcParams[1];\n                                }\n\n                                var fe = this._jsPlumb.floatingEndpoint; // store for later removal.\n                                // restore the original scope (issue 57)\n                                _jsPlumb.setDragScope(existingJpcParams[2], existingJpcParams[3]);\n                                jpc.endpoints[idx] = jpc.suspendedEndpoint;\n                                // if the connection should be reattached, or the other endpoint refuses detach, then\n                                // reset the connection to its original state\n                                if (jpc.isReattach() || jpc._forceReattach || jpc._forceDetach || !_jsPlumb.deleteConnection(jpc, {originalEvent: originalEvent})) {\n\n                                    jpc.setHover(false);\n                                    jpc._forceDetach = null;\n                                    jpc._forceReattach = null;\n                                    this._jsPlumb.floatingEndpoint.detachFromConnection(jpc);\n                                    jpc.suspendedEndpoint.addConnection(jpc);\n\n                                    // TODO this code is duplicated in lots of places...and there is nothing external\n                                    // in the code; it all refers to the connection itself. we could add a\n                                    // `checkSanity(connection)` method to anchorManager that did this.\n                                    if (idx === 1) {\n                                        _jsPlumb.router.sourceOrTargetChanged(jpc.floatingId, jpc.targetId, jpc, jpc.target, idx);\n                                    }\n                                    else {\n                                        _jsPlumb.router.sourceOrTargetChanged(jpc.floatingId, jpc.sourceId, jpc, jpc.source, idx);\n                                    }\n\n                                    _jsPlumb.repaint(existingJpcParams[1]);\n                                }\n                                else {\n                                    _jsPlumb.deleteObject({endpoint: fe});\n                                }\n                            }\n                        }\n\n                        // makeTargets sets this flag, to tell us we have been replaced and should delete this object.\n                        if (this.deleteAfterDragStop) {\n                            _jsPlumb.deleteObject({endpoint: this});\n                        }\n                        else {\n                            if (this._jsPlumb) {\n                                 this.paint({recalc: false});\n                            }\n                        }\n\n                        // although the connection is no longer valid, there are use cases where this is useful.\n                        _jsPlumb.fire(\"connectionDragStop\", jpc, originalEvent);\n                        // fire this event to give people more fine-grained control (connectionDragStop fires a lot)\n                        if (jpc.pending) {\n                            _jsPlumb.fire(\"connectionAborted\", jpc, originalEvent);\n                        }\n                        // tell jsplumb that dragging is finished.\n                        _jsPlumb.currentlyDragging = false;\n                        jpc.suspendedElement = null;\n                        jpc.suspendedEndpoint = null;\n                        jpc = null;\n                    }\n\n                    // if no endpoints, jpc already cleaned up. but still we want to ensure we're reset properly.\n                    // remove the element associated with the floating endpoint\n                    // (and its associated floating endpoint and visual artefacts)\n                    if (placeholderInfo && placeholderInfo.element) {\n                        _jsPlumb.remove(placeholderInfo.element, false, false);\n                    }\n                    // remove the inplace copy\n                    if (inPlaceCopy) {\n                        _jsPlumb.deleteObject({endpoint: inPlaceCopy});\n                    }\n\n                    if (this._jsPlumb) {\n                        // make our canvas visible (TODO: hand off to library; we should not know about DOM)\n                        this.canvas.style.visibility = \"visible\";\n                        // unlock our anchor\n                        this.anchor.unlock();\n                        // clear floating anchor.\n                        this._jsPlumb.floatingEndpoint = null;\n                    }\n\n                }.bind(this);\n\n                dragOptions = _jp.extend(defaultOpts, dragOptions);\n                dragOptions.scope = this.scope || dragOptions.scope;\n                dragOptions[beforeStartEvent] = _ju.wrap(dragOptions[beforeStartEvent], beforeStart, false);\n                dragOptions[startEvent] = _ju.wrap(dragOptions[startEvent], start, false);\n                // extracted drag handler function so can be used by makeSource\n                dragOptions[dragEvent] = _ju.wrap(dragOptions[dragEvent], _dragHandler.drag);\n                dragOptions[stopEvent] = _ju.wrap(dragOptions[stopEvent], stop);\n                dragOptions.multipleDrop = false;\n\n                dragOptions.canDrag = function () {\n                    return this.isSource || this.isTemporarySource || (this.connections.length > 0 && this.connectionsDetachable !== false);\n                }.bind(this);\n\n                _jsPlumb.initDraggable(this.canvas, dragOptions, \"internal\");\n\n                this.canvas._jsPlumbRelatedElement = this.element;\n\n                draggingInitialised = true;\n            }\n        };\n\n        var ep = params.endpoint || this._jsPlumb.instance.Defaults.Endpoint || _jp.Defaults.Endpoint;\n        this.setEndpoint(ep, true);\n        var anchorParamsToUse = params.anchor ? params.anchor : params.anchors ? params.anchors : (_jsPlumb.Defaults.Anchor || \"Top\");\n        this.setAnchor(anchorParamsToUse, true);\n\n        // finally, set type if it was provided\n        var type = [ \"default\", (params.type || \"\")].join(\" \");\n        this.addType(type, params.data, true);\n        this.canvas = this.endpoint.canvas;\n        this.canvas._jsPlumb = this;\n\n        this.initDraggable();\n\n        // pulled this out into a function so we can reuse it for the inPlaceCopy canvas; you can now drop detached connections\n        // back onto the endpoint you detached it from.\n        var _initDropTarget = function (canvas, isTransient, endpoint, referenceEndpoint) {\n\n            if (_jp.isDropSupported(this.element)) {\n                var dropOptions = params.dropOptions || _jsPlumb.Defaults.DropOptions || _jp.Defaults.DropOptions;\n                dropOptions = _jp.extend({}, dropOptions);\n                dropOptions.scope = dropOptions.scope || this.scope;\n                var dropEvent = _jp.dragEvents.drop,\n                    overEvent = _jp.dragEvents.over,\n                    outEvent = _jp.dragEvents.out,\n                    _ep = this,\n                    drop = _jsPlumb.EndpointDropHandler({\n                        getEndpoint: function () {\n                            return _ep;\n                        },\n                        jsPlumb: _jsPlumb,\n                        enabled: function () {\n                            return endpoint != null ? endpoint.isEnabled() : true;\n                        },\n                        isFull: function () {\n                            return endpoint.isFull();\n                        },\n                        element: this.element,\n                        elementId: this.elementId,\n                        isSource: this.isSource,\n                        isTarget: this.isTarget,\n                        addClass: function (clazz) {\n                            _ep.addClass(clazz);\n                        },\n                        removeClass: function (clazz) {\n                            _ep.removeClass(clazz);\n                        },\n                        isDropAllowed: function () {\n                            return _ep.isDropAllowed.apply(_ep, arguments);\n                        },\n                        reference:referenceEndpoint,\n                        isRedrop:function(jpc, dhParams) {\n                            return jpc.suspendedEndpoint && dhParams.reference && (jpc.suspendedEndpoint.id === dhParams.reference.id);\n                        }\n                    });\n\n                dropOptions[dropEvent] = _ju.wrap(dropOptions[dropEvent], drop, true);\n                dropOptions[overEvent] = _ju.wrap(dropOptions[overEvent], function () {\n                    var draggable = _jp.getDragObject(arguments),\n                        id = _jsPlumb.getAttribute(_jp.getElement(draggable), \"dragId\"),\n                        _jpc = _jsPlumb.getFloatingConnectionFor(id);//_jsPlumb.floatingConnections[id];\n\n                    if (_jpc != null) {\n                        var idx = _jsPlumb.getFloatingAnchorIndex(_jpc);\n                        // here we should fire the 'over' event if we are a target and this is a new connection,\n                        // or we are the same as the floating endpoint.\n                        var _cont = (this.isTarget && idx !== 0) || (_jpc.suspendedEndpoint && this.referenceEndpoint && this.referenceEndpoint.id === _jpc.suspendedEndpoint.id);\n                        if (_cont) {\n                            var bb = _jsPlumb.checkCondition(\"checkDropAllowed\", {\n                                sourceEndpoint: _jpc.endpoints[idx],\n                                targetEndpoint: this,\n                                connection: _jpc\n                            });\n                            this[(bb ? \"add\" : \"remove\") + \"Class\"](_jsPlumb.endpointDropAllowedClass);\n                            this[(bb ? \"remove\" : \"add\") + \"Class\"](_jsPlumb.endpointDropForbiddenClass);\n                            _jpc.endpoints[idx].anchor.over(this.anchor, this);\n                        }\n                    }\n                }.bind(this));\n\n                dropOptions[outEvent] = _ju.wrap(dropOptions[outEvent], function () {\n                    var draggable = _jp.getDragObject(arguments),\n                        id = draggable == null ? null : _jsPlumb.getAttribute(_jp.getElement(draggable), \"dragId\"),\n                        _jpc = id ? _jsPlumb.getFloatingConnectionFor(id) : null;\n\n                    if (_jpc != null) {\n                        var idx = _jsPlumb.getFloatingAnchorIndex(_jpc);\n                        var _cont = (this.isTarget && idx !== 0) || (_jpc.suspendedEndpoint && this.referenceEndpoint && this.referenceEndpoint.id === _jpc.suspendedEndpoint.id);\n                        if (_cont) {\n                            this.removeClass(_jsPlumb.endpointDropAllowedClass);\n                            this.removeClass(_jsPlumb.endpointDropForbiddenClass);\n                            _jpc.endpoints[idx].anchor.out();\n                        }\n                    }\n                }.bind(this));\n\n                _jsPlumb.initDroppable(canvas, dropOptions, \"internal\", isTransient);\n            }\n        }.bind(this);\n\n        // Initialise the endpoint's canvas as a drop target. The drop handler will take care of the logic of whether\n        // something can actually be dropped.\n        if (!this.anchor.isFloating) {\n            _initDropTarget(this.canvas, !(params._transient || this.anchor.isFloating), this, params.reference);\n        }\n\n        return this;\n    };\n\n    _ju.extend(_jp.Endpoint, _jp.OverlayCapableJsPlumbUIComponent, {\n\n        setVisible: function (v, doNotChangeConnections, doNotNotifyOtherEndpoint) {\n            this._jsPlumb.visible = v;\n            if (this.canvas) {\n                this.canvas.style.display = v ? \"block\" : \"none\";\n            }\n            this[v ? \"showOverlays\" : \"hideOverlays\"]();\n            if (!doNotChangeConnections) {\n                for (var i = 0; i < this.connections.length; i++) {\n                    this.connections[i].setVisible(v);\n                    if (!doNotNotifyOtherEndpoint) {\n                        var oIdx = this === this.connections[i].endpoints[0] ? 1 : 0;\n                        // only change the other endpoint if this is its only connection.\n                        if (this.connections[i].endpoints[oIdx].connections.length === 1) {\n                            this.connections[i].endpoints[oIdx].setVisible(v, true, true);\n                        }\n                    }\n                }\n            }\n        },\n        getAttachedElements: function () {\n            return this.connections;\n        },\n        applyType: function (t, doNotRepaint) {\n            this.setPaintStyle(t.endpointStyle || t.paintStyle, doNotRepaint);\n            this.setHoverPaintStyle(t.endpointHoverStyle || t.hoverPaintStyle, doNotRepaint);\n            if (t.maxConnections != null) {\n                this._jsPlumb.maxConnections = t.maxConnections;\n            }\n            if (t.scope) {\n                this.scope = t.scope;\n            }\n            _jp.extend(this, t, typeParameters);\n            if (t.cssClass != null && this.canvas) {\n                this._jsPlumb.instance.addClass(this.canvas, t.cssClass);\n            }\n            _jp.OverlayCapableJsPlumbUIComponent.applyType(this, t);\n        },\n        isEnabled: function () {\n            return this._jsPlumb.enabled;\n        },\n        setEnabled: function (e) {\n            this._jsPlumb.enabled = e;\n        },\n        cleanup: function () {\n            var anchorClass = this._jsPlumb.instance.endpointAnchorClassPrefix + (this._jsPlumb.currentAnchorClass ? \"-\" + this._jsPlumb.currentAnchorClass : \"\");\n            _jp.removeClass(this.element, anchorClass);\n            this.anchor = null;\n            this.endpoint.cleanup(true);\n            this.endpoint.destroy();\n            this.endpoint = null;\n            // drag/drop\n            this._jsPlumb.instance.destroyDraggable(this.canvas, \"internal\");\n            this._jsPlumb.instance.destroyDroppable(this.canvas, \"internal\");\n        },\n        setHover: function (h) {\n            if (this.endpoint && this._jsPlumb && !this._jsPlumb.instance.isConnectionBeingDragged()) {\n                this.endpoint.setHover(h);\n            }\n        },\n        isFull: function () {\n            return this._jsPlumb.maxConnections === 0 ? true : !(this.isFloating() || this._jsPlumb.maxConnections < 0 || this.connections.length < this._jsPlumb.maxConnections);\n        },\n        /**\n         * private but needs to be exposed.\n         */\n        isFloating: function () {\n            return this.anchor != null && this.anchor.isFloating;\n        },\n        isConnectedTo: function (endpoint) {\n            var found = false;\n            if (endpoint) {\n                for (var i = 0; i < this.connections.length; i++) {\n                    if (this.connections[i].endpoints[1] === endpoint || this.connections[i].endpoints[0] === endpoint) {\n                        found = true;\n                        break;\n                    }\n                }\n            }\n            return found;\n        },\n        getConnectionCost: function () {\n            return this._jsPlumb.connectionCost;\n        },\n        setConnectionCost: function (c) {\n            this._jsPlumb.connectionCost = c;\n        },\n        areConnectionsDirected: function () {\n            return this._jsPlumb.connectionsDirected;\n        },\n        setConnectionsDirected: function (b) {\n            this._jsPlumb.connectionsDirected = b;\n        },\n        setElementId: function (_elId) {\n            this.elementId = _elId;\n            this.anchor.elementId = _elId;\n        },\n        setReferenceElement: function (_el) {\n            this.element = _jp.getElement(_el);\n        },\n        setDragAllowedWhenFull: function (allowed) {\n            this.dragAllowedWhenFull = allowed;\n        },\n        equals: function (endpoint) {\n            return this.anchor.equals(endpoint.anchor);\n        },\n        getUuid: function () {\n            return this._jsPlumb.uuid;\n        },\n        computeAnchor: function (params) {\n            return this.anchor.compute(params);\n        }\n    });\n\n    root.jsPlumbInstance.prototype.EndpointDropHandler = function (dhParams) {\n        return function (e) {\n\n            var _jsPlumb = dhParams.jsPlumb;\n\n            // remove the classes that are added dynamically. drop is neither forbidden nor allowed now that\n            // the drop is finishing.\n            dhParams.removeClass(_jsPlumb.endpointDropAllowedClass);\n            dhParams.removeClass(_jsPlumb.endpointDropForbiddenClass);\n\n            var originalEvent = _jsPlumb.getDropEvent(arguments),\n                draggable = _jsPlumb.getDragObject(arguments),\n                id = _jsPlumb.getAttribute(draggable, \"dragId\"),\n                elId = _jsPlumb.getAttribute(draggable, \"elId\"),\n                scope = _jsPlumb.getAttribute(draggable, \"originalScope\"),\n                jpc = _jsPlumb.getFloatingConnectionFor(id);\n\n            // if no active connection, bail.\n            if (jpc == null) {\n                return;\n            }\n\n            // calculate if this is an existing connection.\n            var existingConnection = jpc.suspendedEndpoint != null;\n\n            // if suspended endpoint exists but has been cleaned up, bail. This means it's an existing connection\n            // that has been detached and will shortly be discarded.\n            if (existingConnection && jpc.suspendedEndpoint._jsPlumb == null) {\n                return;\n            }\n\n            // get the drop endpoint. for a normal connection this is just the one that would replace the currently\n            // floating endpoint. for a makeTarget this is a new endpoint that is created on drop. But we leave that to\n            // the handler to figure out.\n            var _ep = dhParams.getEndpoint(jpc);\n\n            // If we're not given an endpoint to use, bail.\n            if (_ep == null) {\n                return;\n            }\n\n            // if this is a drop back where the connection came from, mark it force reattach and\n            // return; the stop handler will reattach. without firing an event.\n            if (dhParams.isRedrop(jpc, dhParams)) {\n                jpc._forceReattach = true;\n                jpc.setHover(false);\n                if (dhParams.maybeCleanup) {\n                    dhParams.maybeCleanup(_ep);\n                }\n                return;\n            }\n\n            // ensure we dont bother trying to drop sources on non-source eps, and same for target.\n            var idx = _jsPlumb.getFloatingAnchorIndex(jpc);\n            if ((idx === 0 && !dhParams.isSource)|| (idx === 1 && !dhParams.isTarget)){\n                if (dhParams.maybeCleanup) {\n                    dhParams.maybeCleanup(_ep);\n                }\n                return;\n            }\n\n            if (dhParams.onDrop) {\n                dhParams.onDrop(jpc);\n            }\n\n            // restore the original scope if necessary (issue 57)\n            if (scope) {\n                _jsPlumb.setDragScope(draggable, scope);\n            }\n\n            // if the target of the drop is full, fire an event (we abort below)\n            // makeTarget: keep.\n            var isFull = dhParams.isFull(e);\n            if (isFull) {\n                _ep.fire(\"maxConnections\", {\n                    endpoint: this,\n                    connection: jpc,\n                    maxConnections: _ep._jsPlumb.maxConnections\n                }, originalEvent);\n            }\n            //\n            // if endpoint enabled, not full, and matches the index of the floating endpoint...\n            if (!isFull &&  dhParams.enabled()) {\n                var _doContinue = true;\n\n                // before testing for beforeDrop, reset the connection's source/target to be the actual DOM elements\n                // involved (that is, stash any temporary stuff used for dragging. but we need to keep it around in\n                // order that the anchor manager can clean things up properly).\n                if (idx === 0) {\n                    jpc.floatingElement = jpc.source;\n                    jpc.floatingId = jpc.sourceId;\n                    jpc.floatingEndpoint = jpc.endpoints[0];\n                    jpc.floatingIndex = 0;\n                    jpc.source = dhParams.element;\n                    jpc.sourceId = _jsPlumb.getId(dhParams.element);\n                } else {\n                    jpc.floatingElement = jpc.target;\n                    jpc.floatingId = jpc.targetId;\n                    jpc.floatingEndpoint = jpc.endpoints[1];\n                    jpc.floatingIndex = 1;\n                    jpc.target = dhParams.element;\n                    jpc.targetId = _jsPlumb.getId(dhParams.element);\n                }\n\n                // if this is an existing connection and detach is not allowed we won't continue. The connection's\n                // endpoints have been reinstated; everything is back to how it was.\n                if (existingConnection && jpc.suspendedEndpoint.id !== _ep.id) {\n                    if (!jpc.isDetachAllowed(jpc) || !jpc.endpoints[idx].isDetachAllowed(jpc) || !jpc.suspendedEndpoint.isDetachAllowed(jpc) || !_jsPlumb.checkCondition(\"beforeDetach\", jpc)) {\n                        _doContinue = false;\n                    }\n                }\n\n// ------------ wrap the execution path in a function so we can support asynchronous beforeDrop\n\n                var continueFunction = function (optionalData) {\n                    // remove this jpc from the current endpoint, which is a floating endpoint that we will\n                    // subsequently discard.\n                    jpc.endpoints[idx].detachFromConnection(jpc);\n\n                    // if there's a suspended endpoint, detach it from the connection.\n                    if (jpc.suspendedEndpoint) {\n                        jpc.suspendedEndpoint.detachFromConnection(jpc);\n                    }\n\n                    jpc.endpoints[idx] = _ep;\n                    _ep.addConnection(jpc);\n\n                    // copy our parameters in to the connection:\n                    var params = _ep.getParameters();\n                    for (var aParam in params) {\n                        jpc.setParameter(aParam, params[aParam]);\n                    }\n\n                    if (!existingConnection) {\n                        // if not an existing connection and\n                        if (params.draggable) {\n                            _jsPlumb.initDraggable(this.element, dhParams.dragOptions, \"internal\", _jsPlumb);\n                        }\n                    }\n                    else {\n                        var suspendedElementId = jpc.suspendedEndpoint.elementId;\n                        _jsPlumb.fireMoveEvent({\n                            index: idx,\n                            originalSourceId: idx === 0 ? suspendedElementId : jpc.sourceId,\n                            newSourceId: idx === 0 ? _ep.elementId : jpc.sourceId,\n                            originalTargetId: idx === 1 ? suspendedElementId : jpc.targetId,\n                            newTargetId: idx === 1 ? _ep.elementId : jpc.targetId,\n                            originalSourceEndpoint: idx === 0 ? jpc.suspendedEndpoint : jpc.endpoints[0],\n                            newSourceEndpoint: idx === 0 ? _ep : jpc.endpoints[0],\n                            originalTargetEndpoint: idx === 1 ? jpc.suspendedEndpoint : jpc.endpoints[1],\n                            newTargetEndpoint: idx === 1 ? _ep : jpc.endpoints[1],\n                            connection: jpc\n                        }, originalEvent);\n                    }\n\n                    if (idx === 1) {\n                        _jsPlumb.router.sourceOrTargetChanged(jpc.floatingId, jpc.targetId, jpc, jpc.target, 1);\n                    }\n                    else {\n                        _jsPlumb.router.sourceOrTargetChanged(jpc.floatingId, jpc.sourceId, jpc, jpc.source, 0);\n                    }\n\n                    // when makeSource has uniqueEndpoint:true, we want to create connections with new endpoints\n                    // that are subsequently deleted. So makeSource sets `finalEndpoint`, which is the Endpoint to\n                    // which the connection should be attached. The `detachFromConnection` call below results in the\n                    // temporary endpoint being cleaned up.\n                    if (jpc.endpoints[0].finalEndpoint) {\n                        var _toDelete = jpc.endpoints[0];\n                        _toDelete.detachFromConnection(jpc);\n                        jpc.endpoints[0] = jpc.endpoints[0].finalEndpoint;\n                        jpc.endpoints[0].addConnection(jpc);\n                    }\n\n                    // if optionalData was given, merge it onto the connection's data.\n                    if (_ju.isObject(optionalData)) {\n                        jpc.mergeData(optionalData);\n                    }\n                    // finalise will inform the anchor manager and also add to\n                    // connectionsByScope if necessary.\n                    _jsPlumb.finaliseConnection(jpc, null, originalEvent, false);\n                    jpc.setHover(false);\n\n                    // SP continuous anchor flush\n                    _jsPlumb.revalidate(jpc.endpoints[0].element);\n\n                }.bind(this);\n\n                var dontContinueFunction = function () {\n                    // otherwise just put it back on the endpoint it was on before the drag.\n                    if (jpc.suspendedEndpoint) {\n                        jpc.endpoints[idx] = jpc.suspendedEndpoint;\n                        jpc.setHover(false);\n                        jpc._forceDetach = true;\n                        if (idx === 0) {\n                            jpc.source = jpc.suspendedEndpoint.element;\n                            jpc.sourceId = jpc.suspendedEndpoint.elementId;\n                        } else {\n                            jpc.target = jpc.suspendedEndpoint.element;\n                            jpc.targetId = jpc.suspendedEndpoint.elementId;\n                        }\n                        jpc.suspendedEndpoint.addConnection(jpc);\n\n                        // TODO checkSanity\n                        if (idx === 1) {\n                            _jsPlumb.router.sourceOrTargetChanged(jpc.floatingId, jpc.targetId, jpc, jpc.target, 1);\n                        }\n                        else {\n                            _jsPlumb.router.sourceOrTargetChanged(jpc.floatingId, jpc.sourceId, jpc, jpc.source, 0);\n                        }\n\n                        _jsPlumb.repaint(jpc.sourceId);\n                        jpc._forceDetach = false;\n                    }\n                };\n\n// --------------------------------------\n                // now check beforeDrop.  this will be available only on Endpoints that are setup to\n                // have a beforeDrop condition (although, secretly, under the hood all Endpoints and\n                // the Connection have them, because they are on jsPlumbUIComponent.  shhh!), because\n                // it only makes sense to have it on a target endpoint.\n                _doContinue = _doContinue && dhParams.isDropAllowed(jpc.sourceId, jpc.targetId, jpc.scope, jpc, _ep);// && jpc.pending;\n\n                if (_doContinue) {\n                    continueFunction(_doContinue);\n                    return true;\n                }\n                else {\n                    dontContinueFunction();\n                }\n            }\n\n            if (dhParams.maybeCleanup) {\n                dhParams.maybeCleanup(_ep);\n            }\n\n            _jsPlumb.currentlyDragging = false;\n        };\n    };\n}).call(typeof window !== 'undefined' ? window : this);\n\n/*\n * This file contains the code for Connections.\n *\n * Copyright (c) 2010 - 2020 jsPlumb (hello@jsplumbtoolkit.com)\n *\n * https://jsplumbtoolkit.com\n * https://github.com/jsplumb/jsplumb\n *\n * Dual licensed under the MIT and GPL2 licenses.\n */\n;\n(function () {\n\n    \"use strict\";\n    var root = this,\n        _jp = root.jsPlumb,\n        _ju = root.jsPlumbUtil;\n\n    var makeConnector = function (_jsPlumb, renderMode, connectorName, connectorArgs, forComponent) {\n            // first make sure we have a cache for the specified renderer\n            _jp.Connectors[renderMode] = _jp.Connectors[renderMode] || {};\n\n            // now see if the one we want exists; if not we will try to make it\n            if (_jp.Connectors[renderMode][connectorName] == null) {\n\n                if (_jp.Connectors[connectorName] == null) {\n                    if (!_jsPlumb.Defaults.DoNotThrowErrors) {\n                        throw new TypeError(\"jsPlumb: unknown connector type '\" + connectorName + \"'\");\n                    } else {\n                        return null;\n                    }\n                }\n\n                _jp.Connectors[renderMode][connectorName] = function() {\n                    _jp.Connectors[connectorName].apply(this, arguments);\n                    _jp.ConnectorRenderers[renderMode].apply(this, arguments);\n                };\n\n                _ju.extend(_jp.Connectors[renderMode][connectorName], [ _jp.Connectors[connectorName], _jp.ConnectorRenderers[renderMode]]);\n\n            }\n\n            return new _jp.Connectors[renderMode][connectorName](connectorArgs, forComponent);\n        },\n        _makeAnchor = function (anchorParams, elementId, _jsPlumb) {\n            return (anchorParams) ? _jsPlumb.makeAnchor(anchorParams, elementId, _jsPlumb) : null;\n        },\n        _updateConnectedClass = function (conn, element, _jsPlumb, remove) {\n            if (element != null) {\n                element._jsPlumbConnections = element._jsPlumbConnections || {};\n                if (remove) {\n                    delete element._jsPlumbConnections[conn.id];\n                }\n                else {\n                    element._jsPlumbConnections[conn.id] = true;\n                }\n\n                if (_ju.isEmpty(element._jsPlumbConnections)) {\n                    _jsPlumb.removeClass(element, _jsPlumb.connectedClass);\n                }\n                else {\n                    _jsPlumb.addClass(element, _jsPlumb.connectedClass);\n                }\n            }\n        };\n\n    _jp.Connection = function (params) {\n        var _newEndpoint = params.newEndpoint;\n\n        this.id = params.id;\n        this.connector = null;\n        this.idPrefix = \"_jsplumb_c_\";\n        this.defaultLabelLocation = 0.5;\n        this.defaultOverlayKeys = [\"Overlays\", \"ConnectionOverlays\"];\n        // if a new connection is the result of moving some existing connection, params.previousConnection\n        // will have that Connection in it. listeners for the jsPlumbConnection event can look for that\n        // member and take action if they need to.\n        this.previousConnection = params.previousConnection;\n        this.source = _jp.getElement(params.source);\n        this.target = _jp.getElement(params.target);\n\n\n        _jp.OverlayCapableJsPlumbUIComponent.apply(this, arguments);\n\n        // sourceEndpoint and targetEndpoint override source/target, if they are present. but \n        // source is not overridden if the Endpoint has declared it is not the final target of a connection;\n        // instead we use the source that the Endpoint declares will be the final source element.\n        if (params.sourceEndpoint) {\n            this.source = params.sourceEndpoint.getElement();\n            this.sourceId = params.sourceEndpoint.elementId;\n        } else {\n            this.sourceId = this._jsPlumb.instance.getId(this.source);\n        }\n\n        if (params.targetEndpoint) {\n            this.target = params.targetEndpoint.getElement();\n            this.targetId = params.targetEndpoint.elementId;\n        } else {\n            this.targetId = this._jsPlumb.instance.getId(this.target);\n        }\n\n\n        this.scope = params.scope; // scope may have been passed in to the connect call. if it wasn't, we will pull it from the source endpoint, after having initialised the endpoints.            \n        this.endpoints = [];\n        this.endpointStyles = [];\n\n        var _jsPlumb = this._jsPlumb.instance;\n\n        _jsPlumb.manage(this.sourceId, this.source);\n        _jsPlumb.manage(this.targetId, this.target);\n\n        this._jsPlumb.visible = true;\n\n        this._jsPlumb.params = {\n            cssClass: params.cssClass,\n            container: params.container,\n            \"pointer-events\": params[\"pointer-events\"],\n            editorParams: params.editorParams,\n            overlays: params.overlays\n        };\n        this._jsPlumb.lastPaintedAt = null;\n\n        // listen to mouseover and mouseout events passed from the container delegate.\n        this.bind(\"mouseover\", function () {\n            this.setHover(true);\n        }.bind(this));\n        this.bind(\"mouseout\", function () {\n            this.setHover(false);\n        }.bind(this));\n\n\n// INITIALISATION CODE\n\n        this.makeEndpoint = function (isSource, el, elId, ep, definition) {\n            elId = elId || this._jsPlumb.instance.getId(el);\n            return this.prepareEndpoint(_jsPlumb, _newEndpoint, this, ep, isSource ? 0 : 1, params, el, elId, definition);\n        };\n\n        // if type given, get the endpoint definitions mapping to that type from the jsplumb instance, and use those.\n        // we apply types at the end of this constructor but endpoints are only honoured in a type definition at\n        // create time.\n        if (params.type) {\n            params.endpoints = params.endpoints || this._jsPlumb.instance.deriveEndpointAndAnchorSpec(params.type).endpoints;\n        }\n\n        var eS = this.makeEndpoint(true, this.source, this.sourceId, params.sourceEndpoint),\n            eT = this.makeEndpoint(false, this.target, this.targetId, params.targetEndpoint);\n\n        if (eS) {\n            _ju.addToList(params.endpointsByElement, this.sourceId, eS);\n        }\n        if (eT) {\n            _ju.addToList(params.endpointsByElement, this.targetId, eT);\n        }\n        // if scope not set, set it to be the scope for the source endpoint.\n        if (!this.scope) {\n            this.scope = this.endpoints[0].scope;\n        }\n\n        // if explicitly told to (or not to) delete endpoints when empty, override endpoint's preferences\n        if (params.deleteEndpointsOnEmpty != null) {\n            this.endpoints[0].setDeleteOnEmpty(params.deleteEndpointsOnEmpty);\n            this.endpoints[1].setDeleteOnEmpty(params.deleteEndpointsOnEmpty);\n        }\n\n// -------------------------- DEFAULT TYPE ---------------------------------------------\n\n        // DETACHABLE\n        var _detachable = _jsPlumb.Defaults.ConnectionsDetachable;\n        if (params.detachable === false) {\n            _detachable = false;\n        }\n        if (this.endpoints[0].connectionsDetachable === false) {\n            _detachable = false;\n        }\n        if (this.endpoints[1].connectionsDetachable === false) {\n            _detachable = false;\n        }\n        // REATTACH\n        var _reattach = params.reattach || this.endpoints[0].reattachConnections || this.endpoints[1].reattachConnections || _jsPlumb.Defaults.ReattachConnections;\n\n        this.appendToDefaultType({\n            detachable: _detachable,\n            reattach: _reattach,\n            paintStyle:this.endpoints[0].connectorStyle || this.endpoints[1].connectorStyle || params.paintStyle || _jsPlumb.Defaults.PaintStyle || _jp.Defaults.PaintStyle,\n            hoverPaintStyle:this.endpoints[0].connectorHoverStyle || this.endpoints[1].connectorHoverStyle || params.hoverPaintStyle || _jsPlumb.Defaults.HoverPaintStyle || _jp.Defaults.HoverPaintStyle\n        });\n\n        var _suspendedAt = _jsPlumb.getSuspendedAt();\n        if (!_jsPlumb.isSuspendDrawing()) {\n            // paint the endpoints\n            var myInfo = _jsPlumb.getCachedData(this.sourceId),\n                myOffset = myInfo.o, myWH = myInfo.s,\n                otherInfo = _jsPlumb.getCachedData(this.targetId),\n                otherOffset = otherInfo.o,\n                otherWH = otherInfo.s,\n                initialTimestamp = _suspendedAt || _jsPlumb.timestamp(),\n                anchorLoc = this.endpoints[0].anchor.compute({\n                    xy: [ myOffset.left, myOffset.top ], wh: myWH, element: this.endpoints[0],\n                    elementId: this.endpoints[0].elementId,\n                    txy: [ otherOffset.left, otherOffset.top ], twh: otherWH, tElement: this.endpoints[1],\n                    timestamp: initialTimestamp\n                });\n\n            this.endpoints[0].paint({ anchorLoc: anchorLoc, timestamp: initialTimestamp });\n\n            anchorLoc = this.endpoints[1].anchor.compute({\n                xy: [ otherOffset.left, otherOffset.top ], wh: otherWH, element: this.endpoints[1],\n                elementId: this.endpoints[1].elementId,\n                txy: [ myOffset.left, myOffset.top ], twh: myWH, tElement: this.endpoints[0],\n                timestamp: initialTimestamp\n            });\n            this.endpoints[1].paint({ anchorLoc: anchorLoc, timestamp: initialTimestamp });\n        }\n\n        this.getTypeDescriptor = function () {\n            return \"connection\";\n        };\n        this.getAttachedElements = function () {\n            return this.endpoints;\n        };\n\n        this.isDetachable = function (ep) {\n            return this._jsPlumb.detachable === false ? false : ep != null ? ep.connectionsDetachable === true : this._jsPlumb.detachable === true;\n        };\n        this.setDetachable = function (detachable) {\n            this._jsPlumb.detachable = detachable === true;\n        };\n        this.isReattach = function () {\n            return this._jsPlumb.reattach === true || this.endpoints[0].reattachConnections === true || this.endpoints[1].reattachConnections === true;\n        };\n        this.setReattach = function (reattach) {\n            this._jsPlumb.reattach = reattach === true;\n        };\n\n// END INITIALISATION CODE\n\n\n// COST + DIRECTIONALITY\n        // if cost not supplied, try to inherit from source endpoint\n        this._jsPlumb.cost = params.cost || this.endpoints[0].getConnectionCost();\n        this._jsPlumb.directed = params.directed;\n        // inherit directed flag if set no source endpoint\n        if (params.directed == null) {\n            this._jsPlumb.directed = this.endpoints[0].areConnectionsDirected();\n        }\n// END COST + DIRECTIONALITY\n\n// PARAMETERS\n        // merge all the parameters objects into the connection.  parameters set\n        // on the connection take precedence; then source endpoint params, then\n        // finally target endpoint params.\n        var _p = _jp.extend({}, this.endpoints[1].getParameters());\n        _jp.extend(_p, this.endpoints[0].getParameters());\n        _jp.extend(_p, this.getParameters());\n        this.setParameters(_p);\n// END PARAMETERS\n\n// PAINTING\n\n        this.setConnector(this.endpoints[0].connector || this.endpoints[1].connector || params.connector || _jsPlumb.Defaults.Connector || _jp.Defaults.Connector, true);\n        var data = params.data == null || !_ju.isObject(params.data) ? {} : params.data;\n        this.getData = function() { return data; };\n        this.setData = function(d) { data = d || {}; };\n        this.mergeData = function(d) { data = _jp.extend(data, d); };\n\n        // the very last thing we do is apply types, if there are any.\n        var _types = [ \"default\", this.endpoints[0].connectionType, this.endpoints[1].connectionType,  params.type ].join(\" \");\n        if (/[^\\s]/.test(_types)) {\n            this.addType(_types, params.data, true);\n        }\n\n        this.updateConnectedClass();\n\n// END PAINTING    \n    };\n\n    _ju.extend(_jp.Connection, _jp.OverlayCapableJsPlumbUIComponent, {\n        applyType: function (t, doNotRepaint, typeMap) {\n\n            var _connector = null;\n            if (t.connector != null) {\n                _connector = this.getCachedTypeItem(\"connector\", typeMap.connector);\n                if (_connector == null) {\n                    _connector = this.prepareConnector(t.connector, typeMap.connector);\n                    this.cacheTypeItem(\"connector\", _connector, typeMap.connector);\n                }\n                this.setPreparedConnector(_connector);\n            }\n\n            // none of these things result in the creation of objects so can be ignored.\n            if (t.detachable != null) {\n                this.setDetachable(t.detachable);\n            }\n            if (t.reattach != null) {\n                this.setReattach(t.reattach);\n            }\n            if (t.scope) {\n                this.scope = t.scope;\n            }\n\n            if (t.cssClass != null && this.canvas) {\n                this._jsPlumb.instance.addClass(this.canvas, t.cssClass);\n            }\n\n            var _anchors = null;\n            // this also results in the creation of objects.\n            if (t.anchor) {\n                // note that even if the param was anchor, we store `anchors`.\n                _anchors = this.getCachedTypeItem(\"anchors\", typeMap.anchor);\n                if (_anchors == null) {\n                    _anchors = [ this._jsPlumb.instance.makeAnchor(t.anchor), this._jsPlumb.instance.makeAnchor(t.anchor) ];\n                    this.cacheTypeItem(\"anchors\", _anchors, typeMap.anchor);\n                }\n            }\n            else if (t.anchors) {\n                _anchors = this.getCachedTypeItem(\"anchors\", typeMap.anchors);\n                if (_anchors == null) {\n                    _anchors = [\n                        this._jsPlumb.instance.makeAnchor(t.anchors[0]),\n                        this._jsPlumb.instance.makeAnchor(t.anchors[1])\n                    ];\n                    this.cacheTypeItem(\"anchors\", _anchors, typeMap.anchors);\n                }\n            }\n            if (_anchors != null) {\n                this.endpoints[0].anchor = _anchors[0];\n                this.endpoints[1].anchor = _anchors[1];\n                if (this.endpoints[1].anchor.isDynamic) {\n                    this._jsPlumb.instance.repaint(this.endpoints[1].elementId);\n                }\n            }\n\n            _jp.OverlayCapableJsPlumbUIComponent.applyType(this, t);\n        },\n        addClass: function (c, informEndpoints) {\n            if (informEndpoints) {\n                this.endpoints[0].addClass(c);\n                this.endpoints[1].addClass(c);\n                if (this.suspendedEndpoint) {\n                    this.suspendedEndpoint.addClass(c);\n                }\n            }\n            if (this.connector) {\n                this.connector.addClass(c);\n            }\n        },\n        removeClass: function (c, informEndpoints) {\n            if (informEndpoints) {\n                this.endpoints[0].removeClass(c);\n                this.endpoints[1].removeClass(c);\n                if (this.suspendedEndpoint) {\n                    this.suspendedEndpoint.removeClass(c);\n                }\n            }\n            if (this.connector) {\n                this.connector.removeClass(c);\n            }\n        },\n        isVisible: function () {\n            return this._jsPlumb.visible;\n        },\n        setVisible: function (v) {\n            this._jsPlumb.visible = v;\n            if (this.connector) {\n                this.connector.setVisible(v);\n            }\n            this.repaint();\n        },\n        cleanup: function () {\n            this.updateConnectedClass(true);\n            this.endpoints = null;\n            this.source = null;\n            this.target = null;\n            if (this.connector != null) {\n                this.connector.cleanup(true);\n                this.connector.destroy(true);\n            }\n            this.connector = null;\n        },\n        updateConnectedClass:function(remove) {\n            if (this._jsPlumb) {\n                _updateConnectedClass(this, this.source, this._jsPlumb.instance, remove);\n                _updateConnectedClass(this, this.target, this._jsPlumb.instance, remove);\n            }\n        },\n        setHover: function (state) {\n            if (this.connector && this._jsPlumb && !this._jsPlumb.instance.isConnectionBeingDragged()) {\n                this.connector.setHover(state);\n                root.jsPlumb[state ? \"addClass\" : \"removeClass\"](this.source, this._jsPlumb.instance.hoverSourceClass);\n                root.jsPlumb[state ? \"addClass\" : \"removeClass\"](this.target, this._jsPlumb.instance.hoverTargetClass);\n            }\n        },\n        getUuids:function() {\n            return [ this.endpoints[0].getUuid(), this.endpoints[1].getUuid() ];\n        },\n        getCost: function () {\n            return this._jsPlumb ? this._jsPlumb.cost : -Infinity;\n        },\n        setCost: function (c) {\n            this._jsPlumb.cost = c;\n        },\n        isDirected: function () {\n            return this._jsPlumb.directed;\n        },\n        getConnector: function () {\n            return this.connector;\n        },\n        prepareConnector:function(connectorSpec, typeId) {\n            var connectorArgs = {\n                    _jsPlumb: this._jsPlumb.instance,\n                    cssClass: this._jsPlumb.params.cssClass,\n                    container: this._jsPlumb.params.container,\n                    \"pointer-events\": this._jsPlumb.params[\"pointer-events\"]\n                },\n                renderMode = this._jsPlumb.instance.getRenderMode(),\n                connector;\n\n            if (_ju.isString(connectorSpec)) {\n                connector = makeConnector(this._jsPlumb.instance, renderMode, connectorSpec, connectorArgs, this);\n            } // lets you use a string as shorthand.\n            else if (_ju.isArray(connectorSpec)) {\n                if (connectorSpec.length === 1) {\n                    connector = makeConnector(this._jsPlumb.instance, renderMode, connectorSpec[0], connectorArgs, this);\n                }\n                else {\n                    connector = makeConnector(this._jsPlumb.instance, renderMode, connectorSpec[0], _ju.merge(connectorSpec[1], connectorArgs), this);\n                }\n            }\n            if (typeId != null) {\n                connector.typeId = typeId;\n            }\n            return connector;\n        },\n        setPreparedConnector: function(connector, doNotRepaint, doNotChangeListenerComponent, typeId) {\n\n            if (this.connector !== connector) {\n\n                var previous, previousClasses = \"\";\n                // the connector will not be cleaned up if it was set as part of a type, because `typeId` will be set on it\n                // and we havent passed in `true` for \"force\" here.\n                if (this.connector != null) {\n                    previous = this.connector;\n                    previousClasses = previous.getClass();\n                    this.connector.cleanup();\n                    this.connector.destroy();\n                }\n\n                this.connector = connector;\n                if (typeId) {\n                    this.cacheTypeItem(\"connector\", connector, typeId);\n                }\n\n                this.canvas = this.connector.canvas;\n                this.bgCanvas = this.connector.bgCanvas;\n\n                this.connector.reattach(this._jsPlumb.instance);\n\n                // put classes from prior connector onto the canvas\n                this.addClass(previousClasses);\n\n                // new: instead of binding listeners per connector, we now just have one delegate on the container.\n                // so for that handler we set the connection as the '_jsPlumb' member of the canvas element, and\n                // bgCanvas, if it exists, which it does right now in the VML renderer, so it won't from v 2.0.0 onwards.\n                if (this.canvas) {\n                    this.canvas._jsPlumb = this;\n                }\n                if (this.bgCanvas) {\n                    this.bgCanvas._jsPlumb = this;\n                }\n\n                if (previous != null) {\n                    var o = this.getOverlays();\n                    for (var i = 0; i < o.length; i++) {\n                        if (o[i].transfer) {\n                            o[i].transfer(this.connector);\n                        }\n                    }\n                }\n\n                if (!doNotChangeListenerComponent) {\n                    this.setListenerComponent(this.connector);\n                }\n                if (!doNotRepaint) {\n                    this.repaint();\n                }\n            }\n        },\n        setConnector: function (connectorSpec, doNotRepaint, doNotChangeListenerComponent, typeId) {\n            var connector = this.prepareConnector(connectorSpec, typeId);\n            this.setPreparedConnector(connector, doNotRepaint, doNotChangeListenerComponent, typeId);\n        },\n        paint: function (params) {\n\n            if (!this._jsPlumb.instance.isSuspendDrawing() && this._jsPlumb.visible) {\n                params = params || {};\n                var timestamp = params.timestamp,\n                // if the moving object is not the source we must transpose the two references.\n                    swap = false,\n                    tId = swap ? this.sourceId : this.targetId, sId = swap ? this.targetId : this.sourceId,\n                    tIdx = swap ? 0 : 1, sIdx = swap ? 1 : 0;\n\n                if (timestamp == null || timestamp !== this._jsPlumb.lastPaintedAt) {\n                    var sourceInfo = this._jsPlumb.instance.updateOffset({elId:sId}).o,\n                        targetInfo = this._jsPlumb.instance.updateOffset({elId:tId}).o,\n                        sE = this.endpoints[sIdx], tE = this.endpoints[tIdx];\n\n                    var sAnchorP = sE.anchor.getCurrentLocation({xy: [sourceInfo.left, sourceInfo.top], wh: [sourceInfo.width, sourceInfo.height], element: sE, timestamp: timestamp}),\n                        tAnchorP = tE.anchor.getCurrentLocation({xy: [targetInfo.left, targetInfo.top], wh: [targetInfo.width, targetInfo.height], element: tE, timestamp: timestamp});\n\n                    this.connector.resetBounds();\n\n                    this.connector.compute({\n                        sourcePos: sAnchorP,\n                        targetPos: tAnchorP,\n                        sourceOrientation:sE.anchor.getOrientation(sE),\n                        targetOrientation:tE.anchor.getOrientation(tE),\n                        sourceEndpoint: this.endpoints[sIdx],\n                        targetEndpoint: this.endpoints[tIdx],\n                        \"stroke-width\": this._jsPlumb.paintStyleInUse.strokeWidth,\n                        sourceInfo: sourceInfo,\n                        targetInfo: targetInfo\n                    });\n\n                    var extents = {\n                        xmin: Math.min(this.connector.bounds.minX),\n                        ymin: Math.min(this.connector.bounds.minY),\n                        xmax: Math.max(this.connector.bounds.maxX),\n                        ymax: Math.max(this.connector.bounds.maxY)\n                    };\n\n                    // paint the connector.\n                    this.connector.paintExtents = extents;\n                    this.connector.paint(this._jsPlumb.paintStyleInUse, null, extents);\n\n                    // paint overlays. since 2.14.0 we do not need to do this first as we now use overflow:visible on the\n                    // jtk-connector class, which avoids things being clipped.\n                    for (var i in this._jsPlumb.overlays) {\n                        if (this._jsPlumb.overlays.hasOwnProperty(i)) {\n                            var o = this._jsPlumb.overlays[i];\n                            if (o.isVisible()) {\n                                this._jsPlumb.overlayPlacements[i] = o.draw(this.connector, this._jsPlumb.paintStyleInUse, this.getAbsoluteOverlayPosition(o));\n                                o.paint(this._jsPlumb.overlayPlacements[i], extents);\n                            }\n                        }\n                    }\n                }\n                this._jsPlumb.lastPaintedAt = timestamp;\n            }\n        },\n        repaint: function (params) {\n            var p = jsPlumb.extend(params || {}, {});\n            p.elId = this.sourceId;\n            this.paint(p);\n        },\n        prepareEndpoint: function (_jsPlumb, _newEndpoint, conn, existing, index, params, element, elementId, definition) {\n            var e;\n            if (existing) {\n                conn.endpoints[index] = existing;\n                existing.addConnection(conn);\n            } else {\n                if (!params.endpoints) {\n                    params.endpoints = [ null, null ];\n                }\n                var ep = definition || params.endpoints[index] || params.endpoint || _jsPlumb.Defaults.Endpoints[index] || _jp.Defaults.Endpoints[index] || _jsPlumb.Defaults.Endpoint || _jp.Defaults.Endpoint;\n                if (!params.endpointStyles) {\n                    params.endpointStyles = [ null, null ];\n                }\n                if (!params.endpointHoverStyles) {\n                    params.endpointHoverStyles = [ null, null ];\n                }\n                var es = params.endpointStyles[index] || params.endpointStyle || _jsPlumb.Defaults.EndpointStyles[index] || _jp.Defaults.EndpointStyles[index] || _jsPlumb.Defaults.EndpointStyle || _jp.Defaults.EndpointStyle;\n                // Endpoints derive their fill from the connector's stroke, if no fill was specified.\n                if (es.fill == null && params.paintStyle != null) {\n                    es.fill = params.paintStyle.stroke;\n                }\n\n                if (es.outlineStroke == null && params.paintStyle != null) {\n                    es.outlineStroke = params.paintStyle.outlineStroke;\n                }\n                if (es.outlineWidth == null && params.paintStyle != null) {\n                    es.outlineWidth = params.paintStyle.outlineWidth;\n                }\n\n                var ehs = params.endpointHoverStyles[index] || params.endpointHoverStyle || _jsPlumb.Defaults.EndpointHoverStyles[index] || _jp.Defaults.EndpointHoverStyles[index] || _jsPlumb.Defaults.EndpointHoverStyle || _jp.Defaults.EndpointHoverStyle;\n                // endpoint hover fill style is derived from connector's hover stroke style\n                if (params.hoverPaintStyle != null) {\n                    if (ehs == null) {\n                        ehs = {};\n                    }\n                    if (ehs.fill == null) {\n                        ehs.fill = params.hoverPaintStyle.stroke;\n                    }\n                }\n                var a = params.anchors ? params.anchors[index] :\n                        params.anchor ? params.anchor :\n                            _makeAnchor(_jsPlumb.Defaults.Anchors[index], elementId, _jsPlumb) ||\n                            _makeAnchor(_jp.Defaults.Anchors[index], elementId, _jsPlumb) ||\n                            _makeAnchor(_jsPlumb.Defaults.Anchor, elementId, _jsPlumb) ||\n                            _makeAnchor(_jp.Defaults.Anchor, elementId, _jsPlumb),\n                    u = params.uuids ? params.uuids[index] : null;\n\n                e = _newEndpoint({\n                    paintStyle: es, hoverPaintStyle: ehs, endpoint: ep, connections: [ conn ],\n                    uuid: u, anchor: a, source: element, scope: params.scope,\n                    reattach: params.reattach || _jsPlumb.Defaults.ReattachConnections,\n                    detachable: params.detachable || _jsPlumb.Defaults.ConnectionsDetachable\n                });\n                if (existing == null) {\n                    e.setDeleteOnEmpty(true);\n                }\n                conn.endpoints[index] = e;\n\n                if (params.drawEndpoints === false) {\n                    e.setVisible(false, true, true);\n                }\n\n            }\n            return e;\n        },\n        replaceEndpoint:function(idx, endpointDef) {\n\n            var current = this.endpoints[idx],\n                elId = current.elementId,\n                ebe = this._jsPlumb.instance.getEndpoints(elId),\n                _idx = ebe.indexOf(current),\n                _new = this.makeEndpoint(idx === 0, current.element, elId, null, endpointDef);\n\n            this.endpoints[idx] = _new;\n\n            ebe.splice(_idx, 1, _new);\n            this._jsPlumb.instance.deleteObject({endpoint:current, deleteAttachedObjects:false});\n            this._jsPlumb.instance.fire(\"endpointReplaced\", {previous:current, current:_new});\n\n            this._jsPlumb.instance.router.sourceOrTargetChanged(this.endpoints[1].elementId, this.endpoints[1].elementId, this, this.endpoints[1].element, 1);\n\n        }\n\n    }); // END Connection class            \n}).call(typeof window !== 'undefined' ? window : this);\n\n/*\n * This file contains the code for creating and manipulating anchors.\n *\n * Copyright (c) 2010 - 2020 jsPlumb (hello@jsplumbtoolkit.com)\n *\n * https://jsplumbtoolkit.com\n * https://github.com/jsplumb/jsplumb\n *\n * Dual licensed under the MIT and GPL2 licenses.\n */\n;\n(function () {\n\n    \"use strict\";\n\n    var root = this,\n        _ju = root.jsPlumbUtil,\n        _jp = root.jsPlumb;\n\n    //\n    // manages anchors for all elements.\n    //\n    _jp.AnchorManager = function (params) {\n        var _amEndpoints = {},\n            continuousAnchorLocations = {},\n            continuousAnchorOrientations = {},\n            connectionsByElementId = {},\n            self = this,\n            anchorLists = {},\n            jsPlumbInstance = params.jsPlumbInstance,\n            floatingConnections = {},\n            // used by placeAnchors function\n            placeAnchorsOnLine = function (desc, elementDimensions, elementPosition, connections, horizontal, otherMultiplier, reverse) {\n                var a = [], step = elementDimensions[horizontal ? 0 : 1] / (connections.length + 1);\n\n                for (var i = 0; i < connections.length; i++) {\n                    var val = (i + 1) * step, other = otherMultiplier * elementDimensions[horizontal ? 1 : 0];\n                    if (reverse) {\n                        val = elementDimensions[horizontal ? 0 : 1] - val;\n                    }\n\n                    var dx = (horizontal ? val : other), x = elementPosition[0] + dx, xp = dx / elementDimensions[0],\n                        dy = (horizontal ? other : val), y = elementPosition[1] + dy, yp = dy / elementDimensions[1];\n\n                    a.push([ x, y, xp, yp, connections[i][1], connections[i][2] ]);\n                }\n\n                return a;\n            },\n            rightAndBottomSort = function(a, b) {\n                return b[0][0] - a[0][0];\n            },\n            // used by edgeSortFunctions\n            leftAndTopSort = function (a, b) {\n                var p1 = a[0][0] < 0 ? -Math.PI - a[0][0] : Math.PI - a[0][0],\n                    p2 = b[0][0] < 0 ? -Math.PI - b[0][0] : Math.PI - b[0][0];\n\n                return p1 - p2;\n            },\n            // used by placeAnchors\n            edgeSortFunctions = {\n                \"top\":leftAndTopSort,\n                \"right\": rightAndBottomSort,\n                \"bottom\": rightAndBottomSort,\n                \"left\": leftAndTopSort\n            },\n            // used by placeAnchors\n            _sortHelper = function (_array, _fn) {\n                return _array.sort(_fn);\n            },\n            // used by AnchorManager.redraw\n            placeAnchors = function (elementId, _anchorLists) {\n                var cd = jsPlumbInstance.getCachedData(elementId), sS = cd.s, sO = cd.o,\n                    placeSomeAnchors = function (desc, elementDimensions, elementPosition, unsortedConnections, isHorizontal, otherMultiplier, orientation) {\n                        if (unsortedConnections.length > 0) {\n                            var sc = _sortHelper(unsortedConnections, edgeSortFunctions[desc]), // puts them in order based on the target element's pos on screen\n                                reverse = desc === \"right\" || desc === \"top\",\n                                anchors = placeAnchorsOnLine(desc, elementDimensions,\n                                    elementPosition, sc,\n                                    isHorizontal, otherMultiplier, reverse);\n\n                            // takes a computed anchor position and adjusts it for parent offset and scroll, then stores it.\n                            var _setAnchorLocation = function (endpoint, anchorPos) {\n                                continuousAnchorLocations[endpoint.id] = [ anchorPos[0], anchorPos[1], anchorPos[2], anchorPos[3] ];\n                                continuousAnchorOrientations[endpoint.id] = orientation;\n                            };\n\n                            for (var i = 0; i < anchors.length; i++) {\n                                var c = anchors[i][4], weAreSource = c.endpoints[0].elementId === elementId, weAreTarget = c.endpoints[1].elementId === elementId;\n                                if (weAreSource) {\n                                    _setAnchorLocation(c.endpoints[0], anchors[i]);\n                                }\n                                if (weAreTarget) {\n                                    _setAnchorLocation(c.endpoints[1], anchors[i]);\n                                }\n                            }\n                        }\n                    };\n\n                placeSomeAnchors(\"bottom\", sS, [sO.left, sO.top], _anchorLists.bottom, true, 1, [0, 1]);\n                placeSomeAnchors(\"top\", sS, [sO.left, sO.top], _anchorLists.top, true, 0, [0, -1]);\n                placeSomeAnchors(\"left\", sS, [sO.left, sO.top], _anchorLists.left, false, 0, [-1, 0]);\n                placeSomeAnchors(\"right\", sS, [sO.left, sO.top], _anchorLists.right, false, 1, [1, 0]);\n            };\n\n        this.reset = function () {\n            _amEndpoints = {};\n            connectionsByElementId = {};\n            anchorLists = {};\n        };\n        this.addFloatingConnection = function (key, conn) {\n            floatingConnections[key] = conn;\n        };\n        this.newConnection = function (conn) {\n            var sourceId = conn.sourceId, targetId = conn.targetId,\n                ep = conn.endpoints,\n                doRegisterTarget = true,\n                registerConnection = function (otherIndex, otherEndpoint, otherAnchor, elId, c) {\n                    if ((sourceId === targetId) && otherAnchor.isContinuous) {\n                        // remove the target endpoint's canvas.  we dont need it.\n                        conn._jsPlumb.instance.removeElement(ep[1].canvas);\n                        doRegisterTarget = false;\n                    }\n                    _ju.addToList(connectionsByElementId, elId, [c, otherEndpoint, otherAnchor.constructor === _jp.DynamicAnchor]);\n                };\n\n            registerConnection(0, ep[0], ep[0].anchor, targetId, conn);\n            if (doRegisterTarget) {\n                registerConnection(1, ep[1], ep[1].anchor, sourceId, conn);\n            }\n        };\n        var removeEndpointFromAnchorLists = function (endpoint) {\n            (function (list, eId) {\n                if (list) {  // transient anchors dont get entries in this list.\n                    var f = function (e) {\n                        return e[4] === eId;\n                    };\n                    _ju.removeWithFunction(list.top, f);\n                    _ju.removeWithFunction(list.left, f);\n                    _ju.removeWithFunction(list.bottom, f);\n                    _ju.removeWithFunction(list.right, f);\n                }\n            })(anchorLists[endpoint.elementId], endpoint.id);\n        };\n        this.connectionDetached = function (connInfo, doNotRedraw) {\n            var connection = connInfo.connection || connInfo,\n                sourceId = connInfo.sourceId,\n                targetId = connInfo.targetId,\n                ep = connection.endpoints,\n                removeConnection = function (otherIndex, otherEndpoint, otherAnchor, elId, c) {\n                    _ju.removeWithFunction(connectionsByElementId[elId], function (_c) {\n                        return _c[0].id === c.id;\n                    });\n                };\n\n            removeConnection(1, ep[1], ep[1].anchor, sourceId, connection);\n            removeConnection(0, ep[0], ep[0].anchor, targetId, connection);\n            if (connection.floatingId) {\n                removeConnection(connection.floatingIndex, connection.floatingEndpoint, connection.floatingEndpoint.anchor, connection.floatingId, connection);\n                removeEndpointFromAnchorLists(connection.floatingEndpoint);\n            }\n\n            // remove from anchorLists\n            removeEndpointFromAnchorLists(connection.endpoints[0]);\n            removeEndpointFromAnchorLists(connection.endpoints[1]);\n\n            if (!doNotRedraw) {\n                self.redraw(connection.sourceId);\n                if (connection.targetId !== connection.sourceId) {\n                    self.redraw(connection.targetId);\n                }\n            }\n        };\n        this.add = function (endpoint, elementId) {\n            _ju.addToList(_amEndpoints, elementId, endpoint);\n        };\n        this.changeId = function (oldId, newId) {\n            connectionsByElementId[newId] = connectionsByElementId[oldId];\n            _amEndpoints[newId] = _amEndpoints[oldId];\n            delete connectionsByElementId[oldId];\n            delete _amEndpoints[oldId];\n        };\n        this.getConnectionsFor = function (elementId) {\n            return connectionsByElementId[elementId] || [];\n        };\n        this.getEndpointsFor = function (elementId) {\n            return _amEndpoints[elementId] || [];\n        };\n        this.deleteEndpoint = function (endpoint) {\n            _ju.removeWithFunction(_amEndpoints[endpoint.elementId], function (e) {\n                return e.id === endpoint.id;\n            });\n            removeEndpointFromAnchorLists(endpoint);\n        };\n        this.elementRemoved = function (elementId) {\n            delete floatingConnections[elementId];\n            delete _amEndpoints[elementId];\n            _amEndpoints[elementId] = [];\n        };\n        // updates the given anchor list by either updating an existing anchor's info, or adding it. this function\n        // also removes the anchor from its previous list, if the edge it is on has changed.\n        // all connections found along the way (those that are connected to one of the faces this function\n        // operates on) are added to the connsToPaint list, as are their endpoints. in this way we know to repaint\n        // them wthout having to calculate anything else about them.\n        var _updateAnchorList = function (lists, theta, order, conn, aBoolean, otherElId, idx, reverse, edgeId, elId, connsToPaint, endpointsToPaint) {\n            // first try to find the exact match, but keep track of the first index of a matching element id along the way.s\n            var exactIdx = -1,\n                firstMatchingElIdx = -1,\n                endpoint = conn.endpoints[idx],\n                endpointId = endpoint.id,\n                oIdx = [1, 0][idx],\n                values = [\n                    [ theta, order ],\n                    conn,\n                    aBoolean,\n                    otherElId,\n                    endpointId\n                ],\n                listToAddTo = lists[edgeId],\n                listToRemoveFrom = endpoint._continuousAnchorEdge ? lists[endpoint._continuousAnchorEdge] : null,\n                i,\n                candidate;\n\n            if (listToRemoveFrom) {\n                var rIdx = _ju.findWithFunction(listToRemoveFrom, function (e) {\n                    return e[4] === endpointId;\n                });\n                if (rIdx !== -1) {\n                    listToRemoveFrom.splice(rIdx, 1);\n                    // get all connections from this list\n                    for (i = 0; i < listToRemoveFrom.length; i++) {\n                        candidate = listToRemoveFrom[i][1];\n                        _ju.addWithFunction(connsToPaint, candidate, function (c) {\n                            return c.id === candidate.id;\n                        });\n                        _ju.addWithFunction(endpointsToPaint, listToRemoveFrom[i][1].endpoints[idx], function (e) {\n                            return e.id === candidate.endpoints[idx].id;\n                        });\n                        _ju.addWithFunction(endpointsToPaint, listToRemoveFrom[i][1].endpoints[oIdx], function (e) {\n                            return e.id === candidate.endpoints[oIdx].id;\n                        });\n                    }\n                }\n            }\n\n            for (i = 0; i < listToAddTo.length; i++) {\n                candidate = listToAddTo[i][1];\n                if (params.idx === 1 && listToAddTo[i][3] === otherElId && firstMatchingElIdx === -1) {\n                    firstMatchingElIdx = i;\n                }\n                _ju.addWithFunction(connsToPaint, candidate, function (c) {\n                    return c.id === candidate.id;\n                });\n                _ju.addWithFunction(endpointsToPaint, listToAddTo[i][1].endpoints[idx], function (e) {\n                    return e.id === candidate.endpoints[idx].id;\n                });\n                _ju.addWithFunction(endpointsToPaint, listToAddTo[i][1].endpoints[oIdx], function (e) {\n                    return e.id === candidate.endpoints[oIdx].id;\n                });\n            }\n            if (exactIdx !== -1) {\n                listToAddTo[exactIdx] = values;\n            }\n            else {\n                var insertIdx = reverse ? firstMatchingElIdx !== -1 ? firstMatchingElIdx : 0 : listToAddTo.length; // of course we will get this from having looked through the array shortly.\n                listToAddTo.splice(insertIdx, 0, values);\n            }\n\n            // store this for next time.\n            endpoint._continuousAnchorEdge = edgeId;\n        };\n\n        //\n        // Notification that the connection given has changed source/target from the originalId to the newId.\n        //\n        // For a change of source this involves:\n        // 1. removing the connection from the list of connections stored for the originalId\n        // 2. updating the source information for the target of the connection\n        // 3. re-registering the connection in connectionsByElementId with the newId\n        //\n        // For a change of target this means find the entry in an endpoint's list for this connection and update its target endpoint\n        // with the current target in the connection.\n        //\n        this.sourceOrTargetChanged = function (originalId, newId, connection, newElement, anchorIndex) {\n            if (anchorIndex === 0) {\n                if (originalId !== newId) {\n\n                    connection.sourceId = newId;\n                    connection.source = newElement;\n\n                    // remove the entry that points from the old source to the target\n                    _ju.removeWithFunction(connectionsByElementId[originalId], function (info) {\n                        return info[0].id === connection.id;\n                    });\n                    // find entry for target and update it\n                    var tIdx = _ju.findWithFunction(connectionsByElementId[connection.targetId], function (i) {\n                        return i[0].id === connection.id;\n                    });\n                    if (tIdx > -1) {\n                        connectionsByElementId[connection.targetId][tIdx][0] = connection;\n                        connectionsByElementId[connection.targetId][tIdx][1] = connection.endpoints[0];\n                        connectionsByElementId[connection.targetId][tIdx][2] = connection.endpoints[0].anchor.constructor === _jp.DynamicAnchor;\n                    }\n                    // add entry for new source\n                    _ju.addToList(connectionsByElementId, newId, [connection, connection.endpoints[1], connection.endpoints[1].anchor.constructor === _jp.DynamicAnchor]);\n\n                    // TODO SP not final on this yet. when a user drags an existing connection and it turns into a self\n                    // loop, then this code hides the target endpoint (by removing it from the DOM) But I think this should\n                    // occur only if the anchor is Continuous\n                    if (connection.endpoints[1].anchor.isContinuous) {\n                        if (connection.source === connection.target) {\n                            connection._jsPlumb.instance.removeElement(connection.endpoints[1].canvas);\n                        } else {\n                            if (connection.endpoints[1].canvas.parentNode == null) {\n                                connection._jsPlumb.instance.appendElement(connection.endpoints[1].canvas);\n                            }\n                        }\n                    }\n\n                    connection.updateConnectedClass();\n                }\n            } else if (anchorIndex === 1) {\n                var sourceElId = connection.endpoints[0].elementId;\n\n                connection.target = newElement;\n                connection.targetId = newId;\n\n                var sIndex = _ju.findWithFunction(connectionsByElementId[sourceElId], function (i) {\n                        return i[0].id === connection.id;\n                    }),\n                    tIndex = _ju.findWithFunction(connectionsByElementId[originalId], function (i) {\n                        return i[0].id === connection.id;\n                    });\n\n                // update or add data for source\n                if (sIndex !== -1) {\n                    connectionsByElementId[sourceElId][sIndex][0] = connection;\n                    connectionsByElementId[sourceElId][sIndex][1] = connection.endpoints[1];\n                    connectionsByElementId[sourceElId][sIndex][2] = connection.endpoints[1].anchor.constructor === _jp.DynamicAnchor;\n                }\n\n                // remove entry for previous target (if there)\n                if (tIndex > -1) {\n                    connectionsByElementId[originalId].splice(tIndex, 1);\n                    // add entry for new target\n                    _ju.addToList(connectionsByElementId, newId, [connection, connection.endpoints[0], connection.endpoints[0].anchor.constructor === _jp.DynamicAnchor]);\n                }\n\n                connection.updateConnectedClass();\n            }\n        };\n\n        //\n        // moves the given endpoint from `currentId` to `element`.\n        // This involves:\n        //\n        // 1. changing the key in _amEndpoints under which the endpoint is stored\n        // 2. changing the source or target values in all of the endpoint's connections\n        // 3. changing the array in connectionsByElementId in which the endpoint's connections\n        //    are stored (done by either sourceChanged or updateOtherEndpoint)\n        //\n        this.rehomeEndpoint = function (ep, currentId, element) {\n            var eps = _amEndpoints[currentId] || [],\n                elementId = jsPlumbInstance.getId(element);\n\n            if (elementId !== currentId) {\n                var idx = eps.indexOf(ep);\n                if (idx > -1) {\n                    var _ep = eps.splice(idx, 1)[0];\n                    self.add(_ep, elementId);\n                }\n            }\n\n            for (var i = 0; i < ep.connections.length; i++) {\n                if (ep.connections[i].sourceId === currentId) {\n                    self.sourceOrTargetChanged(currentId, ep.elementId, ep.connections[i], ep.element, 0);\n                }\n                else if (ep.connections[i].targetId === currentId) {\n                    self.sourceOrTargetChanged(currentId, ep.elementId, ep.connections[i], ep.element, 1);\n                }\n            }\n        };\n\n        this.redraw = function (elementId, ui, timestamp, offsetToUI, clearEdits, doNotRecalcEndpoint) {\n\n            if (!jsPlumbInstance.isSuspendDrawing()) {\n                // get all the endpoints for this element\n                var ep = _amEndpoints[elementId] || [],\n                    endpointConnections = connectionsByElementId[elementId] || [],\n                    connectionsToPaint = [],\n                    endpointsToPaint = [],\n                    anchorsToUpdate = [];\n\n                timestamp = timestamp || jsPlumbInstance.timestamp();\n                // offsetToUI are values that would have been calculated in the dragManager when registering\n                // an endpoint for an element that had a parent (somewhere in the hierarchy) that had been\n                // registered as draggable.\n                offsetToUI = offsetToUI || {left: 0, top: 0};\n                if (ui) {\n                    ui = {\n                        left: ui.left + offsetToUI.left,\n                        top: ui.top + offsetToUI.top\n                    };\n                }\n\n                // valid for one paint cycle.\n                var myOffset = jsPlumbInstance.updateOffset({ elId: elementId, offset: ui, recalc: false, timestamp: timestamp }),\n                    orientationCache = {};\n\n                // actually, first we should compute the orientation of this element to all other elements to which\n                // this element is connected with a continuous anchor (whether both ends of the connection have\n                // a continuous anchor or just one)\n\n                for (var i = 0; i < endpointConnections.length; i++) {\n                    var conn = endpointConnections[i][0],\n                        sourceId = conn.sourceId,\n                        targetId = conn.targetId,\n                        sourceContinuous = conn.endpoints[0].anchor.isContinuous,\n                        targetContinuous = conn.endpoints[1].anchor.isContinuous;\n\n                    if (sourceContinuous || targetContinuous) {\n                        var oKey = sourceId + \"_\" + targetId,\n                            o = orientationCache[oKey],\n                            oIdx = conn.sourceId === elementId ? 1 : 0;\n\n                        if (sourceContinuous && !anchorLists[sourceId]) {\n                            anchorLists[sourceId] = { top: [], right: [], bottom: [], left: [] };\n                        }\n                        if (targetContinuous && !anchorLists[targetId]) {\n                            anchorLists[targetId] = { top: [], right: [], bottom: [], left: [] };\n                        }\n\n                        if (elementId !== targetId) {\n                            jsPlumbInstance.updateOffset({ elId: targetId, timestamp: timestamp });\n                        }\n                        if (elementId !== sourceId) {\n                            jsPlumbInstance.updateOffset({ elId: sourceId, timestamp: timestamp });\n                        }\n\n                        var td = jsPlumbInstance.getCachedData(targetId),\n                            sd = jsPlumbInstance.getCachedData(sourceId);\n\n                        if (targetId === sourceId && (sourceContinuous || targetContinuous)) {\n                            // here we may want to improve this by somehow determining the face we'd like\n                            // to put the connector on.  ideally, when drawing, the face should be calculated\n                            // by determining which face is closest to the point at which the mouse button\n                            // was released.  for now, we're putting it on the top face.\n                            _updateAnchorList( anchorLists[sourceId], -Math.PI / 2, 0, conn, false, targetId, 0, false, \"top\", sourceId, connectionsToPaint, endpointsToPaint);\n                            _updateAnchorList( anchorLists[targetId], -Math.PI / 2, 0, conn, false, sourceId, 1, false, \"top\", targetId, connectionsToPaint, endpointsToPaint);\n                        }\n                        else {\n                            if (!o) {\n                                o = this.calculateOrientation(sourceId, targetId, sd.o, td.o, conn.endpoints[0].anchor, conn.endpoints[1].anchor, conn);\n                                orientationCache[oKey] = o;\n                                // this would be a performance enhancement, but the computed angles need to be clamped to\n                                //the (-PI/2 -> PI/2) range in order for the sorting to work properly.\n                                /*  orientationCache[oKey2] = {\n                                 orientation:o.orientation,\n                                 a:[o.a[1], o.a[0]],\n                                 theta:o.theta + Math.PI,\n                                 theta2:o.theta2 + Math.PI\n                                 };*/\n                            }\n                            if (sourceContinuous) {\n                                _updateAnchorList(anchorLists[sourceId], o.theta, 0, conn, false, targetId, 0, false, o.a[0], sourceId, connectionsToPaint, endpointsToPaint);\n                            }\n                            if (targetContinuous) {\n                                _updateAnchorList(anchorLists[targetId], o.theta2, -1, conn, true, sourceId, 1, true, o.a[1], targetId, connectionsToPaint, endpointsToPaint);\n                            }\n                        }\n\n                        if (sourceContinuous) {\n                            _ju.addWithFunction(anchorsToUpdate, sourceId, function (a) {\n                                return a === sourceId;\n                            });\n                        }\n                        if (targetContinuous) {\n                            _ju.addWithFunction(anchorsToUpdate, targetId, function (a) {\n                                return a === targetId;\n                            });\n                        }\n                        _ju.addWithFunction(connectionsToPaint, conn, function (c) {\n                            return c.id === conn.id;\n                        });\n                        if ((sourceContinuous && oIdx === 0) || (targetContinuous && oIdx === 1)) {\n                            _ju.addWithFunction(endpointsToPaint, conn.endpoints[oIdx], function (e) {\n                                return e.id === conn.endpoints[oIdx].id;\n                            });\n                        }\n                    }\n                }\n\n                // place Endpoints whose anchors are continuous but have no Connections\n                for (i = 0; i < ep.length; i++) {\n                    if (ep[i].connections.length === 0 && ep[i].anchor.isContinuous) {\n                        if (!anchorLists[elementId]) {\n                            anchorLists[elementId] = { top: [], right: [], bottom: [], left: [] };\n                        }\n                        _updateAnchorList(anchorLists[elementId], -Math.PI / 2, 0, {endpoints: [ep[i], ep[i]], paint: function () {\n                        }}, false, elementId, 0, false, ep[i].anchor.getDefaultFace(), elementId, connectionsToPaint, endpointsToPaint);\n                        _ju.addWithFunction(anchorsToUpdate, elementId, function (a) {\n                            return a === elementId;\n                        });\n                    }\n                }\n\n                // now place all the continuous anchors we need to;\n                for (i = 0; i < anchorsToUpdate.length; i++) {\n                    placeAnchors(anchorsToUpdate[i], anchorLists[anchorsToUpdate[i]]);\n                }\n\n                // now that continuous anchors have been placed, paint all the endpoints for this element\n                for (i = 0; i < ep.length; i++) {\n                    ep[i].paint({ timestamp: timestamp, offset: myOffset, dimensions: myOffset.s, recalc: doNotRecalcEndpoint !== true });\n                }\n\n                // ... and any other endpoints we came across as a result of the continuous anchors.\n                for (i = 0; i < endpointsToPaint.length; i++) {\n                    var cd = jsPlumbInstance.getCachedData(endpointsToPaint[i].elementId);\n                    //endpointsToPaint[i].paint({ timestamp: timestamp, offset: cd, dimensions: cd.s });\n                    endpointsToPaint[i].paint({ timestamp: null, offset: cd, dimensions: cd.s });\n                }\n\n                // paint all the standard and \"dynamic connections\", which are connections whose other anchor is\n                // static and therefore does need to be recomputed; we make sure that happens only one time.\n\n                // TODO we could have compiled a list of these in the first pass through connections; might save some time.\n                for (i = 0; i < endpointConnections.length; i++) {\n                    var otherEndpoint = endpointConnections[i][1];\n                    if (otherEndpoint.anchor.constructor === _jp.DynamicAnchor) {\n                        otherEndpoint.paint({ elementWithPrecedence: elementId, timestamp: timestamp });\n                        _ju.addWithFunction(connectionsToPaint, endpointConnections[i][0], function (c) {\n                            return c.id === endpointConnections[i][0].id;\n                        });\n                        // all the connections for the other endpoint now need to be repainted\n                        for (var k = 0; k < otherEndpoint.connections.length; k++) {\n                            if (otherEndpoint.connections[k] !== endpointConnections[i][0]) {\n                                _ju.addWithFunction(connectionsToPaint, otherEndpoint.connections[k], function (c) {\n                                    return c.id === otherEndpoint.connections[k].id;\n                                });\n                            }\n                        }\n                    } else {\n                        _ju.addWithFunction(connectionsToPaint, endpointConnections[i][0], function (c) {\n                            return c.id === endpointConnections[i][0].id;\n                        });\n                    }\n                }\n\n                // paint current floating connection for this element, if there is one.\n                var fc = floatingConnections[elementId];\n                if (fc) {\n                    fc.paint({timestamp: timestamp, recalc: false, elId: elementId});\n                }\n\n                // paint all the connections\n                for (i = 0; i < connectionsToPaint.length; i++) {\n                    connectionsToPaint[i].paint({elId: elementId, timestamp: null, recalc: false, clearEdits: clearEdits});\n                }\n            }\n        };\n\n        var ContinuousAnchor = function (anchorParams) {\n            _ju.EventGenerator.apply(this);\n            this.type = \"Continuous\";\n            this.isDynamic = true;\n            this.isContinuous = true;\n            var faces = anchorParams.faces || [\"top\", \"right\", \"bottom\", \"left\"],\n                clockwise = !(anchorParams.clockwise === false),\n                availableFaces = { },\n                opposites = { \"top\": \"bottom\", \"right\": \"left\", \"left\": \"right\", \"bottom\": \"top\" },\n                clockwiseOptions = { \"top\": \"right\", \"right\": \"bottom\", \"left\": \"top\", \"bottom\": \"left\" },\n                antiClockwiseOptions = { \"top\": \"left\", \"right\": \"top\", \"left\": \"bottom\", \"bottom\": \"right\" },\n                secondBest = clockwise ? clockwiseOptions : antiClockwiseOptions,\n                lastChoice = clockwise ? antiClockwiseOptions : clockwiseOptions,\n                cssClass = anchorParams.cssClass || \"\",\n                _currentFace = null, _lockedFace = null, X_AXIS_FACES = [\"left\", \"right\"], Y_AXIS_FACES = [\"top\", \"bottom\"],\n                _lockedAxis = null;\n\n            for (var i = 0; i < faces.length; i++) {\n                availableFaces[faces[i]] = true;\n            }\n\n            this.getDefaultFace = function () {\n                return faces.length === 0 ? \"top\" : faces[0];\n            };\n\n            this.isRelocatable = function() { return true; };\n            this.isSnapOnRelocate = function() { return true; };\n\n            // if the given edge is supported, returns it. otherwise looks for a substitute that _is_\n            // supported. if none supported we also return the request edge.\n            this.verifyEdge = function (edge) {\n                if (availableFaces[edge]) {\n                    return edge;\n                }\n                else if (availableFaces[opposites[edge]]) {\n                    return opposites[edge];\n                }\n                else if (availableFaces[secondBest[edge]]) {\n                    return secondBest[edge];\n                }\n                else if (availableFaces[lastChoice[edge]]) {\n                    return lastChoice[edge];\n                }\n                return edge; // we have to give them something.\n            };\n\n            this.isEdgeSupported = function (edge) {\n                return  _lockedAxis == null ?\n\n                    (_lockedFace == null ? availableFaces[edge] === true : _lockedFace === edge)\n\n                    : _lockedAxis.indexOf(edge) !== -1;\n            };\n\n            this.setCurrentFace = function(face, overrideLock) {\n                _currentFace = face;\n                // if currently locked, and the user wants to override, do that.\n                if (overrideLock && _lockedFace != null) {\n                    _lockedFace = _currentFace;\n                }\n            };\n\n            this.getCurrentFace = function() { return _currentFace; };\n            this.getSupportedFaces = function() {\n                var af = [];\n                for (var k in availableFaces) {\n                    if (availableFaces[k]) {\n                        af.push(k);\n                    }\n                }\n                return af;\n            };\n\n            this.lock = function() {\n                _lockedFace = _currentFace;\n            };\n            this.unlock = function() {\n                _lockedFace = null;\n            };\n            this.isLocked = function() {\n                return _lockedFace != null;\n            };\n\n            this.lockCurrentAxis = function() {\n                if (_currentFace != null) {\n                    _lockedAxis = (_currentFace === \"left\" || _currentFace === \"right\") ? X_AXIS_FACES : Y_AXIS_FACES;\n                }\n            };\n\n            this.unlockCurrentAxis = function() {\n                _lockedAxis = null;\n            };\n\n            this.compute = function (params) {\n                return continuousAnchorLocations[params.element.id] || [0, 0];\n            };\n            this.getCurrentLocation = function (params) {\n                return continuousAnchorLocations[params.element.id] || [0, 0];\n            };\n            this.getOrientation = function (endpoint) {\n                return continuousAnchorOrientations[endpoint.id] || [0, 0];\n            };\n            this.getCssClass = function () {\n                return cssClass;\n            };\n        };\n\n        // continuous anchors\n        jsPlumbInstance.continuousAnchorFactory = {\n            get: function (params) {\n                return new ContinuousAnchor(params);\n            },\n            clear: function (elementId) {\n                delete continuousAnchorLocations[elementId];\n            }\n        };\n    };\n\n    _jp.AnchorManager.prototype.calculateOrientation = function (sourceId, targetId, sd, td, sourceAnchor, targetAnchor) {\n\n        var Orientation = { HORIZONTAL: \"horizontal\", VERTICAL: \"vertical\", DIAGONAL: \"diagonal\", IDENTITY: \"identity\" },\n            axes = [\"left\", \"top\", \"right\", \"bottom\"];\n\n        if (sourceId === targetId) {\n            return {\n                orientation: Orientation.IDENTITY,\n                a: [\"top\", \"top\"]\n            };\n        }\n\n        var theta = Math.atan2((td.centery - sd.centery), (td.centerx - sd.centerx)),\n            theta2 = Math.atan2((sd.centery - td.centery), (sd.centerx - td.centerx));\n\n// --------------------------------------------------------------------------------------\n\n        // improved face calculation. get midpoints of each face for source and target, then put in an array with all combinations of\n        // source/target faces. sort this array by distance between midpoints. the entry at index 0 is our preferred option. we can\n        // go through the array one by one until we find an entry in which each requested face is supported.\n        var candidates = [], midpoints = { };\n        (function (types, dim) {\n            for (var i = 0; i < types.length; i++) {\n                midpoints[types[i]] = {\n                    \"left\": [ dim[i].left, dim[i].centery ],\n                    \"right\": [ dim[i].right, dim[i].centery ],\n                    \"top\": [ dim[i].centerx, dim[i].top ],\n                    \"bottom\": [ dim[i].centerx , dim[i].bottom]\n                };\n            }\n        })([ \"source\", \"target\" ], [ sd, td ]);\n\n        for (var sf = 0; sf < axes.length; sf++) {\n            for (var tf = 0; tf < axes.length; tf++) {\n                candidates.push({\n                    source: axes[sf],\n                    target: axes[tf],\n                    dist: Biltong.lineLength(midpoints.source[axes[sf]], midpoints.target[axes[tf]])\n                });\n            }\n        }\n\n        candidates.sort(function (a, b) {\n            return a.dist < b.dist ? -1 : a.dist > b.dist ? 1 : 0;\n        });\n\n        // now go through this list and try to get an entry that satisfies both (there will be one, unless one of the anchors\n        // declares no available faces)\n        var sourceEdge = candidates[0].source, targetEdge = candidates[0].target;\n        for (var i = 0; i < candidates.length; i++) {\n\n            if (!sourceAnchor.isContinuous || sourceAnchor.isEdgeSupported(candidates[i].source)) {\n                sourceEdge = candidates[i].source;\n            }\n            else {\n                sourceEdge = null;\n            }\n\n            if (!targetAnchor.isContinuous || targetAnchor.isEdgeSupported(candidates[i].target)) {\n                targetEdge = candidates[i].target;\n            }\n            else {\n                targetEdge = null;\n            }\n\n            if (sourceEdge != null && targetEdge != null) {\n                break;\n            }\n        }\n\n        if (sourceAnchor.isContinuous) {\n            sourceAnchor.setCurrentFace(sourceEdge);\n        }\n\n        if (targetAnchor.isContinuous) {\n            targetAnchor.setCurrentFace(targetEdge);\n        }\n\n// --------------------------------------------------------------------------------------\n\n        return {\n            a: [ sourceEdge, targetEdge ],\n            theta: theta,\n            theta2: theta2\n        };\n    };\n\n    /**\n     * Anchors model a position on some element at which an Endpoint may be located.  They began as a first class citizen of jsPlumb, ie. a user\n     * was required to create these themselves, but over time this has been replaced by the concept of referring to them either by name (eg. \"TopMiddle\"),\n     * or by an array describing their coordinates (eg. [ 0, 0.5, 0, -1 ], which is the same as \"TopMiddle\").  jsPlumb now handles all of the\n     * creation of Anchors without user intervention.\n     */\n    _jp.Anchor = function (params) {\n        this.x = params.x || 0;\n        this.y = params.y || 0;\n        this.elementId = params.elementId;\n        this.cssClass = params.cssClass || \"\";\n        this.userDefinedLocation = null;\n        this.orientation = params.orientation || [ 0, 0 ];\n        this.lastReturnValue = null;\n        this.offsets = params.offsets || [ 0, 0 ];\n        this.timestamp = null;\n\n        var relocatable = params.relocatable !== false;\n        this.isRelocatable = function() { return relocatable; };\n        this.setRelocatable = function(_relocatable) { relocatable = _relocatable; };\n        var snapOnRelocate = params.snapOnRelocate !== false;\n        this.isSnapOnRelocate = function() { return snapOnRelocate; };\n\n        var locked = false;\n        this.lock = function() { locked = true; };\n        this.unlock = function() { locked = false; };\n        this.isLocked = function() { return locked; };\n\n        _ju.EventGenerator.apply(this);\n\n        this.compute = function (params) {\n\n            var xy = params.xy, wh = params.wh, timestamp = params.timestamp;\n\n            if (params.clearUserDefinedLocation) {\n                this.userDefinedLocation = null;\n            }\n\n            if (timestamp && timestamp === this.timestamp) {\n                return this.lastReturnValue;\n            }\n\n            if (this.userDefinedLocation != null) {\n                this.lastReturnValue = this.userDefinedLocation;\n            }\n            else {\n                this.lastReturnValue = [ xy[0] + (this.x * wh[0]) + this.offsets[0], xy[1] + (this.y * wh[1]) + this.offsets[1], this.x, this.y ];\n            }\n\n            this.timestamp = timestamp;\n            return this.lastReturnValue;\n        };\n\n        this.getCurrentLocation = function (params) {\n            params = params || {};\n            return (this.lastReturnValue == null || (params.timestamp != null && this.timestamp !== params.timestamp)) ? this.compute(params) : this.lastReturnValue;\n        };\n\n        this.setPosition = function(x, y, ox, oy, overrideLock) {\n            if (!locked || overrideLock) {\n                this.x = x;\n                this.y = y;\n                this.orientation = [ ox, oy ];\n                this.lastReturnValue = null;\n            }\n        };\n    };\n    _ju.extend(_jp.Anchor, _ju.EventGenerator, {\n        equals: function (anchor) {\n            if (!anchor) {\n                return false;\n            }\n            var ao = anchor.getOrientation(),\n                o = this.getOrientation();\n            return this.x === anchor.x && this.y === anchor.y && this.offsets[0] === anchor.offsets[0] && this.offsets[1] === anchor.offsets[1] && o[0] === ao[0] && o[1] === ao[1];\n        },\n        getUserDefinedLocation: function () {\n            return this.userDefinedLocation;\n        },\n        setUserDefinedLocation: function (l) {\n            this.userDefinedLocation = l;\n        },\n        clearUserDefinedLocation: function () {\n            this.userDefinedLocation = null;\n        },\n        getOrientation: function () {\n            return this.orientation;\n        },\n        getCssClass: function () {\n            return this.cssClass;\n        }\n    });\n\n    /**\n     * An Anchor that floats. its orientation is computed dynamically from\n     * its position relative to the anchor it is floating relative to.  It is used when creating\n     * a connection through drag and drop.\n     *\n     * TODO FloatingAnchor could totally be refactored to extend Anchor just slightly.\n     */\n    _jp.FloatingAnchor = function (params) {\n\n        _jp.Anchor.apply(this, arguments);\n\n        // this is the anchor that this floating anchor is referenced to for\n        // purposes of calculating the orientation.\n        var ref = params.reference,\n            // the canvas this refers to.\n            refCanvas = params.referenceCanvas,\n            size = _jp.getSize(refCanvas),\n            // these are used to store the current relative position of our\n            // anchor wrt the reference anchor. they only indicate\n            // direction, so have a value of 1 or -1 (or, very rarely, 0). these\n            // values are written by the compute method, and read\n            // by the getOrientation method.\n            xDir = 0, yDir = 0,\n            // temporary member used to store an orientation when the floating\n            // anchor is hovering over another anchor.\n            orientation = null,\n            _lastResult = null;\n\n        // clear from parent. we want floating anchor orientation to always be computed.\n        this.orientation = null;\n\n        // set these to 0 each; they are used by certain types of connectors in the loopback case,\n        // when the connector is trying to clear the element it is on. but for floating anchor it's not\n        // very important.\n        this.x = 0;\n        this.y = 0;\n\n        this.isFloating = true;\n\n        this.compute = function (params) {\n            var xy = params.xy,\n                result = [ xy[0] + (size[0] / 2), xy[1] + (size[1] / 2) ]; // return origin of the element. we may wish to improve this so that any object can be the drag proxy.\n            _lastResult = result;\n            return result;\n        };\n\n        this.getOrientation = function (_endpoint) {\n            if (orientation) {\n                return orientation;\n            }\n            else {\n                var o = ref.getOrientation(_endpoint);\n                // here we take into account the orientation of the other\n                // anchor: if it declares zero for some direction, we declare zero too. this might not be the most awesome. perhaps we can come\n                // up with a better way. it's just so that the line we draw looks like it makes sense. maybe this wont make sense.\n                return [ Math.abs(o[0]) * xDir * -1,\n                    Math.abs(o[1]) * yDir * -1 ];\n            }\n        };\n\n        /**\n         * notification the endpoint associated with this anchor is hovering\n         * over another anchor; we want to assume that anchor's orientation\n         * for the duration of the hover.\n         */\n        this.over = function (anchor, endpoint) {\n            orientation = anchor.getOrientation(endpoint);\n        };\n\n        /**\n         * notification the endpoint associated with this anchor is no\n         * longer hovering over another anchor; we should resume calculating\n         * orientation as we normally do.\n         */\n        this.out = function () {\n            orientation = null;\n        };\n\n        this.getCurrentLocation = function (params) {\n            return _lastResult == null ? this.compute(params) : _lastResult;\n        };\n    };\n    _ju.extend(_jp.FloatingAnchor, _jp.Anchor);\n\n    var _convertAnchor = function (anchor, jsPlumbInstance, elementId) {\n        return anchor.constructor === _jp.Anchor ? anchor : jsPlumbInstance.makeAnchor(anchor, elementId, jsPlumbInstance);\n    };\n\n    /* \n     * A DynamicAnchor is an Anchor that contains a list of other Anchors, which it cycles\n     * through at compute time to find the one that is located closest to\n     * the center of the target element, and returns that Anchor's compute\n     * method result. this causes endpoints to follow each other with\n     * respect to the orientation of their target elements, which is a useful\n     * feature for some applications.\n     * \n     */\n    _jp.DynamicAnchor = function (params) {\n        _jp.Anchor.apply(this, arguments);\n\n        this.isDynamic = true;\n        this.anchors = [];\n        this.elementId = params.elementId;\n        this.jsPlumbInstance = params.jsPlumbInstance;\n\n        for (var i = 0; i < params.anchors.length; i++) {\n            this.anchors[i] = _convertAnchor(params.anchors[i], this.jsPlumbInstance, this.elementId);\n        }\n\n        this.getAnchors = function () {\n            return this.anchors;\n        };\n\n        var _curAnchor = this.anchors.length > 0 ? this.anchors[0] : null,\n            _lastAnchor = _curAnchor,\n            self = this,\n\n            // helper method to calculate the distance between the centers of the two elements.\n            _distance = function (anchor, cx, cy, xy, wh) {\n                var ax = xy[0] + (anchor.x * wh[0]), ay = xy[1] + (anchor.y * wh[1]),\n                    acx = xy[0] + (wh[0] / 2), acy = xy[1] + (wh[1] / 2);\n                return (Math.sqrt(Math.pow(cx - ax, 2) + Math.pow(cy - ay, 2)) +\n                Math.sqrt(Math.pow(acx - ax, 2) + Math.pow(acy - ay, 2)));\n            },\n            // default method uses distance between element centers.  you can provide your own method in the dynamic anchor\n            // constructor (and also to jsPlumb.makeDynamicAnchor). the arguments to it are four arrays:\n            // xy - xy loc of the anchor's element\n            // wh - anchor's element's dimensions\n            // txy - xy loc of the element of the other anchor in the connection\n            // twh - dimensions of the element of the other anchor in the connection.\n            // anchors - the list of selectable anchors\n            _anchorSelector = params.selector || function (xy, wh, txy, twh, anchors) {\n                    var cx = txy[0] + (twh[0] / 2), cy = txy[1] + (twh[1] / 2);\n                    var minIdx = -1, minDist = Infinity;\n                    for (var i = 0; i < anchors.length; i++) {\n                        var d = _distance(anchors[i], cx, cy, xy, wh);\n                        if (d < minDist) {\n                            minIdx = i + 0;\n                            minDist = d;\n                        }\n                    }\n                    return anchors[minIdx];\n                };\n\n        this.compute = function (params) {\n            var xy = params.xy, wh = params.wh, txy = params.txy, twh = params.twh;\n\n            this.timestamp = params.timestamp;\n\n            var udl = self.getUserDefinedLocation();\n            if (udl != null) {\n                return udl;\n            }\n\n            // if anchor is locked or an opposite element was not given, we\n            // maintain our state. anchor will be locked\n            // if it is the source of a drag and drop.\n            if (this.isLocked() || txy == null || twh == null) {\n                return _curAnchor.compute(params);\n            }\n            else {\n                params.timestamp = null; // otherwise clear this, i think. we want the anchor to compute.\n            }\n\n            _curAnchor = _anchorSelector(xy, wh, txy, twh, this.anchors);\n            this.x = _curAnchor.x;\n            this.y = _curAnchor.y;\n\n            if (_curAnchor !== _lastAnchor) {\n                this.fire(\"anchorChanged\", _curAnchor);\n            }\n\n            _lastAnchor = _curAnchor;\n\n            return _curAnchor.compute(params);\n        };\n\n        this.getCurrentLocation = function (params) {\n            return this.getUserDefinedLocation() || (_curAnchor != null ? _curAnchor.getCurrentLocation(params) : null);\n        };\n\n        this.getOrientation = function (_endpoint) {\n            return _curAnchor != null ? _curAnchor.getOrientation(_endpoint) : [ 0, 0 ];\n        };\n        this.over = function (anchor, endpoint) {\n            if (_curAnchor != null) {\n                _curAnchor.over(anchor, endpoint);\n            }\n        };\n        this.out = function () {\n            if (_curAnchor != null) {\n                _curAnchor.out();\n            }\n        };\n\n        this.setAnchor = function(a) {\n            _curAnchor = a;\n        };\n\n        this.getCssClass = function () {\n            return (_curAnchor && _curAnchor.getCssClass()) || \"\";\n        };\n\n        /**\n         * Attempt to match an anchor with the given coordinates and then set it.\n         * @param coords\n         * @returns true if matching anchor found, false otherwise.\n         */\n        this.setAnchorCoordinates = function(coords) {\n            var idx = jsPlumbUtil.findWithFunction(this.anchors, function(a) {\n                return a.x === coords[0] && a.y === coords[1];\n            });\n            if (idx !== -1) {\n                this.setAnchor(this.anchors[idx]);\n                return true;\n            } else {\n                return false;\n            }\n        };\n    };\n    _ju.extend(_jp.DynamicAnchor, _jp.Anchor);\n\n// -------- basic anchors ------------------    \n    var _curryAnchor = function (x, y, ox, oy, type, fnInit) {\n        _jp.Anchors[type] = function (params) {\n            var a = params.jsPlumbInstance.makeAnchor([ x, y, ox, oy, 0, 0 ], params.elementId, params.jsPlumbInstance);\n            a.type = type;\n            if (fnInit) {\n                fnInit(a, params);\n            }\n            return a;\n        };\n    };\n\n    _curryAnchor(0.5, 0, 0, -1, \"TopCenter\");\n    _curryAnchor(0.5, 1, 0, 1, \"BottomCenter\");\n    _curryAnchor(0, 0.5, -1, 0, \"LeftMiddle\");\n    _curryAnchor(1, 0.5, 1, 0, \"RightMiddle\");\n\n    _curryAnchor(0.5, 0, 0, -1, \"Top\");\n    _curryAnchor(0.5, 1, 0, 1, \"Bottom\");\n    _curryAnchor(0, 0.5, -1, 0, \"Left\");\n    _curryAnchor(1, 0.5, 1, 0, \"Right\");\n    _curryAnchor(0.5, 0.5, 0, 0, \"Center\");\n    _curryAnchor(1, 0, 0, -1, \"TopRight\");\n    _curryAnchor(1, 1, 0, 1, \"BottomRight\");\n    _curryAnchor(0, 0, 0, -1, \"TopLeft\");\n    _curryAnchor(0, 1, 0, 1, \"BottomLeft\");\n\n// ------- dynamic anchors -------------------    \n\n    // default dynamic anchors chooses from Top, Right, Bottom, Left\n    _jp.Defaults.DynamicAnchors = function (params) {\n        return params.jsPlumbInstance.makeAnchors([\"TopCenter\", \"RightMiddle\", \"BottomCenter\", \"LeftMiddle\"], params.elementId, params.jsPlumbInstance);\n    };\n\n    // default dynamic anchors bound to name 'AutoDefault'\n    _jp.Anchors.AutoDefault = function (params) {\n        var a = params.jsPlumbInstance.makeDynamicAnchor(_jp.Defaults.DynamicAnchors(params));\n        a.type = \"AutoDefault\";\n        return a;\n    };\n\n// ------- continuous anchors -------------------    \n\n    var _curryContinuousAnchor = function (type, faces) {\n        _jp.Anchors[type] = function (params) {\n            var a = params.jsPlumbInstance.makeAnchor([\"Continuous\", { faces: faces }], params.elementId, params.jsPlumbInstance);\n            a.type = type;\n            return a;\n        };\n    };\n\n    _jp.Anchors.Continuous = function (params) {\n        return params.jsPlumbInstance.continuousAnchorFactory.get(params);\n    };\n\n    _curryContinuousAnchor(\"ContinuousLeft\", [\"left\"]);\n    _curryContinuousAnchor(\"ContinuousTop\", [\"top\"]);\n    _curryContinuousAnchor(\"ContinuousBottom\", [\"bottom\"]);\n    _curryContinuousAnchor(\"ContinuousRight\", [\"right\"]);\n\n// ------- position assign anchors -------------------    \n\n    // this anchor type lets you assign the position at connection time.\n    _curryAnchor(0, 0, 0, 0, \"Assign\", function (anchor, params) {\n        // find what to use as the \"position finder\". the user may have supplied a String which represents\n        // the id of a position finder in jsPlumb.AnchorPositionFinders, or the user may have supplied the\n        // position finder as a function.  we find out what to use and then set it on the anchor.\n        var pf = params.position || \"Fixed\";\n        anchor.positionFinder = pf.constructor === String ? params.jsPlumbInstance.AnchorPositionFinders[pf] : pf;\n        // always set the constructor params; the position finder might need them later (the Grid one does,\n        // for example)\n        anchor.constructorParams = params;\n    });\n\n    // these are the default anchor positions finders, which are used by the makeTarget function.  supplying\n    // a position finder argument to that function allows you to specify where the resulting anchor will\n    // be located\n    root.jsPlumbInstance.prototype.AnchorPositionFinders = {\n        \"Fixed\": function (dp, ep, es) {\n            return [ (dp.left - ep.left) / es[0], (dp.top - ep.top) / es[1] ];\n        },\n        \"Grid\": function (dp, ep, es, params) {\n            var dx = dp.left - ep.left, dy = dp.top - ep.top,\n                gx = es[0] / (params.grid[0]), gy = es[1] / (params.grid[1]),\n                mx = Math.floor(dx / gx), my = Math.floor(dy / gy);\n            return [ ((mx * gx) + (gx / 2)) / es[0], ((my * gy) + (gy / 2)) / es[1] ];\n        }\n    };\n\n// ------- perimeter anchors -------------------    \n\n    _jp.Anchors.Perimeter = function (params) {\n        params = params || {};\n        var anchorCount = params.anchorCount || 60,\n            shape = params.shape;\n\n        if (!shape) {\n            throw new Error(\"no shape supplied to Perimeter Anchor type\");\n        }\n\n        var _circle = function () {\n                var r = 0.5, step = Math.PI * 2 / anchorCount, current = 0, a = [];\n                for (var i = 0; i < anchorCount; i++) {\n                    var x = r + (r * Math.sin(current)),\n                        y = r + (r * Math.cos(current));\n                    a.push([ x, y, 0, 0 ]);\n                    current += step;\n                }\n                return a;\n            },\n            _path = function (segments) {\n                var anchorsPerFace = anchorCount / segments.length, a = [],\n                    _computeFace = function (x1, y1, x2, y2, fractionalLength, ox, oy) {\n                        anchorsPerFace = anchorCount * fractionalLength;\n                        var dx = (x2 - x1) / anchorsPerFace, dy = (y2 - y1) / anchorsPerFace;\n                        for (var i = 0; i < anchorsPerFace; i++) {\n                            a.push([\n                                x1 + (dx * i),\n                                y1 + (dy * i),\n                                ox == null ? 0 : ox,\n                                oy == null ? 0 : oy\n                            ]);\n                        }\n                    };\n\n                for (var i = 0; i < segments.length; i++) {\n                    _computeFace.apply(null, segments[i]);\n                }\n\n                return a;\n            },\n            _shape = function (faces) {\n                var s = [];\n                for (var i = 0; i < faces.length; i++) {\n                    s.push([faces[i][0], faces[i][1], faces[i][2], faces[i][3], 1 / faces.length, faces[i][4], faces[i][5]]);\n                }\n                return _path(s);\n            },\n            _rectangle = function () {\n                return _shape([\n                    [ 0, 0, 1, 0, 0, -1 ],\n                    [ 1, 0, 1, 1, 1, 0 ],\n                    [ 1, 1, 0, 1, 0, 1 ],\n                    [ 0, 1, 0, 0, -1, 0 ]\n                ]);\n            };\n\n        var _shapes = {\n                \"Circle\": _circle,\n                \"Ellipse\": _circle,\n                \"Diamond\": function () {\n                    return _shape([\n                        [ 0.5, 0, 1, 0.5 ],\n                        [ 1, 0.5, 0.5, 1 ],\n                        [ 0.5, 1, 0, 0.5 ],\n                        [ 0, 0.5, 0.5, 0 ]\n                    ]);\n                },\n                \"Rectangle\": _rectangle,\n                \"Square\": _rectangle,\n                \"Triangle\": function () {\n                    return _shape([\n                        [ 0.5, 0, 1, 1 ],\n                        [ 1, 1, 0, 1 ],\n                        [ 0, 1, 0.5, 0]\n                    ]);\n                },\n                \"Path\": function (params) {\n                    var points = params.points, p = [], tl = 0;\n                    for (var i = 0; i < points.length - 1; i++) {\n                        var l = Math.sqrt(Math.pow(points[i][2] - points[i][0]) + Math.pow(points[i][3] - points[i][1]));\n                        tl += l;\n                        p.push([points[i][0], points[i][1], points[i + 1][0], points[i + 1][1], l]);\n                    }\n                    for (var j = 0; j < p.length; j++) {\n                        p[j][4] = p[j][4] / tl;\n                    }\n                    return _path(p);\n                }\n            },\n            _rotate = function (points, amountInDegrees) {\n                var o = [], theta = amountInDegrees / 180 * Math.PI;\n                for (var i = 0; i < points.length; i++) {\n                    var _x = points[i][0] - 0.5,\n                        _y = points[i][1] - 0.5;\n\n                    o.push([\n                        0.5 + ((_x * Math.cos(theta)) - (_y * Math.sin(theta))),\n                        0.5 + ((_x * Math.sin(theta)) + (_y * Math.cos(theta))),\n                        points[i][2],\n                        points[i][3]\n                    ]);\n                }\n                return o;\n            };\n\n        if (!_shapes[shape]) {\n            throw new Error(\"Shape [\" + shape + \"] is unknown by Perimeter Anchor type\");\n        }\n\n        var da = _shapes[shape](params);\n        if (params.rotation) {\n            da = _rotate(da, params.rotation);\n        }\n        var a = params.jsPlumbInstance.makeDynamicAnchor(da);\n        a.type = \"Perimeter\";\n        return a;\n    };\n}).call(typeof window !== 'undefined' ? window : this);\n\n/*\n * Default router. Defers to an AnchorManager for placement of anchors, and connector paint routines for paths.\n * Currently this is a placeholder and acts as a facade to the pre-existing anchor manager. The Toolkit edition\n * will make use of concept to provide more advanced routing.\n *\n * Copyright (c) 2010 - 2020 jsPlumb (hello@jsplumbtoolkit.com)\n *\n * https://jsplumbtoolkit.com\n * https://github.com/jsplumb/jsplumb\n *\n * Dual licensed under the MIT and GPL2 licenses.\n */\n\n;\n(function () {\n\n    \"use strict\";\n\n    var root = this,\n        _ju = root.jsPlumbUtil,\n        _jp = root.jsPlumb;\n\n    _jp.DefaultRouter = function(jsPlumbInstance) {\n        this.jsPlumbInstance = jsPlumbInstance;\n        this.anchorManager = new _jp.AnchorManager({jsPlumbInstance:jsPlumbInstance});\n\n        this.sourceOrTargetChanged = function (originalId, newId, connection, newElement, anchorIndex) {\n            this.anchorManager.sourceOrTargetChanged(originalId, newId, connection, newElement, anchorIndex);\n        };\n\n        this.reset = function() {\n            this.anchorManager.reset();\n        };\n\n        this.changeId = function (oldId, newId) {\n            this.anchorManager.changeId(oldId, newId);\n        };\n\n        this.elementRemoved = function (elementId) {\n            this.anchorManager.elementRemoved(elementId);\n        };\n\n        this.newConnection = function (conn) {\n            this.anchorManager.newConnection(conn);\n        };\n\n        this.connectionDetached = function (connInfo, doNotRedraw) {\n            this.anchorManager.connectionDetached(connInfo, doNotRedraw);\n        };\n    };\n\n\n\n}).call(typeof window !== 'undefined' ? window : this);\n\n\n\n/*\n * This file contains the default Connectors, Endpoint and Overlay definitions.\n *\n * Copyright (c) 2010 - 2020 jsPlumb (hello@jsplumbtoolkit.com)\n * \n * https://jsplumbtoolkit.com\n * https://github.com/jsplumb/jsplumb\n * \n * Dual licensed under the MIT and GPL2 licenses.\n */\n;\n(function () {\n\n    \"use strict\";\n    var root = this, _jp = root.jsPlumb, _ju = root.jsPlumbUtil, _jg = root.Biltong;\n\n    _jp.Segments = {\n\n        /*\n         * Class: AbstractSegment\n         * A Connector is made up of 1..N Segments, each of which has a Type, such as 'Straight', 'Arc',\n         * 'Bezier'. This is new from 1.4.2, and gives us a lot more flexibility when drawing connections: things such\n         * as rounded corners for flowchart connectors, for example, or a straight line stub for Bezier connections, are\n         * much easier to do now.\n         *\n         * A Segment is responsible for providing coordinates for painting it, and also must be able to report its length.\n         * \n         */\n        AbstractSegment: function (params) {\n            this.params = params;\n\n            /**\n             * Function: findClosestPointOnPath\n             * Finds the closest point on this segment to the given [x, y],\n             * returning both the x and y of the point plus its distance from\n             * the supplied point, and its location along the length of the\n             * path inscribed by the segment.  This implementation returns\n             * Infinity for distance and null values for everything else;\n             * subclasses are expected to override.\n             */\n            this.findClosestPointOnPath = function (x, y) {\n                return {\n                    d: Infinity,\n                    x: null,\n                    y: null,\n                    l: null\n                };\n            };\n\n            this.getBounds = function () {\n                return {\n                    minX: Math.min(params.x1, params.x2),\n                    minY: Math.min(params.y1, params.y2),\n                    maxX: Math.max(params.x1, params.x2),\n                    maxY: Math.max(params.y1, params.y2)\n                };\n            };\n\n            /**\n             * Computes the list of points on the segment that intersect the given line.\n             * @method lineIntersection\n             * @param {number} x1\n             * @param {number} y1\n             * @param {number} x2\n             * @param {number} y2\n             * @returns {Array<[number, number]>}\n             */\n            this.lineIntersection = function(x1, y1, x2, y2) {\n                return [];\n            };\n\n            /**\n             * Computes the list of points on the segment that intersect the box with the given origin and size.\n             * @method boxIntersection\n             * @param {number} x1\n             * @param {number} y1\n             * @param {number} w\n             * @param {number} h\n             * @returns {Array<[number, number]>}\n             */\n            this.boxIntersection = function(x, y, w, h) {\n                var a = [];\n                a.push.apply(a, this.lineIntersection(x, y, x + w, y));\n                a.push.apply(a, this.lineIntersection(x + w, y, x + w, y + h));\n                a.push.apply(a, this.lineIntersection(x + w, y + h, x, y + h));\n                a.push.apply(a, this.lineIntersection(x, y + h, x, y));\n                return a;\n            };\n\n            /**\n             * Computes the list of points on the segment that intersect the given bounding box, which is an object of the form { x:.., y:.., w:.., h:.. }.\n             * @method lineIntersection\n             * @param {BoundingRectangle} box\n             * @returns {Array<[number, number]>}\n             */\n            this.boundingBoxIntersection = function(box) {\n                return this.boxIntersection(box.x, box.y, box.w, box.y);\n            };\n        },\n        Straight: function (params) {\n            var _super = _jp.Segments.AbstractSegment.apply(this, arguments),\n                length, m, m2, x1, x2, y1, y2,\n                _recalc = function () {\n                    length = Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2));\n                    m = _jg.gradient({x: x1, y: y1}, {x: x2, y: y2});\n                    m2 = -1 / m;\n                };\n\n            this.type = \"Straight\";\n\n            this.getLength = function () {\n                return length;\n            };\n            this.getGradient = function () {\n                return m;\n            };\n\n            this.getCoordinates = function () {\n                return { x1: x1, y1: y1, x2: x2, y2: y2 };\n            };\n            this.setCoordinates = function (coords) {\n                x1 = coords.x1;\n                y1 = coords.y1;\n                x2 = coords.x2;\n                y2 = coords.y2;\n                _recalc();\n            };\n            this.setCoordinates({x1: params.x1, y1: params.y1, x2: params.x2, y2: params.y2});\n\n            this.getBounds = function () {\n                return {\n                    minX: Math.min(x1, x2),\n                    minY: Math.min(y1, y2),\n                    maxX: Math.max(x1, x2),\n                    maxY: Math.max(y1, y2)\n                };\n            };\n\n            /**\n             * returns the point on the segment's path that is 'location' along the length of the path, where 'location' is a decimal from\n             * 0 to 1 inclusive. for the straight line segment this is simple maths.\n             */\n            this.pointOnPath = function (location, absolute) {\n                if (location === 0 && !absolute) {\n                    return { x: x1, y: y1 };\n                }\n                else if (location === 1 && !absolute) {\n                    return { x: x2, y: y2 };\n                }\n                else {\n                    var l = absolute ? location > 0 ? location : length + location : location * length;\n                    return _jg.pointOnLine({x: x1, y: y1}, {x: x2, y: y2}, l);\n                }\n            };\n\n            /**\n             * returns the gradient of the segment at the given point - which for us is constant.\n             */\n            this.gradientAtPoint = function (_) {\n                return m;\n            };\n\n            /**\n             * returns the point on the segment's path that is 'distance' along the length of the path from 'location', where\n             * 'location' is a decimal from 0 to 1 inclusive, and 'distance' is a number of pixels.\n             * this hands off to jsPlumbUtil to do the maths, supplying two points and the distance.\n             */\n            this.pointAlongPathFrom = function (location, distance, absolute) {\n                var p = this.pointOnPath(location, absolute),\n                    farAwayPoint = distance <= 0 ? {x: x1, y: y1} : {x: x2, y: y2 };\n\n                /*\n                 location == 1 ? {\n                 x:x1 + ((x2 - x1) * 10),\n                 y:y1 + ((y1 - y2) * 10)\n                 } :\n                 */\n\n                if (distance <= 0 && Math.abs(distance) > 1) {\n                    distance *= -1;\n                }\n\n                return _jg.pointOnLine(p, farAwayPoint, distance);\n            };\n\n            // is c between a and b?\n            var within = function (a, b, c) {\n                return c >= Math.min(a, b) && c <= Math.max(a, b);\n            };\n            // find which of a and b is closest to c\n            var closest = function (a, b, c) {\n                return Math.abs(c - a) < Math.abs(c - b) ? a : b;\n            };\n\n            /**\n             Function: findClosestPointOnPath\n             Finds the closest point on this segment to [x,y]. See\n             notes on this method in AbstractSegment.\n             */\n            this.findClosestPointOnPath = function (x, y) {\n                var out = {\n                    d: Infinity,\n                    x: null,\n                    y: null,\n                    l: null,\n                    x1: x1,\n                    x2: x2,\n                    y1: y1,\n                    y2: y2\n                };\n\n                if (m === 0) {\n                    out.y = y1;\n                    out.x = within(x1, x2, x) ? x : closest(x1, x2, x);\n                }\n                else if (m === Infinity || m === -Infinity) {\n                    out.x = x1;\n                    out.y = within(y1, y2, y) ? y : closest(y1, y2, y);\n                }\n                else {\n                    // closest point lies on normal from given point to this line.  \n                    var b = y1 - (m * x1),\n                        b2 = y - (m2 * x),\n                    // y1 = m.x1 + b and y1 = m2.x1 + b2\n                    // so m.x1 + b = m2.x1 + b2\n                    // x1(m - m2) = b2 - b\n                    // x1 = (b2 - b) / (m - m2)\n                        _x1 = (b2 - b) / (m - m2),\n                        _y1 = (m * _x1) + b;\n\n                    out.x = within(x1, x2, _x1) ? _x1 : closest(x1, x2, _x1);//_x1;\n                    out.y = within(y1, y2, _y1) ? _y1 : closest(y1, y2, _y1);//_y1;\n                }\n\n                var fractionInSegment = _jg.lineLength([ out.x, out.y ], [ x1, y1 ]);\n                out.d = _jg.lineLength([x, y], [out.x, out.y]);\n                out.l = fractionInSegment / length;\n                return out;\n            };\n\n            var _pointLiesBetween = function(q, p1, p2) {\n                return (p2 > p1) ? (p1 <= q && q <= p2) : (p1 >= q && q >= p2);\n            }, _plb = _pointLiesBetween;\n\n            /**\n             * Calculates all intersections of the given line with this segment.\n             * @param _x1\n             * @param _y1\n             * @param _x2\n             * @param _y2\n             * @returns {Array}\n             */\n            this.lineIntersection = function(_x1, _y1, _x2, _y2) {\n                var m2 = Math.abs(_jg.gradient({x: _x1, y: _y1}, {x: _x2, y: _y2})),\n                    m1 = Math.abs(m),\n                    b = m1 === Infinity ? x1 : y1 - (m1 * x1),\n                    out = [],\n                    b2 = m2 === Infinity ? _x1 : _y1 - (m2 * _x1);\n\n                // if lines parallel, no intersection\n                if  (m2 !== m1) {\n                    // perpendicular, segment horizontal\n                    if(m2 === Infinity  && m1 === 0) {\n                        if (_plb(_x1, x1, x2) && _plb(y1, _y1, _y2)) {\n                            out = [ _x1, y1 ];  // we return X on the incident line and Y from the segment\n                        }\n                    } else if(m2 === 0 && m1 === Infinity) {\n                        // perpendicular, segment vertical\n                        if(_plb(_y1, y1, y2) && _plb(x1, _x1, _x2)) {\n                            out = [x1, _y1];  // we return X on the segment and Y from the incident line\n                        }\n                    } else {\n                        var X, Y;\n                        if (m2 === Infinity) {\n                            // test line is a vertical line. where does it cross the segment?\n                            X = _x1;\n                            if (_plb(X, x1, x2)) {\n                                Y = (m1 * _x1) + b;\n                                if (_plb(Y, _y1, _y2)) {\n                                    out = [ X, Y ];\n                                }\n                            }\n                        } else if (m2 === 0) {\n                            Y = _y1;\n                            // test line is a horizontal line. where does it cross the segment?\n                            if (_plb(Y, y1, y2)) {\n                                X = (_y1 - b) / m1;\n                                if (_plb(X, _x1, _x2)) {\n                                    out = [ X, Y ];\n                                }\n                            }\n                        } else {\n                            // mX + b = m2X + b2\n                            // mX - m2X = b2 - b\n                            // X(m - m2) = b2 - b\n                            // X = (b2 - b) / (m - m2)\n                            // Y = mX + b\n                            X = (b2 - b) / (m1 - m2);\n                            Y = (m1 * X) + b;\n                            if(_plb(X, x1, x2) && _plb(Y, y1, y2)) {\n                                out = [ X,  Y];\n                            }\n                        }\n                    }\n                }\n\n                return out;\n            };\n\n            /**\n             * Calculates all intersections of the given box with this segment. By default this method simply calls `lineIntersection` with each of the four\n             * faces of the box; subclasses can override this if they think there's a faster way to compute the entire box at once.\n             * @param x X position of top left corner of box\n             * @param y Y position of top left corner of box\n             * @param w width of box\n             * @param h height of box\n             * @returns {Array}\n             */\n            this.boxIntersection = function(x, y, w, h) {\n                var a = [];\n                a.push.apply(a, this.lineIntersection(x, y, x + w, y));\n                a.push.apply(a, this.lineIntersection(x + w, y, x + w, y + h));\n                a.push.apply(a, this.lineIntersection(x + w, y + h, x, y + h));\n                a.push.apply(a, this.lineIntersection(x, y + h, x, y));\n                return a;\n            };\n\n            /**\n             * Calculates all intersections of the given bounding box with this segment. By default this method simply calls `lineIntersection` with each of the four\n             * faces of the box; subclasses can override this if they think there's a faster way to compute the entire box at once.\n             * @param box Bounding box, in { x:.., y:..., w:..., h:... } format.\n             * @returns {Array}\n             */\n            this.boundingBoxIntersection = function(box) {\n                return this.boxIntersection(box.x, box.y, box.w, box.h);\n            };\n        },\n\n        /*\n         Arc Segment. You need to supply:\n\n         r   -   radius\n         cx  -   center x for the arc\n         cy  -   center y for the arc\n         ac  -   whether the arc is anticlockwise or not. default is clockwise.\n\n         and then either:\n\n         startAngle  -   startAngle for the arc.\n         endAngle    -   endAngle for the arc.\n\n         or:\n\n         x1          -   x for start point\n         y1          -   y for start point\n         x2          -   x for end point\n         y2          -   y for end point\n\n         */\n        Arc: function (params) {\n            var _super = _jp.Segments.AbstractSegment.apply(this, arguments),\n                _calcAngle = function (_x, _y) {\n                    return _jg.theta([params.cx, params.cy], [_x, _y]);\n                },\n                _calcAngleForLocation = function (segment, location) {\n                    if (segment.anticlockwise) {\n                        var sa = segment.startAngle < segment.endAngle ? segment.startAngle + TWO_PI : segment.startAngle,\n                            s = Math.abs(sa - segment.endAngle);\n                        return sa - (s * location);\n                    }\n                    else {\n                        var ea = segment.endAngle < segment.startAngle ? segment.endAngle + TWO_PI : segment.endAngle,\n                            ss = Math.abs(ea - segment.startAngle);\n\n                        return segment.startAngle + (ss * location);\n                    }\n                },\n                TWO_PI = 2 * Math.PI;\n\n            this.radius = params.r;\n            this.anticlockwise = params.ac;\n            this.type = \"Arc\";\n\n            if (params.startAngle && params.endAngle) {\n                this.startAngle = params.startAngle;\n                this.endAngle = params.endAngle;\n                this.x1 = params.cx + (this.radius * Math.cos(params.startAngle));\n                this.y1 = params.cy + (this.radius * Math.sin(params.startAngle));\n                this.x2 = params.cx + (this.radius * Math.cos(params.endAngle));\n                this.y2 = params.cy + (this.radius * Math.sin(params.endAngle));\n            }\n            else {\n                this.startAngle = _calcAngle(params.x1, params.y1);\n                this.endAngle = _calcAngle(params.x2, params.y2);\n                this.x1 = params.x1;\n                this.y1 = params.y1;\n                this.x2 = params.x2;\n                this.y2 = params.y2;\n            }\n\n            if (this.endAngle < 0) {\n                this.endAngle += TWO_PI;\n            }\n            if (this.startAngle < 0) {\n                this.startAngle += TWO_PI;\n            }\n\n            // segment is used by vml     \n            //this.segment = _jg.quadrant([this.x1, this.y1], [this.x2, this.y2]);\n\n            // we now have startAngle and endAngle as positive numbers, meaning the\n            // absolute difference (|d|) between them is the sweep (s) of this arc, unless the\n            // arc is 'anticlockwise' in which case 's' is given by 2PI - |d|.\n\n            var ea = this.endAngle < this.startAngle ? this.endAngle + TWO_PI : this.endAngle;\n            this.sweep = Math.abs(ea - this.startAngle);\n            if (this.anticlockwise) {\n                this.sweep = TWO_PI - this.sweep;\n            }\n            var circumference = 2 * Math.PI * this.radius,\n                frac = this.sweep / TWO_PI,\n                length = circumference * frac;\n\n            this.getLength = function () {\n                return length;\n            };\n\n            this.getBounds = function () {\n                return {\n                    minX: params.cx - params.r,\n                    maxX: params.cx + params.r,\n                    minY: params.cy - params.r,\n                    maxY: params.cy + params.r\n                };\n            };\n\n            var VERY_SMALL_VALUE = 0.0000000001,\n                gentleRound = function (n) {\n                    var f = Math.floor(n), r = Math.ceil(n);\n                    if (n - f < VERY_SMALL_VALUE) {\n                        return f;\n                    }\n                    else if (r - n < VERY_SMALL_VALUE) {\n                        return r;\n                    }\n                    return n;\n                };\n\n            /**\n             * returns the point on the segment's path that is 'location' along the length of the path, where 'location' is a decimal from\n             * 0 to 1 inclusive.\n             */\n            this.pointOnPath = function (location, absolute) {\n\n                if (location === 0) {\n                    return { x: this.x1, y: this.y1, theta: this.startAngle };\n                }\n                else if (location === 1) {\n                    return { x: this.x2, y: this.y2, theta: this.endAngle };\n                }\n\n                if (absolute) {\n                    location = location / length;\n                }\n\n                var angle = _calcAngleForLocation(this, location),\n                    _x = params.cx + (params.r * Math.cos(angle)),\n                    _y = params.cy + (params.r * Math.sin(angle));\n\n                return { x: gentleRound(_x), y: gentleRound(_y), theta: angle };\n            };\n\n            /**\n             * returns the gradient of the segment at the given point.\n             */\n            this.gradientAtPoint = function (location, absolute) {\n                var p = this.pointOnPath(location, absolute);\n                var m = _jg.normal([ params.cx, params.cy ], [p.x, p.y ]);\n                if (!this.anticlockwise && (m === Infinity || m === -Infinity)) {\n                    m *= -1;\n                }\n                return m;\n            };\n\n            this.pointAlongPathFrom = function (location, distance, absolute) {\n                var p = this.pointOnPath(location, absolute),\n                    arcSpan = distance / circumference * 2 * Math.PI,\n                    dir = this.anticlockwise ? -1 : 1,\n                    startAngle = p.theta + (dir * arcSpan),\n                    startX = params.cx + (this.radius * Math.cos(startAngle)),\n                    startY = params.cy + (this.radius * Math.sin(startAngle));\n\n                return {x: startX, y: startY};\n            };\n\n            // TODO: lineIntersection\n        },\n\n        Bezier: function (params) {\n            this.curve = [\n                { x: params.x1, y: params.y1},\n                { x: params.cp1x, y: params.cp1y },\n                { x: params.cp2x, y: params.cp2y },\n                { x: params.x2, y: params.y2 }\n            ];\n\n            var _isPoint = function(c) {\n                return c[0].x === c[1].x && c[0].y === c[1].y;\n            };\n\n            var _dist = function(p1, p2 ) {\n                return Math.sqrt(Math.pow(p1.x - p2.x, 2) + Math.pow(p1.y - p2.y, 2));\n            };\n\n            var _compute = function(loc) {\n\n                var EMPTY_POINT  = {x:0, y:0};\n\n                if (loc === 0) {\n                    return this.curve[0];\n                }\n\n                var degree = this.curve.length - 1;\n\n                if (loc === 1) {\n                    return this.curve[degree];\n                }\n\n                var o = this.curve;\n                var s = 1 - loc;\n\n                if (degree === 0) {\n                    return this.curve[0];\n                }\n\n                if (degree === 1) {\n                    return {\n                        x: s * o[0].x + loc * o[1].x,\n                        y: s * o[0].y + loc * o[1].y\n                    };\n                }\n\n                if (degree < 4) {\n\n                    var l = s * s, h = loc * loc, u = 0, m, g, f;\n\n                    if (degree === 2) {\n                        o = [o[0], o[1], o[2], EMPTY_POINT];\n                        m = l;\n                        g = 2 * (s * loc);\n                        f = h;\n                    } else if (degree === 3) {\n                        m = l * s;\n                        g = 3 * (l * loc);\n                        f = 3 * (s * h);\n                        u = loc * h;\n                    }\n\n                    return {\n                        x: m * o[0].x + g * o[1].x + f * o[2].x + u * o[3].x,\n                        y: m * o[0].y + g * o[1].y + f * o[2].y + u * o[3].y\n                    };\n                } else {\n                    return EMPTY_POINT; // not supported.\n                }\n            }.bind(this);\n\n            var _getLUT = function(steps) {\n                var out = [];\n                steps--;\n                for (var n = 0; n <= steps; n++) {\n                    out.push(_compute(n / steps));\n                }\n                return out;\n            };\n\n            var _computeLength = function() {\n\n                if (_isPoint(this.curve)) {\n                    this.length = 0;\n                }\n\n                var steps = 16;\n                var  lut = _getLUT(steps);\n                this.length = 0;\n\n                for (var i = 0; i < steps - 1; i++) {\n                    var a = lut[i], b = lut[i + 1];\n                    this.length += _dist(a, b);\n                }\n            }.bind(this);\n\n            var _super = _jp.Segments.AbstractSegment.apply(this, arguments);\n            // although this is not a strictly rigorous determination of bounds\n            // of a bezier curve, it works for the types of curves that this segment\n            // type produces.\n            this.bounds = {\n                minX: Math.min(params.x1, params.x2, params.cp1x, params.cp2x),\n                minY: Math.min(params.y1, params.y2, params.cp1y, params.cp2y),\n                maxX: Math.max(params.x1, params.x2, params.cp1x, params.cp2x),\n                maxY: Math.max(params.y1, params.y2, params.cp1y, params.cp2y)\n            };\n\n            this.type = \"Bezier\";\n\n            _computeLength();\n\n            var _translateLocation = function (_curve, location, absolute) {\n                if (absolute) {\n                    location = root.jsBezier.locationAlongCurveFrom(_curve, location > 0 ? 0 : 1, location);\n                }\n\n                return location;\n            };\n\n            /**\n             * returns the point on the segment's path that is 'location' along the length of the path, where 'location' is a decimal from\n             * 0 to 1 inclusive.\n             */\n            this.pointOnPath = function (location, absolute) {\n                location = _translateLocation(this.curve, location, absolute);\n                return root.jsBezier.pointOnCurve(this.curve, location);\n            };\n\n            /**\n             * returns the gradient of the segment at the given point.\n             */\n            this.gradientAtPoint = function (location, absolute) {\n                location = _translateLocation(this.curve, location, absolute);\n                return root.jsBezier.gradientAtPoint(this.curve, location);\n            };\n\n            this.pointAlongPathFrom = function (location, distance, absolute) {\n                location = _translateLocation(this.curve, location, absolute);\n                return root.jsBezier.pointAlongCurveFrom(this.curve, location, distance);\n            };\n\n            this.getLength = function () {\n                return this.length;\n            };\n\n            this.getBounds = function () {\n                return this.bounds;\n            };\n\n            this.findClosestPointOnPath = function (x, y) {\n                var p = root.jsBezier.nearestPointOnCurve({x:x,y:y}, this.curve);\n                return {\n                    d:Math.sqrt(Math.pow(p.point.x - x, 2) + Math.pow(p.point.y - y, 2)),\n                    x:p.point.x,\n                    y:p.point.y,\n                    l:1 - p.location,\n                    s:this\n                };\n            };\n\n            this.lineIntersection = function(x1, y1, x2, y2) {\n                return root.jsBezier.lineIntersection(x1, y1, x2, y2, this.curve);\n            };\n        }\n    };\n\n    _jp.SegmentRenderer = {\n        getPath: function (segment, isFirstSegment) {\n            return ({\n                \"Straight\": function (isFirstSegment) {\n                    var d = segment.getCoordinates();\n                    return (isFirstSegment ? \"M \" + d.x1 + \" \" + d.y1 + \" \" : \"\") + \"L \" + d.x2 + \" \" + d.y2;\n                },\n                \"Bezier\": function (isFirstSegment) {\n                    var d = segment.params;\n                    return (isFirstSegment ? \"M \" + d.x2 + \" \" + d.y2 + \" \" : \"\") +\n                        \"C \" + d.cp2x + \" \" + d.cp2y + \" \" + d.cp1x + \" \" + d.cp1y + \" \" + d.x1 + \" \" + d.y1;\n                },\n                \"Arc\": function (isFirstSegment) {\n                    var d = segment.params,\n                        laf = segment.sweep > Math.PI ? 1 : 0,\n                        sf = segment.anticlockwise ? 0 : 1;\n\n                    return  (isFirstSegment ? \"M\" + segment.x1 + \" \" + segment.y1  + \" \" : \"\")  + \"A \" + segment.radius + \" \" + d.r + \" 0 \" + laf + \",\" + sf + \" \" + segment.x2 + \" \" + segment.y2;\n                }\n            })[segment.type](isFirstSegment);\n        }\n    };\n\n    /*\n     Class: UIComponent\n     Superclass for Connector and AbstractEndpoint.\n     */\n    var AbstractComponent = function () {\n        this.resetBounds = function () {\n            this.bounds = { minX: Infinity, minY: Infinity, maxX: -Infinity, maxY: -Infinity };\n        };\n        this.resetBounds();\n    };\n\n    /*\n     * Class: Connector\n     * Superclass for all Connectors; here is where Segments are managed.  This is exposed on jsPlumb just so it\n     * can be accessed from other files. You should not try to instantiate one of these directly.\n     *\n     * When this class is asked for a pointOnPath, or gradient etc, it must first figure out which segment to dispatch\n     * that request to. This is done by keeping track of the total connector length as segments are added, and also\n     * their cumulative ratios to the total length.  Then when the right segment is found it is a simple case of dispatching\n     * the request to it (and adjusting 'location' so that it is relative to the beginning of that segment.)\n     */\n    _jp.Connectors.AbstractConnector = function (params) {\n\n        AbstractComponent.apply(this, arguments);\n\n        var segments = [],\n            totalLength = 0,\n            segmentProportions = [],\n            segmentProportionalLengths = [],\n            stub = params.stub || 0,\n            sourceStub = _ju.isArray(stub) ? stub[0] : stub,\n            targetStub = _ju.isArray(stub) ? stub[1] : stub,\n            gap = params.gap || 0,\n            sourceGap = _ju.isArray(gap) ? gap[0] : gap,\n            targetGap = _ju.isArray(gap) ? gap[1] : gap,\n            userProvidedSegments = null,\n            paintInfo = null;\n\n        this.getPathData = function() {\n            var p = \"\";\n            for (var i = 0; i < segments.length; i++) {\n                p += _jp.SegmentRenderer.getPath(segments[i], i === 0);\n                p += \" \";\n            }\n            return p;\n        };\n\n        /**\n         * Function: findSegmentForPoint\n         * Returns the segment that is closest to the given [x,y],\n         * null if nothing found.  This function returns a JS\n         * object with:\n         *\n         *   d   -   distance from segment\n         *   l   -   proportional location in segment\n         *   x   -   x point on the segment\n         *   y   -   y point on the segment\n         *   s   -   the segment itself.\n         *   connectorLocation - the location on the connector of the point, expressed as a decimal between 0 and 1 inclusive.\n         */\n        this.findSegmentForPoint = function (x, y) {\n            var out = { d: Infinity, s: null, x: null, y: null, l: null };\n            for (var i = 0; i < segments.length; i++) {\n                var _s = segments[i].findClosestPointOnPath(x, y);\n                if (_s.d < out.d) {\n                    out.d = _s.d;\n                    out.l = _s.l;\n                    out.x = _s.x;\n                    out.y = _s.y;\n                    out.s = segments[i];\n                    out.x1 = _s.x1;\n                    out.x2 = _s.x2;\n                    out.y1 = _s.y1;\n                    out.y2 = _s.y2;\n                    out.index = i;\n                    out.connectorLocation = segmentProportions[i][0] + (_s.l * (segmentProportions[i][1] - segmentProportions[i][0]));\n                }\n            }\n\n            return out;\n        };\n\n        this.lineIntersection = function(x1, y1, x2, y2) {\n            var out = [];\n            for (var i = 0; i < segments.length; i++) {\n                out.push.apply(out, segments[i].lineIntersection(x1, y1, x2, y2));\n            }\n            return out;\n        };\n\n        this.boxIntersection = function(x, y, w, h) {\n            var out = [];\n            for (var i = 0; i < segments.length; i++) {\n                out.push.apply(out, segments[i].boxIntersection(x, y, w, h));\n            }\n            return out;\n        };\n\n        this.boundingBoxIntersection = function(box) {\n            var out = [];\n            for (var i = 0; i < segments.length; i++) {\n                out.push.apply(out, segments[i].boundingBoxIntersection(box));\n            }\n            return out;\n        };\n\n        var _updateSegmentProportions = function () {\n                var curLoc = 0;\n                for (var i = 0; i < segments.length; i++) {\n                    var sl = segments[i].getLength();\n                    segmentProportionalLengths[i] = sl / totalLength;\n                    segmentProportions[i] = [curLoc, (curLoc += (sl / totalLength)) ];\n                }\n            },\n\n            /**\n             * returns [segment, proportion of travel in segment, segment index] for the segment\n             * that contains the point which is 'location' distance along the entire path, where\n             * 'location' is a decimal between 0 and 1 inclusive. in this connector type, paths\n             * are made up of a list of segments, each of which contributes some fraction to\n             * the total length.\n             * From 1.3.10 this also supports the 'absolute' property, which lets us specify a location\n             * as the absolute distance in pixels, rather than a proportion of the total path.\n             */\n            _findSegmentForLocation = function (location, absolute) {\n\n                var idx, i, inSegmentProportion;\n\n                if (absolute) {\n                    location = location > 0 ? location / totalLength : (totalLength + location) / totalLength;\n                }\n\n                // if location 1 we know its the last segment\n                if (location === 1) {\n                    idx = segments.length - 1;\n                    inSegmentProportion = 1;\n                } else if (location === 0) {\n                    // if location 0 we know its the first segment\n                    inSegmentProportion = 0;\n                    idx = 0;\n                } else {\n\n                    // if location >= 0.5, traverse backwards (of course not exact, who knows the segment proportions. but\n                    // an educated guess at least)\n                    if (location >= 0.5) {\n\n                        idx = 0;\n                        inSegmentProportion = 0;\n                        for (i = segmentProportions.length - 1; i > -1; i--) {\n                            if (segmentProportions[i][1] >= location && segmentProportions[i][0] <= location) {\n                                idx = i;\n                                inSegmentProportion = (location - segmentProportions[i][0]) / segmentProportionalLengths[i];\n                                break;\n                            }\n                        }\n\n                    } else {\n                        idx = segmentProportions.length - 1;\n                        inSegmentProportion = 1;\n                        for (i = 0; i < segmentProportions.length; i++) {\n                            if (segmentProportions[i][1] >= location) {\n                                idx = i;\n                                inSegmentProportion = (location - segmentProportions[i][0]) / segmentProportionalLengths[i];\n                                break;\n                            }\n                        }\n                    }\n                }\n\n                return { segment: segments[idx], proportion: inSegmentProportion, index: idx };\n            },\n            _addSegment = function (conn, type, params) {\n                if (params.x1 === params.x2 && params.y1 === params.y2) {\n                    return;\n                }\n                var s = new _jp.Segments[type](params);\n                segments.push(s);\n                totalLength += s.getLength();\n                conn.updateBounds(s);\n            },\n            _clearSegments = function () {\n                totalLength = segments.length = segmentProportions.length = segmentProportionalLengths.length = 0;\n            };\n\n        this.setSegments = function (_segs) {\n            userProvidedSegments = [];\n            totalLength = 0;\n            for (var i = 0; i < _segs.length; i++) {\n                userProvidedSegments.push(_segs[i]);\n                totalLength += _segs[i].getLength();\n            }\n        };\n\n        this.getLength = function() {\n            return totalLength;\n        };\n\n        var _prepareCompute = function (params) {\n            this.strokeWidth = params.strokeWidth;\n            var segment = _jg.quadrant(params.sourcePos, params.targetPos),\n                swapX = params.targetPos[0] < params.sourcePos[0],\n                swapY = params.targetPos[1] < params.sourcePos[1],\n                lw = params.strokeWidth || 1,\n                so = params.sourceEndpoint.anchor.getOrientation(params.sourceEndpoint),\n                to = params.targetEndpoint.anchor.getOrientation(params.targetEndpoint),\n                x = swapX ? params.targetPos[0] : params.sourcePos[0],\n                y = swapY ? params.targetPos[1] : params.sourcePos[1],\n                w = Math.abs(params.targetPos[0] - params.sourcePos[0]),\n                h = Math.abs(params.targetPos[1] - params.sourcePos[1]);\n            \n            // if either anchor does not have an orientation set, we derive one from their relative\n            // positions.  we fix the axis to be the one in which the two elements are further apart, and\n            // point each anchor at the other element.  this is also used when dragging a new connection.\n            if (so[0] === 0 && so[1] === 0 || to[0] === 0 && to[1] === 0) {\n                var index = w > h ? 0 : 1, oIndex = [1, 0][index];\n                so = [];\n                to = [];\n                so[index] = params.sourcePos[index] > params.targetPos[index] ? -1 : 1;\n                to[index] = params.sourcePos[index] > params.targetPos[index] ? 1 : -1;\n                so[oIndex] = 0;\n                to[oIndex] = 0;\n            }\n\n            var sx = swapX ? w + (sourceGap * so[0]) : sourceGap * so[0],\n                sy = swapY ? h + (sourceGap * so[1]) : sourceGap * so[1],\n                tx = swapX ? targetGap * to[0] : w + (targetGap * to[0]),\n                ty = swapY ? targetGap * to[1] : h + (targetGap * to[1]),\n                oProduct = ((so[0] * to[0]) + (so[1] * to[1]));\n\n            var result = {\n                sx: sx, sy: sy, tx: tx, ty: ty, lw: lw,\n                xSpan: Math.abs(tx - sx),\n                ySpan: Math.abs(ty - sy),\n                mx: (sx + tx) / 2,\n                my: (sy + ty) / 2,\n                so: so, to: to, x: x, y: y, w: w, h: h,\n                segment: segment,\n                startStubX: sx + (so[0] * sourceStub),\n                startStubY: sy + (so[1] * sourceStub),\n                endStubX: tx + (to[0] * targetStub),\n                endStubY: ty + (to[1] * targetStub),\n                isXGreaterThanStubTimes2: Math.abs(sx - tx) > (sourceStub + targetStub),\n                isYGreaterThanStubTimes2: Math.abs(sy - ty) > (sourceStub + targetStub),\n                opposite: oProduct === -1,\n                perpendicular: oProduct === 0,\n                orthogonal: oProduct === 1,\n                sourceAxis: so[0] === 0 ? \"y\" : \"x\",\n                points: [x, y, w, h, sx, sy, tx, ty ],\n                stubs:[sourceStub, targetStub]\n            };\n            result.anchorOrientation = result.opposite ? \"opposite\" : result.orthogonal ? \"orthogonal\" : \"perpendicular\";\n            return result;\n        };\n\n        this.getSegments = function () {\n            return segments;\n        };\n\n        this.updateBounds = function (segment) {\n            var segBounds = segment.getBounds();\n            this.bounds.minX = Math.min(this.bounds.minX, segBounds.minX);\n            this.bounds.maxX = Math.max(this.bounds.maxX, segBounds.maxX);\n            this.bounds.minY = Math.min(this.bounds.minY, segBounds.minY);\n            this.bounds.maxY = Math.max(this.bounds.maxY, segBounds.maxY);\n        };\n\n        var dumpSegmentsToConsole = function () {\n            console.log(\"SEGMENTS:\");\n            for (var i = 0; i < segments.length; i++) {\n                console.log(segments[i].type, segments[i].getLength(), segmentProportions[i]);\n            }\n        };\n\n        this.pointOnPath = function (location, absolute) {\n            var seg = _findSegmentForLocation(location, absolute);\n            return seg.segment && seg.segment.pointOnPath(seg.proportion, false) || [0, 0];\n        };\n\n        this.gradientAtPoint = function (location, absolute) {\n            var seg = _findSegmentForLocation(location, absolute);\n            return seg.segment && seg.segment.gradientAtPoint(seg.proportion, false) || 0;\n        };\n\n        this.pointAlongPathFrom = function (location, distance, absolute) {\n            var seg = _findSegmentForLocation(location, absolute);\n            // TODO what happens if this crosses to the next segment?\n            return seg.segment && seg.segment.pointAlongPathFrom(seg.proportion, distance, false) || [0, 0];\n        };\n\n        this.compute = function (params) {\n            paintInfo = _prepareCompute.call(this, params);\n\n            _clearSegments();\n            this._compute(paintInfo, params);\n            this.x = paintInfo.points[0];\n            this.y = paintInfo.points[1];\n            this.w = paintInfo.points[2];\n            this.h = paintInfo.points[3];\n            this.segment = paintInfo.segment;\n            _updateSegmentProportions();\n        };\n\n        return {\n            addSegment: _addSegment,\n            prepareCompute: _prepareCompute,\n            sourceStub: sourceStub,\n            targetStub: targetStub,\n            maxStub: Math.max(sourceStub, targetStub),\n            sourceGap: sourceGap,\n            targetGap: targetGap,\n            maxGap: Math.max(sourceGap, targetGap)\n        };\n    };\n    _ju.extend(_jp.Connectors.AbstractConnector, AbstractComponent);\n\n\n    // ********************************* END OF CONNECTOR TYPES *******************************************************************\n\n    // ********************************* ENDPOINT TYPES *******************************************************************\n\n    _jp.Endpoints.AbstractEndpoint = function (params) {\n        AbstractComponent.apply(this, arguments);\n        var compute = this.compute = function (anchorPoint, orientation, endpointStyle, connectorPaintStyle) {\n            var out = this._compute.apply(this, arguments);\n            this.x = out[0];\n            this.y = out[1];\n            this.w = out[2];\n            this.h = out[3];\n            this.bounds.minX = this.x;\n            this.bounds.minY = this.y;\n            this.bounds.maxX = this.x + this.w;\n            this.bounds.maxY = this.y + this.h;\n            return out;\n        };\n        return {\n            compute: compute,\n            cssClass: params.cssClass\n        };\n    };\n    _ju.extend(_jp.Endpoints.AbstractEndpoint, AbstractComponent);\n\n    /**\n     * Class: Endpoints.Dot\n     * A round endpoint, with default radius 10 pixels.\n     */\n\n    /**\n     * Function: Constructor\n     *\n     * Parameters:\n     *\n     *    radius    -    radius of the endpoint.  defaults to 10 pixels.\n     */\n    _jp.Endpoints.Dot = function (params) {\n        this.type = \"Dot\";\n        var _super = _jp.Endpoints.AbstractEndpoint.apply(this, arguments);\n        params = params || {};\n        this.radius = params.radius || 10;\n        this.defaultOffset = 0.5 * this.radius;\n        this.defaultInnerRadius = this.radius / 3;\n\n        this._compute = function (anchorPoint, orientation, endpointStyle, connectorPaintStyle) {\n            this.radius = endpointStyle.radius || this.radius;\n            var x = anchorPoint[0] - this.radius,\n                y = anchorPoint[1] - this.radius,\n                w = this.radius * 2,\n                h = this.radius * 2;\n\n            if (endpointStyle.stroke) {\n                var lw = endpointStyle.strokeWidth || 1;\n                x -= lw;\n                y -= lw;\n                w += (lw * 2);\n                h += (lw * 2);\n            }\n            return [ x, y, w, h, this.radius ];\n        };\n    };\n    _ju.extend(_jp.Endpoints.Dot, _jp.Endpoints.AbstractEndpoint);\n\n    _jp.Endpoints.Rectangle = function (params) {\n        this.type = \"Rectangle\";\n        var _super = _jp.Endpoints.AbstractEndpoint.apply(this, arguments);\n        params = params || {};\n        this.width = params.width || 20;\n        this.height = params.height || 20;\n\n        this._compute = function (anchorPoint, orientation, endpointStyle, connectorPaintStyle) {\n            var width = endpointStyle.width || this.width,\n                height = endpointStyle.height || this.height,\n                x = anchorPoint[0] - (width / 2),\n                y = anchorPoint[1] - (height / 2);\n\n            return [ x, y, width, height];\n        };\n    };\n    _ju.extend(_jp.Endpoints.Rectangle, _jp.Endpoints.AbstractEndpoint);\n\n    var DOMElementEndpoint = function (params) {\n        _jp.jsPlumbUIComponent.apply(this, arguments);\n        this._jsPlumb.displayElements = [];\n    };\n    _ju.extend(DOMElementEndpoint, _jp.jsPlumbUIComponent, {\n        getDisplayElements: function () {\n            return this._jsPlumb.displayElements;\n        },\n        appendDisplayElement: function (el) {\n            this._jsPlumb.displayElements.push(el);\n        }\n    });\n\n    /**\n     * Class: Endpoints.Image\n     * Draws an image as the Endpoint.\n     */\n    /**\n     * Function: Constructor\n     *\n     * Parameters:\n     *\n     *    src    -    location of the image to use.\n\n     TODO: multiple references to self. not sure quite how to get rid of them entirely. perhaps self = null in the cleanup\n     function will suffice\n\n     TODO this class still might leak memory.\n\n     */\n    _jp.Endpoints.Image = function (params) {\n\n        this.type = \"Image\";\n        DOMElementEndpoint.apply(this, arguments);\n        _jp.Endpoints.AbstractEndpoint.apply(this, arguments);\n\n        var _onload = params.onload,\n            src = params.src || params.url,\n            clazz = params.cssClass ? \" \" + params.cssClass : \"\";\n\n        this._jsPlumb.img = new Image();\n        this._jsPlumb.ready = false;\n        this._jsPlumb.initialized = false;\n        this._jsPlumb.deleted = false;\n        this._jsPlumb.widthToUse = params.width;\n        this._jsPlumb.heightToUse = params.height;\n        this._jsPlumb.endpoint = params.endpoint;\n\n        this._jsPlumb.img.onload = function () {\n            if (this._jsPlumb != null) {\n                this._jsPlumb.ready = true;\n                this._jsPlumb.widthToUse = this._jsPlumb.widthToUse || this._jsPlumb.img.width;\n                this._jsPlumb.heightToUse = this._jsPlumb.heightToUse || this._jsPlumb.img.height;\n                if (_onload) {\n                    _onload(this);\n                }\n            }\n        }.bind(this);\n\n        /*\n         Function: setImage\n         Sets the Image to use in this Endpoint.\n\n         Parameters:\n         img         -   may be a URL or an Image object\n         onload      -   optional; a callback to execute once the image has loaded.\n         */\n        this._jsPlumb.endpoint.setImage = function (_img, onload) {\n            var s = _img.constructor === String ? _img : _img.src;\n            _onload = onload;\n            this._jsPlumb.img.src = s;\n\n            if (this.canvas != null) {\n                this.canvas.setAttribute(\"src\", this._jsPlumb.img.src);\n            }\n        }.bind(this);\n\n        this._jsPlumb.endpoint.setImage(src, _onload);\n        this._compute = function (anchorPoint, orientation, endpointStyle, connectorPaintStyle) {\n            this.anchorPoint = anchorPoint;\n            if (this._jsPlumb.ready) {\n                return [anchorPoint[0] - this._jsPlumb.widthToUse / 2, anchorPoint[1] - this._jsPlumb.heightToUse / 2,\n                    this._jsPlumb.widthToUse, this._jsPlumb.heightToUse];\n            }\n            else {\n                return [0, 0, 0, 0];\n            }\n        };\n\n        this.canvas = _jp.createElement(\"img\", {\n            position:\"absolute\",\n            margin:0,\n            padding:0,\n            outline:0\n        }, this._jsPlumb.instance.endpointClass + clazz);\n\n        if (this._jsPlumb.widthToUse) {\n            this.canvas.setAttribute(\"width\", this._jsPlumb.widthToUse);\n        }\n        if (this._jsPlumb.heightToUse) {\n            this.canvas.setAttribute(\"height\", this._jsPlumb.heightToUse);\n        }\n        this._jsPlumb.instance.appendElement(this.canvas);\n\n        this.actuallyPaint = function (d, style, anchor) {\n            if (!this._jsPlumb.deleted) {\n                if (!this._jsPlumb.initialized) {\n                    this.canvas.setAttribute(\"src\", this._jsPlumb.img.src);\n                    this.appendDisplayElement(this.canvas);\n                    this._jsPlumb.initialized = true;\n                }\n                var x = this.anchorPoint[0] - (this._jsPlumb.widthToUse / 2),\n                    y = this.anchorPoint[1] - (this._jsPlumb.heightToUse / 2);\n                _ju.sizeElement(this.canvas, x, y, this._jsPlumb.widthToUse, this._jsPlumb.heightToUse);\n            }\n        };\n\n        this.paint = function (style, anchor) {\n            if (this._jsPlumb != null) {  // may have been deleted\n                if (this._jsPlumb.ready) {\n                    this.actuallyPaint(style, anchor);\n                }\n                else {\n                    root.setTimeout(function () {\n                        this.paint(style, anchor);\n                    }.bind(this), 200);\n                }\n            }\n        };\n    };\n    _ju.extend(_jp.Endpoints.Image, [ DOMElementEndpoint, _jp.Endpoints.AbstractEndpoint ], {\n        cleanup: function (force) {\n            if (force) {\n                this._jsPlumb.deleted = true;\n                if (this.canvas) {\n                    this.canvas.parentNode.removeChild(this.canvas);\n                }\n                this.canvas = null;\n            }\n        }\n    });\n\n    /*\n     * Class: Endpoints.Blank\n     * An Endpoint that paints nothing (visible) on the screen.  Supports cssClass and hoverClass parameters like all Endpoints.\n     */\n    _jp.Endpoints.Blank = function (params) {\n        var _super = _jp.Endpoints.AbstractEndpoint.apply(this, arguments);\n        this.type = \"Blank\";\n        DOMElementEndpoint.apply(this, arguments);\n        this._compute = function (anchorPoint, orientation, endpointStyle, connectorPaintStyle) {\n            return [anchorPoint[0], anchorPoint[1], 10, 0];\n        };\n\n        var clazz = params.cssClass ? \" \" + params.cssClass : \"\";\n\n        this.canvas = _jp.createElement(\"div\", {\n            display: \"block\",\n            width: \"1px\",\n            height: \"1px\",\n            background: \"transparent\",\n            position: \"absolute\"\n        }, this._jsPlumb.instance.endpointClass + clazz);\n\n        this._jsPlumb.instance.appendElement(this.canvas);\n\n        this.paint = function (style, anchor) {\n            _ju.sizeElement(this.canvas, this.x, this.y, this.w, this.h);\n        };\n    };\n    _ju.extend(_jp.Endpoints.Blank, [_jp.Endpoints.AbstractEndpoint, DOMElementEndpoint], {\n        cleanup: function () {\n            if (this.canvas && this.canvas.parentNode) {\n                this.canvas.parentNode.removeChild(this.canvas);\n            }\n        }\n    });\n\n    /*\n     * Class: Endpoints.Triangle\n     * A triangular Endpoint.\n     */\n    /*\n     * Function: Constructor\n     *\n     * Parameters:\n     *\n     * width   width of the triangle's base.  defaults to 55 pixels.\n     * height  height of the triangle from base to apex.  defaults to 55 pixels.\n     */\n    _jp.Endpoints.Triangle = function (params) {\n        this.type = \"Triangle\";\n        _jp.Endpoints.AbstractEndpoint.apply(this, arguments);\n        var self = this;\n        params = params || {  };\n        params.width = params.width || 55;\n        params.height = params.height || 55;\n        this.width = params.width;\n        this.height = params.height;\n        this._compute = function (anchorPoint, orientation, endpointStyle, connectorPaintStyle) {\n            var width = endpointStyle.width || self.width,\n                height = endpointStyle.height || self.height,\n                x = anchorPoint[0] - (width / 2),\n                y = anchorPoint[1] - (height / 2);\n            return [ x, y, width, height ];\n        };\n    };\n// ********************************* END OF ENDPOINT TYPES *******************************************************************\n\n\n// ********************************* OVERLAY DEFINITIONS ***********************************************************************    \n\n    var AbstractOverlay = _jp.Overlays.AbstractOverlay = function (params) {\n        this.visible = true;\n        this.isAppendedAtTopLevel = true;\n        this.component = params.component;\n        this.loc = params.location == null ? 0.5 : params.location;\n        this.endpointLoc = params.endpointLocation == null ? [ 0.5, 0.5] : params.endpointLocation;\n        this.visible = params.visible !== false;\n    };\n    AbstractOverlay.prototype = {\n        cleanup: function (force) {\n            if (force) {\n                this.component = null;\n                this.canvas = null;\n                this.endpointLoc = null;\n            }\n        },\n        reattach:function(instance, component) { },\n        setVisible: function (val) {\n            this.visible = val;\n            this.component.repaint();\n        },\n        isVisible: function () {\n            return this.visible;\n        },\n        hide: function () {\n            this.setVisible(false);\n        },\n        show: function () {\n            this.setVisible(true);\n        },\n        incrementLocation: function (amount) {\n            this.loc += amount;\n            this.component.repaint();\n        },\n        setLocation: function (l) {\n            this.loc = l;\n            this.component.repaint();\n        },\n        getLocation: function () {\n            return this.loc;\n        },\n        updateFrom:function() { }\n    };\n\n\n    /*\n     * Class: Overlays.Arrow\n     *\n     * An arrow overlay, defined by four points: the head, the two sides of the tail, and a 'foldback' point at some distance along the length\n     * of the arrow that lines from each tail point converge into.  The foldback point is defined using a decimal that indicates some fraction\n     * of the length of the arrow and has a default value of 0.623.  A foldback point value of 1 would mean that the arrow had a straight line\n     * across the tail.\n     */\n    /*\n     * @constructor\n     *\n     * @param {Object} params Constructor params.\n     * @param {Number} [params.length] Distance in pixels from head to tail baseline. default 20.\n     * @param {Number} [params.width] Width in pixels of the tail baseline. default 20.\n     * @param {String} [params.fill] Style to use when filling the arrow.  defaults to \"black\".\n     * @param {String} [params.stroke] Style to use when stroking the arrow. defaults to null, which means the arrow is not stroked.\n     * @param {Number} [params.stroke-width] Line width to use when stroking the arrow. defaults to 1, but only used if stroke is not null.\n     * @param {Number} [params.foldback] Distance (as a decimal from 0 to 1 inclusive) along the length of the arrow marking the point the tail points should fold back to.  defaults to 0.623.\n     * @param {Number} [params.location] Distance (as a decimal from 0 to 1 inclusive) marking where the arrow should sit on the connector. defaults to 0.5.\n     * @param {NUmber} [params.direction] Indicates the direction the arrow points in. valid values are -1 and 1; 1 is default.\n     */\n    _jp.Overlays.Arrow = function (params) {\n        this.type = \"Arrow\";\n        AbstractOverlay.apply(this, arguments);\n        this.isAppendedAtTopLevel = false;\n        params = params || {};\n        var self = this;\n\n        this.length = params.length || 20;\n        this.width = params.width || 20;\n        this.id = params.id;\n        this.direction = (params.direction || 1) < 0 ? -1 : 1;\n        var paintStyle = params.paintStyle || { \"stroke-width\": 1 },\n        // how far along the arrow the lines folding back in come to. default is 62.3%.\n            foldback = params.foldback || 0.623;\n\n        this.computeMaxSize = function () {\n            return self.width * 1.5;\n        };\n\n        this.elementCreated = function(p, component) {\n            this.path = p;\n            if (params.events) {\n                for (var i in params.events) {\n                    _jp.on(p, i, params.events[i]);\n                }\n            }\n        };\n\n        this.draw = function (component, currentConnectionPaintStyle) {\n\n            var hxy, mid, txy, tail, cxy;\n            if (component.pointAlongPathFrom) {\n\n                if (_ju.isString(this.loc) || this.loc > 1 || this.loc < 0) {\n                    var l = parseInt(this.loc, 10),\n                        fromLoc = this.loc < 0 ? 1 : 0;\n                    hxy = component.pointAlongPathFrom(fromLoc, l, false);\n                    mid = component.pointAlongPathFrom(fromLoc, l - (this.direction * this.length / 2), false);\n                    txy = _jg.pointOnLine(hxy, mid, this.length);\n                }\n                else if (this.loc === 1) {\n                    hxy = component.pointOnPath(this.loc);\n                    mid = component.pointAlongPathFrom(this.loc, -(this.length));\n                    txy = _jg.pointOnLine(hxy, mid, this.length);\n\n                    if (this.direction === -1) {\n                        var _ = txy;\n                        txy = hxy;\n                        hxy = _;\n                    }\n                }\n                else if (this.loc === 0) {\n                    txy = component.pointOnPath(this.loc);\n                    mid = component.pointAlongPathFrom(this.loc, this.length);\n                    hxy = _jg.pointOnLine(txy, mid, this.length);\n                    if (this.direction === -1) {\n                        var __ = txy;\n                        txy = hxy;\n                        hxy = __;\n                    }\n                }\n                else {\n                    hxy = component.pointAlongPathFrom(this.loc, this.direction * this.length / 2);\n                    mid = component.pointOnPath(this.loc);\n                    txy = _jg.pointOnLine(hxy, mid, this.length);\n                }\n\n                tail = _jg.perpendicularLineTo(hxy, txy, this.width);\n                cxy = _jg.pointOnLine(hxy, txy, foldback * this.length);\n\n                var d = { hxy: hxy, tail: tail, cxy: cxy },\n                    stroke = paintStyle.stroke || currentConnectionPaintStyle.stroke,\n                    fill = paintStyle.fill || currentConnectionPaintStyle.stroke,\n                    lineWidth = paintStyle.strokeWidth || currentConnectionPaintStyle.strokeWidth;\n\n                return {\n                    component: component,\n                    d: d,\n                    \"stroke-width\": lineWidth,\n                    stroke: stroke,\n                    fill: fill,\n                    minX: Math.min(hxy.x, tail[0].x, tail[1].x),\n                    maxX: Math.max(hxy.x, tail[0].x, tail[1].x),\n                    minY: Math.min(hxy.y, tail[0].y, tail[1].y),\n                    maxY: Math.max(hxy.y, tail[0].y, tail[1].y)\n                };\n            }\n            else {\n                return {component: component, minX: 0, maxX: 0, minY: 0, maxY: 0};\n            }\n        };\n    };\n    _ju.extend(_jp.Overlays.Arrow, AbstractOverlay, {\n        updateFrom:function(d) {\n            this.length = d.length || this.length;\n            this.width = d.width|| this.width;\n            this.direction = d.direction != null ? d.direction : this.direction;\n            this.foldback = d.foldback|| this.foldback;\n        },\n        cleanup:function() {\n            if (this.path && this.path.parentNode) {\n                this.path.parentNode.removeChild(this.path);\n            }\n        }\n    });\n\n    /*\n     * Class: Overlays.PlainArrow\n     *\n     * A basic arrow.  This is in fact just one instance of the more generic case in which the tail folds back on itself to some\n     * point along the length of the arrow: in this case, that foldback point is the full length of the arrow.  so it just does\n     * a 'call' to Arrow with foldback set appropriately.\n     */\n    /*\n     * Function: Constructor\n     * See <Overlays.Arrow> for allowed parameters for this overlay.\n     */\n    _jp.Overlays.PlainArrow = function (params) {\n        params = params || {};\n        var p = _jp.extend(params, {foldback: 1});\n        _jp.Overlays.Arrow.call(this, p);\n        this.type = \"PlainArrow\";\n    };\n    _ju.extend(_jp.Overlays.PlainArrow, _jp.Overlays.Arrow);\n\n    /*\n     * Class: Overlays.Diamond\n     * \n     * A diamond. Like PlainArrow, this is a concrete case of the more generic case of the tail points converging on some point...it just\n     * happens that in this case, that point is greater than the length of the the arrow.\n     *\n     *      this could probably do with some help with positioning...due to the way it reuses the Arrow paint code, what Arrow thinks is the\n     *      center is actually 1/4 of the way along for this guy.  but we don't have any knowledge of pixels at this point, so we're kind of\n     *      stuck when it comes to helping out the Arrow class. possibly we could pass in a 'transpose' parameter or something. the value\n     *      would be -l/4 in this case - move along one quarter of the total length.\n     */\n    /*\n     * Function: Constructor\n     * See <Overlays.Arrow> for allowed parameters for this overlay.\n     */\n    _jp.Overlays.Diamond = function (params) {\n        params = params || {};\n        var l = params.length || 40,\n            p = _jp.extend(params, {length: l / 2, foldback: 2});\n        _jp.Overlays.Arrow.call(this, p);\n        this.type = \"Diamond\";\n    };\n    _ju.extend(_jp.Overlays.Diamond, _jp.Overlays.Arrow);\n\n    var _getDimensions = function (component, forceRefresh) {\n        if (component._jsPlumb.cachedDimensions == null || forceRefresh) {\n            component._jsPlumb.cachedDimensions = component.getDimensions();\n        }\n        return component._jsPlumb.cachedDimensions;\n    };\n\n    // abstract superclass for overlays that add an element to the DOM.\n    var AbstractDOMOverlay = function (params) {\n        _jp.jsPlumbUIComponent.apply(this, arguments);\n        AbstractOverlay.apply(this, arguments);\n\n        // hand off fired events to associated component.\n        var _f = this.fire;\n        this.fire = function () {\n            _f.apply(this, arguments);\n            if (this.component) {\n                this.component.fire.apply(this.component, arguments);\n            }\n        };\n\n        this.detached=false;\n        this.id = params.id;\n        this._jsPlumb.div = null;\n        this._jsPlumb.initialised = false;\n        this._jsPlumb.component = params.component;\n        this._jsPlumb.cachedDimensions = null;\n        this._jsPlumb.create = params.create;\n        this._jsPlumb.initiallyInvisible = params.visible === false;\n\n        this.getElement = function () {\n            if (this._jsPlumb.div == null) {\n                var div = this._jsPlumb.div = _jp.getElement(this._jsPlumb.create(this._jsPlumb.component));\n                div.style.position = \"absolute\";\n                jsPlumb.addClass(div, this._jsPlumb.instance.overlayClass + \" \" +\n                    (this.cssClass ? this.cssClass :\n                        params.cssClass ? params.cssClass : \"\"));\n                this._jsPlumb.instance.appendElement(div);\n                this._jsPlumb.instance.getId(div);\n                this.canvas = div;\n\n                // in IE the top left corner is what it placed at the desired location.  This will not\n                // be fixed. IE8 is not going to be supported for much longer.\n                var ts = \"translate(-50%, -50%)\";\n                div.style.webkitTransform = ts;\n                div.style.mozTransform = ts;\n                div.style.msTransform = ts;\n                div.style.oTransform = ts;\n                div.style.transform = ts;\n\n                // write the related component into the created element\n                div._jsPlumb = this;\n\n                if (params.visible === false) {\n                    div.style.display = \"none\";\n                }\n            }\n            return this._jsPlumb.div;\n        };\n\n        this.draw = function (component, currentConnectionPaintStyle, absolutePosition) {\n            var td = _getDimensions(this);\n            if (td != null && td.length === 2) {\n                var cxy = { x: 0, y: 0 };\n\n                // absolutePosition would have been set by a call to connection.setAbsoluteOverlayPosition.\n                if (absolutePosition) {\n                    cxy = { x: absolutePosition[0], y: absolutePosition[1] };\n                }\n                else if (component.pointOnPath) {\n                    var loc = this.loc, absolute = false;\n                    if (_ju.isString(this.loc) || this.loc < 0 || this.loc > 1) {\n                        loc = parseInt(this.loc, 10);\n                        absolute = true;\n                    }\n                    cxy = component.pointOnPath(loc, absolute);  // a connection\n                }\n                else {\n                    var locToUse = this.loc.constructor === Array ? this.loc : this.endpointLoc;\n                    cxy = { x: locToUse[0] * component.w,\n                        y: locToUse[1] * component.h };\n                }\n\n                var minx = cxy.x - (td[0] / 2),\n                    miny = cxy.y - (td[1] / 2);\n\n                return {\n                    component: component,\n                    d: { minx: minx, miny: miny, td: td, cxy: cxy },\n                    minX: minx,\n                    maxX: minx + td[0],\n                    minY: miny,\n                    maxY: miny + td[1]\n                };\n            }\n            else {\n                return {minX: 0, maxX: 0, minY: 0, maxY: 0};\n            }\n        };\n    };\n    _ju.extend(AbstractDOMOverlay, [_jp.jsPlumbUIComponent, AbstractOverlay], {\n        getDimensions: function () {\n            return [1,1];\n        },\n        setVisible: function (state) {\n            if (this._jsPlumb.div) {\n                this._jsPlumb.div.style.display = state ? \"block\" : \"none\";\n                // if initially invisible, dimensions are 0,0 and never get updated\n                if (state && this._jsPlumb.initiallyInvisible) {\n                    _getDimensions(this, true);\n                    this.component.repaint();\n                    this._jsPlumb.initiallyInvisible = false;\n                }\n            }\n        },\n        /*\n         * Function: clearCachedDimensions\n         * Clears the cached dimensions for the label. As a performance enhancement, label dimensions are\n         * cached from 1.3.12 onwards. The cache is cleared when you change the label text, of course, but\n         * there are other reasons why the text dimensions might change - if you make a change through CSS, for\n         * example, you might change the font size.  in that case you should explicitly call this method.\n         */\n        clearCachedDimensions: function () {\n            this._jsPlumb.cachedDimensions = null;\n        },\n        cleanup: function (force) {\n            if (force) {\n                if (this._jsPlumb.div != null) {\n                    this._jsPlumb.div._jsPlumb = null;\n                    this._jsPlumb.instance.removeElement(this._jsPlumb.div);\n                }\n            }\n            else {\n                // if not a forced cleanup, just detach child from parent for now.\n                if (this._jsPlumb && this._jsPlumb.div && this._jsPlumb.div.parentNode) {\n                    this._jsPlumb.div.parentNode.removeChild(this._jsPlumb.div);\n                }\n                this.detached = true;\n            }\n\n        },\n        reattach:function(instance, component) {\n            if (this._jsPlumb.div != null) {\n                instance.getContainer().appendChild(this._jsPlumb.div);\n            }\n            this.detached = false;\n        },\n        computeMaxSize: function () {\n            var td = _getDimensions(this);\n            return Math.max(td[0], td[1]);\n        },\n        paint: function (p, containerExtents) {\n            if (!this._jsPlumb.initialised) {\n                this.getElement();\n                p.component.appendDisplayElement(this._jsPlumb.div);\n                this._jsPlumb.initialised = true;\n                if (this.detached) {\n                    this._jsPlumb.div.parentNode.removeChild(this._jsPlumb.div);\n                }\n            }\n            this._jsPlumb.div.style.left = (p.component.x + p.d.minx) + \"px\";\n            this._jsPlumb.div.style.top = (p.component.y + p.d.miny) + \"px\";\n        }\n    });\n\n    /*\n     * Class: Overlays.Custom\n     * A Custom overlay. You supply a 'create' function which returns some DOM element, and jsPlumb positions it.\n     * The 'create' function is passed a Connection or Endpoint.\n     */\n    /*\n     * Function: Constructor\n     * \n     * Parameters:\n     * create - function for jsPlumb to call that returns a DOM element.\n     * location - distance (as a decimal from 0 to 1 inclusive) marking where the label should sit on the connector. defaults to 0.5.\n     * id - optional id to use for later retrieval of this overlay.\n     *\n     */\n    _jp.Overlays.Custom = function (params) {\n        this.type = \"Custom\";\n        AbstractDOMOverlay.apply(this, arguments);\n    };\n    _ju.extend(_jp.Overlays.Custom, AbstractDOMOverlay);\n\n    _jp.Overlays.GuideLines = function () {\n        var self = this;\n        self.length = 50;\n        self.strokeWidth = 5;\n        this.type = \"GuideLines\";\n        AbstractOverlay.apply(this, arguments);\n        _jp.jsPlumbUIComponent.apply(this, arguments);\n        this.draw = function (connector, currentConnectionPaintStyle) {\n\n            var head = connector.pointAlongPathFrom(self.loc, self.length / 2),\n                mid = connector.pointOnPath(self.loc),\n                tail = _jg.pointOnLine(head, mid, self.length),\n                tailLine = _jg.perpendicularLineTo(head, tail, 40),\n                headLine = _jg.perpendicularLineTo(tail, head, 20);\n\n            return {\n                connector: connector,\n                head: head,\n                tail: tail,\n                headLine: headLine,\n                tailLine: tailLine,\n                minX: Math.min(head.x, tail.x, headLine[0].x, headLine[1].x),\n                minY: Math.min(head.y, tail.y, headLine[0].y, headLine[1].y),\n                maxX: Math.max(head.x, tail.x, headLine[0].x, headLine[1].x),\n                maxY: Math.max(head.y, tail.y, headLine[0].y, headLine[1].y)\n            };\n        };\n\n        // this.cleanup = function() { };  // nothing to clean up for GuideLines\n    };\n\n    /*\n     * Class: Overlays.Label\n\n     */\n    /*\n     * Function: Constructor\n     * \n     * Parameters:\n     * cssClass - optional css class string to append to css class. This string is appended \"as-is\", so you can of course have multiple classes\n     *             defined.  This parameter is preferred to using labelStyle, borderWidth and borderStyle.\n     * label - the label to paint.  May be a string or a function that returns a string.  Nothing will be painted if your label is null or your\n     *         label function returns null.  empty strings _will_ be painted.\n     * location - distance (as a decimal from 0 to 1 inclusive) marking where the label should sit on the connector. defaults to 0.5.\n     * id - optional id to use for later retrieval of this overlay.\n     * \n     *\n     */\n    _jp.Overlays.Label = function (params) {\n        this.labelStyle = params.labelStyle;\n\n        var labelWidth = null, labelHeight = null, labelText = null, labelPadding = null;\n        this.cssClass = this.labelStyle != null ? this.labelStyle.cssClass : null;\n        var p = _jp.extend({\n            create: function () {\n                return _jp.createElement(\"div\");\n            }}, params);\n        _jp.Overlays.Custom.call(this, p);\n        this.type = \"Label\";\n        this.label = params.label || \"\";\n        this.labelText = null;\n        if (this.labelStyle) {\n            var el = this.getElement();\n            this.labelStyle.font = this.labelStyle.font || \"12px sans-serif\";\n            el.style.font = this.labelStyle.font;\n            el.style.color = this.labelStyle.color || \"black\";\n            if (this.labelStyle.fill) {\n                el.style.background = this.labelStyle.fill;\n            }\n            if (this.labelStyle.borderWidth > 0) {\n                var dStyle = this.labelStyle.borderStyle ? this.labelStyle.borderStyle : \"black\";\n                el.style.border = this.labelStyle.borderWidth + \"px solid \" + dStyle;\n            }\n            if (this.labelStyle.padding) {\n                el.style.padding = this.labelStyle.padding;\n            }\n        }\n\n    };\n    _ju.extend(_jp.Overlays.Label, _jp.Overlays.Custom, {\n        cleanup: function (force) {\n            if (force) {\n                this.div = null;\n                this.label = null;\n                this.labelText = null;\n                this.cssClass = null;\n                this.labelStyle = null;\n            }\n        },\n        getLabel: function () {\n            return this.label;\n        },\n        /*\n         * Function: setLabel\n         * sets the label's, um, label.  you would think i'd call this function\n         * 'setText', but you can pass either a Function or a String to this, so\n         * it makes more sense as 'setLabel'. This uses innerHTML on the label div, so keep\n         * that in mind if you need escaped HTML.\n         */\n        setLabel: function (l) {\n            this.label = l;\n            this.labelText = null;\n            this.clearCachedDimensions();\n            this.update();\n            this.component.repaint();\n        },\n        getDimensions: function () {\n            this.update();\n            return AbstractDOMOverlay.prototype.getDimensions.apply(this, arguments);\n        },\n        update: function () {\n            if (typeof this.label === \"function\") {\n                var lt = this.label(this);\n                this.getElement().innerHTML = lt.replace(/\\r\\n/g, \"<br/>\");\n            }\n            else {\n                if (this.labelText == null) {\n                    this.labelText = this.label;\n                    this.getElement().innerHTML = this.labelText.replace(/\\r\\n/g, \"<br/>\");\n                }\n            }\n        },\n        updateFrom:function(d) {\n            if(d.label != null){\n                this.setLabel(d.label);\n            }\n        }\n    });\n\n    // ********************************* END OF OVERLAY DEFINITIONS ***********************************************************************\n\n}).call(typeof window !== 'undefined' ? window : this);\n\n/*\n * Copyright (c) 2010 - 2020 jsPlumb (hello@jsplumbtoolkit.com)\n *\n * https://jsplumbtoolkit.com\n * https://github.com/jsplumb/jsplumb\n *\n * Dual licensed under the MIT and GPL2 licenses.\n */\n;(function() {\n    \"use strict\";\n\n    var root = this,\n        _ju = root.jsPlumbUtil,\n        _jpi = root.jsPlumbInstance;\n\n    var GROUP_COLLAPSED_CLASS = \"jtk-group-collapsed\";\n    var GROUP_EXPANDED_CLASS = \"jtk-group-expanded\";\n    var GROUP_CONTAINER_SELECTOR = \"[jtk-group-content]\";\n    var ELEMENT_DRAGGABLE_EVENT = \"elementDraggable\";\n    var STOP = \"stop\";\n    var REVERT = \"revert\";\n    var GROUP_MANAGER = \"_groupManager\";\n    var GROUP = \"_jsPlumbGroup\";\n    var GROUP_DRAG_SCOPE = \"_jsPlumbGroupDrag\";\n    var EVT_CHILD_ADDED = \"group:addMember\";\n    var EVT_CHILD_REMOVED = \"group:removeMember\";\n    var EVT_GROUP_ADDED = \"group:add\";\n    var EVT_GROUP_REMOVED = \"group:remove\";\n    var EVT_EXPAND = \"group:expand\";\n    var EVT_COLLAPSE = \"group:collapse\";\n    var EVT_GROUP_DRAG_STOP = \"groupDragStop\";\n    var EVT_CONNECTION_MOVED = \"connectionMoved\";\n    var EVT_INTERNAL_CONNECTION_DETACHED = \"internal.connectionDetached\";\n\n    var CMD_REMOVE_ALL = \"removeAll\";\n    var CMD_ORPHAN_ALL = \"orphanAll\";\n    var CMD_SHOW = \"show\";\n    var CMD_HIDE = \"hide\";\n\n    var GroupManager = function(_jsPlumb) {\n        var _managedGroups = {}, _connectionSourceMap = {}, _connectionTargetMap = {}, self = this;\n\n        // function findGroupFor(el) {\n        //     var c = _jsPlumb.getContainer();\n        //     var abort = false, g = null, child = null;\n        //     while (!abort) {\n        //         if (el == null || el === c) {\n        //             abort = true;\n        //         } else {\n        //             if (el[GROUP]) {\n        //                 g = el[GROUP];\n        //                 child = el;\n        //                 abort = true;\n        //             } else {\n        //                 el = el.parentNode;\n        //             }\n        //         }\n        //     }\n        //     return g;\n        // }\n\n        function isDescendant(el, parentEl) {\n            var c = _jsPlumb.getContainer();\n            var abort = false, g = null, child = null;\n            while (!abort) {\n                if (el == null || el === c) {\n                    return false;\n                } else {\n                    if (el === parentEl) {\n                        return true;\n                    } else {\n                        el = el.parentNode;\n                    }\n                }\n            }\n        }\n\n        _jsPlumb.bind(\"connection\", function(p) {\n\n            var sourceGroup = _jsPlumb.getGroupFor(p.source);\n            var targetGroup = _jsPlumb.getGroupFor(p.target);\n\n            if (sourceGroup != null && targetGroup != null && sourceGroup === targetGroup) {\n                _connectionSourceMap[p.connection.id] = sourceGroup;\n                _connectionTargetMap[p.connection.id] = sourceGroup;\n            }\n            else {\n                if (sourceGroup != null) {\n                    _ju.suggest(sourceGroup.connections.source, p.connection);\n                    _connectionSourceMap[p.connection.id] = sourceGroup;\n                }\n                if (targetGroup != null) {\n                    _ju.suggest(targetGroup.connections.target, p.connection);\n                    _connectionTargetMap[p.connection.id] = targetGroup;\n                }\n            }\n        });\n\n        function _cleanupDetachedConnection(conn) {\n            delete conn.proxies;\n            var group = _connectionSourceMap[conn.id], f;\n            if (group != null) {\n                f = function(c) { return c.id === conn.id; };\n                _ju.removeWithFunction(group.connections.source, f);\n                _ju.removeWithFunction(group.connections.target, f);\n                delete _connectionSourceMap[conn.id];\n            }\n\n            group = _connectionTargetMap[conn.id];\n            if (group != null) {\n                f = function(c) { return c.id === conn.id; };\n                _ju.removeWithFunction(group.connections.source, f);\n                _ju.removeWithFunction(group.connections.target, f);\n                delete _connectionTargetMap[conn.id];\n            }\n        }\n\n        _jsPlumb.bind(EVT_INTERNAL_CONNECTION_DETACHED, function(p) {\n            _cleanupDetachedConnection(p.connection);\n        });\n\n        _jsPlumb.bind(EVT_CONNECTION_MOVED, function(p) {\n            var connMap = p.index === 0 ? _connectionSourceMap : _connectionTargetMap;\n            var group = connMap[p.connection.id];\n            if (group) {\n                var list = group.connections[p.index === 0 ? \"source\" : \"target\"];\n                var idx = list.indexOf(p.connection);\n                if (idx !== -1) {\n                    list.splice(idx, 1);\n                }\n            }\n        });\n\n        this.addGroup = function(group) {\n            _jsPlumb.addClass(group.getEl(), GROUP_EXPANDED_CLASS);\n            _managedGroups[group.id] = group;\n            group.manager = this;\n            _updateConnectionsForGroup(group);\n            _jsPlumb.fire(EVT_GROUP_ADDED, { group:group });\n        };\n\n        this.addToGroup = function(group, el, doNotFireEvent) {\n            group = this.getGroup(group);\n            if (group) {\n                var groupEl = group.getEl();\n\n                if (el._isJsPlumbGroup) {\n                    return;\n                }\n                var currentGroup = el._jsPlumbGroup;\n                // if already a member of this group, do nothing\n                if (currentGroup !== group) {\n\n                    _jsPlumb.removeFromDragSelection(el);\n\n                    var elpos = _jsPlumb.getOffset(el, true);\n                    var cpos = group.collapsed ? _jsPlumb.getOffset(groupEl, true) : _jsPlumb.getOffset(group.getDragArea(), true);\n\n                    // otherwise, transfer to this group.\n                    if (currentGroup != null) {\n                        currentGroup.remove(el, false, doNotFireEvent, false, group);\n                        self.updateConnectionsForGroup(currentGroup);\n                    }\n                    group.add(el, doNotFireEvent/*, currentGroup*/);\n\n                    var handleDroppedConnections = function (list, index) {\n                        var oidx = index === 0 ? 1 : 0;\n                        list.each(function (c) {\n                            c.setVisible(false);\n                            if (c.endpoints[oidx].element._jsPlumbGroup === group) {\n                                c.endpoints[oidx].setVisible(false);\n                                _expandConnection(c, oidx, group);\n                            }\n                            else {\n                                c.endpoints[index].setVisible(false);\n                                _collapseConnection(c, index, group);\n                            }\n                        });\n                    };\n\n                    if (group.collapsed) {\n                        handleDroppedConnections(_jsPlumb.select({source: el}), 0);\n                        handleDroppedConnections(_jsPlumb.select({target: el}), 1);\n                    }\n\n                    var elId = _jsPlumb.getId(el);\n                    _jsPlumb.dragManager.setParent(el, elId, groupEl, _jsPlumb.getId(groupEl), elpos);\n\n                    var newPosition = { left: elpos.left - cpos.left, top: elpos.top - cpos.top };\n\n                    _jsPlumb.setPosition(el, newPosition);\n\n                    _jsPlumb.dragManager.revalidateParent(el, elId, elpos);\n\n                    self.updateConnectionsForGroup(group);\n\n                    _jsPlumb.revalidate(elId);\n\n                    if (!doNotFireEvent) {\n                        var p = {group: group, el: el, pos:newPosition};\n                        if (currentGroup) {\n                            p.sourceGroup = currentGroup;\n                        }\n                        _jsPlumb.fire(EVT_CHILD_ADDED, p);\n                    }\n                }\n            }\n        };\n\n        this.removeFromGroup = function(group, el, doNotFireEvent) {\n            group = this.getGroup(group);\n            if (group) {\n\n                // if this group is currently collapsed then any proxied connections for the given el (or its descendants) need\n                // to be put back on their original element, and unproxied\n                if (group.collapsed) {\n                    var _expandSet = function (conns, index) {\n                        for (var i = 0; i < conns.length; i++) {\n                            var c = conns[i];\n                            if (c.proxies) {\n                                for(var j = 0; j < c.proxies.length; j++) {\n                                    if (c.proxies[j] != null) {\n                                        var proxiedElement = c.proxies[j].originalEp.element;\n                                        if (proxiedElement === el || isDescendant(proxiedElement, el)) {\n                                            _expandConnection(c, index, group);\n                                        }\n                                    }\n\n                                }\n                            }\n                        }\n                    };\n\n                    // setup proxies for sources and targets\n                    _expandSet(group.connections.source.slice(), 0);\n                    _expandSet(group.connections.target.slice(), 1);\n                }\n\n                group.remove(el, null, doNotFireEvent);\n            }\n        };\n\n        this.getGroup = function(groupId) {\n            var group = groupId;\n            if (_ju.isString(groupId)) {\n                group = _managedGroups[groupId];\n                if (group == null) {\n                    throw new TypeError(\"No such group [\" + groupId + \"]\");\n                }\n            }\n            return group;\n        };\n\n        this.getGroups = function() {\n            var o = [];\n            for (var g in _managedGroups) {\n                o.push(_managedGroups[g]);\n            }\n            return o;\n        };\n\n        this.removeGroup = function(group, deleteMembers, manipulateDOM, doNotFireEvent) {\n            group = this.getGroup(group);\n            this.expandGroup(group, true); // this reinstates any original connections and removes all proxies, but does not fire an event.\n            var newPositions = group[deleteMembers ? CMD_REMOVE_ALL : CMD_ORPHAN_ALL](manipulateDOM, doNotFireEvent);\n            _jsPlumb.remove(group.getEl());\n            delete _managedGroups[group.id];\n            delete _jsPlumb._groups[group.id];\n            _jsPlumb.fire(EVT_GROUP_REMOVED, { group:group });\n            return newPositions; // this will be null in the case or remove, but be a map of {id->[x,y]} in the case of orphan\n        };\n\n        this.removeAllGroups = function(deleteMembers, manipulateDOM, doNotFireEvent) {\n            for (var g in _managedGroups) {\n                this.removeGroup(_managedGroups[g], deleteMembers, manipulateDOM, doNotFireEvent);\n            }\n        };\n\n        function _setVisible(group, state) {\n\n            // TODO discovering the list of elements would ideally be a pluggable function.\n            var m = group.getEl().querySelectorAll(\".jtk-managed\");\n            for (var i = 0; i < m.length; i++) {\n                _jsPlumb[state ? CMD_SHOW : CMD_HIDE](m[i], true);\n            }\n        }\n\n        var _collapseConnection = function(c, index, group) {\n\n            var otherEl = c.endpoints[index === 0 ? 1 : 0].element;\n            if (otherEl[GROUP] && (!otherEl[GROUP].shouldProxy() && otherEl[GROUP].collapsed)) {\n                return;\n            }\n\n            var groupEl = group.getEl(), groupElId = _jsPlumb.getId(groupEl);\n\n            _jsPlumb.proxyConnection(c, index, groupEl, groupElId, function(c, index) { return group.getEndpoint(c, index); }, function(c, index) { return group.getAnchor(c, index); });\n        };\n\n        this.collapseGroup = function(group) {\n            group = this.getGroup(group);\n            if (group == null || group.collapsed) {\n                return;\n            }\n            var groupEl = group.getEl();\n\n            // todo remove old proxy endpoints first, just in case?\n            //group.proxies.length = 0;\n\n            // hide all connections\n            _setVisible(group, false);\n\n            if (group.shouldProxy()) {\n                // collapses all connections in a group.\n                var _collapseSet = function (conns, index) {\n                    for (var i = 0; i < conns.length; i++) {\n                        var c = conns[i];\n                        _collapseConnection(c, index, group);\n                    }\n                };\n\n                // setup proxies for sources and targets\n                _collapseSet(group.connections.source, 0);\n                _collapseSet(group.connections.target, 1);\n            }\n\n            group.collapsed = true;\n            _jsPlumb.removeClass(groupEl, GROUP_EXPANDED_CLASS);\n            _jsPlumb.addClass(groupEl, GROUP_COLLAPSED_CLASS);\n            _jsPlumb.revalidate(groupEl);\n            _jsPlumb.fire(EVT_COLLAPSE, { group:group  });\n        };\n\n        var _expandConnection = function(c, index, group) {\n            _jsPlumb.unproxyConnection(c, index, _jsPlumb.getId(group.getEl()));\n        };\n\n        this.expandGroup = function(group, doNotFireEvent) {\n\n            group = this.getGroup(group);\n\n            if (group == null || !group.collapsed) {\n                return;\n            }\n            var groupEl = group.getEl();\n\n            _setVisible(group, true);\n\n            if (group.shouldProxy()) {\n                // expands all connections in a group.\n                var _expandSet = function (conns, index) {\n                    for (var i = 0; i < conns.length; i++) {\n                        var c = conns[i];\n                        _expandConnection(c, index, group);\n                    }\n                };\n\n                // setup proxies for sources and targets\n                _expandSet(group.connections.source, 0);\n                _expandSet(group.connections.target, 1);\n            }\n\n            group.collapsed = false;\n            _jsPlumb.addClass(groupEl, GROUP_EXPANDED_CLASS);\n            _jsPlumb.removeClass(groupEl, GROUP_COLLAPSED_CLASS);\n            _jsPlumb.revalidate(groupEl);\n            this.repaintGroup(group);\n            if (!doNotFireEvent) {\n                _jsPlumb.fire(EVT_EXPAND, { group: group});\n            }\n        };\n\n        this.repaintGroup = function(group) {\n            group = this.getGroup(group);\n            var m = group.getMembers();\n            for (var i = 0; i < m.length; i++) {\n                _jsPlumb.revalidate(m[i]);\n            }\n        };\n\n        // TODO refactor this with the code that responds to `connection` events.\n        function _updateConnectionsForGroup(group) {\n            var members = group.getMembers().slice();\n\n            var childMembers = [];\n            for (var i = 0; i < members.length; i++) {\n                Array.prototype.push.apply(childMembers, members[i].querySelectorAll(\".jtk-managed\"));\n            }\n            Array.prototype.push.apply(members, childMembers);\n\n            var c1 = _jsPlumb.getConnections({source:members, scope:\"*\"}, true);\n            var c2 = _jsPlumb.getConnections({target:members, scope:\"*\"}, true);\n\n            var processed = {};\n            group.connections.source.length = 0;\n            group.connections.target.length = 0;\n            var oneSet = function(c) {\n                for (var i = 0; i < c.length; i++) {\n                    if (processed[c[i].id]) {\n                        continue;\n                    }\n                    processed[c[i].id] = true;\n                    var gs = _jsPlumb.getGroupFor(c[i].source),\n                        gt = _jsPlumb.getGroupFor(c[i].target);\n\n                    if (gs === group) {\n                        if (gt !== group) {\n                            group.connections.source.push(c[i]);\n                        }\n                        _connectionSourceMap[c[i].id] = group;\n                    }\n                    else if (gt === group) {\n                        group.connections.target.push(c[i]);\n                        _connectionTargetMap[c[i].id] = group;\n                    }\n                }\n            };\n            oneSet(c1); oneSet(c2);\n        }\n\n        this.updateConnectionsForGroup = _updateConnectionsForGroup;\n        this.refreshAllGroups = function() {\n            for (var g in _managedGroups) {\n                _updateConnectionsForGroup(_managedGroups[g]);\n                _jsPlumb.dragManager.updateOffsets(_jsPlumb.getId(_managedGroups[g].getEl()));\n            }\n        };\n    };\n\n    /**\n     *\n     * @param {jsPlumbInstance} _jsPlumb Associated jsPlumb instance.\n     * @param {Object} params\n     * @param {Element} params.el The DOM element representing the Group.\n     * @param {String} [params.id] Optional ID for the Group. A UUID will be assigned as the Group's ID if you do not provide one.\n     * @param {Boolean} [params.constrain=false] If true, child elements will not be able to be dragged outside of the Group container.\n     * @param {Boolean} [params.revert=true] By default, child elements revert to the container if dragged outside. You can change this by setting `revert:false`. This behaviour is also overridden if you set `orphan` or `prune`.\n     * @param {Boolean} [params.orphan=false] If true, child elements dropped outside of the Group container will be removed from the Group (but not from the DOM).\n     * @param {Boolean} [params.prune=false] If true, child elements dropped outside of the Group container will be removed from the Group and also from the DOM.\n     * @param {Boolean} [params.dropOverride=false] If true, a child element that has been dropped onto some other Group will not be subject to the controls imposed by `prune`, `revert` or `orphan`.\n     * @constructor\n     */\n    var Group = function(_jsPlumb, params) {\n        var self = this;\n        var el = params.el;\n        this.getEl = function() { return el; };\n        this.id = params.id || _ju.uuid();\n        el._isJsPlumbGroup = true;\n\n        var getDragArea = this.getDragArea = function() {\n            var da = _jsPlumb.getSelector(el, GROUP_CONTAINER_SELECTOR);\n            return da && da.length > 0 ? da[0] : el;\n        };\n\n        var ghost = params.ghost === true;\n        var constrain = ghost || (params.constrain === true);\n        var revert = params.revert !== false;\n        var orphan = params.orphan === true;\n        var prune = params.prune === true;\n        var dropOverride = params.dropOverride === true;\n        var proxied = params.proxied !== false;\n        var elements = [];\n        this.connections = { source:[], target:[], internal:[] };\n\n        // this function, and getEndpoint below, are stubs for a future setup in which we can choose endpoint\n        // and anchor based upon the connection and the index (source/target) of the endpoint to be proxied.\n        this.getAnchor = function(conn, endpointIndex) {\n            return params.anchor || \"Continuous\";\n        };\n\n        this.getEndpoint = function(conn, endpointIndex) {\n            return params.endpoint || [ \"Dot\", { radius:10 }];\n        };\n\n        this.collapsed = false;\n        if (params.draggable !== false) {\n            var opts = {\n                drag:function() {\n                    for (var i = 0; i < elements.length; i++) {\n                        _jsPlumb.draw(elements[i]);\n                    }\n                },\n                stop:function(params) {\n                    _jsPlumb.fire(EVT_GROUP_DRAG_STOP, jsPlumb.extend(params, {group:self}));\n                },\n                scope:GROUP_DRAG_SCOPE\n            };\n            if (params.dragOptions) {\n                root.jsPlumb.extend(opts, params.dragOptions);\n            }\n            _jsPlumb.draggable(params.el, opts);\n        }\n        if (params.droppable !== false) {\n            _jsPlumb.droppable(params.el, {\n                drop:function(p) {\n                    var el = p.drag.el;\n                    if (el._isJsPlumbGroup) {\n                        return;\n                    }\n                    var currentGroup = el._jsPlumbGroup;\n                    if (currentGroup !== self) {\n                        if (currentGroup != null) {\n                            if (currentGroup.overrideDrop(el, self)) {\n                                return;\n                            }\n                        }\n                        _jsPlumb.getGroupManager().addToGroup(self, el, false);\n                    }\n\n                }\n            });\n        }\n        var _each = function(_el, fn) {\n            var els = _el.nodeType == null ?  _el : [ _el ];\n            for (var i = 0; i < els.length; i++) {\n                fn(els[i]);\n            }\n        };\n\n        this.overrideDrop = function(_el, targetGroup) {\n            return dropOverride && (revert || prune || orphan);\n        };\n\n        this.add = function(_el, doNotFireEvent/*, sourceGroup*/) {\n            var dragArea = getDragArea();\n            _each(_el, function(__el) {\n\n                if (__el._jsPlumbGroup != null) {\n                    if (__el._jsPlumbGroup === self) {\n                        return;\n                    } else {\n                        __el._jsPlumbGroup.remove(__el, true, doNotFireEvent, false);\n                    }\n                }\n\n                __el._jsPlumbGroup = self;\n                elements.push(__el);\n                // test if draggable and add handlers if so.\n                if (_jsPlumb.isAlreadyDraggable(__el)) {\n                    _bindDragHandlers(__el);\n                }\n\n                if (__el.parentNode !== dragArea) {\n                    dragArea.appendChild(__el);\n                }\n\n                // if (!doNotFireEvent) {\n                //     var p = {group: self, el: __el};\n                //     if (sourceGroup) {\n                //         p.sourceGroup = sourceGroup;\n                //     }\n                //     //_jsPlumb.fire(EVT_CHILD_ADDED, p);\n                // }\n            });\n\n            _jsPlumb.getGroupManager().updateConnectionsForGroup(self);\n        };\n\n        this.remove = function(el, manipulateDOM, doNotFireEvent, doNotUpdateConnections, targetGroup) {\n\n            _each(el, function(__el) {\n                if (__el._jsPlumbGroup === self) {\n                    delete __el._jsPlumbGroup;\n                    _ju.removeWithFunction(elements, function (e) {\n                        return e === __el;\n                    });\n\n\n                    if (manipulateDOM) {\n                        try {\n                            self.getDragArea().removeChild(__el);\n                        } catch (e) {\n                            jsPlumbUtil.log(\"Could not remove element from Group \" + e);\n                        }\n                    }\n                    _unbindDragHandlers(__el);\n\n                    if (!doNotFireEvent) {\n                        var p = {group: self, el: __el};\n                        if (targetGroup) {\n                            p.targetGroup = targetGroup;\n                        }\n                        _jsPlumb.fire(EVT_CHILD_REMOVED, p);\n                    }\n                }\n            });\n            if (!doNotUpdateConnections) {\n                _jsPlumb.getGroupManager().updateConnectionsForGroup(self);\n            }\n        };\n        this.removeAll = function(manipulateDOM, doNotFireEvent) {\n            for (var i = 0, l = elements.length; i < l; i++) {\n                var el = elements[0];\n                self.remove(el, manipulateDOM, doNotFireEvent, true);\n                _jsPlumb.remove(el, true);\n            }\n            elements.length = 0;\n            _jsPlumb.getGroupManager().updateConnectionsForGroup(self);\n        };\n        this.orphanAll = function() {\n            var orphanedPositions = {};\n            for (var i = 0; i < elements.length; i++) {\n                var newPosition = _orphan(elements[i]);\n                orphanedPositions[newPosition[0]] = newPosition[1];\n            }\n            elements.length = 0;\n\n            return orphanedPositions;\n        };\n        this.getMembers = function() { return elements; };\n\n        el[GROUP] = this;\n\n        _jsPlumb.bind(ELEMENT_DRAGGABLE_EVENT, function(dragParams) {\n            // if its for the current group,\n            if (dragParams.el._jsPlumbGroup === this) {\n                _bindDragHandlers(dragParams.el);\n            }\n        }.bind(this));\n\n        function _findParent(_el) {\n            return _el.offsetParent;\n        }\n\n        function _isInsideParent(_el, pos) {\n            var p = _findParent(_el),\n                s = _jsPlumb.getSize(p),\n                ss = _jsPlumb.getSize(_el),\n                leftEdge = pos[0],\n                rightEdge = leftEdge + ss[0],\n                topEdge = pos[1],\n                bottomEdge = topEdge + ss[1];\n\n            return rightEdge > 0 && leftEdge < s[0] && bottomEdge > 0 && topEdge < s[1];\n        }\n\n        //\n        // orphaning an element means taking it out of the group and adding it to the main jsplumb container.\n        // we return the new calculated position from this method and the element's id.\n        //\n        function _orphan(_el) {\n            var id = _jsPlumb.getId(_el);\n            var pos = _jsPlumb.getOffset(_el);\n            _el.parentNode.removeChild(_el);\n            _jsPlumb.getContainer().appendChild(_el);\n            _jsPlumb.setPosition(_el, pos);\n            _unbindDragHandlers(_el);\n            _jsPlumb.dragManager.clearParent(_el, id);\n            return [id, pos];\n        }\n\n        //\n        // remove an element from the group, then either prune it from the jsplumb instance, or just orphan it.\n        //\n        function _pruneOrOrphan(p) {\n\n            var out = [];\n\n            function _one(el, left, top) {\n                var orphanedPosition = null;\n                if (!_isInsideParent(el, [left, top])) {\n                    var group = el._jsPlumbGroup;\n                    if (prune) {\n                        _jsPlumb.remove(el);\n                    } else {\n                        orphanedPosition = _orphan(el);\n                    }\n\n                    group.remove(el);\n                }\n\n                return orphanedPosition;\n            }\n\n            for (var i = 0; i < p.selection.length; i++) {\n                out.push(_one(p.selection[i][0], p.selection[i][1].left, p.selection[i][1].top));\n            }\n\n            return out.length === 1 ? out[0] : out;\n\n        }\n\n        //\n        // redraws the element\n        //\n        function _revalidate(_el) {\n            var id = _jsPlumb.getId(_el);\n            _jsPlumb.revalidate(_el);\n            _jsPlumb.dragManager.revalidateParent(_el, id);\n        }\n\n        //\n        // unbind the group specific drag/revert handlers.\n        //\n        function _unbindDragHandlers(_el) {\n            if (!_el._katavorioDrag) {\n                return;\n            }\n            if (prune || orphan) {\n                _el._katavorioDrag.off(STOP, _pruneOrOrphan);\n            }\n            if (!prune && !orphan && revert) {\n                _el._katavorioDrag.off(REVERT, _revalidate);\n                _el._katavorioDrag.setRevert(null);\n            }\n        }\n\n        function _bindDragHandlers(_el) {\n            if (!_el._katavorioDrag) {\n                return;\n            }\n            if (prune || orphan) {\n                _el._katavorioDrag.on(STOP, _pruneOrOrphan);\n            }\n\n            if (constrain) {\n                _el._katavorioDrag.setConstrain(true);\n            }\n\n            if (ghost) {\n                _el._katavorioDrag.setUseGhostProxy(true);\n            }\n\n            if (!prune && !orphan && revert) {\n                _el._katavorioDrag.on(REVERT, _revalidate);\n                _el._katavorioDrag.setRevert(function(__el, pos) {\n                    return !_isInsideParent(__el, pos);\n                });\n            }\n        }\n\n        this.shouldProxy = function() {\n            return proxied;\n        };\n\n        _jsPlumb.getGroupManager().addGroup(this);\n    };\n\n    /**\n     * Adds a group to the jsPlumb instance.\n     * @method addGroup\n     * @param {Object} params\n     * @return {Group} The newly created Group.\n     */\n    _jpi.prototype.addGroup = function(params) {\n        var j = this;\n        j._groups = j._groups || {};\n        if (j._groups[params.id] != null) {\n            throw new TypeError(\"cannot create Group [\" + params.id + \"]; a Group with that ID exists\");\n        }\n        if (params.el[GROUP] != null) {\n            throw new TypeError(\"cannot create Group [\" + params.id + \"]; the given element is already a Group\");\n        }\n        var group = new Group(j, params);\n        j._groups[group.id] = group;\n        if (params.collapsed) {\n            this.collapseGroup(group);\n        }\n        return group;\n    };\n\n    /**\n     * Add an element to a group.\n     * @method addToGroup\n     * @param {String} group Group, or ID of the group, to add the element to.\n     * @param {Element} el Element to add to the group.\n     */\n    _jpi.prototype.addToGroup = function(group, el, doNotFireEvent) {\n\n        var _one = function(_el) {\n            var id = this.getId(_el);\n            this.manage(id, _el);\n            this.getGroupManager().addToGroup(group, _el, doNotFireEvent);\n        }.bind(this);\n\n        if (Array.isArray(el)) {\n            for (var i = 0; i < el.length; i++) {\n                _one(el[i]);\n            }\n        } else {\n            _one(el);\n        }\n    };\n\n    /**\n     * Remove an element from a group, and sets its DOM element to be a child of the container again.  ??\n     * @method removeFromGroup\n     * @param {String} group Group, or ID of the group, to remove the element from.\n     * @param {Element} el Element to add to the group.\n     */\n    _jpi.prototype.removeFromGroup = function(group, el, doNotFireEvent) {\n        this.getGroupManager().removeFromGroup(group, el, doNotFireEvent);\n        this.getContainer().appendChild(el);\n    };\n\n    /**\n     * Remove a group, and optionally remove its members from the jsPlumb instance.\n     * @method removeGroup\n     * @param {String|Group} group Group to delete, or ID of Group to delete.\n     * @param {Boolean} [deleteMembers=false] If true, group members will be removed along with the group. Otherwise they will\n     * just be 'orphaned' (returned to the main container).\n     * @returns {Map[String, Position}} When deleteMembers is false, this method returns a map of {id->position}\n     */\n    _jpi.prototype.removeGroup = function(group, deleteMembers, manipulateDOM, doNotFireEvent) {\n        return this.getGroupManager().removeGroup(group, deleteMembers, manipulateDOM, doNotFireEvent);\n    };\n\n    /**\n     * Remove all groups, and optionally remove their members from the jsPlumb instance.\n     * @method removeAllGroup\n     * @param {Boolean} [deleteMembers=false] If true, group members will be removed along with the groups. Otherwise they will\n     * just be 'orphaned' (returned to the main container).\n     */\n    _jpi.prototype.removeAllGroups = function(deleteMembers, manipulateDOM, doNotFireEvent) {\n        this.getGroupManager().removeAllGroups(deleteMembers, manipulateDOM, doNotFireEvent);\n    };\n\n    /**\n     * Get a Group\n     * @method getGroup\n     * @param {String} groupId ID of the group to get\n     * @return {Group} Group with the given ID, null if not found.\n     */\n    _jpi.prototype.getGroup = function(groupId) {\n        return this.getGroupManager().getGroup(groupId);\n    };\n\n    /**\n     * Gets all the Groups managed by the jsPlumb instance.\n     * @returns {Group[]} List of Groups. Empty if none.\n     */\n    _jpi.prototype.getGroups = function() {\n        return this.getGroupManager().getGroups();\n    };\n\n    /**\n     * Expands a group element. jsPlumb doesn't do \"everything\" for you here, because what it means to expand a Group\n     * will vary from application to application. jsPlumb does these things:\n     *\n     * - Hides any connections that are internal to the group (connections between members, and connections from member of\n     * the group to the group itself)\n     * - Proxies all connections for which the source or target is a member of the group.\n     * - Hides the proxied connections.\n     * - Adds the jtk-group-expanded class to the group's element\n     * - Removes the jtk-group-collapsed class from the group's element.\n     *\n     * @method expandGroup\n     * @param {String|Group} group Group to expand, or ID of Group to expand.\n     */\n    _jpi.prototype.expandGroup = function(group) {\n        this.getGroupManager().expandGroup(group);\n    };\n\n    /**\n     * Collapses a group element. jsPlumb doesn't do \"everything\" for you here, because what it means to collapse a Group\n     * will vary from application to application. jsPlumb does these things:\n     *\n     * - Shows any connections that are internal to the group (connections between members, and connections from member of\n     * the group to the group itself)\n     * - Removes proxies for all connections for which the source or target is a member of the group.\n     * - Shows the previously proxied connections.\n     * - Adds the jtk-group-collapsed class to the group's element\n     * - Removes the jtk-group-expanded class from the group's element.\n     *\n     * @method expandGroup\n     * @param {String|Group} group Group to expand, or ID of Group to expand.\n     */\n    _jpi.prototype.collapseGroup = function(groupId) {\n        this.getGroupManager().collapseGroup(groupId);\n    };\n\n\n    _jpi.prototype.repaintGroup = function(group) {\n        this.getGroupManager().repaintGroup(group);\n    };\n\n    /**\n     * Collapses or expands a group element depending on its current state. See notes in the collapseGroup and expandGroup method.\n     *\n     * @method toggleGroup\n     * @param {String|Group} group Group to expand/collapse, or ID of Group to expand/collapse.\n     */\n    _jpi.prototype.toggleGroup = function(group) {\n        group = this.getGroupManager().getGroup(group);\n        if (group != null) {\n            this.getGroupManager()[group.collapsed ? \"expandGroup\" : \"collapseGroup\"](group);\n        }\n    };\n\n    //\n    // lazy init a group manager for the given jsplumb instance.\n    //\n    _jpi.prototype.getGroupManager = function() {\n        var mgr = this[GROUP_MANAGER];\n        if (mgr == null) {\n            mgr = this[GROUP_MANAGER] = new GroupManager(this);\n        }\n        return mgr;\n    };\n\n    _jpi.prototype.removeGroupManager = function() {\n        delete this[GROUP_MANAGER];\n    };\n\n    /**\n     * Gets the Group that the given element belongs to, null if none.\n     * @method getGroupFor\n     * @param {String|Element} el Element, or element ID.\n     * @returns {Group} A Group, if found, or null.\n     */\n    _jpi.prototype.getGroupFor = function(el) {\n        el = this.getElement(el);\n        if (el) {\n            var c = this.getContainer();\n            var abort = false, g = null, child = null;\n            while (!abort) {\n                if (el == null || el === c) {\n                    abort = true;\n                } else {\n                    if (el[GROUP]) {\n                        g = el[GROUP];\n                        child = el;\n                        abort = true;\n                    } else {\n                        el = el.parentNode;\n                    }\n                }\n            }\n            return g;\n        }\n    };\n\n}).call(typeof window !== 'undefined' ? window : this);\n\n\n/*\n * This file contains the 'flowchart' connectors, consisting of vertical and horizontal line segments.\n *\n * Copyright (c) 2010 - 2020 jsPlumb (hello@jsplumbtoolkit.com)\n *\n * https://jsplumbtoolkit.com\n * https://github.com/jsplumb/jsplumb\n *\n * Dual licensed under the MIT and GPL2 licenses.\n */\n;\n(function () {\n\n    \"use strict\";\n    var root = this, _jp = root.jsPlumb, _ju = root.jsPlumbUtil;\n    var STRAIGHT = \"Straight\";\n    var ARC = \"Arc\";\n\n    var Flowchart = function (params) {\n        this.type = \"Flowchart\";\n        params = params || {};\n        params.stub = params.stub == null ? 30 : params.stub;\n        var segments,\n            _super = _jp.Connectors.AbstractConnector.apply(this, arguments),\n            midpoint = params.midpoint == null ? 0.5 : params.midpoint,\n            alwaysRespectStubs = params.alwaysRespectStubs === true,\n            lastx = null, lasty = null, lastOrientation,\n            cornerRadius = params.cornerRadius != null ? params.cornerRadius : 0,\n\n            // TODO now common between this and AbstractBezierEditor; refactor into superclass?\n            loopbackRadius = params.loopbackRadius || 25,\n            isLoopbackCurrently = false,\n\n            sgn = function (n) {\n                return n < 0 ? -1 : n === 0 ? 0 : 1;\n            },\n            segmentDirections = function(segment) {\n            return [\n                    sgn( segment[2] - segment[0] ),\n                    sgn( segment[3] - segment[1] )\n                ];\n            },\n            /**\n             * helper method to add a segment.\n             */\n            addSegment = function (segments, x, y, paintInfo) {\n                if (lastx === x && lasty === y) {\n                    return;\n                }\n                var lx = lastx == null ? paintInfo.sx : lastx,\n                    ly = lasty == null ? paintInfo.sy : lasty,\n                    o = lx === x ? \"v\" : \"h\";\n\n                lastx = x;\n                lasty = y;\n                segments.push([ lx, ly, x, y, o ]);\n            },\n            segLength = function (s) {\n                return Math.sqrt(Math.pow(s[0] - s[2], 2) + Math.pow(s[1] - s[3], 2));\n            },\n            _cloneArray = function (a) {\n                var _a = [];\n                _a.push.apply(_a, a);\n                return _a;\n            },\n            writeSegments = function (conn, segments, paintInfo) {\n                var current = null, next, currentDirection, nextDirection;\n                for (var i = 0; i < segments.length - 1; i++) {\n\n                    current = current || _cloneArray(segments[i]);\n                    next = _cloneArray(segments[i + 1]);\n\n                    currentDirection = segmentDirections(current);\n                    nextDirection = segmentDirections(next);\n\n                    if (cornerRadius > 0 && current[4] !== next[4]) {\n\n                        var minSegLength = Math.min(segLength(current), segLength(next));\n                        var radiusToUse = Math.min(cornerRadius, minSegLength / 2);\n\n                        current[2] -= currentDirection[0] * radiusToUse;\n                        current[3] -= currentDirection[1] * radiusToUse;\n                        next[0] += nextDirection[0] * radiusToUse;\n                        next[1] += nextDirection[1] * radiusToUse;\n\n                        var ac = (currentDirection[1] === nextDirection[0] && nextDirection[0] === 1) ||\n                                ((currentDirection[1] === nextDirection[0] && nextDirection[0] === 0) && currentDirection[0] !== nextDirection[1]) ||\n                                (currentDirection[1] === nextDirection[0] && nextDirection[0] === -1),\n                                sgny = next[1] > current[3] ? 1 : -1,\n                                sgnx = next[0] > current[2] ? 1 : -1,\n                                sgnEqual = sgny === sgnx,\n                                cx = (sgnEqual && ac || (!sgnEqual && !ac)) ? next[0] : current[2],\n                                cy = (sgnEqual && ac || (!sgnEqual && !ac)) ? current[3] : next[1];\n\n                        _super.addSegment(conn, STRAIGHT, {\n                            x1: current[0], y1: current[1], x2: current[2], y2: current[3]\n                        });\n\n                        _super.addSegment(conn, ARC, {\n                            r: radiusToUse,\n                            x1: current[2],\n                            y1: current[3],\n                            x2: next[0],\n                            y2: next[1],\n                            cx: cx,\n                            cy: cy,\n                            ac: ac\n                        });\n                    }\n                    else {\n                        // dx + dy are used to adjust for line width.\n                        var dx = (current[2] === current[0]) ? 0 : (current[2] > current[0]) ? (paintInfo.lw / 2) : -(paintInfo.lw / 2),\n                            dy = (current[3] === current[1]) ? 0 : (current[3] > current[1]) ? (paintInfo.lw / 2) : -(paintInfo.lw / 2);\n\n                        _super.addSegment(conn, STRAIGHT, {\n                            x1: current[0] - dx, y1: current[1] - dy, x2: current[2] + dx, y2: current[3] + dy\n                        });\n                    }\n                    current = next;\n                }\n                if (next != null) {\n                    // last segment\n                    _super.addSegment(conn, STRAIGHT, {\n                        x1: next[0], y1: next[1], x2: next[2], y2: next[3]\n                    });\n                }\n            };\n\n        this._compute = function (paintInfo, params) {\n\n            segments = [];\n            lastx = null;\n            lasty = null;\n            lastOrientation = null;\n\n            var commonStubCalculator = function () {\n                    return [paintInfo.startStubX, paintInfo.startStubY, paintInfo.endStubX, paintInfo.endStubY];\n                },\n                stubCalculators = {\n                    perpendicular: commonStubCalculator,\n                    orthogonal: commonStubCalculator,\n                    opposite: function (axis) {\n                        var pi = paintInfo,\n                            idx = axis === \"x\" ? 0 : 1,\n                            areInProximity = {\n                                \"x\": function () {\n                                    return ( (pi.so[idx] === 1 && (\n                                        ( (pi.startStubX > pi.endStubX) && (pi.tx > pi.startStubX) ) ||\n                                        ( (pi.sx > pi.endStubX) && (pi.tx > pi.sx))))) ||\n\n                                        ( (pi.so[idx] === -1 && (\n                                        ( (pi.startStubX < pi.endStubX) && (pi.tx < pi.startStubX) ) ||\n                                        ( (pi.sx < pi.endStubX) && (pi.tx < pi.sx)))));\n                                },\n                                \"y\": function () {\n                                    return ( (pi.so[idx] === 1 && (\n                                        ( (pi.startStubY > pi.endStubY) && (pi.ty > pi.startStubY) ) ||\n                                        ( (pi.sy > pi.endStubY) && (pi.ty > pi.sy))))) ||\n\n                                        ( (pi.so[idx] === -1 && (\n                                        ( (pi.startStubY < pi.endStubY) && (pi.ty < pi.startStubY) ) ||\n                                        ( (pi.sy < pi.endStubY) && (pi.ty < pi.sy)))));\n                                }\n                            };\n\n                        if (!alwaysRespectStubs && areInProximity[axis]()) {\n                            return {\n                                \"x\": [(paintInfo.sx + paintInfo.tx) / 2, paintInfo.startStubY, (paintInfo.sx + paintInfo.tx) / 2, paintInfo.endStubY],\n                                \"y\": [paintInfo.startStubX, (paintInfo.sy + paintInfo.ty) / 2, paintInfo.endStubX, (paintInfo.sy + paintInfo.ty) / 2]\n                            }[axis];\n                        }\n                        else {\n                            return [paintInfo.startStubX, paintInfo.startStubY, paintInfo.endStubX, paintInfo.endStubY];\n                        }\n                    }\n                };\n\n            // calculate Stubs.\n            var stubs = stubCalculators[paintInfo.anchorOrientation](paintInfo.sourceAxis),\n                idx = paintInfo.sourceAxis === \"x\" ? 0 : 1,\n                oidx = paintInfo.sourceAxis === \"x\" ? 1 : 0,\n                ss = stubs[idx],\n                oss = stubs[oidx],\n                es = stubs[idx + 2],\n                oes = stubs[oidx + 2];\n\n            // add the start stub segment. use stubs for loopback as it will look better, with the loop spaced\n            // away from the element.\n            addSegment(segments, stubs[0], stubs[1], paintInfo);\n\n            // if its a loopback and we should treat it differently.\n            // if (false && params.sourcePos[0] === params.targetPos[0] && params.sourcePos[1] === params.targetPos[1]) {\n            //\n            //     // we use loopbackRadius here, as statemachine connectors do.\n            //     // so we go radius to the left from stubs[0], then upwards by 2*radius, to the right by 2*radius,\n            //     // down by 2*radius, left by radius.\n            //     addSegment(segments, stubs[0] - loopbackRadius, stubs[1], paintInfo);\n            //     addSegment(segments, stubs[0] - loopbackRadius, stubs[1] - (2 * loopbackRadius), paintInfo);\n            //     addSegment(segments, stubs[0] + loopbackRadius, stubs[1] - (2 * loopbackRadius), paintInfo);\n            //     addSegment(segments, stubs[0] + loopbackRadius, stubs[1], paintInfo);\n            //     addSegment(segments, stubs[0], stubs[1], paintInfo);\n            //\n            // }\n            // else {\n\n\n                var midx = paintInfo.startStubX + ((paintInfo.endStubX - paintInfo.startStubX) * midpoint),\n                    midy = paintInfo.startStubY + ((paintInfo.endStubY - paintInfo.startStubY) * midpoint);\n\n                var orientations = {x: [0, 1], y: [1, 0]},\n                    lineCalculators = {\n                        perpendicular: function (axis) {\n                            var pi = paintInfo,\n                                sis = {\n                                    x: [\n                                        [[1, 2, 3, 4], null, [2, 1, 4, 3]],\n                                        null,\n                                        [[4, 3, 2, 1], null, [3, 4, 1, 2]]\n                                    ],\n                                    y: [\n                                        [[3, 2, 1, 4], null, [2, 3, 4, 1]],\n                                        null,\n                                        [[4, 1, 2, 3], null, [1, 4, 3, 2]]\n                                    ]\n                                },\n                                stubs = {\n                                    x: [[pi.startStubX, pi.endStubX], null, [pi.endStubX, pi.startStubX]],\n                                    y: [[pi.startStubY, pi.endStubY], null, [pi.endStubY, pi.startStubY]]\n                                },\n                                midLines = {\n                                    x: [[midx, pi.startStubY], [midx, pi.endStubY]],\n                                    y: [[pi.startStubX, midy], [pi.endStubX, midy]]\n                                },\n                                linesToEnd = {\n                                    x: [[pi.endStubX, pi.startStubY]],\n                                    y: [[pi.startStubX, pi.endStubY]]\n                                },\n                                startToEnd = {\n                                    x: [[pi.startStubX, pi.endStubY], [pi.endStubX, pi.endStubY]],\n                                    y: [[pi.endStubX, pi.startStubY], [pi.endStubX, pi.endStubY]]\n                                },\n                                startToMidToEnd = {\n                                    x: [[pi.startStubX, midy], [pi.endStubX, midy], [pi.endStubX, pi.endStubY]],\n                                    y: [[midx, pi.startStubY], [midx, pi.endStubY], [pi.endStubX, pi.endStubY]]\n                                },\n                                otherStubs = {\n                                    x: [pi.startStubY, pi.endStubY],\n                                    y: [pi.startStubX, pi.endStubX]\n                                },\n                                soIdx = orientations[axis][0], toIdx = orientations[axis][1],\n                                _so = pi.so[soIdx] + 1,\n                                _to = pi.to[toIdx] + 1,\n                                otherFlipped = (pi.to[toIdx] === -1 && (otherStubs[axis][1] < otherStubs[axis][0])) || (pi.to[toIdx] === 1 && (otherStubs[axis][1] > otherStubs[axis][0])),\n                                stub1 = stubs[axis][_so][0],\n                                stub2 = stubs[axis][_so][1],\n                                segmentIndexes = sis[axis][_so][_to];\n\n                            if (pi.segment === segmentIndexes[3] || (pi.segment === segmentIndexes[2] && otherFlipped)) {\n                                return midLines[axis];\n                            }\n                            else if (pi.segment === segmentIndexes[2] && stub2 < stub1) {\n                                return linesToEnd[axis];\n                            }\n                            else if ((pi.segment === segmentIndexes[2] && stub2 >= stub1) || (pi.segment === segmentIndexes[1] && !otherFlipped)) {\n                                return startToMidToEnd[axis];\n                            }\n                            else if (pi.segment === segmentIndexes[0] || (pi.segment === segmentIndexes[1] && otherFlipped)) {\n                                return startToEnd[axis];\n                            }\n                        },\n                        orthogonal: function (axis, startStub, otherStartStub, endStub, otherEndStub) {\n                            var pi = paintInfo,\n                                extent = {\n                                    \"x\": pi.so[0] === -1 ? Math.min(startStub, endStub) : Math.max(startStub, endStub),\n                                    \"y\": pi.so[1] === -1 ? Math.min(startStub, endStub) : Math.max(startStub, endStub)\n                                }[axis];\n\n                            return {\n                                \"x\": [\n                                    [extent, otherStartStub],\n                                    [extent, otherEndStub],\n                                    [endStub, otherEndStub]\n                                ],\n                                \"y\": [\n                                    [otherStartStub, extent],\n                                    [otherEndStub, extent],\n                                    [otherEndStub, endStub]\n                                ]\n                            }[axis];\n                        },\n                        opposite: function (axis, ss, oss, es) {\n                            var pi = paintInfo,\n                                otherAxis = {\"x\": \"y\", \"y\": \"x\"}[axis],\n                                dim = {\"x\": \"height\", \"y\": \"width\"}[axis],\n                                comparator = pi[\"is\" + axis.toUpperCase() + \"GreaterThanStubTimes2\"];\n\n                            if (params.sourceEndpoint.elementId === params.targetEndpoint.elementId) {\n                                var _val = oss + ((1 - params.sourceEndpoint.anchor[otherAxis]) * params.sourceInfo[dim]) + _super.maxStub;\n                                return {\n                                    \"x\": [\n                                        [ss, _val],\n                                        [es, _val]\n                                    ],\n                                    \"y\": [\n                                        [_val, ss],\n                                        [_val, es]\n                                    ]\n                                }[axis];\n\n                            }\n                            else if (!comparator || (pi.so[idx] === 1 && ss > es) || (pi.so[idx] === -1 && ss < es)) {\n                                return {\n                                    \"x\": [\n                                        [ss, midy],\n                                        [es, midy]\n                                    ],\n                                    \"y\": [\n                                        [midx, ss],\n                                        [midx, es]\n                                    ]\n                                }[axis];\n                            }\n                            else if ((pi.so[idx] === 1 && ss < es) || (pi.so[idx] === -1 && ss > es)) {\n                                return {\n                                    \"x\": [\n                                        [midx, pi.sy],\n                                        [midx, pi.ty]\n                                    ],\n                                    \"y\": [\n                                        [pi.sx, midy],\n                                        [pi.tx, midy]\n                                    ]\n                                }[axis];\n                            }\n                        }\n                    };\n\n                // compute the rest of the line\n                var p = lineCalculators[paintInfo.anchorOrientation](paintInfo.sourceAxis, ss, oss, es, oes);\n                if (p) {\n                    for (var i = 0; i < p.length; i++) {\n                        addSegment(segments, p[i][0], p[i][1], paintInfo);\n                    }\n                }\n\n                // line to end stub\n                addSegment(segments, stubs[2], stubs[3], paintInfo);\n\n            //}\n\n            // end stub to end (common)\n            addSegment(segments, paintInfo.tx, paintInfo.ty, paintInfo);\n\n\n\n            // write out the segments.\n            writeSegments(this, segments, paintInfo);\n\n        };\n    };\n\n    _jp.Connectors.Flowchart = Flowchart;\n    _ju.extend(_jp.Connectors.Flowchart, _jp.Connectors.AbstractConnector);\n\n}).call(typeof window !== 'undefined' ? window : this);\n\n/*\n * This file contains the code for the Bezier connector type.\n *\n * Copyright (c) 2010 - 2020 jsPlumb (hello@jsplumbtoolkit.com)\n *\n * https://jsplumbtoolkit.com\n * https://github.com/jsplumb/jsplumb\n *\n * Dual licensed under the MIT and GPL2 licenses.\n */\n;\n(function () {\n\n    \"use strict\";\n    var root = this, _jp = root.jsPlumb, _ju = root.jsPlumbUtil;\n\n    _jp.Connectors.AbstractBezierConnector = function(params) {\n        params = params || {};\n        var showLoopback = params.showLoopback !== false,\n            curviness = params.curviness || 10,\n            margin = params.margin || 5,\n            proximityLimit = params.proximityLimit || 80,\n            clockwise = params.orientation && params.orientation === \"clockwise\",\n            loopbackRadius = params.loopbackRadius || 25,\n            isLoopbackCurrently = false,\n            _super;\n\n        this._compute = function (paintInfo, p) {\n\n            var sp = p.sourcePos,\n                tp = p.targetPos,\n                _w = Math.abs(sp[0] - tp[0]),\n                _h = Math.abs(sp[1] - tp[1]);\n\n            if (!showLoopback || (p.sourceEndpoint.elementId !== p.targetEndpoint.elementId)) {\n                isLoopbackCurrently = false;\n                this._computeBezier(paintInfo, p, sp, tp, _w, _h);\n            } else {\n                isLoopbackCurrently = true;\n                // a loopback connector.  draw an arc from one anchor to the other.\n                var x1 = p.sourcePos[0], y1 = p.sourcePos[1] - margin,\n                    cx = x1, cy = y1 - loopbackRadius,\n                // canvas sizing stuff, to ensure the whole painted area is visible.\n                    _x = cx - loopbackRadius,\n                    _y = cy - loopbackRadius;\n\n                _w = 2 * loopbackRadius;\n                _h = 2 * loopbackRadius;\n\n                paintInfo.points[0] = _x;\n                paintInfo.points[1] = _y;\n                paintInfo.points[2] = _w;\n                paintInfo.points[3] = _h;\n\n                // ADD AN ARC SEGMENT.\n                _super.addSegment(this, \"Arc\", {\n                    loopback: true,\n                    x1: (x1 - _x) + 4,\n                    y1: y1 - _y,\n                    startAngle: 0,\n                    endAngle: 2 * Math.PI,\n                    r: loopbackRadius,\n                    ac: !clockwise,\n                    x2: (x1 - _x) - 4,\n                    y2: y1 - _y,\n                    cx: cx - _x,\n                    cy: cy - _y\n                });\n            }\n        };\n\n        _super = _jp.Connectors.AbstractConnector.apply(this, arguments);\n        return _super;\n    };\n    _ju.extend(_jp.Connectors.AbstractBezierConnector, _jp.Connectors.AbstractConnector);\n\n    var Bezier = function (params) {\n        params = params || {};\n        this.type = \"Bezier\";\n\n        var _super = _jp.Connectors.AbstractBezierConnector.apply(this, arguments),\n            majorAnchor = params.curviness || 150,\n            minorAnchor = 10;\n\n        this.getCurviness = function () {\n            return majorAnchor;\n        };\n\n        this._findControlPoint = function (point, sourceAnchorPosition, targetAnchorPosition, sourceEndpoint, targetEndpoint, soo, too) {\n            // determine if the two anchors are perpendicular to each other in their orientation.  we swap the control\n            // points around if so (code could be tightened up)\n            var perpendicular = soo[0] !== too[0] || soo[1] === too[1],\n                p = [];\n\n            if (!perpendicular) {\n                if (soo[0] === 0) {\n                    p.push(sourceAnchorPosition[0] < targetAnchorPosition[0] ? point[0] + minorAnchor : point[0] - minorAnchor);\n                }\n                else {\n                    p.push(point[0] - (majorAnchor * soo[0]));\n                }\n\n                if (soo[1] === 0) {\n                    p.push(sourceAnchorPosition[1] < targetAnchorPosition[1] ? point[1] + minorAnchor : point[1] - minorAnchor);\n                }\n                else {\n                    p.push(point[1] + (majorAnchor * too[1]));\n                }\n            }\n            else {\n                if (too[0] === 0) {\n                    p.push(targetAnchorPosition[0] < sourceAnchorPosition[0] ? point[0] + minorAnchor : point[0] - minorAnchor);\n                }\n                else {\n                    p.push(point[0] + (majorAnchor * too[0]));\n                }\n\n                if (too[1] === 0) {\n                    p.push(targetAnchorPosition[1] < sourceAnchorPosition[1] ? point[1] + minorAnchor : point[1] - minorAnchor);\n                }\n                else {\n                    p.push(point[1] + (majorAnchor * soo[1]));\n                }\n            }\n\n            return p;\n        };\n\n        this._computeBezier = function (paintInfo, p, sp, tp, _w, _h) {\n\n            var _CP, _CP2,\n                _sx = sp[0] < tp[0] ? _w : 0,\n                _sy = sp[1] < tp[1] ? _h : 0,\n                _tx = sp[0] < tp[0] ? 0 : _w,\n                _ty = sp[1] < tp[1] ? 0 : _h;\n\n            _CP = this._findControlPoint([_sx, _sy], sp, tp, p.sourceEndpoint, p.targetEndpoint, paintInfo.so, paintInfo.to);\n            _CP2 = this._findControlPoint([_tx, _ty], tp, sp, p.targetEndpoint, p.sourceEndpoint, paintInfo.to, paintInfo.so);\n\n\n            _super.addSegment(this, \"Bezier\", {\n                x1: _sx, y1: _sy, x2: _tx, y2: _ty,\n                cp1x: _CP[0], cp1y: _CP[1], cp2x: _CP2[0], cp2y: _CP2[1]\n            });\n        };\n\n\n    };\n\n    _jp.Connectors.Bezier = Bezier;\n    _ju.extend(Bezier, _jp.Connectors.AbstractBezierConnector);\n\n}).call(typeof window !== 'undefined' ? window : this);\n\n/*\n * This file contains the state machine connectors, which extend AbstractBezierConnector.\n *\n * Copyright (c) 2010 - 2020 jsPlumb (hello@jsplumbtoolkit.com)\n *\n * https://jsplumbtoolkit.com\n * https://github.com/jsplumb/jsplumb\n * \n * Dual licensed under the MIT and GPL2 licenses.\n */\n;\n(function () {\n\n    \"use strict\";\n    var root = this, _jp = root.jsPlumb, _ju = root.jsPlumbUtil;\n\n    var _segment = function (x1, y1, x2, y2) {\n            if (x1 <= x2 && y2 <= y1) {\n                return 1;\n            }\n            else if (x1 <= x2 && y1 <= y2) {\n                return 2;\n            }\n            else if (x2 <= x1 && y2 >= y1) {\n                return 3;\n            }\n            return 4;\n        },\n\n    // the control point we will use depends on the faces to which each end of the connection is assigned, specifically whether or not the\n    // two faces are parallel or perpendicular.  if they are parallel then the control point lies on the midpoint of the axis in which they\n    // are parellel and varies only in the other axis; this variation is proportional to the distance that the anchor points lie from the\n    // center of that face.  if the two faces are perpendicular then the control point is at some distance from both the midpoints; the amount and\n    // direction are dependent on the orientation of the two elements. 'seg', passed in to this method, tells you which segment the target element\n    // lies in with respect to the source: 1 is top right, 2 is bottom right, 3 is bottom left, 4 is top left.\n    //\n    // sourcePos and targetPos are arrays of info about where on the source and target each anchor is located.  their contents are:\n    //\n    // 0 - absolute x\n    // 1 - absolute y\n    // 2 - proportional x in element (0 is left edge, 1 is right edge)\n    // 3 - proportional y in element (0 is top edge, 1 is bottom edge)\n    //\n        _findControlPoint = function (midx, midy, segment, sourceEdge, targetEdge, dx, dy, distance, proximityLimit) {\n            // TODO (maybe)\n            // - if anchor pos is 0.5, make the control point take into account the relative position of the elements.\n            if (distance <= proximityLimit) {\n                return [midx, midy];\n            }\n\n            if (segment === 1) {\n                if (sourceEdge[3] <= 0 && targetEdge[3] >= 1) {\n                    return [ midx + (sourceEdge[2] < 0.5 ? -1 * dx : dx), midy ];\n                }\n                else if (sourceEdge[2] >= 1 && targetEdge[2] <= 0) {\n                    return [ midx, midy + (sourceEdge[3] < 0.5 ? -1 * dy : dy) ];\n                }\n                else {\n                    return [ midx + (-1 * dx) , midy + (-1 * dy) ];\n                }\n            }\n            else if (segment === 2) {\n                if (sourceEdge[3] >= 1 && targetEdge[3] <= 0) {\n                    return [ midx + (sourceEdge[2] < 0.5 ? -1 * dx : dx), midy ];\n                }\n                else if (sourceEdge[2] >= 1 && targetEdge[2] <= 0) {\n                    return [ midx, midy + (sourceEdge[3] < 0.5 ? -1 * dy : dy) ];\n                }\n                else {\n                    return [ midx + dx, midy + (-1 * dy) ];\n                }\n            }\n            else if (segment === 3) {\n                if (sourceEdge[3] >= 1 && targetEdge[3] <= 0) {\n                    return [ midx + (sourceEdge[2] < 0.5 ? -1 * dx : dx), midy ];\n                }\n                else if (sourceEdge[2] <= 0 && targetEdge[2] >= 1) {\n                    return [ midx, midy + (sourceEdge[3] < 0.5 ? -1 * dy : dy) ];\n                }\n                else {\n                    return [ midx + (-1 * dx) , midy + (-1 * dy) ];\n                }\n            }\n            else if (segment === 4) {\n                if (sourceEdge[3] <= 0 && targetEdge[3] >= 1) {\n                    return [ midx + (sourceEdge[2] < 0.5 ? -1 * dx : dx), midy ];\n                }\n                else if (sourceEdge[2] <= 0 && targetEdge[2] >= 1) {\n                    return [ midx, midy + (sourceEdge[3] < 0.5 ? -1 * dy : dy) ];\n                }\n                else {\n                    return [ midx + dx , midy + (-1 * dy) ];\n                }\n            }\n\n        };\n\n    var StateMachine = function (params) {\n        params = params || {};\n        this.type = \"StateMachine\";\n\n        var _super = _jp.Connectors.AbstractBezierConnector.apply(this, arguments),\n            curviness = params.curviness || 10,\n            margin = params.margin || 5,\n            proximityLimit = params.proximityLimit || 80,\n            clockwise = params.orientation && params.orientation === \"clockwise\",\n            _controlPoint;\n\n        this._computeBezier = function(paintInfo, params, sp, tp, w, h) {\n            var _sx = params.sourcePos[0] < params.targetPos[0] ? 0 : w,\n                _sy = params.sourcePos[1] < params.targetPos[1] ? 0 : h,\n                _tx = params.sourcePos[0] < params.targetPos[0] ? w : 0,\n                _ty = params.sourcePos[1] < params.targetPos[1] ? h : 0;\n\n            // now adjust for the margin\n            if (params.sourcePos[2] === 0) {\n                _sx -= margin;\n            }\n            if (params.sourcePos[2] === 1) {\n                _sx += margin;\n            }\n            if (params.sourcePos[3] === 0) {\n                _sy -= margin;\n            }\n            if (params.sourcePos[3] === 1) {\n                _sy += margin;\n            }\n            if (params.targetPos[2] === 0) {\n                _tx -= margin;\n            }\n            if (params.targetPos[2] === 1) {\n                _tx += margin;\n            }\n            if (params.targetPos[3] === 0) {\n                _ty -= margin;\n            }\n            if (params.targetPos[3] === 1) {\n                _ty += margin;\n            }\n\n            //\n            // these connectors are quadratic bezier curves, having a single control point. if both anchors\n            // are located at 0.5 on their respective faces, the control point is set to the midpoint and you\n            // get a straight line.  this is also the case if the two anchors are within 'proximityLimit', since\n            // it seems to make good aesthetic sense to do that. outside of that, the control point is positioned\n            // at 'curviness' pixels away along the normal to the straight line connecting the two anchors.\n            //\n            // there may be two improvements to this.  firstly, we might actually support the notion of avoiding nodes\n            // in the UI, or at least making a good effort at doing so.  if a connection would pass underneath some node,\n            // for example, we might increase the distance the control point is away from the midpoint in a bid to\n            // steer it around that node.  this will work within limits, but i think those limits would also be the likely\n            // limits for, once again, aesthetic good sense in the layout of a chart using these connectors.\n            //\n            // the second possible change is actually two possible changes: firstly, it is possible we should gradually\n            // decrease the 'curviness' as the distance between the anchors decreases; start tailing it off to 0 at some\n            // point (which should be configurable).  secondly, we might slightly increase the 'curviness' for connectors\n            // with respect to how far their anchor is from the center of its respective face. this could either look cool,\n            // or stupid, and may indeed work only in a way that is so subtle as to have been a waste of time.\n            //\n\n            var _midx = (_sx + _tx) / 2,\n                _midy = (_sy + _ty) / 2,\n                segment = _segment(_sx, _sy, _tx, _ty),\n                distance = Math.sqrt(Math.pow(_tx - _sx, 2) + Math.pow(_ty - _sy, 2)),\n                cp1x, cp2x, cp1y, cp2y;\n\n\n            // calculate the control point.  this code will be where we'll put in a rudimentary element avoidance scheme; it\n            // will work by extending the control point to force the curve to be, um, curvier.\n            _controlPoint = _findControlPoint(_midx,\n                _midy,\n                segment,\n                params.sourcePos,\n                params.targetPos,\n                curviness, curviness,\n                distance,\n                proximityLimit);\n\n            cp1x = _controlPoint[0];\n            cp2x = _controlPoint[0];\n            cp1y = _controlPoint[1];\n            cp2y = _controlPoint[1];\n\n            _super.addSegment(this, \"Bezier\", {\n                x1: _tx, y1: _ty, x2: _sx, y2: _sy,\n                cp1x: cp1x, cp1y: cp1y,\n                cp2x: cp2x, cp2y: cp2y\n            });\n        };\n    };\n\n    _jp.Connectors.StateMachine = StateMachine;\n    _ju.extend(StateMachine, _jp.Connectors.AbstractBezierConnector);\n\n}).call(typeof window !== 'undefined' ? window : this);\n\n/*\n * This file contains the 'flowchart' connectors, consisting of vertical and horizontal line segments.\n *\n * Copyright (c) 2010 - 2020 jsPlumb (hello@jsplumbtoolkit.com)\n *\n * https://jsplumbtoolkit.com\n * https://github.com/jsplumb/jsplumb\n *\n * Dual licensed under the MIT and GPL2 licenses.\n */\n;\n(function () {\n\n    \"use strict\";\n    var root = this, _jp = root.jsPlumb, _ju = root.jsPlumbUtil;\n    var STRAIGHT = \"Straight\";\n\n    var Straight = function (params) {\n        this.type = STRAIGHT;\n        var _super = _jp.Connectors.AbstractConnector.apply(this, arguments);\n\n        this._compute = function (paintInfo, _) {\n            _super.addSegment(this, STRAIGHT, {x1: paintInfo.sx, y1: paintInfo.sy, x2: paintInfo.startStubX, y2: paintInfo.startStubY});\n            _super.addSegment(this, STRAIGHT, {x1: paintInfo.startStubX, y1: paintInfo.startStubY, x2: paintInfo.endStubX, y2: paintInfo.endStubY});\n            _super.addSegment(this, STRAIGHT, {x1: paintInfo.endStubX, y1: paintInfo.endStubY, x2: paintInfo.tx, y2: paintInfo.ty});\n        };\n    };\n\n    _jp.Connectors.Straight = Straight;\n    _ju.extend(Straight, _jp.Connectors.AbstractConnector);\n\n}).call(typeof window !== 'undefined' ? window : this);\n\n/*\n * This file contains the SVG renderers.\n *\n * Copyright (c) 2010 - 2020 jsPlumb (hello@jsplumbtoolkit.com)\n * \n * https://jsplumbtoolkit.com\n * https://github.com/jsplumb/jsplumb\n * \n * Dual licensed under the MIT and GPL2 licenses.\n */\n;\n(function () {\n\n// ************************** SVG utility methods ********************************************\t\n\n    \"use strict\";\n    var root = this, _jp = root.jsPlumb, _ju = root.jsPlumbUtil;\n\n    var svgAttributeMap = {\n            \"stroke-linejoin\": \"stroke-linejoin\",\n            \"stroke-dashoffset\": \"stroke-dashoffset\",\n            \"stroke-linecap\": \"stroke-linecap\"\n        },\n        STROKE_DASHARRAY = \"stroke-dasharray\",\n        DASHSTYLE = \"dashstyle\",\n        LINEAR_GRADIENT = \"linearGradient\",\n        RADIAL_GRADIENT = \"radialGradient\",\n        DEFS = \"defs\",\n        FILL = \"fill\",\n        STOP = \"stop\",\n        STROKE = \"stroke\",\n        STROKE_WIDTH = \"stroke-width\",\n        STYLE = \"style\",\n        NONE = \"none\",\n        JSPLUMB_GRADIENT = \"jsplumb_gradient_\",\n        LINE_WIDTH = \"strokeWidth\",\n        ns = {\n            svg: \"http://www.w3.org/2000/svg\"\n        },\n        _attr = function (node, attributes) {\n            for (var i in attributes) {\n                node.setAttribute(i, \"\" + attributes[i]);\n            }\n        },\n        _node = function (name, attributes) {\n            attributes = attributes || {};\n            attributes.version = \"1.1\";\n            attributes.xmlns = ns.svg;\n            return _jp.createElementNS(ns.svg, name, null, null, attributes);\n        },\n        _pos = function (d) {\n            return \"position:absolute;left:\" + d[0] + \"px;top:\" + d[1] + \"px\";\n        },\n        _clearGradient = function (parent) {\n            var els = parent.querySelectorAll(\" defs,linearGradient,radialGradient\");\n            for (var i = 0; i < els.length; i++) {\n                els[i].parentNode.removeChild(els[i]);\n            }\n        },\n        _updateGradient = function (parent, node, style, dimensions, uiComponent) {\n            var id = JSPLUMB_GRADIENT + uiComponent._jsPlumb.instance.idstamp();\n            // first clear out any existing gradient\n            _clearGradient(parent);\n            // this checks for an 'offset' property in the gradient, and in the absence of it, assumes\n            // we want a linear gradient. if it's there, we create a radial gradient.\n            // it is possible that a more explicit means of defining the gradient type would be\n            // better. relying on 'offset' means that we can never have a radial gradient that uses\n            // some default offset, for instance.\n            // issue 244 suggested the 'gradientUnits' attribute; without this, straight/flowchart connectors with gradients would\n            // not show gradients when the line was perfectly horizontal or vertical.\n            var g;\n            if (!style.gradient.offset) {\n                g = _node(LINEAR_GRADIENT, {id: id, gradientUnits: \"userSpaceOnUse\"});\n            }\n            else {\n                g = _node(RADIAL_GRADIENT, { id: id });\n            }\n\n            var defs = _node(DEFS);\n            parent.appendChild(defs);\n            defs.appendChild(g);\n\n            // the svg radial gradient seems to treat stops in the reverse\n            // order to how canvas does it.  so we want to keep all the maths the same, but\n            // iterate the actual style declarations in reverse order, if the x indexes are not in order.\n            for (var i = 0; i < style.gradient.stops.length; i++) {\n                var styleToUse = uiComponent.segment === 1 || uiComponent.segment === 2 ? i : style.gradient.stops.length - 1 - i,\n                    stopColor = style.gradient.stops[styleToUse][1],\n                    s = _node(STOP, {\"offset\": Math.floor(style.gradient.stops[i][0] * 100) + \"%\", \"stop-color\": stopColor});\n\n                g.appendChild(s);\n            }\n            var applyGradientTo = style.stroke ? STROKE : FILL;\n            node.setAttribute(applyGradientTo, \"url(#\" + id + \")\");\n        },\n        _applyStyles = function (parent, node, style, dimensions, uiComponent) {\n\n            node.setAttribute(FILL, style.fill ? style.fill : NONE);\n            node.setAttribute(STROKE, style.stroke ? style.stroke : NONE);\n\n            if (style.gradient) {\n                _updateGradient(parent, node, style, dimensions, uiComponent);\n            }\n            else {\n                // make sure we clear any existing gradient\n                _clearGradient(parent);\n                node.setAttribute(STYLE, \"\");\n            }\n\n            if (style.strokeWidth) {\n                node.setAttribute(STROKE_WIDTH, style.strokeWidth);\n            }\n\n            // in SVG there is a stroke-dasharray attribute we can set, and its syntax looks like\n            // the syntax in VML but is actually kind of nasty: values are given in the pixel\n            // coordinate space, whereas in VML they are multiples of the width of the stroked\n            // line, which makes a lot more sense.  for that reason, jsPlumb is supporting both\n            // the native svg 'stroke-dasharray' attribute, and also the 'dashstyle' concept from\n            // VML, which will be the preferred method.  the code below this converts a dashstyle\n            // attribute given in terms of stroke width into a pixel representation, by using the\n            // stroke's lineWidth.\n            if (style[DASHSTYLE] && style[LINE_WIDTH] && !style[STROKE_DASHARRAY]) {\n                var sep = style[DASHSTYLE].indexOf(\",\") === -1 ? \" \" : \",\",\n                    parts = style[DASHSTYLE].split(sep),\n                    styleToUse = \"\";\n                parts.forEach(function (p) {\n                    styleToUse += (Math.floor(p * style.strokeWidth) + sep);\n                });\n                node.setAttribute(STROKE_DASHARRAY, styleToUse);\n            }\n            else if (style[STROKE_DASHARRAY]) {\n                node.setAttribute(STROKE_DASHARRAY, style[STROKE_DASHARRAY]);\n            }\n\n            // extra attributes such as join type, dash offset.\n            for (var i in svgAttributeMap) {\n                if (style[i]) {\n                    node.setAttribute(svgAttributeMap[i], style[i]);\n                }\n            }\n        },\n        _appendAtIndex = function (svg, path, idx) {\n            if (svg.childNodes.length > idx) {\n                svg.insertBefore(path, svg.childNodes[idx]);\n            }\n            else {\n                svg.appendChild(path);\n            }\n        };\n\n    /**\n     utility methods for other objects to use.\n     */\n    _ju.svg = {\n        node: _node,\n        attr: _attr,\n        pos: _pos\n    };\n\n    // ************************** / SVG utility methods ********************************************\n\n    /*\n     * Base class for SVG components.\n     */\n    var SvgComponent = function (params) {\n        var pointerEventsSpec = params.pointerEventsSpec || \"all\", renderer = {};\n\n        _jp.jsPlumbUIComponent.apply(this, params.originalArgs);\n        this.canvas = null;\n        this.path = null;\n        this.svg = null;\n        this.bgCanvas = null;\n\n        var clazz = params.cssClass + \" \" + (params.originalArgs[0].cssClass || \"\"),\n            svgParams = {\n                \"style\": \"\",\n                \"width\": 0,\n                \"height\": 0,\n                \"pointer-events\": pointerEventsSpec,\n                \"position\": \"absolute\"\n            };\n\n        this.svg = _node(\"svg\", svgParams);\n\n        if (params.useDivWrapper) {\n            this.canvas = _jp.createElement(\"div\", { position : \"absolute\" });\n            _ju.sizeElement(this.canvas, 0, 0, 1, 1);\n            this.canvas.className = clazz;\n        }\n        else {\n            _attr(this.svg, { \"class\": clazz });\n            this.canvas = this.svg;\n        }\n\n        params._jsPlumb.appendElement(this.canvas, params.originalArgs[0].parent);\n        if (params.useDivWrapper) {\n            this.canvas.appendChild(this.svg);\n        }\n\n        var displayElements = [ this.canvas ];\n        this.getDisplayElements = function () {\n            return displayElements;\n        };\n\n        this.appendDisplayElement = function (el) {\n            displayElements.push(el);\n        };\n\n        this.paint = function (style, anchor, extents) {\n            if (style != null) {\n\n                var xy = [ this.x, this.y ], wh = [ this.w, this.h ], p;\n                if (extents != null) {\n                    if (extents.xmin < 0) {\n                        xy[0] += extents.xmin;\n                    }\n                    if (extents.ymin < 0) {\n                        xy[1] += extents.ymin;\n                    }\n                    wh[0] = extents.xmax + ((extents.xmin < 0) ? -extents.xmin : 0);\n                    wh[1] = extents.ymax + ((extents.ymin < 0) ? -extents.ymin : 0);\n                }\n\n                if (params.useDivWrapper) {\n                    _ju.sizeElement(this.canvas, xy[0], xy[1], wh[0] > 0 ? wh[0] : 1, wh[1] > 0 ? wh[1] : 1);\n                    xy[0] = 0;\n                    xy[1] = 0;\n                    p = _pos([ 0, 0 ]);\n                }\n                else {\n                    p = _pos([ xy[0], xy[1] ]);\n                }\n\n                renderer.paint.apply(this, arguments);\n\n                _attr(this.svg, {\n                    \"style\": p,\n                    \"width\": wh[0] || 1,\n                    \"height\": wh[1] || 1\n                });\n            }\n        };\n\n        return {\n            renderer: renderer\n        };\n    };\n\n    _ju.extend(SvgComponent, _jp.jsPlumbUIComponent, {\n        cleanup: function (force) {\n            if (force || this.typeId == null) {\n                if (this.canvas) {\n                    this.canvas._jsPlumb = null;\n                }\n                if (this.svg) {\n                    this.svg._jsPlumb = null;\n                }\n                if (this.bgCanvas) {\n                    this.bgCanvas._jsPlumb = null;\n                }\n\n                if (this.canvas && this.canvas.parentNode) {\n                    this.canvas.parentNode.removeChild(this.canvas);\n                }\n                if (this.bgCanvas && this.bgCanvas.parentNode) {\n                    this.canvas.parentNode.removeChild(this.canvas);\n                }\n\n                this.svg = null;\n                this.canvas = null;\n                this.path = null;\n                this.group = null;\n            }\n            else {\n                // if not a forced cleanup, just detach from DOM for now.\n                if (this.canvas && this.canvas.parentNode) {\n                    this.canvas.parentNode.removeChild(this.canvas);\n                }\n                if (this.bgCanvas && this.bgCanvas.parentNode) {\n                    this.bgCanvas.parentNode.removeChild(this.bgCanvas);\n                }\n            }\n        },\n        reattach:function(instance) {\n            var c = instance.getContainer();\n            if (this.canvas && this.canvas.parentNode == null) {\n                c.appendChild(this.canvas);\n            }\n            if (this.bgCanvas && this.bgCanvas.parentNode == null) {\n                c.appendChild(this.bgCanvas);\n            }\n        },\n        setVisible: function (v) {\n            if (this.canvas) {\n                this.canvas.style.display = v ? \"block\" : \"none\";\n            }\n        }\n    });\n\n    /*\n     * Base class for SVG connectors.\n     */\n    _jp.ConnectorRenderers.svg = function (params) {\n        var self = this,\n            _super = SvgComponent.apply(this, [\n                {\n                    cssClass: params._jsPlumb.connectorClass,\n                    originalArgs: arguments,\n                    pointerEventsSpec: \"none\",\n                    _jsPlumb: params._jsPlumb\n                }\n            ]);\n\n        _super.renderer.paint = function (style, anchor, extents) {\n\n            var segments = self.getSegments(), p = \"\", offset = [0, 0];\n            if (extents.xmin < 0) {\n                offset[0] = -extents.xmin;\n            }\n            if (extents.ymin < 0) {\n                offset[1] = -extents.ymin;\n            }\n\n            if (segments.length > 0) {\n\n                p = self.getPathData();\n\n                var a = {\n                        d: p,\n                        transform: \"translate(\" + offset[0] + \",\" + offset[1] + \")\",\n                        \"pointer-events\": params[\"pointer-events\"] || \"visibleStroke\"\n                    },\n                    outlineStyle = null,\n                    d = [self.x, self.y, self.w, self.h];\n\n                // outline style.  actually means drawing an svg object underneath the main one.\n                if (style.outlineStroke) {\n                    var outlineWidth = style.outlineWidth || 1,\n                        outlineStrokeWidth = style.strokeWidth + (2 * outlineWidth);\n                    outlineStyle = _jp.extend({}, style);\n                    delete outlineStyle.gradient;\n                    outlineStyle.stroke = style.outlineStroke;\n                    outlineStyle.strokeWidth = outlineStrokeWidth;\n\n                    if (self.bgPath == null) {\n                        self.bgPath = _node(\"path\", a);\n                        _jp.addClass(self.bgPath, _jp.connectorOutlineClass);\n                        _appendAtIndex(self.svg, self.bgPath, 0);\n                    }\n                    else {\n                        _attr(self.bgPath, a);\n                    }\n\n                    _applyStyles(self.svg, self.bgPath, outlineStyle, d, self);\n                }\n\n                if (self.path == null) {\n                    self.path = _node(\"path\", a);\n                    _appendAtIndex(self.svg, self.path, style.outlineStroke ? 1 : 0);\n                }\n                else {\n                    _attr(self.path, a);\n                }\n\n                _applyStyles(self.svg, self.path, style, d, self);\n            }\n        };\n    };\n    _ju.extend(_jp.ConnectorRenderers.svg, SvgComponent);\n\n// ******************************* svg segment renderer *****************************************************\t\n\n\n// ******************************* /svg segments *****************************************************\n\n    /*\n     * Base class for SVG endpoints.\n     */\n    var SvgEndpoint = _jp.SvgEndpoint = function (params) {\n        var _super = SvgComponent.apply(this, [\n            {\n                cssClass: params._jsPlumb.endpointClass,\n                originalArgs: arguments,\n                pointerEventsSpec: \"all\",\n                useDivWrapper: true,\n                _jsPlumb: params._jsPlumb\n            }\n        ]);\n\n        _super.renderer.paint = function (style) {\n            var s = _jp.extend({}, style);\n            if (s.outlineStroke) {\n                s.stroke = s.outlineStroke;\n            }\n\n            if (this.node == null) {\n                this.node = this.makeNode(s);\n                this.svg.appendChild(this.node);\n            }\n            else if (this.updateNode != null) {\n                this.updateNode(this.node);\n            }\n            _applyStyles(this.svg, this.node, s, [ this.x, this.y, this.w, this.h ], this);\n            _pos(this.node, [ this.x, this.y ]);\n        }.bind(this);\n\n    };\n    _ju.extend(SvgEndpoint, SvgComponent);\n\n    /*\n     * SVG Dot Endpoint\n     */\n    _jp.Endpoints.svg.Dot = function () {\n        _jp.Endpoints.Dot.apply(this, arguments);\n        SvgEndpoint.apply(this, arguments);\n        this.makeNode = function (style) {\n            return _node(\"circle\", {\n                \"cx\": this.w / 2,\n                \"cy\": this.h / 2,\n                \"r\": this.radius\n            });\n        };\n        this.updateNode = function (node) {\n            _attr(node, {\n                \"cx\": this.w / 2,\n                \"cy\": this.h / 2,\n                \"r\": this.radius\n            });\n        };\n    };\n    _ju.extend(_jp.Endpoints.svg.Dot, [_jp.Endpoints.Dot, SvgEndpoint]);\n\n    /*\n     * SVG Rectangle Endpoint\n     */\n    _jp.Endpoints.svg.Rectangle = function () {\n        _jp.Endpoints.Rectangle.apply(this, arguments);\n        SvgEndpoint.apply(this, arguments);\n        this.makeNode = function (style) {\n            return _node(\"rect\", {\n                \"width\": this.w,\n                \"height\": this.h\n            });\n        };\n        this.updateNode = function (node) {\n            _attr(node, {\n                \"width\": this.w,\n                \"height\": this.h\n            });\n        };\n    };\n    _ju.extend(_jp.Endpoints.svg.Rectangle, [_jp.Endpoints.Rectangle, SvgEndpoint]);\n\n    /*\n     * SVG Image Endpoint is the default image endpoint.\n     */\n    _jp.Endpoints.svg.Image = _jp.Endpoints.Image;\n    /*\n     * Blank endpoint in svg renderer is the default Blank endpoint.\n     */\n    _jp.Endpoints.svg.Blank = _jp.Endpoints.Blank;\n    /*\n     * Label overlay in svg renderer is the default Label overlay.\n     */\n    _jp.Overlays.svg.Label = _jp.Overlays.Label;\n    /*\n     * Custom overlay in svg renderer is the default Custom overlay.\n     */\n    _jp.Overlays.svg.Custom = _jp.Overlays.Custom;\n\n    var AbstractSvgArrowOverlay = function (superclass, originalArgs) {\n        superclass.apply(this, originalArgs);\n        _jp.jsPlumbUIComponent.apply(this, originalArgs);\n        this.isAppendedAtTopLevel = false;\n        var self = this;\n        this.path = null;\n        this.paint = function (params, containerExtents) {\n            // only draws on connections, not endpoints.\n            if (params.component.svg && containerExtents) {\n                if (this.path == null) {\n                    this.path = _node(\"path\", {\n                        \"pointer-events\": \"all\"\n                    });\n                    params.component.svg.appendChild(this.path);\n                    if (this.elementCreated) {\n                        this.elementCreated(this.path, params.component);\n                    }\n\n                    this.canvas = params.component.svg; // for the sake of completeness; this behaves the same as other overlays\n                }\n                var clazz = originalArgs && (originalArgs.length === 1) ? (originalArgs[0].cssClass || \"\") : \"\",\n                    offset = [0, 0];\n\n                if (containerExtents.xmin < 0) {\n                    offset[0] = -containerExtents.xmin;\n                }\n                if (containerExtents.ymin < 0) {\n                    offset[1] = -containerExtents.ymin;\n                }\n\n                _attr(this.path, {\n                    \"d\": makePath(params.d),\n                    \"class\": clazz,\n                    stroke: params.stroke ? params.stroke : null,\n                    fill: params.fill ? params.fill : null,\n                    transform: \"translate(\" + offset[0] + \",\" + offset[1] + \")\"\n                });\n            }\n        };\n        var makePath = function (d) {\n            return (isNaN(d.cxy.x) || isNaN(d.cxy.y)) ? \"\" : \"M\" + d.hxy.x + \",\" + d.hxy.y +\n                \" L\" + d.tail[0].x + \",\" + d.tail[0].y +\n                \" L\" + d.cxy.x + \",\" + d.cxy.y +\n                \" L\" + d.tail[1].x + \",\" + d.tail[1].y +\n                \" L\" + d.hxy.x + \",\" + d.hxy.y;\n        };\n        this.transfer = function(target) {\n            if (target.canvas && this.path && this.path.parentNode) {\n                this.path.parentNode.removeChild(this.path);\n                target.canvas.appendChild(this.path);\n            }\n        };\n    };\n\n    var svgProtoFunctions = {\n        cleanup : function (force) {\n            if (this.path != null) {\n                if (force) {\n                    this._jsPlumb.instance.removeElement(this.path);\n                }\n                else {\n                    if (this.path.parentNode) {\n                        this.path.parentNode.removeChild(this.path);\n                    }\n                }\n            }\n        }, reattach :function(instance, component) {\n            if (this.path && component.canvas) {\n                component.canvas.appendChild(this.path);\n            }\n        },\n        setVisible : function (v) {\n            if (this.path != null) {\n                (this.path.style.display = (v ? \"block\" : \"none\"));\n            }\n        }\n    };\n\n    _ju.extend(AbstractSvgArrowOverlay, [_jp.jsPlumbUIComponent, _jp.Overlays.AbstractOverlay]);\n\n    _jp.Overlays.svg.Arrow = function () {\n        AbstractSvgArrowOverlay.apply(this, [_jp.Overlays.Arrow, arguments]);\n    };\n    _ju.extend(_jp.Overlays.svg.Arrow, [ _jp.Overlays.Arrow, AbstractSvgArrowOverlay ], svgProtoFunctions);\n\n    _jp.Overlays.svg.PlainArrow = function () {\n        AbstractSvgArrowOverlay.apply(this, [_jp.Overlays.PlainArrow, arguments]);\n    };\n    _ju.extend(_jp.Overlays.svg.PlainArrow, [ _jp.Overlays.PlainArrow, AbstractSvgArrowOverlay ], svgProtoFunctions);\n\n    _jp.Overlays.svg.Diamond = function () {\n        AbstractSvgArrowOverlay.apply(this, [_jp.Overlays.Diamond, arguments]);\n    };\n    _ju.extend(_jp.Overlays.svg.Diamond, [ _jp.Overlays.Diamond, AbstractSvgArrowOverlay ], svgProtoFunctions);\n\n    // a test\n    _jp.Overlays.svg.GuideLines = function () {\n        var path = null, self = this, p1_1, p1_2;\n        _jp.Overlays.GuideLines.apply(this, arguments);\n        this.paint = function (params, containerExtents) {\n            if (path == null) {\n                path = _node(\"path\");\n                params.connector.svg.appendChild(path);\n                self.attachListeners(path, params.connector);\n                self.attachListeners(path, self);\n\n                p1_1 = _node(\"path\");\n                params.connector.svg.appendChild(p1_1);\n                self.attachListeners(p1_1, params.connector);\n                self.attachListeners(p1_1, self);\n\n                p1_2 = _node(\"path\");\n                params.connector.svg.appendChild(p1_2);\n                self.attachListeners(p1_2, params.connector);\n                self.attachListeners(p1_2, self);\n            }\n\n            var offset = [0, 0];\n            if (containerExtents.xmin < 0) {\n                offset[0] = -containerExtents.xmin;\n            }\n            if (containerExtents.ymin < 0) {\n                offset[1] = -containerExtents.ymin;\n            }\n\n            _attr(path, {\n                \"d\": makePath(params.head, params.tail),\n                stroke: \"red\",\n                fill: null,\n                transform: \"translate(\" + offset[0] + \",\" + offset[1] + \")\"\n            });\n\n            _attr(p1_1, {\n                \"d\": makePath(params.tailLine[0], params.tailLine[1]),\n                stroke: \"blue\",\n                fill: null,\n                transform: \"translate(\" + offset[0] + \",\" + offset[1] + \")\"\n            });\n\n            _attr(p1_2, {\n                \"d\": makePath(params.headLine[0], params.headLine[1]),\n                stroke: \"green\",\n                fill: null,\n                transform: \"translate(\" + offset[0] + \",\" + offset[1] + \")\"\n            });\n        };\n\n        var makePath = function (d1, d2) {\n            return \"M \" + d1.x + \",\" + d1.y +\n                \" L\" + d2.x + \",\" + d2.y;\n        };\n    };\n    _ju.extend(_jp.Overlays.svg.GuideLines, _jp.Overlays.GuideLines);\n}).call(typeof window !== 'undefined' ? window : this);\n\n/*\n * This file contains code used when jsPlumb is being rendered in a DOM.\n *\n * Copyright (c) 2010 - 2020 jsPlumb (hello@jsplumbtoolkit.com)\n *\n * https://jsplumbtoolkit.com\n * https://github.com/jsplumb/jsplumb\n *\n * Dual licensed under the MIT and GPL2 licenses.\n */\n;\n(function () {\n\n    \"use strict\";\n\n    var root = this, _jp = root.jsPlumb, _ju = root.jsPlumbUtil,\n        _jk = root.Katavorio, _jg = root.Biltong;\n\n    var _getEventManager = function(instance) {\n        var e = instance._mottle;\n        if (!e) {\n            e = instance._mottle = new root.Mottle();\n        }\n        return e;\n    };\n\n    var _getDragManager = function (instance, category) {\n\n        category = category || \"main\";\n        var key = \"_katavorio_\" + category;\n        var k = instance[key],\n            e = instance.getEventManager();\n\n        if (!k) {\n            k = new _jk({\n                bind: e.on,\n                unbind: e.off,\n                getSize: _jp.getSize,\n                getConstrainingRectangle:function(el) {\n                    return [ el.parentNode.scrollWidth, el.parentNode.scrollHeight ];\n                },\n                getPosition: function (el, relativeToRoot) {\n                    // if this is a nested draggable then compute the offset against its own offsetParent, otherwise\n                    // compute against the Container's origin. see also the getUIPosition method below.\n                    var o = instance.getOffset(el, relativeToRoot, el._katavorioDrag ? el.offsetParent : null);\n                    return [o.left, o.top];\n                },\n                setPosition: function (el, xy) {\n                    el.style.left = xy[0] + \"px\";\n                    el.style.top = xy[1] + \"px\";\n                },\n                addClass: _jp.addClass,\n                removeClass: _jp.removeClass,\n                intersects: _jg.intersects,\n                indexOf: function(l, i) { return l.indexOf(i); },\n                scope:instance.getDefaultScope(),\n                css: {\n                    noSelect: instance.dragSelectClass,\n                    droppable: \"jtk-droppable\",\n                    draggable: \"jtk-draggable\",\n                    drag: \"jtk-drag\",\n                    selected: \"jtk-drag-selected\",\n                    active: \"jtk-drag-active\",\n                    hover: \"jtk-drag-hover\",\n                    ghostProxy:\"jtk-ghost-proxy\"\n                }\n            });\n            k.setZoom(instance.getZoom());\n            instance[key] = k;\n            instance.bind(\"zoom\", k.setZoom);\n        }\n        return k;\n    };\n\n    var _dragStart=function(params) {\n        var options = params.el._jsPlumbDragOptions;\n        var cont = true;\n        if (options.canDrag) {\n            cont = options.canDrag();\n        }\n        if (cont) {\n            this.setHoverSuspended(true);\n            this.select({source: params.el}).addClass(this.elementDraggingClass + \" \" + this.sourceElementDraggingClass, true);\n            this.select({target: params.el}).addClass(this.elementDraggingClass + \" \" + this.targetElementDraggingClass, true);\n            this.setConnectionBeingDragged(true);\n        }\n        return cont;\n    };\n    var _dragMove=function(params) {\n        var ui = this.getUIPosition(arguments, this.getZoom());\n        if (ui != null) {\n            var o = params.el._jsPlumbDragOptions;\n            this.draw(params.el, ui, null, true);\n            if (o._dragging) {\n                this.addClass(params.el, \"jtk-dragged\");\n            }\n            o._dragging = true;\n        }\n    };\n    var _dragStop=function(params) {\n        var elements = params.selection, uip;\n\n        var _one = function (_e) {\n            if (_e[1] != null) {\n                // run the reported offset through the code that takes parent containers\n                // into account, to adjust if necessary (issue 554)\n                uip = this.getUIPosition([{\n                    el:_e[2].el,\n                    pos:[_e[1].left, _e[1].top]\n                }]);\n                this.draw(_e[2].el, uip);\n            }\n\n            if (_e[0]._jsPlumbDragOptions != null) {\n                delete _e[0]._jsPlumbDragOptions._dragging;\n            }\n\n            this.removeClass(_e[0], \"jtk-dragged\");\n            this.select({source: _e[2].el}).removeClass(this.elementDraggingClass + \" \" + this.sourceElementDraggingClass, true);\n            this.select({target: _e[2].el}).removeClass(this.elementDraggingClass + \" \" + this.targetElementDraggingClass, true);\n            this.getDragManager().dragEnded(_e[2].el);\n        }.bind(this);\n\n        for (var i = 0; i < elements.length; i++) {\n            _one(elements[i]);\n        }\n\n        this.setHoverSuspended(false);\n        this.setConnectionBeingDragged(false);\n    };\n\n    var _animProps = function (o, p) {\n        var _one = function (pName) {\n            if (p[pName] != null) {\n                if (_ju.isString(p[pName])) {\n                    var m = p[pName].match(/-=/) ? -1 : 1,\n                        v = p[pName].substring(2);\n                    return o[pName] + (m * v);\n                }\n                else {\n                    return p[pName];\n                }\n            }\n            else {\n                return o[pName];\n            }\n        };\n        return [ _one(\"left\"), _one(\"top\") ];\n    };\n\n    var _genLoc = function (prefix, e) {\n            if (e == null) {\n                return [ 0, 0 ];\n            }\n            var ts = _touches(e), t = _getTouch(ts, 0);\n            return [t[prefix + \"X\"], t[prefix + \"Y\"]];\n        },\n        _pageLocation = _genLoc.bind(this, \"page\"),\n        _screenLocation = _genLoc.bind(this, \"screen\"),\n        _clientLocation = _genLoc.bind(this, \"client\"),\n        _getTouch = function (touches, idx) {\n            return touches.item ? touches.item(idx) : touches[idx];\n        },\n        _touches = function (e) {\n            return e.touches && e.touches.length > 0 ? e.touches :\n                e.changedTouches && e.changedTouches.length > 0 ? e.changedTouches :\n                    e.targetTouches && e.targetTouches.length > 0 ? e.targetTouches :\n                        [ e ];\n        };\n\n    /**\n     Manages dragging for some instance of jsPlumb.\n\n     TODO instead of this being accessed directly, it should subscribe to events on the jsPlumb instance: every method\n     in here is called directly by jsPlumb. But what should happen is that we have unpublished events that this listens\n     to.  The only trick is getting one of these instantiated with every jsPlumb instance: it needs to have a hook somehow.\n     Basically the general idea is to pull ALL the drag code out (prototype method registrations plus this) into a\n     dedicated drag script), that does not necessarily need to be included.\n\n\n     */\n    var DragManager = function (_currentInstance) {\n        var _draggables = {}, _dlist = [], _delements = {}, _elementsWithEndpoints = {},\n            // elementids mapped to the draggable to which they belong.\n            _draggablesForElements = {};\n\n        /**\n         register some element as draggable.  right now the drag init stuff is done elsewhere, and it is\n         possible that will continue to be the case.\n         */\n        this.register = function (el) {\n            var id = _currentInstance.getId(el),\n                parentOffset;\n\n            if (!_draggables[id]) {\n                _draggables[id] = el;\n                _dlist.push(el);\n                _delements[id] = {};\n            }\n\n            // look for child elements that have endpoints and register them against this draggable.\n            var _oneLevel = function (p) {\n                if (p) {\n                    for (var i = 0; i < p.childNodes.length; i++) {\n                        if (p.childNodes[i].nodeType !== 3 && p.childNodes[i].nodeType !== 8) {\n                            var cEl = jsPlumb.getElement(p.childNodes[i]),\n                                cid = _currentInstance.getId(p.childNodes[i], null, true);\n                            if (cid && _elementsWithEndpoints[cid] && _elementsWithEndpoints[cid] > 0) {\n                                if (!parentOffset) {\n                                    parentOffset = _currentInstance.getOffset(el);\n                                }\n                                var cOff = _currentInstance.getOffset(cEl);\n                                _delements[id][cid] = {\n                                    id: cid,\n                                    offset: {\n                                        left: cOff.left - parentOffset.left,\n                                        top: cOff.top - parentOffset.top\n                                    }\n                                };\n                                _draggablesForElements[cid] = id;\n                            }\n                            _oneLevel(p.childNodes[i]);\n                        }\n                    }\n                }\n            };\n\n            _oneLevel(el);\n        };\n\n        // refresh the offsets for child elements of this element.\n        this.updateOffsets = function (elId, childOffsetOverrides) {\n            if (elId != null) {\n                childOffsetOverrides = childOffsetOverrides || {};\n                var domEl = jsPlumb.getElement(elId),\n                    id = _currentInstance.getId(domEl),\n                    children = _delements[id],\n                    parentOffset;\n\n                if (children) {\n                    for (var i in children) {\n                        if (children.hasOwnProperty(i)) {\n                            var cel = jsPlumb.getElement(i),\n                                cOff = childOffsetOverrides[i] || _currentInstance.getOffset(cel);\n\n                            // do not update if we have a value already and we'd just be writing 0,0\n                            if (cel.offsetParent == null && _delements[id][i] != null) {\n                                continue;\n                            }\n\n                            if (!parentOffset) {\n                                parentOffset = _currentInstance.getOffset(domEl);\n                            }\n\n                            _delements[id][i] = {\n                                id: i,\n                                offset: {\n                                    left: cOff.left - parentOffset.left,\n                                    top: cOff.top - parentOffset.top\n                                }\n                            };\n                            _draggablesForElements[i] = id;\n                        }\n                    }\n                }\n            }\n        };\n\n        /**\n         notification that an endpoint was added to the given el.  we go up from that el's parent\n         node, looking for a parent that has been registered as a draggable. if we find one, we add this\n         el to that parent's list of elements to update on drag (if it is not there already)\n         */\n        this.endpointAdded = function (el, id) {\n\n            id = id || _currentInstance.getId(el);\n\n            var b = document.body,\n                p = el.parentNode;\n\n            _elementsWithEndpoints[id] = _elementsWithEndpoints[id] ? _elementsWithEndpoints[id] + 1 : 1;\n\n            while (p != null && p !== b) {\n                var pid = _currentInstance.getId(p, null, true);\n                if (pid && _draggables[pid]) {\n                    var pLoc = _currentInstance.getOffset(p);\n\n                    if (_delements[pid][id] == null) {\n                        var cLoc = _currentInstance.getOffset(el);\n                        _delements[pid][id] = {\n                            id: id,\n                            offset: {\n                                left: cLoc.left - pLoc.left,\n                                top: cLoc.top - pLoc.top\n                            }\n                        };\n                        _draggablesForElements[id] = pid;\n                    }\n                    break;\n                }\n                p = p.parentNode;\n            }\n        };\n\n        this.endpointDeleted = function (endpoint) {\n            if (_elementsWithEndpoints[endpoint.elementId]) {\n                _elementsWithEndpoints[endpoint.elementId]--;\n                if (_elementsWithEndpoints[endpoint.elementId] <= 0) {\n                    for (var i in _delements) {\n                        if (_delements.hasOwnProperty(i) && _delements[i]) {\n                            delete _delements[i][endpoint.elementId];\n                            delete _draggablesForElements[endpoint.elementId];\n                        }\n                    }\n                }\n            }\n        };\n\n        this.changeId = function (oldId, newId) {\n            _delements[newId] = _delements[oldId];\n            _delements[oldId] = {};\n            _draggablesForElements[newId] = _draggablesForElements[oldId];\n            _draggablesForElements[oldId] = null;\n        };\n\n        this.getElementsForDraggable = function (id) {\n            return _delements[id];\n        };\n\n        this.elementRemoved = function (elementId) {\n            var elId = _draggablesForElements[elementId];\n            if (elId) {\n                delete _delements[elId][elementId];\n                delete _draggablesForElements[elementId];\n            }\n        };\n\n        this.reset = function () {\n            _draggables = {};\n            _dlist = [];\n            _delements = {};\n            _elementsWithEndpoints = {};\n        };\n\n        //\n        // notification drag ended. We check automatically if need to update some\n        // ancestor's offsets.\n        //\n        this.dragEnded = function (el) {\n            if (el.offsetParent != null) {\n                var id = _currentInstance.getId(el),\n                    ancestor = _draggablesForElements[id];\n\n                if (ancestor) {\n                    this.updateOffsets(ancestor);\n                }\n            }\n        };\n\n        this.setParent = function (el, elId, p, pId, currentChildLocation) {\n            var current = _draggablesForElements[elId];\n            if (!_delements[pId]) {\n                _delements[pId] = {};\n            }\n            var pLoc = _currentInstance.getOffset(p),\n                cLoc = currentChildLocation || _currentInstance.getOffset(el);\n\n            if (current && _delements[current]) {\n                delete _delements[current][elId];\n            }\n\n            _delements[pId][elId] = {\n                id:elId,\n                offset : {\n                    left: cLoc.left - pLoc.left,\n                    top: cLoc.top - pLoc.top\n                }\n            };\n            _draggablesForElements[elId] = pId;\n        };\n\n        this.clearParent = function(el, elId) {\n            var current = _draggablesForElements[elId];\n            if (current) {\n                delete _delements[current][elId];\n                delete _draggablesForElements[elId];\n            }\n        };\n\n        this.revalidateParent = function(el, elId, childOffset) {\n            var current = _draggablesForElements[elId];\n            if (current) {\n                var co = {};\n                co[elId] = childOffset;\n                this.updateOffsets(current, co);\n                _currentInstance.revalidate(current);\n            }\n        };\n\n        this.getDragAncestor = function (el) {\n            var de = jsPlumb.getElement(el),\n                id = _currentInstance.getId(de),\n                aid = _draggablesForElements[id];\n\n            if (aid) {\n                return jsPlumb.getElement(aid);\n            }\n            else {\n                return null;\n            }\n        };\n\n    };\n\n    var _setClassName = function (el, cn, classList) {\n            cn = _ju.fastTrim(cn);\n            if (typeof el.className.baseVal !== \"undefined\") {\n                el.className.baseVal = cn;\n            }\n            else {\n                el.className = cn;\n            }\n\n            // recent (i currently have  61.0.3163.100) version of chrome do not update classList when you set the base val\n            // of an svg element's className. in the long run we'd like to move to just using classList anyway\n            try {\n                var cl = el.classList;\n                if (cl != null) {\n                    while (cl.length > 0) {\n                        cl.remove(cl.item(0));\n                    }\n                    for (var i = 0; i < classList.length; i++) {\n                        if (classList[i]) {\n                            cl.add(classList[i]);\n                        }\n                    }\n                }\n            }\n            catch(e) {\n                // not fatal\n                _ju.log(\"JSPLUMB: cannot set class list\", e);\n            }\n        },\n        _getClassName = function (el) {\n            return (typeof el.className.baseVal === \"undefined\") ? el.className : el.className.baseVal;\n        },\n        _classManip = function (el, classesToAdd, classesToRemove) {\n            classesToAdd = classesToAdd == null ? [] : _ju.isArray(classesToAdd) ? classesToAdd : classesToAdd.split(/\\s+/);\n            classesToRemove = classesToRemove == null ? [] : _ju.isArray(classesToRemove) ? classesToRemove : classesToRemove.split(/\\s+/);\n\n            var className = _getClassName(el),\n                curClasses = className.split(/\\s+/);\n\n            var _oneSet = function (add, classes) {\n                for (var i = 0; i < classes.length; i++) {\n                    if (add) {\n                        if (curClasses.indexOf(classes[i]) === -1) {\n                            curClasses.push(classes[i]);\n                        }\n                    }\n                    else {\n                        var idx = curClasses.indexOf(classes[i]);\n                        if (idx !== -1) {\n                            curClasses.splice(idx, 1);\n                        }\n                    }\n                }\n            };\n\n            _oneSet(true, classesToAdd);\n            _oneSet(false, classesToRemove);\n\n            _setClassName(el, curClasses.join(\" \"), curClasses);\n        };\n\n    root.jsPlumb.extend(root.jsPlumbInstance.prototype, {\n\n        headless: false,\n\n        pageLocation: _pageLocation,\n        screenLocation: _screenLocation,\n        clientLocation: _clientLocation,\n\n        getDragManager:function() {\n            if (this.dragManager == null) {\n                this.dragManager = new DragManager(this);\n            }\n\n            return this.dragManager;\n        },\n\n        recalculateOffsets:function(elId) {\n            this.getDragManager().updateOffsets(elId);\n        },\n\n        createElement:function(tag, style, clazz, atts) {\n            return this.createElementNS(null, tag, style, clazz, atts);\n        },\n\n        createElementNS:function(ns, tag, style, clazz, atts) {\n            var e = ns == null ? document.createElement(tag) : document.createElementNS(ns, tag);\n            var i;\n            style = style || {};\n            for (i in style) {\n                e.style[i] = style[i];\n            }\n\n            if (clazz) {\n                e.className = clazz;\n            }\n\n            atts = atts || {};\n            for (i in atts) {\n                e.setAttribute(i, \"\" + atts[i]);\n            }\n\n            return e;\n        },\n\n        getAttribute: function (el, attName) {\n            return el.getAttribute != null ? el.getAttribute(attName) : null;\n        },\n\n        setAttribute: function (el, a, v) {\n            if (el.setAttribute != null) {\n                el.setAttribute(a, v);\n            }\n        },\n\n        setAttributes: function (el, atts) {\n            for (var i in atts) {\n                if (atts.hasOwnProperty(i)) {\n                    el.setAttribute(i, atts[i]);\n                }\n            }\n        },\n        appendToRoot: function (node) {\n            document.body.appendChild(node);\n        },\n        getRenderModes: function () {\n            return [ \"svg\"  ];\n        },\n        getClass:_getClassName,\n        addClass: function (el, clazz) {\n            jsPlumb.each(el, function (e) {\n                _classManip(e, clazz);\n            });\n        },\n        hasClass: function (el, clazz) {\n            el = jsPlumb.getElement(el);\n            if (el.classList) {\n                return el.classList.contains(clazz);\n            }\n            else {\n                return _getClassName(el).indexOf(clazz) !== -1;\n            }\n        },\n        removeClass: function (el, clazz) {\n            jsPlumb.each(el, function (e) {\n                _classManip(e, null, clazz);\n            });\n        },\n        toggleClass:function(el, clazz) {\n            if (jsPlumb.hasClass(el, clazz)) {\n                jsPlumb.removeClass(el, clazz);\n            } else {\n                jsPlumb.addClass(el, clazz);\n            }\n        },\n        updateClasses: function (el, toAdd, toRemove) {\n            jsPlumb.each(el, function (e) {\n                _classManip(e, toAdd, toRemove);\n            });\n        },\n        setClass: function (el, clazz) {\n            if (clazz != null) {\n                jsPlumb.each(el, function (e) {\n                    _setClassName(e, clazz, clazz.split(/\\s+/));\n                });\n            }\n        },\n        setPosition: function (el, p) {\n            el.style.left = p.left + \"px\";\n            el.style.top = p.top + \"px\";\n        },\n        getPosition: function (el) {\n            var _one = function (prop) {\n                var v = el.style[prop];\n                return v ? v.substring(0, v.length - 2) : 0;\n            };\n            return {\n                left: _one(\"left\"),\n                top: _one(\"top\")\n            };\n        },\n        getStyle:function(el, prop) {\n            if (typeof window.getComputedStyle !== 'undefined') {\n                return getComputedStyle(el, null).getPropertyValue(prop);\n            } else {\n                return el.currentStyle[prop];\n            }\n        },\n        getSelector: function (ctx, spec) {\n            var sel = null;\n            if (arguments.length === 1) {\n                sel = ctx.nodeType != null ? ctx : document.querySelectorAll(ctx);\n            }\n            else {\n                sel = ctx.querySelectorAll(spec);\n            }\n\n            return sel;\n        },\n        getOffset:function(el, relativeToRoot, container) {\n            el = jsPlumb.getElement(el);\n            container = container || this.getContainer();\n            var out = {\n                    left: el.offsetLeft,\n                    top: el.offsetTop\n                },\n                op = (relativeToRoot  || (container != null && (el !== container && el.offsetParent !== container))) ?  el.offsetParent : null,\n                _maybeAdjustScroll = function(offsetParent) {\n                    if (offsetParent != null && offsetParent !== document.body && (offsetParent.scrollTop > 0 || offsetParent.scrollLeft > 0)) {\n                        out.left -= offsetParent.scrollLeft;\n                        out.top -= offsetParent.scrollTop;\n                    }\n                }.bind(this);\n\n            while (op != null) {\n                out.left += op.offsetLeft;\n                out.top += op.offsetTop;\n                _maybeAdjustScroll(op);\n                op = relativeToRoot ? op.offsetParent :\n                    op.offsetParent === container ? null : op.offsetParent;\n            }\n\n            // if container is scrolled and the element (or its offset parent) is not absolute or fixed, adjust accordingly.\n            if (container != null && !relativeToRoot && (container.scrollTop > 0 || container.scrollLeft > 0)) {\n                var pp = el.offsetParent != null ? this.getStyle(el.offsetParent, \"position\") : \"static\",\n                    p = this.getStyle(el, \"position\");\n                if (p !== \"absolute\" && p !== \"fixed\" && pp !== \"absolute\" && pp !== \"fixed\") {\n                    out.left -= container.scrollLeft;\n                    out.top -= container.scrollTop;\n                }\n            }\n            return out;\n        },\n        //\n        // return x+y proportion of the given element's size corresponding to the location of the given event.\n        //\n        getPositionOnElement: function (evt, el, zoom) {\n            var box = typeof el.getBoundingClientRect !== \"undefined\" ? el.getBoundingClientRect() : { left: 0, top: 0, width: 0, height: 0 },\n                body = document.body,\n                docElem = document.documentElement,\n                scrollTop = window.pageYOffset || docElem.scrollTop || body.scrollTop,\n                scrollLeft = window.pageXOffset || docElem.scrollLeft || body.scrollLeft,\n                clientTop = docElem.clientTop || body.clientTop || 0,\n                clientLeft = docElem.clientLeft || body.clientLeft || 0,\n                pst = 0,\n                psl = 0,\n                top = box.top + scrollTop - clientTop + (pst * zoom),\n                left = box.left + scrollLeft - clientLeft + (psl * zoom),\n                cl = jsPlumb.pageLocation(evt),\n                w = box.width || (el.offsetWidth * zoom),\n                h = box.height || (el.offsetHeight * zoom),\n                x = (cl[0] - left) / w,\n                y = (cl[1] - top) / h;\n\n            return [ x, y ];\n        },\n\n        /**\n         * Gets the absolute position of some element as read from the left/top properties in its style.\n         * @method getAbsolutePosition\n         * @param {Element} el The element to retrieve the absolute coordinates from. **Note** this is a DOM element, not a selector from the underlying library.\n         * @return {Number[]} [left, top] pixel values.\n         */\n        getAbsolutePosition: function (el) {\n            var _one = function (s) {\n                var ss = el.style[s];\n                if (ss) {\n                    return parseFloat(ss.substring(0, ss.length - 2));\n                }\n            };\n            return [ _one(\"left\"), _one(\"top\") ];\n        },\n\n        /**\n         * Sets the absolute position of some element by setting the left/top properties in its style.\n         * @method setAbsolutePosition\n         * @param {Element} el The element to set the absolute coordinates on. **Note** this is a DOM element, not a selector from the underlying library.\n         * @param {Number[]} xy x and y coordinates\n         * @param {Number[]} [animateFrom] Optional previous xy to animate from.\n         * @param {Object} [animateOptions] Options for the animation.\n         */\n        setAbsolutePosition: function (el, xy, animateFrom, animateOptions) {\n            if (animateFrom) {\n                this.animate(el, {\n                    left: \"+=\" + (xy[0] - animateFrom[0]),\n                    top: \"+=\" + (xy[1] - animateFrom[1])\n                }, animateOptions);\n            }\n            else {\n                el.style.left = xy[0] + \"px\";\n                el.style.top = xy[1] + \"px\";\n            }\n        },\n        /**\n         * gets the size for the element, in an array : [ width, height ].\n         */\n        getSize: function (el) {\n            return [ el.offsetWidth, el.offsetHeight ];\n        },\n        getWidth: function (el) {\n            return el.offsetWidth;\n        },\n        getHeight: function (el) {\n            return el.offsetHeight;\n        },\n        getRenderMode : function() { return \"svg\"; },\n        draggable : function (el, options) {\n            var info;\n            el = _ju.isArray(el) || (el.length != null && !_ju.isString(el)) ? el: [ el ];\n            Array.prototype.slice.call(el).forEach(function(_el) {\n                info = this.info(_el);\n                if (info.el) {\n                    this._initDraggableIfNecessary(info.el, true, options, info.id, true);\n                }\n            }.bind(this));\n            return this;\n        },\n        snapToGrid : function(el, x, y) {\n            var out = [];\n            var _oneEl = function(_el) {\n                var info = this.info(_el);\n                if (info.el != null && info.el._katavorioDrag) {\n                    var snapped = info.el._katavorioDrag.snap(x, y);\n                    this.revalidate(info.el);\n                    out.push([info.el, snapped]);\n                }\n            }.bind(this);\n\n            // if you call this method with 0 arguments or 2 arguments it is assumed you want to snap all managed elements to\n            // a grid. if you supply one argument or 3, then you are assumed to be specifying one element.\n            if(arguments.length === 1 || arguments.length === 3) {\n                _oneEl(el, x, y);\n            } else {\n                var _me = this.getManagedElements();\n                for (var mel in _me) {\n                    _oneEl(mel, arguments[0], arguments[1]);\n                }\n            }\n\n            return out;\n        },\n        initDraggable: function (el, options, category) {\n            _getDragManager(this, category).draggable(el, options);\n            el._jsPlumbDragOptions = options;\n        },\n        destroyDraggable: function (el, category) {\n            _getDragManager(this, category).destroyDraggable(el);\n            delete el._jsPlumbDragOptions;\n        },\n        unbindDraggable: function (el, evt, fn, category) {\n            _getDragManager(this, category).destroyDraggable(el, evt, fn);\n        },\n        setDraggable : function (element, draggable) {\n            return jsPlumb.each(element, function (el) {\n                if (this.isDragSupported(el)) {\n                    this._draggableStates[this.getAttribute(el, \"id\")] = draggable;\n                    this.setElementDraggable(el, draggable);\n                }\n            }.bind(this));\n        },\n        _draggableStates : {},\n        /*\n         * toggles the draggable state of the given element(s).\n         * el is either an id, or an element object, or a list of ids/element objects.\n         */\n        toggleDraggable : function (el) {\n            var state;\n            jsPlumb.each(el, function (el) {\n                var elId = this.getAttribute(el, \"id\");\n                state = this._draggableStates[elId] == null ? false : this._draggableStates[elId];\n                state = !state;\n                this._draggableStates[elId] = state;\n                this.setDraggable(el, state);\n                return state;\n            }.bind(this));\n            return state;\n        },\n        _initDraggableIfNecessary : function (element, isDraggable, dragOptions, id, fireEvent) {\n            // TODO FIRST: move to DragManager. including as much of the decision to init dragging as possible.\n            if (!jsPlumb.headless) {\n                var _draggable = isDraggable == null ? false : isDraggable;\n                if (_draggable) {\n                    if (jsPlumb.isDragSupported(element, this)) {\n                        var options = dragOptions || this.Defaults.DragOptions;\n                        options = jsPlumb.extend({}, options); // make a copy.\n                        if (!jsPlumb.isAlreadyDraggable(element, this)) {\n                            var dragEvent = jsPlumb.dragEvents.drag,\n                                stopEvent = jsPlumb.dragEvents.stop,\n                                startEvent = jsPlumb.dragEvents.start;\n\n                            this.manage(id, element);\n\n                            options[startEvent] = _ju.wrap(options[startEvent], _dragStart.bind(this));\n\n                            options[dragEvent] = _ju.wrap(options[dragEvent], _dragMove.bind(this));\n\n                            options[stopEvent] = _ju.wrap(options[stopEvent], _dragStop.bind(this));\n\n                            var elId = this.getId(element); // need ID\n\n                            this._draggableStates[elId] = true;\n                            var draggable = this._draggableStates[elId];\n\n                            options.disabled = draggable == null ? false : !draggable;\n                            this.initDraggable(element, options);\n                            this.getDragManager().register(element);\n                            if (fireEvent) {\n                                this.fire(\"elementDraggable\", {el:element, options:options});\n                            }\n                        }\n                        else {\n                            // already draggable. attach any start, drag or stop listeners to the current Drag.\n                            if (dragOptions.force) {\n                                this.initDraggable(element, options);\n                            }\n                        }\n                    }\n                }\n            }\n        },\n        animationSupported:true,\n        getElement: function (el) {\n            if (el == null) {\n                return null;\n            }\n            // here we pluck the first entry if el was a list of entries.\n            // this is not my favourite thing to do, but previous versions of\n            // jsplumb supported jquery selectors, and it is possible a selector\n            // will be passed in here.\n            el = typeof el === \"string\" ? el : el.length != null && el.enctype == null ? el[0] : el;\n            return typeof el === \"string\" ? document.getElementById(el) : el;\n        },\n        removeElement: function (element) {\n            _getDragManager(this).elementRemoved(element);\n            this.getEventManager().remove(element);\n        },\n        //\n        // this adapter supports a rudimentary animation function. no easing is supported.  only\n        // left/top properties are supported. property delta args are expected to be in the form\n        //\n        // +=x.xxxx\n        //\n        // or\n        //\n        // -=x.xxxx\n        //\n        doAnimate: function (el, properties, options) {\n            options = options || {};\n            var o = this.getOffset(el),\n                ap = _animProps(o, properties),\n                ldist = ap[0] - o.left,\n                tdist = ap[1] - o.top,\n                d = options.duration || 250,\n                step = 15, steps = d / step,\n                linc = (step / d) * ldist,\n                tinc = (step / d) * tdist,\n                idx = 0,\n                _int = setInterval(function () {\n                    _jp.setPosition(el, {\n                        left: o.left + (linc * (idx + 1)),\n                        top: o.top + (tinc * (idx + 1))\n                    });\n                    if (options.step != null) {\n                        options.step(idx, Math.ceil(steps));\n                    }\n                    idx++;\n                    if (idx >= steps) {\n                        window.clearInterval(_int);\n                        if (options.complete != null) {\n                            options.complete();\n                        }\n                    }\n                }, step);\n        },\n        // DRAG/DROP\n\n\n        destroyDroppable: function (el, category) {\n            _getDragManager(this, category).destroyDroppable(el);\n        },\n        unbindDroppable: function (el, evt, fn, category) {\n            _getDragManager(this, category).destroyDroppable(el, evt, fn);\n        },\n\n        droppable :function(el, options) {\n            el = _ju.isArray(el) || (el.length != null && !_ju.isString(el)) ? el: [ el ];\n            var info;\n            options = options || {};\n            options.allowLoopback = false;\n            Array.prototype.slice.call(el).forEach(function(_el) {\n                info = this.info(_el);\n                if (info.el) {\n                    this.initDroppable(info.el, options);\n                }\n            }.bind(this));\n            return this;\n        },\n\n        initDroppable: function (el, options, category) {\n            _getDragManager(this, category).droppable(el, options);\n        },\n        isAlreadyDraggable: function (el) {\n            return el._katavorioDrag != null;\n        },\n        isDragSupported: function (el, options) {\n            return true;\n        },\n        isDropSupported: function (el, options) {\n            return true;\n        },\n        isElementDraggable: function (el) {\n            el = _jp.getElement(el);\n            return el._katavorioDrag && el._katavorioDrag.isEnabled();\n        },\n        getDragObject: function (eventArgs) {\n            return eventArgs[0].drag.getDragElement();\n        },\n        getDragScope: function (el) {\n            return el._katavorioDrag && el._katavorioDrag.scopes.join(\" \") || \"\";\n        },\n        getDropEvent: function (args) {\n            return args[0].e;\n        },\n        getUIPosition: function (eventArgs, zoom) {\n            // here the position reported to us by Katavorio is relative to the element's offsetParent. For top\n            // level nodes that is fine, but if we have a nested draggable then its offsetParent is actually\n            // not going to be the jsplumb container; it's going to be some child of that element. In that case\n            // we want to adjust the UI position to account for the offsetParent's position relative to the Container\n            // origin.\n            var el = eventArgs[0].el;\n            if (el.offsetParent == null) {\n                return null;\n            }\n            var finalPos = eventArgs[0].finalPos || eventArgs[0].pos;\n            var p = { left:finalPos[0], top:finalPos[1] };\n            if (el._katavorioDrag && el.offsetParent !== this.getContainer()) {\n                var oc = this.getOffset(el.offsetParent);\n                p.left += oc.left;\n                p.top += oc.top;\n            }\n            return p;\n        },\n        setDragFilter: function (el, filter, _exclude) {\n            if (el._katavorioDrag) {\n                el._katavorioDrag.setFilter(filter, _exclude);\n            }\n        },\n        setElementDraggable: function (el, draggable) {\n            el = _jp.getElement(el);\n            if (el._katavorioDrag) {\n                el._katavorioDrag.setEnabled(draggable);\n            }\n        },\n        setDragScope: function (el, scope) {\n            if (el._katavorioDrag) {\n                el._katavorioDrag.k.setDragScope(el, scope);\n            }\n        },\n        setDropScope:function(el, scope) {\n            if (el._katavorioDrop && el._katavorioDrop.length > 0) {\n                el._katavorioDrop[0].k.setDropScope(el, scope);\n            }\n        },\n        addToPosse:function(el, spec) {\n            var specs = Array.prototype.slice.call(arguments, 1);\n            var dm = _getDragManager(this);\n            _jp.each(el, function(_el) {\n                _el = [ _jp.getElement(_el) ];\n                _el.push.apply(_el, specs );\n                dm.addToPosse.apply(dm, _el);\n            });\n        },\n        setPosse:function(el, spec) {\n            var specs = Array.prototype.slice.call(arguments, 1);\n            var dm = _getDragManager(this);\n            _jp.each(el, function(_el) {\n                _el = [ _jp.getElement(_el) ];\n                _el.push.apply(_el, specs );\n                dm.setPosse.apply(dm, _el);\n            });\n        },\n        removeFromPosse:function(el, posseId) {\n            var specs = Array.prototype.slice.call(arguments, 1);\n            var dm = _getDragManager(this);\n            _jp.each(el, function(_el) {\n                _el = [ _jp.getElement(_el) ];\n                _el.push.apply(_el, specs );\n                dm.removeFromPosse.apply(dm, _el);\n            });\n        },\n        removeFromAllPosses:function(el) {\n            var dm = _getDragManager(this);\n            _jp.each(el, function(_el) { dm.removeFromAllPosses(_jp.getElement(_el)); });\n        },\n        setPosseState:function(el, posseId, state) {\n            var dm = _getDragManager(this);\n            _jp.each(el, function(_el) { dm.setPosseState(_jp.getElement(_el), posseId, state); });\n        },\n        dragEvents: {\n            'start': 'start', 'stop': 'stop', 'drag': 'drag', 'step': 'step',\n            'over': 'over', 'out': 'out', 'drop': 'drop', 'complete': 'complete',\n            'beforeStart':'beforeStart'\n        },\n        animEvents: {\n            'step': \"step\", 'complete': 'complete'\n        },\n        stopDrag: function (el) {\n            if (el._katavorioDrag) {\n                el._katavorioDrag.abort();\n            }\n        },\n        addToDragSelection: function (spec) {\n            var el = this.getElement(spec);\n            if (el != null && (el._isJsPlumbGroup || el._jsPlumbGroup == null)) {\n                _getDragManager(this).select(spec);\n            }\n        },\n        removeFromDragSelection: function (spec) {\n            _getDragManager(this).deselect(spec);\n        },\n        getDragSelection:function() {\n            return _getDragManager(this).getSelection();\n        },\n        clearDragSelection: function () {\n            _getDragManager(this).deselectAll();\n        },\n        trigger: function (el, event, originalEvent, payload) {\n            this.getEventManager().trigger(el, event, originalEvent, payload);\n        },\n        doReset:function() {\n            // look for katavorio instances and reset each one if found.\n            for (var key in this) {\n                if (key.indexOf(\"_katavorio_\") === 0) {\n                    this[key].reset();\n                }\n            }\n        },\n        getEventManager:function() {\n            return _getEventManager(this);\n        },\n        on : function(el, event, callback) {\n            // TODO: here we would like to map the tap event if we know its\n            // an internal bind to a click. we have to know its internal because only\n            // then can we be sure that the UP event wont be consumed (tap is a synthesized\n            // event from a mousedown followed by a mouseup).\n            //event = { \"click\":\"tap\", \"dblclick\":\"dbltap\"}[event] || event;\n            this.getEventManager().on.apply(this, arguments);\n            return this;\n        },\n        off : function(el, event, callback) {\n            this.getEventManager().off.apply(this, arguments);\n            return this;\n        }\n\n    });\n\n    var ready = function (f) {\n        var _do = function () {\n            if (/complete|loaded|interactive/.test(document.readyState) && typeof(document.body) !== \"undefined\" && document.body != null) {\n                f();\n            }\n            else {\n                setTimeout(_do, 9);\n            }\n        };\n\n        _do();\n    };\n    ready(_jp.init);\n\n}).call(typeof window !== 'undefined' ? window : this);\n","import { __decorate, __metadata, __param } from 'tslib';\nimport { EventEmitter, ViewChild, ElementRef, Output, InjectionToken, NgZone, Inject, Input, Component, forwardRef, NgModule } from '@angular/core';\nimport { NG_VALUE_ACCESSOR } from '@angular/forms';\nimport { fromEvent } from 'rxjs';\nimport { CommonModule } from '@angular/common';\n\nimport * as ɵngcc0 from '@angular/core';\n\nconst _c0 = [\"editorContainer\"];\nlet loadedMonaco = false;\nlet loadPromise;\nclass BaseEditor {\n    constructor(config) {\n        this.config = config;\n        this.onInit = new EventEmitter();\n    }\n    ngAfterViewInit() {\n        if (loadedMonaco) {\n            // Wait until monaco editor is available\n            loadPromise.then(() => {\n                this.initMonaco(this._options);\n            });\n        }\n        else {\n            loadedMonaco = true;\n            loadPromise = new Promise((resolve) => {\n                const baseUrl = this.config.baseUrl || './assets';\n                if (typeof (window.monaco) === 'object') {\n                    resolve();\n                    return;\n                }\n                const onGotAmdLoader = () => {\n                    // Load monaco\n                    window.require.config({ paths: { 'vs': `${baseUrl}/monaco/vs` } });\n                    window.require(['vs/editor/editor.main'], () => {\n                        if (typeof this.config.onMonacoLoad === 'function') {\n                            this.config.onMonacoLoad();\n                        }\n                        this.initMonaco(this._options);\n                        resolve();\n                    });\n                };\n                // Load AMD loader if necessary\n                if (!window.require) {\n                    const loaderScript = document.createElement('script');\n                    loaderScript.type = 'text/javascript';\n                    loaderScript.src = `${baseUrl}/monaco/vs/loader.js`;\n                    loaderScript.addEventListener('load', onGotAmdLoader);\n                    document.body.appendChild(loaderScript);\n                }\n                else {\n                    onGotAmdLoader();\n                }\n            });\n        }\n    }\n    ngOnDestroy() {\n        if (this._windowResizeSubscription) {\n            this._windowResizeSubscription.unsubscribe();\n        }\n        if (this._editor) {\n            this._editor.dispose();\n            this._editor = undefined;\n        }\n    }\n}\nBaseEditor.ɵfac = function BaseEditor_Factory(t) { ɵngcc0.ɵɵinvalidFactory(); };\nBaseEditor.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: BaseEditor, viewQuery: function BaseEditor_Query(rf, ctx) { if (rf & 1) {\n        ɵngcc0.ɵɵstaticViewQuery(_c0, true);\n    } if (rf & 2) {\n        var _t;\n        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx._editorContainer = _t.first);\n    } }, outputs: { onInit: \"onInit\" } });\n__decorate([\n    ViewChild('editorContainer', { static: true }),\n    __metadata(\"design:type\", ElementRef)\n], BaseEditor.prototype, \"_editorContainer\", void 0);\n__decorate([\n    Output(),\n    __metadata(\"design:type\", Object)\n], BaseEditor.prototype, \"onInit\", void 0);\n\nconst NGX_MONACO_EDITOR_CONFIG = new InjectionToken('NGX_MONACO_EDITOR_CONFIG');\n\nvar EditorComponent_1;\nlet EditorComponent = EditorComponent_1 = class EditorComponent extends BaseEditor {\n    constructor(zone, editorConfig) {\n        super(editorConfig);\n        this.zone = zone;\n        this.editorConfig = editorConfig;\n        this._value = '';\n        this.propagateChange = (_) => { };\n        this.onTouched = () => { };\n    }\n    set options(options) {\n        this._options = Object.assign({}, this.config.defaultOptions, options);\n        if (this._editor) {\n            this._editor.dispose();\n            this.initMonaco(options);\n        }\n    }\n    get options() {\n        return this._options;\n    }\n    set model(model) {\n        this.options.model = model;\n        if (this._editor) {\n            this._editor.dispose();\n            this.initMonaco(this.options);\n        }\n    }\n    writeValue(value) {\n        this._value = value || '';\n        // Fix for value change while dispose in process.\n        setTimeout(() => {\n            if (this._editor && !this.options.model) {\n                this._editor.setValue(this._value);\n            }\n        });\n    }\n    registerOnChange(fn) {\n        this.propagateChange = fn;\n    }\n    registerOnTouched(fn) {\n        this.onTouched = fn;\n    }\n    initMonaco(options) {\n        const hasModel = !!options.model;\n        if (hasModel) {\n            const model = monaco.editor.getModel(options.model.uri || '');\n            if (model) {\n                options.model = model;\n                options.model.setValue(this._value);\n            }\n            else {\n                options.model = monaco.editor.createModel(options.model.value, options.model.language, options.model.uri);\n            }\n        }\n        this._editor = monaco.editor.create(this._editorContainer.nativeElement, options);\n        if (!hasModel) {\n            this._editor.setValue(this._value);\n        }\n        this._editor.onDidChangeModelContent((e) => {\n            const value = this._editor.getValue();\n            // value is not propagated to parent when executing outside zone.\n            this.zone.run(() => {\n                this.propagateChange(value);\n                this._value = value;\n            });\n        });\n        this._editor.onDidBlurEditorWidget(() => {\n            this.onTouched();\n        });\n        // refresh layout on resize event.\n        if (this._windowResizeSubscription) {\n            this._windowResizeSubscription.unsubscribe();\n        }\n        this._windowResizeSubscription = fromEvent(window, 'resize').subscribe(() => this._editor.layout());\n        this.onInit.emit(this._editor);\n    }\n};\nEditorComponent.ɵfac = function EditorComponent_Factory(t) { return new (t || EditorComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.NgZone), ɵngcc0.ɵɵdirectiveInject(NGX_MONACO_EDITOR_CONFIG)); };\nEditorComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: EditorComponent, selectors: [[\"ngx-monaco-editor\"]], inputs: { options: \"options\", model: \"model\" }, features: [ɵngcc0.ɵɵProvidersFeature([{\n                provide: NG_VALUE_ACCESSOR,\n                useExisting: forwardRef(() => EditorComponent_1),\n                multi: true\n            }]), ɵngcc0.ɵɵInheritDefinitionFeature], decls: 2, vars: 0, consts: [[1, \"editor-container\"], [\"editorContainer\", \"\"]], template: function EditorComponent_Template(rf, ctx) { if (rf & 1) {\n        ɵngcc0.ɵɵelement(0, \"div\", 0, 1);\n    } }, styles: [\"[_nghost-%COMP%] {\\n      display: block;\\n      height: 200px;\\n    }\\n\\n    .editor-container[_ngcontent-%COMP%] {\\n      width: 100%;\\n      height: 98%;\\n    }\"] });\nEditorComponent.ctorParameters = () => [\n    { type: NgZone },\n    { type: undefined, decorators: [{ type: Inject, args: [NGX_MONACO_EDITOR_CONFIG,] }] }\n];\n__decorate([\n    Input('options'),\n    __metadata(\"design:type\", Object),\n    __metadata(\"design:paramtypes\", [Object])\n], EditorComponent.prototype, \"options\", null);\n__decorate([\n    Input('model'),\n    __metadata(\"design:type\", Object),\n    __metadata(\"design:paramtypes\", [Object])\n], EditorComponent.prototype, \"model\", null);\nEditorComponent = EditorComponent_1 = __decorate([ __param(1, Inject(NGX_MONACO_EDITOR_CONFIG)),\n    __metadata(\"design:paramtypes\", [NgZone, Object])\n], EditorComponent);\n\nlet DiffEditorComponent = class DiffEditorComponent extends BaseEditor {\n    constructor(editorConfig) {\n        super(editorConfig);\n        this.editorConfig = editorConfig;\n    }\n    set options(options) {\n        this._options = Object.assign({}, this.config.defaultOptions, options);\n        if (this._editor) {\n            this._editor.dispose();\n            this.initMonaco(options);\n        }\n    }\n    get options() {\n        return this._options;\n    }\n    set originalModel(model) {\n        this._originalModel = model;\n        if (this._editor) {\n            this._editor.dispose();\n            this.initMonaco(this.options);\n        }\n    }\n    set modifiedModel(model) {\n        this._modifiedModel = model;\n        if (this._editor) {\n            this._editor.dispose();\n            this.initMonaco(this.options);\n        }\n    }\n    initMonaco(options) {\n        if (!this._originalModel || !this._modifiedModel) {\n            throw new Error('originalModel or modifiedModel not found for ngx-monaco-diff-editor');\n        }\n        this._originalModel.language = this._originalModel.language || options.language;\n        this._modifiedModel.language = this._modifiedModel.language || options.language;\n        let originalModel = monaco.editor.createModel(this._originalModel.code, this._originalModel.language);\n        let modifiedModel = monaco.editor.createModel(this._modifiedModel.code, this._modifiedModel.language);\n        this._editorContainer.nativeElement.innerHTML = '';\n        const theme = options.theme;\n        this._editor = monaco.editor.createDiffEditor(this._editorContainer.nativeElement, options);\n        options.theme = theme;\n        this._editor.setModel({\n            original: originalModel,\n            modified: modifiedModel\n        });\n        // refresh layout on resize event.\n        if (this._windowResizeSubscription) {\n            this._windowResizeSubscription.unsubscribe();\n        }\n        this._windowResizeSubscription = fromEvent(window, 'resize').subscribe(() => this._editor.layout());\n        this.onInit.emit(this._editor);\n    }\n};\nDiffEditorComponent.ɵfac = function DiffEditorComponent_Factory(t) { return new (t || DiffEditorComponent)(ɵngcc0.ɵɵdirectiveInject(NGX_MONACO_EDITOR_CONFIG)); };\nDiffEditorComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: DiffEditorComponent, selectors: [[\"ngx-monaco-diff-editor\"]], inputs: { options: \"options\", originalModel: \"originalModel\", modifiedModel: \"modifiedModel\" }, features: [ɵngcc0.ɵɵInheritDefinitionFeature], decls: 2, vars: 0, consts: [[1, \"editor-container\"], [\"editorContainer\", \"\"]], template: function DiffEditorComponent_Template(rf, ctx) { if (rf & 1) {\n        ɵngcc0.ɵɵelement(0, \"div\", 0, 1);\n    } }, styles: [\"[_nghost-%COMP%] {\\n      display: block;\\n      height: 200px;\\n    }\\n\\n    .editor-container[_ngcontent-%COMP%] {\\n      width: 100%;\\n      height: 98%;\\n    }\"] });\nDiffEditorComponent.ctorParameters = () => [\n    { type: undefined, decorators: [{ type: Inject, args: [NGX_MONACO_EDITOR_CONFIG,] }] }\n];\n__decorate([\n    Input('options'),\n    __metadata(\"design:type\", Object),\n    __metadata(\"design:paramtypes\", [Object])\n], DiffEditorComponent.prototype, \"options\", null);\n__decorate([\n    Input('originalModel'),\n    __metadata(\"design:type\", Object),\n    __metadata(\"design:paramtypes\", [Object])\n], DiffEditorComponent.prototype, \"originalModel\", null);\n__decorate([\n    Input('modifiedModel'),\n    __metadata(\"design:type\", Object),\n    __metadata(\"design:paramtypes\", [Object])\n], DiffEditorComponent.prototype, \"modifiedModel\", null);\nDiffEditorComponent = __decorate([ __param(0, Inject(NGX_MONACO_EDITOR_CONFIG)),\n    __metadata(\"design:paramtypes\", [Object])\n], DiffEditorComponent);\n\nvar MonacoEditorModule_1;\nlet MonacoEditorModule = MonacoEditorModule_1 = class MonacoEditorModule {\n    static forRoot(config = {}) {\n        return {\n            ngModule: MonacoEditorModule_1,\n            providers: [\n                { provide: NGX_MONACO_EDITOR_CONFIG, useValue: config }\n            ]\n        };\n    }\n};\nMonacoEditorModule.ɵmod = ɵngcc0.ɵɵdefineNgModule({ type: MonacoEditorModule });\nMonacoEditorModule.ɵinj = ɵngcc0.ɵɵdefineInjector({ factory: function MonacoEditorModule_Factory(t) { return new (t || MonacoEditorModule)(); }, imports: [[\n            CommonModule\n        ]] });\n\n/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(EditorComponent, [{\n        type: Component,\n        args: [{\n                selector: 'ngx-monaco-editor',\n                template: '<div class=\"editor-container\" #editorContainer></div>',\n                providers: [{\n                        provide: NG_VALUE_ACCESSOR,\n                        useExisting: forwardRef(() => EditorComponent_1),\n                        multi: true\n                    }],\n                styles: [`\n    :host {\n      display: block;\n      height: 200px;\n    }\n\n    .editor-container {\n      width: 100%;\n      height: 98%;\n    }\n  `]\n            }]\n    }], function () { return [{ type: ɵngcc0.NgZone }, { type: undefined, decorators: [{\n                type: Inject,\n                args: [NGX_MONACO_EDITOR_CONFIG]\n            }] }]; }, { options: [{\n            type: Input,\n            args: ['options']\n        }], model: [{\n            type: Input,\n            args: ['model']\n        }] }); })();\n/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(DiffEditorComponent, [{\n        type: Component,\n        args: [{\n                selector: 'ngx-monaco-diff-editor',\n                template: '<div class=\"editor-container\" #editorContainer></div>',\n                styles: [`\n    :host {\n      display: block;\n      height: 200px;\n    }\n\n    .editor-container {\n      width: 100%;\n      height: 98%;\n    }\n  `]\n            }]\n    }], function () { return [{ type: undefined, decorators: [{\n                type: Inject,\n                args: [NGX_MONACO_EDITOR_CONFIG]\n            }] }]; }, { options: [{\n            type: Input,\n            args: ['options']\n        }], originalModel: [{\n            type: Input,\n            args: ['originalModel']\n        }], modifiedModel: [{\n            type: Input,\n            args: ['modifiedModel']\n        }] }); })();\n(function () { (typeof ngJitMode === \"undefined\" || ngJitMode) && ɵngcc0.ɵɵsetNgModuleScope(MonacoEditorModule, { declarations: function () { return [EditorComponent,\n        DiffEditorComponent]; }, imports: function () { return [CommonModule]; }, exports: function () { return [EditorComponent,\n        DiffEditorComponent]; } }); })();\n/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(MonacoEditorModule, [{\n        type: NgModule,\n        args: [{\n                imports: [\n                    CommonModule\n                ],\n                declarations: [\n                    EditorComponent,\n                    DiffEditorComponent\n                ],\n                exports: [\n                    EditorComponent,\n                    DiffEditorComponent\n                ]\n            }]\n    }], null, null); })();\n\n/*\n * Public API Surface of my-lib\n */\n\n/**\n * Generated bundle index. Do not edit.\n */\n\nexport { DiffEditorComponent, EditorComponent, MonacoEditorModule, NGX_MONACO_EDITOR_CONFIG, BaseEditor as ɵa };\n\n//# sourceMappingURL=ngx-monaco-editor.js.map","import { Component, OnInit } from '@angular/core';\n\n@Component({\n  selector: 'app-design-block-types',\n  templateUrl: './design-block-types.component.html',\n  styleUrls: ['./design-block-types.component.scss']\n})\nexport class DesignBlockTypesComponent implements OnInit {\n\n  constructor() { }\n\n  ngOnInit(): void {\n  }\n\n}\n","<div class=\"main-container\" style=\"height: calc(100% - 60px) !important;\">\n  <div class=\"content-container\">\n    <div class=\"content-area\">\n      <app-records-list-view [table]=\"'blockTypes'\"></app-records-list-view>\n    </div>\n  </div>\n</div>\n","import { Component, OnInit } from '@angular/core';\n\n@Component({\n  selector: 'app-design-blocks',\n  templateUrl: './design-blocks.component.html',\n  styleUrls: ['./design-blocks.component.scss']\n})\nexport class DesignBlocksComponent implements OnInit {\n\n  constructor() { }\n\n  ngOnInit(): void {\n  }\n\n}\n","<div class=\"main-container\" style=\"height: calc(100% - 60px) !important;\">\n  <div class=\"content-container\">\n    <div class=\"content-area\">\n      <app-records-list-view [table]=\"'blocks'\"></app-records-list-view>\n    </div>\n  </div>\n</div>\n\n","import { Component, OnInit } from '@angular/core';\n\n@Component({\n  selector: 'app-design-custom-icons',\n  templateUrl: './design-custom-icons.component.html',\n  styleUrls: ['./design-custom-icons.component.scss']\n})\nexport class DesignCustomIconsComponent implements OnInit {\n\n  constructor() { }\n\n  ngOnInit(): void {\n  }\n\n}\n","<div class=\"main-container\" style=\"height: calc(100% - 60px) !important;\">\n  <div class=\"content-container\">\n    <div class=\"content-area\">\n      <app-records-list-view [table]=\"'customIcons'\"></app-records-list-view>\n    </div>\n  </div>\n</div>\n\n","import { Component, OnInit } from '@angular/core';\n\n@Component({\n  selector: 'app-design-home',\n  templateUrl: './design-home.component.html',\n  styleUrls: ['./design-home.component.scss']\n})\nexport class DesignHomeComponent implements OnInit {\n\n  constructor() { }\n\n  ngOnInit(): void {\n  }\n\n}\n","<div class=\"home-container\" style=\"padding: 10px;\">\n  <h1 syle=\"padding: 0 !important; margin: 0 !important;\">Design Introduction</h1>\n  <h2 syle=\"padding: 0 !important; margin: 0 !important;\">Blocks</h2>\n  <p syle=\"padding: 0 !important; margin: 0 !important;\">\n    Blocks are used to build workflows.  All blocks have a parent <a routerLink=\"/design/block-types\">block type.</a>\n  </p>\n</div>\n","import { Component, OnInit } from '@angular/core';\n\n@Component({\n  selector: 'app-design-providers',\n  templateUrl: './design-providers.component.html',\n  styleUrls: ['./design-providers.component.scss']\n})\nexport class DesignProvidersComponent implements OnInit {\n\n  constructor() { }\n\n  ngOnInit(): void {\n  }\n\n}\n","<p>design-providers works!</p>\n","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { DesignComponent } from './design.component';\nimport { WorkflowStudioRootComponent } from './workflow-studio-root/workflow-studio-root.component';\nimport { DesignHomeComponent } from './design-home/design-home.component';\nimport { DesignBlocksComponent } from './design-blocks/design-blocks.component';\nimport { DesignWorkflowsComponent } from './design-workflows/design-workflows.component';\nimport { DesignBlockTypesComponent } from './design-block-types/design-block-types.component';\nimport { DesignWorkflowEditorComponent } from './design-workflow-editor/design-workflow-editor.component';\nimport { DesignWorkflowTreeComponent } from './design-workflow-tree/design-workflow-tree.component';\nimport { DesignCustomIconsComponent } from './design-custom-icons/design-custom-icons.component';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: DesignComponent,\n    children: [\n      {\n        path: '',\n        pathMatch: 'full',\n        redirectTo: 'workflows'\n      },\n      {\n        path: 'home',\n        component: DesignHomeComponent\n      },\n      {\n        path: 'blocks',\n        component: DesignBlocksComponent\n      },\n      {\n        path: 'workflows',\n        component: DesignWorkflowsComponent\n      },\n      {\n        path: 'block-types',\n        component: DesignBlockTypesComponent\n      },\n      {\n        path: 'custom-icons',\n        component: DesignCustomIconsComponent\n      },\n      {\n        path: 'workflows/editor/:id',\n        component: DesignWorkflowEditorComponent\n      }\n    ]\n  },\n  {\n    path: 'tree',\n    component: DesignWorkflowTreeComponent\n  }\n\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule]\n})\nexport class DesignRoutingModule { }\n","import { Component, OnInit, OnDestroy, AfterViewInit, AfterContentInit, ViewEncapsulation, Input, ViewContainerRef, ViewChild } from '@angular/core';\nimport { Observable, Subscription } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { Paginated } from '@feathersjs/feathers';\nimport { Router, ActivatedRoute } from '@angular/router';\nimport { DataService } from '../../core/services/data.service';\nimport { NodeService } from '../node.service';\nimport { AuthService } from '../../core/services/auth.service';\nimport { TreelistService } from '../treelist.service';\n \n// @ts-ignore\nimport data from '../../../../assets/DatabaseLayout.json';\n\n\n@Component({\n  selector: 'app-design-workflow-editor',\n  templateUrl: './design-workflow-editor.component.html',\n  styleUrls: ['./design-workflow-editor.component.scss']\n})\nexport class DesignWorkflowEditorComponent implements OnInit, AfterViewInit {\n\n  editorOptions = {theme: 'vs-dark', language: 'javascript'};\n  code: string= 'function x() {\\nconsole.log(\"Hello world!\");\\n}';\n\n  treeLists = [];\n  currentlySelectedTree;\n  currentlySelectedTreeId;\n\n  blocks$: Observable<any>;\n  ansibleWorkflows$: Observable<any>;\n  pwshScripts$: Observable<any>;\n    \n\n  nodes = [];\n\n  activities$: Observable<any>;\n\n  text = 'hi'\n\n  loading: boolean = true;\n\n  nodes$: Observable<any>;\n  connections$: Observable<any>;\n\n  workflow: any;\n\n  connections = [];\n\n  showNodeConfig: boolean = false;\n  currentNode: any = null;\n\n  @ViewChild('nodes', { read: ViewContainerRef }) viewContainerRef;\n\n  constructor(\n    private dataService: DataService,\n    private nodeService: NodeService,\n    private activatedRoute: ActivatedRoute,\n    private authService: AuthService,\n    private treelistsvc: TreelistService\n  ) {\n\n  }\n\n  ngOnInit(): void {\n\n    this.treelistsvc.showNodeDetails.subscribe( t => {\n      console.log(t);\n      this.showNodeConfig = t;\n    });\n\n    this.treelistsvc.currentNodeDetails.subscribe( d => {\n      this.currentNode = d;\n    })\n\n\t\tthis.blocks$ = this.dataService.records$('blocks', {})\n\t\t\t.pipe(\n\t\t\t\tmap(( r: Paginated<any>) => r.data)\n      )\n      \n    this.activatedRoute.params.subscribe( p => {\n      console.log(p)\n      this.workflow = p.id;\n    })\n\n    // this.loading = false;\n\n\n\n    // for (const c of data.children) {\n    //   const alist = [];\n    //   alist.push(c);\n    //   this.treeLists.push([alist]);\n    // }\n\n    // this.treelistsvc.setCurrentlySelectedTree(this.treeLists[0]);\n    // this.currentlySelectedTree = treelistsvc.currentlySelectedTree;\n    // this.currentlySelectedTreeId = this.currentlySelectedTree[0][0].id;\n\n    console.log(this.workflow);\n    this.dataService.findRecords('workflow-blocks', {\n      parent_workflow: `${this.workflow}`,\n      start: true\n    })\n    .then( res => {\n\n\n      console.log('---- WORKFLOW BLOCKS -----');\n      console.log(res)\n\n      let nodeCount = 10;\n      res.data.forEach( n => {\n        // this.nodeService.addDynamicNode(n);\n        console.log(n)\n        n.id = n._id\n\n        this.nodes.push(n)\n\n        console.log(n)\n\n\n\n      \n      })\n      \n    })\n    .then( () => {\n      // this.loading = false;\n      this.treelistsvc.treeToggler$.subscribe((status) => {\n        this.currentlySelectedTree = this.treelistsvc.currentlySelectedTree;\n        this.currentlySelectedTreeId = this.treelistsvc.currentlySelectedTreeId;\n        this.treelistsvc.clearHiddenChildren();\n      });\n  \n      // // // for (const c of this.nodes) {\n      // // //   console.log(c)\n      // // //   const alist = [];\n      // // //   alist.push(c);\n      // // //   this.treeLists.push([alist]);\n\n      // // //   console.log(this.treeLists)\n      // // // }\n\n      this.loading = false;\n  \n      console.log('--- NODES ---')\n      console.log(this.nodes);\n      this.treeLists.push([this.nodes]);\n      this.treelistsvc.setCurrentlySelectedTree(this.treeLists[0]);\n      this.currentlySelectedTree = this.currentlySelectedTree;\n      this.currentlySelectedTreeId = this.currentlySelectedTree[0][0].id;\n    })\n\n\n    \n\n\n  }\n\n  ngAfterViewInit() {\n\n    // this.nodeService.showNodeDetails$.subscribe( t => {\n    //   this.showNodeConfig = t;\n    // });\n\n    // this.nodeService.currentNodeDetails$.subscribe( n => {\n    //   this.currentNode = n;\n    // });\n\n    // this.nodeService\n    // this.nodeService.setRootViewContainerRef(this.viewContainerRef);\n\n\n\n\n    // this.activities$ = this.dataService.records$('workflow-activities', {\n    //   parent_workflow: this.workflow\n    // })\n    // .pipe(\n    //   map(( r: Paginated<any>) => r.data)\n    // )\n\n  }\n\n\n\n\n\n  loadConnections() {\n    this.dataService.getRecord('workflows', this.workflow)\n      .then( wf => {\n        if(wf.node_connections) {\n          wf.node_connections.forEach( c => {\n            this.nodeService.addConnection(c);\n          });\n        }\n\n      });\n  }\n\n  saveWorkflow() {\n\n  }\n\n  onResourceDrop(event: any) {\n    console.log(event);\n  }\n\n}\n","<div class=\"module-content-container\">\n  <div class=\"module-header-wrapper\" style=\"border-bottom: 1px solid #cccccc;\">\n    <div class=\"module-header-container\" class=\"flex-container\"  style=\"padding: 15px;\">\n\n      <div class=\"module-branding\">\n        <div class=\"module-brand\">\n          <clr-icon class=\"is-solid\" style=\"margin-right: 10px;\" shape=\"design\"></clr-icon>\n          <span class=\"module-title\">\n            Workflow Designer\n          </span>\n\n\n\n        </div>\n      </div>\n\n\n      <div class=\"module-nav\" style=\"margin-left: 25px;\">\n        <button class=\"btn btn-sm btn-primary\" (click)=\"saveWorkflow();\">Save</button>\n      </div>\n\n    </div>\n\n  </div>\n\n\n  <div class=\"module-content-area\">\n\n\n    <div *ngIf=\"loading\" style=\"height: 100%; margin-bottom: 500px;\">\n      <app-page-loading></app-page-loading>\n    </div>\n\n\n    <as-split unit=\"pixel\">\n      <as-split-area size=\"250\" minSize=\"225\" maxSize=\"250\">\n        <div class=\"workflow-activity-picker\" style=\"margin: 10px;\" *ngIf=\"blocks$ | async as blocks\">\n          <div class=\"card activity-card\" \n            *ngFor=\"let m of blocks\"\n            [clrDraggable]=\"m\"\n            style=\"margin-bottom: 10px !important;\n             max-width: 240px !important;\n             margin-top: 0 !important;\n            padding-left: 11px; padding-right: 10px !important;\">\n            <div class=\"card-block flex-container\">\n              <span style=\"margin-right: 10px;\">\n                <clr-icon [attr.shape]=\"m.icon\"></clr-icon>\n              </span>\n              <span>\n                {{ m.name }}\n              </span>\n            </div>\n          </div>\n\n        </div>\n\n        <div class=\"workflow-activity-picker\" style=\"margin: 10px;\" *ngIf=\"pwshScripts$ | async as modules\">\n          <div class=\"card activity-card\" \n            *ngFor=\"let m of modules\"\n            [clrDraggable]=\"m\"\n            style=\"margin-bottom: 10px !important;\n             max-width: 240px !important;\n             margin-top: 0 !important;\n            padding-left: 11px; padding-right: 10px !important;\">\n            <div class=\"card-block flex-container\">\n              <span style=\"margin-right: 10px;\">\n                <clr-icon [attr.shape]=\"m.icon\"></clr-icon>\n              </span>\n              <span>\n                {{ m.name }}\n              </span>\n            </div>\n          </div>\n\n        </div>\n      </as-split-area>\n\n      <as-split-area size=\"*\">\n\n\n        <app-design-workflow-tree [treelist]=\"currentlySelectedTree\"></app-design-workflow-tree>\n\n\n      </as-split-area>\n\n      <as-split-area size=\"600\">\n        <!-- <ngx-monaco-editor [options]=\"editorOptions\" [(ngModel)]=\"code\"></ngx-monaco-editor> -->\n        <div class=\"workflow-node-details\" *ngIf=\"showNodeConfig\">\n          <workflow-node-details [node]=\"currentNode\"></workflow-node-details>\n        </div>\n      </as-split-area>\n    </as-split>\n\n  \n  </div>\n\n</div>\n\n","import { Component, OnInit, Input } from '@angular/core';\nimport { TreelistService } from '../treelist.service';\nimport { DataService } from '../../core/services/data.service';\nimport { ActivatedRoute } from '@angular/router';\n\n@Component({\n  selector: 'app-design-workflow-node',\n  templateUrl: './design-workflow-node.component.html',\n  styleUrls: ['./design-workflow-node.component.scss']\n})\nexport class DesignWorkflowNodeComponent implements OnInit {\n\n  @Input('node') node: any;\n  \n\n  workflow: any;\n\n  selectedNodeID: string;\n  nodeId: string;\n  ticks = 0;\n  public hideChildrenList;\n  mouseDownX: string;\n  mouseDownY: string;\n\n  currentlyHoveringId: string;\n\n  constructor(\n    private treelistsvc: TreelistService,\n    private dataService: DataService,\n    private activatedRoute: ActivatedRoute\n  ) {\n\n    this.activatedRoute.params.subscribe(p => {\n      this.workflow = p.id;\n    })\n\n    this.treelistsvc.hideChilrenToggler$.subscribe((status) => {\n      this.hideChildrenList = treelistsvc.hideChildrenOfIds;\n    });\n    this.treelistsvc.hoverNodeToggler$.subscribe((status) => {\n      this.currentlyHoveringId = treelistsvc.currentlyHoveringId;\n    });\n    this.hideChildrenList = [];\n  }\n\n  ngOnInit(): void {\n  }\n\n\n  updateSelectedNode(node) {\n    this.treelistsvc.showDetails(node);\n  }\n\n\n  shouldShowPopup(id) {\n    return this.currentlyHoveringId === id;\n  }\n\n  hideChilren(id) {\n    this.treelistsvc.hideNodeChilren(id);\n  }\n\n  mouseDown(nodeID: string, selectedNode, event) {\n    // console.log('mouse down: ' + this.ticks);\n    if (event.target.id !== 'expandbutton') {\n      this.mouseDownX = event.clientX;\n      this.mouseDownY = event.clientY;\n    }\n  }\n\n  mouseUp(nodeID: string, selectedNode, event) {\n    if (event.target.id !== 'expandbutton' && event.target.id !== 'addbutton') {\n      if (this.mouseDownX === event.clientX && this.mouseDownY === event.clientY) {\n        // this.sidenav.setFocusNode(nodeID, selectedNode);\n      } \n      // else if (selectedNode !== this.sidenav.getFocusNode()) {\n      //   // this.sidenav.setFocusNode(nodeID, selectedNode);\n      // }\n    }\n  }\n\n  getSelectedNodeID() {\n    // return this.sidenav.getFocusNodeId();\n  }\n\n  mouseEnter(id, event) {\n    // console.log('enter');\n    // console.log(id)\n    this.treelistsvc.setCurrentlyHoveringId(id);\n  }\n\n  mouseLeave(id, event) {\n    // console.log('leaving');\n    this.treelistsvc.setCurrentlyHoveringId('');\n  }\n\n  nodeClicked(nodeID: string, selectedNode, event) {\n    // this.sidenav.setFocusNode(nodeID, selectedNode);\n    // console.log(this.ticks);\n  }\n\n  shouldHideChildren(id) {\n    return this.treelistsvc.hideChildrenOfIds.includes(id);\n  }\n\n  addChild(id) {\n    this.dataService.createRecord('workflow-blocks', {\n      parent_activity: id,\n      parent_workflow: this.workflow,\n      start: false,\n      name: 'A NEW CHILD',\n      children: []\n    })\n    .then( res => {\n      console.log(res);\n      this.treelistsvc.addChild(id, res);\n    })\n    // console.log('add child to ' + id);\n    \n  }\n\n  onResourceDrop(event, parent) {\n    let blockData = event.dragDataTransfer;\n\n    console.log(blockData)\n    this.dataService.createRecord('workflow-blocks', {\n      type: blockData._type,\n      parent_block: `${blockData._id}`,\n      parent: `${parent}`,\n      start: false,\n      name: blockData.name,\n      icon: blockData.icon,\n      parent_activity: `${parent}`,\n      parent_workflow: `${this.workflow}`,\n      children: []\n    })\n    .then( res => {\n      console.log(res);\n      this.treelistsvc.addChild(parent, res);\n    })\n    console.log(event);\n    console.log('Parent ' + parent);\n  }\n\n\n}\n","<div class=\"hv-item\">\n\t<div class=\"hv-item-parent\" *ngIf=\"node.children.length >= 0 && !shouldHideChildren(node._id)\">\n    <div  (click)=\"nodeClicked(node._id, node, $event)\"  (mousedown)=\"mouseDown(node._id, node, $event)\" (mouseup)=\"mouseUp(node._id, node, $event)\" [ngClass]=\"node._id == getSelectedNodeID() ? 'simple-card-highlighted': 'simple-card-not-highlighted'\">\n        <!-- <div class=\"popoverbox\" (mouseleave)=\"mouseLeave(node._id, $event)\" (mouseenter)=\"mouseEnter(node._id, $event)\">\n            <div [ngClass]=\"shouldShowPopup(node._id) ? 'popupdescription':'invispopupdescription'\">{{node.description}}</div>\n        </div> -->\n        <!-- <button id=\"addbutton\" class=\"add-button\" (click)='addChild(node._id)'></button> -->\n        <button id=\"expandbutton\" class=\"expand-button rotated-button\"(click)='hideChilren(node._id)'></button>\n        <div class=\"card clickable\" clrDroppable (clrDrop)=\"onResourceDrop($event, node._id);\" (click)=\"updateSelectedNode(node)\" style=\"margin: 0;\">\n          <div class=\"card-block flex-container\">\n            <clr-icon [attr.shape]=\"node.icon\"></clr-icon>\n            <span>\n              {{ node.name }}\n            </span>\n          </div>\n        </div>         \n    </div>\n\n  </div>\n  <div class=\"hv-item-children\" *ngIf=\"node.children.length > 0 && shouldHideChildren(node._id)\">\n      <div (click)=\"nodeClicked(node._id, node, $event)\"  (mousedown)=\"mouseDown(node._id, node, $event)\" (mouseup)=\"mouseUp(node._id, node, $event)\" [ngClass]=\"node._id == getSelectedNodeID() ? 'simple-card-highlighted': 'simple-card-not-highlighted'\">\n          <div class=\"popoverbox\" (mouseleave)=\"mouseLeave(node._id, $event)\" (mouseenter)=\"mouseEnter(node._id, $event)\">\n              <!-- <div [ngClass]=\"shouldShowPopup(node._id) ? 'popupdescription':'invispopupdescription'\">{{node.description}}</div> -->\n          </div>\n          <button id=\"expandbutton\" class=\"expand-button-2\"(click)='hideChilren(node._id)'></button>\n          <div class=\"card clickable\" clrDroppable (clrDrop)=\"onResourceDrop($event, node._id);\" (click)=\"updateSelectedNode(node)\" style=\"margin: 0;\">\n            <div class=\"card-block flex-container\">\n              <clr-icon [attr.shape]=\"node.icon\"></clr-icon>\n              <span>\n                {{ node.name }}\n              </span>\n            </div>\n          </div>\n      </div>\n  </div>\n\t<div class=\"hv-item-children\" *ngIf=\"node.children.length > 0 && !shouldHideChildren(node._id)\">\n    <div class=\"hv-item-child onlyfirst\" *ngFor=\"let child of node.children\">\n        <app-design-workflow-node *ngIf=\"child.children.length > 0\" [node]=\"child\"></app-design-workflow-node>\n        <div class=\"hv-item\" *ngIf=\"child.children.length == 0\">\n            <div (mouseleave)=\"mouseLeave(child._id, $event)\" (mouseenter)=\"mouseEnter(child._id, $event)\" (click)=\"nodeClicked(child._id, child, $event)\"  (mousedown)=\"mouseDown(child._id, child, $event)\" (mouseup)=\"mouseUp(child._id, child, $event)\" [ngClass]=\"child._id == getSelectedNodeID() ? 'simple-card-highlighted': 'simple-card-not-highlighted'\">\n                <div class=\"popoverbox\" (mouseleave)=\"mouseLeave(child._id, $event)\" (mouseenter)=\"mouseEnter(child._id, $event)\">\n                    <!-- <div [ngClass]=\"shouldShowPopup(child._id) ? 'popupdescription':'invispopupdescription'\">{{child.description}}</div> -->\n                </div>\n              <!-- <button id=\"addbutton\" class=\"add-button\"(click)='addChild(child._id)'></button> -->\n              <div class=\"card clickable\" clrDroppable (clrDrop)=\"onResourceDrop($event, child._id);\" (click)=\"updateSelectedNode(child)\" style=\"margin: 0;\">\n                <div class=\"card-block flex-container\">\n                  <clr-icon [attr.shape]=\"child.icon\"></clr-icon>\n                  <span>\n                    {{ child.name }}\n                  </span>\n                </div>\n              </div>\n            </div>\n        </div>\n      </div>\n  </div>\n</div>\n","import { Component, OnInit } from '@angular/core';\n\n@Component({\n  selector: 'workflow-palette',\n  templateUrl: './design-workflow-palette.component.html',\n  styleUrls: ['./design-workflow-palette.component.scss']\n})\nexport class DesignWorkflowPaletteComponent implements OnInit {\n\n  constructor() { }\n\n  ngOnInit(): void {\n  }\n\n}\n","<p>design-workflow-palette works!</p>\n","import { Component, OnInit, Input } from '@angular/core';\nimport {DomSanitizer} from '@angular/platform-browser';\n\n@Component({\n  selector: 'app-design-workflow-tree',\n  templateUrl: './design-workflow-tree.component.html',\n  styleUrls: ['./design-workflow-tree.component.scss']\n})\nexport class DesignWorkflowTreeComponent implements OnInit {\n\n  @Input() treelist;\n\n  constructor(private sanitizer: DomSanitizer) {\n\n  }\n\n  ngOnInit(): void {\n  }\n\n}\n","<div class=\"trees\">\n  <div *ngFor=\"let tree of treelist\">\n        <div class=\"hv-container\">\n          <app-design-workflow-node *ngFor=\"let node of tree\" [node]=\"node\"></app-design-workflow-node>\n        </div>\n  </div>\n</div>\n","import { Component, OnInit } from '@angular/core';\n\n@Component({\n  selector: 'app-design-workflows',\n  templateUrl: './design-workflows.component.html',\n  styleUrls: ['./design-workflows.component.scss']\n})\nexport class DesignWorkflowsComponent implements OnInit {\n\n  constructor() { }\n\n  ngOnInit(): void {\n  }\n\n}\n","<div class=\"main-container\" style=\"height: calc(100% - 60px) !important;\">\n  <div class=\"content-container\">\n    <div class=\"content-area\">\n      <app-records-list-view [table]=\"'workflows'\"></app-records-list-view>\n    </div>\n  </div>\n</div>\n\n","import { Component, OnInit, OnDestroy, AfterViewInit, AfterContentInit, ViewEncapsulation, Input, ViewContainerRef, ViewChild } from '@angular/core';\nimport { Observable, Subscription } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { Paginated } from '@feathersjs/feathers';\nimport { Router, ActivatedRoute } from '@angular/router';\nimport { DataService } from '../core/services/data.service';\n\nimport { NodeService } from './node.service';\n\n@Component({\n  selector: 'app-design',\n  templateUrl: './design.component.html',\n  styleUrls: ['./design.component.scss']\n\n})\nexport class DesignComponent implements OnInit, AfterViewInit {\n\n\tblocks$: Observable<any>;\n  ansibleWorkflows$: Observable<any>;\n  pwshScripts$: Observable<any>;\n    \n \n  nodes = [];\n\n  loading: boolean = true;\n\n  nodes$: Observable<any>;\n  connections$: Observable<any>;\n\n  workflow: any;\n\n  connections = [];\n\n  showNodeConfig: boolean = false;\n  currentNode: any = null;\n\n\n  constructor(\n      private dataService: DataService,\n      private nodeService: NodeService,\n      private activatedRoute: ActivatedRoute\n  ) { }\n\n  ngOnInit(): void {\n\n\t\t// this.terraformModules$ = this.dataService.records$('api/terraform/modules', {})\n\t\t// \t.pipe(\n\t\t// \t\tmap(( r: Paginated<any>) => r.data)\n\t\t// \t)\n\n\t\t// this.terraformModules$.subscribe( data => {\n\n    //   for ( var d in data ) {\n    //     data[d].node_type = 'terraform-module'\n    //   }\n\t\t// \tthis.rootDirectory[0].files = data;\n\t\t// })\n\n\t\t// this.ansibleWorkflows$ = this.dataService.records$('api/tower/workflows', {})\n\t\t// \t.pipe(\n\t\t// \t\tmap(( r: Paginated<any>) => r.data)\n\t\t// \t)\n\n    // this.pwshScripts$ = this.dataService.records$('api/scripts/pwsh', {})\n\t\t// \t.pipe(\n\t\t// \t\tmap(( r: Paginated<any>) => r.data)\n\t\t// \t)\n\t\t// this.ansibleWorkflows$.subscribe( data => {\n    //   for ( var d in data ) {\n    //     data[d].node_type = 'tower-workflow'\n    //   }\n\t\t// \t  this.rootDirectory[1].files = data;\n    // });\n        \n        //this.fillFromJson();\n\n    // this.activatedRoute.params.subscribe( params => {\n    //   this.workflow = params.id;\n    //   // this.nodes$ = this.dataService.records$('api/workflow-nodes', {\n    //   //   parent_workflow: this.workflow,\n    //   //   $sort: {\n    //   //     order: 1\n    //   //   }\n    //   // })\n    //   // .pipe(\n    //   //   map(( r: Paginated<any>) => r.data)\n    //   // )\n\n    //   // this.connections$ = this.dataService.records$('api/workflow-connections', {\n    //   //   parent_workflow: this.workflow\n    //   // })\n    //   // .pipe(\n    //   //   map(( r: Paginated<any>) => r.data)\n    //   // )\n\n    // })\n  }\n\n  // loadConnections() {\n  //   this.dataService.getRecord('api/catalog-workflows', this.workflow)\n  //     .then( wf => {\n  //       if(wf.node_connections) {\n  //         wf.node_connections.forEach( c => {\n  //           this.nodeService.addConnection(c);\n  //         });\n  //       }\n\n  //     });\n  // }\n\n  ngAfterViewInit() {\n\n    // this.nodeService.showNodeDetails$.subscribe( t => {\n    //   this.showNodeConfig = t;\n    // });\n\n    // this.nodeService.currentNodeDetails$.subscribe( n => {\n    //   this.currentNode = n;\n    // });\n\n    // this.nodeService\n    // this.nodeService.setRootViewContainerRef(this.viewContainerRef);\n\n    // this.dataService.findRecords('api/workflow-nodes', {\n    //   parent_workflow: this.workflow\n    // })\n    // .then( res => {\n\n    //   let nodeCount = 0;\n    //   res.data.forEach( n => {\n    //     this.nodeService.addDynamicNode(n);\n\n      \n    //   })\n      \n    // })\n    // .then( () => {\n    //   setTimeout( () => {\n    //     this.loadConnections();\n    //     this.loading = false;\n    //   }, 5000);\n    // })\n  }\n\n\n  openFile(directoryName: string, fileName: string) {\n  }\n\n  files: any[] = [{ name: 'img_001.jpg' }, { name: 'img_002.jpg' }, { name: 'img_003.jpg' }];\n  activeDemoVariant = 'basic-draggable';\n  droppedFiles: any[] = [];\n\n  private moveItem(item: any, from: any[], to: any[]) {\n    const indexInFiles = from.indexOf(item);\n    if (indexInFiles > -1) {\n      from.splice(indexInFiles, 1);\n    }\n    if (to.indexOf(item) === -1) {\n      to.push(item);\n    }\n  }\n\n//   {\"id\":\"Step_0 id: b46a17\",\"top\":177,\"left\":146}\n  onResourceDrop(dropEvent) {\n      console.log(dropEvent)\n\n      let newNode = {\n        type: dropEvent.dragDataTransfer.node_type,\n        parent: dropEvent.dragDataTransfer._id,\n        parent_workflow: this.workflow,\n        icon: dropEvent.dragDataTransfer.icon,\n        name: dropEvent.dragDataTransfer.name,\n        description: dropEvent.dragDataTransfer.description,\n        left: dropEvent.dropPointPosition.pageX - 216,\n        top: dropEvent.dropPointPosition.pageY - 60,\n        order: dropEvent.dropPointPosition.pageY - 60\n      }\n\n      \n\n      this.dataService.createRecord('api/workflow-nodes', newNode)\n        .then( n => {\n          this.nodeService.addDynamicNode(n);\n        })\n      // this.nodeService.addDynamicNode({\n      //     id: dropEvent.dragDataTransfer.name,\n      //     top: 100,\n      //     left: 200\n      // });\n  }\n\n  configureNode(n) {\n    this.showNodeConfig = true;\n    this.currentNode = n;\n  }\n  deleteNode(n) {\n    if( this.currentNode._id == n._id ) {\n      this.showNodeConfig = false;\n    };\n\n    this.dataService.updateRecord('api/workflow-nodes', n._id, { deleted: true });\n  }\n\n\n  // onSaveWorkflow() {\n\n  //     //save element position on Canvas and node conections\n  \n  //     const container = this.viewContainerRef.element.nativeElement.parentNode;\n  //     const nodes = Array.from(container.querySelectorAll('.node')).map((node: HTMLDivElement) => {\n  //       return {\n  //         id: node.id,\n  //         top: node.offsetTop,\n  //         left: node.offsetLeft\n  //       }\n  //     });\n  \n  //     nodes.forEach( n => {\n  //       this.dataService.updateRecord('api/workflow-nodes', n.id, n);\n  //     })\n  \n  //     const connections = (this.nodeService.jsPlumbInstance.getAllConnections() as any[])\n  //         .map((conn) => ({ uuids: conn.getUuids() }));\n\n  //     this.dataService.updateRecord('api/catalog-workflows', this.workflow, { node_connections: connections })\n  \n  //     // connections.forEach( (c:any)=> {\n  //     //   c.parent_workflow = this.workflow;\n  //     //   this.dataService.findRecords('api/workflow-connections', {\n  //     //     parent_workflow: this.workflow\n  //     //   })\n  //     //   .then( res => {\n  \n  //     //   })\n  //     //   .then( () => {\n  //     //     // res.data.forEach(w => {\n  //     //     //   this.dataService.deleteRecord('api/workflow-connections', w._id, w);\n  //     //     // });\n  //     //     this.dataService.createRecord('api/workflow-connections', c);\n  //     //   })\n  \n        \n  //     // })\n  \n  //     // const json = JSON.stringify({ nodes, connections });\n  \n  //     // console.log(json);\n\n  // }\n\n}\n","<div class=\"main-container\">\n  <!-- <div class=\"alert alert-app-level\">\n      ...\n  </div> -->\n  <nav class=\"subnav\">\n    <ul class=\"nav\">\n      <!-- <li class=\"nav-item\">\n        <a class=\"nav-link\" routerLink=\"/design/home\" routerLinkActive=\"active\">Home</a>\n      </li> -->\n\n      <li class=\"nav-item\">\n        <a class=\"nav-link\" routerLink=\"/design/workflows\" routerLinkActive=\"active\">Workflows</a>\n      </li>\n\n      <li class=\"nav-item\">\n        <a class=\"nav-link\" routerLink=\"/design/blocks\" routerLinkActive=\"active\">Blocks</a>\n      </li>\n\n      \n      <li class=\"nav-item\">\n        <a class=\"nav-link\" routerLink=\"/design/block-types\" routerLinkActive=\"active\">Block Types</a>\n      </li>\n      <li class=\"nav-item\">\n        <a class=\"nav-link\" routerLink=\"/design/custom-icons\" routerLinkActive=\"active\">Custom Icons</a>\n      </li>\n      <!-- <li class=\"nav-item\">\n        <a class=\"nav-link\" routerLink=\"/design/providers\" routerLinkActive=\"active\">Providers</a>\n      </li> -->\n    </ul>\n  </nav>\n  <div class=\"content-container\">\n    <div class=\"content-area\" style=\"padding: 0; margin: 0; height: 100%;\">\n      <router-outlet></router-outlet>\n    </div>\n    <!-- <nav class=\"sidenav\">\n        ...\n    </nav> -->\n  </div>\n</div>","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\nimport { DesignRoutingModule } from './design-routing.module';\n\nimport { MonacoEditorModule } from 'ngx-monaco-editor';\n\n\nimport { AngularSplitModule } from 'angular-split';\nimport { DesignComponent } from './design.component';\nimport { SharedModule } from '../shared/shared.module';\nimport { ClarityModule } from '@clr/angular';\nimport { WorkflowStudioRootComponent } from './workflow-studio-root/workflow-studio-root.component';\nimport { NodesContainerComponent } from './nodes-container/nodes-container.component';\nimport { NodeService } from './node.service';\nimport { NodeComponent } from './node.component';\nimport { WorkflowNodeDetailsComponent } from './workflow-node-details/workflow-node-details.component';\nimport { DesignHomeComponent } from './design-home/design-home.component';\nimport { DesignBlocksComponent } from './design-blocks/design-blocks.component';\nimport { DesignWorkflowsComponent } from './design-workflows/design-workflows.component';\nimport { DesignProvidersComponent } from './design-providers/design-providers.component';\nimport { DesignBlockTypesComponent } from './design-block-types/design-block-types.component';\nimport { DesignWorkflowEditorComponent } from './design-workflow-editor/design-workflow-editor.component';\nimport { DesignWorkflowPaletteComponent } from './design-workflow-palette/design-workflow-palette.component';\nimport { DesignWorkflowTreeComponent } from './design-workflow-tree/design-workflow-tree.component';\nimport { DesignWorkflowNodeComponent } from './design-workflow-node/design-workflow-node.component';\nimport { DesignCustomIconsComponent } from './design-custom-icons/design-custom-icons.component';\n\n\n@NgModule({\n  declarations: [DesignComponent, WorkflowStudioRootComponent, NodesContainerComponent, NodeComponent, WorkflowNodeDetailsComponent, DesignHomeComponent, DesignBlocksComponent, DesignWorkflowsComponent, DesignProvidersComponent, DesignBlockTypesComponent, DesignWorkflowEditorComponent, DesignWorkflowPaletteComponent, DesignWorkflowTreeComponent, DesignWorkflowNodeComponent, DesignCustomIconsComponent],\n  imports: [\n    CommonModule,\n    ClarityModule,\n    SharedModule,\n    AngularSplitModule,\n    MonacoEditorModule.forRoot(),\n    DesignRoutingModule\n  ],\n  exports: [\n    \n  ],\n  entryComponents: [\n    NodeComponent\n  ],\n  providers: [\n    NodeService\n  ]\n})\nexport class DesignModule { }\n","import { Component, Input, AfterViewInit, ViewEncapsulation } from '@angular/core';\nimport { NodeService } from './node.service';\n\nexport interface Node {\n  id: string,\n  _id: string;\n  type: string,\n  name: string,\n  icon: string,\n  parent_workflow: string,\n  top?: number;\n  left?: number\n}\n\n\n\n@Component({\n  selector: 'node',\n  templateUrl: './node.component.html',\n  encapsulation: ViewEncapsulation.None\n})\nexport class NodeComponent implements AfterViewInit {\n  @Input() node: any;\n\n  @Input('showNodeConfig') showNodeConfig: any;\n\n  @Input() jsPlumbInstance;\n\n\n  connectorPaintStyle = {\n    strokeWidth: 2,\n    stroke: \"#61B7CF\",\n    joinstyle: \"flow\",\n    outlineStroke: \"white\",\n    outlineWidth: 0\n  }\n  // .. and this is the hover style.\n  connectorHoverStyle = {\n    strokeWidth: 5,\n    stroke: \"#216477\",\n    outlineWidth: 0,\n    outlineStroke: \"white\"\n  }\n  endpointHoverStyle = {\n    fill: \"#216477\",\n    stroke: \"#216477\"\n  }\n  // the definition of source endpoints (the small blue ones)\n  sourceEndpoint = {\n    endpoint: \"Dot\",\n    paintStyle: {\n        stroke: \"#7AB02C\",\n        fill: \"transparent\",\n        radius: 10,\n        strokeWidth: 2\n    },\n    isSource: true,\n    connector: [ \"Flowchart\", { stub: [40, 60], gap: 10, cornerRadius: 5, alwaysRespectStubs: true } ],\n    connectorStyle: this.connectorPaintStyle,\n    hoverPaintStyle: this.endpointHoverStyle,\n    connectorHoverStyle: this.connectorHoverStyle,\n    dragOptions: {},\n    overlays: [\n        [ \"Label\", {\n            location: [0.5, 1.5],\n            label: \"OUT\",\n            cssClass: \"endpointSourceLabel\",\n            visible:true\n        } ]\n    ]\n  }\n  // the definition of target endpoints (will appear when the user drags a connection)\n  targetEndpoint = {\n    endpoint: \"Dot\",\n    paintStyle: { fill: \"#7AB02C\", radius: 10 },\n    hoverPaintStyle: this.endpointHoverStyle,\n    maxConnections: 10,\n    dropOptions: { hoverClass: \"hover\", activeClass: \"active\" },\n    isTarget: true,\n    overlays: [\n        [ \"Label\", { location: [0.5, 1.5], label: \"IN\", cssClass: \"endpointTargetLabel\", visible:true } ]\n    ]\n  }\n\n\n  sourceAnchors = [\n    [ 0, 1, 0, 1 ],\n    [ 0.25, 1, 0, 1 ],\n    [ 0.5, 1, 0, 1 ],\n    [ 0.75, 1, 0, 1 ],\n    [ 1, 1, 0, 1 ]\n  ];\n\n  constructor(\n    private nodeService: NodeService\n  ) {\n\n  }\n\n\n  handleClick(event, node) {\n    if(event.metaKey) {\n      let endpoints = this.jsPlumbInstance.getEndpoints(node._id)\n      console.log(endpoints)\n      if(endpoints.length == 2) {\n        this.jsPlumbInstance.addEndpoint(node._id, { anchor: 'TopRight', uuid: node._id + new Date() }, this.sourceEndpoint);\n      }\n      else {\n\n          alert('NO MORE!')\n\n      }\n      \n    }\n  }\n\n  ngAfterViewInit() {\n\n\n\n    // this is the paint style for the connecting lines..\n\n    const id = this.node._id;\n    \n    this.jsPlumbInstance.batch( () => {\n      this._addEndpoints(id, [\"BottomRight\"], [\"TopLeft\"]);\n    })\n    \n    //this.jsPlumbInstance.fire(\"jsPlumbDemoLoaded\", this.jsPlumbInstance);\n    //this.jsPlumbInstance.addEndpoint(id, { anchor: 'TopCenter', uuid: id + '_top' }, targetEndpoint);\n    this.jsPlumbInstance.draggable(id);\n\n\n\n\n    console.log(this.jsPlumbInstance);\n  }\n  _addEndpoints (toId, sourceAnchors, targetAnchors) {\n    for (var i = 0; i < sourceAnchors.length; i++) {\n        var sourceUUID = toId + sourceAnchors[i];\n        this.jsPlumbInstance.addEndpoint(toId, this.sourceEndpoint, {\n            anchor: sourceAnchors[i], uuid: sourceUUID\n        });\n    }\n    for (var j = 0; j < targetAnchors.length; j++) {\n        var targetUUID = toId + targetAnchors[j];\n        this.jsPlumbInstance.addEndpoint(toId, this.targetEndpoint, { anchor: targetAnchors[j], uuid: targetUUID });\n    }\n  };\n\n  loadNodeDetails(n) {\n    console.log('\\n\\n---- NODE ----');\n    console.log(n)\n    this.nodeService.showDetails(n);\n  }\n}\n\n\n"," <div class=\"node studio-component-node\" id=\"{{node._id}}\" [style.top.px]=\"node.top || 0\" [style.left.px]=\"node.left || 20\">\n  \n     <div class=\"studio-node-data\" style=\"height: 100%\">\n    \n      <a (click)=\"handleClick($event, node);\" style=\"margin-top: 0px !important\" (dblclick)=\"loadNodeDetails(node)\" href=\"javascript://\" class=\"card clickable\">\n        <div class=\"card-block\">\n          <div class=\"progress danger top\">\n            <progress value=\"100\" max=\"100\"></progress>\n          </div>\n          <p class=\"card-text flex-container\">\n            <span style=\"margin-right: 10px;\">\n              <clr-icon [attr.shape]=\"node.icon\"></clr-icon>\n            </span>\n            <span>\n              {{ node.name }}\n            </span>\n          </p>\n        </div>\n      </a>\n    \n     </div>\n\n   </div>\n\n\n<style>\n.flex-container {\n  display: flex;\n  flex-wrap: wrap;\n}\n\n.flex-container > a {\n  width: 300px;\n  height: 200px;\n  margin: 10px;\n}\n</style>","import {\n  ComponentRef,\n  ComponentFactoryResolver,\n  Injectable,\n  Inject,\n  ReflectiveInjector\n} from '@angular/core';\nimport { jsPlumb } from 'jsplumb';\n\nimport { NodeComponent, Node } from './node.component';\nimport { Subscribable, Subject } from 'rxjs';\n\n@Injectable()\nexport class NodeService {\n\n  private rootViewContainer: any;\n\n  showNodeDetails = new Subject<boolean>();\n  showNodeDetails$ = this.showNodeDetails.asObservable();\n\n  currentNodeDetails = new Subject<any>();\n  currentNodeDetails$ = this.currentNodeDetails.asObservable();\n\n  jsPlumbInstance = jsPlumb.getInstance({\n    // drag options\n    DragOptions: { cursor: \"pointer\", zIndex: 2000 },\n    // default to a gradient stroke from blue to green.\n    PaintStyle: {\n      // @ts-ignore\n        gradient: { stops: [\n            [ 0, \"#0d78bc\" ],\n            [ 1, \"#558822\" ] \n        ] },\n        stroke: \"#558822\",\n        strokeWidth: 10\n    },\n    Container: \"canvas\"\n});\n\n  constructor(private factoryResolver: ComponentFactoryResolver) { }\n\n  public setRootViewContainerRef(viewContainerRef) {\n    console.log('\\n\\n ---- SET VIEW ----');\n    console.log(viewContainerRef);\n    this.rootViewContainer = viewContainerRef;\n  }\n\n  public addDynamicNode(node: any) {\n    const factory = this.factoryResolver.resolveComponentFactory(NodeComponent);\n    const component = factory.create(this.rootViewContainer.parentInjector);\n    (<any>component.instance).node = node;\n    (<any>component.instance).jsPlumbInstance = this.jsPlumbInstance;\n    this.rootViewContainer.insert(component.hostView);\n    //console.log(\"in NodeService..\" , component.instance );\n  }\n \n  addConnection(connection) {\n    //console.log(connection)\n    this.jsPlumbInstance.connect({ uuids: connection.uuids });\n  }\n\n  showDetails(node) {\n    this.currentNodeDetails.next(node);\n    this.showNodeDetails.next(true);\n  }\n\n  hideDetails() {\n    this.showNodeDetails.next(false)\n  }\n\n  setCurrentNode() {\n    \n  }\n\n  public clear() {\n    this.rootViewContainer.clear();\n  }\n}\n\n","import { Component, OnInit, OnChanges, Input, ChangeDetectionStrategy, ViewContainerRef, ViewChild, ComponentFactoryResolver, AfterViewInit, ViewEncapsulation } from '@angular/core';\nimport { NodeService } from '../node.service';\nimport { DataService } from '../../core/services/data.service';\nimport { Subject, Subscribable } from 'rxjs';\n\n\n\n@Component({\n  selector: 'nodes-container',\n  templateUrl: './nodes-container.component.html',\n  styleUrls: ['./nodes-container.component.scss'],\n  encapsulation: ViewEncapsulation.None\n // changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class NodesContainerComponent implements OnInit, AfterViewInit {\n  @Input() nodes = [];\n\n  @Input() connections = [];\n\n  @Input() workflow: any;\n\n  @Input('showNodeConfig') showNodeConfig: any;\n\n  \n\n  // @ViewChild('nodes', { read: ViewContainerRef }) viewContainerRef: ViewContainerRef;\n\n  @ViewChild('nodes', { read: ViewContainerRef }) viewContainerRef;\n\n  constructor(\n    private r: ComponentFactoryResolver,\n    private nodeService: NodeService,\n    private dataService: DataService\n  ) {}\n\n  ngOnInit() {\n\n    \n\n  }  \n\n \n\n\n  loadConnections() {\n    for ( var c in this.connections ) {\n      this.nodeService.addConnection(this.connections[c])\n    }\n\n    return true;\n  }\n\n  ngAfterViewInit() {\n    //console.log(this.viewContainerRef);\n    this.nodeService.setRootViewContainerRef(this.viewContainerRef);\n\n    //console.log(this.nodeService);\n\n\n    let nodesAdded = 0;\n    this.nodes.forEach(n => {\n      this.nodeService.addDynamicNode(n);\n\n      nodesAdded++;\n\n      if(nodesAdded == this.nodes.length) {\n        //this.loadConnections();\n\n        console.log(nodesAdded);\n        console.log(this.nodes.length)\n      }\n    })\n\n    // this.connections.forEach(conn => {\n    //   this.nodeService.addConnection(conn);\n    // })\n    \n    // setTimeout(() => {\n    //   this.connections.forEach(connection => {\n    //     console.log(connection)\n    //     this.nodeService.addConnection(connection);\n    //   });\n    // }, )\n  }\n\n  addNode() {\n\n  }\n\n  saveNodeJson(){\n    //save element position on Canvas and node conections\n\n    const container = this.viewContainerRef.element.nativeElement.parentNode;\n    const nodes = Array.from(container.querySelectorAll('.node')).map((node: HTMLDivElement) => {\n      return {\n        id: node.id,\n        top: node.offsetTop,\n        left: node.offsetLeft\n      }\n    });\n\n    nodes.forEach( n => {\n      this.dataService.updateRecord('api/workflow-nodes', n.id, n);\n    })\n\n    const connections = (this.nodeService.jsPlumbInstance.getAllConnections() as any[])\n        .map((conn) => ({ uuids: conn.getUuids() }));\n\n    connections.forEach( (c:any)=> {\n      c.parent_workflow = this.workflow;\n      this.dataService.findRecords('api/workflow-connections', {\n        parent_workflow: this.workflow\n      })\n      .then( res => {\n\n      })\n      .then( () => {\n        // res.data.forEach(w => {\n        //   this.dataService.deleteRecord('api/workflow-connections', w._id, w);\n        // });\n        this.dataService.createRecord('api/workflow-connections', c);\n      })\n\n      \n    })\n\n    const json = JSON.stringify({ nodes, connections });\n\n    console.log(json);\n  }\n  \n}","<!-- <div class=\"nodes-container studio-canvas\">\n  <button (click)=\"saveNodeJson();\">SAVE</button>\n  <div class=\"nodes\" style=\"height: 100%;\">\n    <ng-template class=\"ss-node\" #nodes></ng-template>\n  </div>\n</div> -->\n\n\n<div id=\"canvas\" class=\"nodes-container studio-canvas\">\n  <button (click)=\"saveNodeJson();\">SAVE</button>\n  <div class=\"nodes\" style=\"height: 100%;\">\n    <ng-template class=\"ss-node\" #nodes [showNodesConfig]=\"showNodesConfig\"></ng-template>\n  </div>\n</div>","import { Injectable } from '@angular/core';\nimport { Subject } from 'rxjs';\n@Injectable({\n  providedIn: 'root'\n})\nexport class TreelistService {\n  public newId = 30;\n  private treeToggler = new Subject<any>();\n  treeToggler$ = this.treeToggler.asObservable();\n  private hideChilrenToggler = new Subject<any>();\n  hideChilrenToggler$ = this.hideChilrenToggler.asObservable();\n  private hoverNodeToggler = new Subject<any>();\n  hoverNodeToggler$ = this.hoverNodeToggler.asObservable();\n\n  showNodeDetails = new Subject<boolean>();\n  showNodeDetails$ = this.showNodeDetails.asObservable();\n\n  currentNodeDetails = new Subject<any>();\n  currentNodeDetails$ = this.currentNodeDetails.asObservable();\n\n  hideChildrenOfIds = [];\n  public treelist;\n  public currentlySelectedTree;\n  public currentlySelectedTreeId;\n  public currentlyHoveringId;\n  constructor() { }\n\n  setCurrentlyHoveringId(id) {\n    this.currentlyHoveringId = id;\n    this.hoverNodeToggler.next(true);\n  }\n\n  getCurrentlyHoveringId() {\n    return this.currentlyHoveringId;\n  }\n\n  setCurrentlySelectedTree(t) {\n    console.log('---- SET ----')\n    console.log(t)\n    this.currentlySelectedTree = t;\n    this.currentlySelectedTreeId = t[0][0]._id;\n    this.treeToggler.next(true);\n  }\n\n\n\n  setTreeList(tl) {\n    this.treelist = tl;\n  }\n\n  clearHiddenChildren() {\n    this.hideChildrenOfIds = [];\n  }\n  hideNodeChilren(id) {\n    if (this.hideChildrenOfIds.includes(id)) {\n      const index = this.hideChildrenOfIds.indexOf(String(id));\n      this.hideChildrenOfIds.splice(index, 1);\n    } else {\n      this.hideChildrenOfIds.push(id);\n      this.hideChilrenToggler.next(true);\n      console.log(this.hideChildrenOfIds);\n    }\n  }\n\n  addChild(id, data) {\n    console.log('add child to ' + id);\n    console.log(this.currentlySelectedTree[0][0]);\n\n    const childArray = this.getChildrenOfID(this.currentlySelectedTree[0][0], id);\n    console.log('---- CHILD ARRAY ----');\n    \n    console.log(childArray);\n    childArray.push(data);\n    this.newId = this.newId + 1;\n  }\n\n\n\n  getChildrenOfID(tree, id) {\n    const stack = [tree];\n    console.log('---- STACK ----');\n    console.log(stack);\n    while (stack.length) {\n        const current = stack.pop();\n        console.log('---- CURRENT ----');\n        console.log(current);\n        if (current._id === id) {\n          return current.children;\n        }\n        stack.push(...current.children);\n    }\n  }\n\n  hideChild(id) {\n\n  }\n\n  showDetails(node) {\n    console.log('---- SHOW SERVICE ----');\n    this.currentNodeDetails.next(node);\n    this.showNodeDetails.next(true);\n  }\n\n  hideDetails() {\n    this.showNodeDetails.next(false)\n  }\n}\n","import { Component, OnInit, OnDestroy, AfterViewInit, AfterContentInit, Input, OnChanges } from '@angular/core';\nimport { Observable, Subscription } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { Paginated } from '@feathersjs/feathers';\nimport { Router, ActivatedRoute } from '@angular/router';\nimport { DataService } from '../../core/services/data.service';\nimport { NodeService } from '../node.service';\nimport { TreelistService } from '../treelist.service';\n\n\n@Component({\n  selector: 'workflow-node-details',\n  templateUrl: './workflow-node-details.component.html',\n  styleUrls: ['./workflow-node-details.component.scss']\n})\nexport class WorkflowNodeDetailsComponent implements OnInit, OnDestroy { \n\n  @Input('node') node: any;\n  @Input('showDetails') showDetails: boolean;\n\n  table: any;\n\n  parentVariables$: Observable<any>;\n  parent$: Observable<any>;\n\n  node_vars = [];\n\n  currentNode$: Observable<any>;\n  showDetails$: Observable<any>;\n\n  constructor(\n    private dataService: DataService,\n    private nodeService: NodeService\n  ) { }\n\n  ngOnDestroy() {\n    this.node = null;\n  }\n\n\n\n  ngOnInit(): void {\n\n    console.log(this.node)\n\n    if(this.node.type == 'terraform-module') {\n      this.parentVariables$ = this.dataService.records$('api/terraform/module-variables', {\n        parent: this.node.parent\n      })\n      .pipe(\n        map(( r: Paginated<any>) => r.data)\n      )\n\n      this.parentVariables$.subscribe( vars => {\n\n        vars.forEach(v => {\n          this.node_vars.push(v);\n        });\n        \n\n        // this.dataService.createRecord('api/workflow-node-variables', v);\n      })\n\n      this.parent$ = this.dataService.record$('api/terraform/module', this.node.parent);\n\n    }\n\n  }\n\n  addNodeConnector() {\n\n  }\n\n  saveNode(){\n    this.dataService.updateRecord('workflow-blocks', this.node._id, this.node);\n  }\n\n  deleteNode() {\n    this.dataService.findRecords('workflow-block-variables', {\n      parent: this.node._id\n    })\n    .then( res => {\n      res.data.forEach( r => {\n        this.dataService.deleteRecord('workflow-block-variables', r._id, r);\n      });\n\n      this.dataService.deleteRecord('workflow-blocks', this.node._id, this.node);\n    });\n\n\n    // this.dataService.updateRecord('workflow-blocks', this.node._id, { deleted: true });\n  }\n\n  syncVariablesFromParentModule() {\n\n    console.log('sync')\n    console.log(this.node)\n\n    this.dataService.findRecords('block-variables', {\n      parent: `${this.node.parent_block}`\n    })\n    .then( res => {\n      res.data.forEach( v => {\n        v.parent = `${this.node._id}`;\n        // v.parent_module = v.parent;\n\n        v._id = this.node._id + v._id;\n\n        console.log(v)\n\n\n        this.dataService.getRecord('workflow-block-variables', v._id)\n          .then( res => {\n            console.log(res);\n            this.dataService.updateRecord('workflow-block-variables', v._id, v);\n          })\n          .catch( err => {\n            console.log(err)\n            this.dataService.createRecord('workflow-block-variables', v);\n          })\n\n      });\n    })\n  }\n\n}\n","<div class=\"module-content-container\">\n  <div class=\"module-header-wrapper\" style=\"border-bottom: 1px solid #cccccc;\">\n    <div class=\"module-header-container\" class=\"flex-container\"  style=\"padding: 15px;\">\n\n      <div class=\"module-branding\">\n        <div class=\"module-brand\">\n          <clr-icon class=\"is-solid\" style=\"margin-right: 10px;\" [attr.shape]=\"node.icon\"></clr-icon>\n          <span class=\"module-title\">\n            {{ node.name }}\n          </span>\n\n        </div>\n      </div>\n\n      <div class=\"module-nav\" style=\"margin-left: 25px;\">\n        <!-- <a href=\"javascript://\" class=\"nav-link nav-icon\">\n          <clr-icon shape=\"plus-circle\" class=\"is-solid\"></clr-icon>\n        </a> -->\n      </div>\n\n    </div>\n\n  </div>\n\n\n  <div class=\"module-content-area\" style=\"padding: 10px;\">\n\n    <!-- <div class=\"btn-group btn-outline-primary btn-sm\">\n      <button class=\"btn\" (click)=\"addNodeConnector();\">Add Connector</button>\n      <button class=\"btn\">Edit</button>\n      <button class=\"btn\">Download</button>\n      <button class=\"btn\">Delete</button>\n    </div> -->\n\n    <clr-tabs>\n      <clr-tab>\n          <button clrTabLink id=\"link1\">Details</button>\n          <clr-tab-content id=\"content1\" *clrIfActive>\n            <form clrForm>\n              <clr-input-container>\n                <label>Name</label>\n                <input clrInput placeholder=\"Fill me in, scotty!\" name=\"name\" [(ngModel)]=\"node.name\" />\n                <clr-control-helper>This is a label that overrides the how the resource is displayed on workflows and in the catalog.</clr-control-helper>\n              </clr-input-container>\n\n              <clr-input-container>\n                <label>Icon</label>\n                <input clrInput placeholder=\"Fill me in, scotty!\" name=\"icon\" [(ngModel)]=\"node.icon\" />\n                <clr-control-helper>The icon displayed on the workflow and in the catalog.</clr-control-helper>\n              </clr-input-container>\n\n\n\n              <clr-textarea-container>\n                <label>Description</label>\n                <textarea clrTextarea placeholder=\"Fill me in, scotty!\" name=\"description\" [(ngModel)]=\"node.description\"></textarea>\n                <clr-control-helper>The description of the resource displayed on the workflow and in the catalog.</clr-control-helper>\n              </clr-textarea-container>\n            </form>\n\n\n            <button (click)=\"saveNode();\" class=\"btn btn-sm btn-primary\">Save</button>\n            <button (click)=\"deleteNode();\" class=\"btn btn-sm btn-danger\">Delete</button>\n          </clr-tab-content>\n      </clr-tab>\n\n      <clr-tab>\n        <button clrTabLink>Variables</button>\n        <clr-tab-content *clrIfActive>\n\n\n          <div class=\"module-variables-container\" style=\"margin-top: 10px; height: 80% !important;\">\n            <app-records-list-view [table]=\"'workflowNodeVariables'\" [filterOnParent]=\"true\" [parentId]=\"node._id\" [sortOnOrder]=\"true\"></app-records-list-view>\n          </div>\n\n          <button (click)=\"syncVariablesFromParentModule();\" class=\"btn btn-sm\">Sync Variables From Parent</button>\n\n          \n        </clr-tab-content>\n    </clr-tab>\n      <clr-tab>\n          <button clrTabLink>Parent Block Variables</button>\n          <clr-tab-content *clrIfActive>\n            <div class=\"module-variables-container\" style=\"margin-top: 10px; height: 50% !important;\">\n              <app-records-list-view [table]=\"'blockVariables'\" [filterOnParent]=\"true\" [parentId]=\"node.parent_block\"></app-records-list-view>\n            </div>\n            \n          </clr-tab-content>\n      </clr-tab>\n    </clr-tabs>\n\n  \n  </div>\n\n</div>\n\n","import { Component, OnInit } from '@angular/core';\n\n@Component({\n  selector: 'app-workflow-studio-root',\n  templateUrl: './workflow-studio-root.component.html',\n  styleUrls: ['./workflow-studio-root.component.scss']\n})\nexport class WorkflowStudioRootComponent implements OnInit {\n\n  constructor() { }\n\n  ngOnInit(): void {\n  }\n\n}\n","<p>workflow-studio-root works!</p>\n"]}